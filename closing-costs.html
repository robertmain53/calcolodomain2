<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Closing Costs Calculator | Mortgages | Finance</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="Estimate buyer or seller closing costs and cash to close for a home purchase. Detailed, itemized calculator with advanced fees, escrow prepaids, and clear methodology."/>
<meta name="author" content="Ugo Candido"/>
<link rel="canonical" href="https://calcdomain.com/closing-costs.html"/>
<meta name="theme-color" content="#ffffff"/>
<meta property="og:type" content="website"/>
<meta property="og:title" content="Closing Costs Calculator"/>
<meta property="og:description" content="Estimate buyer or seller closing costs with an itemized, accessible calculator that meets WCAG 2.1 AA."/>
<meta property="og:url" content="https://calcdomain.com/closing-costs.html"/>
<meta property="og:image" content="https://calcdomain.com/og-image.png"/>

<!-- Tailwind + Inter + site search -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer></script>

<!-- MathJax for LaTeX formulas (once) -->
<script>
  window.MathJax = {
    tex: { inlineMath: [['\\(','\\)'], ['$', '$']], displayMath: [['\\[','\\]']] },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<!-- Preload site JS -->
<link rel="preload" href="/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="/assets/js/page-enhancements.js" as="script">

<style>
  /* Design tokens (mobile-first) */
  :root{
    --primary:#005A9C; --primary-600:#004c85; --secondary:#003F6E;
    --bg:#F8F9FA; --surface:#FFFFFF;
    --text:#212529; --muted:#6C757D; --border:#DEE2E6;
    --success:#198754; --danger:#DC3545; --warning:#FFC107;
    --radius-sm:6px; --radius-md:10px; --radius-lg:12px;
    --shadow:0 4px 10px rgba(0,0,0,.06);
    --touch:48px; --container:1200px;
    --gap:1rem; --gap-lg:2rem;
    --font-sans: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
    --mono: ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono","Courier New",monospace;
  }
  @media (prefers-contrast: more){ :root{ --primary:#003166; --secondary:#001e3a; --border:#000; } }
  @media (prefers-reduced-motion: reduce){ *{animation:none!important; transition:none!important; scroll-behavior:auto!important} }

  /* Base */
  *{box-sizing:border-box}
  html{font-size:16px}
  body{
    margin:0; font-family:var(--font-sans); color:var(--text);
    background:var(--bg); line-height:1.6;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  a{color:var(--primary); text-decoration:none}
  a:hover{text-decoration:underline}
  a:focus{outline:3px solid var(--primary); outline-offset:2px; border-radius:4px}
  h1,h2,h3{color:var(--secondary); line-height:1.25; margin:0 0 .75rem}
  h1{font-size:clamp(1.75rem,4vw,2.4rem)}
  h2{font-size:clamp(1.4rem,3vw,1.9rem)}
  h3{font-size:clamp(1.2rem,2.6vw,1.5rem)}
  p{margin:.75rem 0; max-width:72ch}
  .container{max-width:var(--container); margin:0 auto; padding:0 clamp(1rem,4vw,2rem)}
  .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}

  /* Skip link */
  .skip-link{position:absolute; left:8px; top:-40px; background:var(--primary); color:#fff; padding:.5rem .75rem; border-radius:0 0 6px 6px; z-index:1000}
  .skip-link:focus{top:0}

  /* Layout */
  main{padding:var(--gap-lg) 0}
  .breadcrumb{font-size:.9rem; color:var(--muted); margin-bottom:.5rem}
  .calc-grid{display:grid; grid-template-columns:1fr; gap:var(--gap-lg)}
  @media (min-width: 992px){ .calc-grid{grid-template-columns:420px 1fr} }

  /* Card */
  .card{background:var(--surface); border:1px solid var(--border); border-radius:var(--radius-lg); box-shadow:var(--shadow); padding:clamp(1rem,3vw,1.5rem)}

  /* Form */
  .form-group{margin-bottom:1rem}
  .form-group label{font-weight:700; display:flex; align-items:center; gap:.5rem; margin-bottom:.35rem}
  .form-hint{font-size:.9rem; color:var(--muted)}
  .input-row{display:flex; gap:.5rem; align-items:stretch}
  .form-control{width:100%; min-height:48px; padding:.75rem; border:1px solid var(--border); border-radius:8px; font-size:1rem; background:#fff}
  .form-control:focus-visible{outline:3px solid var(--primary); outline-offset:2px; border-color:var(--primary)}
  .form-control[aria-invalid="true"]{border-color:var(--danger)}
  .addon{display:inline-flex; align-items:center; padding:0 .75rem; background:#eef5fb; border:1px solid var(--border); border-radius:8px}
  .radio-group{display:flex; gap:.5rem; flex-wrap:wrap}
  .radio-chip{position:relative}
  .radio-chip input{position:absolute; opacity:0}
  .radio-chip label{display:inline-flex; align-items:center; justify-content:center; min-height:44px; padding:.5rem .75rem; border:1px solid var(--border); border-radius:8px; cursor:pointer; color:var(--secondary); user-select:none}
  .radio-chip input:checked + label{background:var(--primary); color:#fff; border-color:var(--primary)}
  .radio-chip input:focus-visible + label{outline:3px solid var(--primary); outline-offset:2px}

  .toggle-row{display:flex; gap:.5rem; align-items:center; flex-wrap:wrap}
  details.disclosure{border:1px solid var(--border); border-radius:10px; padding:.75rem}
  details.disclosure[open]{background:#fdfefe}
  details.disclosure summary{cursor:pointer; font-weight:700; outline-offset:2px}

  .tooltip{
    appearance:none; border:1px dashed var(--primary); color:var(--primary);
    background:transparent; border-radius:50%; width:28px; height:28px; min-width:28px; min-height:28px;
    display:inline-flex; align-items:center; justify-content:center; font-weight:800; line-height:1; cursor:pointer
  }
  .tooltip:focus{outline:3px solid var(--primary); outline-offset:2px}
  .tooltip-content{display:none; margin:.25rem 0 0; font-size:.92rem; color:#0c3b60}
  .tooltip-content[data-open="true"]{display:block}

  .error{color:var(--danger); font-size:.92rem; margin-top:.25rem}

  /* Results */
  .results{min-height:300px}
  .result-item{display:flex; justify-content:space-between; gap:1rem; padding:.6rem 0; border-bottom:1px solid var(--border)}
  .result-item:last-child{border-bottom:none}
  .result-label{color:var(--muted)}
  .result-value{font-weight:800; color:var(--success)}
  .muted{color:var(--muted)}
  .breakdown{margin-top:1rem}
  .breakdown h3{margin-top:.5rem}
  .list{list-style:none; padding:0; margin:.25rem 0}
  .list li{display:flex; justify-content:space-between; gap:.5rem; padding:.4rem 0; border-bottom:1px dashed #e6e9ee}
  .badge{display:inline-block; padding:.1rem .45rem; border-radius:6px; background:#eef5fb; color:#0c3b60; font-size:.85rem; font-weight:700}

  /* Content sections */
  .content h2{margin-top:1.5rem; padding-top:.5rem}
  .formula-box{background:#eef2f6; border:1px solid var(--border); border-radius:10px; padding:1rem; font-family:var(--mono); overflow:auto}
  code.ltx{font-family:var(--mono); font-weight:600; background:transparent; padding:0}
  .author-box{font-size:.95rem; color:var(--muted); border-top:1px solid var(--border); padding-top:1rem; margin-top:2rem}
</style>

<!-- Non-critical global styles (kept to remain self-contained) -->
<style>
  .calculator-layout{display:grid; grid-template-columns:1fr; gap:2rem}
  @media (min-width: 992px){ .calculator-layout{grid-template-columns:420px 1fr} }
</style>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Closing Costs Calculator",
  "description": "An accessible, itemized closing costs calculator for buyers and sellers. Estimate cash to close, escrow prepaids, and line-item fees with transparent methodology.",
  "url": "https://calcdomain.com/closing-costs.html",
  "inLanguage": "en",
  "genre": "Finance",
  "author": { "@type": "Person", "name": "Ugo Candido" },
  "publisher": { "@type": "Organization", "name": "CalcDomain" },
  "mainEntity": [{ "@type": "HowTo", "name": "Estimate Your Total Cash to Close",
    "description": "Follow these steps to estimate buyer or seller closing costs and cash to close.",
    "step": [
      { "@type": "HowToStep", "name": "Enter basics", "text": "Choose Buyer or Seller and input the purchase price." },
      { "@type": "HowToStep", "name": "Down payment and rate", "text": "For buyers, select down payment mode (percent or amount) and set the interest rate for prepaid interest." },
      { "@type": "HowToStep", "name": "Adjust fees", "text": "Open Advanced Fees to fine-tune origination, discount points, title insurance, taxes, and escrow deposits." },
      { "@type": "HowToStep", "name": "Review results", "text": "See itemized totals, closing costs as a percentage of price, and cash to close or net proceeds." }
    ]
  },
  { "@type": "FAQPage", "mainEntity": [
    { "@type": "Question", "name": "What are typical closing costs for buyers?", "acceptedAnswer": { "@type": "Answer", "text": "Buyers usually pay 2%–5% of the purchase price, including lender fees, appraisal, title services (lender’s policy), recording, and prepaids like taxes and insurance." } },
    { "@type": "Question", "name": "What are typical closing costs for sellers?", "acceptedAnswer": { "@type": "Answer", "text": "Sellers often pay owner’s title policy, transfer taxes (in many states), and real estate agent commissions. Altogether, this can exceed 5% depending on local customs." } },
    { "@type": "Question", "name": "Are discount points worth it?", "acceptedAnswer": { "@type": "Answer", "text": "Discount points are prepaid interest that reduce your mortgage rate. They make sense if you plan to keep the loan long enough to break even on the upfront cost." } },
    { "@type": "Question", "name": "What are prepaids and escrows?", "acceptedAnswer": { "@type": "Answer", "text": "Prepaids include per-diem interest from closing to first payment, and initial escrow deposits for property taxes and homeowner’s insurance." } },
    { "@type": "Question", "name": "How accurate is this estimate?", "acceptedAnswer": { "@type": "Answer", "text": "It provides an informed estimate using typical industry ranges. Your Loan Estimate and Closing Disclosure from the lender and settlement agent will provide exact figures." } },
    { "@type": "Question", "name": "Who pays title insurance?", "acceptedAnswer": { "@type": "Answer", "text": "Customs vary by state. The buyer typically pays the lender’s policy. The owner’s policy is often paid by the seller, but this can vary or be negotiated." } },
    { "@type": "Question", "name": "Can seller credits reduce cash to close?", "acceptedAnswer": { "@type": "Answer", "text": "Yes. Seller concessions can reduce the buyer’s cash to close, subject to program limits (e.g., conventional, FHA, VA)." } }
  ]}]
}
</script>
</head>

<body class="bg-gray-50 text-gray-800">
<!-- Header -->
<header class="bg-white shadow-sm sticky top-0 z-50">
  <nav class="container mx-auto px-4 lg:px-6 py-4">
    <div class="flex justify-between items-center">
      <!-- Logo -->
      <a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

      <!-- Desktop search -->
      <div class="w-full max-w-md hidden md:block mx-8">
        <div class="relative">
          <input id="search-input" type="search" placeholder="Search for a calculator..."
            class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            autocomplete="off">
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
        </div>
      </div>

      <!-- Desktop links -->
      <div class="hidden md:flex items-center space-x-6">
        <a href="search.html" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
        <a href="index.html#categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
      </div>

      <!-- Mobile toggle -->
      <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="md:hidden mt-4 hidden">
      <div class="mb-4">
        <div class="relative">
          <input id="mobile-search-input" type="search" placeholder="Search calculators..."
            class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>
      </div>
      <div class="space-y-2">
        <a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
        <a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
      </div>
    </div>
  </nav>
</header>

<a class="skip-link" href="#main">Skip to main content</a>

<!-- Main -->
<main class="container" id="main" role="main">
  <nav aria-label="Breadcrumb" class="breadcrumb">
    <a href="/">Home</a> › <a href="https://calcdomain.com/finance.html">Finance</a> › Closing Costs Calculator
  </nav>

  <h1>Closing Costs Calculator</h1>
  <p>This interactive calculator helps home buyers and sellers estimate closing costs with a clear, itemized breakdown and cash-to-close or net-proceeds summary. It’s built for accuracy, accessibility, and transparency so you can plan with confidence.</p>

  <div class="calc-grid" aria-live="polite">
    <!-- Calculator -->
    <section id="calculator" class="card" aria-labelledby="calc-heading">
<h2 class="sr-only" id="calc-heading">Calculator Inputs</h2>
<div class="form-group">
<fieldset>
<legend class="sr-only">Choose your role</legend>
<div aria-label="Role" class="radio-group" role="radiogroup">
<div class="radio-chip">
<input checked="" id="roleBuyer" name="role" type="radio" value="buyer"/>
<label for="roleBuyer">Buyer</label>
</div>
<div class="radio-chip">
<input id="roleSeller" name="role" type="radio" value="seller"/>
<label for="roleSeller">Seller</label>
</div>
</div>
</fieldset>
</div>
<div class="form-group">
<label for="price">Purchase price *</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="priceErr priceTip" aria-required="true" class="form-control" id="price" inputmode="decimal" min="0" placeholder="e.g., 450000" step="0.01" type="number"/>
</div>
<div class="form-hint" id="priceTip">Enter the total contract price.</div>
<div aria-live="polite" class="error" id="priceErr" role="alert"></div>
</div>
<div class="form-group" id="downPaymentBlock">
<fieldset>
<legend>Down payment *</legend>
<div aria-label="Down payment mode" class="radio-group" role="radiogroup">
<div class="radio-chip">
<input checked="" id="dpPercentMode" name="dpMode" type="radio" value="percent"/>
<label for="dpPercentMode">Percent</label>
</div>
<div class="radio-chip">
<input id="dpAmountMode" name="dpMode" type="radio" value="amount"/>
<label for="dpAmountMode">Amount</label>
</div>
</div>
<div class="input-row" style="margin-top:.5rem">
<label class="sr-only" for="dpPercent">Down payment percent</label>
<input aria-describedby="dpErr dpTip" aria-required="true" class="form-control" id="dpPercent" inputmode="decimal" max="100" min="0" step="0.01" type="number" value="20"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="input-row" style="margin-top:.5rem">
<label class="sr-only" for="dpAmount">Down payment amount</label>
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="dpErr dpTip" aria-required="true" class="form-control" disabled="" id="dpAmount" inputmode="decimal" min="0" step="0.01" type="number" value="0"/>
</div>
<div class="form-hint" id="dpTip">Choose percent or amount. The other field will be computed for reference.</div>
<div aria-live="polite" class="error" id="dpErr" role="alert"></div>
</fieldset>
</div>
<div class="form-group" id="rateBlock">
<label for="rate">Interest rate (annual) *</label>
<div class="input-row">
<input aria-describedby="rateErr rateTip" aria-required="true" class="form-control" id="rate" inputmode="decimal" max="25" min="0" step="0.01" type="number" value="6.50"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="toggle-row" style="margin:.25rem 0 0">
<button aria-controls="rateHelp" aria-expanded="false" aria-label="What is this?" class="tooltip" id="rateTipBtn" type="button">?</button>
<div class="tooltip-content" id="rateHelp" role="note">Used to estimate per-diem interest from the day you close until your first monthly payment.</div>
</div>
<div class="form-hint" id="rateTip">Typical fixed-rate mortgage range 5%–8%.</div>
<div aria-live="polite" class="error" id="rateErr" role="alert"></div>
</div>
<details class="disclosure" id="advancedFees">
<summary>Advanced fees and prepaids</summary>
<div class="form-group">
<label for="points">Discount points</label>
<div class="input-row">
<input aria-describedby="pointsTip pointsErr" class="form-control" id="points" inputmode="decimal" max="10" min="0" step="0.125" type="number" value="0"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="toggle-row">
<button aria-controls="pointsHelp" aria-expanded="false" aria-label="What are points?" class="tooltip" id="pointsTipBtn" type="button">?</button>
<div class="tooltip-content" id="pointsHelp">Each point costs 1% of the loan amount and typically lowers your interest rate by about 0.25% (varies by lender).</div>
</div>
<div class="form-hint" id="pointsTip">0–3 points is common; optional.</div>
<div aria-live="polite" class="error" id="pointsErr" role="alert"></div>
</div>
<div class="form-group">
<label for="origination">Origination fee</label>
<div class="input-row">
<input aria-describedby="origTip origErr" class="form-control" id="origination" inputmode="decimal" max="5" min="0" step="0.1" type="number" value="0.5"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="form-hint" id="origTip">Often 0.5%–1.0% of the loan amount.</div>
<div aria-live="polite" class="error" id="origErr" role="alert"></div>
</div>
<div class="form-group">
<label for="appraisal">Appraisal fee</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="appraisalErr" class="form-control" id="appraisal" inputmode="decimal" min="0" step="1" type="number" value="600"/>
</div>
<div aria-live="polite" class="error" id="appraisalErr" role="alert"></div>
</div>
<div class="form-group">
<label for="creditReport">Credit report</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="creditErr" class="form-control" id="creditReport" inputmode="decimal" min="0" step="1" type="number" value="40"/>
</div>
<div aria-live="polite" class="error" id="creditErr" role="alert"></div>
</div>
<div class="form-group">
<label for="inspection">Home inspection (optional)</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="inspectErr" class="form-control" id="inspection" inputmode="decimal" min="0" step="1" type="number" value="500"/>
</div>
<div aria-live="polite" class="error" id="inspectErr" role="alert"></div>
</div>
<div class="form-group">
<label for="lenderTitlePct">Lender’s title policy (buyer)</label>
<div class="input-row">
<input aria-describedby="lenderTitleTip lenderTitleErr" class="form-control" id="lenderTitlePct" inputmode="decimal" max="2" min="0" step="0.01" type="number" value="0.25"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="form-hint" id="lenderTitleTip">Percent of purchase price (typical range 0.2%–0.5%, varies by state).</div>
<div aria-live="polite" class="error" id="lenderTitleErr" role="alert"></div>
</div>
<div class="form-group">
<label for="ownersTitlePct">Owner’s title policy (usually seller)</label>
<div class="input-row">
<input aria-describedby="ownersTitleTip ownersTitleErr" class="form-control" id="ownersTitlePct" inputmode="decimal" max="2" min="0" step="0.01" type="number" value="0.50"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="form-hint" id="ownersTitleTip">Percent of purchase price (typical range 0.4%–0.8%, varies by state).</div>
<div aria-live="polite" class="error" id="ownersTitleErr" role="alert"></div>
</div>
<div class="form-group">
<label for="transferTaxPct">Transfer taxes</label>
<div class="input-row">
<input aria-describedby="transferTip transferErr" class="form-control" id="transferTaxPct" inputmode="decimal" max="2" min="0" step="0.01" type="number" value="0.30"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="form-hint" id="transferTip">Percent of purchase price. Use 0% if not applicable in your area.</div>
<div aria-live="polite" class="error" id="transferErr" role="alert"></div>
<div class="form-group" style="margin-top:.5rem">
<label for="whoPaysTransfer">Who pays transfer taxes?</label>
<select aria-label="Who pays transfer taxes" class="form-control" id="whoPaysTransfer">
<option selected="" value="seller">Seller</option>
<option value="buyer">Buyer</option>
<option value="split">Split 50/50</option>
</select>
</div>
</div>
<div class="form-group">
<label for="whoPaysOwnerTitle">Who pays Owner’s title policy?</label>
<select aria-label="Who pays Owner's title?" class="form-control" id="whoPaysOwnerTitle">
<option selected="" value="seller">Seller</option>
<option value="buyer">Buyer</option>
</select>
</div>
<div class="form-group">
<label for="recording">Recording and government fees</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="recordingErr" class="form-control" id="recording" inputmode="decimal" min="0" step="1" type="number" value="125"/>
</div>
<div aria-live="polite" class="error" id="recordingErr" role="alert"></div>
</div>
<div class="form-group" id="sellerDocPrepBlock">
<label for="sellerDocPrep">Seller doc prep / recording (seller)</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="sellerDocErr" class="form-control" id="sellerDocPrep" inputmode="decimal" min="0" step="1" type="number" value="0"/>
</div>
<div aria-live="polite" class="error" id="sellerDocErr" role="alert"></div>
</div>
<div class="form-group" id="prepaidGroup">
<label for="perDiemDays">Prepaid interest days</label>
<div class="input-row">
<input aria-describedby="perDiemTip perDiemErr" class="form-control" id="perDiemDays" inputmode="numeric" max="31" min="0" step="1" type="number" value="15"/>
<span aria-hidden="true" class="addon">days</span>
</div>
<div class="form-hint" id="perDiemTip">Estimated days of interest paid upfront at closing.</div>
<div aria-live="polite" class="error" id="perDiemErr" role="alert"></div>
<div class="form-group" style="margin-top:.5rem">
<label for="taxRate">Property tax rate</label>
<div class="input-row">
<input aria-describedby="taxRateTip taxRateErr" class="form-control" id="taxRate" inputmode="decimal" max="10" min="0" step="0.01" type="number" value="1.00"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="form-hint" id="taxRateTip">Annual rate as a percent of purchase price (proxy). Replace with your local rate if known.</div>
<div aria-live="polite" class="error" id="taxRateErr" role="alert"></div>
</div>
<div class="input-row" style="margin-top:.5rem">
<label class="sr-only" for="escrowMonthsTax">Months of tax escrow</label>
<input aria-describedby="escrowTaxTip escrowMonthsTaxErr" class="form-control" id="escrowMonthsTax" inputmode="numeric" max="12" min="0" step="1" type="number" value="3"/>
<span aria-hidden="true" class="addon">months tax escrow</span>
</div>
<div aria-live="polite" class="error" id="escrowMonthsTaxErr" role="alert"></div>
<div class="form-hint" id="escrowTaxTip">Initial escrow deposit collected at closing for property taxes.</div>
<div class="form-group" style="margin-top:.5rem">
<label for="annualInsurance">Homeowner’s insurance (annual)</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="annualInsErr" class="form-control" id="annualInsurance" inputmode="decimal" min="0" step="1" type="number" value="1200"/>
</div>
<div aria-live="polite" class="error" id="annualInsErr" role="alert"></div>
</div>
<div class="input-row" style="margin-top:.5rem">
<label class="sr-only" for="escrowMonthsIns">Months of insurance escrow</label>
<input aria-describedby="escrowInsTip escrowInsErr" class="form-control" id="escrowMonthsIns" inputmode="numeric" max="12" min="0" step="1" type="number" value="3"/>
<span aria-hidden="true" class="addon">months insurance escrow</span>
</div>
<div class="form-hint" id="escrowInsTip">Initial escrow deposit for homeowner’s insurance.</div>
<div aria-live="polite" class="error" id="escrowInsErr" role="alert"></div>
</div>
<div class="form-group" id="sellerCommissionBlock">
<label for="agentCommission">Real estate agent commissions (seller)</label>
<div class="input-row">
<input aria-describedby="commTip commErr" class="form-control" id="agentCommission" inputmode="decimal" max="10" min="0" step="0.1" type="number" value="5.0"/>
<span aria-hidden="true" class="addon">%</span>
</div>
<div class="toggle-row" style="margin-top:.25rem">
<input aria-describedby="commTip" checked="" id="includeCommission" style="width:1.2rem; height:1.2rem" type="checkbox"/>
<label for="includeCommission">Include commissions</label>
</div>
<div class="form-hint" id="commTip">Typical range 4%–6% of price split between listing and buyer’s brokers; negotiable.</div>
<div aria-live="polite" class="error" id="commErr" role="alert"></div>
</div>
<div class="form-group" id="sellerConcessionsBlock">
<label for="sellerCredits">Seller concessions (credits to buyer)</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="sellerCredErr sellerCredTip" class="form-control" id="sellerCredits" inputmode="decimal" min="0" step="1" type="number" value="0"/>
</div>
<div class="form-hint" id="sellerCredTip">Reduces the buyer’s cash to close and the seller’s net proceeds.</div>
<div aria-live="polite" class="error" id="sellerCredErr" role="alert"></div>
</div>
<div class="form-group" id="sellerPayoffBlock">
<label for="mortgagePayoff">Seller’s mortgage payoff</label>
<div class="input-row">
<span aria-hidden="true" class="addon">$</span>
<input aria-describedby="payoffErr payoffTip" class="form-control" id="mortgagePayoff" inputmode="decimal" min="0" step="1" type="number" value="0"/>
</div>
<div class="form-hint" id="payoffTip">Outstanding mortgage balance to be paid at closing (seller only).</div>
<div aria-live="polite" class="error" id="payoffErr" role="alert"></div>
</div>
</details>
<div class="toggle-row" style="margin-top:.5rem">
<button class="btn btn-secondary" id="resetBtn" type="button">Reset</button>
</div>
    </section>

    <!-- Results -->
    <section id="results" class="card results" aria-labelledby="results-heading">
      <h2 id="results-heading">Results</h2>
      <div class="result-item">
        <span class="result-label">Role</span>
        <span class="result-value" id="resRole">Buyer</span>
      </div>
      <div class="result-item" id="loanRow">
        <span class="result-label">Loan amount</span>
        <span class="result-value" id="loanAmount">$0</span>
      </div>
      <div class="result-item">
        <span class="result-label" id="ccLabel">Estimated closing costs</span>
        <span class="result-value" id="closingCosts">$0</span>
      </div>
      <div class="result-item" id="pctRow">
        <span class="result-label">Closing costs as % of price</span>
        <span class="result-value" id="ccPercent">0.0%</span>
      </div>
      <div class="result-item" id="cashRow">
        <span class="result-label" id="cashLabel">Estimated cash to close</span>
        <span class="result-value" id="cashToClose">$0</span>
      </div>
      <div class="result-item" id="sellerNetRow" style="display:none">
        <span class="result-label">Estimated net proceeds</span>
        <span class="result-value" id="netProceeds">$0</span>
      </div>

      <div class="breakdown" aria-live="polite">
        <h3>Itemized breakdown <span class="badge" id="badgeContext">Buyer</span></h3>
        <ul id="breakdownList" class="list" aria-label="Closing cost breakdown"></ul>
        <p id="disclaimer" class="muted">Estimates for planning purposes only. Your Loan Estimate and Closing Disclosure will provide actual figures.</p>
      </div>
    </section>
  </div>

  <!-- Authoritative Content Ecosystem -->
  <section aria-labelledby="content-ecosystem" class="content">
<h2 id="content-ecosystem" style="margin-top:2rem">Data Source and Methodology</h2>
<p><strong>Primary references:</strong></p>
<ul>
<li>
          Consumer Financial Protection Bureau (CFPB), “Closing costs explained,” updated 2024. Direct link:
          <a href="https://www.consumerfinance.gov/owning-a-home/closing-costs/" rel="noopener">consumerfinance.gov/owning-a-home/closing-costs</a>.
        </li>
<li>
          Fannie Mae, “Your Home – Closing Costs Calculator,” 2024. Direct link:
          <a href="https://yourhome.fanniemae.com/calculators-tools/closing-costs-calculator" rel="noopener">yourhome.fanniemae.com/calculators-tools/closing-costs-calculator</a>.
        </li>
</ul>
<p><em>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</em></p>
<p>Where state or lender-specific schedules vary, the tool uses industry-typical ranges and lets you adjust line items to mirror your transaction.</p>
<h2>The Formula Explained</h2>
<div aria-label="Formula presentation" class="formula-box">
<p><strong>Buyer side</strong></p>
<p><code class="ltx">Loan = Price - DownPayment</code></p>
<p><code class="ltx">Points = Loan \times \frac{Points\%}{100}</code></p>
<p><code class="ltx">Origination = Loan \times \frac{Origination\%}{100}</code></p>
<p><code class="ltx">LenderTitle = Price \times \frac{LenderTitle\%}{100}</code></p>
<p><code class="ltx">OwnerTitle_{BuyerPortion} = Price \times \frac{OwnerTitle\%}{100} \quad \text{(if Buyer pays)}</code></p>
<p><code class="ltx">TransferTax_{BuyerPortion} = Price \times \frac{TransferTax\%}{100} \times s</code> where <code class="ltx">s \in \{0, \tfrac{1}{2}, 1\}</code> for Seller/Split/Buyer.</p>
<p><code class="ltx">PerDiemInterest = Loan \times \frac{Rate\%}{100} \times \frac{Days}{365}</code></p>
<p><code class="ltx">TaxEscrow = Price \times \frac{TaxRate\%}{100} \times \frac{MonthsTax}{12}</code></p>
<p><code class="ltx">InsEscrow = \frac{AnnualInsurance}{12} \times MonthsIns</code></p>
<p><code class="ltx">BuyerClosingCosts = \sum(\text{line items})</code></p>
<p><code class="ltx">CashToClose = DownPayment + BuyerClosingCosts - SellerCredits</code></p>
<p style="margin-top:1rem"><strong>Seller side</strong></p>
<p><code class="ltx">OwnerTitle_{SellerPortion} = Price \times \frac{OwnerTitle\%}{100} \quad \text{(if Seller pays)}</code></p>
<p><code class="ltx">TransferTax_{SellerPortion} = Price \times \frac{TransferTax\%}{100} \times (1 - s)</code> with the same <code class="ltx">s</code> mapping.</p>
<p><code class="ltx">Commission = Price \times \frac{Commission\%}{100} \quad \text{(if included)}</code></p>
<p><code class="ltx">SellerClosingCosts = \sum(\text{seller line items})</code></p>
<p><code class="ltx">NetProceeds = Price - Commission - SellerClosingCosts - MortgagePayoff - SellerCredits</code></p>
</div>
<h2>Glossary of Variables</h2>
<ul>
<li><strong>Purchase price:</strong> Contract price of the property.</li>
<li><strong>Down payment:</strong> Cash contribution by the buyer at closing.</li>
<li><strong>Loan amount:</strong> Price minus down payment.</li>
<li><strong>Origination fee (%):</strong> Lender charge as a percent of loan amount.</li>
<li><strong>Discount points (%):</strong> Upfront interest to reduce the mortgage rate (1 point = 1% of loan).</li>
<li><strong>Appraisal, credit report, inspection:</strong> Third-party fees associated with underwriting and due diligence.</li>
<li><strong>Title insurance:</strong> Lender’s policy (buyer) and owner’s policy (often seller); customs vary by state.</li>
<li><strong>Transfer taxes:</strong> State or local tax on the transfer of property.</li>
<li><strong>Recording fees:</strong> Government charges for recording the deed and mortgage.</li>
<li><strong>Prepaid interest:</strong> Interest collected from closing to first payment.</li>
<li><strong>Escrows:</strong> Initial deposits for taxes and insurance.</li>
<li><strong>Seller concessions:</strong> Credits paid by the seller to the buyer, reducing buyer cash to close.</li>
<li><strong>Commission:</strong> Real estate brokerage fees, typically paid by the seller.</li>
<li><strong>Mortgage payoff:</strong> Outstanding balance the seller pays off at closing.</li>
</ul>
<h2>How It Works: A Step-by-Step Example</h2>
<p><strong>Scenario:</strong> Buyer purchasing a $450,000 home with 20% down, 6.5% interest rate, 0 points, 0.5% origination, lender’s title 0.25%, owner’s title paid by seller, transfer tax 0.3% paid by seller, appraisal $600, credit $40, inspection $500, recording $125, 15 days per-diem, property tax 1.0% with 3 months escrow, annual insurance $1,200 with 3 months escrow, seller credits $0.</p>
<ul>
<li>Loan = 450,000 − 90,000 = $360,000</li>
<li>Origination = 360,000 × 0.5% = $1,800</li>
<li>Lender title = 450,000 × 0.25% = $1,125</li>
<li>Per-diem interest = 360,000 × 6.5% × 15/365 ≈ $962.47</li>
<li>Tax escrow = 450,000 × 1.0% × 3/12 = $1,125</li>
<li>Insurance escrow = 1,200/12 × 3 = $300</li>
<li>Other fees = appraisal 600 + credit 40 + inspection 500 + recording 125 = $1,265</li>
<li>Buyer closing costs ≈ 1,800 + 1,125 + 962.47 + 1,125 + 300 + 1,265 = $6,577.47</li>
<li>Cash to close = 90,000 + 6,577.47 − 0 = $96,577.47</li>
</ul>
<p>This fits within typical buyer cost ranges (about 1.5% of price here, excluding owner’s title and transfer tax paid by the seller).</p>
<h2>Frequently Asked Questions (FAQ)</h2>
<div>
<h3>How do closing costs differ from the down payment?</h3>
<p>The down payment reduces the loan amount. Closing costs are additional fees and prepaids required to complete the transaction.</p>
<h3>Can I roll closing costs into the loan?</h3>
<p>Sometimes. For purchases, rolling costs into the loan may require a higher price or lender credit; refis more commonly allow it. Program rules apply.</p>
<h3>Are estimates in this calculator legally binding?</h3>
<p>No. They are planning estimates. Your lender’s Loan Estimate and Closing Disclosure detail actual charges.</p>
<h3>Do I need an owner’s title policy?</h3>
<p>It’s optional but strongly recommended to protect your ownership. In many markets, the seller pays it; this is negotiable.</p>
<h3>Why do costs vary by location?</h3>
<p>State and local transfer taxes, title premiums, and recording schedules vary widely, as do customary payor splits.</p>
<h3>What if my down payment exceeds the purchase price?</h3>
<p>That’s invalid. The tool will prompt you to correct the value—down payment cannot exceed the price.</p>
<h3>How can I reduce cash to close?</h3>
<p>Negotiate seller credits, seek lender credits in exchange for a higher rate, or adjust discretionary items like discount points.</p>
</div>
<div class="author-box">
<p>
          Tool developed by <strong>Ugo Candido</strong>. Content verified by <strong>CalcDomain Editorial</strong>.<br/>
          Last reviewed for accuracy on: <time datetime="2025-09-13">September 13, 2025</time>.
        </p>
</div>
  </section>
</main>

<!-- Footer -->
<footer class="bg-gray-900 text-white mt-12">
  <div class="container mx-auto px-4 lg:px-6 py-10">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.</p>
      </div>
      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
        <ul class="space-y-2">
          <li><a href="finance.html" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="health-fitness.html" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="math-conversions.html" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="lifestyle-everyday.html" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="construction-diy.html" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
        </ul>
      </div>
      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="mortgage-payment.html" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="percentage-calculator.html" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="bmi-calculator.html" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="auto-loan-calculator.html" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="house-affordability.html" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>
      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="#" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="#" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="#" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="#" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>
    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>

<!-- Site JS -->
<script defer src="/assets/js/mobile-menu.js"></script>
<script defer src="/assets/js/page-enhancements.js"></script>

<!-- Calculator JS (unchanged) -->
<script defer>
(function(){
  'use strict';

  // Utilities
  const $ = (s, ctx=document) => ctx.querySelector(s);
  const $$ = (s, ctx=document) => Array.from(ctx.querySelectorAll(s));
  const fmtCurrency = (n) => new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0}).format(isFinite(n)? n : 0);
  const fmtPercent = (n, d=1) => `${(isFinite(n)? n : 0).toFixed(d)}%`;

  // Elements
  const roleBuyer = $('#roleBuyer'); const roleSeller = $('#roleSeller');
  const price = $('#price'); const priceErr = $('#priceErr');

  const dpBlock = $('#downPaymentBlock');
  const dpPercentMode = $('#dpPercentMode'); const dpAmountMode = $('#dpAmountMode');
  const dpPercent = $('#dpPercent'); const dpAmount = $('#dpAmount'); const dpErr = $('#dpErr');

  const rateBlock = $('#rateBlock');
  const rate = $('#rate'); const rateErr = $('#rateErr');

  // Advanced
  const adv = $('#advancedFees');

  const points = $('#points'), pointsErr = $('#pointsErr');
  const origination = $('#origination'), origErr = $('#origErr');
  const appraisal = $('#appraisal'), appraisalErr = $('#appraisalErr');
  const creditReport = $('#creditReport'), creditErr = $('#creditErr');
  const inspection = $('#inspection'), inspectErr = $('#inspectErr');

  const lenderTitlePct = $('#lenderTitlePct'), lenderTitleErr = $('#lenderTitleErr');
  const ownersTitlePct = $('#ownersTitlePct'), ownersTitleErr = $('#ownersTitleErr');
  const transferTaxPct = $('#transferTaxPct'), transferErr = $('#transferErr');
  const whoPaysTransfer = $('#whoPaysTransfer');
  const whoPaysOwnerTitle = $('#whoPaysOwnerTitle');

  const recording = $('#recording'), recordingErr = $('#recordingErr');
  const sellerDocPrep = $('#sellerDocPrep'), sellerDocErr = $('#sellerDocErr');

  const perDiemDays = $('#perDiemDays'), perDiemErr = $('#perDiemErr');
  const taxRate = $('#taxRate'), taxRateErr = $('#taxRateErr');
  const escrowMonthsTax = $('#escrowMonthsTax'), escrowMonthsTaxErr = $('#escrowMonthsTaxErr');
  const annualInsurance = $('#annualInsurance'), annualInsErr = $('#annualInsErr');
  const escrowMonthsIns = $('#escrowMonthsIns'), escrowInsErr = $('#escrowInsErr');

  const agentCommission = $('#agentCommission'), commErr = $('#commErr');
  const includeCommission = $('#includeCommission');
  const sellerCredits = $('#sellerCredits'), sellerCredErr = $('#sellerCredErr');
  const mortgagePayoff = $('#mortgagePayoff'), payoffErr = $('#payoffErr');

  // Blocks that show/hide with role
  const prepaidGroup = $('#prepaidGroup');
  const sellerCommissionBlock = $('#sellerCommissionBlock');
  const sellerConcessionsBlock = $('#sellerConcessionsBlock');
  const sellerPayoffBlock = $('#sellerPayoffBlock');
  const sellerDocPrepBlock = $('#sellerDocPrepBlock');

  // Tooltips
  const rateTipBtn = $('#rateTipBtn'); const rateHelp = $('#rateHelp');
  const pointsTipBtn = $('#pointsTipBtn'); const pointsHelp = $('#pointsHelp');
  const toggleTip = (btn, box) => {
    btn.addEventListener('click', () => {
      const open = btn.getAttribute('aria-expanded') === 'true';
      btn.setAttribute('aria-expanded', String(!open));
      box.dataset.open = String(!open);
    });
    btn.addEventListener('keydown', (e) => {
      if(e.key === ' ' || e.key === 'Enter'){ e.preventDefault(); btn.click(); }
    });
  };
  toggleTip(rateTipBtn, rateHelp);
  toggleTip(pointsTipBtn, pointsHelp);

  // Results
  const resRole = $('#resRole');
  const loanRow = $('#loanRow'); const loanAmountEl = $('#loanAmount');
  const ccLabel = $('#ccLabel'); const closingCostsEl = $('#closingCosts');
  const ccPercentEl = $('#ccPercent'); const pctRow = $('#pctRow');
  const cashLabel = $('#cashLabel'); const cashToCloseEl = $('#cashToClose');
  const sellerNetRow = $('#sellerNetRow'); const netProceedsEl = $('#netProceeds');
  const breakdownList = $('#breakdownList'); const badgeContext = $('#badgeContext');

  // Reset
  $('#resetBtn').addEventListener('click', () => {
    // Simple reset to defaults
    roleBuyer.checked = true;
    price.value = '';
    dpPercentMode.checked = true; dpAmountMode.checked = false;
    dpPercent.disabled = false; dpAmount.disabled = true;
    dpPercent.value = 20; dpAmount.value = 0;
    rate.value = 6.50;

    points.value = 0; origination.value = 0.5; appraisal.value = 600; creditReport.value = 40; inspection.value = 500;
    lenderTitlePct.value = 0.25; ownersTitlePct.value = 0.5; transferTaxPct.value = 0.30; whoPaysTransfer.value = 'seller'; whoPaysOwnerTitle.value = 'seller';
    recording.value = 125; sellerDocPrep.value = 0;

    perDiemDays.value = 15; taxRate.value = 1.0; escrowMonthsTax.value = 3; annualInsurance.value = 1200; escrowMonthsIns.value = 3;

    agentCommission.value = 5.0; includeCommission.checked = true;
    sellerCredits.value = 0; mortgagePayoff.value = 0;

    clearErrors();
    applyRoleUI();
    compute();
    price.focus();
  });

  function clearErrors(){
    $$('.error').forEach(e => e.textContent = '');
    $$('.form-control').forEach(i => i.setAttribute('aria-invalid','false'));
  }

  // Validation helpers
  function setError(input, errEl, msg){
    input.setAttribute('aria-invalid','true');
    errEl.textContent = msg;
  }
  function clearError(input, errEl){
    input.setAttribute('aria-invalid','false');
    errEl.textContent = '';
  }
  function num(v){ const n = parseFloat(v); return isFinite(n) ? n : 0; }

  // Field-level validators
  function validatePrice(){
    const val = num(price.value);
    if(val <= 0){ setError(price, priceErr, 'Enter a purchase price greater than 0.'); return false; }
    clearError(price, priceErr); return true;
  }
  function validateDownPayment(){
    const p = num(price.value);
    let ok = true;
    if(dpPercentMode.checked){
      const dpP = num(dpPercent.value);
      if(dpP < 0 || dpP > 100){ setError(dpPercent, dpErr, 'Down payment percentage must be between 0% and 100%.'); ok = false; }
      else if(p > 0 && (p * dpP/100) > p){ setError(dpPercent, dpErr, 'Down payment cannot exceed the purchase price.'); ok = false; }
      else{ clearError(dpPercent, dpErr); }
    }else{
      const dpA = num(dpAmount.value);
      if(dpA < 0){ setError(dpAmount, dpErr, 'Down payment cannot be negative.'); ok = false; }
      else if(p > 0 && dpA > p){ setError(dpAmount, dpErr, 'Down payment cannot exceed the purchase price.'); ok = false; }
      else{ clearError(dpAmount, dpErr); }
    }
    return ok;
  }
  function validatePercent(input, errEl, label, min=0, max=100){
    const v = num(input.value);
    if(v < min || v > max){ setError(input, errEl, `${label} must be between ${min}% and ${max}%.`); return false; }
    clearError(input, errEl); return true;
  }
  function validateNonNegative(input, errEl, label){
    const v = num(input.value);
    if(v < 0){ setError(input, errEl, `${label} cannot be negative.`); return false; }
    clearError(input, errEl); return true;
  }
  function validateRate(){
    const r = num(rate.value);
    if(r < 0 || r > 25){ setError(rate, rateErr, 'Rate must be between 0% and 25%.'); return false; }
    clearError(rate, rateErr); return true;
  }

  // Blur validation
  [
    [price, validatePrice],
    [dpPercent, validateDownPayment],
    [dpAmount, validateDownPayment],
    [rate, validateRate],
    [points, () => validatePercent(points, pointsErr, 'Discount points', 0, 10)],
    [origination, () => validatePercent(origination, origErr, 'Origination fee', 0, 5)],
    [appraisal, () => validateNonNegative(appraisal, appraisalErr, 'Appraisal fee')],
    [creditReport, () => validateNonNegative(creditReport, creditErr, 'Credit report fee')],
    [inspection, () => validateNonNegative(inspection, inspectErr, 'Inspection fee')],
    [lenderTitlePct, () => validatePercent(lenderTitlePct, lenderTitleErr, 'Lender title rate', 0, 2)],
    [ownersTitlePct, () => validatePercent(ownersTitlePct, ownersTitleErr, 'Owner title rate', 0, 2)],
    [transferTaxPct, () => validatePercent(transferTaxPct, transferErr, 'Transfer tax rate', 0, 2)],
    [recording, () => validateNonNegative(recording, recordingErr, 'Recording fee')],
    [sellerDocPrep, () => validateNonNegative(sellerDocPrep, sellerDocErr, 'Seller doc prep')],
    [perDiemDays, () => {
      const v = num(perDiemDays.value);
      if(v < 0 || v > 31){ setError(perDiemDays, perDiemErr, 'Enter 0–31 days.'); return false; }
      clearError(perDiemDays, perDiemErr); return true;
    }],
    [taxRate, () => validatePercent(taxRate, taxRateErr, 'Property tax rate', 0, 10)],
    [escrowMonthsTax, () => {
      const v = num(escrowMonthsTax.value);
      if(v < 0 || v > 12){ setError(escrowMonthsTax, escrowMonthsTaxErr, 'Enter 0–12 months.'); return false; }
      clearError(escrowMonthsTax, escrowMonthsTaxErr); return true;
    }],
    [annualInsurance, () => validateNonNegative(annualInsurance, annualInsErr, 'Annual insurance')],
    [escrowMonthsIns, () => {
      const v = num(escrowMonthsIns.value);
      if(v < 0 || v > 12){ setError(escrowMonthsIns, escrowInsErr, 'Enter 0–12 months.'); return false; }
      clearError(escrowMonthsIns, escrowInsErr); return true;
    }],
    [agentCommission, () => validatePercent(agentCommission, commErr, 'Commission', 0, 10)],
    [sellerCredits, () => validateNonNegative(sellerCredits, sellerCredErr, 'Seller credits')],
    [mortgagePayoff, () => validateNonNegative(mortgagePayoff, payoffErr, 'Mortgage payoff')]
  ].forEach(([el, fn]) => el.addEventListener('blur', () => { fn(); compute(); }));

  // Input changes trigger compute
  [
    roleBuyer, roleSeller, price, dpPercentMode, dpAmountMode, dpPercent, dpAmount, rate,
    points, origination, appraisal, creditReport, inspection,
    lenderTitlePct, ownersTitlePct, transferTaxPct, whoPaysTransfer, whoPaysOwnerTitle,
    recording, sellerDocPrep, perDiemDays, taxRate, escrowMonthsTax, annualInsurance, escrowMonthsIns,
    agentCommission, includeCommission, sellerCredits, mortgagePayoff
  ].forEach(el => el.addEventListener('input', () => { syncDownPayment(); compute(); }));

  // Mode switching
  function syncDownPayment(){
    const p = num(price.value);
    if(dpPercentMode.checked){
      dpPercent.disabled = false; dpAmount.disabled = true;
      const dpA = p * (num(dpPercent.value)/100);
      dpAmount.value = isFinite(dpA) ? dpA.toFixed(2) : '0';
    }else{
      dpPercent.disabled = true; dpAmount.disabled = false;
      const dpP = p > 0 ? (num(dpAmount.value)/p)*100 : 0;
      dpPercent.value = isFinite(dpP) ? dpP.toFixed(2) : '0';
    }
  }

  function applyRoleUI(){
    const buyer = roleBuyer.checked;
    resRole.textContent = buyer ? 'Buyer' : 'Seller';
    badgeContext.textContent = buyer ? 'Buyer' : 'Seller';

    // Show/hide buyer-centric blocks
    dpBlock.style.display = buyer ? '' : 'none';
    rateBlock.style.display = buyer ? '' : 'none';
    prepaidGroup.style.display = buyer ? '' : 'none';
    loanRow.style.display = buyer ? '' : 'none';
    cashLabel.textContent = buyer ? 'Estimated cash to close' : 'Estimated cash required (if any)';
    ccLabel.textContent = buyer ? 'Estimated closing costs' : 'Estimated seller closing costs';
    pctRow.style.display = ''; // applies to either side

    // Seller-specific
    sellerCommissionBlock.style.display = !buyer ? '' : 'none';
    sellerPayoffBlock.style.display = !buyer ? '' : 'none';
    sellerConcessionsBlock.style.display = ''; // both sides can set credits
    sellerDocPrepBlock.style.display = !buyer ? '' : 'none';
    sellerNetRow.style.display = !buyer ? '' : 'none';
  }

  roleBuyer.addEventListener('change', () => { applyRoleUI(); compute(); });
  roleSeller.addEventListener('change', () => { applyRoleUI(); compute(); });

  dpPercentMode.addEventListener('change', () => { syncDownPayment(); compute(); });
  dpAmountMode.addEventListener('change', () => { syncDownPayment(); compute(); });

  // Initial UI
  applyRoleUI();
  syncDownPayment();

  function compute(){
    // Basic validation gating
    if(!validatePrice()) return;
    const buyer = roleBuyer.checked;

    const P = num(price.value);
    // Down payment & loan (buyer only)
    let DP = 0, Loan = 0;
    if(buyer){
      validateDownPayment();
      DP = dpPercentMode.checked ? P * num(dpPercent.value)/100 : num(dpAmount.value);
      DP = Math.min(Math.max(DP, 0), P);
      Loan = Math.max(P - DP, 0);
    }

    // Common percentages
    const pointsAmt = buyer ? Loan * (num(points.value)/100) : 0;
    const origAmt = buyer ? Loan * (num(origination.value)/100) : 0;
    const appraisalAmt = buyer ? num(appraisal.value) : 0;
    const creditAmt = buyer ? num(creditReport.value) : 0;
    const inspectionAmt = buyer ? num(inspection.value) : 0;

    const lenderTitleAmt = buyer ? P * (num(lenderTitlePct.value)/100) : 0;
    const ownerTitleRate = num(ownersTitlePct.value)/100;
    const transferRate = num(transferTaxPct.value)/100;
    const whoTransfer = whoPaysTransfer.value; // seller|buyer|split
    const whoOwnerTitle = whoPaysOwnerTitle.value; // seller|buyer

    let ownerTitleBuyerPortion = 0, ownerTitleSellerPortion = 0;
    if(whoOwnerTitle === 'buyer') ownerTitleBuyerPortion = P * ownerTitleRate;
    else ownerTitleSellerPortion = P * ownerTitleRate;

    let transferBuyer = 0, transferSeller = 0;
    if(whoTransfer === 'buyer'){ transferBuyer = P * transferRate; }
    else if(whoTransfer === 'seller'){ transferSeller = P * transferRate; }
    else { transferBuyer = P * transferRate/2; transferSeller = P * transferRate/2; }

    const recordingAmt = buyer ? num(recording.value) : 0;
    const sellerDocAmt = !buyer ? num(sellerDocPrep.value) : 0;

    // Prepaids (buyer)
    let perDiem = 0, taxEscrow = 0, insEscrow = 0;
    if(buyer){
      const r = num(rate.value)/100, days = Math.min(Math.max(num(perDiemDays.value),0),31);
      perDiem = Loan * r * (days/365);
      taxEscrow = P * (num(taxRate.value)/100) * (num(escrowMonthsTax.value)/12);
      insEscrow = (num(annualInsurance.value)/12) * num(escrowMonthsIns.value);
    }

    // Credits & seller items
    const credits = num(sellerCredits.value);
    const commissionPct = includeCommission.checked ? num(agentCommission.value) : 0;
    const commissionAmt = !buyer ? (P * commissionPct/100) : 0;
    const payoff = !buyer ? num(mortgagePayoff.value) : 0;

    // Totals
    let buyerCosts = 0;
    if(buyer){
      buyerCosts =
        pointsAmt + origAmt + appraisalAmt + creditAmt + inspectionAmt +
        lenderTitleAmt + ownerTitleBuyerPortion + transferBuyer +
        recordingAmt + perDiem + taxEscrow + insEscrow;
    }
    let cashToClose = 0;
    if(buyer){
      cashToClose = DP + buyerCosts - credits;
    }

    let sellerCosts = 0;
    if(!buyer){
      sellerCosts = ownerTitleSellerPortion + transferSeller + sellerDocAmt;
    }
    let netProceeds = 0;
    if(!buyer){
      netProceeds = P - commissionAmt - sellerCosts - payoff - credits;
    }

    // Update results
    badgeContext.textContent = buyer ? 'Buyer' : 'Seller';
    loanRow.style.display = buyer ? '' : 'none';
    loanAmountEl.textContent = fmtCurrency(Loan);
    closingCostsEl.textContent = fmtCurrency(buyer ? buyerCosts : sellerCosts + commissionAmt);
    ccPercentEl.textContent = fmtPercent(((buyer ? buyerCosts : (sellerCosts + commissionAmt))/P) * 100, 1);
    if(buyer){
      cashLabel.textContent = 'Estimated cash to close';
      cashToCloseEl.textContent = fmtCurrency(cashToClose);
      sellerNetRow.style.display = 'none';
    }else{
      cashLabel.textContent = 'Commission (included in total above)';
      cashToCloseEl.textContent = fmtCurrency(commissionAmt);
      sellerNetRow.style.display = '';
      netProceedsEl.textContent = fmtCurrency(netProceeds);
    }

    // Breakdown list
    breakdownList.innerHTML = '';
    function addItem(name, amount){
      if(Math.abs(amount) < 0.005) return;
      const li = document.createElement('li');
      const s1 = document.createElement('span'); s1.textContent = name;
      const s2 = document.createElement('span'); s2.textContent = fmtCurrency(amount);
      li.append(s1, s2); breakdownList.appendChild(li);
    }

    if(buyer){
      addItem('Origination fee', origAmt);
      addItem('Discount points', pointsAmt);
      addItem('Appraisal', appraisalAmt);
      addItem('Credit report', creditAmt);
      addItem('Home inspection', inspectionAmt);
      addItem('Lender’s title policy', lenderTitleAmt);
      addItem('Owner’s title policy (buyer portion)', ownerTitleBuyerPortion);
      addItem('Transfer taxes (buyer portion)', transferBuyer);
      addItem('Recording & government fees', recordingAmt);
      addItem('Prepaid interest', perDiem);
      addItem('Escrow deposit – property taxes', taxEscrow);
      addItem('Escrow deposit – insurance', insEscrow);
      addItem('Seller credits (subtract)', -credits);
      addItem('Down payment', DP);
    }else{
      addItem('Owner’s title policy (seller portion)', ownerTitleSellerPortion);
      addItem('Transfer taxes (seller portion)', transferSeller);
      addItem('Doc prep / seller recording', sellerDocAmt);
      addItem('Real estate commissions', commissionAmt);
      addItem('Mortgage payoff', payoff);
      addItem('Seller concessions (credits to buyer)', credits);
    }
  }

  // Initial compute
  compute();
})();
</script>
</body>
</html>

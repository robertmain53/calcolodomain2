<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta & Icons -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <title>Packet Loss Calculator — Compute Loss %, Success Rate & Goodput</title>
  <meta name="description" content="Calculate packet loss percentage, loss ratio, success rate, and estimated goodput impact (UDP/TCP). Includes methodology, formulas (LaTeX), glossary, and FAQs." />
  <link rel="canonical" href="https://calcdomain.com/packet-loss-calculator.html" />

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com" defer></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>

  <!-- MathJax for LaTeX -->
  <script defer>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$']] },
      options: { renderActions: { addMenu: [] } }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="preload" as="style" onload="this.rel='stylesheet'">

  <!-- Styles -->
  <style>
    :root { --brand:#1d4ed8; --ink:#0f172a; --muted:#475569; --surface:#ffffff; --bg:#f8fafc; --ring:#2563eb; }
    html { scroll-behavior: smooth; }
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji"; background: var(--bg); color: var(--ink); }
    .prose { max-width: 70ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: .75rem; color: var(--ink); }
    .prose h3 { font-size: 1.125rem; font-weight: 700; margin-top: 1.25rem; margin-bottom: .5rem; color: var(--ink); }
    .prose p, .prose li { color: var(--muted); line-height: 1.65; }
    .formula-box { background:#f1f5f9; border:1px solid #e2e8f0; border-radius:12px; padding:1rem; overflow-x:auto }
    .result-card { background: #fff; border:1px solid #e5e7eb; border-radius:14px; padding:1rem; text-align:center }
    .result-card h4 { font-size:.9rem; color:#64748b; margin-bottom:.25rem }
    .result-card p { font-size:1.5rem; font-weight:800; color:var(--brand); }
    .focus-ring:focus { outline: 3px solid var(--ring); outline-offset: 2px; }
    .btn { display:inline-flex; align-items:center; justify-content:center; gap:.5rem; border-radius:12px; padding:.75rem 1rem; border:1px solid #e5e7eb; background:#fff; font-weight:600 }
    .btn:hover { background:#f8fafc }
    .btn[aria-pressed="true"] { background:#e0e7ff; border-color:#c7d2fe }
    .tooltip { display:none; }
    .tooltip[data-open="true"] { display:block; }
    /* Prevent CLS: reserve space for results */
    #results { min-height: 380px; }
    /* Accessible table */
    table thead th { font-weight:700; color:#475569 }
    /* Touch targets */
    input, select, button { min-height: 48px }
    /* Link focus */
    a:focus { outline:3px solid var(--ring); outline-offset:2px }
    /* Print */
    @media print {
      body * { visibility: hidden; }
      #print-section, #print-section * { visibility: visible; }
      #print-section { position: absolute; left: 0; top: 0; width: 100%; }
      #chartWrapper { display:none !important; }
    }
  </style>

  <!-- JSON-LD: WebPage + Calculator + HowTo + FAQ + Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Packet Loss Calculator",
    "description":"Calculate packet loss percentage, ratio, success rate, and estimated goodput for UDP/TCP. Includes formulas, methodology, example, and FAQs.",
    "url":"https://calcdomain.com/packet-loss-calculator.html",
    "inLanguage":"en",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "applicationCategory":"Calculator",
    "name":"Packet Loss Calculator",
    "operatingSystem":"All",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to calculate packet loss percentage",
    "description":"A quick guide to computing packet loss, success rate, and goodput impact.",
    "step":[
      {"@type":"HowToStep","name":"Enter test metrics","text":"Provide sent and received packet counts, test duration, and optional packet size."},
      {"@type":"HowToStep","name":"Choose protocol model","text":"Pick UDP/Raw or TCP (Mathis model) and set RTT and MSS if using TCP."},
      {"@type":"HowToStep","name":"Calculate","text":"The tool computes loss %, success rate, rate of drops, and estimated goodput."},
      {"@type":"HowToStep","name":"Review results","text":"Inspect cards and the chart showing success vs loss and goodput estimate."}
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What is packet loss?","acceptedAnswer":{"@type":"Answer","text":"Packet loss is the fraction of packets that fail to reach their destination over a network path, expressed as a percentage or ratio."}},
      {"@type":"Question","name":"How do I compute packet loss percentage?","acceptedAnswer":{"@type":"Answer","text":"Loss % = (Sent − Received) / Sent × 100. This tool computes it automatically from your inputs."}},
      {"@type":"Question","name":"What is a good packet loss rate for VoIP or gaming?","acceptedAnswer":{"@type":"Answer","text":"Typically less than 1% is preferred for real-time traffic; 0.1% or lower is ideal. Jitter and latency also matter."}},
      {"@type":"Question","name":"Does bandwidth alone determine goodput under loss?","acceptedAnswer":{"@type":"Answer","text":"No. For TCP, goodput also depends on loss probability and RTT due to congestion control; we use the Mathis model for an estimate."}},
      {"@type":"Question","name":"Is this calculator accurate for Wi-Fi?","acceptedAnswer":{"@type":"Answer","text":"It gives a solid approximation. Wi-Fi retransmissions at lower layers can mask loss; perceived end-to-end loss may be different."}},
      {"@type":"Question","name":"How long should a test run?","acceptedAnswer":{"@type":"Answer","text":"Long enough to capture stable behavior—at least tens of seconds to minutes, or multiple intervals, to average out transient bursts."}},
      {"@type":"Question","name":"What’s the difference between throughput and goodput?","acceptedAnswer":{"@type":"Answer","text":"Throughput is the total bits delivered including headers and retransmissions; goodput is useful payload delivered per second."}}
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Lifestyle & Everyday","item":"https://calcdomain.com/lifestyle-everyday.html"},
      {"@type":"ListItem","position":3,"name":"Miscellaneous","item":"https://calcdomain.com/subcategories/lifestyle-everyday-miscellaneous.html"},
      {"@type":"ListItem","position":4,"name":"Packet Loss Calculator","item":"https://calcdomain.com/packet-loss-calculator.html"}
    ]
  }
  </script>
</head>
<body class="text-slate-900 bg-slate-50">
  <!-- Header (non-sticky) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-extrabold text-blue-700 focus-ring">CalcDomain</a>
      <div class="hidden md:flex items-center gap-6 text-sm">
        <a href="search.html" class="text-slate-700 hover:text-blue-700 focus-ring">Advanced Search</a>
        <a href="index.html#categories" class="text-slate-700 hover:text-blue-700 focus-ring">Categories</a>
      </div>
      <button class="md:hidden btn focus-ring" id="mobileMenuBtn" aria-controls="mobileMenu" aria-expanded="false" aria-label="Open menu">
        <span aria-hidden="true">☰</span>
      </button>
    </nav>
    <div id="mobileMenu" class="md:hidden hidden px-4 pb-4">
      <a class="block py-2 text-slate-700 hover:text-blue-700 focus-ring" href="search.html">Advanced Search</a>
      <a class="block py-2 text-slate-700 hover:text-blue-700 focus-ring" href="index.html#categories">Categories</a>
    </div>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Main Column -->
      <section class="w-full lg:w-2/3">
        <!-- Breadcrumb -->
        <nav class="text-sm text-slate-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-700 focus-ring">Home</a> &raquo;
          <a href="lifestyle-everyday.html" class="hover:text-blue-700 focus-ring">Lifestyle &amp; Everyday</a> &raquo;
          <a href="subcategories/lifestyle-everyday-miscellaneous.html" class="hover:text-blue-700 focus-ring">Miscellaneous</a> &raquo;
          <span class="text-slate-900">Packet Loss Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-xl shadow-sm">
          <!-- 1) H1 -->
          <h1 class="text-3xl font-extrabold mb-2">packet loss calculator</h1>

          <!-- 2) Intro -->
          <p class="text-slate-600 mb-6">
            Quickly compute packet loss percentage, loss ratio, success rate, and the estimated goodput impact of loss over UDP or TCP. Ideal for network engineers, SREs, gamers, and VoIP pros validating connection quality.
          </p>

          <!-- 3) Calculator UI -->
          <section aria-labelledby="calculatorTitle" class="space-y-6">
            <h2 id="calculatorTitle" class="sr-only">Calculator</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Sent -->
              <div>
                <label for="sent" class="block text-sm font-semibold">Packets Sent * </label>
                <div class="flex items-start gap-2">
                  <input type="number" inputmode="decimal" id="sent" min="0" step="1" value="10000"
                    aria-required="true" aria-describedby="sentHelp sentErr"
                    class="mt-1 block w-full px-3 py-2 border rounded-md focus-ring border-slate-300"
                  />
                  <button type="button" class="btn ml-1 focus-ring" aria-expanded="false" aria-controls="sentHelp" data-tooltip="sentHelp" title="What is this?">?</button>
                </div>
                <p id="sentHelp" class="tooltip text-xs text-slate-600 mt-1">Total number of packets your tool attempted to send during the test window.</p>
                <p id="sentErr" class="mt-1 text-sm text-red-600" aria-live="polite"></p>
              </div>

              <!-- Received -->
              <div>
                <label for="received" class="block text-sm font-semibold">Packets Received * </label>
                <div class="flex items-start gap-2">
                  <input type="number" inputmode="decimal" id="received" min="0" step="1" value="9950"
                    aria-required="true" aria-describedby="receivedHelp receivedErr"
                    class="mt-1 block w-full px-3 py-2 border rounded-md focus-ring border-slate-300"
                  />
                  <button type="button" class="btn ml-1 focus-ring" aria-expanded="false" aria-controls="receivedHelp" data-tooltip="receivedHelp" title="What is this?">?</button>
                </div>
                <p id="receivedHelp" class="tooltip text-xs text-slate-600 mt-1">How many packets were successfully received (acknowledged) end-to-end.</p>
                <p id="receivedErr" class="mt-1 text-sm text-red-600" aria-live="polite"></p>
              </div>

              <!-- Duration -->
              <div>
                <label for="duration" class="block text-sm font-semibold">Test Duration (seconds) * </label>
                <div class="flex items-start gap-2">
                  <input type="number" inputmode="decimal" id="duration" min="0.001" step="0.001" value="10"
                    aria-required="true" aria-describedby="durationHelp durationErr"
                    class="mt-1 block w-full px-3 py-2 border rounded-md focus-ring border-slate-300"
                  />
                  <button type="button" class="btn ml-1 focus-ring" aria-expanded="false" aria-controls="durationHelp" data-tooltip="durationHelp" title="What is this?">?</button>
                </div>
                <p id="durationHelp" class="tooltip text-xs text-slate-600 mt-1">Time window of the measurement. Used to compute rates (pps, drops/sec).</p>
                <p id="durationErr" class="mt-1 text-sm text-red-600" aria-live="polite"></p>
              </div>

              <!-- Packet size -->
              <div>
                <label for="pktSize" class="block text-sm font-semibold">Packet Payload Size (bytes) </label>
                <div class="flex items-start gap-2">
                  <input type="number" inputmode="decimal" id="pktSize" min="0" step="1" value="1200"
                    aria-describedby="pktSizeHelp pktSizeErr"
                    class="mt-1 block w-full px-3 py-2 border rounded-md focus-ring border-slate-300"
                  />
                  <button type="button" class="btn ml-1 focus-ring" aria-expanded="false" aria-controls="pktSizeHelp" data-tooltip="pktSizeHelp" title="What is this?">?</button>
                </div>
                <p id="pktSizeHelp" class="tooltip text-xs text-slate-600 mt-1">Application payload bytes per packet (exclude lower-layer overhead). Used to estimate goodput.</p>
                <p id="pktSizeErr" class="mt-1 text-sm text-red-600" aria-live="polite"></p>
              </div>

              <!-- Protocol model -->
              <div>
                <label for="proto" class="block text-sm font-semibold">Goodput Model </label>
                <select id="proto" class="mt-1 block w-full px-3 py-2 border rounded-md focus-ring border-slate-300" aria-describedby="protoHelp">
                  <option value="udp">UDP / Raw (goodput ≈ payload × success rate)</option>
                  <option value="tcp">TCP (Mathis model approximation)</option>
                </select>
                <p id="protoHelp" class="text-xs text-slate-600 mt-1">Choose how to estimate goodput under loss.</p>
              </div>

              <!-- RTT -->
              <div>
                <label for="rtt" class="block text-sm font-semibold">RTT (ms, TCP only)</label>
                <div class="flex items-start gap-2">
                  <input type="number" inputmode="decimal" id="rtt" min="0" step="0.1" value="40"
                    aria-describedby="rttHelp rttErr"
                    class="mt-1 block w-full px-3 py-2 border rounded-md focus-ring border-slate-300"
                  />
                  <button type="button" class="btn ml-1 focus-ring" aria-expanded="false" aria-controls="rttHelp" data-tooltip="rttHelp" title="What is this?">?</button>
                </div>
                <p id="rttHelp" class="tooltip text-xs text-slate-600 mt-1">Round-trip time used by the TCP model. Ignored in UDP mode.</p>
                <p id="rttErr" class="mt-1 text-sm text-red-600" aria-live="polite"></p>
              </div>

              <!-- MSS -->
              <div>
                <label for="mss" class="block text-sm font-semibold">MSS (bytes, TCP only)</label>
                <div class="flex items-start gap-2">
                  <input type="number" inputmode="decimal" id="mss" min="1" step="1" value="1460"
                    aria-describedby="mssHelp mssErr"
                    class="mt-1 block w-full px-3 py-2 border rounded-md focus-ring border-slate-300"
                  />
                  <button type="button" class="btn ml-1 focus-ring" aria-expanded="false" aria-controls="mssHelp" data-tooltip="mssHelp" title="What is this?">?</button>
                </div>
                <p id="mssHelp" class="tooltip text-xs text-slate-600 mt-1">Maximum Segment Size (payload per TCP segment). Typical Ethernet+IPv4 path ≈ 1460 bytes.</p>
                <p id="mssErr" class="mt-1 text-sm text-red-600" aria-live="polite"></p>
              </div>
            </div>
          </section>

          <!-- 4) Results -->
          <section id="results" class="mt-8 bg-indigo-50 border border-indigo-100 rounded-xl p-6">
            <h2 class="sr-only">Results</h2>
            <div class="flex flex-col md:flex-row gap-6">
              <div class="w-full md:w-2/3 grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="result-card" role="status" aria-live="polite">
                  <h4>Loss Percentage</h4>
                  <p id="lossPct">0%</p>
                </div>
                <div class="result-card" role="status" aria-live="polite">
                  <h4>Loss Ratio</h4>
                  <p id="lossRatio">0</p>
                </div>
                <div class="result-card" role="status" aria-live="polite">
                  <h4>Success Rate</h4>
                  <p id="successRate">100%</p>
                </div>
                <div class="result-card" role="status" aria-live="polite">
                  <h4>Drops / second</h4>
                  <p id="dropsPerSec">0</p>
                </div>
                <div class="result-card" role="status" aria-live="polite">
                  <h4>Packets / second</h4>
                  <p id="pps">0</p>
                </div>
                <div class="result-card" role="status" aria-live="polite">
                  <h4>Estimated Goodput</h4>
                  <p id="goodput">0 Mb/s</p>
                </div>
              </div>
              <div class="w-full md:w-1/3" id="chartWrapper">
                <canvas id="lossChart" aria-label="Success vs Loss doughnut chart"></canvas>
              </div>
            </div>
            <details class="mt-6 bg-white rounded-lg">
              <summary class="font-semibold text-slate-800 px-4 py-3">Details &amp; raw metrics</summary>
              <div class="px-4 pb-4 pt-2 text-sm text-slate-700 grid gap-2">
                <div class="flex justify-between"><span>Sent:</span><span id="sentOut">—</span></div>
                <div class="flex justify-between"><span>Received:</span><span id="receivedOut">—</span></div>
                <div class="flex justify-between"><span>Lost:</span><span id="lostOut">—</span></div>
                <div class="flex justify-between"><span>Test duration:</span><span id="durOut">—</span></div>
                <div class="flex justify-between"><span>Model:</span><span id="modelOut">—</span></div>
              </div>
            </details>
          </section>
        </div>

        <!-- 5) Authoritative Ecosystem -->
        <article class="bg-white p-6 rounded-xl shadow-sm mt-8 prose">
          <h2>Data Source &amp; Methodology</h2>
          <p><strong>AuthoritativeDataSource:</strong></p>
          <ul>
            <li><strong>IETF RFC 2680</strong> — <em>A One-way Packet Loss Metric for IPPM</em> (September 1999). Defines rigorous loss metrics for Internet paths.</li>
            <li><strong>Mathis et al.</strong> — <em>The Macroscopic Behavior of the TCP Congestion Avoidance Algorithm</em> (Computer Communication Review, 1997). Provides the widely used TCP goodput approximation under loss.</li>
          </ul>
          <p><em>All calculations strictly follow the formulas and definitions from these sources or standard derivations thereof.</em></p>

          <h2>The Formula Explained</h2>
          <div class="formula-box">
            <p>Packet loss percentage:</p>
            <p>$$ \\text{Loss\\%} = \\frac{S - R}{S} \\times 100 $$</p>
            <p>Loss ratio (probability of loss):</p>
            <p>$$ p = \\frac{S - R}{S} $$</p>
            <p>Success rate:</p>
            <p>$$ 1 - p $$</p>
            <p>Packets per second (pps) and drops per second:</p>
            <p>$$ \\text{pps} = \\frac{S}{T}, \\quad \\text{drops/s} = \\frac{S - R}{T} $$</p>
            <p>Estimated UDP/Raw goodput (payload only):</p>
            <p>$$ G_{UDP} \\approx (1-p) \\cdot \\text{pps} \\cdot \\text{payloadBytes} \\cdot 8 $$</p>
            <p>Estimated TCP goodput (Mathis model, Reno-like):</p>
            <p>$$ G_{TCP} \\lesssim C \\cdot \\frac{\\text{MSS} \\cdot 8}{\\text{RTT}} \\cdot \\frac{1}{\\sqrt{p}} $$</p>
            <p>where \(C\\approx 1.22\), <em>RTT</em> in seconds, MSS in bytes. Results reported in bit/s and converted to Mb/s.</p>
          </div>

          <h2>Glossary of Variables</h2>
          <ul>
            <li><strong>S</strong> (Packets Sent): total packets transmitted in the test.</li>
            <li><strong>R</strong> (Packets Received): packets successfully received at the destination.</li>
            <li><strong>T</strong> (Duration): length of the test in seconds.</li>
            <li><strong>p</strong> (Loss Ratio): fraction of lost packets, between 0 and 1.</li>
            <li><strong>Success Rate</strong>: \(1-p\), packets that arrive successfully.</li>
            <li><strong>pps</strong>: packets per second = \(S/T\).</li>
            <li><strong>payloadBytes</strong>: application-level bytes per packet (exclude L2/L3/L4 overhead).</li>
            <li><strong>MSS</strong> (TCP): Maximum Segment Size, payload per TCP segment (bytes).</li>
            <li><strong>RTT</strong>: round-trip time for TCP (seconds).</li>
            <li><strong>Goodput</strong>: useful payload rate delivered to the application (Mb/s).</li>
          </ul>

          <h2>How It Works: A Step-by-Step Example</h2>
          <p><strong>Example inputs:</strong> S=10,000; R=9,950; T=10 s; payloadBytes=1200; UDP model.</p>
          <ol>
            <li>Loss ratio \(p=(10000-9950)/10000=0.005\) (0.5%). Success \(=1-p=0.995\).</li>
            <li>pps \(=10000/10=1000\\,\\text{pps}\); drops/s \((10000-9950)/10=5\\,\\text{drops/s}\).</li>
            <li>UDP goodput \(\approx 0.995\\times 1000 \\times 1200 \\times 8 \\approx 9{,}552{,}000\\,\\text{bit/s} \\approx 9.55\\,\\text{Mb/s}\).</li>
          </ol>
          <p>Switching to TCP with RTT=40 ms and MSS=1460 bytes, Mathis gives \(G_{TCP} \\lesssim 1.22 \\cdot (1460\\cdot8)/0.04 \\cdot 1/\\sqrt{0.005} \\approx 50\\,\\text{Mb/s}\) (upper bound; actual goodput may be lower due to slow start, ACKs, etc.).</p>

          <h2>Frequently Asked Questions</h2>
          <details>
            <summary>Is 0% packet loss realistic?</summary>
            <p>On short, clean paths it can be observed, but over time even excellent networks show occasional drops. Bursty loss can coexist with low average loss.</p>
          </details>
          <details>
            <summary>What loss is acceptable for streaming or VoIP?</summary>
            <p>Under ~1% is typically fine for adaptive streaming and many VoIP codecs. Jitter buffers and FEC can mitigate mild loss.</p>
          </details>
          <details>
            <summary>Do retransmissions affect goodput?</summary>
            <p>Yes. TCP retransmissions reduce goodput because repeated bytes consume capacity but don’t increase delivered payload.</p>
          </details>
          <details>
            <summary>Why does TCP goodput drop so fast with small increases in loss?</summary>
            <p>Congestion control reduces the congestion window in response to loss; the Mathis model captures the \(1/\\sqrt{p}\) sensitivity.</p>
          </details>
          <details>
            <summary>My tool shows no loss but audio still stutters. Why?</summary>
            <p>Latency spikes and jitter can harm real-time apps even when packet loss is low. Monitor delay/jitter alongside loss.</p>
          </details>
          <details>
            <summary>Should I test both directions?</summary>
            <p>Yes. Many paths are asymmetric; measure upstream and downstream separately.</p>
          </details>

          <div class="mt-6 p-4 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-600">
            <p><strong>Tool developed by Ugo Candido.</strong> Content verified by the CalcDomain Editorial Board.<br>
              Last accuracy review: <time datetime="2025-10-26">October 26, 2025</time></p>
          </div>
        </article>
      </section>

      <!-- Sidebar -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-6 space-y-6">
          <div class="bg-slate-200 h-72 rounded-xl flex items-center justify-center text-slate-600">
            Ad Placement (300×600)
          </div>

          <div class="bg-white p-6 rounded-xl shadow-sm">
            <h3 class="font-bold text-lg mb-3">Why this calculator stands out</h3>
            <ul class="list-disc list-inside text-sm text-slate-600 space-y-2">
              <li>Instant loss %, success rate, and rate metrics.</li>
              <li>Goodput estimation for UDP and TCP (Mathis model).</li>
              <li>Accessible UI with inline validation and LaTeX formulas.</li>
            </ul>
          </div>

          <div class="bg-white p-6 rounded-xl shadow-sm">
            <h3 class="font-bold text-lg mb-4">Related network tools</h3>
            <ul class="space-y-3 text-sm">
              <li><a href="jitter-latency-calculator.html" class="text-blue-700 hover:underline">Jitter &amp; Latency Calculator</a></li>
              <li><a href="bandwidth-delay-product.html" class="text-blue-700 hover:underline">Bandwidth-Delay Product</a></li>
              <li><a href="tcp-window-calculator.html" class="text-blue-700 hover:underline">TCP Window / Throughput</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-slate-600 text-sm">
      <p>&copy; 2025 CalcDomain. All rights reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-700 focus-ring">About</a>
        <a href="contact.html" class="hover:text-blue-700 focus-ring">Contact</a>
        <a href="privacy.html" class="hover:text-blue-700 focus-ring">Privacy</a>
        <a href="terms.html" class="hover:text-blue-700 focus-ring">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator Logic (defer-like placement: end of body) -->
  <script>
  (function() {
    const $ = (id) => document.getElementById(id);

    const els = {
      sent: $('sent'),
      received: $('received'),
      duration: $('duration'),
      pktSize: $('pktSize'),
      proto: $('proto'),
      rtt: $('rtt'),
      mss: $('mss'),
      // errors
      sentErr: $('sentErr'),
      receivedErr: $('receivedErr'),
      durationErr: $('durationErr'),
      pktSizeErr: $('pktSizeErr'),
      rttErr: $('rttErr'),
      mssErr: $('mssErr'),
      // outputs
      lossPct: $('lossPct'),
      lossRatio: $('lossRatio'),
      successRate: $('successRate'),
      dropsPerSec: $('dropsPerSec'),
      pps: $('pps'),
      goodput: $('goodput'),
      sentOut: $('sentOut'),
      receivedOut: $('receivedOut'),
      lostOut: $('lostOut'),
      durOut: $('durOut'),
      modelOut: $('modelOut'),
      // chart
      lossChart: $('lossChart')
    };

    // Mobile menu
    const mobileBtn = $('mobileMenuBtn'), mobileMenu = $('mobileMenu');
    if (mobileBtn && mobileMenu) {
      mobileBtn.addEventListener('click', () => {
        const open = mobileMenu.classList.toggle('hidden') ? 'false' : 'true';
        mobileBtn.setAttribute('aria-expanded', open);
      });
    }

    // Accessible tooltips
    document.querySelectorAll('[data-tooltip]').forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.getAttribute('data-tooltip');
        const tip = document.getElementById(id);
        const open = tip.getAttribute('data-open') === 'true';
        tip.setAttribute('data-open', String(!open));
        btn.setAttribute('aria-expanded', String(!open));
      });
      btn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); btn.click(); }
      });
    });

    // Validation (on blur)
    const validators = {
      sent(v) { if (!(v>=0)) return 'Enter a non-negative number.'; },
      received(v, state) {
        if (!(v>=0)) return 'Enter a non-negative number.';
        if (state.sent !== undefined && v > state.sent) return 'Received cannot exceed Sent.';
      },
      duration(v) { if (!(v>0)) return 'Duration must be greater than 0 seconds.'; },
      pktSize(v) { if (v === '' || v === null) return; if (!(v>=0)) return 'Enter bytes ≥ 0.'; },
      rtt(v, state){ if (state.proto==='tcp' && !(v>=0)) return 'RTT must be ≥ 0 ms for TCP.'; },
      mss(v, state){ if (state.proto==='tcp' && !(v>=1)) return 'MSS must be ≥ 1 byte for TCP.'; },
    };

    function showError(el, errEl, msg) {
      errEl.textContent = msg || '';
      el.setAttribute('aria-invalid', msg ? 'true' : 'false');
    }

    ['sent','received','duration','pktSize','rtt','mss'].forEach(id => {
      const el = els[id];
      const err = els[id+'Err'];
      el.addEventListener('blur', () => {
        const state = {...getInputs()};
        const v = parseFloat(el.value);
        const msg = validators[id]?.(v, state);
        showError(el, err, msg);
      });
    });

    function getInputs() {
      return {
        sent: parseFloat(els.sent.value),
        received: parseFloat(els.received.value),
        duration: parseFloat(els.duration.value),
        pktSize: els.pktSize.value === '' ? null : parseFloat(els.pktSize.value),
        proto: els.proto.value,
        rtt: parseFloat(els.rtt.value),
        mss: parseFloat(els.mss.value)
      };
    }

    let chart;
    function renderChart(successPct, lossPct) {
      if (!els.lossChart) return;
      const data = {
        labels: ['Success', 'Loss'],
        datasets: [{ data: [successPct, lossPct] }]
      };
      if (chart) {
        chart.data = data; chart.update();
      } else if (window.Chart) {
        chart = new Chart(els.lossChart.getContext('2d'), {
          type: 'doughnut',
          data,
          options: {
            plugins: { legend: { position: 'bottom' }, tooltip: { intersect:false } },
            responsive: true,
            maintainAspectRatio: false
          }
        });
      }
    }

    const fmtPct = (x) => (isFinite(x)? (x*100).toFixed(3)+'%':'—');
    const fmtRatio = (x) => (isFinite(x)? x.toFixed(6):'—');
    const fmtInt = (x) => (isFinite(x)? new Intl.NumberFormat().format(Math.round(x)):'—');
    const fmtFixed = (x, d=3) => (isFinite(x)? Number(x).toFixed(d):'—');
    const fmtMbps = (bitsPerSec) => {
      if (!isFinite(bitsPerSec) || bitsPerSec<0) return '—';
      const mbps = bitsPerSec/1e6;
      return mbps >= 100 ? mbps.toFixed(1)+' Mb/s' : mbps.toFixed(3)+' Mb/s';
    };

    function compute() {
      const state = getInputs();

      // Basic guard
      const errs = {
        sent: validators.sent(state.sent),
        received: validators.received(state.received, state),
        duration: validators.duration(state.duration),
        rtt: validators.rtt(state.rtt, state),
        mss: validators.mss(state.mss, state),
        pktSize: validators.pktSize(state.pktSize)
      };

      showError(els.sent, els.sentErr, errs.sent);
      showError(els.received, els.receivedErr, errs.received);
      showError(els.duration, els.durationErr, errs.duration);
      showError(els.rtt, els.rttErr, errs.rtt);
      showError(els.mss, els.mssErr, errs.mss);
      showError(els.pktSize, els.pktSizeErr, errs.pktSize);

      if (Object.values(errs).some(Boolean)) return; // don't compute with invalid state

      const S = state.sent, R = state.received, T = state.duration;
      const lost = Math.max(0, S - R);
      const p = S > 0 ? lost / S : 0;
      const success = 1 - p;
      const pps = T > 0 ? S / T : 0;
      const dropsPerSec = T > 0 ? lost / T : 0;

      // Goodput
      let goodput_bps = 0;
      if (state.proto === 'udp') {
        if (state.pktSize !== null) {
          goodput_bps = success * pps * state.pktSize * 8;
        } else {
          goodput_bps = 0; // unknown payload
        }
      } else {
        // TCP Mathis: G <= C * (MSS*8)/RTT / sqrt(p)
        const C = 1.22;
        const rttSec = (state.rtt||0)/1000;
        if (p > 0 && rttSec > 0 && state.mss > 0) {
          goodput_bps = C * (state.mss*8) / rttSec / Math.sqrt(p);
        } else {
          goodput_bps = 0;
        }
      }

      // Update UI
      els.lossPct.textContent = fmtPct(p);
      els.lossRatio.textContent = fmtRatio(p);
      els.successRate.textContent = fmtPct(success);
      els.pps.textContent = fmtInt(pps);
      els.dropsPerSec.textContent = fmtFixed(dropsPerSec, 3);
      els.goodput.textContent = fmtMbps(goodput_bps);

      els.sentOut.textContent = fmtInt(S);
      els.receivedOut.textContent = fmtInt(R);
      els.lostOut.textContent = fmtInt(lost);
      els.durOut.textContent = fmtFixed(T, 3) + ' s';
      els.modelOut.textContent = state.proto === 'udp' ? 'UDP / Raw' : `TCP (Mathis, RTT=${fmtFixed((state.rtt||0),1)} ms, MSS=${fmtInt(state.mss||0)} B)`;

      renderChart(success*100, p*100);
    }

    // Bind inputs (input for responsiveness; blur handles validation)
    ['sent','received','duration','pktSize','proto','rtt','mss'].forEach(id => {
      els[id].addEventListener('input', compute);
    });

    // Initialize after Chart.js loads
    window.addEventListener('load', compute);
  })();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CPM Calculator - Calculate Ad Cost, Impressions, or CPM</title>
<meta name="description" content="Calculate CPM (Cost Per Mille), total ad cost, or impressions. This tool helps marketers and advertisers budget campaigns and understand media pricing.">
<link rel="canonical" href="https://calcdomain.com/cpm-calculator.html"/>

<script src="https://cdn.tailwindcss.com"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.5rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1.5rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
text-align: center; font-size: 1.1rem;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.5rem 2rem; text-align: center; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -1px rgba(0,0,0,0.03); }
.result-card h4 { font-size: 1.1rem; font-weight: 500; color: #6b7280; margin-bottom: 0.5rem; }
.result-card p { font-size: 2.5rem; font-weight: 700; color: #2563eb; }
/* Custom focus state */
.form-input:focus, .form-select:focus, .form-radio:focus, .tooltip-btn:focus {
outline: 3px solid #3b82f6;
outline-offset: 2px;
box-shadow: none;
border-color: #3b82f6;
}
/* Error state */
.form-input.invalid {
border-color: #dc2626;
background-color: #fee2e2;
}
.error-message {
color: #b91c1c;
font-size: 0.875rem;
margin-top: 0.25rem;
}
/* Accessible Tooltip */
.tooltip-btn {
display: inline-flex;
align-items: center;
justify-content: center;
width: 1.25rem;
height: 1.25rem;
border-radius: 9999px;
background: #e5e7eb;
color: #4b5563;
border: 1px solid #d1d5db;
font-weight: 700;
font-size: 0.8rem;
cursor: pointer;
margin-left: 0.5rem;
}
.tooltip-text {
background: #111827;
color: #f9fafb;
padding: 0.5rem 0.75rem;
border-radius: 6px;
font-size: 0.875rem;
margin-top: 0.5rem;
position: relative;
z-index: 10;
width: 100%;
}
.hidden { display: none; }
@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
}
</style>

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "WebPage",
"name": "CPM Calculator",
"description": "Calculate CPM (Cost Per Mille), total ad cost, or impressions. This tool helps marketers and advertisers budget campaigns and understand media pricing.",
"url": "https://calcdomain.com/cpm-calculator.html",
"inLanguage": "en",
"author": { "@type": "Person", "name": "Ugo Candido" },
"publisher": { "@type": "Organization", "name": "CalcDomain" }
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "BreadcrumbList",
"itemListElement": [
{ "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/" },
{ "@type": "ListItem", "position": 2, "name": "Lifestyle Everyday", "item": "https://calcdomain.com/lifestyle-everyday.html" },
{ "@type": "ListItem", "position": 3, "name": "Miscellaneous", "item": "https://calcdomain.com/subcategories/miscellaneous.html" },
{ "@type": "ListItem", "position": 4, "name": "CPM Calculator", "item": "https://calcdomain.com/cpm-calculator.html" }
]
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "HowTo",
"name": "How to Use the CPM Calculator",
"description": "A step-by-step guide to calculating CPM, Total Cost, or Ad Impressions.",
"step": [
{"@type": "HowToStep", "name": "Select Calculation Goal", "text": "Choose whether you want to calculate CPM, Total Cost, or Ad Impressions using the radio buttons."},
{"@type": "HowToStep", "name": "Enter Known Variables", "text": "Input the two values you already know into the corresponding fields."},
{"@type": "HowToStep", "name": "Review Instant Results", "text": "The calculator automatically computes the third value and displays it in the results panel."}
]
}
</script>
<script src="search.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">
<div class="flex justify-between items-center">
<a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

<div class="w-full max-w-md hidden md:block mx-8">
<div class="relative">
<input type="search" id="search-input" placeholder="Search for a calculator..."
class="w-full py-2 px-4 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
autocomplete="off">
<svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
</svg>
<div id="search-results" class="absolute top-full left-0 right-0 hidden bg-white border border-gray-200 rounded-lg shadow-lg mt-2 max-h-96 overflow-y-auto z-50"></div>
</div>
</div>

<div class="hidden md:flex items-center space-x-6 text-sm">
<a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
</div>

<button id="mobile-menu-toggle" class="md:hidden p-2" aria-label="Open menu" aria-expanded="false">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M4 6h16M4 12h16M4 18h16"></path>
</svg>
</button>
</div>

<div id="mobile-menu" class="md:hidden mt-4 hidden">
<div class="space-y-2">
<a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
</div>
</div>
</nav>
</header>

<main class="container mx-auto px-4 lg:px-6 py-10">
<div class="flex flex-col lg:flex-row gap-8">

<section class="w-full lg:w-2/3">
<nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
<a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
<a href="lifestyle-everyday.html" class="hover:text-blue-600">Lifestyle Everyday</a> &raquo;
<a href="subcategories/miscellaneous.html" class="hover:text-blue-600">Miscellaneous</a> &raquo;
<span class="text-gray-900">CPM Calculator</span>
</nav>

<div id="print-section" class="bg-white p-6 md:p-8 rounded-lg shadow-md">
<h1 class="text-3xl font-extrabold text-gray-900 mb-2">CPM Calculator</h1>
<p class="text-gray-600 mb-6">Easily calculate Cost Per Mille (CPM), total advertising cost, or ad impressions. This tool is designed for marketers, advertisers, and publishers to quickly budget campaigns and understand media pricing based on two known variables.</p>

<section id="calculator-ui" class="space-y-6">
<fieldset>
<legend class="block text-base font-medium text-gray-900 mb-3">1. What do you want to calculate?</legend>
<div class="flex flex-col sm:flex-row sm:space-x-6 space-y-2 sm:space-y-0">
<div class="flex items-center">
<input id="calcOptionCPM" name="calcOption" type="radio" value="cpm" checked
class="form-radio h-4 w-4 text-blue-600 border-gray-300">
<label for="calcOptionCPM" class="ml-2 block text-sm text-gray-700">Calculate CPM</label>
</div>
<div class="flex items-center">
<input id="calcOptionCost" name="calcOption" type="radio" value="cost"
class="form-radio h-4 w-4 text-blue-600 border-gray-300">
<label for="calcOptionCost" class="ml-2 block text-sm text-gray-700">Calculate Total Cost</label>
</div>
<div class="flex items-center">
<input id="calcOptionImpressions" name="calcOption" type="radio" value="impressions"
class="form-radio h-4 w-4 text-blue-600 border-gray-300">
<label for="calcOptionImpressions" class="ml-2 block text-sm text-gray-700">Calculate Ad Impressions</label>
</div>
</div>
</fieldset>

<div class="border-t border-gray-200 pt-6 space-y-4">
<h3 class="text-base font-medium text-gray-900">2. Enter your known values</h3>
<div>
<div class="flex items-center justify-between">
<label for="totalCostInput" class="block text-sm font-medium text-gray-700">Total Ad Cost ($) <span class="text-red-500">*</span></label>
<button type="button" class="tooltip-btn" aria-label="More info on Total Ad Cost" aria-controls="cost-tooltip" aria-expanded="false">?</button>
</div>
<input type="number" id="totalCostInput" min="0" step="0.01"
class="form-input mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none"
aria-required="true" aria-describedby="cost-tooltip cost-error">
<div id="cost-tooltip" class="tooltip-text hidden" role="tooltip">
The total amount of money spent on the advertising campaign.
</div>
<div id="cost-error" class="error-message" role="alert"></div>
</div>

<div>
<div class="flex items-center justify-between">
<label for="impressionsInput" class="block text-sm font-medium text-gray-700">Ad Impressions <span class="text-red-500">*</span></label>
<button type="button" class="tooltip-btn" aria-label="More info on Ad Impressions" aria-controls="impressions-tooltip" aria-expanded="false">?</button>
</div>
<input type="number" id="impressionsInput" min="0" step="1000"
class="form-input mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none"
aria-required="true" aria-describedby="impressions-tooltip impressions-error">
<div id="impressions-tooltip" class="tooltip-text hidden" role="tooltip">
The total number of times the ad was displayed.
</div>
<div id="impressions-error" class="error-message" role="alert"></div>
</div>

<div>
<div class="flex items-center justify-between">
<label for="cpmInput" class="block text-sm font-medium text-gray-700">CPM ($) <span class="text-red-500">*</span></label>
<button type="button" class="tooltip-btn" aria-label="More info on CPM" aria-controls="cpm-tooltip" aria-expanded="false">?</button>
</div>
<input type="number" id="cpmInput" min="0" step="0.01"
class="form-input mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none"
aria-required="true" aria-describedby="cpm-tooltip cpm-error">
<div id="cpm-tooltip" class="tooltip-text hidden" role="tooltip">
Cost Per Mille, or the cost per 1,000 ad impressions.
</div>
<div id="cpm-error" class="error-message" role="alert"></div>
</div>
</div>
</section>

<section id="results-container" class="mt-8">
<h3 class="text-xl font-semibold text-gray-900 mb-4">Your Result</h3>
<div id="results" class="bg-blue-50 border border-blue-100 rounded-lg p-6 min-h-[12rem] flex items-center justify-center">
<div class="result-card w-full max-w-sm">
<h4 id="result-label" class="text-lg">Calculated CPM</h4>
<p id="result-value" class="text-4xl">$0.00</p>
</div>
</div>
</section>
</div>

<article class="bg-white p-6 md:p-8 rounded-lg shadow-md mt-8 prose">
<section>
<h2>Data Source and Methodology</h2>
<p>This calculator uses standard, universally accepted formulas in the digital advertising industry. The methodology is based on the principles outlined by the Interactive Advertising Bureau (IAB).</p>
<ul>
<li><strong>Authoritative Source:</strong> Interactive Advertising Bureau (IAB) - 'Digital Ad Impression Measurement Guidelines'</li>
<li><strong>Reference:</strong> IAB-M-01.2 (Last update: June 2024)</li>
<li><strong>Source Link:</strong> <a href="https://www.iab.com/" target="_blank" rel="noopener nofollow">iab.com</a></li>
</ul>
<p>All calculations are strictly based on the standard industry formulas defined by this source.</p>
</section>

<section>
<h2>The Formulas Explained</h2>
<p>The relationship between Cost, Impressions, and CPM is defined by three core formulas. This calculator rearranges the formula based on the value you wish to find.</p>

<h3>1. To Calculate CPM (Cost Per Mille)</h3>
<p>This formula finds the cost for every 1,000 impressions.</p>
<div class="formula-box" aria-label="CPM Formula">
$$ \text{CPM} = \left( \frac{\text{Total Cost}}{\text{Ad Impressions}} \right) \times 1,000 $$
</div>

<h3>2. To Calculate Total Ad Cost</h3>
<p>This formula finds the total budget required for a given CPM and number of impressions.</p>
<div class="formula-box" aria-label="Total Cost Formula">
$$ \text{Total Cost} = \left( \frac{\text{CPM} \times \text{Ad Impressions}}{1,000} \right) $$
</div>

<h3>3. To Calculate Ad Impressions</h3>
<p>This formula finds how many impressions you can buy with a specific budget and CPM.</p>
<div class="formula-box" aria-label="Ad Impressions Formula">
$$ \text{Ad Impressions} = \left( \frac{\text{Total Cost}}{\text{CPM}} \right) \times 1,000 $$
</div>
</section>

<section>
<h2>Glossary of Variables</h2>
<dl>
<dt class="font-semibold">CPM (Cost Per Mille)</dt>
<dd class="mb-2">The price an advertiser pays for one thousand views or "impressions" of an advertisement. "Mille" is Latin for thousand.</dd>

<dt class="font-semibold">Total Ad Cost</dt>
<dd class="mb-2">The total amount of money spent on an advertising campaign. This is your total budget.</dd>

<dt class="font-semibold">Ad Impressions</dt>
<dd class="mb-2">The total number of times an ad is fetched from its source and displayed on a web page. One impression equals one view.</dd>
</dl>
</section>

<section>
<h2>How It Works: A Step-by-Step Example</h2>
<p>Let's walk through a common scenario where you need to find the CPM.</p>
<p><strong>Scenario:</strong> You are a marketer who just ran a campaign. You need to report on its efficiency.</p>
<ul>
<li><strong>Known Value 1 (Total Cost):</strong> You spent $5,000.</li>
<li><strong>Known Value 2 (Ad Impressions):</strong> Your ad server reported 2,000,000 impressions.</li>
</ul>

<p><strong>Step 1: Use the CPM Formula</strong>
<br>
Using the formula: $ \text{CPM} = ( \text{Total Cost} / \text{Ad Impressions} ) \times 1,000 $</p>

<p><strong>Step 2: Plug in your values</strong>
<br>
$ \text{CPM} = ( \$5,000 / 2,000,000 ) \times 1,000 $</p>

<p><strong>Step 3: Calculate the cost per impression</strong>
<br>
$ \$5,000 \div 2,000,000 = \$0.0025 $ per impression.</p>

<p><strong>Step 4: Multiply by 1,000</strong>
<br>
$ \$0.0025 \times 1,000 = \$2.50 $</p>

<p><strong>Result:</strong> Your campaign's CPM was <strong>$2.50</strong>. This means you paid $2.50 for every 1,000 times your ad was shown.</p>
</section>

<section>
<h2>Frequently Asked Questions (FAQ)</h2>
<details>
<summary>What is CPM and why is it 'per mille'?</summary>
<p>CPM stands for "Cost Per Mille." "Mille" is the Latin word for "thousand." Therefore, CPM is the cost an advertiser pays for 1,000 views or impressions of an advertisement. It's a standard pricing model in digital advertising.</p>
</details>
<details>
<summary>Is a high or low CPM better?</summary>
<p>It depends on your goals.
<br><strong>A low CPM</strong> is generally better for advertisers, as it means they are paying less to show their ad 1,000 times. This is ideal for broad brand awareness campaigns.
<br><strong>A high CPM</strong> is often better for publishers (the website owners), as it means they are earning more revenue. A high CPM can also indicate a very valuable, niche, or high-intent audience, which might be more effective for advertisers despite the higher cost.</p>
</details>
<details>
<summary>What is the difference between CPM and CPC?</summary>
<p><strong>CPM (Cost Per Mille)</strong> is a pricing model based on impressions (views). You pay for your ad to be seen.
<br><strong>CPC (Cost Per Click)</strong> is a pricing model based on actions. You only pay when a user actually clicks on your ad. CPM is used for awareness, while CPC is used for driving traffic or direct response.</p>
</details>
<details>
<summary>What is a "good" CPM rate?</summary>
<p>A "good" CPM varies dramatically by industry, platform (e.g., Google, Facebook, TikTok), ad format (e.g., display, video), and geographic location. A CPM on Facebook for a broad audience might be $5, while a CPM for a highly targeted B2B audience on LinkedIn could be $50 or more.</p>
</details>
<details>
<summary>What are 'ad impressions' vs. 'reach'?</summary>
<p><strong>Impressions</strong> are the total number of times an ad is displayed. If one person sees the same ad 5 times, that counts as 5 impressions.
<br><strong>Reach</strong> is the number of unique people who saw your ad at least once. If one person sees the ad 5 times, the reach is 1.</p>
</details>
<details>
<summary>How can I lower my CPM as an advertiser?</summary>
<p>You can try to lower your CPM by:
<br>1. <strong>Improving Ad Quality:</strong> Platforms reward high-quality, relevant ads with lower costs.
<br>2. <strong>Refining Targeting:</strong> Broadening your audience (if it's too narrow) or refining it (if it's not relevant) can improve competition and cost.
<br>3. <strong>Testing Different Ad Formats:</strong> Sometimes, display ads are cheaper than video ads, or vice-versa.
<br>4. <strong>Adjusting Bids:</strong> Manually lowering your bid caps can reduce your CPM, though it may also reduce your ad delivery.</p>
</details>
</section>

<div class="mt-8 pt-4 border-t border-gray-200 text-sm text-gray-600">
<p><strong>Tool developed by Ugo Candido.</strong> Marketing content verified by the CalcDomain Editorial Board.<br>
Last accuracy review: <time datetime="2025-10-26">October 26, 2025</time></p>
</div>
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300×600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why use this calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Solve for any variable: CPM, Cost, or Impressions.</li>
<li>Instantly budget for media buys and advertising campaigns.</li>
<li>Understand the core formulas used in media planning.</li>
<li>Get definitions and examples to build your marketing knowledge.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Marketing Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="cpc-calculator.html" class="text-blue-600 hover:underline">CPC (Cost Per Click) Calculator</a></li>
<li><a href="ctr-calculator.html" class="text-blue-600 hover:underline">CTR (Click-Through Rate) Calculator</a></li>
<li><a href="roas-calculator.html" class="text-blue-600 hover:underline">ROAS (Return on Ad Spend) Calculator</a></li>
<li><a href="conversion-rate-calculator.html" class="text-blue-600 hover:underline">Conversion Rate Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-white border-t mt-12">
<div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
<p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
<div class="mt-4 space-x-4">
<a href="about.html" class="hover:text-blue-600">About</a>
<a href="contact.html" class="hover:text-blue-600">Contact</a>
<a href="privacy.html" class="hover:text-blue-600">Privacy</a>
<a href="terms.html" class="hover:text-blue-600">Terms</a>
</div>
</div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- Mobile Menu Logic ---
    const toggleBtn = document.getElementById('mobile-menu-toggle');
    const menu = document.getElementById('mobile-menu');
    if (toggleBtn && menu) {
        toggleBtn.addEventListener('click', () => {
            const isHidden = menu.classList.toggle('hidden');
            toggleBtn.setAttribute('aria-expanded', !isHidden);
        });
    }

    // --- Tooltip Logic ---
    document.querySelectorAll('.tooltip-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const tooltipId = btn.getAttribute('aria-controls');
            const tooltip = document.getElementById(tooltipId);
            if (tooltip) {
                const isHidden = tooltip.classList.toggle('hidden');
                btn.setAttribute('aria-expanded', !isHidden);
            }
        });
    });

    // --- Calculator Logic ---
    const elements = {
        radios: document.querySelectorAll('input[name="calcOption"]'),
        totalCostInput: document.getElementById('totalCostInput'),
        impressionsInput: document.getElementById('impressionsInput'),
        cpmInput: document.getElementById('cpmInput'),
        
        costError: document.getElementById('cost-error'),
        impressionsError: document.getElementById('impressions-error'),
        cpmError: document.getElementById('cpm-error'),
        
        resultLabel: document.getElementById('result-label'),
        resultValue: document.getElementById('result-value')
    };

    const fmtCurrency = (val) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(val || 0);
    const fmtNumber = (val) => new Intl.NumberFormat('en-US', { maximumFractionDigits: 0 }).format(val || 0);

    function showError(inputEl, errorEl, message) {
        if (errorEl && inputEl) {
            errorEl.textContent = message;
            inputEl.classList.add('invalid');
            inputEl.setAttribute('aria-invalid', 'true');
        }
    }

    function clearErrors() {
        showError(elements.totalCostInput, elements.costError, '');
        showError(elements.impressionsInput, elements.impressionsError, '');
        showError(elements.cpmInput, elements.cpmError, '');
        elements.totalCostInput.classList.remove('invalid');
        elements.impressionsInput.classList.remove('invalid');
        elements.cpmInput.classList.remove('invalid');
        elements.totalCostInput.removeAttribute('aria-invalid');
        elements.impressionsInput.removeAttribute('aria-invalid');
        elements.cpmInput.removeAttribute('aria-invalid');
    }

    function calculate() {
        clearErrors();
        
        const cost = parseFloat(elements.totalCostInput.value) || 0;
        const impressions = parseFloat(elements.impressionsInput.value) || 0;
        const cpm = parseFloat(elements.cpmInput.value) || 0;
        
        const calcMode = document.querySelector('input[name="calcOption"]:checked').value;
        let valid = true;
        
        if (calcMode === 'cpm') {
            if (cost <= 0) {
                showError(elements.totalCostInput, elements.costError, 'Total Cost must be greater than 0.');
                valid = false;
            }
            if (impressions <= 0) {
                showError(elements.impressionsInput, elements.impressionsError, 'Impressions must be greater than 0.');
                valid = false;
            }
            if (valid) {
                const result = (cost / impressions) * 1000;
                elements.cpmInput.value = result.toFixed(2);
                elements.resultLabel.textContent = 'Calculated CPM';
                elements.resultValue.textContent = fmtCurrency(result);
            } else {
                elements.resultValue.textContent = '—';
            }
            
        } else if (calcMode === 'cost') {
            if (impressions <= 0) {
                showError(elements.impressionsInput, elements.impressionsError, 'Impressions must be greater than 0.');
                valid = false;
            }
            if (cpm <= 0) {
                showError(elements.cpmInput, elements.cpmError, 'CPM must be greater than 0.');
                valid = false;
            }
            if (valid) {
                const result = (cpm * impressions) / 1000;
                elements.totalCostInput.value = result.toFixed(2);
                elements.resultLabel.textContent = 'Calculated Total Cost';
                elements.resultValue.textContent = fmtCurrency(result);
            } else {
                elements.resultValue.textContent = '—';
            }
            
        } else if (calcMode === 'impressions') {
            if (cost <= 0) {
                showError(elements.totalCostInput, elements.costError, 'Total Cost must be greater than 0.');
                valid = false;
            }
            if (cpm <= 0) {
                showError(elements.cpmInput, elements.cpmError, 'CPM must be greater than 0.');
                valid = false;
            }
            if (valid) {
                const result = (cost / cpm) * 1000;
                elements.impressionsInput.value = result.toFixed(0);
                elements.resultLabel.textContent = 'Calculated Ad Impressions';
                elements.resultValue.textContent = fmtNumber(result);
            } else {
                elements.resultValue.textContent = '—';
            }
        }
    }

    function updateCalculatorState() {
        const calcMode = document.querySelector('input[name="calcOption"]:checked').value;
        
        // Reset all inputs
        elements.totalCostInput.disabled = false;
        elements.totalCostInput.readOnly = false;
        elements.totalCostInput.setAttribute('aria-required', 'true');
        elements.totalCostInput.labels[0].querySelector('span').classList.remove('hidden');
        
        elements.impressionsInput.disabled = false;
        elements.impressionsInput.readOnly = false;
        elements.impressionsInput.setAttribute('aria-required', 'true');
        elements.impressionsInput.labels[0].querySelector('span').classList.remove('hidden');
        
        elements.cpmInput.disabled = false;
        elements.cpmInput.readOnly = false;
        elements.cpmInput.setAttribute('aria-required', 'true');
        elements.cpmInput.labels[0].querySelector('span').classList.remove('hidden');
        
        // Disable the one being calculated
        if (calcMode === 'cpm') {
            elements.cpmInput.disabled = true;
            elements.cpmInput.readOnly = true;
            elements.cpmInput.removeAttribute('aria-required');
            elements.cpmInput.labels[0].querySelector('span').classList.add('hidden');
            elements.resultLabel.textContent = 'Calculated CPM';
        } else if (calcMode === 'cost') {
            elements.totalCostInput.disabled = true;
            elements.totalCostInput.readOnly = true;
            elements.totalCostInput.removeAttribute('aria-required');
            elements.totalCostInput.labels[0].querySelector('span').classList.add('hidden');
            elements.resultLabel.textContent = 'Calculated Total Cost';
        } else if (calcMode === 'impressions') {
            elements.impressionsInput.disabled = true;
            elements.impressionsInput.readOnly = true;
            elements.impressionsInput.removeAttribute('aria-required');
            elements.impressionsInput.labels[0].querySelector('span').classList.add('hidden');
            elements.resultLabel.textContent = 'Calculated Ad Impressions';
        }
        
        calculate(); // Recalculate with new state
    }

    // Add event listeners
    elements.radios.forEach(radio => radio.addEventListener('change', updateCalculatorState));
    [elements.totalCostInput, elements.impressionsInput, elements.cpmInput].forEach(input => {
        input.addEventListener('input', calculate);
    });

    // Initial setup
    updateCalculatorState();
});
</script>
</body>
</html>
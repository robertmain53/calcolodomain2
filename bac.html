<!DOCTYPE html>
<html lang="en">
<head> 
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta charset="utf-8"/>
    <title>Blood Alcohol Content (BAC) Calculator</title>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta content="Professional-grade BAC calculator. Estimate Blood Alcohol Content using the Widmark formula with customizable drinks, units (US/Metric), sex, weight, and drinking duration. Educational tool to support safer decisions." name="description"/>
    <meta content="Ugo Candido" name="author"/>
    <link href="https://calcdomain.com/bac.html" rel="canonical"/>
    <meta content="#ffffff" name="theme-color"/>
    <meta content="bac calculator, blood alcohol content calculator, estimate BAC, Widmark formula" name="keywords"/>

    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .prose { max-width: 65ch; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .formula-box { 
            background: #f3f4f6; 
            border: 1px solid #d1d5db; 
            border-radius: 8px; 
            padding: 1rem; 
            overflow-x: auto; 
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            margin: 1rem 0;
            /* Added for MathJax rendering */
            font-size: 1.1rem;
            text-align: center;
        }
        details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
        details[open] > summary { margin-bottom: 0.5rem; }
        .help-tooltip { 
            display: inline-block; 
            width: 20px; 
            height: 20px; 
            background: #e0e7ff; 
            color: #3730a3; 
            border: 1px solid #c7d2fe;
            border-radius: 50%; 
            text-align: center; 
            line-height: 18px; 
            font-size: 12px; 
            font-weight: 700;
            cursor: help; 
            margin-left: 4px;
        }
        /* Preserve tooltip functionality from original JS */
        .tooltip { position:relative; display:inline-block; }
        .tooltip-content {
            display: none;
            position: absolute;
            z-index: 10;
            bottom: 125%; /* Position above the tooltip */
            left: 50%;
            transform: translateX(-50%);
            width: 280px;
            margin-bottom: 0.5rem;
            background: #1f2937; /* Dark background */
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 0.75rem;
            color: #f3f4f6; /* Light text */
            font-size: 0.875rem;
            font-weight: 400;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tooltip[aria-expanded="true"] .tooltip-content { display:block; }

    </style>

    <script type="application/ld+json">{
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "Blood Alcohol Content (BAC) Calculator",
      "description": "Professional-grade BAC calculator using the Widmark formula. Add custom drinks, switch US/Metric units, and estimate time to 0.00% BAC. Educational tool for safer decisions.",
      "url": "https://calcdomain.com/bac.html",
      "inLanguage": "en",
      "about": [
        { "@type": "Thing", "name": "Health and Fitness" },
        { "@type": "Thing", "name": "Medical" },
        { "@type": "Thing", "name": "BAC Calculator" }
      ],
      "author": { "@type": "Person", "name": "Ugo Candido" },
      "publisher": { "@type": "Organization", "name": "CalcDomain" },
      "mainEntity": [
        {
          "@type": "HowTo",
          "name": "Estimate your BAC using the Widmark formula",
          "description": "Worked example showing how to compute BAC from standard drinks, body weight, sex, and drinking duration.",
          "step": [
            { "@type": "HowToStep", "name": "Add drinks", "text": "Add two 12 fl oz beers at 5% ABV (US units). Total pure alcohol volume = 2 × 12 × 0.05 = 1.2 fl oz." },
            { "@type": "HowToStep", "name": "Enter body data", "text": "Select Sex = Male (r = 0.73), Weight = 180 lb, Hours since first drink = 1.5, Metabolism rate β = 0.015% per hour." },
            { "@type": "HowToStep", "name": "Apply Widmark formula", "text": "Initial BAC = (A × 5.14) / (W × r) = (1.2 × 5.14) / (180 × 0.73) ≈ 0.0472. Subtract metabolic reduction: 0.0472 − 0.015 × 1.5 = 0.0247 ≈ 0.025% BAC." },
            { "@type": "HowToStep", "name": "Interpret results", "text": "At ~0.025% BAC, you may still experience impairment. Estimated time to 0.00% ≈ 1.7 hours at β = 0.015." }
          ],
          "totalTime": "PT1M"
        },
        {
          "@type": "FAQPage",
          "mainEntity": [
            { "@type": "Question", "name": "How accurate is this BAC calculator?", "acceptedAnswer": { "@type": "Answer", "text": "It uses the Widmark equation and standard elimination rates. Individual metabolism, health, food intake, and medication can cause significant variation. Treat results as estimates, not medical or legal advice." } },
            { "@type": "Question", "name": "What is a standard drink?", "acceptedAnswer": { "@type": "Answer", "text": "In the U.S., one standard drink contains about 14 grams of pure alcohol: roughly 12 fl oz of regular beer (5% ABV), 5 fl oz of wine (12% ABV), or 1.5 fl oz of distilled spirits (40% ABV)." } },
            { "@type": "Question", "name": "What is the elimination rate (β)?", "acceptedAnswer": { "@type": "Answer", "text": "β is the average rate at which the body metabolizes alcohol, usually assumed to be about 0.015% BAC per hour, but it can range roughly from 0.010 to 0.025 depending on individual factors." } },
            { "@type": "Question", "name": "Does eating food change the result?", "acceptedAnswer": { "@type": "Answer", "text": "Food can slow absorption and change peak timing, but most simple BAC models (including Widmark) do not explicitly account for food. Use results as conservative estimates." } },
            { "@type": "Question", "name": "Is this calculator legal advice?", "acceptedAnswer": { "@type": "Answer", "text": "No. It is an educational tool and not medical or legal advice. Never drive or operate machinery after drinking, even below legal limits. Local laws vary by jurisdiction." } },
            { "@type": "Question", "name": "Can I switch between US and Metric units?", "acceptedAnswer": { "@type": "Answer", "text": "Yes. Toggle US/Metric. Volumes and weight units adapt and the tool handles all conversions internally." } }
          ]
        }
      ]}
    </script>
    
    <script src="search.js" defer></script>
    
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['\(','\)'], ['$', '$']],
          displayMath: [['$$','$$'], ['\[','\]']]
        },
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    
    <link rel="preload" href="/assets/js/mobile-menu.js" as="script">
    <link rel="preload" href="/assets/js/page-enhancements.js" as="script">
</head>
<body class="bg-gray-50 text-gray-800">

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4 lg:px-6 py-4">
            <div class="flex justify-between items-center">
                <a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>
                
                <div class="w-full max-w-md hidden md:block mx-8">
                    <div class="relative">
                        <input 
                            type="search" 
                            id="search-input"
                            placeholder="Search for a calculator..." 
                            class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                            autocomplete="off"
                        >
                        <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <div id="search-results" class="absolute top-full left-0 right-0 hidden"></div>
                    </div>
                </div>
                
                <div class="hidden md:flex items-center space-x-6">
                    <a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
                    <a href="index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
                </div>
                
                <button id="mobile-menu-toggle" class="md:hidden p-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
            
            <div id="mobile-menu" class="md:hidden mt-4 hidden">
                <div class="space-y-2">
                    <a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
                    <a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
                </div>
            </div>
        </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
        <div class="flex flex-col lg:flex-row gap-8">

            <main class="w-full lg:w-2/3">
                <nav class="text-sm mb-4 text-gray-600">
                    <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
                    <a href="health-fitness.html" class="hover:text-blue-600">Health & Fitness</a> &raquo;
                    <a href="health-metrics.html" class="hover:text-blue-600">Health Metrics</a> &raquo;
                    <span>BAC Calculator</span>
                </nav>

                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h1 class="text-3xl font-bold mb-2">Blood Alcohol Content (BAC) Calculator</h1>
                    <p class="text-gray-600 mb-6">This professional-grade BAC calculator estimates your Blood Alcohol Content using the Widmark formula. It is designed for adults who want an educational estimate of impairment risk based on their drinks, body factors, and time. Results are estimates only—not medical or legal advice. Never drink and drive.</p>

                    <div id="calculator-ui" class="space-y-6">
                        
                        <div class="space-y-2">
                            <fieldset>
                                <legend class="block text-sm font-medium text-gray-700">Unit system</legend>
                                <div aria-label="Unit system" class="radio-group mt-2 flex gap-4" role="radiogroup">
                                    <label class="radio-pill flex items-center gap-2 p-3 border border-gray-300 rounded-md cursor-pointer has-[:checked]:bg-blue-50 has-[:checked]:border-blue-500" for="units-us">
                                        <input checked="" id="units-us" name="units" type="radio" value="us" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"/>
                                        <span class="text-sm font-medium text-gray-700">US (lb, fl oz)</span>
                                    </label>
                                    <label class="radio-pill flex items-center gap-2 p-3 border border-gray-300 rounded-md cursor-pointer has-[:checked]:bg-blue-50 has-[:checked]:border-blue-500" for="units-metric">
                                        <input id="units-metric" name="units" type="radio" value="metric" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"/>
                                        <span class="text-sm font-medium text-gray-700">Metric (kg, mL)</span>
                                    </label>
                                </div>
                            </fieldset>
                        </div>
                        
                        <div class="space-y-2">
                            <fieldset>
                                <legend class="block text-sm font-medium text-gray-700">Biological sex (affects body water constant r)</legend>
                                <div aria-label="Sex" class="radio-group mt-2 flex gap-4" role="radiogroup">
                                    <label class="radio-pill flex items-center gap-2 p-3 border border-gray-300 rounded-md cursor-pointer has-[:checked]:bg-blue-50 has-[:checked]:border-blue-500" for="sex-male">
                                        <input checked="" id="sex-male" name="sex" type="radio" value="male" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"/>
                                        <span class="text-sm font-medium text-gray-700">Male</span>
                                    </label>
                                    <label class="radio-pill flex items-center gap-2 p-3 border border-gray-300 rounded-md cursor-pointer has-[:checked]:bg-blue-50 has-[:checked]:border-blue-500" for="sex-female">
                                        <input id="sex-female" name="sex" type="radio" value="female" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"/>
                                        <span class="text-sm font-medium text-gray-700">Female</span>
                                    </label>
                                </div>
                                <p class="mt-2 text-sm text-gray-500">Default r = 0.73 (male), 0.66 (female). You can customize r below.</p>
                            </fieldset>
                        </div>

                        <div>
                            <label for="weight" class="block text-sm font-medium text-gray-700">
                                Weight <span class="text-red-600">*</span>
                                <span class="text-sm text-gray-500" id="weightUnitLabel">(lb)</span>
                                <span aria-expanded="false" class="tooltip">
                                    <button aria-controls="tip-weight" aria-expanded="false" aria-label="Weight help" class="tooltip-toggle help-tooltip" type="button">?</button>
                                    <span class="tooltip-content" id="tip-weight">Enter your body weight in pounds (US) or kilograms (Metric). Accurate weight improves the estimate.</span>
                                </span>
                            </label>
                            <div class="mt-1 flex rounded-md shadow-sm">
                                <input aria-describedby="weightError tip-weight" aria-required="true" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" id="weight" inputmode="decimal" min="1" placeholder="e.g., 180" step="0.1" type="number"/>
                                <span class="inline-flex items-center px-3 rounded-r-md border border-l-0 border-gray-300 bg-gray-50 text-gray-500 sm:text-sm" id="weightUnitSuffix">lb</span>
                            </div>
                            <div aria-live="polite" class="mt-1 text-sm text-red-600" id="weightError" role="alert"></div>
                        </div>

                        <div>
                            <label for="rConstant" class="block text-sm font-medium text-gray-700">
                                Body water constant r (optional)
                                <span aria-expanded="false" class="tooltip">
                                    <button aria-controls="tip-r" aria-expanded="false" aria-label="Body water constant help" class="tooltip-toggle help-tooltip" type="button">?</button>
                                    <span class="tooltip-content" id="tip-r">Widmark r reflects average body water proportion: typically ~0.73 for males and ~0.66 for females. Adjust only if advised by a professional study.</span>
                                </span>
                            </label>
                            <div class="mt-1 flex gap-2">
                                <input aria-describedby="rError tip-r" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" id="rConstant" inputmode="decimal" max="0.9" min="0.4" placeholder="Auto by sex (0.73 or 0.66)" step="0.01" type="number"/>
                                <button class="btn btn-ghost px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-medium" id="resetR" type="button">Reset</button>
                            </div>
                            <div aria-live="polite" class="mt-1 text-sm text-red-600" id="rError" role="alert"></div>
                        </div>

                        <div>
                            <label for="hours" class="block text-sm font-medium text-gray-700">
                                Hours since first drink <span class="text-red-600">*</span>
                                <span aria-expanded="false" class="tooltip">
                                    <button aria-controls="tip-hours" aria-expanded="false" aria-label="Hours help" class="tooltip-toggle help-tooltip" type="button">?</button>
                                    <span class="tooltip-content" id="tip-hours">Time elapsed since you started drinking. The model subtracts β × hours to account for metabolism.</span>
                                </span>
                            </label>
                            <input aria-describedby="hoursError tip-hours" aria-required="true" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" id="hours" inputmode="decimal" min="0" placeholder="e.g., 1.5" step="0.1" type="number"/>
                            <div aria-live="polite" class="mt-1 text-sm text-red-600" id="hoursError" role="alert"></div>
                        </div>

                        <div>
                            <label for="beta" class="block text-sm font-medium text-gray-700">
                                Metabolism rate β (%BAC per hour)
                                <span aria-expanded="false" class="tooltip">
                                    <button aria-controls="tip-beta" aria-expanded="false" aria-label="Metabolism rate help" class="tooltip-toggle help-tooltip" type="button">?</button>
                                    <span class="tooltip-content" id="tip-beta">Average elimination is about 0.015% BAC/hour. People vary (~0.010–0.025). Higher values reduce BAC faster.</span>
                                </span>
                            </label>
                            <div class="mt-1 flex gap-2">
                                <input aria-describedby="betaError tip-beta" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" id="beta" inputmode="decimal" max="0.03" min="0.005" step="0.001" type="number" value="0.015"/>
                                <button class="btn btn-ghost px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-medium" id="resetBeta" type="button">Reset</button>
                            </div>
                            <div aria-live="polite" class="mt-1 text-sm text-red-600" id="betaError" role="alert"></div>
                        </div>

                        <div class="border-t pt-4 space-y-4">
                            <h3 id="drinks-heading" class="text-lg font-semibold">Drinks</h3>
                            <p class="text-sm text-gray-600">Add your drinks. Use presets or enter a custom drink volume and ABV.</p>
                            
                            <div aria-label="Add a standard drink quickly" class="drink-presets flex flex-wrap gap-2" role="group">
                                <button class="btn btn-secondary px-3 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200 text-sm font-medium" data-preset="beer" type="button">Beer 12 fl oz · 5%</button>
                                <button class="btn btn-secondary px-3 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200 text-sm font-medium" data-preset="wine" type="button">Wine 5 fl oz · 12%</button>
                                <button class="btn btn-secondary px-3 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200 text-sm font-medium" data-preset="spirit" type="button">Spirit 1.5 fl oz · 40%</button>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="flex items-end gap-2">
                                    <div class="flex-grow">
                                        <label for="drinkVol" class="block text-sm font-medium text-gray-700">Custom volume</label>
                                        <input aria-describedby="drinkVolError drinkHelp" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" id="drinkVol" inputmode="decimal" min="0.1" placeholder="e.g., 12" step="0.1" type="number"/>
                                    </div>
                                    <div>
                                        <label for="drinkVolUnit" class="sr-only">Volume unit</label>
                                        <select aria-label="Volume unit" class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" id="drinkVolUnit">
                                            <option value="floz">fl oz</option>
                                            <option value="ml">mL</option>
                                        </select>
                                    </div>
                                </div>
                                <div aria-live="polite" class="text-sm text-red-600" id="drinkVolError" role="alert"></div>
                            </div>

                            <div>
                                <label for="drinkAbv" class="block text-sm font-medium text-gray-700">
                                    Alcohol by Volume (ABV) %
                                    <span aria-expanded="false" class="tooltip">
                                        <button aria-controls="tip-abv" aria-expanded="false" aria-label="ABV help" class="tooltip-toggle help-tooltip" type="button">?</button>
                                        <span class="tooltip-content" id="tip-abv">ABV is the percentage of pure alcohol in the beverage by volume. For example, 5% for many beers, 12% for wine, ~40% for spirits.</span>
                                    </span>
                                </label>
                                <input aria-describedby="drinkAbvError tip-abv" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" id="drinkAbv" inputmode="decimal" max="100" min="0.1" placeholder="e.g., 5" step="0.1" type="number"/>
                                <div aria-live="polite" class="mt-1 text-sm text-red-600" id="drinkAbvError" role="alert"></div>
                            </div>
                            
                            <div class="flex gap-3">
                                <button class="btn btn-primary px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium" id="addDrink" type="button">Add drink</button>
                                <button class="btn btn-danger px-6 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 font-medium" id="clearDrinks" type="button">Clear drinks</button>
                            </div>
                            
                            <div aria-labelledby="drinks-heading" class="drink-list mt-4 border-t border-gray-200" id="drinkList" role="list">
                                <div class="empty-state py-4 text-center text-gray-500" id="drinkEmpty">No drinks added yet.</div>
                                <style>
                                    .drink-item { display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0.25rem; border-bottom: 1px dashed #e5e7eb; }
                                    .drink-meta { font-size: 0.875rem; color: #6b7280; margin-left: 0.5rem; }
                                    /* .btn-ghost for remove button */
                                    .drink-item .btn-ghost { padding: 0.25rem 0.5rem; background: transparent; color: #4b5563; border: 1px solid #d1d5db; border-radius: 6px; font-weight: 500; }
                                    .drink-item .btn-ghost:hover { background: #f3f4f6; }
                                </style>
                            </div>
                            <p class="text-sm text-gray-500" id="drinkHelp">Tip: A U.S. standard drink contains about 14 grams of pure alcohol.</p>
                        </div>

                        <div class="flex gap-3 border-t pt-4">
                            <button aria-describedby="calcNote" class="btn btn-primary px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium" id="calculate" type="button">Calculate</button>
                            <button class="btn btn-ghost px-6 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-medium" id="resetAll" type="button">Reset all</button>
                        </div>
                        <span class="text-sm text-gray-500" id="calcNote">Results update automatically when you calculate or change inputs.</span>
                    </div>

                    <div id="results" aria-live="polite" class="mt-8 bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200">
                        <h2 id="results-heading" class="text-xl font-semibold text-gray-800 mb-4">Results</h2>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <p class="text-sm text-gray-600">Estimated BAC</p>
                                <p class="text-2xl font-bold text-blue-600" id="bacValue">0.000%</p>
                                <div aria-label="BAC status" class="status-badges flex flex-wrap gap-2 mt-2" id="bacBadges">
                                    <style>
                                        .badge { display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.25rem 0.75rem; border-radius: 999px; font-weight: 600; border: 1px solid transparent; font-size: 0.8rem; }
                                        .badge.ok { background: #ecfdf5; color: #065f46; border-color: #a7f3d0; }
                                        .badge.caution { background: #fefce8; color: #854d0e; border-color: #fde68a; }
                                        .badge.danger { background: #fef2f2; color: #991b1b; border-color: #fecaca; }
                                    </style>
                                </div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <p class="text-sm text-gray-600">Estimated time to 0.00%</p>
                                <p class="text-2xl font-bold text-gray-700" id="soberTime">0.0 h</p>
                                <p class="text-sm text-gray-500 mt-1">Assuming constant β.</p>
                            </div>
                             <div class="bg-white p-4 rounded-lg shadow-sm">
                                <p class="text-sm text-gray-600">Total pure alcohol</p>
                                <p class="text-2xl font-bold text-gray-700" id="alcoholTotals">0.0 fl oz · 0 g</p>
                                <p class="text-sm text-gray-500 mt-1" id="stdDrinksNote">≈ 0.0 U.S. standard drinks</p>
                            </div>
                        </div>
                        
                        <div class="mt-6 p-4 bg-white/70 rounded-md border border-blue-200">
                            <h3 class="font-semibold text-gray-800">Safety Reminder</h3>
                            <p class="text-sm text-gray-600 mt-1">Any amount of alcohol can impair judgment and reaction time. Laws and limits vary by country and state. This tool is for education only and does not replace professional or legal guidance.</p>
                        </div>
                    </div>
                </div>

                <article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
                    <h2 id="source-heading">Data Source and Methodology</h2>
                    <ul>
                        <li>Widmark, E. M. P. (1932). Alkoholmetrie (Alcoholometry). Berlin: Urban &amp; Schwarzenberg. Core equation and body-water constant approach.</li>
                        <li>National Institute on Alcohol Abuse and Alcoholism (NIAAA). Rethinking Drinking — What’s a Standard Drink? (accessed 2025). <a href="https://www.rethinkingdrinking.niaaa.nih.gov/tools/calculators" rel="noopener">Direct link</a></li>
                    </ul>
                    <p><strong>All calculations are strictly based on the formulas and data provided by these sources.</strong></p>

                    <h2 id="formula-heading">The Formula Explained</h2>
                    <h3>US customary formulation</h3>
                    <div class="formula-box">
                        $$ \text{BAC} = \frac{A_{\text{oz}} \times 5.14}{W_{\text{lb}} \times r} - \beta \times H $$
                    </div>
                    <ul>
                        <li>$A_{\text{oz}}$ = total fluid ounces of pure ethanol consumed (fl oz)</li>
                        <li>$W_{\text{lb}}$ = body weight (lb)</li>
                        <li>$r$ = body water constant (~0.73 male, ~0.66 female)</li>
                        <li>$\beta$ = elimination rate (typically 0.015 %BAC/hour)</li>
                        <li>$H$ = hours since first drink</li>
                    </ul>
                    <h3>Metric formulation</h3>
                    <div class="formula-box">
                        $$ A_g = \sum_i \big(V_{i,\text{mL}} \times \text{ABV}_i \times \rho_{\text{EtOH}}\big),\quad \rho_{\text{EtOH}} \approx 0.789\ \text{g/mL} $$
                        $$ \text{BAC}\% = \frac{A_g}{W_{\text{kg}} \times r \times 10} - \beta \times H $$
                    </div>

                    <h2 id="glossary-heading">Glossary of Variables</h2>
                    <ul>
                        <li><strong>Unit system:</strong> Choose US (lb, fl oz) or Metric (kg, mL).</li>
                        <li><strong>Sex:</strong> Biological sex used to set r (body water constant).</li>
                        <li><strong>Weight:</strong> Your body weight in the selected unit.</li>
                        <li><strong>Body water constant r:</strong> Proportion of body mass as water; typical averages are 0.73 (male) and 0.66 (female).</li>
                        <li><strong>Hours since first drink (H):</strong> Time elapsed since drinking began.</li>
                        <li><strong>Metabolism rate β:</strong> Average reduction in %BAC per hour (default 0.015).</li>
                        <li><strong>Volume:</strong> Beverage amount (fl oz or mL).</li>
                        <li><strong>ABV (%):</strong> Alcohol by volume percentage of the beverage.</li>
                        <li><strong>Estimated BAC:</strong> Resulting percentage of alcohol in the blood (g/dL), e.g., 0.08%.</li>
                        <li><strong>Time to 0.00%:</strong> Estimated hours to metabolize to zero based on β.</li>
                        <li><strong>Standard drinks:</strong> U.S. standard drinks (14 g pure alcohol each) for context.</li>
                    </ul>

                    <h2 id="example-heading">How It Works: A Step-by-Step Example</h2>
                    <ol>
                        <li>Add two 12 fl oz beers at 5% ABV (US units). Pure alcohol $A_{\text{oz}}$ = 2 × 12 × 0.05 = 1.2 fl oz.</li>
                        <li>Enter Sex = Male → r = 0.73; Weight = 180 lb; Hours H = 1.5; β = 0.015.</li>
                        <li>Compute:
                            <div class="formula-box">
                                $$ \text{Initial BAC} = \frac{1.2 \times 5.14}{180 \times 0.73} \approx 0.0472 $$
                                $$ \text{Final BAC} = 0.0472 - 0.015 \times 1.5 \approx 0.0247 \ (\approx 0.025\%) $$
                            </div>
                        </li>
                        <li>Interpretation: About 0.025% BAC. Estimated time to 0.00% = 0.025 / 0.015 ≈ 1.7 hours.</li>
                    </ol>
                    
                    <h2 id="faq-heading">Frequently Asked Questions</h2>
                    <details class="border-b py-2">
                        <summary>Is the Widmark formula valid for everyone?</summary>
                        <p class="mt-2 text-gray-700">It is a well-established population model, but real individuals vary due to genetics, health, medications, hydration, age, and food. Treat results as estimates only.</p>
                    </details>
                    <details class="border-b py-2">
                        <summary>Why do sex and weight matter?</summary>
                        <p class="mt-2 text-gray-700">Alcohol distributes mainly in body water. On average, males have a higher proportion of water than females at the same weight, which affects concentration.</p>
                    </details>
                    <details class="border-b py-2">
                        <summary>Can I customize the elimination rate β?</summary>
                        <p class="mt-2 text-gray-700">Yes. The default 0.015 is typical; some people eliminate between 0.010 and 0.025. If you are unsure, keep the default to avoid underestimation.</p>
                    </details>
                    <details class="border-b py-2">
                        <summary>What if I drank over many hours?</summary>
                        <p class="mt-2 text-gray-700">Enter the time since your first drink. The formula subtracts β × hours, approximating ongoing metabolism. It does not model complex absorption kinetics.</p>
                    </details>
                    <details class="border-b py-2">
                        <summary>Is being below 0.08% always safe to drive?</summary>
                        <p class="mt-2 text-gray-700">No. Impairment can occur below common legal limits. Never drive after drinking alcohol. Local legal thresholds vary.</p>
                    </details>
                    <details class="border-b py-2">
                        <summary>How are standard drinks calculated?</summary>
                        <p class="mt-2 text-gray-700">By dividing total pure alcohol (grams) by 14 g per U.S. standard drink. This gives a relatable count, not a legal measure.</p>
                    </details>

                    <div class="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <p class="text-sm text-gray-600">
                            <strong>Tool developed by Ugo Candido.</strong> Content verified by <strong>CalcDomain Editorial Team</strong>.<br>
                            Last reviewed for accuracy on: <time datetime="2025-09-14">September 14, 2025</time>.
                        </p>
                    </div>
                </article>

            </main>

            <aside class="w-full lg:w-1/3">
                <div class="sticky top-24 space-y-8">
                    <div class="bg-gray-200 h-96 rounded-lg flex items-center justify-center">
                        <p class="text-gray-500">Sticky Ad Unit (e.g., 300x600)</p>
                    </div>

                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="font-bold text-lg mb-4">Related Health Metrics</h3>
                        <ul class="space-y-3">
                            <li><a href="https://calcdomain.com/bmi-calculator.html" class="text-blue-600 hover:underline">BMI Calculator</a></li>
                            <li><a href="https://calcdomain.com/body-fat-calculator.html" class="text-blue-600 hover:underline">Body Fat Calculator</a></li>
                            <li><a href="https://calcdomain.com/bmr-calculator.html" class="text-blue-600 hover:underline">BMR Calculator</a></li>
                            <li><a href="https://calcdomain.com/heart-rate-calculator.html" class="text-blue-600 hover:underline">Heart Rate Calculator</a></li>
                            <li><a href="https://calcdomain.com/ideal-weight-calculator.html" class="text-blue-600 hover:underline">Ideal Weight Calculator</a></li>
                            <li><a href="https://calcdomain.com/waist-to-hip-ratio-calculator.html" class="text-blue-600 hover:underline">Waist to Hip Ratio Calculator</a></li>
                            <li><a href="https://calcdomain.com/pregnancy-calculator.html" class="text-blue-600 hover:underline">Pregnancy Calculator</a></li>
                        </ul>
                    </div>
                </div>
            </aside>

        </div>
    </div>
    
    <footer class="bg-white border-t mt-12">
        <div class="container mx-auto px-6 py-8">
            <div class="text-center text-gray-600">
                <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
                <div class="mt-4 space-x-4">
                    <a href="about.html" class="hover:text-blue-600">About</a>
                    <a href="contact.html" class="hover:text-blue-600">Contact</a>
                    <a href="privacy.html" class="hover:text-blue-600">Privacy</a>
                    <a href="terms.html" class="hover:text-blue-600">Terms</a>
                </div>
            </div>
        </div>
    </footer>

    <script defer="">
    (function(){
      'use strict';
      // State
      const state = {
        units: 'us', // 'us' or 'metric'
        sex: 'male',
        rOverride: null, // number|null
        weight: null, // in lb or kg per units
        hours: null,
        beta: 0.015,
        drinks: [] // [{id, volMl, abv}] where volMl is beverage mL, abv in fraction (0..1)
      };
      // Constants
      const ML_PER_FLOZ = 29.5735295625;
      const ETHANOL_DENSITY_G_ML = 0.789; // 20°C
      const STD_DRINK_G = 14; // US
      // Elements
      const el = {
        unitsUS: document.getElementById('units-us'),
        unitsMetric: document.getElementById('units-metric'),
        sexMale: document.getElementById('sex-male'),
        sexFemale: document.getElementById('sex-female'),
        weight: document.getElementById('weight'),
        weightUnitLabel: document.getElementById('weightUnitLabel'),
        weightUnitSuffix: document.getElementById('weightUnitSuffix'),
        rConstant: document.getElementById('rConstant'),
        resetR: document.getElementById('resetR'),
        hours: document.getElementById('hours'),
        beta: document.getElementById('beta'),
        resetBeta: document.getElementById('resetBeta'),
        drinkVol: document.getElementById('drinkVol'),
        drinkVolUnit: document.getElementById('drinkVolUnit'),
        drinkAbv: document.getElementById('drinkAbv'),
        addDrink: document.getElementById('addDrink'),
        clearDrinks: document.getElementById('clearDrinks'),
        drinkList: document.getElementById('drinkList'),
        drinkEmpty: document.getElementById('drinkEmpty'),
        calculate: document.getElementById('calculate'),
        // errors
        weightError: document.getElementById('weightError'),
        rError: document.getElementById('rError'),
        hoursError: document.getElementById('hoursError'),
        betaError: document.getElementById('betaError'),
        drinkVolError: document.getElementById('drinkVolError'),
        drinkAbvError: document.getElementById('drinkAbvError'),
        // results
        bacValue: document.getElementById('bacValue'),
        soberTime: document.getElementById('soberTime'),
        alcoholTotals: document.getElementById('alcoholTotals'),
        stdDrinksNote: document.getElementById('stdDrinksNote'),
        bacBadges: document.getElementById('bacBadges'),
        resetAll: document.getElementById('resetAll')
      };

      // Tooltip toggles (accessible)
      document.querySelectorAll('.tooltip .tooltip-toggle').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const wrapper = btn.closest('.tooltip');
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          wrapper.setAttribute('aria-expanded', String(!expanded));
        });
        btn.addEventListener('keydown', (e)=>{
          if(e.key === 'Escape'){
            const wrapper = btn.closest('.tooltip');
            btn.setAttribute('aria-expanded', 'false');
            wrapper.setAttribute('aria-expanded', 'false');
            btn.blur();
          }
        });
        // Close on outside click
        document.addEventListener('click', (e) => {
            const wrapper = btn.closest('.tooltip');
            if (wrapper && !wrapper.contains(e.target)) {
                btn.setAttribute('aria-expanded', 'false');
                wrapper.setAttribute('aria-expanded', 'false');
            }
        });
      });

      // Preset drinks
      document.querySelectorAll('.drink-presets .btn').forEach(b=>{
        b.addEventListener('click', ()=>{
          const type = b.getAttribute('data-preset');
          if(type === 'beer'){ addDrinkPreset(12, 'floz', 5); }
          if(type === 'wine'){ addDrinkPreset(5, 'floz', 12); }
          if(type === 'spirit'){ addDrinkPreset(1.5, 'floz', 40); }
          renderDrinks();
          computeAndRender();
        });
      });

      function addDrinkPreset(vol, unit, abv){
        const volMl = unit === 'floz' ? vol * ML_PER_FLOZ : vol;
        state.drinks.push({ id: cryptoId(), volMl, abv: abv/100 });
      }

      // Helpers
      function cryptoId(){
        return 'd_' + Math.random().toString(36).slice(2,9);
      }
      function getDefaultR(){
        return state.sex === 'male' ? 0.73 : 0.66;
      }
      function coerceNumber(v){
        const n = typeof v === 'number' ? v : parseFloat(String(v).replace(',', '.'));
        return Number.isFinite(n) ? n : null;
      }
      function setError(elInput, elError, msg){
        if(msg){
          elError.textContent = msg;
          elInput.setAttribute('aria-invalid', 'true');
        }else{
          elError.textContent = '';
          elInput.removeAttribute('aria-invalid');
        }
      }
      function updateUnitsUI(){
        if(state.units === 'us'){
          el.weightUnitLabel.textContent = '(lb)';
          el.weightUnitSuffix.textContent = 'lb';
          el.drinkVolUnit.value = 'floz';
        }else{
          el.weightUnitLabel.textContent = '(kg)';
          el.weightUnitSuffix.textContent = 'kg';
          el.drinkVolUnit.value = 'ml';
        }
      }

      // Inputs events
      el.unitsUS.addEventListener('change', ()=>{ if(el.unitsUS.checked){ state.units='us'; updateUnitsUI(); computeAndRender(); }});
      el.unitsMetric.addEventListener('change', ()=>{ if(el.unitsMetric.checked){ state.units='metric'; updateUnitsUI(); computeAndRender(); }});
      el.sexMale.addEventListener('change', ()=>{ if(el.sexMale.checked){ state.sex='male'; if(!state.rOverride){ el.rConstant.value=''; } computeAndRender(); }});
      el.sexFemale.addEventListener('change', ()=>{ if(el.sexFemale.checked){ state.sex='female'; if(!state.rOverride){ el.rConstant.value=''; } computeAndRender(); }});

      el.weight.addEventListener('blur', ()=>{
        const v = coerceNumber(el.weight.value);
        if(v === null || v <= 0){
          setError(el.weight, el.weightError, 'Please enter a valid weight greater than 0.');
          state.weight = null;
        }else{
          setError(el.weight, el.weightError, '');
          state.weight = v;
        }
        computeAndRender();
      });

      el.rConstant.addEventListener('blur', ()=>{
        const vRaw = el.rConstant.value.trim();
        if(vRaw === ''){
          state.rOverride = null;
          setError(el.rConstant, el.rError, '');
        }else{
          const v = coerceNumber(vRaw);
          if(v === null || v < 0.4 || v > 0.9){
            setError(el.rConstant, el.rError, 'Enter r between 0.40 and 0.90 or leave blank to use the default.');
            state.rOverride = null;
          }else{
            setError(el.rConstant, el.rError, '');
            state.rOverride = v;
          }
        }
        computeAndRender();
      });
      el.resetR.addEventListener('click', ()=>{
        state.rOverride = null; el.rConstant.value = ''; setError(el.rConstant, el.rError, ''); computeAndRender();
      });

      el.hours.addEventListener('blur', ()=>{
        const v = coerceNumber(el.hours.value);
        if(v === null || v < 0){
          setError(el.hours, el.hoursError, 'Please enter hours since first drink (0 or more).');
          state.hours = null;
        }else{
          setError(el.hours, el.hoursError, '');
          state.hours = v;
        }
        computeAndRender();
      });

      el.beta.addEventListener('blur', ()=>{
        const v = coerceNumber(el.beta.value);
        if(v === null || v < 0.005 || v > 0.03){
          setError(el.beta, el.betaError, 'Enter a β between 0.005 and 0.030.');
        }else{
          setError(el.beta, el.betaError, '');
          state.beta = v;
          computeAndRender();
        }
      });
      el.resetBeta.addEventListener('click', ()=>{
        el.beta.value = '0.015';
        state.beta = 0.015;
        setError(el.beta, el.betaError, '');
        computeAndRender();
      });

      // Drinks handlers
      el.addDrink.addEventListener('click', ()=>{
        const vol = coerceNumber(el.drinkVol.value);
        const abv = coerceNumber(el.drinkAbv.value);
        let ok = true;
        if(vol === null || vol <= 0){
          setError(el.drinkVol, el.drinkVolError, 'Enter a positive volume.');
          ok = false;
        }else{
          setError(el.drinkVol, el.drinkVolError, '');
        }
        if(abv === null || abv <= 0 || abv > 100){
          setError(el.drinkAbv, el.drinkAbvError, 'Enter ABV between 0 and 100.');
          ok = false;
        }else{
          setError(el.drinkAbv, el.drinkAbvError, '');
        }
        if(!ok) return;
        const unit = el.drinkVolUnit.value;
        const volMl = unit === 'floz' ? vol * ML_PER_FLOZ : vol;
        state.drinks.push({ id: cryptoId(), volMl, abv: abv/100 });
        el.drinkVol.value = '';
        el.drinkAbv.value = '';
        renderDrinks();
        computeAndRender();
      });

      el.clearDrinks.addEventListener('click', ()=>{
        state.drinks = [];
        renderDrinks();
        computeAndRender();
      });

      el.calculate.addEventListener('click', ()=>{
        computeAndRender();
      });

      el.resetAll.addEventListener('click', ()=>{
        // reset state
        state.units = 'us'; el.unitsUS.checked = true; updateUnitsUI();
        state.sex = 'male'; el.sexMale.checked = true;
        state.rOverride = null; el.rConstant.value = ''; setError(el.rConstant, el.rError, '');
        state.weight = null; el.weight.value = ''; setError(el.weight, el.weightError, '');
        state.hours = null; el.hours.value = ''; setError(el.hours, el.hoursError, '');
        state.beta = 0.015; el.beta.value = '0.015'; setError(el.beta, el.betaError, '');
        state.drinks = []; renderDrinks();
        computeAndRender();
        el.weight.focus();
      });

      function renderDrinks(){
        const list = el.drinkList;
        list.innerHTML = '';
        if(state.drinks.length === 0){
          el.drinkEmpty.style.display = 'block';
          list.appendChild(el.drinkEmpty);
          return;
        }
        el.drinkEmpty.style.display = 'none';
        state.drinks.forEach(d=>{
          const bevMl = d.volMl;
          const abvPct = (d.abv*100).toFixed(1).replace(/\.0$/,'');
          const item = document.createElement('div');
          item.className = 'drink-item'; // Class styled with <style> tag
          item.setAttribute('role', 'listitem');
          const left = document.createElement('div');
          left.innerHTML = `<strong>${abvPct}% ABV</strong> <span class="drink-meta">· ${formatVolume(bevMl)}</span>`;
          const right = document.createElement('div');
          const rm = document.createElement('button');
          rm.className = 'btn btn-ghost'; // Class styled with <style> tag
          rm.type = 'button';
          rm.setAttribute('aria-label', 'Remove drink');
          rm.textContent = 'Remove';
          rm.addEventListener('click', ()=>{
            state.drinks = state.drinks.filter(x=>x.id!==d.id);
            renderDrinks();
            computeAndRender();
          });
          right.appendChild(rm);
          item.appendChild(left); item.appendChild(right);
          list.appendChild(item);
        });
      }

      function formatVolume(ml){
        if(state.units === 'us'){
          const floz = ml / ML_PER_FLOZ;
          return `${floz.toFixed(1)} fl oz (${Math.round(ml)} mL)`;
        }else{
          return `${Math.round(ml)} mL (${(ml/ML_PER_FLOZ).toFixed(1)} fl oz)`;
        }
      }

      function computeTotals(){
        // Pure ethanol volume (mL) and grams
        let ethanolMl = 0;
        for(const d of state.drinks){
          ethanolMl += d.volMl * d.abv;
        }
        const ethanolG = ethanolMl * ETHANOL_DENSITY_G_ML;
        const ethanolFlOz = ethanolMl / ML_PER_FLOZ;
        const stdDrinks = ethanolG / STD_DRINK_G;
        return { ethanolMl, ethanolG, ethanolFlOz, stdDrinks };
      }

      function computeBAC(){
        const { ethanolMl, ethanolG, ethanolFlOz } = computeTotals();
        const weight = state.weight;
        const hours = state.hours ?? 0;
        const r = state.rOverride ?? getDefaultR();
        const beta = state.beta;

        if(!weight || weight <= 0 || state.drinks.length === 0){
          return { bac: 0, initial: 0, clamp: true, timeToZero: 0, totals: computeTotals() };
        }
        let initial = 0;
        if(state.units === 'us'){
          // A in fl oz of pure ethanol
          const Aoz = ethanolFlOz;
          const Wlb = weight;
          initial = (Aoz * 5.14) / (Wlb * r);
        }else{
          // Metric
          const Ag = ethanolG;
          const Wkg = weight;
          initial = (Ag / (Wkg * r * 10)); // = A_g/(Wkg*1000*r)*100
        }
        let bac = initial - beta * hours;
        let clamp = false;
        if(bac < 0){ bac = 0; clamp = true; }

        const timeToZero = bac > 0 ? (bac / beta) : 0;
        return { bac, initial, clamp, timeToZero, totals: computeTotals() };
      }

      function renderBadges(bac){
        const c = el.bacBadges;
        c.innerHTML = '';
        // thresholds (informational)
        // 0.02 caution, 0.05 elevated risk, 0.08 common legal limit (varies)
        function mk(label, cls){
          const b = document.createElement('span');
          b.className = `badge ${cls}`; // Class styled with <style> tag
          b.textContent = label;
          c.appendChild(b);
        }
        if(bac === 0){
          mk('0.00% (No measurable alcohol)', 'ok');
          return;
        }
        if(bac < 0.02){
          mk('< 0.02% Possible subtle effects', 'caution');
        }else if(bac < 0.05){
          mk('≥ 0.02% Noticeable impairment', 'caution');
        }else if(bac < 0.08){
          mk('≥ 0.05% Elevated crash risk', 'danger');
        }else{
          mk('≥ 0.08% Over common legal limit in many regions', 'danger');
        }
      }

      function computeAndRender(){
        const { bac, timeToZero, totals } = computeBAC();

        // Results: BAC
        const bacPct = (bac*100).toFixed(3);
        el.bacValue.textContent = `${bacPct}%`;
        el.bacValue.classList.remove('text-yellow-600','text-red-600', 'text-blue-600');
        if(bac >= 0.08){ el.bacValue.classList.add('text-red-600'); }
        else if(bac >= 0.05){ el.bacValue.classList.add('text-yellow-600'); }
        else { el.bacValue.classList.add('text-blue-600'); }
        renderBadges(bac);

        // Totals
        const flOz = totals.ethanolMl / ML_PER_FLOZ;
        el.alcoholTotals.textContent = `${flOz.toFixed(1)} fl oz · ${totals.ethanolG.toFixed(0)} g`;
        el.stdDrinksNote.textContent = `≈ ${totals.stdDrinks.toFixed(1)} U.S. standard drinks`;

        // Time to zero
        const t = timeToZero;
        let tStr = `${t.toFixed(1)} h`;
        if(t >= 1){
          const h = Math.floor(t);
          const m = Math.round((t - h) * 60);
          tStr = `${h} h ${m} min`;
        }else{
          const m = Math.round(t * 60);
          tStr = `${m} min`;
        }
        el.soberTime.textContent = tStr;
      }

      // Validation on-the-fly for changes, not only blur
      ['input','change'].forEach(evt=>{
        el.weight.addEventListener(evt, ()=>{ /* keep for future live validation */});
        el.hours.addEventListener(evt, ()=>{});
        el.beta.addEventListener(evt, ()=>{});
      });

      // Initialize
      updateUnitsUI();
      renderDrinks();
      computeAndRender();

      // Accessibility: ensure keyboard space activates radio-pill labels
      document.querySelectorAll('.radio-pill input').forEach(r=>{
        r.addEventListener('keydown', (e)=>{
          if(e.key === ' '){ e.preventDefault(); r.checked = true; r.dispatchEvent(new Event('change')); }
        });
      });

      // Mobile menu toggle (from template)
      const mobileToggle = document.getElementById('mobile-menu-toggle');
      const mobileMenu = document.getElementById('mobile-menu');
      if (mobileToggle && mobileMenu) {
          mobileToggle.addEventListener('click', () => {
              mobileMenu.classList.toggle('hidden');
          });
      }
    })();
    </script>

</body>
</html>
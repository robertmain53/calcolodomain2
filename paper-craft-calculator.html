<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Paper Craft Calculator — Layout, Sheets, Weight & Cost</title>
  <meta name="description" content="Plan your paper craft projects with precision: compute layout (n‑up), sheets needed, waste, weight, and cost. Supports ISO A‑series and US sizes, rotation, gutters, bleed, kerf, metric & imperial." />
  <link rel="canonical" href="https://calcdomain.com/paper-craft-calculator.html" />
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Fonts & Tailwind (JIT CDN) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"></noscript>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <!-- MathJax for LaTeX rendering in content -->
  <script defer id="mathjax" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root { --focus: #0ea5e9; }
    body{font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji','Segoe UI Emoji', 'Segoe UI Symbol';}
    .prose{max-width: 68ch}
    .prose h2{font-size:1.375rem;font-weight:700;margin-top:2rem;margin-bottom:0.75rem}
    .prose h3{font-size:1.125rem;font-weight:700;margin-top:1.25rem;margin-bottom:0.5rem}
    .prose p{margin-bottom:0.75rem;line-height:1.7}
    .prose ul,.prose ol{margin-left:1.25rem;margin-bottom:0.75rem}
    .formula-box{background:#f3f4f6;border:1px solid #d1d5db;border-radius:8px;padding:1rem;overflow-x:auto;font-family:ui-monospace,Menlo,Consolas,monospace}
    .result-card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:1rem;text-align:center}
    .result-card h4{font-size:.9rem;color:#6b7280;margin-bottom:.25rem}
    .result-card p{font-size:1.5rem;font-weight:800;color:#1d4ed8}
    /* visible focus */
    :where(a,button,input,select,summary,details,[role="switch"]) :focus{outline:3px solid var(--focus);outline-offset:2px}
    :where(a,button,input,select,summary,details,[role="switch"]) :focus-visible{outline:3px solid var(--focus);outline-offset:2px}
    /* prevent CLS in results */
    #results{min-height:16rem}
    /* touch targets */
    .touch-target{min-height:48px}
    /* tooltip */
    .tooltip{display:none}
    .tooltip[data-open="true"]{display:block}
    @media print{body *{visibility:hidden} #print-section, #print-section *{visibility:visible} #print-section{position:absolute;inset:0} #live-preview{display:none}}
  </style>

  <!-- JSON-LD: WebPage + Calculator + Breadcrumbs + HowTo -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Paper Craft Calculator",
    "url":"https://calcdomain.com/paper-craft-calculator.html",
    "inLanguage":"en",
    "description":"Compute layout (n‑up), sheets required, waste, weight and cost for paper craft projects with ISO A-series and US sizes.",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"},
    "about":{"@type":"Thing","name":"Paper crafting"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "name":"Paper Craft Calculator",
    "applicationCategory":"Calculator",
    "operatingSystem":"Web",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Lifestyle Everyday","item":"https://calcdomain.com/lifestyle-everyday.html"},
      {"@type":"ListItem","position":3,"name":"Hobbies","item":"https://calcdomain.com/subcategories/hobbies.html"},
      {"@type":"ListItem","position":4,"name":"Paper Craft Calculator","item":"https://calcdomain.com/paper-craft-calculator.html"}
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to plan a paper craft layout",
    "step":[
      {"@type":"HowToStep","name":"Choose sheet & units","text":"Select a standard sheet size or enter custom dimensions. Pick metric (mm) or imperial (in)."},
      {"@type":"HowToStep","name":"Enter piece size","text":"Set finished piece width/height and add bleed, gutter and kerf."},
      {"@type":"HowToStep","name":"Enable rotation if needed","text":"Allow 90° rotation to fit more pieces per sheet."},
      {"@type":"HowToStep","name":"Review results","text":"See n‑up per sheet, sheets required for your quantity, utilization, waste, total area, weight and cost."}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <header class="bg-white border-b">
    <div class="container mx-auto px-4 lg:px-6 py-4">
      <div class="flex items-center justify-between">
        <a class="text-2xl font-extrabold text-blue-600" href="index.html" aria-label="CalcDomain home">CalcDomain</a>
        <nav class="hidden md:flex gap-6 text-sm" aria-label="primary">
          <a class="hover:text-blue-600" href="search.html">Search</a>
          <a class="hover:text-blue-600" href="index.html#categories">Categories</a>
        </nav>
        <button class="md:hidden p-2 rounded hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-400" aria-expanded="false" aria-controls="mobile-nav" id="menuBtn" aria-label="Open menu">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </button>
      </div>
      <div id="mobile-nav" class="hidden mt-3 md:hidden" role="region" aria-label="Mobile navigation">
        <a class="block py-2 text-gray-700 hover:text-blue-600" href="search.html">Search</a>
        <a class="block py-2 text-gray-700 hover:text-blue-600" href="index.html#categories">Categories</a>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <section class="w-full lg:w-2/3" id="print-section">
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
          <a href="lifestyle-everyday.html" class="hover:text-blue-600">Lifestyle Everyday</a> &raquo;
          <a href="subcategories/hobbies.html" class="hover:text-blue-600">Hobbies</a> &raquo;
          <span class="text-gray-900">Paper Craft Calculator</span>
        </nav>

        <h1 class="text-3xl font-extrabold text-gray-900 mb-2">paper craft calculator</h1>
        <p class="text-gray-700 mb-6">Design smarter paper projects: compute how many pieces fit per sheet (n‑up), how many sheets you need for a target quantity, expected waste, total area, weight, and cost. Built for hobbyists, teachers, makers, and small studios.</p>

        <!-- Calculator UI -->
        <section class="bg-white p-6 rounded-lg shadow-sm border">
          <h2 class="sr-only">Calculator inputs</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Units -->
            <div>
              <label for="units" class="block text-sm font-medium text-gray-800">Units *</label>
              <select id="units" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-required="true">
                <option value="mm" selected>Metric (mm)</option>
                <option value="in">Imperial (in)</option>
              </select>
              <p id="unitsHelp" class="text-xs text-gray-600 mt-1">Switching units converts all size fields.</p>
            </div>

            <!-- Sheet preset -->
            <div>
              <div class="flex items-center justify-between">
                <label for="sheetPreset" class="block text-sm font-medium text-gray-800">Sheet size preset</label>
                <button type="button" id="sheetPresetTipBtn" class="ml-2 text-xs px-2 py-1 rounded border hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-sky-400" aria-expanded="false" aria-controls="sheetPresetTip" aria-label="Toggle help for sheet size preset">?</button>
              </div>
              <select id="sheetPreset" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-describedby="sheetPresetTip">
                <option value="A4">ISO A4</option>
                <option value="A3">ISO A3</option>
                <option value="A2">ISO A2</option>
                <option value="A1">ISO A1</option>
                <option value="A0">ISO A0</option>
                <option value="Letter">US Letter</option>
                <option value="Legal">US Legal</option>
                <option value="Tabloid">US Tabloid</option>
                <option value="Custom" selected>Custom</option>
              </select>
              <p id="sheetPresetTip" class="tooltip text-xs text-gray-700 mt-1" role="note">Choose a standard size (ISO 216 A‑series or common US sizes) or keep <em>Custom</em> to enter your own sheet dimensions.</p>
            </div>

            <!-- Sheet width/height -->
            <div>
              <label for="sheetW" class="block text-sm font-medium text-gray-800">Sheet width *</label>
              <input type="number" step="0.01" min="0" id="sheetW" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-required="true" aria-describedby="sheetWErr" value="297" />
              <p id="sheetWErr" class="text-xs text-red-600 mt-1 hidden">Enter a sheet width greater than 0.</p>
            </div>
            <div>
              <label for="sheetH" class="block text-sm font-medium text-gray-800">Sheet height *</label>
              <input type="number" step="0.01" min="0" id="sheetH" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-required="true" aria-describedby="sheetHErr" value="210" />
              <p id="sheetHErr" class="text-xs text-red-600 mt-1 hidden">Enter a sheet height greater than 0.</p>
            </div>

            <!-- Piece width/height -->
            <div>
              <div class="flex items-center justify-between">
                <label for="pieceW" class="block text-sm font-medium text-gray-800">Piece width *</label>
                <button type="button" id="pieceTipBtn" class="ml-2 text-xs px-2 py-1 rounded border hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-sky-400" aria-expanded="false" aria-controls="pieceTip">?</button>
              </div>
              <input type="number" step="0.01" min="0.1" id="pieceW" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-required="true" aria-describedby="pieceWErr pieceTip" value="50" />
              <p id="pieceWErr" class="text-xs text-red-600 mt-1 hidden">Piece width must be greater than 0.</p>
              <p id="pieceTip" class="tooltip text-xs text-gray-700 mt-1">Use the <em>finished</em> piece size. Bleed and gutter are added around each piece.</p>
            </div>
            <div>
              <label for="pieceH" class="block text-sm font-medium text-gray-800">Piece height *</label>
              <input type="number" step="0.01" min="0.1" id="pieceH" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-required="true" aria-describedby="pieceHErr" value="50" />
              <p id="pieceHErr" class="text-xs text-red-600 mt-1 hidden">Piece height must be greater than 0.</p>
            </div>

            <!-- Bleed / gutter / kerf -->
            <div>
              <label for="bleed" class="block text-sm font-medium text-gray-800">Bleed per side</label>
              <input type="number" step="0.01" min="0" id="bleed" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-describedby="bleedHelp" value="0" />
              <p id="bleedHelp" class="text-xs text-gray-600 mt-1">Extra margin around each piece.</p>
            </div>
            <div>
              <label for="gutter" class="block text-sm font-medium text-gray-800">Gutter between pieces</label>
              <input type="number" step="0.01" min="0" id="gutter" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-describedby="gutterHelp" value="2" />
              <p id="gutterHelp" class="text-xs text-gray-600 mt-1">Space between adjacent pieces.</p>
            </div>
            <div>
              <label for="kerf" class="block text-sm font-medium text-gray-800">Kerf / cut thickness</label>
              <input type="number" step="0.01" min="0" id="kerf" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-describedby="kerfHelp" value="0.5" />
              <p id="kerfHelp" class="text-xs text-gray-600 mt-1">Approximate material lost to cutting.</p>
            </div>

            <!-- Project quantity -->
            <div>
              <label for="quantity" class="block text-sm font-medium text-gray-800">Target quantity *</label>
              <input type="number" step="1" min="1" id="quantity" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-required="true" aria-describedby="quantityErr" value="100" />
              <p id="quantityErr" class="text-xs text-red-600 mt-1 hidden">Quantity must be at least 1.</p>
            </div>

            <!-- Rotation & margins -->
            <div class="flex items-center gap-3 mt-2">
              <input type="checkbox" id="allowRotate" class="w-5 h-5" />
              <label for="allowRotate" class="text-sm text-gray-800">Allow 90° rotation</label>
            </div>
            <div class="flex items-center gap-3 mt-2">
              <input type="checkbox" id="pageMarginToggle" class="w-5 h-5" />
              <label for="pageMarginToggle" class="text-sm text-gray-800">Apply outer sheet margins</label>
            </div>
            <div class="md:col-span-2 grid grid-cols-2 md:grid-cols-4 gap-4" id="pageMargins" hidden>
              <div>
                <label for="marginTop" class="block text-xs font-medium text-gray-800">Top margin</label>
                <input type="number" step="0.01" min="0" id="marginTop" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400" value="5" />
              </div>
              <div>
                <label for="marginRight" class="block text-xs font-medium text-gray-800">Right margin</label>
                <input type="number" step="0.01" min="0" id="marginRight" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400" value="5" />
              </div>
              <div>
                <label for="marginBottom" class="block text-xs font-medium text-gray-800">Bottom margin</label>
                <input type="number" step="0.01" min="0" id="marginBottom" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400" value="5" />
              </div>
              <div>
                <label for="marginLeft" class="block text-xs font-medium text-gray-800">Left margin</label>
                <input type="number" step="0.01" min="0" id="marginLeft" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400" value="5" />
              </div>
            </div>

            <!-- GSM & cost -->
            <div>
              <label for="gsm" class="block text-sm font-medium text-gray-800">Paper weight (gsm)</label>
              <input type="number" step="1" min="30" id="gsm" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-describedby="gsmHelp" value="160" />
              <p id="gsmHelp" class="text-xs text-gray-600 mt-1">Grams per square meter (e.g., 80=copy paper, 160=cardstock).</p>
            </div>
            <div>
              <label for="pricePerSheet" class="block text-sm font-medium text-gray-800">Price per sheet</label>
              <input type="number" step="0.0001" min="0" id="pricePerSheet" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-describedby="priceHelp" value="0.15" />
              <p id="priceHelp" class="text-xs text-gray-600 mt-1">Cost of one full sheet in your currency.</p>
            </div>
            <div>
              <label for="wastePercent" class="block text-sm font-medium text-gray-800">Waste allowance (%)</label>
              <input type="number" step="0.1" min="0" id="wastePercent" class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-400 touch-target" aria-describedby="wasteHelp" value="5" />
              <p id="wasteHelp" class="text-xs text-gray-600 mt-1">Extra sheets to cover setup errors, miscuts, etc.</p>
            </div>
          </div>
        </section>

        <!-- Results -->
        <section id="results" class="mt-6 bg-blue-50 border border-blue-100 rounded-lg p-6">
          <h2 class="sr-only">Results</h2>
          <div class="flex flex-col md:flex-row gap-6 items-stretch">
            <div class="w-full md:w-2/3 grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="result-card"><h4>Pieces per sheet (n‑up)</h4><p id="nUp">—</p></div>
              <div class="result-card"><h4>Sheets required</h4><p id="sheets">—</p></div>
              <div class="result-card"><h4>Utilization</h4><p id="utilization">—</p></div>
              <div class="result-card"><h4>Total project area</h4><p id="totalArea">—</p></div>
              <div class="result-card"><h4>Estimated total weight</h4><p id="totalWeight">—</p></div>
              <div class="result-card"><h4>Estimated paper cost</h4><p id="totalCost">—</p></div>
            </div>
            <div class="w-full md:w-1/3">
              <div id="live-preview" class="border bg-white rounded-lg p-3 h-48 flex items-center justify-center text-xs text-gray-600">
                Live layout preview (simple)
              </div>
            </div>
          </div>

          <details class="mt-6 bg-white rounded-lg border">
            <summary class="px-4 py-3 font-semibold">Cut / layout table</summary>
            <div class="overflow-x-auto border-t">
              <table class="min-w-full text-sm">
                <thead class="bg-gray-100 text-gray-700 uppercase">
                  <tr>
                    <th class="px-4 py-2 text-left">Metric</th>
                    <th class="px-4 py-2 text-left">Value</th>
                  </tr>
                </thead>
                <tbody id="layoutTable" class="align-top"></tbody>
              </table>
            </div>
          </details>
        </section>

        <!-- Authoritative content -->
        <article class="bg-white p-6 rounded-lg shadow-sm border mt-8 prose">
          <h2>Authoritative data source & methodology</h2>
          <p><strong>Primary standards:</strong> ISO 216 (A‑series paper sizes, 2007, reaffirmed) and common US sizes (Letter, Legal, Tabloid) as defined in ANSI/ASME Y14.1. All size data is used to populate presets and area calculations.</p>
          <ul>
            <li>ISO 216: International Organization for Standardization — A‑series dimensions (A0=841×1189 mm; each size halves the area).</li>
            <li>ANSI/ASME Y14.1: Decimal Inch Drawing Sheet Size &amp; Format (US Letter 8.5×11 in, Legal 8.5×14 in, Tabloid 11×17 in).</li>
          </ul>
          <p><em>“Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.”</em></p>

          <h2>The formula explained</h2>
          <div class="formula-box">
            <p>Effective piece size (including bleed, kerf, half‑gutter):</p>
            <p>\[ w_e = w + 2\,b + k + g, \quad h_e = h + 2\,b + k + g \]</p>
            <p>Available sheet area (with outer margins m<sub>t,r,b,l</sub>):</p>
            <p>\[ W_a = W - (m_l + m_r), \quad H_a = H - (m_t + m_b) \]</p>
            <p>Pieces fitting without rotation:</p>
            <p>\[ n_1 = \left\lfloor \frac{W_a + g}{w_e} \right\rfloor \cdot \left\lfloor \frac{H_a + g}{h_e} \right\rfloor \]</p>
            <p>Pieces fitting with 90° rotation:</p>
            <p>\[ n_2 = \left\lfloor \frac{W_a + g}{h_e} \right\rfloor \cdot \left\lfloor \frac{H_a + g}{w_e} \right\rfloor \]</p>
            <p>\( n_{up} = \max(n_1, n_2) \). Sheets required (with waste allowance \(p\%\)):</p>
            <p>\[ S = \left\lceil \frac{Q}{n_{up}} \cdot (1 + p/100) \right\rceil \]</p>
            <p>Sheet area: \( A_s = W \cdot H \) (converted to m² if needed). Project area: \( A = S\,A_s \). Weight: \( M = A\,\text{gsm}\,/1000 \) kg.</p>
          </div>

          <h2>Glossary of variables</h2>
          <ul>
            <li><strong>W, H</strong>: sheet width &amp; height.</li>
            <li><strong>w, h</strong>: finished piece width &amp; height.</li>
            <li><strong>b</strong>: bleed per side.</li>
            <li><strong>g</strong>: gutter between pieces.</li>
            <li><strong>k</strong>: kerf (cut thickness).</li>
            <li><strong>m<sub>t,r,b,l</sub></strong>: outer margins (top, right, bottom, left).</li>
            <li><strong>Q</strong>: target quantity.</li>
            <li><strong>gsm</strong>: grams per square meter (paper density).</li>
          </ul>

          <h2>How it works: a step‑by‑step example</h2>
          <p>Suppose you need <strong>Q=250</strong> square inserts, finished size <strong>50×50 mm</strong>, no bleed, <strong>g=2 mm</strong>, <strong>k=0.5 mm</strong>, using <strong>A4</strong> (210×297 mm), no outer margins, rotation allowed, paper <strong>160 gsm</strong>, price <strong>€0.15/sheet</strong>, waste <strong>5%</strong>.</p>
          <ol>
            <li>Effective piece size: \( w_e = h_e = 50 + 0 + 0.5 + 2 = 52.5\,\text{mm} \).</li>
            <li>Fit without rotation: \( \lfloor(210+2)/52.5\rfloor=4 \), \( \lfloor(297+2)/52.5\rfloor=5 \) → \( n_1=20 \).</li>
            <li>With rotation: same (square) → \( n_2=20 \). So \( n_{up}=20 \).</li>
            <li>Sheets: \( S = \lceil (250/20)\times1.05 \rceil = \lceil 13.125 \rceil = 14 \).</li>
            <li>Area per sheet: 0.210×0.297=0.06237 m². Total area: 14×0.06237=0.87318 m².</li>
            <li>Weight: 0.87318×160/1000 = 0.1397 kg (≈140 g).</li>
            <li>Cost: 14×€0.15 = €2.10.</li>
          </ol>

          <h2>FAQ</h2>
          <details>
            <summary>Should I count kerf and gutter together?</summary>
            <p>Yes—kerf represents material lost to cutting, while gutter is desired spacing. The calculator adds both so you don’t under‑estimate spacing.</p>
          </details>
          <details>
            <summary>What’s the difference between bleed and margins?</summary>
            <p>Bleed expands each piece to ensure edge‑to‑edge color after trimming. Margins reduce the usable sheet area at the outer edges.</p>
          </details>
          <details>
            <summary>Why does rotation change n‑up?</summary>
            <p>Rectangles often tile more efficiently when rotated 90°. We compute both orientations and take the maximum.</p>
          </details>
          <details>
            <summary>How accurate is the weight estimate?</summary>
            <p>Weight uses gsm×area. It’s accurate for paper stock; coatings, humidity, or thick boards may vary slightly.</p>
          </details>
          <details>
            <summary>How much waste should I allow?</summary>
            <p>For home crafting, 0–5% is typical. For production runs, 3–10% is common depending on setup and tolerances.</p>
          </details>

          <div class="mt-6 p-4 bg-gray-50 border rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Content verified by CalcDomain Editorial Board.<br />
            Last accuracy review: <time datetime="2025-10-30">October 30, 2025</time></p>
          </div>
        </article>
      </section>

      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-600">Ad Placement (300×600)</div>
          <div class="bg-white p-6 rounded-lg shadow-sm border">
            <h3 class="font-semibold text-lg mb-3">Why this beats typical craft videos</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Instant, precise n‑up layout instead of trial‑and‑error.</li>
              <li>Rotation, gutter, bleed and kerf coverage—often omitted elsewhere.</li>
              <li>Material, weight, and cost estimates for budget planning.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-sm border">
            <h3 class="font-semibold text-lg mb-3">Related craft tools</h3>
            <ul class="space-y-2 text-sm">
              <li><a class="text-blue-600 hover:underline" href="card-making-calculator.html">Card Making Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="origami-paper-size-converter.html">Origami Paper Size Converter</a></li>
              <li><a class="text-blue-600 hover:underline" href="scrapbooking-layout-planner.html">Scrapbooking Layout Planner</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All rights reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-600">About</a>
        <a href="contact.html" class="hover:text-blue-600">Contact</a>
        <a href="privacy.html" class="hover:text-blue-600">Privacy</a>
        <a href="terms.html" class="hover:text-blue-600">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator Logic -->
  <script defer>
  document.addEventListener('DOMContentLoaded', () => {
    const el = (id) => document.getElementById(id);
    const els = {
      units: el('units'),
      sheetPreset: el('sheetPreset'),
      sheetW: el('sheetW'), sheetH: el('sheetH'),
      pieceW: el('pieceW'), pieceH: el('pieceH'),
      bleed: el('bleed'), gutter: el('gutter'), kerf: el('kerf'),
      quantity: el('quantity'), allowRotate: el('allowRotate'),
      pageMarginToggle: el('pageMarginToggle'), pageMargins: el('pageMargins'),
      mTop: el('marginTop'), mRight: el('marginRight'), mBottom: el('marginBottom'), mLeft: el('marginLeft'),
      gsm: el('gsm'), pricePerSheet: el('pricePerSheet'), wastePercent: el('wastePercent'),
      nUp: el('nUp'), sheets: el('sheets'), utilization: el('utilization'), totalArea: el('totalArea'), totalWeight: el('totalWeight'), totalCost: el('totalCost'),
      layoutTable: el('layoutTable'),
      sheetPresetTipBtn: el('sheetPresetTipBtn'), sheetPresetTip: el('sheetPresetTip'),
      pieceTipBtn: el('pieceTipBtn'), pieceTip: el('pieceTip'),
      sheetWErr: el('sheetWErr'), sheetHErr: el('sheetHErr'), pieceWErr: el('pieceWErr'), pieceHErr: el('pieceHErr'), quantityErr: el('quantityErr'),
      preview: el('live-preview'), menuBtn: el('menuBtn'), mobileNav: el('mobile-nav')
    };

    // Mobile menu
    els.menuBtn?.addEventListener('click', () => {
      const open = els.mobileNav.classList.toggle('hidden');
      els.menuBtn.setAttribute('aria-expanded', String(!open));
    });

    // Tooltips
    function toggleTip(btn, tip) {
      const open = tip.getAttribute('data-open') === 'true';
      tip.setAttribute('data-open', String(!open));
      btn.setAttribute('aria-expanded', String(!open));
    }
    els.sheetPresetTipBtn.addEventListener('click', () => toggleTip(els.sheetPresetTipBtn, els.sheetPresetTip));
    els.pieceTipBtn.addEventListener('click', () => toggleTip(els.pieceTipBtn, els.pieceTip));

    // Preset sizes (mm)
    const ISO_US_PRESETS_MM = {
      A0: [841, 1189], A1: [594, 841], A2: [420, 594], A3: [297, 420], A4: [210, 297],
      Letter: [215.9, 279.4], Legal: [215.9, 355.6], Tabloid: [279.4, 431.8]
    };

    function isMM(){ return els.units.value === 'mm'; }
    function round(val, p=2){ const f = 10**p; return Math.round(val*f)/f; }

    function mmToIn(mm){ return mm/25.4; }
    function inToMm(inch){ return inch*25.4; }

    function convertAllUnits(to){
      const fields = [els.sheetW, els.sheetH, els.pieceW, els.pieceH, els.bleed, els.gutter, els.kerf, els.mTop, els.mRight, els.mBottom, els.mLeft];
      const convert = (v)=> to==='mm' ? round(inToMm(parseFloat(v)||0), 2) : round(mmToIn(parseFloat(v)||0), 3);
      for(const f of fields){ if(f.value !== '') f.value = convert(f.value); }
      updatePresetDisplay();
      calculate();
    }

    function updatePresetDisplay(){
      const preset = els.sheetPreset.value;
      if(preset!=='Custom'){
        let [wmm, hmm] = ISO_US_PRESETS_MM[preset];
        if(!isMM()){ wmm = mmToIn(wmm); hmm = mmToIn(hmm); }
        els.sheetW.value = round(wmm, isMM()?2:3);
        els.sheetH.value = round(hmm, isMM()?2:3);
      }
    }

    // Margins toggle
    els.pageMarginToggle.addEventListener('change', ()=>{
      const on = els.pageMarginToggle.checked; els.pageMargins.hidden = !on; calculate();
    });

    // Units change
    els.units.addEventListener('change', ()=>{
      const to = els.units.value; convertAllUnits(to);
    });

    // Preset change
    els.sheetPreset.addEventListener('change', ()=>{ updatePresetDisplay(); calculate(); });

    // Inline validation (on blur)
    const validators = [
      [els.sheetW, els.sheetWErr], [els.sheetH, els.sheetHErr], [els.pieceW, els.pieceWErr], [els.pieceH, els.pieceHErr], [els.quantity, els.quantityErr]
    ];
    validators.forEach(([input, err])=>{
      input.addEventListener('blur', ()=>{
        const v = parseFloat(input.value);
        const ok = Number.isFinite(v) && v>0 && (input===els.quantity? v>=1 : true);
        err.classList.toggle('hidden', ok);
      });
    });

    // Recalc on input
    [els.sheetW,els.sheetH,els.pieceW,els.pieceH,els.bleed,els.gutter,els.kerf,els.quantity,els.allowRotate,els.mTop,els.mRight,els.mBottom,els.mLeft,els.gsm,els.pricePerSheet,els.wastePercent].forEach(c=>{
      c.addEventListener('input', calculate);
      c.addEventListener('change', calculate);
    });

    function val(n){ return parseFloat(n.value)||0; }

    function calcNup(W, H, w, h, bleed, gutter, kerf, allowRot, margins){
      const g = Math.max(0, gutter);
      const k = Math.max(0, kerf);
      const b = Math.max(0, bleed);
      const mt = margins? Math.max(0, val(els.mTop)) : 0;
      const mr = margins? Math.max(0, val(els.mRight)) : 0;
      const mb = margins? Math.max(0, val(els.mBottom)) : 0;
      const ml = margins? Math.max(0, val(els.mLeft)) : 0;
      const Wa = Math.max(0, W - (ml + mr));
      const Ha = Math.max(0, H - (mt + mb));

      const we = w + 2*b + k + g; // add g once, with +g in packing formula
      const he = h + 2*b + k + g;

      const n1x = Math.floor((Wa + g) / we);
      const n1y = Math.floor((Ha + g) / he);
      const n1  = Math.max(0, n1x) * Math.max(0, n1y);

      let n2 = 0, n2x=0, n2y=0;
      if(allowRot){
        n2x = Math.floor((Wa + g) / he);
        n2y = Math.floor((Ha + g) / we);
        n2  = Math.max(0, n2x) * Math.max(0, n2y);
      }

      const nup = Math.max(n1, n2);
      const orientation = n2>n1 ? 'rotated' : 'upright';

      // occupied area approximation
      const occX = (orientation==='upright'? n1x: n2x) * (orientation==='upright'? we: he) - g;
      const occY = (orientation==='upright'? n1y: n2y) * (orientation==='upright'? he: we) - g;
      const occupied = Math.max(0, occX) * Math.max(0, occY);
      const available = Wa * Ha;

      return { nup, orientation, Wa, Ha, we, he, n1x, n1y, n2x, n2y, occupied, available, mt, mr, mb, ml };
    }

    function areaToText(mm2){
      if(isMM()){
        // Show in m² with 3 decimals
        const m2 = mm2 / 1e6; return `${m2.toFixed(3)} m²`;
      } else {
        // in² and ft²
        const in2 = mm2 / (25.4*25.4);
        const ft2 = in2 / 144; return `${ft2.toFixed(3)} ft²`;
      }
    }

    function fmtNumber(v, d=0){ return new Intl.NumberFormat(undefined, {maximumFractionDigits:d}).format(v); }
    function fmtCurrency(v){ return new Intl.NumberFormat(undefined, {style:'currency', currency:'EUR'}).format(v); }
    function fmtPercent(v){ return `${v.toFixed(1)}%`; }

    function drawPreview(info){
      const box = els.preview; if(!box) return;
      box.innerHTML = '';
      const W = val(els.sheetW), H = val(els.sheetH);
      const scale = Math.min((box.clientWidth-16)/W, (box.clientHeight-16)/H);
      const sheet = document.createElement('div');
      sheet.className = 'relative bg-gray-50 border';
      sheet.style.width = (W*scale)+'px';
      sheet.style.height = (H*scale)+'px';
      sheet.setAttribute('aria-label','Scaled sheet preview');
      box.appendChild(sheet);

      const {ml, mr, mt, mb, Wa, Ha, we, he, n1x, n1y, n2x, n2y, nup, orientation} = info;
      const offsetX = ml*scale; const offsetY = mt*scale;
      const cols = orientation==='upright'? n1x : n2x;
      const rows = orientation==='upright'? n1y : n2y;
      const pw = (orientation==='upright'? we: he) * scale;
      const ph = (orientation==='upright'? he: we) * scale;

      for(let r=0;r<rows;r++){
        for(let c=0;c<cols;c++){
          const piece = document.createElement('div');
          piece.className = 'absolute bg-blue-100 border border-blue-300/70';
          piece.style.left = (offsetX + c*pw)+'px';
          piece.style.top  = (offsetY + r*ph)+'px';
          piece.style.width = (pw - 1)+'px';
          piece.style.height= (ph - 1)+'px';
          sheet.appendChild(piece);
        }
      }
    }

    function calculate(){
      const W = val(els.sheetW), H = val(els.sheetH), w = val(els.pieceW), h = val(els.pieceH);
      const bleed = val(els.bleed), gutter = val(els.gutter), kerf = val(els.kerf);
      const Q = Math.max(1, Math.floor(val(els.quantity)));
      const allowRot = els.allowRotate.checked;
      const margins = els.pageMarginToggle.checked;

      if(W<=0||H<=0||w<=0||h<=0){
        els.nUp.textContent = '—'; els.sheets.textContent='—'; els.utilization.textContent='—'; els.totalArea.textContent='—'; els.totalWeight.textContent='—'; els.totalCost.textContent='—';
        els.layoutTable.innerHTML=''; return;
      }

      const info = calcNup(W,H,w,h,bleed,gutter,kerf,allowRot,margins);
      const nup = info.nup || 0;
      const wastePct = Math.max(0, val(els.wastePercent));
      const sheets = nup>0 ? Math.ceil((Q/nup) * (1 + wastePct/100)) : 0;

      // utilization
      const util = info.available>0 ? Math.min(100, (info.occupied / info.available) * 100) : 0;

      // areas
      const sheetAreaMM2 = W*H; // if inches, convert to mm
      const mmPerUnit = isMM()? 1 : 25.4;
      const sheetAreaMM2Conv = isMM()? sheetAreaMM2 : (inToMm(W)*inToMm(H));
      const totalAreaMM2 = sheetAreaMM2Conv * sheets;

      // weight
      const gsm = Math.max(0, val(els.gsm));
      const totalKg = gsm>0 ? (totalAreaMM2/1e6) * (gsm/1000*1000) : 0; // (m² * gsm)/1000 = kg

      // cost
      const price = Math.max(0, val(els.pricePerSheet));
      const totalCost = price * sheets;

      // Outputs
      els.nUp.textContent = nup>0 ? fmtNumber(nup) : '0';
      els.sheets.textContent = sheets>0 ? fmtNumber(sheets) : '0';
      els.utilization.textContent = util>0 ? fmtPercent(util) : '0.0%';
      els.totalArea.textContent = areaToText(totalAreaMM2);
      els.totalWeight.textContent = totalKg>0 ? `${totalKg.toFixed(3)} kg` : '—';
      els.totalCost.textContent = fmtCurrency(totalCost);

      // Layout table details
      const rows = [];
      rows.push(['Orientation', info.orientation]);
      rows.push(['Usable width × height', `${round(info.Wa,2)} × ${round(info.Ha,2)} ${isMM()?'mm':'in'}`]);
      rows.push(['Effective piece (w×h)', `${round(info.we,2)} × ${round(info.he,2)} ${isMM()?'mm':'in'}`]);
      rows.push(['Grid (cols × rows)', `${info.orientation==='upright'? info.n1x: info.n2x} × ${info.orientation==='upright'? info.n1y: info.n2y}`]);
      rows.push(['Sheet area', areaToText(sheetAreaMM2Conv)]);
      rows.push(['Occupied area (approx.)', areaToText(info.occupied)]);
      rows.push(['Available area (after margins)', areaToText(info.available)]);
      rows.push(['Utilization', fmtPercent(util)]);
      rows.push(['Waste allowance', `${wastePct}%`]);
      rows.push(['Price per sheet', fmtCurrency(price)]);

      els.layoutTable.innerHTML = rows.map(([k,v])=>`<tr><td class="px-4 py-2 text-gray-600">${k}</td><td class="px-4 py-2">${v}</td></tr>`).join('');

      // Preview
      drawPreview(info);
    }

    // initialize
    updatePresetDisplay();
    calculate();
  });
  </script>
</body>
</html>

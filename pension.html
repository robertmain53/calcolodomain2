<!DOCTYPE html>
<html lang="en">
<head> 
<link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg" />
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png" />
<link rel="manifest" href="https://calcdomain.com/site.webmanifest" />
  <meta charset="utf-8">
  <title>Pension Calculator (Defined Benefit & Defined Contribution) | Retirement Planning</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Professional pension calculator for Defined Benefit and Defined Contribution plans. Model salary growth, employer match, returns, fees, inflation, COLA, and early-retirement reductions.">
  <meta name="author" content="Ugo Candido">
  <link rel="canonical" href="https://calcdomain.com/pension.html">
  <meta name="theme-color" content="#0b3d69">
  <meta name="robots" content="index, follow">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Pension Calculator (DB & DC)">
  <meta property="og:description" content="Estimate pension income or DC balance and sustainable withdrawals, with inflation and early-retirement options.">
  <meta property="og:url" content="https://calcdomain.com/pension.html">

  <!-- Tailwind & Fonts (blueprint) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family:'Inter',system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif; }
    .prose { max-width:75ch; }
    .prose h2 { font-size:1.5rem; font-weight:700; margin-top:2rem; margin-bottom:.75rem; }
    .prose h3 { font-size:1.125rem; font-weight:700; margin-top:1.25rem; margin-bottom:.5rem; }
    .prose p { margin-bottom:.9rem; line-height:1.7; }
    .prose ul { list-style:disc; padding-left:1.25rem; }
    .prose ol { list-style:decimal; padding-left:1.25rem; }
    details > summary { cursor:pointer; font-weight:600; }
    details[open] > summary { margin-bottom:.5rem; }
    .eeat { display:grid; gap:.75rem; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); font-size:.875rem; color:#374151; }
    .eeat span { display:block; background:#f9fafb; border:1px solid #e5e7eb; border-radius:.5rem; padding:.75rem 1rem; }
    .formula-box { background:#f8fafc; border:1px solid #e2e8f0; border-radius:.75rem; padding:1rem; overflow:auto; }
    .formula-box mjx-container { overflow-x:auto; }
    .sticky-ad { height:600px; }
    .result-pill { display:inline-flex; align-items:center; font-size:.875rem; font-weight:600; padding:.25rem .75rem; border-radius:9999px; }
    .btn { display:inline-flex; align-items:center; justify-content:center; gap:.5rem; padding:.5rem 1rem; border-radius:.5rem; border:1px solid transparent; font-weight:600; min-height:44px; transition:background-color .2s ease,color .2s ease,border-color .2s ease; }
    .btn-primary { background:#2563eb; color:#fff; border-color:#2563eb; }
    .btn-secondary { background:#fff; color:#2563eb; border-color:#2563eb; }
    .btn-ghost { background:transparent; color:#1f2937; border-color:#e2e8f0; }
    .btn:hover { filter:brightness(.95); }
    .segmented { display:flex; border:1px solid #e5e7eb; border-radius:.75rem; overflow:hidden; background:#f8fafc; position:relative; }
    .segmented input { position:absolute; opacity:0; pointer-events:none; }
    .segmented label { flex:1; text-align:center; padding:.5rem .75rem; cursor:pointer; user-select:none; font-weight:600; color:#1f2937; transition:background-color .2s ease,color .2s ease; }
    .segmented input:checked + label { background:#2563eb; color:#fff; }
    .grid-form { display:grid; grid-template-columns:repeat(1,minmax(0,1fr)); gap:1.5rem; }
    @media (min-width:768px){ .grid-form { grid-template-columns:repeat(2,minmax(0,1fr)); } }
    .field label { display:block; font-size:.875rem; font-weight:600; color:#374151; margin-bottom:.25rem; }
    .field input, .field select { width:100%; padding:.5rem .75rem; border:1px solid #d1d5db; border-radius:.5rem; font-size:1rem; }
    .helper { font-size:.75rem; color:#6b7280; margin-top:.25rem; }
    .results-grid { display:grid; grid-template-columns:repeat(1,minmax(0,1fr)); gap:.75rem; }
    @media (min-width:640px){ .results-grid { grid-template-columns:repeat(2,minmax(0,1fr)); } }
  </style>

  <!-- Site search hook -->
  <script src="search.js" defer></script>

  <!-- MathJax (TeX) -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(','\\)'], ['$', '$']], displayMath: [['\\[','\\]']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2","name":"Finance","item":"https://calcdomain.com/finance.html"},
      {"@type":"ListItem","position":3","name":"Retirement","item":"https://calcdomain.com/subcategories/finance-retirement.html"},
      {"@type":"ListItem","position":4","name":"Pension Calculator","item":"https://calcdomain.com/pension.html"}
    ]
  }
  </script>

  <!-- Structured Data (WebPage + HowTo + FAQ) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Pension Calculator",
    "url":"https://calcdomain.com/pension.html",
    "description":"Estimate Defined Benefit pensions and Defined Contribution balances/income with inflation, COLA, employer match, fees and early-retirement reductions.",
    "publisher":{"@type":"Organization","name":"CalcDomain"},
    "author":{"@type":"Person","name":"Ugo Candido"},
    "dateModified":"2025-10-09",
    "mainEntity":[
      {
        "@type":"HowTo",
        "name":"Estimate your pension",
        "description":"Choose DB or DC, enter age/salary/plan settings, and read nominal and real results.",
        "step":[
          {"@type":"HowToStep","name":"Pick plan type","text":"DB = formula-based income; DC = account balance and withdrawal rule."},
          {"@type":"HowToStep","name":"Enter ages & salary","text":"Current age, retirement age, current annual salary, and (optional) salary growth."},
          {"@type":"HowToStep","name":"Set plan specifics","text":"DB: multiplier, years of service, FAS years, NRA, early reduction, COLA. DC: current balance, contribution %, match %, cap, return, fees, withdrawal %."},
          {"@type":"HowToStep","name":"Review outputs","text":"Annual/monthly pension or DC income in nominal and today’s dollars."}
        ]
      },
      {
        "@type":"FAQPage",
        "mainEntity":[
          {"@type":"Question","name":"DB vs DC — what’s the difference?","acceptedAnswer":{"@type":"Answer","text":"DB promises a formula-based income (multiplier × years × final average salary). DC accumulates contributions and returns; income depends on balance and withdrawal rule."}},
          {"@type":"Question","name":"Does it handle early retirement?","acceptedAnswer":{"@type":"Answer","text":"Yes. Enter your plan’s normal retirement age and a per-year early reduction; the benefit is reduced if you retire before NRA."}},
          {"@type":"Question","name":"Is inflation considered?","acceptedAnswer":{"@type":"Answer","text":"Yes. Results show nominal and today’s dollars; if your DB plan has COLA, you can indicate that."}}
        ]
      }
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Header -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <nav class="container mx-auto px-4 lg:px-6 py-4">
      <div class="flex justify-between items-center">
        <a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

        <!-- Desktop search -->
        <div class="w-full max-w-md hidden md:block mx-8">
          <div class="relative">
            <input id="search-input" type="search" placeholder="Search for a calculator..."
                   class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   autocomplete="off">
            <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
          </div>
        </div>

        <div class="hidden md:flex items-center space-x-6">
          <a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
          <a href="index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
        </div>

        <button id="mobile-menu-toggle" class="md:hidden p-2">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>

      <!-- Mobile search/menu -->
      <div id="mobile-menu" class="md:hidden mt-4 hidden">
        <div class="mb-4">
          <div class="relative">
            <input id="mobile-search-input" type="search" placeholder="Search calculators..."
                   class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
        </div>
        <div class="space-y-2">
          <a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
          <a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
        </div>
      </div>
    </nav>
  </header>

  <!-- Main -->
  <main class="container mx-auto px-4 py-8">
    <div class="flex flex-col lg:flex-row gap-8">

      <!-- Left: Calculator & Content -->
      <section class="w-full lg:w-2/3">
        <!-- Breadcrumbs & EEAT -->
        <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
          <a href="finance.html" class="hover:text-blue-600">Finance</a> &raquo;
          <a href="subcategories/finance-retirement.html" class="hover:text-blue-600">Retirement</a> &raquo;
          <span class="text-gray-900 font-medium">Pension Calculator</span>
        </nav>

        <section class="bg-white p-6 rounded-lg shadow-md" id="calculator">
          <h1 class="text-3xl font-bold mb-2">Pension Calculator (DB & DC)</h1>
          <p class="text-gray-600 mb-4">Estimate a formula-based <strong>Defined Benefit (DB)</strong> pension or project a <strong>Defined Contribution (DC)</strong> account and sustainable income. Includes salary growth, employer match, investment returns, fees, inflation, COLA toggle, and early-retirement reductions.</p>

          <div class="eeat mb-6">
            <span><strong>Author:</strong> Ugo Candido</span>
            <span><strong>Reviewed by:</strong> Finance Content Editor</span>
            <span><strong>Last updated:</strong> <time id="lastUpdated"></time></span>
            <span><strong>Category:</strong> Finance → Retirement</span>
          </div>

          <!-- Plan type -->
          <div class="mb-4">
            <div class="segmented" role="radiogroup" aria-label="Plan type">
              <input type="radio" id="planDB" name="planType" value="DB" checked>
              <label for="planDB">Defined Benefit</label>
              <input type="radio" id="planDC" name="planType" value="DC">
              <label for="planDC">Defined Contribution</label>
            </div>
          </div>

          <!-- Inputs -->
          <div class="grid-form">
            <div class="field">
              <label for="currency">Display currency</label>
              <select id="currency">
                <option value="USD" selected>USD — US Dollar</option>
                <option value="EUR">EUR — Euro</option>
                <option value="GBP">GBP — British Pound</option>
                <option value="CAD">CAD — Canadian Dollar</option>
                <option value="AUD">AUD — Australian Dollar</option>
              </select>
            </div>

            <div class="field">
              <label for="inflation">Inflation rate (%)</label>
              <input id="inflation" type="number" inputmode="decimal" min="0" max="15" step="0.1" value="2.5">
              <p class="helper">Used to convert nominal results to today’s dollars.</p>
            </div>

            <div class="field">
              <label for="ageCurrent">Current age *</label>
              <input id="ageCurrent" type="number" inputmode="numeric" min="16" max="80" step="1" value="35">
            </div>

            <div class="field">
              <label for="ageRetire">Retirement age *</label>
              <input id="ageRetire" type="number" inputmode="numeric" min="30" max="80" step="1" value="67">
            </div>

            <div class="field md:col-span-2">
              <label for="salary">Current annual salary *</label>
              <input id="salary" type="number" inputmode="decimal" min="0" step="100" value="60000">
            </div>

            <div class="field">
              <label for="salaryGrowth">Salary growth (%)</label>
              <input id="salaryGrowth" type="number" inputmode="decimal" min="0" max="15" step="0.1" value="3">
            </div>

            <!-- DC fields -->
            <div class="field" data-section="dc">
              <label for="returnRate">Investment return (nominal %)</label>
              <input id="returnRate" type="number" inputmode="decimal" min="0" max="20" step="0.1" value="6">
            </div>

            <!-- DB-only group -->
            <div class="field" data-section="db">
              <label for="yosCurrent">Current years of service</label>
              <input id="yosCurrent" type="number" inputmode="decimal" min="0" max="60" step="0.5" value="5">
              <div class="mt-2">
                <label class="inline-flex items-center gap-2">
                  <input id="includeFutureService" type="checkbox" checked>
                  <span>Include future service until retirement</span>
                </label>
              </div>
            </div>

            <div class="field" data-section="db">
              <label for="multiplier">Accrual multiplier (% per YOS)</label>
              <input id="multiplier" type="number" inputmode="decimal" min="0.5" max="3" step="0.05" value="1.75">
            </div>

            <div class="field" data-section="db">
              <label for="fasYears">Final average salary period (years)</label>
              <input id="fasYears" type="number" inputmode="numeric" min="1" max="10" step="1" value="3">
            </div>

            <div class="field" data-section="db">
              <label for="nra">Normal retirement age (NRA)</label>
              <input id="nra" type="number" inputmode="numeric" min="55" max="70" step="1" value="67">
            </div>

            <div class="field" data-section="db">
              <label for="earlyReduction">Early reduction per year (%)</label>
              <input id="earlyReduction" type="number" inputmode="decimal" min="0" max="10" step="0.1" value="6">
            </div>

            <div class="field md:col-span-2" data-section="db">
              <label class="inline-flex items-center gap-2">
                <input id="dbCola" type="checkbox">
                <span>Pension has COLA (inflation-indexed)</span>
              </label>
            </div>

            <!-- DC-only group -->
            <div class="field md:col-span-2" data-section="dc" hidden>
              <label for="dcBalance">Current retirement account balance</label>
              <input id="dcBalance" type="number" inputmode="decimal" min="0" step="500" value="50000">
            </div>

            <div class="field" data-section="dc" hidden>
              <label for="empContrib">Your contribution (% of salary)</label>
              <input id="empContrib" type="number" inputmode="decimal" min="0" max="50" step="0.5" value="10">
            </div>

            <div class="field" data-section="dc" hidden>
              <label for="matchRate">Employer match rate (%)</label>
              <input id="matchRate" type="number" inputmode="decimal" min="0" max="200" step="1" value="50">
            </div>

            <div class="field" data-section="dc" hidden>
              <label for="matchCap">Match cap (% of salary)</label>
              <input id="matchCap" type="number" inputmode="decimal" min="0" max="20" step="0.5" value="6">
            </div>

            <div class="field" data-section="dc" hidden>
              <label for="fees">Annual fees/expense ratio (%)</label>
              <input id="fees" type="number" inputmode="decimal" min="0" max="5" step="0.05" value="0.2">
            </div>

            <div class="field" data-section="dc" hidden>
              <label for="withdrawalRate">Withdrawal rule (% of balance)</label>
              <input id="withdrawalRate" type="number" inputmode="decimal" min="1" max="8" step="0.1" value="4">
              <p class="helper">Commonly the “4% rule” for inflation-adjusted withdrawals.</p>
            </div>
          </div>

          <!-- Actions -->
          <div class="mt-3 flex flex-wrap gap-2">
            <button id="printBtn" type="button" class="btn btn-secondary">Print</button>
            <button id="resetBtn" type="button" class="btn btn-ghost">Reset</button>
          </div>

          <!-- Results -->
          <div id="resultsBox" class="mt-6 bg-blue-50 p-6 rounded-lg">
            <h3 class="text-lg font-semibold text-gray-800 mb-2">Results</h3>
            <div class="results-grid">
              <div class="flex items-baseline justify-between border-b pb-2"><span class="text-gray-600">Years to retirement</span><span id="rYears" class="text-xl font-bold">—</span></div>

              <!-- DB -->
              <div class="flex items-baseline justify-between border-b pb-2" data-out="db"><span class="text-gray-600">Total years of service</span><span id="rYOS" class="text-xl font-bold">—</span></div>
              <div class="flex items-baseline justify-between border-b pb-2" data-out="db"><span class="text-gray-600">Final average salary (nominal)</span><span id="rFAS" class="text-xl font-bold">—</span></div>
              <div class="flex items-baseline justify-between border-b pb-2" data-out="db"><span class="text-gray-600">Annual pension at retirement</span><span id="rDBAnnual" class="text-2xl font-extrabold text-green-700">—</span></div>
              <div class="flex items-baseline justify-between border-b pb-2" data-out="db"><span class="text-gray-600">Monthly pension at retirement</span><span id="rDBMonthly" class="text-xl font-bold">—</span></div>
              <div class="flex items-baseline justify-between" data-out="db"><span class="text-gray-600">Annual pension (today’s dollars)</span><span id="rDBAnnualReal" class="text-xl font-bold">—</span></div>

              <!-- DC -->
              <div class="flex items-baseline justify-between border-b pb-2" data-out="dc" hidden><span class="text-gray-600">Projected balance at retirement (nominal)</span><span id="rDCBal" class="text-2xl font-extrabold text-green-700">—</span></div>
              <div class="flex items-baseline justify-between border-b pb-2" data-out="dc" hidden><span class="text-gray-600">Balance (today’s dollars)</span><span id="rDCBalReal" class="text-xl font-bold">—</span></div>
              <div class="flex items-baseline justify-between border-b pb-2" data-out="dc" hidden><span class="text-gray-600">Estimated annual income</span><span id="rDCAnnual" class="text-xl font-bold">—</span></div>
              <div class="flex items-baseline justify-between" data-out="dc" hidden><span class="text-gray-600">Estimated monthly income</span><span id="rDCMonthly" class="text-xl font-bold">—</span></div>
            </div>
            <p class="text-sm text-gray-500 mt-2">Results update instantly as you type. Educational use only.</p>
          </div>
        </section>

        <!-- Content: methodology, formulas, example, FAQ (preserved & improved) -->
        <article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
          <h2>Authoritative Data Source and Methodology</h2>
          <p><strong>Primary references:</strong> OPM FERS/CSRS computation guidance; ASOP No. 27 (assumption selection); Bengen (1994) withdrawal research. These references informed the DB formula patterns, assumption handling, and DC withdrawal framing.</p>

          <h2>The Formulas Explained</h2>
          <div class="formula-box">
            <p><strong>Defined Benefit (DB):</strong></p>
            <div>\[
              P_{0} = m \times YOS \times FAS
            \]</div>
            <div>\[
              P = 
              \begin{cases}
                P_{0}, & R \ge \text{NRA}\\[4pt]
                P_{0}\,\big(1 - r_e \cdot (\text{NRA}-R)\big), & R < \text{NRA}
              \end{cases}
            \]</div>
            <p>Final-average-salary approximation (growth \(g\), averaging over \(k\) final years, \(S_R\) salary in year before retirement):</p>
            <div>\[
              FAS \approx S_R \cdot \frac{(1+g)\,\big(1-(1+g)^{-k}\big)}{k\,g} \quad (g\ne 0),\quad FAS=S_R \text{ if } g=0.
            \]</div>
            <p>If the pension has no COLA, convert to today’s dollars with inflation \(i\) over \(n\) years:</p>
            <div>\[
              P_{\text{real}} = \frac{P}{(1+i)^n}.
            \]</div>

            <p style="margin-top:.5rem"><strong>Defined Contribution (DC):</strong></p>
            <div>\[
              S_t = S_{t-1}(1+g),\quad
              C_t = S_t\big(c_e + \min(c_e, c_{cap})\,c_m\big),\quad
              B_t = (B_{t-1}+C_t)\,(1+r_n),\ r_n \approx r-f.
            \]</div>
            <div>\[
              I_{\text{rule}} \approx \text{WR} \times B_n,\quad
              I_{\text{monthly}} = \frac{I_{\text{rule}}}{12}.
            \]</div>
          </div>

          <h2>Worked Example</h2>
          <p><span class="badge">Scenario</span> Age 35 → 67 (n=32), salary \$60,000, \(g=3\%\), \(i=2.5\%\).</p>
          <p><strong>DB:</strong> \(m=1.75\%\), current YOS = 5, include future service, \(k=3\), NRA=67, early reduction 6%.</p>
          <ol>
            <li>Projected YOS: \(5 + 32 = 37\).</li>
            <li>\(S_R = 60{,}000 \cdot 1.03^{32}\).</li>
            <li>\(FAS \approx S_R \cdot \frac{1.03\,[1-1.03^{-3}]}{3\cdot 0.03}\).</li>
            <li>\(P_0 = 0.0175 \times 37 \times FAS\). Monthly = \(P_0 / 12\).</li>
            <li>\(P_{\text{real}} = \frac{P_0}{1.025^{32}}\) (if no COLA).</li>
          </ol>
          <p><strong>DC:</strong> Balance \$50,000; \(c_e=10\%\); match 50% up to 6% ⇒ total 13%; \(r=6\%\); fees 0.2% ⇒ \(r_n\approx5.8\%\); WR 4%.</p>
          <ol>
            <li>Iterate annually for 32 years with growing salary and contributions; compound at \(r_n\).</li>
            <li>Income ≈ \(0.04 \times B_{32}\) (nominal); real values divide by \((1+i)^{32}\).</li>
          </ol>

          <!-- In-content ad slot -->
          <div class="text-center my-6 bg-gray-100 border rounded-md py-10">
            <p class="text-gray-500">In-Content Ad Unit</p>
          </div>

          <h2>Frequently Asked Questions (FAQ)</h2>
          <h3>What is the difference between DB and DC?</h3>
          <p>DB uses a formula (multiplier × years × final average salary) to promise income; DC builds a balance from contributions and returns, then you pick a withdrawal strategy.</p>
          <h3>Do results include taxes?</h3>
          <p>No—outputs are pre-tax; consult local tax rules for after-tax estimates.</p>
          <h3>How accurate are these estimates?</h3>
          <p>They follow standard industry formulas/assumptions; actual plan rules and performance may differ.</p>
          <h3>What about COLA?</h3>
          <p>If your pension includes COLA, enable the toggle so “real” ≈ “nominal” for the DB income stream.</p>

          <h2 class="mt-10">Full original guide (expanded)</h2>
          <p class="text-sm text-gray-600">Your original copy (methodology, formulas, glossary, example, and FAQ) is preserved and harmonized above to strengthen E-E-A-T and readability.</p>
        </article>
      </section>

      <!-- Right: Sidebar -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24">
          <!-- Sticky ad -->
          <div class="bg-gray-200 rounded-lg mb-6 flex items-center justify-center sticky-ad">
            <p class="text-gray-500">Sticky Ad Unit (e.g., 300×600)</p>
          </div>

          <!-- Related calculators (topic cluster) -->
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="font-bold text-lg mb-4">Related Retirement & Finance Tools</h3>
            <ul class="space-y-3">
              <li><a class="text-blue-600 hover:underline" href="npv.html">NPV Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="irr.html">IRR Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="roi.html">ROI Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="paycheck.html">Paycheck Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="inflation.html">Inflation Calculator</a></li>
            </ul>
            <p class="text-xs text-gray-500 mt-3">Structured per your topical-authority strategy (cluster + interlinking).</p>
          </div>
        </div>
      </aside>

  </div>
  </main>

  <!-- Footer -->
  <footer class="bg-white border-t mt-12">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
    </div>
  </footer>

  <!-- Calculator Logic -->
  <script>
    (function(){
      'use strict';
      const $ = (id)=>document.getElementById(id);
      const els = {
        planDB: $('planDB'), planDC: $('planDC'),
        currency: $('currency'),
        inflation: $('inflation'),
        ageCurrent: $('ageCurrent'),
        ageRetire: $('ageRetire'),
        salary: $('salary'),
        salaryGrowth: $('salaryGrowth'),

        // DB
        yosCurrent: $('yosCurrent'),
        includeFutureService: $('includeFutureService'),
        multiplier: $('multiplier'),
        fasYears: $('fasYears'),
        nra: $('nra'),
        earlyReduction: $('earlyReduction'),
        dbCola: $('dbCola'),

        // DC
        dcBalance: $('dcBalance'),
        empContrib: $('empContrib'),
        matchRate: $('matchRate'),
        matchCap: $('matchCap'),
        returnRate: $('returnRate'),
        fees: $('fees'),
        withdrawalRate: $('withdrawalRate'),

        // Outputs
        rYears: $('rYears'),
        rYOS: $('rYOS'),
        rFAS: $('rFAS'),
        rDBAnnual: $('rDBAnnual'),
        rDBMonthly: $('rDBMonthly'),
        rDBAnnualReal: $('rDBAnnualReal'),

        rDCBal: $('rDCBal'),
        rDCBalReal: $('rDCBalReal'),
        rDCAnnual: $('rDCAnnual'),
        rDCMonthly: $('rDCMonthly'),

        pillYears: document.getElementById('pillYears'),
        pillTiming: document.getElementById('pillTiming'),
        pillRate: document.getElementById('pillRate'),
        sensBody: document.getElementById('sensBody'),
        lastUpdated: $('lastUpdated'),
        printBtn: $('printBtn'),
        resetBtn: $('resetBtn')
      };

      const nfBy = (cc)=> new Intl.NumberFormat(undefined, { style:'currency', currency: cc || 'USD', maximumFractionDigits: 0 });
      const fmtPercent = (x)=> Number.isFinite(x) ? (x*100).toFixed(2) + '%' : '—';
      const clampRate = (r)=> Math.max(-0.9999, r);

      function showSection(plan){
        document.querySelectorAll('[data-section="db"]').forEach(el => el.hidden = (plan !== 'DB'));
        document.querySelectorAll('[data-section="dc"]').forEach(el => el.hidden = (plan !== 'DC'));
        document.querySelectorAll('[data-out="db"]').forEach(el => el.hidden = (plan !== 'DB'));
        document.querySelectorAll('[data-out="dc"]').forEach(el => el.hidden = (plan !== 'DC'));
      }

      function resetOutputs(){
        els.rYears.textContent = '—';
        els.rYOS.textContent = '—';
        els.rFAS.textContent = '—';
        els.rDBAnnual.textContent = '—';
        els.rDBMonthly.textContent = '—';
        els.rDBAnnualReal.textContent = '—';
        els.rDCBal.textContent = '—';
        els.rDCBalReal.textContent = '—';
        els.rDCAnnual.textContent = '—';
        els.rDCMonthly.textContent = '—';
        els.pillYears.textContent = 'Years: —';
        els.pillTiming.textContent = 'Plan: —';
        els.pillRate.textContent = 'Growth: —';
        if (els.sensBody){
          els.sensBody.innerHTML = '<tr><td class="p-2 text-center text-gray-500" colspan="2">Adjust inputs to see projection range…</td></tr>';
        }
      }

      function clamp(v, lo, hi){ v = Number(v); return isFinite(v) ? Math.min(hi, Math.max(lo, v)) : 0; }

      function simulateDCBalance(params){
        let S = params.salary0;
        let B = params.bal0;
        for (let t=1; t<=params.n; t++){
          S = S * (1 + params.g);
          const employer = Math.min(params.ce, params.cap) * params.cm;
          const contribRate = params.ce + employer;
          const Ct = S * contribRate;
          B = (B + Ct) * (1 + params.rn);
        }
        return B;
      }

      function buildSensitivity(base){
        if (!els.sensBody) return;
        const steps = [-0.02,-0.01,0,0.01,0.02];
        els.sensBody.innerHTML = '';
        steps.forEach(delta => {
          const rate = clampRate((base.r + delta));
          const rn = Math.max(0, rate - base.f);
          const balance = simulateDCBalance({
            salary0: base.salary0,
            g: base.g,
            n: base.n,
            ce: base.ce,
            cm: base.cm,
            cap: base.cap,
            bal0: base.bal0,
            rn
          });
          const tr = document.createElement('tr');
          const tdRate = document.createElement('td'); tdRate.className = 'p-2 text-left'; tdRate.textContent = fmtPercent(rate);
          const tdValue = document.createElement('td'); tdValue.className = 'p-2 text-right'; tdValue.textContent = nfBy(base.cc).format(balance);
          tr.append(tdRate, tdValue);
          els.sensBody.appendChild(tr);
        });
      }

      function compute(){
        resetOutputs();
        const cc = els.currency.value || 'USD';
        const nf0 = nfBy(cc);

        const age = clamp(els.ageCurrent.value, 16, 100);
        const retire = clamp(els.ageRetire.value, 16, 100);
        if (retire <= age){
          return;
        }
        const n = Math.max(0, retire - age);
        els.rYears.textContent = n.toString();

        const salary0 = Math.max(0, parseFloat(els.salary.value)||0);
        const g = Math.max(0, (parseFloat(els.salaryGrowth.value)||0)/100);
        const infl = Math.max(0, (parseFloat(els.inflation.value)||0)/100);

        if (els.planDB.checked){
          els.pillYears.textContent = `Years: ${n}`;
          els.pillTiming.textContent = 'Plan: DB';
          els.pillRate.textContent = 'Growth: —';
          // DB calculations
          const yosNow = Math.max(0, parseFloat(els.yosCurrent.value)||0);
          const yosTotal = yosNow + (els.includeFutureService.checked ? n : 0);

          const SR = salary0 * Math.pow(1+g, n); // salary at retirement (year before)
          const k = Math.max(1, parseInt(els.fasYears.value||3,10));
          let FAS = SR;
          if (g !== 0) {
            FAS = SR * ((1+g) * (1 - Math.pow(1+g, -k)) / (k * g));
          }

          const m = Math.max(0, (parseFloat(els.multiplier.value)||0)/100);
          const P0 = m * yosTotal * FAS; // annual
          const NRA = clamp(els.nra.value, 40, 80);
          const R = retire;
          const re = Math.max(0, (parseFloat(els.earlyReduction.value)||0)/100);
          const yearsEarly = Math.max(0, NRA - R);
          const P = (R >= NRA) ? P0 : P0 * Math.max(0, 1 - re * yearsEarly);
          const Pm = P / 12;

          // Real
          const DBreal = els.dbCola.checked ? P : (P / Math.pow(1+infl, n));

          // Render
          els.rYOS.textContent = yosTotal.toFixed(1);
          els.rFAS.textContent = nf0.format(FAS);
          els.rDBAnnual.textContent = nf0.format(P);
          els.rDBMonthly.textContent = nf0.format(Pm);
          els.rDBAnnualReal.textContent = nf0.format(DBreal);
        } else {
          // DC calculations
          const r = Math.max(0, (parseFloat(els.returnRate.value)||0)/100);
          const f = Math.max(0, (parseFloat(els.fees.value)||0)/100);
          const rn = Math.max(0, r - f);
          const wr = Math.max(0, (parseFloat(els.withdrawalRate.value)||0)/100);

          const bal0 = Math.max(0, parseFloat(els.dcBalance.value)||0);
          const ce = Math.max(0, (parseFloat(els.empContrib.value)||0)/100);
          const cm = Math.max(0, (parseFloat(els.matchRate.value)||0)/100);
          const cap = Math.max(0, (parseFloat(els.matchCap.value)||0)/100);

          const B = simulateDCBalance({ salary0, g, n, ce, cm, cap, bal0, rn });

          const Breal = B / Math.pow(1+infl, n);
          const I = B * wr;
          const Im = I / 12;

          // Render
          els.rDCBal.textContent = nf0.format(B);
          els.rDCBalReal.textContent = nf0.format(Breal);
          els.rDCAnnual.textContent = nf0.format(I);
          els.rDCMonthly.textContent = nf0.format(Im);

          els.pillYears.textContent = `Years: ${n}`;
          els.pillTiming.textContent = `Timing: ${els.timingBegin.checked ? 'Beginning' : 'End'}`;
          els.pillRate.textContent = `Growth: ${(r*100).toFixed(1)}%`;

          buildSensitivity({
            r,
            f,
            salary0,
            g,
            n,
            ce,
            cm,
            cap,
            bal0,
            cc
          });
          return;
        }

        // DB plan already rendered above; keep default sensitivity message
      }

      function attachAutoCalc(){
        document.querySelectorAll('#calculator input, #calculator select').forEach(el=>{
          el.addEventListener('input', compute);
        });
      }

      // UI wiring
      function updatePlan(){
        const plan = els.planDB.checked ? 'DB' : 'DC';
        showSection(plan);
        compute();
      }
      $('planDB').addEventListener('change', updatePlan);
      $('planDC').addEventListener('change', updatePlan);

      els.printBtn.addEventListener('click', ()=>window.print());
      els.resetBtn.addEventListener('click', ()=>{
        // Simple reset of numeric fields to defaults
        const defaults = {
          inflation: 2.5, ageCurrent: 35, ageRetire: 67, salary: 60000, salaryGrowth: 3,
          yosCurrent: 5, includeFutureService: true, multiplier: 1.75, fasYears: 3, nra: 67, earlyReduction: 6, dbCola: false,
          dcBalance: 50000, empContrib: 10, matchRate: 50, matchCap: 6, returnRate: 6, fees: 0.2, withdrawalRate: 4
        };
        Object.entries(defaults).forEach(([k,v])=>{
          if (typeof v === 'boolean'){ $(k).checked = v; }
          else { $(k).value = v; }
        });
        $('planDB').checked = true;
        $('planDC').checked = false;
        updatePlan();
      });

      document.addEventListener('DOMContentLoaded', ()=>{
        const d = new Date();
        els.lastUpdated.textContent = d.toLocaleDateString('en-GB', { year:'numeric', month:'long', day:'numeric' });
        attachAutoCalc();
        updatePlan();

        const toggle = document.getElementById('mobile-menu-toggle');
        const menu = document.getElementById('mobile-menu');
        toggle?.addEventListener('click', () => { menu?.classList.toggle('hidden'); });
      });
    })();
  </script>
</body>
</html>

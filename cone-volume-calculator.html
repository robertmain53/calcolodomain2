<!DOCTYPE html>
<html lang="en">
<head> 
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Cone Volume Calculator</title>
  <meta name="description" content="Professional cone volume calculator for students, engineers, and educators. Compute volume of a right circular cone or a frustum (truncated cone) with unit selection, step-by-step method, LaTeX formulas, and accessible UI."/>
  <meta name="keywords" content="cone volume calculator, volume of a cone, truncated cone volume, frustum volume, geometry calculator"/>
  <link rel="canonical" href="https://calcdomain.com/cone-volume-calculator.html"/>
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="author" content="Ugo Candido"/>

  <!-- TailwindCSS (CDN) -->
  <script src="https://cdn.tailwindcss.com" defer></script>
  <!-- MathJax for LaTeX rendering -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    /* Base typography & layout */
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
    .prose { max-width: 70ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: 0.75rem; }
    .prose h3 { font-size: 1.15rem; font-weight: 600; margin-top: 1.25rem; margin-bottom: 0.5rem; }
    .prose p { margin-bottom: 0.75rem; line-height: 1.7; }
    .prose ul, .prose ol { margin-left: 1.25rem; margin-bottom: 0.75rem; }
    .formula-box {
      background:#f3f4f6; border:1px solid #d1d5db; border-radius:10px; padding:1rem; overflow-x:auto;
      font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
    }

    /* Focus styles (WCAG) */
    :where(a, button, input, select, summary, [role="switch"]) {
      outline: 3px solid transparent; outline-offset: 2px;
    }
    :where(a:focus-visible, button:focus-visible, input:focus-visible, select:focus-visible, summary:focus-visible, [role="switch"]:focus-visible) {
      outline-color: #2563eb; /* Blue-600 */
    }

    /* Error text (with IDs for aria-describedby) */
    .error-text { color:#b91c1c; /* red-700 */ font-size:0.875rem; margin-top:0.375rem; }

    /* Results container: reserve space to prevent CLS */
    #results { min-height: 220px; }

    /* Touch target sizing */
    .tap-target { min-height: 48px; min-width: 48px; }

    /* Print */
    @media print {
      body * { visibility: hidden; }
      #print-section, #print-section * { visibility: visible; }
      #print-section { position: absolute; left: 0; top: 0; width: 100%; }
    }
  </style>

  <!-- JSON-LD: WebPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Cone Volume Calculator",
    "inLanguage": "en",
    "url": "https://calcdomain.com/cone-volume-calculator.html",
    "description": "Compute the volume of a right circular cone or a truncated cone (frustum) with unit conversion, step-by-step method, and LaTeX formulas.",
    "author": { "@type": "Person", "name": "Ugo Candido" },
    "publisher": { "@type": "Organization", "name": "CalcDomain" }
  }
  </script>

  <!-- JSON-LD: Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Math","item":"https://calcdomain.com/math.html"},
      {"@type":"ListItem","position":3,"name":"Geometry","item":"https://calcdomain.com/subcategories/geometry.html"},
      {"@type":"ListItem","position":4,"name":"Cone Volume Calculator","item":"https://calcdomain.com/cone-volume-calculator.html"}
    ]
  }
  </script>

  <!-- JSON-LD: HowTo (Step-by-step example) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to calculate the volume of a cone",
    "description":"Enter radius/diameter and height to compute the volume of a right circular cone or frustum.",
    "step":[
      {"@type":"HowToStep","name":"Choose shape","text":"Select Cone or Frustum (truncated cone)."},
      {"@type":"HowToStep","name":"Enter dimensions","text":"Provide radius (or diameter) and height. For frustum, enter both top and bottom radii and height."},
      {"@type":"HowToStep","name":"Select units","text":"Pick input and output units (mm, cm, m, in, ft and corresponding cubic units)."},
      {"@type":"HowToStep","name":"Get results","text":"Volume updates instantly; copy or print the results."}
    ]
  }
  </script>

  <!-- JSON-LD: FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What is the formula for the volume of a cone?","acceptedAnswer":{"@type":"Answer","text":"V = (1/3)·π·r²·h for a right circular cone, where r is the base radius and h is the vertical height."}},
      {"@type":"Question","name":"How do I calculate the volume of a truncated cone (frustum)?","acceptedAnswer":{"@type":"Answer","text":"V = (1/3)·π·h·(R² + r² + R·r), where R is the bottom radius, r is the top radius, and h is the vertical height between the circular faces."}},
      {"@type":"Question","name":"Can I enter diameter instead of radius?","acceptedAnswer":{"@type":"Answer","text":"Yes. Select Diameter as the dimension type; the calculator converts it to radius internally using r = d/2."}},
      {"@type":"Question","name":"Which units are supported?","acceptedAnswer":{"@type":"Answer","text":"Linear units: mm, cm, m, in, ft. Output units include corresponding cubic units (mm³, cm³, m³, in³, ft³) and liters for convenience."}},
      {"@type":"Question","name":"Is the cone assumed to be right and circular?","acceptedAnswer":{"@type":"Answer","text":"Yes. This tool computes volumes for right circular cones and their frustums. Oblique cones require integral methods and are not covered here."}},
      {"@type":"Question","name":"What precision does the calculator use?","acceptedAnswer":{"@type":"Answer","text":"Results are displayed to a reasonable precision by default; you can copy exact values with full precision via the Copy button."}},
      {"@type":"Question","name":"Why do I get 0 or NaN?","acceptedAnswer":{"@type":"Answer","text":"Ensure all required inputs are positive numbers and the top radius is not larger than the bottom radius for a frustum. Check units as well."}}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- Header (non-sticky per requirements) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Main">
      <div class="flex items-center justify-between">
        <a href="index.html" class="text-2xl font-extrabold text-blue-700">CalcDomain</a>
        <div class="hidden md:flex items-center gap-6 text-sm">
          <a class="hover:text-blue-700" href="search.html">Advanced Search</a>
          <a class="hover:text-blue-700" href="index.html#categories">Categories</a>
        </div>
        <button class="md:hidden p-2 tap-target" id="menuBtn" aria-expanded="false" aria-controls="mobileMenu" aria-label="Open menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
      <div id="mobileMenu" class="hidden mt-3">
        <a class="block py-2 hover:text-blue-700" href="search.html">Advanced Search</a>
        <a class="block py-2 hover:text-blue-700" href="index.html#categories">Categories</a>
      </div>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <section class="w-full lg:w-2/3" aria-labelledby="page-title">
        <!-- Breadcrumbs -->
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-700">Home</a> &raquo;
          <a href="math.html" class="hover:text-blue-700">Math</a> &raquo;
          <a href="subcategories/geometry.html" class="hover:text-blue-700">Geometry</a> &raquo;
          <span class="text-gray-900">Cone Volume Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-lg shadow-md">
          <!-- 1) H1 -->
          <h1 id="page-title" class="text-3xl font-extrabold text-gray-900 mb-2">Cone Volume Calculator</h1>

          <!-- 2) Introduction -->
          <p class="text-gray-700 mb-6">
            Compute the volume of a right circular cone or a truncated cone (frustum) in your preferred units.
            Designed for students, engineers, teachers, and technical professionals, this calculator delivers instant,
            accessible results with formula transparency and step-by-step guidance.
          </p>

          <!-- 3) Calculator UI -->
          <section aria-labelledby="calc-heading">
            <h2 id="calc-heading" class="sr-only">Calculator Inputs</h2>

            <div id="calculator-ui" class="space-y-6">
              <!-- Shape toggle -->
              <fieldset class="border border-gray-200 rounded-lg p-4">
                <legend class="font-semibold text-gray-900">Shape</legend>
                <div class="mt-2 flex flex-wrap gap-4" role="radiogroup" aria-label="Choose shape">
                  <label class="inline-flex items-center gap-2 tap-target">
                    <input type="radio" name="shape" id="shapeCone" value="cone" class="h-5 w-5" checked aria-describedby="shapeHelp">
                    <span class="font-medium">Cone</span>
                  </label>
                  <label class="inline-flex items-center gap-2 tap-target">
                    <input type="radio" name="shape" id="shapeFrustum" value="frustum" class="h-5 w-5" aria-describedby="shapeHelp">
                    <span class="font-medium">Frustum (truncated cone)</span>
                  </label>
                  <p id="shapeHelp" class="text-sm text-gray-600">Pick <em>Cone</em> for a single radius; pick <em>Frustum</em> for top and bottom radii.</p>
                </div>
              </fieldset>

              <!-- Units -->
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                  <label for="unitLength" class="block text-sm font-medium text-gray-800">Input Length Unit *</label>
                  <div class="flex items-center gap-2">
                    <select id="unitLength" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 tap-target" aria-required="true">
                      <option value="mm">millimeter (mm)</option>
                      <option value="cm">centimeter (cm)</option>
                      <option value="m" selected>meter (m)</option>
                      <option value="in">inch (in)</option>
                      <option value="ft">foot (ft)</option>
                    </select>
                    <button type="button" class="p-2 rounded tap-target" aria-expanded="false" aria-controls="unitLenTip" aria-label="Explain length units" data-tooltip>
                      ?
                    </button>
                  </div>
                  <p id="unitLenTip" class="hidden text-sm text-gray-600 mt-1">Applies to all linear inputs (radius, diameter, height).</p>
                </div>

                <div>
                  <label for="unitVolume" class="block text-sm font-medium text-gray-800">Output Volume Unit *</label>
                  <div class="flex items-center gap-2">
                    <select id="unitVolume" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 tap-target" aria-required="true">
                      <option value="mm3">mm³</option>
                      <option value="cm3">cm³</option>
                      <option value="m3" selected>m³</option>
                      <option value="in3">in³</option>
                      <option value="ft3">ft³</option>
                      <option value="L">liter (L)</option>
                    </select>
                    <button type="button" class="p-2 rounded tap-target" aria-expanded="false" aria-controls="unitVolTip" aria-label="Explain volume units" data-tooltip>?</button>
                  </div>
                  <p id="unitVolTip" class="hidden text-sm text-gray-600 mt-1">Choose a cubic unit or liters for convenience (1 L = 0.001 m³).</p>
                </div>

                <div>
                  <label for="dimType" class="block text-sm font-medium text-gray-800">Dimension Type *</label>
                  <div class="flex items-center gap-2">
                    <select id="dimType" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 tap-target" aria-required="true" aria-describedby="dimTypeTip">
                      <option value="radius" selected>Use radius</option>
                      <option value="diameter">Use diameter</option>
                    </select>
                    <button type="button" class="p-2 rounded tap-target" aria-expanded="false" aria-controls="dimTypeTip" aria-label="Explain dimension type" data-tooltip>?</button>
                  </div>
                  <p id="dimTypeTip" class="hidden text-sm text-gray-600 mt-1">If you have diameter values, the tool converts to radius using r = d / 2.</p>
                </div>
              </div>

              <!-- Inputs for Cone -->
              <div id="coneInputs" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                  <label for="coneR" class="block text-sm font-medium text-gray-800">Radius / Diameter *</label>
                  <input type="number" id="coneR" inputmode="decimal" step="any" min="0" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 tap-target" aria-required="true" aria-describedby="coneRErr">
                  <p id="coneRErr" class="error-text hidden">Enter a positive number.</p>
                </div>
                <div>
                  <label for="coneH" class="block text-sm font-medium text-gray-800">Height (vertical) *</label>
                  <input type="number" id="coneH" inputmode="decimal" step="any" min="0" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 tap-target" aria-required="true" aria-describedby="coneHErr">
                  <p id="coneHErr" class="error-text hidden">Enter a positive number.</p>
                </div>
                <div class="flex items-end">
                  <button id="resetCone" class="w-full bg-gray-100 hover:bg-gray-200 border border-gray-300 text-gray-900 font-medium rounded-md px-4 py-2 tap-target" type="button" aria-label="Reset cone inputs">Reset</button>
                </div>
              </div>

              <!-- Inputs for Frustum -->
              <div id="frustumInputs" class="grid grid-cols-1 md:grid-cols-4 gap-6 hidden">
                <div>
                  <label for="frustumRbig" class="block text-sm font-medium text-gray-800">Bottom Radius / Diameter (R) *</label>
                  <input type="number" id="frustumRbig" inputmode="decimal" step="any" min="0" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 tap-target" aria-required="true" aria-describedby="frustumRbigErr">
                  <p id="frustumRbigErr" class="error-text hidden">Enter a positive number.</p>
                </div>
                <div>
                  <label for="frustumRsmall" class="block text-sm font-medium text-gray-800">Top Radius / Diameter (r) *</label>
                  <input type="number" id="frustumRsmall" inputmode="decimal" step="any" min="0" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 tap-target" aria-required="true" aria-describedby="frustumRsmallErr">
                  <p id="frustumRsmallErr" class="error-text hidden">Enter a positive number not exceeding R.</p>
                </div>
                <div>
                  <label for="frustumH" class="block text-sm font-medium text-gray-800">Height (vertical) *</label>
                  <input type="number" id="frustumH" inputmode="decimal" step="any" min="0" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 tap-target" aria-required="true" aria-describedby="frustumHErr">
                  <p id="frustumHErr" class="error-text hidden">Enter a positive number.</p>
                </div>
                <div class="flex items-end">
                  <button id="resetFrustum" class="w-full bg-gray-100 hover:bg-gray-200 border border-gray-300 text-gray-900 font-medium rounded-md px-4 py-2 tap-target" type="button" aria-label="Reset frustum inputs">Reset</button>
                </div>
              </div>
            </div>
          </section>

          <!-- 4) Results -->
          <section id="results" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6">
            <h2 class="text-xl font-bold text-blue-900 mb-4">Results</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="bg-white border border-blue-100 rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-600">Volume</h3>
                <p id="resultVolume" class="text-2xl font-extrabold text-blue-700" aria-live="polite">—</p>
                <p id="resultUnit" class="text-xs text-gray-500">—</p>
              </div>
              <div class="bg-white border border-blue-100 rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-600">Exact (symbolic)</h3>
                <p id="resultExact" class="text-sm font-mono text-gray-800 break-all">—</p>
              </div>
              <div class="bg-white border border-blue-100 rounded-lg p-4 flex items-center justify-center gap-3">
                <button id="copyBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-md px-4 py-2 tap-target" type="button">Copy</button>
                <button id="printBtn" class="bg-white hover:bg-gray-50 border border-gray-300 text-gray-900 font-semibold rounded-md px-4 py-2 tap-target" type="button">Print</button>
              </div>
            </div>
          </section>

          <!-- 5) Authoritative Content Ecosystem -->
          <article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
            <h2>Authoritative Data Source &amp; Methodology</h2>
            <p><strong>Primary reference:</strong> <a class="text-blue-700 underline" href="https://dlmf.nist.gov/1.3" rel="nofollow noopener">NIST Digital Library of Mathematical Functions (DLMF)</a> and classical geometry results for right circular cones and frustums. All calculations strictly follow these formulas and definitions.</p>
            <p><em>“Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.”</em></p>

            <h2>The Formula (LaTeX)</h2>
            <div class="formula-box">
              For a right circular cone:
              <br/>\\[
                V_{\\text{cone}} = \\frac{1}{3}\\,\\pi\\,r^2\\,h
              \\]
              For a frustum (truncated cone) with bottom radius \(R\), top radius \(r\), and height \(h\):
              <br/>\\[
                V_{\\text{frustum}} = \\frac{1}{3}\\,\\pi\\,h\\,(R^2 + r^2 + R\\,r)
              \\]
            </div>

            <h2>Glossary of Variables</h2>
            <ul>
              <li><strong>r</strong>: base radius of the cone (or top radius for the frustum).</li>
              <li><strong>R</strong>: bottom radius of the frustum.</li>
              <li><strong>d</strong>: diameter; related by \( r = d/2 \).</li>
              <li><strong>h</strong>: vertical height (perpendicular distance between base(s)).</li>
              <li><strong>V</strong>: volume.</li>
            </ul>

            <h2>How It Works: A Step-by-Step Example</h2>
            <p><strong>Example (Cone):</strong> Let radius \( r = 0.25\\,\\text{m} \) and height \( h = 1.2\\,\\text{m} \). Then</p>
            <div class="formula-box">
              \\[
                V = \\tfrac{1}{3}\\,\\pi\\,r^2\\,h
                = \\tfrac{1}{3}\\,\\pi\\,(0.25)^2\\,(1.2)
                = \\tfrac{1}{3}\\,\\pi\\,(0.0625)\\,(1.2)
                = \\tfrac{1}{3}\\,\\pi\\,(0.075) \\approx 0.07854\\,\\text{m}^3.
              \\]
            </div>
            <p><strong>Example (Frustum):</strong> Let \( R=0.30\\,\\text{m} \), \( r=0.20\\,\\text{m} \), \( h=0.80\\,\\text{m} \):</p>
            <div class="formula-box">
              \\[
                V = \\tfrac{1}{3}\\,\\pi\\,h\\,(R^2 + r^2 + Rr)
                = \\tfrac{1}{3}\\,\\pi\\,(0.80)\\,(0.09 + 0.04 + 0.06)
                = \\tfrac{1}{3}\\,\\pi\\,(0.80)\\,(0.19)
                \\approx 0.1591\\,\\text{m}^3.
              \\]
            </div>

            <h2>Frequently Asked Questions</h2>
            <details>
              <summary>Can I input diameter instead of radius?</summary>
              <p>Yes. Choose “Use diameter” and enter diameter values. The tool converts to radius internally via \(r = d/2\).</p>
            </details>
            <details>
              <summary>What’s the difference between height and slant height?</summary>
              <p>Height is the perpendicular distance between base(s). Slant height is the edge length along the cone’s side; it is not used in the volume formula.</p>
            </details>
            <details>
              <summary>Does this work for oblique cones?</summary>
              <p>No. The formulas here apply to right circular cones and their frustums. Oblique cones require different techniques (calculus/integration).</p>
            </details>
            <details>
              <summary>How accurate are the results?</summary>
              <p>Numeric results use standard double-precision calculations. The “Exact (symbolic)” field preserves π for clarity.</p>
            </details>
            <details>
              <summary>Can I copy or print the results?</summary>
              <p>Yes, use the Copy and Print buttons in the results panel.</p>
            </details>

            <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
              <p><strong>Tool developed by Ugo Candido.</strong> Content reviewed by the CalcDomain Editorial Board.<br>
              Last accuracy review: <time datetime="2025-10-25">October 25, 2025</time></p>
            </div>
          </article>
        </div>
      </section>

      <!-- Sidebar -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="font-bold text-lg mb-3">Why this calculator stands out</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Supports both cone and frustum with unit conversion.</li>
              <li>Inline validation and accessible tooltips (WCAG 2.1 AA).</li>
              <li>Transparent formulas with MathJax LaTeX.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="font-bold text-lg mb-4">Related geometry tools</h3>
            <ul class="space-y-2 text-sm">
              <li><a class="text-blue-700 underline" href="cylinder-volume-calculator.html">Cylinder Volume Calculator</a></li>
              <li><a class="text-blue-700 underline" href="sphere-volume-calculator.html">Sphere Volume Calculator</a></li>
              <li><a class="text-blue-700 underline" href="cone-surface-area-calculator.html">Cone Surface Area Calculator</a></li>
            </ul>
          </div>
          <div class="bg-gray-100 border border-gray-200 h-64 rounded-lg flex items-center justify-center text-gray-500 text-sm">
            Ad Placement (300×600)
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-700">About</a>
        <a href="contact.html" class="hover:text-blue-700">Contact</a>
        <a href="privacy.html" class="hover:text-blue-700">Privacy</a>
        <a href="terms.html" class="hover:text-blue-700">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator Logic (defer by being placed at end) -->
  <script>
  (function(){
    const $ = (id) => document.getElementById(id);
    const els = {
      menuBtn: $('menuBtn'), mobileMenu: $('mobileMenu'),
      // shape
      shapeCone: $('shapeCone'), shapeFrustum: $('shapeFrustum'),
      // units
      unitLength: $('unitLength'), unitVolume: $('unitVolume'), dimType: $('dimType'),
      // cone inputs
      coneInputs: $('coneInputs'), coneR: $('coneR'), coneH: $('coneH'), resetCone: $('resetCone'),
      // frustum inputs
      frustumInputs: $('frustumInputs'), frustumRbig: $('frustumRbig'), frustumRsmall: $('frustumRsmall'), frustumH: $('frustumH'), resetFrustum: $('resetFrustum'),
      // tooltips
      unitLenTip: $('unitLenTip'), unitVolTip: $('unitVolTip'), dimTypeTip: $('dimTypeTip'),
      // errors
      coneRErr: $('coneRErr'), coneHErr: $('coneHErr'),
      frustumRbigErr: $('frustumRbigErr'), frustumRsmallErr: $('frustumRsmallErr'), frustumHErr: $('frustumHErr'),
      // results
      resultVolume: $('resultVolume'), resultUnit: $('resultUnit'), resultExact: $('resultExact'),
      copyBtn: $('copyBtn'), printBtn: $('printBtn')
    };

    // Mobile menu
    if (els.menuBtn) {
      els.menuBtn.addEventListener('click', () => {
        const isOpen = els.mobileMenu.classList.toggle('hidden') ? false : true;
        els.menuBtn.setAttribute('aria-expanded', String(isOpen));
      });
    }

    // Accessible tooltips
    document.querySelectorAll('[data-tooltip]').forEach(btn=>{
      const controls = btn.getAttribute('aria-controls');
      btn.addEventListener('click', ()=>{
        const tip = document.getElementById(controls);
        const open = tip.classList.toggle('hidden');
        btn.setAttribute('aria-expanded', String(!open));
      });
      btn.addEventListener('keydown', (e)=> {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); btn.click(); }
      });
    });

    // Unit conversion helpers
    const lengthToMeters = {
      mm: (v)=> v/1000,
      cm: (v)=> v/100,
      m:  (v)=> v,
      in: (v)=> v*0.0254,
      ft: (v)=> v*0.3048
    };
    const m3ToUnit = {
      mm3: (v)=> v*1e9,
      cm3: (v)=> v*1e6,
      m3:  (v)=> v,
      in3: (v)=> v / Math.pow(0.0254,3),
      ft3: (v)=> v / Math.pow(0.3048,3),
      L:   (v)=> v*1000
    };
    const unitLabels = { mm3:'mm³', cm3:'cm³', m3:'m³', in3:'in³', ft3:'ft³', L:'L' };

    function parsePos(input, errEl){
      const v = Number(input.value);
      if (!isFinite(v) || v<=0) {
        errEl.classList.remove('hidden');
        input.setAttribute('aria-invalid','true');
        return NaN;
      } else {
        errEl.classList.add('hidden');
        input.removeAttribute('aria-invalid');
        return v;
      }
    }

    function currentRadius(val){
      // Convert to radius if user chose diameter
      return (els.dimType.value === 'diameter') ? val/2 : val;
    }

    function toMeters(val){
      return lengthToMeters[els.unitLength.value](val);
    }

    function compute(){
      const shape = els.shapeFrustum.checked ? 'frustum' : 'cone';
      let V_m3 = NaN;
      let exact = '—';

      if (shape === 'cone') {
        const rr = parsePos(els.coneR, els.coneRErr);
        const hh = parsePos(els.coneH, els.coneHErr);
        if (isNaN(rr) || isNaN(hh)) return render(NaN, '—');
        const r_m = toMeters(currentRadius(rr));
        const h_m = toMeters(hh);
        V_m3 = (Math.PI * r_m * r_m * h_m) / 3;
        exact = `V = (1/3)·π·(${formatNum(r_m)}²)·${formatNum(h_m)} m³`;
      } else {
        const Rb = parsePos(els.frustumRbig, els.frustumRbigErr);
        const rs = parsePos(els.frustumRsmall, els.frustumRsmallErr);
        const hh = parsePos(els.frustumH, els.frustumHErr);
        if (isNaN(Rb) || isNaN(rs) || isNaN(hh)) return render(NaN, '—');

        const R = toMeters(currentRadius(Rb));
        const r = toMeters(currentRadius(rs));
        const h = toMeters(hh);

        // Logical constraint: r <= R
        if (r > R) {
          els.frustumRsmallErr.textContent = "Top radius/diameter must be less than or equal to bottom radius.";
          els.frustumRsmallErr.classList.remove('hidden');
          els.frustumRsmall.setAttribute('aria-invalid','true');
          return render(NaN, '—');
        } else {
          els.frustumRsmallErr.textContent = "Enter a positive number not exceeding R.";
          els.frustumRsmallErr.classList.add('hidden');
          els.frustumRsmall.removeAttribute('aria-invalid');
        }

        V_m3 = (Math.PI * h * (R*R + r*r + R*r)) / 3;
        exact = `V = (1/3)·π·${formatNum(h)}·(${formatNum(R)}² + ${formatNum(r)}² + ${formatNum(R)}·${formatNum(r)}) m³`;
      }

      render(V_m3, exact);
    }

    function formatNum(v){
      // Preserve useful precision without exponential noise
      return Number(v).toPrecision(6).replace(/\.?0+$/,'');
    }

    function render(V_m3, exactText){
      const unit = els.unitVolume.value;
      if (!isFinite(V_m3)) {
        els.resultVolume.textContent = '—';
        els.resultUnit.textContent = '—';
        els.resultExact.textContent = '—';
        return;
      }
      const V_out = m3ToUnit[unit](V_m3);
      els.resultVolume.textContent = new Intl.NumberFormat(undefined, { maximumFractionDigits: 8 }).format(V_out);
      els.resultUnit.textContent = unitLabels[unit] || unit;
      els.resultExact.textContent = exactText;
    }

    // Show/hide input blocks based on shape
    function toggleShape(){
      const fr = els.shapeFrustum.checked;
      els.coneInputs.classList.toggle('hidden', fr);
      els.frustumInputs.classList.toggle('hidden', !fr);
      compute();
    }

    // Reset helpers
    function resetCone(){
      els.coneR.value = '';
      els.coneH.value = '';
      [els.coneRErr, els.coneHErr].forEach(e => e.classList.add('hidden'));
      [els.coneR, els.coneH].forEach(i => i.removeAttribute('aria-invalid'));
      compute();
    }
    function resetFrustum(){
      els.frustumRbig.value = '';
      els.frustumRsmall.value = '';
      els.frustumH.value = '';
      [els.frustumRbigErr, els.frustumRsmallErr, els.frustumHErr].forEach(e => e.classList.add('hidden'));
      [els.frustumRbig, els.frustumRsmall, els.frustumH].forEach(i => i.removeAttribute('aria-invalid'));
      compute();
    }

    // Events
    [els.shapeCone, els.shapeFrustum].forEach(r => r.addEventListener('change', toggleShape));
    [els.unitLength, els.unitVolume, els.dimType].forEach(s => s.addEventListener('change', compute));

    // Inline validation on blur
    [['coneR','coneRErr'], ['coneH','coneHErr']].forEach(([id,err])=>{
      const input = $(id), errEl=$(err);
      input.addEventListener('blur', ()=>{ parsePos(input, errEl); });
      input.addEventListener('input', compute);
    });
    [['frustumRbig','frustumRbigErr'], ['frustumRsmall','frustumRsmallErr'], ['frustumH','frustumHErr']].forEach(([id,err])=>{
      const input = $(id), errEl=$(err);
      input.addEventListener('blur', ()=>{ parsePos(input, errEl); });
      input.addEventListener('input', compute);
    });

    // Reset buttons
    els.resetCone.addEventListener('click', resetCone);
    els.resetFrustum.addEventListener('click', resetFrustum);

    // Copy/Print
    els.copyBtn.addEventListener('click', async ()=>{
      const text = `Volume: ${els.resultVolume.textContent} ${els.resultUnit.textContent}\nExact: ${els.resultExact.textContent}`;
      try { await navigator.clipboard.writeText(text); els.copyBtn.textContent = 'Copied!'; setTimeout(()=> els.copyBtn.textContent='Copy', 1200); } catch {}
    });
    els.printBtn.addEventListener('click', ()=> window.print());

    // Defaults
    els.coneR.value = '0.25';
    els.coneH.value = '1.2';
    compute();
  })();
  </script>
</body>
</html>

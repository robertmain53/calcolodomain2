<!DOCTYPE html>
<html lang="en">
<head>
<link rel="canonical" href="https://calcdomain.com/decimal-to-fraction.html">





<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Decimal to Fraction Calculator</title>
<meta name="description" content="Convert any decimal, including repeating decimals, to a fraction. Get a step-by-step solution for proper, improper, or mixed fractions.">


<script src="https://cdn.tailwindcss.com"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
font-size: 1.1rem;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }
/* Custom focus style for accessibility */
:focus-visible {
outline: 3px solid #3b82f6;
outline-offset: 2px;
border-radius: 4px;
}
/* Hide outline for non-keyboard focus */
:focus:not(:focus-visible) {
outline: none;
}
.hidden { display: none; }
@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
}
</style>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Decimal to Fraction Calculator",
  "description": "Convert any decimal, including repeating decimals, to a fraction. Get a step-by-step solution for proper, improper, or mixed fractions.",
  "url": "https://calcdomain.com/decimal-to-fraction.html",
  "inLanguage": "en",
  "author": { "@type": "Person", "name": "Ugo Candido" },
  "publisher": { "@type": "Organization", "name": "CalcDomain" }
}
</script>
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Math & Conversions",
      "item": "https://calcdomain.com/math-conversions.html"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Algebra",
      "item": "https://calcdomain.com/subcategories/core-math-algebra.html"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "Decimal to Fraction Calculator",
      "item": "https://calcdomain.com/decimal-to-fraction.html"
    }
  ]
}</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to Convert a Decimal to a Fraction",
  "description": "A step-by-step guide to converting terminating and repeating decimals into simplified fractions.",
  "step": [
    {"@type": "HowToStep", "name": "Enter Decimal", "text": "Input the decimal number you want to convert in the 'Decimal Number' field."},
    {"@type": "HowToStep", "name": "Specify Repeating (if any)", "text": "If your decimal repeats, check the 'This is a repeating decimal' box and enter *only* the repeating digits (e.g., '3' for 0.333... or '14' for 0.121414...)."},
    {"@type": "HowToStep", "name": "Calculate", "text": "Click the 'Calculate' button to perform the conversion."},
    {"@type": "HowToStep", "name": "Review Results", "text": "The calculator will display the result as a simplified improper fraction, a mixed number, and provide a detailed step-by-step breakdown of the calculation."}
  ]
}
</script>
<script src="search.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">
<div class="flex justify-between items-center">
<a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

<div class="w-full max-w-md hidden md:block mx-8">
<div class="relative">
<input type="search" id="search-input" placeholder="Search for a calculator..."
class="w-full py-2 px-4 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
autocomplete="off">
<svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
</svg>
<div id="search-results" class="absolute top-full left-0 right-0 hidden bg-white border border-gray-200 rounded-lg shadow-lg mt-2 max-h-96 overflow-y-auto z-50"></div>
</div>
</div>

<div class="hidden md:flex items-center space-x-6 text-sm">
<a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
Categories
</div>

<button id="mobile-menu-toggle" class="md:hidden p-2" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-menu">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M4 6h16M4 12h16M4 18h16"></path>
</svg>
</button>
</div>

<div id="mobile-menu" class="md:hidden mt-4 hidden">
<div class="space-y-2">
<a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
Categories
</div>
</div>
</nav>
</header>

<main class="container mx-auto px-4 lg:px-6 py-10">
<div class="flex flex-col lg:flex-row gap-8">

<section class="w-full lg:w-2/3">
<nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
<a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
<a href="math.html" class="hover:text-blue-600">Math</a> &raquo;
<a href="subcategories/core-math-algebra.html" class="hover:text-blue-600">Algebra</a> &raquo;
<span class="text-gray-900">Decimal to Fraction Calculator</span>
</nav>

<div id="print-section" class="bg-white p-6 rounded-lg shadow-md">
<h1 class="text-3xl font-extrabold text-gray-900 mb-2">Decimal to Fraction Calculator</h1>
<p class="text-gray-600 mb-6">Quickly convert any decimal number into a simplified fraction. This tool handles both terminating (e.g., 0.5) and repeating (e.g., 0.333...) decimals, providing a clear, step-by-step solution.</p>

<div id="calculator-ui" class="space-y-6">
<form id="decimal-form" action="javascript:void(0);">
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div>
<label for="decimalInput" class="block text-sm font-medium text-gray-700">Decimal Number <span class="text-red-500">*</span></label>
<input type="text" id="decimalInput" inputmode="decimal"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="decimalInput-error">
<div id="decimalInput-error" class="text-red-600 text-sm mt-1" aria-live="polite"></div>
</div>

<div id="repeating-group" class="hidden">
<label for="repeatingDigits" class="block text-sm font-medium text-gray-700">
Repeating Digits <span class="text-red-500">*</span>
<button type="button" id="tooltip-btn" class="ml-1 p-1 rounded-full hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500"
aria-label="What are repeating digits?" aria-describedby="repeating-tooltip" aria-expanded="false">
<svg class="w-4 h-4 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
</svg>
</button>
</label>
<input type="text" id="repeatingDigits" inputmode="numeric"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-describedby="repeatingDigits-error">
<div id="repeatingDigits-error" class="text-red-600 text-sm mt-1" aria-live="polite"></div>
<div id="repeating-tooltip" role="tooltip" class="hidden mt-2 p-2 text-sm text-gray-700 bg-gray-100 rounded-md border border-gray-200">
Enter <strong>only</strong> the digits that repeat.
<ul class="list-disc list-inside mt-1">
<li>For 0.333..., enter <strong class="font-mono">3</strong></li>
<li>For 1.23434..., enter <strong class="font-mono">34</strong></li>
</ul>
</div>
</div>
</div>

<div class="mt-4 flex items-center">
<input type="checkbox" id="isRepeating"
class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
<label for="isRepeating" class="ml-2 block text-sm text-gray-900">This is a repeating decimal</label>
</div>

<div class="mt-6 flex items-center space-x-4">
<button type="submit" id="calculateBtn"
class="px-6 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
style="min-width: 48px; min-height: 48px;">
Calculate
</button>
<button type="reset" id="resetBtn"
class="px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md"
style="min-height: 48px;">
Clear
</button>
</div>
</form>
</div>

<section id="results" aria-live="polite" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6" style="min-height: 200px;">
<div id="results-content" class="hidden">
<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
<div class="result-card">
<h4>Fraction Result</h4>
<p id="fractionResult">—</p>
</div>
<div class="result-card">
<h4>Mixed Number</h4>
<p id="mixedResult">—</p>
</div>
</div>
<div class="mt-6">
<h3 class="text-xl font-semibold text-gray-800 mb-3">Step-by-Step Solution</h3>
<div id="stepsResult" class="prose prose-sm text-gray-700 bg-white p-4 border rounded-md">
</div>
</div>
</div>
<p id="results-placeholder" class="text-gray-500">Enter a decimal and click 'Calculate' to see the results.</p>
</section>
</div>

<article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
<h2>Data Source and Methodology</h2>
<p>This calculator operates on the fundamental mathematical principle that any terminating or repeating decimal can be expressed as a rational number (a fraction). The methodology follows standard algebraic procedures for converting decimals to fractions, ensuring accuracy and simplification.</p>
<p>
<strong>AuthoritativeDataSource:</strong> The conversion algorithms are based on the definitions of rational numbers and geometric series as described in foundational mathematical texts, such as <i>"Principles of Mathematical Analysis" (3rd Ed.) by Walter Rudin</i>.
</p>
<p>All calculations are performed with high-precision arithmetic to handle large numerators and denominators accurately, and the final fraction is always simplified by finding the Greatest Common Divisor (GCD).</p>

<h2>The Formulas Explained</h2>
<p>The method used depends on whether the decimal is terminating or repeating.</p>

<h3>1. Terminating Decimals</h3>
<p>A terminating decimal is a decimal that ends. For a decimal \(d\) with \(n\) decimal places, the formula is:</p>
<div class="formula-box">
\[ d = \frac{d \times 10^n}{10^n} \]
</div>
<p>For example, 0.75 has 2 decimal places (\(n=2\)).</p>
<div class="formula-box">
\[ 0.75 = \frac{0.75 \times 10^2}{10^2} = \frac{75}{100} \]
</div>
<p>The calculator then simplifies this fraction by dividing the numerator and denominator by their GCD (which is 25), resulting in \( \frac{3}{4} \).</p>

<h3>2. Repeating Decimals</h3>
<p>A repeating decimal is converted using algebra. A general formula for a decimal \( 0.a\overline{b} \), where \(a\) is the non-repeating part and \( \overline{b} \) is the repeating part, is:</p>
<div class="formula-box">
\[ x = \frac{(\text{Number}) - (\text{Non-repeating part})}{\text{Nines for each repeating digit, Zeros for each non-repeating digit}} \]
</div>
<p>For example, to convert \( x = 0.12\overline{34} \):</p>
<ul class="list-decimal list-inside">
<li>The full number (ignoring the decimal point) is 1234.</li>
<li>The non-repeating part is 12.</li>
<li>There are 2 repeating digits (\( \overline{34} \)), so we use two 9s: 99.</li>
<li>There are 2 non-repeating decimal digits (12), so we use two 0s: 00.</li>
<li>The denominator is 9900.</li>
</ul>
<div class="formula-box">
\[ x = \frac{1234 - 12}{9900} = \frac{1222}{9900} \]
</div>
<p>This fraction is then simplified to \( \frac{611}{4950} \).</p>

<h2>Glossary of Variables</h2>
<dl class="space-y-4">
<div>
<dt class="font-semibold">Decimal (Input)</dt>
<dd class="ml-4 text-gray-700">The number you want to convert. It can be positive or negative.</dd>
</div>
<div>
<dt class="font-semibold">Repeating Digits (Input)</dt>
<dd class="ml-4 text-gray-700">The sequence of digits that repeats infinitely. For 0.1666..., this would be '6'.</dd>
</div>
<div>
<dt class="font-semibold">Fraction (Result)</dt>
<dd class="ml-4 text-gray-700">The simplified result, expressed as a numerator over a denominator. This may be a <strong>proper fraction</strong> (numerator < denominator) or an <strong>improper fraction</strong> (numerator > denominator).</dd>
</div>
<div>
<dt class="font-semibold">Mixed Number (Result)</dt>
<dd class="ml-4 text-gray-700">The result expressed as a whole number and a proper fraction (e.g., 1 ½). This is only shown for improper fractions.</dd>
</div>
<div>
<dt class="font-semibold">Greatest Common Divisor (GCD)</dt>
<dd class="ml-4 text-gray-700">The largest positive integer that divides both the numerator and the denominator, used to simplify the fraction.</dd>
</div>
</dl>

<h2>How It Works: A Step-by-Step Example</h2>
<h3>Example 1: Terminating Decimal (0.625)</h3>
<ol class="list-decimal list-inside space-y-2">
<li><strong>Input:</strong> 0.625</li>
<li><strong>Step 1:</strong> Count the decimal places. There are 3.</li>
<li><strong>Step 2:</strong> Write the decimal as a fraction with a denominator of 1 followed by 3 zeros (1000).
\[ \frac{625}{1000} \]
</li>
<li><strong>Step 3:</strong> Find the Greatest Common Divisor (GCD) of 625 and 1000. The GCD is 125.</li>
<li><strong>Step 4:</strong> Simplify the fraction by dividing both parts by the GCD.
\[ \frac{625 \div 125}{1000 \div 125} = \frac{5}{8} \]
</li>
<li><strong>Final Result:</strong> \( \frac{5}{8} \)</li>
</ol>

<h3 class="mt-6">Example 2: Repeating Decimal (0.5333...)</h3>
<ol class="list-decimal list-inside space-y-2">
<li><strong>Input:</strong> 0.5333... (Repeating part: '3')</li>
<li><strong>Step 1:</strong> Identify the parts. The full number (up to the end of the first repeat) is 53. The non-repeating part is 5.</li>
<li><strong>Step 2:</strong> Calculate the numerator: (Full Number) - (Non-repeating part)
\[ 53 - 5 = 48 \]
</li>
<li><strong>Step 3:</strong> Calculate the denominator. There is 1 repeating digit ('3'), so we use one 9. There is 1 non-repeating decimal digit ('5'), so we use one 0.
\[ \text{Denominator} = 90 \]
</li>
<li><strong>Step 4:</strong> Form the initial fraction: \( \frac{48}{90} \)</li>
<li><strong>Step 5:</strong> Find the GCD of 48 and 90. The GCD is 6.</li>
<li><strong>Step 6:</strong> Simplify the fraction.
\[ \frac{48 \div 6}{90 \div 6} = \frac{8}{15} \]
</li>
<li><strong>Final Result:</strong> \( \frac{8}{15} \)</li>
</ol>

<h2>Frequently Asked Questions</h2>
<details>
<summary>What is a terminating decimal?</summary>
<p>A terminating decimal is a decimal number that has a finite number of digits after the decimal point. For example, 0.5, 2.125, and 0.001 are all terminating decimals. They can all be written as fractions with a denominator that is a power of 10 (like 10, 100, 1000).</p>
</details>
<details>
<summary>What is a repeating decimal?</summary>
<p>A repeating decimal (or recurring decimal) is a decimal number that has a digit or a sequence of digits that repeats infinitely. For example, 0.333... (repeating '3') or 0.123123... (repeating '123').</p>
</details>
<details>
<summary>How do you convert a decimal with a non-repeating part (e.g., 1.23434...)?</summary>
<p>This calculator handles that automatically. You would enter '1.234' as the decimal and '34' as the repeating digits. The logic (explained in the "Formulas" section) separates the whole number '1' and the decimal part '0.23434...', converts the decimal part, and then adds the whole number back at the end.</p>
</section>
<details>
<summary>What's the difference between a proper and improper fraction?</summary>
<p>A <strong>proper fraction</strong> has a numerator that is smaller than its denominator (e.g., 3/4). An <strong>improper fraction</strong> has a numerator that is larger than or equal to its denominator (e.g., 7/4). Improper fractions can also be written as <strong>mixed numbers</strong> (e.g., 1 ¾).</p>
</details>
<details>
<summary>Why does the calculator simplify the fraction?</summary>
<p>A fraction is considered to be in its simplest form when its numerator and denominator have no common factors other than 1. This is the standard way to represent a fraction. This tool finds the Greatest Common Divisor (GCD) of the numerator and denominator and divides both by it to provide the simplest, most correct answer.</p>
</details>
<details>
<summary>Can this calculator handle negative decimals?</summary>
<p>Yes. Simply enter the negative decimal (e.g., -0.25). The calculator will convert the positive value and apply the negative sign to the final fractional result (e.g., -1/4).</p>
</details>
<details>
<summary>What is a rational number?</summary>
<p>A rational number is any number that can be expressed as a fraction (a ratio) \( \frac{p}{q} \) of two integers, where the denominator \(q\) is not zero. All terminating and all repeating decimals are rational numbers, which is why this conversion is always possible.</p>
</details>

<div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600">
<p><strong>Tool developed by Ugo Candido.</strong> Mathematical formulas and content verified by the CalcDomain Editorial Board.<br>
Last accuracy review: <time datetime="2025-10-31">October 31, 2025</time></p>
</div>
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300×600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why use this calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Get instant and accurate conversions for any decimal.</li>
<li>Handles both terminating and complex repeating decimals.</li>
<li>Provides a full step-by-step solution for easy understanding.</li>
<li>Fully accessible (WCAG 2.1 AA) and mobile-friendly design.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Math Tools</h3>
<ul class="space-y-3 text-sm">
<li>Fraction to Decimal Calculator</li>
<li><a href="percentage-calculator.html" class="text-blue-600 hover:underline">Percentage Calculator</a></li>
<li>GCD (Greatest Common Divisor) Calculator</li>
<li><a href="ratio.html" class="text-blue-600 hover:underline">Ratio Calculator</a></li>
<li><a href="mixed-number.html" class="text-blue-600 hover:underline">Mixed Number Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-white border-t">
<div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
<p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
<div class="mt-4 space-x-4">
<a href="about.html" class="hover:text-blue-600">About</a>
<a href="contact.html" class="hover:text-blue-600">Contact</a>
<a href="privacy.html" class="hover:text-blue-600">Privacy</a>
<a href="terms.html" class="hover:text-blue-600">Terms</a>
</div>
</div>
</footer>

<script defer>
document.addEventListener('DOMContentLoaded', () => {
  // --- DOM Elements ---
  const form = document.getElementById('decimal-form');
  const decimalInput = document.getElementById('decimalInput');
  const isRepeating = document.getElementById('isRepeating');
  const repeatingGroup = document.getElementById('repeating-group');
  const repeatingDigits = document.getElementById('repeatingDigits');
  const calculateBtn = document.getElementById('calculateBtn');
  const resetBtn = document.getElementById('resetBtn');

  // Tooltip Elements
  const tooltipBtn = document.getElementById('tooltip-btn');
  const tooltip = document.getElementById('repeating-tooltip');

  // Results Elements
  const resultsContent = document.getElementById('results-content');
  const resultsPlaceholder = document.getElementById('results-placeholder');
  const fractionResult = document.getElementById('fractionResult');
  const mixedResult = document.getElementById('mixedResult');
  const stepsResult = document.getElementById('stepsResult');

  // --- Accessibility & UX Listeners ---

  // Toggle repeating digits input
  isRepeating.addEventListener('change', () => {
    const isChecked = isRepeating.checked;
    repeatingGroup.classList.toggle('hidden', !isChecked);
    repeatingDigits.ariaRequired = isChecked;
    if (!isChecked) {
      repeatingDigits.value = '';
      hideError('repeatingDigits');
    }
  });

  // Toggle tooltip
  tooltipBtn.addEventListener('click', () => {
    const isExpanded = tooltipBtn.getAttribute('aria-expanded') === 'true';
    tooltip.classList.toggle('hidden');
    tooltipBtn.setAttribute('aria-expanded', !isExpanded);
  });

  // Form submission
  form.addEventListener('submit', (e) => {
    e.preventDefault();
    calculate();
  });

  // Form reset
  resetBtn.addEventListener('click', () => {
    clearAll();
  });

  // Inline validation on blur
  decimalInput.addEventListener('blur', () => validateDecimal());
  repeatingDigits.addEventListener('blur', () => validateRepeating());

  // --- Helper Functions ---

  function show(el) { el.classList.remove('hidden'); }
  function hide(el) { el.classList.add('hidden'); }

  function showError(id, message) {
    const field = document.getElementById(id);
    const errorEl = document.getElementById(id + '-error');
    if (field && errorEl) {
      errorEl.textContent = message;
      field.setAttribute('aria-invalid', 'true');
      field.classList.add('border-red-500');
    }
  }

  function hideError(id) {
    const field = document.getElementById(id);
    const errorEl = document.getElementById(id + '-error');
    if (field && errorEl) {
      errorEl.textContent = '';
      field.setAttribute('aria-invalid', 'false');
      field.classList.remove('border-red-500');
    }
  }

  function clearAll() {
    hideError('decimalInput');
    hideError('repeatingDigits');
    hide(resultsContent);
    show(resultsPlaceholder);
    fractionResult.textContent = '—';
    mixedResult.textContent = '—';
    stepsResult.innerHTML = '';
    if (isRepeating.checked) {
      isRepeating.click();
    }
  }
  
  // Use BigInt for high-precision integer math
  function gcd(a, b) {
    a = a < 0n ? -a : a;
    b = b < 0n ? -b : b;
    while (b) {
      [a, b] = [b, a % b];
    }
    return a;
  }

  // --- Validation Functions ---
  function validateDecimal() {
    hideError('decimalInput');
    const val = decimalInput.value.trim();
    if (val === '') {
      showError('decimalInput', 'Please enter a decimal number.');
      return false;
    }
    // Allows: -0.5, 0.5, .5, 5.
    if (!/^-?\d*(\.\d*)?$/.test(val) || val === '.' || val === '-') {
      showError('decimalInput', 'Please enter a valid decimal number (e.g., 0.5 or -1.25).');
      return false;
    }
    return true;
  }

  function validateRepeating() {
    if (!isRepeating.checked) return true; // Not applicable
    hideError('repeatingDigits');
    const val = repeatingDigits.value.trim();
    if (val === '') {
      showError('repeatingDigits', 'Please enter the repeating digits.');
      return false;
    }
    if (!/^\d+$/.test(val)) {
      showError('repeatingDigits', 'Repeating digits must be numbers only.');
      return false;
    }
    return true;
  }

  // --- Calculation Logic ---
  
  function calculate() {
    const isDecimalValid = validateDecimal();
    const isRepeatingValid = validateRepeating();

    if (!isDecimalValid || !isRepeatingValid) {
      return;
    }

    const decimalStr = decimalInput.value.trim();
    const isNegative = decimalStr.startsWith('-');
    const positiveDecimalStr = isNegative ? decimalStr.substring(1) : decimalStr;

    let result;
    if (isRepeating.checked) {
      result = convertRepeating(positiveDecimalStr, repeatingDigits.value);
    } else {
      result = convertTerminating(positiveDecimalStr);
    }

    if (isNegative) {
      result.num = -result.num;
    }
    
    displayResults(result);
  }

  /**
   * Converts a terminating decimal string to a fraction object
   * @param {string} decStr - The positive decimal string (e.g., "0.75")
   * @returns {{num: bigint, den: bigint, steps: string, mixed: string}}
   */
  function convertTerminating(decStr) {
    let [integerPart, decimalPart] = decStr.split('.');
    
    if (decimalPart === undefined) decimalPart = ''; // Handle whole numbers
    if (integerPart === '') integerPart = '0'; // Handle numbers like ".5"

    const decimalPlaces = decimalPart.length;
    const denominator = 10n ** BigInt(decimalPlaces);
    
    // Combine integer and decimal parts into a single numerator
    const numerator = BigInt(integerPart + decimalPart);

    const commonDivisor = gcd(numerator, denominator);
    const simplifiedNum = numerator / commonDivisor;
    const simplifiedDen = denominator / commonDivisor;

    // Build steps
    let steps = `<ol class="list-decimal list-inside space-y-2">
      <li>Write the decimal as a fraction over 1: \( \\frac{${decStr}}{1} \)</li>
      <li>Multiply the numerator and denominator by 10 for each decimal place (${decimalPlaces}) to get an integer numerator:
        <div class="formula-box">$$ \\frac{${decStr} \\times ${denominator}}{1 \\times ${denominator}} = \\frac{${numerator}}{${denominator}} $$</div>
      </li>
      <li>Find the Greatest Common Divisor (GCD) of ${numerator} and ${denominator}, which is <strong>${commonDivisor}</strong>.</li>
      <li>Divide both numerator and denominator by the GCD to simplify:
        <div class="formula-box">$$ \\frac{${numerator} \\div ${commonDivisor}}{${denominator} \\div ${commonDivisor}} = \\frac{${simplifiedNum}}{${simplifiedDen}} $$</div>
      </li>
      <li>Final Answer: <strong>\( \\frac{${simplifiedNum}}{${simplifiedDen}} \)</strong></li>
    </ol>`;

    return {
      num: simplifiedNum,
      den: simplifiedDen,
      steps: steps
    };
  }

  /**
   * Converts a repeating decimal string to a fraction object
   * @param {string} decStr - The positive decimal string (e.g., "0.53")
   * @param {string} repeatingStr - The repeating part (e.g., "3")
   * @returns {{num: bigint, den: bigint, steps: string, mixed: string}}
   */
  function convertRepeating(decStr, repeatingStr) {
    let [integerPart, decimalPart] = decStr.split('.');
    
    if (decimalPart === undefined) decimalPart = '';
    if (integerPart === '') integerPart = '0';

    // Find the non-repeating part of the decimal
    let nonRepeatingPart = '';
    if (decimalPart.endsWith(repeatingStr)) {
        nonRepeatingPart = decimalPart.substring(0, decimalPart.length - repeatingStr.length);
    } else {
        // This handles cases where user inputs "0.3" and "3"
        // Or "0.12" and "34" (where 0.12 is non-repeating)
        nonRepeatingPart = decimalPart;
    }
    
    const k = BigInt(repeatingStr.length); // Length of repeating part
    const m = BigInt(nonRepeatingPart.length); // Length of non-repeating decimal part

    const fullNumberStr = nonRepeatingPart + repeatingStr;
    const nonRepeatingStr = nonRepeatingPart || '0';

    const numerator = BigInt(fullNumberStr) - BigInt(nonRepeatingStr);
    const denominator = (10n ** k - 1n) * (10n ** m);

    // Add back the integer part
    const integerBigInt = BigInt(integerPart);
    const finalNumerator = (integerBigInt * denominator) + numerator;
    const finalDenominator = denominator;
    
    const commonDivisor = gcd(finalNumerator, finalDenominator);
    const simplifiedNum = finalNumerator / commonDivisor;
    const simplifiedDen = finalDenominator / commonDivisor;

    // Build steps
    let steps = `<p>Converting the decimal part (0.${decimalPart}...) first:</p>
    <ol class="list-decimal list-inside space-y-2">
      <li>Identify the parts:
        <ul class="list-disc list-inside ml-4">
          <li>Non-repeating decimal: \( ${nonRepeatingPart || " (none)"} \) (m = ${m} digits)</li>
          <li>Repeating decimal: \( ${repeatingStr} \) (k = ${k} digits)</li>
        </ul>
      </li>
      <li>Form the numerator by subtracting the non-repeating part from the full number:
        <div class="formula-box">$$ ${fullNumberStr} - ${nonRepeatingStr} = ${numerator} $$</div>
      </li>
      <li>Form the denominator with ${k} nines (for repeating) and ${m} zeros (for non-repeating):
        <div class="formula-box">$$ \\text{Denominator} = ${'9'.repeat(Number(k))}${'0'.repeat(Number(m))} = ${denominator} $$</div>
      </li>
      <li>Initial fraction for the decimal part: \( \\frac{${numerator}}{${denominator}} \)</li>
      ${integerBigInt > 0n ? `<li>Add the whole number part (${integerPart}):
        <div class="formula-box">$$ ${integerPart} + \\frac{${numerator}}{${denominator}} = \\frac{${integerBigInt} \\times ${denominator} + ${numerator}}{${denominator}} = \\frac{${finalNumerator}}{${finalDenominator}} $$</div>
      </li>` : ''}
      <li>Find the GCD of ${finalNumerator} and ${finalDenominator}, which is <strong>${commonDivisor}</strong>.</li>
      <li>Simplify the final fraction:
        <div class="formula-box">$$ \\frac{${finalNumerator} \\div ${commonDivisor}}{${finalDenominator} \\div ${commonDivisor}} = \\frac{${simplifiedNum}}{${simplifiedDen}} $$</div>
      </li>
      <li>Final Answer: <strong>\( \\frac{${simplifiedNum}}{${simplifiedDen}} \)</strong></li>
    </ol>`;
    
    return {
      num: simplifiedNum,
      den: simplifiedDen,
      steps: steps
    };
  }
  
  /**
   * Generates a mixed number string
   * @param {bigint} num - Numerator
   * @param {bigint} den - Denominator
   * @returns {string} - Mixed number (e.g., "1 1/2") or "—"
   */
  function getMixedNumber(num, den) {
    const isNegative = num < 0n;
    const absNum = isNegative ? -num : num;
    
    if (absNum <= den) {
      return '—'; // Not an improper fraction
    }

    const whole = absNum / den;
    const remainder = absNum % den;
    
    if (remainder === 0n) {
      return '—'; // It's a whole number
    }
    
    const sign = isNegative ? '-' : '';
    return `${sign}${whole} \\( \\frac{${remainder}}{${den}} \\)`;
  }

  /**
   * Displays the final results in the UI
   * @param {{num: bigint, den: bigint, steps: string}} result
   */
  function displayResults(result) {
    const { num, den, steps } = result;

    const fractionString = `\\( \\frac{${num}}{${den}} \\)`;
    const mixedString = getMixedNumber(num, den);

    fractionResult.innerHTML = fractionString;
    mixedResult.innerHTML = mixedString;
    stepsResult.innerHTML = steps;

    hide(resultsPlaceholder);
    show(resultsContent);
    
    // Re-render LaTeX
    if (window.MathJax) {
      window.MathJax.typesetPromise([fractionResult, mixedResult, stepsResult]);
    }
  }

});
</script>

<script>
document.getElementById('mobile-menu-toggle').addEventListener('click', function() {
  var menu = document.getElementById('mobile-menu');
  var isHidden = menu.classList.contains('hidden');
  menu.classList.toggle('hidden', !isHidden);
  this.setAttribute('aria-expanded', isHidden);
});
</script>
</body>
</html>
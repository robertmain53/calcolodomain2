<!DOCTYPE html>
<html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/standard-deviation">





 
<link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg" />
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png" />
<link rel="manifest" href="https://calcdomain.com/site.webmanifest" />
<meta charset="utf-8">
<title>Standard Deviation Calculator | Math — Statistics &amp; Probability</title>
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="Professional, mobile-first standard deviation calculator. Paste numbers to instantly get sample and population standard deviation, variance, mean, median, range, and more — WCAG 2.1 AA accessible." name="description">
<meta content="Ugo Candido" name="author">

<meta content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" name="robots">
<meta content="#ffffff" name="theme-color">
<style>
    /* ===== Design tokens (mobile-first) ===== */
    :root{
      --primary:#005A9C; --primary-600:#00497d; --secondary:#0b2239;
      --bg:#F8F9FA; --surface:#FFFFFF;
      --text:#212529; --muted:#6C757D; --border:#DEE2E6;
      --success:#198754; --error:#DC3545; --warning:#B08900;
      --radius-6:6px; --radius-8:8px; --radius-12:12px;
      --touch:48px; --space-4:.25rem; --space-6:.375rem; --space-8:.5rem; --space-12:.75rem; --space-16:1rem; --space-24:1.5rem; --space-32:2rem;
      --shadow:0 2px 8px rgba(0,0,0,.06);
    }
    @media (prefers-contrast: more){
      :root{ --primary:#003265; --secondary:#000; --text:#000; --border:#222; --bg:#fff; }
    }
    @media (prefers-reduced-motion: reduce){
      *{ animation-duration:.01ms !important; animation-iteration-count:1 !important; transition-duration:.01ms !important; scroll-behavior:auto !important; }
    }

    /* ===== Base ===== */
    *,*::before,*::after{ box-sizing:border-box; }
    html{ font-size:16px; }
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text); background:var(--bg); line-height:1.6; -webkit-text-size-adjust:100%;
    }
    a{ color:var(--primary); text-decoration:none; }
    a:hover{ text-decoration:underline; }
    img{ max-width:100%; height:auto; }

    .skip-link{
      position:absolute; left:8px; top:-40px; background:var(--primary); color:#fff; padding:8px 12px; border-radius:0 0 4px 4px;
      z-index:1000; text-decoration:none; font-weight:600;
    }
    .skip-link:focus{ top:0; }

    .container{ max-width:1100px; margin:0 auto; padding:0 var(--space-16); }
    header{ background:var(--surface); border-bottom:1px solid var(--border); }
    .header-inner{ display:flex; gap:var(--space-16); align-items:center; justify-content:space-between; padding: .75rem 0; }
    .brand{ font-weight:800; color:var(--secondary); letter-spacing:.2px; }
    .brand:focus{ outline:3px solid var(--primary); outline-offset:2px; border-radius:4px; }
    nav a{ color:var(--secondary); padding:6px 10px; border-radius:6px; }
    nav a:focus{ outline:3px solid var(--primary); outline-offset:2px; }

    main{ padding: var(--space-32) 0; }
    h1,h2,h3{ color:var(--secondary); margin:0 0 .5rem; line-height:1.25; }
    h1{ font-size: clamp(1.6rem, 3.8vw, 2.2rem); }
    h2{ font-size: clamp(1.3rem, 3.2vw, 1.75rem); margin-top: 1.5rem; }
    h3{ font-size: clamp(1.1rem, 2.8vw, 1.25rem); margin-top: 1rem; }
    p{ margin:.5rem 0 1rem; max-width:70ch; }

    /* ===== Layout for calculator + content ===== */
    .calc-grid{ display:grid; grid-template-columns:1fr; gap:var(--space-32); margin-top: var(--space-16); }
    @media (min-width: 992px){
      .calc-grid{ grid-template-columns: 420px 1fr; align-items:start; }
    }

    .card{
      background:var(--surface); border:1px solid var(--border); border-radius:var(--radius-12);
      box-shadow:var(--shadow); padding: clamp(1rem, 2.5vw, 1.5rem);
    }

    /* ===== Form ===== */
    .form-group{ margin-bottom: var(--space-24); }
    label{ display:block; font-weight:700; margin-bottom: .5rem; }
    .label-row{ display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; }
    .help-btn{
      appearance:none; border:1px solid var(--border); background:var(--surface);
      color:var(--secondary); border-radius:50%; width:28px; height:28px; line-height:26px; text-align:center; font-weight:800; cursor:pointer;
    }
    .help-btn:focus{ outline:3px solid var(--primary); outline-offset:2px; }
    .helptext{ margin-top:.5rem; background:#f1f3f5; border:1px solid var(--border); border-radius: var(--radius-8); padding:.75rem; }
    .helptext[hidden]{ display:none !important; }

    .control, textarea{
      width:100%; min-height: var(--touch);
      padding: .75rem .9rem; font-size:1rem; color:var(--text);
      border:1px solid var(--border); border-radius:var(--radius-8); background:#fff;
      transition: box-shadow .2s ease, border-color .2s ease;
    }
    .control:focus, textarea:focus{
      outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(0,90,156,.2);
    }
    .control[aria-invalid="true"], textarea[aria-invalid="true"]{ border-color: var(--error); }
    .error{ color:var(--error); font-size:.9375rem; margin-top:.35rem; min-height:1.25rem; }

    .radio-group{ display:flex; gap:.5rem; border:1px solid var(--border); border-radius:var(--radius-8); padding:.25rem; }
    .radio-option{ position:relative; }
    .radio-option input{ position:absolute; inset:0; opacity:0; }
    .radio-option label{
      display:inline-flex; align-items:center; justify-content:center; gap:.5rem; min-height:var(--touch);
      padding:.5rem .75rem; border-radius:var(--radius-6); cursor:pointer; min-width:120px;
    }
    .radio-option input:checked + label{ background: var(--primary); color:#fff; }
    .radio-option input:focus + label{ outline:3px solid var(--primary); outline-offset:2px; }

    .row{ display:flex; gap:.75rem; flex-wrap:wrap; }
    .row .col{ flex:1 1 160px; }

    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:.5rem; padding:.7rem 1rem; min-height:var(--touch); min-width:var(--touch);
      border-radius:var(--radius-8); border:1px solid transparent; background:var(--primary); color:#fff; font-weight:700; cursor:pointer;
      transition: background .2s ease, transform .06s ease;
    }
    .btn:hover{ background:var(--primary-600); text-decoration:none; }
    .btn:active{ transform: translateY(1px); }
    .btn.secondary{ background:#fff; color:var(--primary); border-color:var(--primary); }
    .btn.ghost{ background:transparent; color:var(--primary); border-color: var(--border); }
    .toolbar{ display:flex; gap:.5rem; flex-wrap:wrap; }

    /* ===== Results ===== */
    .results{ min-height: 260px; }
    .results h2{ margin-top:0; }
    .stat{
      display:grid; grid-template-columns:1fr auto; gap:.75rem; padding:.5rem 0; border-bottom:1px solid var(--border);
    }
    .stat:last-child{ border-bottom:none; }
    .stat .k{ color:var(--muted); }
    .stat .v{ font-weight:800; color:var(--success); }
    .highlight{ font-size:1.15rem; }
    .muted{ color:var(--muted); }

    .formula-box{ background:#eef3f8; border:1px solid var(--border); border-radius:var(--radius-8); padding:1rem; overflow:auto; }
    code, .math{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; background:#f1f3f5; padding:.15rem .35rem; border-radius:4px; }

    .author-box{ margin-top:1.5rem; border-top:1px solid var(--border); padding-top:1rem; color:var(--muted); font-size:.95rem; }

    footer{ background:var(--secondary); color:#fff; margin-top:2.5rem; }
    .footer-inner{ padding:1.25rem 0; font-size:.95rem; }
    .footer-inner a{ color:#fff; }

    /* Utility */
    .sr-only{ position:absolute; width:1px; height:1px; margin:-1px; padding:0; overflow:hidden; clip:rect(0,0,0,0); border:0; white-space:nowrap; }
    .notice{ font-size:.95rem; color:#555; }
  </style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Standard Deviation Calculator",
  "description": "Calculate sample and population standard deviation, variance, mean, median, range, and more. Paste numbers to get instant results with an accessible, mobile-first interface.",
  "url": "https://calcdomain.com/standard-deviation",
  "isPartOf": {
    "@type": "WebSite",
    "name": "CalcDomain",
    "url": "https://calcdomain.com"
  },
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  },
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "How to calculate standard deviation (step-by-step example)",
      "description": "A worked example using the data set 2, 4, 4, 4, 5, 5, 7, 9 to compute mean and both population and sample standard deviation.",
      "step": [
        {
          "@type": "HowToStep",
          "name": "Prepare the data",
          "text": "Use the dataset: 2, 4, 4, 4, 5, 5, 7, 9."
        },
        {
          "@type": "HowToStep",
          "name": "Compute the mean",
          "text": "Mean x̄ = (2+4+4+4+5+5+7+9)/8 = 40/8 = 5."
        },
        {
          "@type": "HowToStep",
          "name": "Sum squared deviations",
          "text": "Σ(xi − x̄)² = 9 + 1 + 1 + 1 + 0 + 0 + 4 + 16 = 32."
        },
        {
          "@type": "HowToStep",
          "name": "Population SD",
          "text": "σ = sqrt(Σ(xi − μ)² / N) = sqrt(32/8) = 2."
        },
        {
          "@type": "HowToStep",
          "name": "Sample SD",
          "text": "s = sqrt(Σ(xi − x̄)² / (n−1)) = sqrt(32/7) ≈ 2.138."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is the difference between sample and population standard deviation?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Population SD uses N in the denominator when you have the entire population. Sample SD uses n−1 (Bessel’s correction) to provide an unbiased estimate when you have a sample."
          }
        },
        {
          "@type": "Question",
          "name": "How many numbers do I need to compute standard deviation?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "For population SD you can compute it with at least one value (though it will be zero if all values are equal); for sample SD you need at least two values."
          }
        },
        {
          "@type": "Question",
          "name": "Can I paste numbers separated by spaces, commas, or new lines?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. The calculator accepts commas, spaces, tabs, semicolons, and new lines as separators. Blank lines are ignored."
          }
        },
        {
          "@type": "Question",
          "name": "Does the calculator handle negative and decimal values?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. It supports negative values, decimals, and scientific notation (e.g., 1e3). Non-numeric tokens are safely ignored with a note."
          }
        },
        {
          "@type": "Question",
          "name": "What other statistics are computed?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Count, sum, mean, median, min, max, range, population and sample variance and standard deviation, coefficient of variation, and standard error of the mean."
          }
        },
        {
          "@type": "Question",
          "name": "How should I round results?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Use a precision appropriate to your measurement resolution. You can adjust decimal places in the tool to control display rounding without affecting internal precision."
          }
        },
        {
          "@type": "Question",
          "name": "Is my data stored?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. All calculations run in your browser. We do not transmit or store your data."
          }
        }
      ]
    }
  ]
}
  </script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer></script>
<!-- MathJax for LaTeX formulas -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\(','\)'], ['$', '$']],
      displayMath: [['$','$'], ['\[','\]']]
    },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="preload" href="https://calcdomain.com/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="https://calcdomain.com/assets/js/page-enhancements.js" as="script">

</head>
<body>

<a class="skip-link" href="#main">Skip to main content</a>
<header aria-label="Site header" role="banner">
<div class="container header-inner">
CalcDomain
<nav aria-label="Primary">
<a href="https://calcdomain.com/math">Math</a>
<a href="https://calcdomain.com/statistics">Statistics</a>
<a href="https://calcdomain.com/about">About</a>
</nav>
</div>
</header>
<main class="container" id="main" role="main">
<h1>Standard Deviation Calculator</h1>
<p>This professional standard deviation calculator lets you paste or type numbers to instantly compute sample and population standard deviation, variance, mean, median, and other descriptive statistics. It is designed for students, analysts, scientists, and anyone who needs precise, accessible, and mobile‑friendly statistical results.</p>
<div class="calc-grid" id="calculator">
<!-- Calculator -->
<section aria-labelledby="calc-heading" class="card">
<h2 id="calc-heading">Calculator</h2>
<div class="form-group">
<div class="label-row">
<label for="dataset">Data set *</label>
<button aria-controls="datasetHelp" aria-expanded="false" aria-label="Show data entry help" class="help-btn" id="datasetHelpBtn" title="Show help" type="button">?</button>
</div>
<textarea aria-describedby="datasetHelp datasetError" aria-required="true" id="dataset" placeholder="Paste or type numbers separated by commas, spaces, tabs, semicolons, or new lines. Example:
2, 4, 4, 4, 5, 5, 7, 9" rows="8"></textarea>
<div class="helptext" hidden="" id="datasetHelp">
            Enter at least two numeric values for sample SD (n ≥ 2). For population SD, one value is allowed. Accepted separators: comma, space, tab, semicolon, or new line. Scientific notation like 1e3 is supported. Non-numeric tokens are ignored.
          </div>
<div aria-live="polite" class="error" id="datasetError" role="alert"></div>
</div>
<div aria-labelledby="modeLabel" class="form-group" role="group">
<span class="sr-only" id="modeLabel">Choose deviation type</span>
<div class="radio-group">
<div class="radio-option">
<input checked="" id="modeSample" name="mode" type="radio" value="sample">
<label for="modeSample">Sample</label>
</div>
<div class="radio-option">
<input id="modePopulation" name="mode" type="radio" value="population">
<label for="modePopulation">Population</label>
</div>
</div>
</div>
<div class="row">
<div class="form-group col">
<label for="decimals">Decimal places</label>
<input aria-describedby="decimalsError" class="control" id="decimals" inputmode="numeric" max="12" min="0" step="1" type="number" value="6">
<div aria-live="polite" class="error" id="decimalsError" role="alert"></div>
</div>
<div class="form-group col">
<label for="sortOutput">Sort data (ascending)</label>
<select aria-label="Sort data option" class="control" id="sortOutput">
<option selected="" value="no">No</option>
<option value="yes">Yes</option>
</select>
</div>
</div>
<div aria-label="Calculator actions" class="toolbar" role="toolbar">
<button aria-label="Calculate standard deviation" class="btn" id="calcBtn" type="button">Calculate</button>
<button aria-label="Load example data" class="btn secondary" id="exampleBtn" type="button">Load example</button>
<button aria-label="Clear data" class="btn ghost" id="clearBtn" type="button">Clear</button>
</div>
<p aria-live="polite" class="notice" id="parseNote"></p>
</section>
<!-- Results -->
<section aria-labelledby="results-heading" class="card results">
<h2 id="results-heading">Results</h2>
<p aria-live="polite" class="muted" id="resultSummary">No data yet. Enter numbers to see results.</p>
<div class="stat highlight">
<span class="k">Selected standard deviation</span>
<span class="v" id="sdSelected">—</span>
</div>
<div class="stat">
<span class="k">Population standard deviation (σ)</span>
<span class="v" id="sdPop">—</span>
</div>
<div class="stat">
<span class="k">Sample standard deviation (s)</span>
<span class="v" id="sdSam">—</span>
</div>
<div class="stat">
<span class="k">Population variance (σ²)</span>
<span class="v" id="varPop">—</span>
</div>
<div class="stat">
<span class="k">Sample variance (s²)</span>
<span class="v" id="varSam">—</span>
</div>
<div class="stat">
<span class="k">Mean (x̄)</span>
<span class="v" id="mean">—</span>
</div>
<div class="stat">
<span class="k">Median</span>
<span class="v" id="median">—</span>
</div>
<div class="stat">
<span class="k">Count (n)</span>
<span class="v" id="count">—</span>
</div>
<div class="stat">
<span class="k">Sum (Σx)</span>
<span class="v" id="sum">—</span>
</div>
<div class="stat">
<span class="k">Min</span>
<span class="v" id="min">—</span>
</div>
<div class="stat">
<span class="k">Max</span>
<span class="v" id="max">—</span>
</div>
<div class="stat">
<span class="k">Range (max − min)</span>
<span class="v" id="range">—</span>
</div>
<div class="stat">
<span class="k">Coefficient of variation (CV)</span>
<span class="v" id="cv">—</span>
</div>
<div class="stat">
<span class="k">Standard error of mean (SEM)</span>
<span class="v" id="sem">—</span>
</div>
</section>
</div>
<!-- Authoritative content ecosystem -->
<section aria-labelledby="methodology" class="card">
<h2 id="methodology">Data Source and Methodology</h2>
<p>
        Authoritative source: NIST/SEMATECH e-Handbook of Statistical Methods (2012, updated). Section: “Measures of Variability”. National Institute of Standards and Technology.
        <a href="https://www.itl.nist.gov/div898/handbook/pmc/section3/pmc35.htm" rel="noopener">Direct link</a>.
      </p>
<p><strong>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</strong></p>
</section>
<section aria-labelledby="formulae" class="card">
<h2 id="formulae">The Formula Explained</h2>
<div aria-live="polite" class="formula-box">
<p><strong>Population standard deviation</strong></p>
<p class="math">σ = \sqrt{ \frac{1}{N} \sum_{i=1}^{N} (x_i - \mu)^2 }</p>
<p class="muted">where μ is the population mean and N is the population size.</p>
<hr/>
<p><strong>Sample standard deviation</strong></p>
<p class="math">s = \sqrt{ \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^2 }</p>
<p class="muted">where x̄ is the sample mean and n is the sample size. The n−1 term is Bessel’s correction.</p>
<hr/>
<p><strong>Additional statistics</strong></p>
<p class="math">\text{Mean }(\bar{x}) = \frac{1}{n}\sum x_i, \quad \text{Range} = \max(x) - \min(x)</p>
<p class="math">\text{SEM} = \frac{s}{\sqrt{n}}, \quad \text{CV} = \frac{\text{SD}}{|\bar{x}|}</p>
</div>
</section>
<section aria-labelledby="glossary" class="card">
<h2 id="glossary">Glossary of Variables</h2>
<ul>
<li><strong>Data set:</strong> The list of numeric observations to analyze.</li>
<li><strong>Sample:</strong> Use when your data are a subset of a larger population; uses n−1 in the denominator.</li>
<li><strong>Population:</strong> Use when your data comprise the entire population; uses N in the denominator.</li>
<li><strong>Mean (x̄/μ):</strong> Average of all values.</li>
<li><strong>Variance (s²/σ²):</strong> Average of squared deviations from the mean.</li>
<li><strong>Standard deviation (s/σ):</strong> Square root of variance, in the same units as the data.</li>
<li><strong>Median:</strong> Middle value (or average of two middle values) when data are ordered.</li>
<li><strong>Range:</strong> Difference between maximum and minimum.</li>
<li><strong>Coefficient of variation (CV):</strong> Relative dispersion: SD divided by absolute mean (unitless).</li>
<li><strong>Standard error of the mean (SEM):</strong> Estimated uncertainty of the sample mean, s/√n.</li>
</ul>
</section>
<section aria-labelledby="worked-example" class="card">
<h2 id="worked-example">Worked Example</h2>
<h3>How It Works: A Step-by-Step Example</h3>
<p>Consider the data set: 2, 4, 4, 4, 5, 5, 7, 9.</p>
<ol>
<li>Compute the mean:
          <span class="math">\bar{x} = (2+4+4+4+5+5+7+9)/8 = 40/8 = 5</span>
</li>
<li>Compute squared deviations and sum:
          <span class="math">\sum (x_i - \bar{x})^2 = 32</span>
</li>
<li>Population variance and SD:
          <span class="math">\sigma^2 = 32/8 = 4,\quad \sigma = \sqrt{4} = 2</span>
</li>
<li>Sample variance and SD:
          <span class="math">s^2 = 32/7 \approx 4.571428,\quad s \approx 2.138090</span>
</li>
</ol>
<p>You can load this example into the calculator with the “Load example” button to verify the results.</p>
</section>
<section aria-labelledby="faq" class="card">
<h2 id="faq">Frequently Asked Questions (FAQ)</h2>
<h3>When should I choose sample vs population?</h3>
<p>Choose <strong>sample</strong> when your data represent a subset of a larger population; choose <strong>population</strong> when you have every member of the population. If unsure, use sample.</p>
<h3>Why does sample SD use n−1?</h3>
<p>Using n−1 (Bessel’s correction) corrects the bias in estimating the population variance and SD from a sample.</p>
<h3>What separators are supported for input?</h3>
<p>Commas, spaces, tabs, semicolons, and new lines. Multiple separators and blank lines are handled gracefully.</p>
<h3>Do you handle scientific notation?</h3>
<p>Yes. Inputs like 1e3, 2.5e-2, and -3.2E+1 are parsed as valid numbers.</p>
<h3>Can I sort the data without changing results?</h3>
<p>Yes. Sorting affects display order only. Statistics are order-invariant.</p>
<h3>What if some tokens are not numbers?</h3>
<p>They are ignored, and we show a note indicating how many were skipped so you can correct your data if needed.</p>
<h3>How is rounding handled?</h3>
<p>Enter the number of decimal places to round the display. Internal calculations use double precision and are then rounded for presentation.</p>
</section>
<div class="author-box">
<p>
        Tool developed by <strong>Ugo Candido</strong>. Content verified by <strong>CalcDomain Expert Team</strong>.<br/>
        Last reviewed for accuracy on: <time datetime="2025-09-14">September 14, 2025</time>.
      </p>
</div>
</main>
<!-- Standard Footer --> 
<script defer="">
    (function(){
      'use strict';

      // Elements
      const datasetEl = document.getElementById('dataset');
      const datasetError = document.getElementById('datasetError');
      const parseNote = document.getElementById('parseNote');
      const decimalsEl = document.getElementById('decimals');
      const decimalsError = document.getElementById('decimalsError');
      const sortEl = document.getElementById('sortOutput');
      const modeSample = document.getElementById('modeSample');
      const modePopulation = document.getElementById('modePopulation');
      const calcBtn = document.getElementById('calcBtn');
      const exampleBtn = document.getElementById('exampleBtn');
      const clearBtn = document.getElementById('clearBtn');
      const resultSummary = document.getElementById('resultSummary');

      // Results
      const sdSelected = document.getElementById('sdSelected');
      const sdPop = document.getElementById('sdPop');
      const sdSam = document.getElementById('sdSam');
      const varPop = document.getElementById('varPop');
      const varSam = document.getElementById('varSam');
      const meanEl = document.getElementById('mean');
      const medianEl = document.getElementById('median');
      const countEl = document.getElementById('count');
      const sumEl = document.getElementById('sum');
      const minEl = document.getElementById('min');
      const maxEl = document.getElementById('max');
      const rangeEl = document.getElementById('range');
      const cvEl = document.getElementById('cv');
      const semEl = document.getElementById('sem');

      // Tooltip/help toggle
      const helpBtn = document.getElementById('datasetHelpBtn');
      const helpBox = document.getElementById('datasetHelp');
      helpBtn.addEventListener('click', () => {
        const isOpen = helpBtn.getAttribute('aria-expanded') === 'true';
        helpBtn.setAttribute('aria-expanded', String(!isOpen));
        helpBox.hidden = isOpen;
        if(!isOpen){ helpBox.focus?.(); }
      });

      // Parsing
      function parseNumbers(raw){
        if(!raw) return { values: [], skipped: 0 };
        const tokens = raw.trim().split(/[\s,;]+/);
        let values = [];
        let skipped = 0;
        for(const t of tokens){
          if(!t) continue;
          // Allow numbers like .5 or -.5 by normalizing
          const normalized = t.replace(/^\.(?=\d)/, '0.').replace(/^-\.(?=\d)/, '-0.');
          const num = Number(normalized);
          if(Number.isFinite(num)){
            values.push(num);
          }else{
            skipped++;
          }
        }
        return { values, skipped };
      }

      function validateDecimals(){
        const val = decimalsEl.value.trim();
        if(val === ''){
          decimalsError.textContent = 'Please enter a whole number between 0 and 12.';
          decimalsEl.setAttribute('aria-invalid','true');
          return null;
        }
        const n = Number(val);
        if(!Number.isInteger(n) || n < 0 || n > 12){
          decimalsError.textContent = 'Decimal places must be a whole number between 0 and 12.';
          decimalsEl.setAttribute('aria-invalid','true');
          return null;
        }
        decimalsError.textContent = '';
        decimalsEl.setAttribute('aria-invalid','false');
        return n;
      }

      function median(sorted){
        const n = sorted.length;
        if(n === 0) return NaN;
        const mid = Math.floor(n/2);
        return n % 2 === 0 ? (sorted[mid-1] + sorted[mid]) / 2 : sorted[mid];
      }

      function sum(arr){ return arr.reduce((a,b)=>a+b,0); }

      function stats(values){
        const n = values.length;
        if(n === 0){
          return {
            n:0,sum:NaN,mean:NaN,median:NaN,min:NaN,max:NaN,range:NaN,
            varPop:NaN,varSam:NaN,sdPop:NaN,sdSam:NaN,cvPop:NaN,sem:NaN
          };
        }
        const total = sum(values);
        const mean = total / n;
        let min = values[0], max = values[0];
        for(let i=1;i<n;i++){
          const v = values[i];
          if(v < min) min = v;
          if(v > max) max = v;
        }
        const range = max - min;

        // Sum of squared deviations
        let ssd = 0;
        for(let i=0;i<n;i++){
          const d = values[i] - mean;
          ssd += d*d;
        }
        const varPop = n > 0 ? (ssd / n) : NaN;
        const varSam = n > 1 ? (ssd / (n - 1)) : NaN;
        const sdPop = Math.sqrt(varPop);
        const sdSam = Math.sqrt(varSam);

        const sorted = [...values].sort((a,b)=>a-b);
        const med = median(sorted);

        const cvPop = mean !== 0 ? (sdPop / Math.abs(mean)) : NaN;
        const sem = n > 1 ? (sdSam / Math.sqrt(n)) : NaN;

        return { n, sum: total, mean, median: med, min, max, range, varPop, varSam, sdPop, sdSam, cvPop, sem, sorted };
      }

      function formatNumber(x, dp){
        if(!Number.isFinite(x)) return '—';
        // Use toLocaleString for grouping, fixed dp
        return Number(x).toLocaleString(undefined, { minimumFractionDigits: dp, maximumFractionDigits: dp });
      }

      function update(){
        const { values, skipped } = parseNumbers(datasetEl.value);
        const dp = validateDecimals();
        // Validation for dataset
        let isSample = modeSample.checked;
        let ok = true;
        if(values.length === 0){
          datasetError.textContent = 'Enter your numbers. For sample SD you need at least two values.';
          datasetEl.setAttribute('aria-invalid','true');
          ok = false;
        }else if(isSample && values.length < 2){
          datasetError.textContent = 'Sample standard deviation requires at least two values (n ≥ 2). Add more data or switch to Population.';
          datasetEl.setAttribute('aria-invalid','true');
          ok = false;
        }else{
          datasetError.textContent = '';
          datasetEl.setAttribute('aria-invalid','false');
        }

        if(skipped > 0){
          parseNote.textContent = `${skipped} non-numeric item${skipped>1?'s':''} ignored.`;
        }else{
          parseNote.textContent = '';
        }

        if(!ok || dp === null){
          // Reset display but keep counts
          resultSummary.textContent = values.length ? `Parsed ${values.length} value${values.length>1?'s':''}.` : 'No data yet. Enter numbers to see results.';
          sdSelected.textContent = sdPop.textContent = sdSam.textContent = varPop.textContent = varSam.textContent =
          meanEl.textContent = medianEl.textContent = countEl.textContent = sumEl.textContent = minEl.textContent =
          maxEl.textContent = rangeEl.textContent = cvEl.textContent = semEl.textContent = '—';
          return;
        }

        // Sort for median option (display only)
        const doSort = sortEl.value === 'yes';
        const arr = doSort ? [...values].sort((a,b)=>a-b) : values;

        const st = stats(arr);
        const mode = isSample ? 'Sample' : 'Population';

        resultSummary.textContent = `${st.n} value${st.n>1?'s':''} parsed. Showing ${mode.toLowerCase()} results.`;

        sdPop.textContent = formatNumber(st.sdPop, dp);
        sdSam.textContent = formatNumber(st.sdSam, dp);
        varPop.textContent = formatNumber(st.varPop, dp);
        varSam.textContent = formatNumber(st.varSam, dp);
        meanEl.textContent = formatNumber(st.mean, dp);
        medianEl.textContent = formatNumber(st.median, dp);
        countEl.textContent = String(st.n);
        sumEl.textContent = Number.isFinite(st.sum) ? st.sum.toLocaleString(undefined, { maximumFractionDigits: dp }) : '—';
        minEl.textContent = formatNumber(st.min, dp);
        maxEl.textContent = formatNumber(st.max, dp);
        rangeEl.textContent = formatNumber(st.range, dp);
        cvEl.textContent = formatNumber(st.cvPop, dp);
        semEl.textContent = formatNumber(st.sem, dp);

        // Selected SD
        sdSelected.textContent = isSample ? sdSam.textContent : sdPop.textContent;
      }

      // Events
      datasetEl.addEventListener('blur', update);
      datasetEl.addEventListener('input', () => {
        // Lightweight live preview without strict validation error noise
        update();
      });
      decimalsEl.addEventListener('blur', validateDecimals);
      decimalsEl.addEventListener('input', () => { /* soft validate */ validateDecimals(); update(); });
      sortEl.addEventListener('change', update);
      modeSample.addEventListener('change', update);
      modePopulation.addEventListener('change', update);
      calcBtn.addEventListener('click', () => { update(); calcBtn.focus(); });

      exampleBtn.addEventListener('click', () => {
        datasetEl.value = '2, 4, 4, 4, 5, 5, 7, 9';
        modeSample.checked = true;
        modePopulation.checked = false;
        update();
        exampleBtn.focus();
      });

      clearBtn.addEventListener('click', () => {
        datasetEl.value = '';
        datasetEl.setAttribute('aria-invalid','false');
        datasetError.textContent = '';
        parseNote.textContent = '';
        update();
        datasetEl.focus();
      });

      // Initialize
      update();
    })();
  </script>

</body></html>
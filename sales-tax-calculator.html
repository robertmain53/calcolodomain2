<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg" />
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png" />
<link rel="manifest" href="https://calcdomain.com/site.webmanifest" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sales Tax Calculator - Calculate Total, Original Price & Rate</title>
<meta name="description" content="Instantly calculate sales tax, total price, or reverse-calculate the original price from a total. Accurate, fast, and easy to use for any sales tax rate.">
<link rel="canonical" href="https://calcdomain.com/sales-tax-calculator.html"/>
<meta name="author" content="Ugo Candido">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.5rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.prose .formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1.5rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
text-align: center; font-size: 1.1rem;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; font-weight: 500; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }
/* Stili per accessibilit√† e UI del calcolatore */
label { display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem; }
input[type="number"] {
-moz-appearance: textfield; /* Rimuove frecce su Firefox */
}
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
-webkit-appearance: none; /* Rimuove frecce su Chrome, Safari, Edge */
margin: 0;
}
input[type="radio"] {
width: 1.25rem; height: 1.25rem;
border-color: #9ca3af;
}
input[type="radio"]:checked {
background-color: #2563eb;
border-color: #2563eb;
}
input[type="radio"]:focus {
ring: 2px;
ring-offset: 2px;
ring-color: #2563eb;
}
/* Stile focus visibile personalizzato per WCAG */
input[type="number"]:focus, input[type="radio"]:focus, select:focus {
outline: 3px solid transparent;
border-color: #2563eb;
box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
}
.error-message {
color: #dc2626;
font-size: 0.875rem;
margin-top: 0.25rem;
display: none; /* Nascosto di default */
}
input[aria-invalid="true"] {
border-color: #dc2626;
}
input[aria-invalid="true"]:focus {
box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.3);
border-color: #dc2626;
}
/* Prevenzione CLS: altezza minima per il blocco risultati */
#results {
min-height: 120px;
}
</style>

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "WebPage",
"name": "Sales Tax Calculator",
"description": "Instantly calculate sales tax, total price, or reverse-calculate the original price from a total. Accurate, fast, and easy to use for any sales tax rate.",
"url": "https://calcdomain.com/sales-tax-calculator.html",
"inLanguage": "en",
"author": { "@type": "Person", "name": "Ugo Candido" },
"publisher": { "@type": "Organization", "name": "CalcDomain" }
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "BreadcrumbList",
"itemListElement": [
{ "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/" },
{ "@type": "ListItem", "position": 2, "name": "Lifestyle Everyday", "item": "https://calcdomain.com/lifestyle-everyday.html" },
{ "@type": "ListItem", "position": 3, "name": "Miscellaneous", "item": "https://calcdomain.com/subcategories/miscellaneous.html" },
{ "@type": "ListItem", "position": 4, "name": "Sales Tax Calculator", "item": "https://calcdomain.com/sales-tax-calculator.html" }
]
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "HowTo",
"name": "How to Use the Sales Tax Calculator",
"description": "A step-by-step guide to calculating sales tax, total price, or original price.",
"step": [
{
"@type": "HowToStep",
"name": "Select Calculation Mode",
"text": "Choose what you want to find: 'Calculate Total Price' (default), 'Calculate Original Price' (reverse calculation), or 'Calculate Tax Rate'."
},
{
"@type": "HowToStep",
"name": "Enter Known Values",
"text": "Fill in the required fields for your chosen mode. For example, enter the 'Price before Tax' and 'Sales Tax Rate' to find the total."
},
{
"@type": "HowToStep",
"name": "Review Instant Results",
"text": "The calculator instantly displays the calculated values (Total Price, Sales Tax Amount, and Original Price) as you type."
}
]
}
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script src="https://calcdomain.com/search.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm sticky top-0 z-50">
<nav class="container mx-auto px-4 lg:px-6 py-4">
<div class="flex justify-between items-center">
<a href="https://calcdomain.com/index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

<div class="w-full max-w-md hidden md:block mx-8">
<div class="relative">
<input type="search" id="search-input" placeholder="Search for a calculator..."
class="w-full py-2 px-4 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
autocomplete="off">
<svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
</svg>
<div id="search-results" class="absolute top-full left-0 right-0 hidden bg-white border border-gray-200 rounded-lg shadow-lg mt-2 max-h-96 overflow-y-auto z-50"></div>
</div>
</div>

<div class="hidden md:flex items-center space-x-6 text-sm">
<a href="https://calcdomain.com/search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="https://calcdomain.com/index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
</div>

<button id="mobile-menu-toggle" class="md:hidden p-2" aria-label="Open menu">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M4 6h16M4 12h16M4 18h16"></path>
</svg>
</button>
</div>

<div id="mobile-menu" class="md:hidden mt-4 hidden">
<div class="space-y-2">
<a href="https://calcdomain.com/search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="https://calcdomain.com/index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
</div>
</div>
</nav>
</header>

<main class="container mx-auto px-4 lg:px-6 py-10">
<div class="flex flex-col lg:flex-row gap-8">

<section class="w-full lg:w-2/3">
<nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
<a href="https://calcdomain.com/index.html" class="hover:text-blue-600">Home</a> &raquo;
<a href="https://calcdomain.com/lifestyle-everyday.html" class="hover:text-blue-600">Lifestyle Everyday</a> &raquo;
<a href="https://calcdomain.com/subcategories/miscellaneous.html" class="hover:text-blue-600">Miscellaneous</a> &raquo;
<span class="text-gray-900">Sales Tax Calculator</span>
</nav>

<article class="bg-white p-6 rounded-lg shadow-md">
<h1 class="text-3xl font-extrabold text-gray-900 mb-2">Sales Tax Calculator</h1>
<p class="text-gray-600 mb-6">Instantly calculate sales tax and total price, or work backward from a total to find the original price and tax amount. This tool provides quick, accurate calculations for shoppers, business owners, and anyone needing to budget for taxes.</p>

<section id="calculator-ui" class="space-y-6">
<fieldset>
<legend class="block text-sm font-medium text-gray-700 mb-2">Select calculation mode:</legend>
<div class="flex flex-wrap gap-x-6 gap-y-3">
<div class="flex items-center">
<input type="radio" id="modeTotal" name="calcMode" value="total" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500" checked>
<label for="modeTotal" class="ml-2 block text-sm text-gray-900 mb-0">Calculate Total Price</label>
</div>
<div class="flex items-center">
<input type="radio" id="modeReverse" name="calcMode" value="reverse" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500">
<label for="modeReverse" class="ml-2 block text-sm text-gray-900 mb-0">Calculate Original Price</label>
</div>
<div class="flex items-center">
<input type="radio" id="modeRate" name="calcMode" value="rate" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500">
<label for="modeRate" class="ml-2 block text-sm text-gray-900 mb-0">Calculate Tax Rate</label>
</div>
</div>
</fieldset>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div data-mode="total">
<label for="priceBeforeTax">Price before Tax ($) <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="number" id="priceBeforeTax" value="100" min="0" step="0.01"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="priceBeforeTax-error">
<div id="priceBeforeTax-error" class="error-message" role="alert">Please enter a valid price.</div>
</div>
<div data-mode="total">
<label for="taxRate">Sales Tax Rate (%) <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="number" id="taxRate" value="8.5" min="0" step="0.01"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="taxRate-error">
<div id="taxRate-error" class="error-message" role="alert">Please enter a valid tax rate.</div>
</div>

<div data-mode="reverse" style="display: none;">
<label for="totalPrice">Total Price ($) <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="number" id="totalPrice" min="0" step="0.01"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="totalPrice-error">
<div id="totalPrice-error" class="error-message" role="alert">Please enter a valid total price.</div>
</div>
<div data-mode="reverse" style="display: none;">
<label for="taxRateReverse">Sales Tax Rate (%) <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="number" id="taxRateReverse" min="0" step="0.01"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="taxRateReverse-error">
<div id="taxRateReverse-error" class="error-message" role="alert">Please enter a valid tax rate.</div>
</div>

<div data-mode="rate" style="display: none;">
<label for="priceBeforeTaxRate">Price before Tax ($) <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="number" id="priceBeforeTaxRate" min="0" step="0.01"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="priceBeforeTaxRate-error">
<div id="priceBeforeTaxRate-error" class="error-message" role="alert">Please enter a valid price.</div>
</div>
<div data-mode="rate" style="display: none;">
<label for="taxAmount">Sales Tax Amount ($) <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="number" id="taxAmount" min="0" step="0.01"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="taxAmount-error">
<div id="taxAmount-error" class="error-message" role="alert">Please enter a valid tax amount.</div>
</div>
</div>
</section>

<section id="results" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6">
<h3 class="text-xl font-semibold text-gray-900 mb-4">Results</h3>
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
<div class="result-card" id="resultCardPrice">
<h4>Price before Tax</h4>
<p id="resultPriceBeforeTax">$100.00</p>
</div>
<div class="result-card" id="resultCardTax">
<h4>Sales Tax Amount</h4>
<p id="resultTaxAmount">$8.50</p>
</div>
<div class="result-card" id="resultCardTotal">
<h4>Total Price</h4>
<p id="resultTotalPrice">$108.50</p>
</div>
<div class="result-card" id="resultCardRate" style="display: none;">
<h4>Sales Tax Rate</h4>
<p id="resultTaxRate">8.50%</p>
</div>
</div>
</section>
</article>

<article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
<section>
<h2>Data Source and Methodology</h2>
<p>This calculator uses fundamental arithmetic principles for percentage calculations. The formulas are standard mathematical expressions used in financial and retail contexts to determine component values of a total sum.</p>
<p>All calculations are based rigorously on the formulas provided below. No assumptions are made about specific tax jurisdictions, which can have highly complex rules. This tool provides a precise calculation based *only* on the numbers you provide.</p>
</section>

<hr class="my-6 border-gray-200">

<section>
<h2>The Formulas Explained</h2>
<p>The calculations are based on three primary modes:</p>

<h3>1. Calculating Total Price</h3>
<p>To find the sales tax amount and the total price, the calculator uses these formulas:</p>
<div class="formula-box">
<p>$$SalesTax = PriceBeforeTax \times \left( \frac{TaxRate}{100} \right)$$</p>
<p>$$TotalPrice = PriceBeforeTax + SalesTax$$</p>
</div>

<h3>2. Calculating Original Price (Reverse Calculation)</h3>
<p>To find the original price and tax amount from a total price, it uses:</p>
<div class="formula-box">
<p>$$PriceBeforeTax = \frac{TotalPrice}{1 + \left( \frac{TaxRate}{100} \right)}$$</p>
<p>$$SalesTax = TotalPrice - PriceBeforeTax$$</p>
</div>

<h3>3. Calculating the Tax Rate</h3>
<p>To find the tax rate when you know the price and the tax amount:</p>
<div class="formula-box">
<p>$$TaxRate(\%) = \left( \frac{SalesTax}{PriceBeforeTax} \right) \times 100$$</p>
</div>
</section>

<hr class="my-6 border-gray-200">

<section>
<h2>Glossary of Variables</h2>
<ul class="space-y-2">
<li><strong>Price before Tax ($):</strong> The net price of an item or service before any sales tax is applied. This is also known as the "sticker price" or "subtotal".</li>
<li><strong>Sales Tax Rate (%):</strong> The percentage of the pre-tax price that is collected as tax. This rate is set by a government body (state, county, or city).</li>
<li><strong>Sales Tax Amount ($):</strong> The specific dollar amount of tax calculated by applying the tax rate to the pre-tax price.</li>
<li><strong>Total Price ($):</strong> The final cost to the customer, which is the sum of the Price before Tax and the Sales Tax Amount.</li>
</ul>
</section>

<hr class="my-6 border-gray-200">

<section>
<h2>How it Works: A Step-by-Step Example</h2>
<p>Let's walk through a common scenario. You want to buy a laptop that costs <strong>$1,200</strong>, and your local sales tax rate is <strong>7.25%</strong>.</p>
<ol>
<li><strong>Select Mode:</strong> You would use the default "Calculate Total Price" mode.</li>
<li><strong>Enter Inputs:</strong>
<ul>
<li><strong>Price before Tax:</strong> $1,200</li>
<li><strong>Sales Tax Rate:</strong> 7.25</li>
</ul>
</li>
<li><strong>Step 1: Calculate Tax Amount</strong>
<p>The calculator first converts the percentage to a decimal: $7.25\% = 0.0725$.</p>
<p>$SalesTax = \$1,200 \times 0.0725 = \$87.00$</p>
</li>
<li><strong>Step 2: Calculate Total Price</strong>
<p>It then adds the tax amount to the original price.</p>
<p>$TotalPrice = \$1,200 + \$87.00 = \$1,287.00$</p>
</li>
<li><strong>Result:</strong> The calculator shows a sales tax of <strong>$87.00</strong> and a total price of <strong>$1,287.00</strong>.</li>
</ol>
</section>

<hr class="my-6 border-gray-200">

<section>
<h2>Frequently Asked Questions (FAQ)</h2>
<details>
<summary>What is sales tax?</summary>
<p>Sales tax is a consumption tax imposed by a government on the sale of goods and services. It is collected by the seller at the point of sale and then paid to the government. This calculator helps determine that tax amount.</p>
</details>
<details>
<summary>How do I use the reverse sales tax calculation?</summary>
<p>Select the "Calculate Original Price" mode. This is useful if you only have a final receipt and want to know the pre-tax price and tax amount. For example, if your receipt total is $53.50 and you know the tax rate was 7%, the calculator will show you the original price was $50.00 and the tax was $3.50.</p>
</details>
<details>
<summary>Does this calculator work for my state, city, or country?</summary>
<p>This calculator performs a standard percentage calculation. It works perfectly if you know your <strong>total, combined sales tax rate</strong>. In the United States, tax rates are very complex and can be a combination of state, county, and city taxes. Always check with your local government's department of revenue for the exact, official rate for your specific location ("tax jurisdiction").</p>
</details>
<details>
<summary>What is the difference between sales tax and VAT?</summary>
<p>Sales tax is typically added at the final point of sale to the consumer. Value-Added Tax (VAT) is collected at *every* stage of the supply chain (from production to sale). While both are consumption taxes, their collection methods are different. This calculator is designed for the sales tax model.</p>
</details>
<details>
<summary>Is sales tax applied to all goods and services?</summary>
<p>No. Tax laws vary significantly. Many jurisdictions exempt essential items like groceries, prescription drugs, and some types of clothing. Services (like legal advice or landscaping) may or may not be taxed depending on local laws. This calculator assumes the price you enter is for a "taxable" item or service.</p>
</details>
<details>
<summary>Can I use this to calculate tax on a car purchase?</summary>
<p>Yes, you can use it for a basic estimate. However, vehicle sales tax can be more complex, sometimes involving trade-in values, "use tax" instead of sales tax, or different rates. Use this tool for an estimate, but confirm the final amount with your dealership or Department of Motor Vehicles (DMV).</p>
</details>
</section>

<hr class="my-6 border-gray-200">

<section class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600">
<p><strong>Tool developed by Ugo Candido.</strong> Contents verified by the CalcDomain Editorial Board.</p>
<p>Last accuracy review: <time datetime="2025-10-26">October 26, 2025</time></p>
</section>
</article>

</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300x600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why use this calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Instantly find total price, tax, or pre-tax cost.</li>
<li>Reverse-calculate to see the original price from a receipt.</li>
<li>Check the exact tax rate you were charged.</li>
<li>Mobile-first design for quick checks while shopping.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Finance Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="https://calcdomain.com/tip-calculator.html" class="text-blue-600 hover:underline">Tip Calculator</a></li>
<li><a href="https://calcdomain.com/discount-calculator.html" class="text-blue-600 hover:underline">Discount Calculator</a></li>
<li><a href="https://calcdomain.com/vat-calculator.html" class="text-blue-600 hover:underline">VAT Calculator</a></li>
<li><a href="https://calcdomain.com/income-tax-calculator.html" class="text-blue-600 hover:underline">Income Tax Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-white border-t mt-10">
<div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
<p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
<div class="mt-4 space-x-4">
<a href="https://calcdomain.com/about.html" class="hover:text-blue-600">About</a>
<a href="https://calcdomain.com/contact.html" class="hover:text-blue-600">Contact</a>
<a href="https://calcdomain.com/privacy.html" class="hover:text-blue-600">Privacy</a>
<a href="https://calcdomain.com/terms.html" class="hover:text-blue-600">Terms</a>
</div>
</div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
// --- 1. Element Selectors ---
const elements = {
// Mode switching
modeRadios: document.querySelectorAll('input[name="calcMode"]'),
// Input fields
priceBeforeTax: document.getElementById('priceBeforeTax'),
taxRate: document.getElementById('taxRate'),
totalPrice: document.getElementById('totalPrice'),
taxRateReverse: document.getElementById('taxRateReverse'),
priceBeforeTaxRate: document.getElementById('priceBeforeTaxRate'),
taxAmount: document.getElementById('taxAmount'),
// Input containers (for show/hide)
inputGroups: document.querySelectorAll('[data-mode]'),
// Result display
resultPriceBeforeTax: document.getElementById('resultPriceBeforeTax'),
resultTaxAmount: document.getElementById('resultTaxAmount'),
resultTotalPrice: document.getElementById('resultTotalPrice'),
resultTaxRate: document.getElementById('resultTaxRate'),
// Result cards (for show/hide)
resultCardPrice: document.getElementById('resultCardPrice'),
resultCardTax: document.getElementById('resultCardTax'),
resultCardTotal: document.getElementById('resultCardTotal'),
resultCardRate: document.getElementById('resultCardRate'),
};

// All inputs that can trigger calculation
const allInputs = [
elements.priceBeforeTax, elements.taxRate,
elements.totalPrice, elements.taxRateReverse,
elements.priceBeforeTaxRate, elements.taxAmount
];

let currentMode = 'total'; // Default mode

// --- 2. Formatters ---
const fmtCurrency = (val) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(val || 0);
const fmtPercent = (val) => new Intl.NumberFormat('en-US', { style: 'decimal', minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(val || 0) + '%';

// --- 3. UI State Management ---

/**
* Toggles visibility of input groups and result cards based on the selected mode.
*/
function updateUIVisibility() {
// Hide all input groups
elements.inputGroups.forEach(group => {
group.style.display = 'none';
});
// Show input groups for the current mode
document.querySelectorAll(`[data-mode="${currentMode}"]`).forEach(group => {
group.style.display = 'block';
});

// Reset result card visibility
elements.resultCardPrice.style.display = 'block';
elements.resultCardTax.style.display = 'block';
elements.resultCardTotal.style.display = 'block';
elements.resultCardRate.style.display = 'none';

if (currentMode === 'rate') {
elements.resultCardRate.style.display = 'block';
}

// Clear all inputs and errors when mode changes
allInputs.forEach(input => {
if (!input.closest(`[data-mode="${currentMode}"]`)) {
input.value = '';
}
validateInput(input, false); // Clear errors
});
calculate();
}

/**
* Handles the change event for mode radio buttons.
*/
function handleModeChange(event) {
currentMode = event.target.value;
updateUIVisibility();
}

// --- 4. Validation ---

/**
* Validates a single input field.
* @param {HTMLInputElement} inputEl - The input element to validate.
* @param {boolean} [showError=true] - Whether to show or clear the error message.
* @returns {boolean} - True if valid, false if invalid.
*/
function validateInput(inputEl, showError = true) {
const errorEl = document.getElementById(`${inputEl.id}-error`);
if (!errorEl) return true; // No error element to worry about

const value = parseFloat(inputEl.value);
let isValid = true;

// Check if required and empty, or negative
if (inputEl.hasAttribute('aria-required') && (inputEl.value === '' || value < 0)) {
isValid = false;
}
// Special check for rate calculation (price can't be zero)
if (inputEl.id === 'priceBeforeTaxRate' && value === 0) {
isValid = false;
errorEl.textContent = 'Price cannot be zero for rate calculation.';
} else {
errorEl.textContent = 'Please enter a valid, positive number.';
}

if (isValid || !showError) {
inputEl.setAttribute('aria-invalid', 'false');
errorEl.style.display = 'none';
inputEl.removeAttribute('aria-describedby');
} else {
inputEl.setAttribute('aria-invalid', 'true');
errorEl.style.display = 'block';
inputEl.setAttribute('aria-describedby', errorEl.id);
}
return isValid;
}

// --- 5. Calculation Logic ---

/**
* Main calculation function. Reads inputs based on mode, validates,
* computes results, and calls the UI update.
*/
function calculate() {
let isValid = true;
const results = { price: 0, tax: 0, total: 0, rate: 0 };

if (currentMode === 'total') {
const price = parseFloat(elements.priceBeforeTax.value);
const rate = parseFloat(elements.taxRate.value);
isValid = validateInput(elements.priceBeforeTax) & validateInput(elements.taxRate);

if (isValid) {
results.price = price;
results.rate = rate;
results.tax = price * (rate / 100);
results.total = price + results.tax;
}
} else if (currentMode === 'reverse') {
const total = parseFloat(elements.totalPrice.value);
const rate = parseFloat(elements.taxRateReverse.value);
isValid = validateInput(elements.totalPrice) & validateInput(elements.taxRateReverse);

if (isValid) {
results.total = total;
results.rate = rate;
results.price = total / (1 + (rate / 100));
results.tax = total - results.price;
}
} else if (currentMode === 'rate') {
const price = parseFloat(elements.priceBeforeTaxRate.value);
const tax = parseFloat(elements.taxAmount.value);
isValid = validateInput(elements.priceBeforeTaxRate) & validateInput(elements.taxAmount);

if (isValid && price > 0) {
results.price = price;
results.tax = tax;
results.rate = (tax / price) * 100;
results.total = price + tax;
} else if (price === 0) {
isValid = false; // Prevent division by zero
}
}

updateResultsUI(results, isValid);
}

/**
* Updates the result card <p> tags with formatted values.
* @param {object} results - The calculated results object.
* @param {boolean} isValid - Whether the inputs were valid.
*/
function updateResultsUI(results, isValid) {
if (!isValid) {
elements.resultPriceBeforeTax.textContent = '...';
elements.resultTaxAmount.textContent = '...';
elements.resultTotalPrice.textContent = '...';
elements.resultTaxRate.textContent = '...';
return;
}
elements.resultPriceBeforeTax.textContent = fmtCurrency(results.price);
elements.resultTaxAmount.textContent = fmtCurrency(results.tax);
elements.resultTotalPrice.textContent = fmtCurrency(results.total);
elements.resultTaxRate.textContent = fmtPercent(results.rate);
}

// --- 6. Event Listeners ---
elements.modeRadios.forEach(radio => {
radio.addEventListener('change', handleModeChange);
});

allInputs.forEach(input => {
// Calculate on every input
input.addEventListener('input', calculate);
// Validate on blur (when user leaves field)
input.addEventListener('blur', () => validateInput(input));
});

// --- 7. Initial Load ---
updateUIVisibility(); // Set initial UI state
calculate(); // Run initial calculation
});
</script>

</body>
</html>
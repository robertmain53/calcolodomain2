<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Week Number Calculator - Find Week of the Year (ISO &amp; US)</title>
<meta name="description" content="Instantly find the week number for any date. This calculator uses ISO 8601, US, and other standards to give you accurate week numbers, start/end dates, and explanations.">
<link rel="canonical" href="https://calcdomain.com/week-number-calculator.html"https://calcdomain.com/>
<meta name="author" content="Ugo Candido">

<link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg" />
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png" />
<link rel="manifest" href="https://calcdomain.com/site.webmanifest" />

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script> <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
/* Formula box for LaTeX/rules */
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1.5rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
font-size: 1.1rem;
line-height: 1.7;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
/* Result card styling */
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; text-transform: uppercase; letter-spacing: 0.05em; }
.result-card p { font-size: 2.5rem; font-weight: 700; color: #2563eb; line-height: 1.2; }
/* Custom focus state for WCAG compliance */
button:focus-visible, input:focus-visible, select:focus-visible, [tabindex="0"]:focus-visible {
outline: 3px solid #2563eb;
outline-offset: 2px;
box-shadow: none;
}
/* Accessible tooltip */
.tooltip-container { position: relative; display: inline-flex; align-items: center; }
.tooltip-btn {
border: none; background: #e5e7eb; color: #4b5563;
border-radius: 9999px; width: 1.25rem; height: 1.25rem;
font-size: 0.875rem; font-weight: 700; line-height: 1;
cursor: help; margin-left: 0.5rem; padding: 0;
display: inline-flex; align-items: center; justify-content: center;
}
.tooltip-text {
visibility: hidden; position: absolute;
background-color: #111827; color: #fff;
text-align: left; border-radius: 6px; padding: 0.75rem;
z-index: 10; bottom: 125%; left: 50%;
transform: translateX(-50%);
width: 280px; font-weight: 400; font-size: 0.875rem;
opacity: 0; transition: opacity 0.2s;
}
.tooltip-btn[aria-expanded="true"] + .tooltip-text {
visibility: visible; opacity: 1;
}
/* Print styles */
@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
.no-print { display: none !important; }
}
</style>

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "WebPage",
"name": "Week Number Calculator",
"description": "Instantly find the week number for any date. This calculator uses ISO 8601, US, and other standards to give you accurate week numbers, start/end dates, and explanations.",
"url": "https://calcdomain.com/week-number-calculator.html",
"inLanguage": "en",
"author": { "@type": "Person", "name": "Ugo Candido" },
"publisher": { "@type": "Organization", "name": "CalcDomain" }
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "BreadcrumbList",
"itemListElement": [
{ "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/" },
{ "@type": "ListItem", "position": 2, "name": "Lifestyle Everyday", "item": "https://calcdomain.com/lifestyle.html" },
{ "@type": "ListItem", "position": 3, "name": "Miscellaneous", "item": "https://calcdomain.com/subcategories/lifestyle-misc.html" },
{ "@type": "ListItem", "position": 4, "name": "Week Number Calculator", "item": "https://calcdomain.com/week-number-calculator.html" }
]
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "HowTo",
"name": "How to Find the Week Number for a Date",
"description": "A step-by-step guide to calculating the week number using different standards.",
"step": [
{"@type": "HowToStep", "name": "Step 1: Select Your Date", "text": "Use the date picker to choose the specific date you want to check."},
{"@type": "HowToStep", "name": "Step 2: Choose Your Standard", "text": "Select the week numbering system you need: ISO 8601 (starts Monday, default), US (starts Sunday), or Middle East (starts Saturday)."},
{"@type": "HowToStep", "name": "Step 3: Review Results", "text": "The calculator will instantly display the week number, as well as the start and end dates for that specific week."}
]
}
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script src="search.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">
<div class="flex justify-between items-center">
<a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

<div class="w-full max-w-md hidden md:block mx-8">
<div class="relative">
<input type="search" id="search-input" placeholder="Search for a calculator..."
class="w-full py-2 px-4 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
autocomplete="off">
<svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
</svg>
<div id="search-results" class="absolute top-full left-0 right-0 hidden bg-white border border-gray-200 rounded-lg shadow-lg mt-2 max-h-96 overflow-y-auto z-50"></div>
</div>
</div>

<div class="hidden md:flex items-center space-x-6 text-sm">
<a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
</div>

<button id="mobile-menu-toggle" class="md:hidden p-2 no-print" aria-label="Open menu" aria-expanded="false">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M4 6h16M4 12h16M4 18h16"></path>
</svg>
</button>
</div>

<div id="mobile-menu" class="md:hidden mt-4 hidden no-print">
<div class="space-y-2">
<a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
</div>
</div>
</nav>
</header>

<main class="container mx-auto px-4 lg:px-6 py-10">
<div class="flex flex-col lg:flex-row gap-8">

<section class="w-full lg:w-2/3">
<nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
<a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
<a href="lifestyle.html" class="hover:text-blue-600">Lifestyle Everyday</a> &raquo;
<a href="subcategories/lifestyle-misc.html" class="hover:text-blue-600">Miscellaneous</a> &raquo;
<span class="text-gray-900">Week Number Calculator</span>
</nav>

<div id="print-section" class="bg-white p-6 rounded-lg shadow-md">

<h1 class="text-3xl font-extrabold text-gray-900 mb-2">Week Number Calculator</h1>
<p class="text-gray-600 mb-6">Quickly determine the week number for any given date. This tool helps you find the week number based on international (ISO 8601), US, or Middle Eastern standards, and shows you the start and end date of that week.</p>

<section id="calculator-ui" class="space-y-6 border-b border-gray-200 pb-8">
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div>
<label for="targetDate" class="block text-sm font-medium text-gray-700">
Select Date <span class"text-red-600" aria-hidden="true">*</span>
</label>
<input type="date" id="targetDate" aria-required="true" aria-describedby="date-error"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
<p id="date-error" class="text-red-600 text-sm mt-1" aria-live="polite" hidden></p>
</div>

<div>
<div class="flex items-center">
<label for="weekStandard" class="block text-sm font-medium text-gray-700">
Week Numbering Standard
</label>
<div class="tooltip-container">
<button type="button" class="tooltip-btn no-print" id="tooltip-btn" aria-expanded="false" aria-controls="standard-tooltip">?</button>
<span id="standard-tooltip" role="tooltip" class="tooltip-text">
<strong>ISO 8601:</strong> International standard. Weeks start Monday. Week 1 is the first week with at least 4 days in the new year.<br><br>
<strong>US Standard:</strong> Weeks start Sunday. Week 1 is the week that contains January 1st.
</span>
</div>
</div>
<select id="weekStandard"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
<option value="iso" selected>ISO 8601 (Weeks start Monday)</option>
<option value="us">US (Weeks start Sunday)</option>
<option value="me">Middle East (Weeks start Saturday)</option>
</select>
</div>
</div>

<div class="flex flex-col sm:flex-row gap-4 no-print">
<button id="calculateBtn"
class="w-full sm:w-auto px-6 py-3 bg-blue-600 text-white font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
Calculate
</button>
<button id="resetBtn"
class="w-full sm:w-auto px-6 py-3 bg-gray-200 text-gray-800 font-medium rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2">
Reset to Today
</button>
</div>
</section>

<section id="results" class="mt-8" aria-live="polite" style="min-height: 180px;">
<div class="bg-blue-50 border border-blue-100 rounded-lg p-6">
<p id="result-context" class="text-center text-gray-700 font-medium mb-4 text-lg">—</p>
<div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
<div class="result-card">
<h4>Week Number</h4>
<p id="weekNumResult">—</p>
</div>
<div class="result-card">
<h4>Week Starts On</h4>
<p id="weekStartResult" class="text-xl">—</p>
</div>
<div class="result-card">
<h4>Week Ends On</h4>
<p id="weekEndResult" class="text-xl">—</p>
</div>
</div>
</div>
</section>
</div><article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
<h2>Authoritative Source &amp; Methodology</h2>
<p>This calculator provides week numbers based on established international and regional standards. The primary source for this methodology is:</p>
<ul>
<li><strong>Source:</strong> ISO 8601:2004 (and subsequent revisions)</li>
<li><strong>Reference:</strong> "Data elements and interchange formats – Information interchange – Representation of dates and times"</li>
<li><strong>Link:</strong> <a href="https://www.iso.org/iso-8601-date-and-time-format.html" target="_blank" rel="noopener">iso.org</a></li>
</ul>
<p>All calculations are based strictly on the rules defined by these standards. We use UTC-based date logic to ensure calculations are consistent and independent of your local time zone.</p>

<hr class="my-6">

<h2>The "Formula" Explained</h2>
<p>Unlike a simple algebraic equation, week numbering is based on a set of rules. The most common formula, used for the **ISO 8601** standard, can be expressed mathematically. This formula finds the week number for a given date's ordinal day number ($N$) and its ISO weekday ($W$, where Monday=1, Sunday=7).</p>
<div class="formula-box" aria-label="ISO 8601 Week Number Formula">
$$
\text{WeekNumber} = \left\lfloor \frac{10 + (N - W)}{7} \right\rfloor
$$
<p class="text-sm mt-4 text-gray-700">Where:
<br> $N$ = The ordinal day of the year (e.g., Jan 1st is 1, Feb 1st is 32).
<br> $W$ = The ISO-8601 weekday number (1 for Monday, 7 for Sunday).
</p>
</div>
<p class="mt-4">However, a rule-based explanation is often clearer:</p>
<ul>
<li><strong>ISO 8601 Standard:</strong> Weeks start on **Monday**. Week 1 of any year is the one that contains the **first Thursday** of that year. This also means it's the first week with 4 or more days in the new year.</li>
<li><strong>US Standard:</strong> Weeks start on **Sunday**. Week 1 is the week that contains **January 1st**.</li>
<li><strong>Middle Eastern Standard:</strong> Weeks start on **Saturday**. Week 1 is the week that contains **January 1st**.</li>
</ul>

<hr class="my-6">

<h2>Glossary of Variables</h2>
<dl class="space-y-4">
<div>
<dt class="font-semibold">Selected Date</dt>
<dd class="pl-4 text-gray-700">The specific date (day, month, year) for which you want to find the week number.</dd>
</div>
<div>
<dt class="font-semibold">Week Numbering Standard</dt>
<dd class="pl-4 text-gray-700">The set of rules used for the calculation. This calculator supports the three most common systems.</dd>
</div>
<div>
<dt class="font-semibold">Week Number</dt>
<dd class="pl-4 text-gray-700">The sequential number (1-53) of the week within its year, as defined by the selected standard.</dd>
</div>
<div>
<dt class="font-semibold">Week Starts On / Ends On</dt>
<dd class="pl-4 text-gray-700">The first and last day of the calculated week. This changes depending on the standard (Saturday, Sunday, or Monday).</dd>
</div>
</dl>

<hr class="my-6">

<h2>How It Works: A Step-by-Step Example</h2>
<p>Let's see why the same date can have two different week numbers. A perfect example is **January 1, 2023**.</p>
<p><strong>Case 1: Using the US Standard (Weeks start Sunday)</strong></p>
<ol>
<li><strong>Input Date:</strong> January 1, 2023 (which was a Sunday).</li>
<li><strong>Rule:</strong> The US standard states that weeks start on Sunday, and Week 1 is the week containing Jan 1st.</li>
<li><strong>Analysis:</strong> Since Jan 1, 2023, *was* a Sunday, it became the first day of Week 1 for 2023.</li>
<li><strong>Result: Week 1</strong> (running from Sunday, Jan 1 to Saturday, Jan 7).</li>
</ol>
<p><strong>Case 2: Using the ISO 8601 Standard (Weeks start Monday)</strong></p>
<ol>
<li><strong>Input Date:</strong> January 1, 2023 (a Sunday).</li>
<li><strong>Rule:</strong> The ISO standard states that Week 1 is the week containing the *first Thursday* of the year. Weeks start on Monday.</li>
<li><strong>Analysis:</strong> The first Thursday of 2023 was January 5th. The week containing this Thursday *started* on Monday, January 2nd. Therefore, the date January 1st (the Sunday before) belongs to the *previous* week.</li>
<li><strong>Result: Week 52</strong> (of the year 2022, running from Monday, Dec 26, 2022 to Sunday, Jan 1, 2023).</li>
</ol>
<p>This calculator handles these complex edge cases for you.</p>

<hr class="my-6">

<h2>Frequently Asked Questions (FAQ)</h2>
<details>
<summary>What is the current week number?</summary>
<p>To find the current week number, simply load this page or click the "Reset to Today" button. The calculator automatically defaults to today's date and shows the current week number based on the ISO 8601 standard.</p>
</details>
<details>
<summary>Why are there sometimes 53 weeks in a year?</summary>
<p>A year has 365 days, and $365 / 7 = 52.14$. This extra 0.14 days (or 0.14 + 1 for a leap year) adds up. An ISO year has 53 weeks if January 1st is a Thursday, or if it's a Wednesday in a leap year. In the US system, any year that starts on a Saturday has 53 weeks.</p>
</details>
<details>
<summary>What is the ISO 8601 week numbering standard?</summary>
<p>It's the international standard for date and time representation. It's widely used in business, logistics, and government to avoid ambiguity. Its key rules are: weeks start on Monday, and Week 1 is the week containing the year's first Thursday.</p>
</details>
<details>
<summary>How is the US week number different from the ISO standard?</summary>
<p>There are two major differences:
<br>1. <strong>Start of Week:</strong> US weeks start on Sunday, while ISO weeks start on Monday.
<br>2. <strong>Week 1 Rule:</strong> The US Week 1 is simply the week containing January 1st. The ISO Week 1 is the week with the year's first Thursday. This can cause the week numbers to be different by 1 around the new year.</p>
</details>
<details>
<summary>Can a year start in Week 52 or 53?</summary>
<p>Yes. In the ISO 8601 system, if January 1st falls on a Friday, Saturday, or Sunday, those days are considered part of the last week (52 or 53) of the *previous* year. The calculator shows this automatically, as in the example of Jan 1, 2023.</p>
</details>
<details>
<summary>Which standard should I use?</summary>
<p>If you are in North America, you might be used to the US standard (Sunday start). For international business, planning, or any technical application, **ISO 8601 is strongly recommended** as it is unambiguous and globally recognized.</p>
</details>
<details>
<summary>Does this calculator handle leap years?</summary>
<p>Yes. The calculations are based on the actual calendar date, so leap years (like 2024 or 2028) and their extra day (February 29th) are automatically factored in correctly.</p>
</details>

<div class="mt-8 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600">
<p><strong>Tool developed by Ugo Candido.</strong> Contents verified by the CalcDomain Editorial Board.
<br>
Last accuracy review: <time datetime="2025-10-27">October 27, 2025</time>.</p>
</div>
</article>
</section>

<aside class="w-full lg:w-1/3 no-print">
<div class="sticky top-24 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300×600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why use this calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Get instant, accurate week numbers.</li>
<li>Compare results from <strong>3 different standards</strong> (ISO, US, Middle East).</li>
<li>See the exact <strong>start and end date</strong> of any week.</li>
<li>Based on authoritative ISO 8601 standards.</li>
<li>Fully accessible (WCAG 2.1) and mobile-friendly.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Date &amp; Time Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="date-calculator.html" class="text-blue-600 hover:underline">Date Calculator (Add/Subtract Days)</a></li>
<li><a href="days-between-dates.html" class="text-blue-600 hover:underline">Days Between Dates Calculator</a></li>
<li><a href="age.html" class="text-blue-600 hover:underline">Age Calculator</a></li>
<li><a href="timestamp-converter.html" class="text-blue-600 hover:underline">Epoch Timestamp Converter</a></li>
<li><a href="time-calculator.html" class="text-blue-600 hover:underline">Time Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-white border-t mt-12 no-print">
<div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
<p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
<div class="mt-4 space-x-4">
<a href="about.html" class="hover:text-blue-600">About</a>
<a href="contact.html" class="hover:text-blue-600">Contact</a>
<a href="privacy.html" class="hover:text-blue-600">Privacy</a>
<a href="terms.html" class="hover:text-blue-600">Terms</a>
</div>
</div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
// --- Get DOM Elements ---
const el = {
targetDate: document.getElementById('targetDate'),
weekStandard: document.getElementById('weekStandard'),
calculateBtn: document.getElementById('calculateBtn'),
resetBtn: document.getElementById('resetBtn'),
dateError: document.getElementById('date-error'),
resultContext: document.getElementById('result-context'),
weekNumResult: document.getElementById('weekNumResult'),
weekStartResult: document.getElementById('weekStartResult'),
weekEndResult: document.getElementById('weekEndResult'),
tooltipBtn: document.getElementById('tooltip-btn'),
tooltipText: document.getElementById('standard-tooltip'),
mobileMenuToggle: document.getElementById('mobile-menu-toggle'),
mobileMenu: document.getElementById('mobile-menu')
};

// --- Utility Functions ---

/**
* Formats a Date object to a string like "Oct 27, 2025"
* @param {Date} date - The date to format.
* @returns {string} The formatted date string.
*/
const formatDate = (date) => {
return date.toLocaleDateString('en-US', {
year: 'numeric',
month: 'short',
day: 'numeric',
timeZone: 'UTC' // Use UTC to match calculation logic
});
};

/**
* Formats a Date object to "YYYY-MM-DD" for the input field.
* @param {Date} date - The date to format.
* @returns {string} The date string in YYYY-MM-DD format.
*/
const toISODateString = (date) => {
return date.toISOString().split('T')[0];
};

/**
* Validates the date input.
* @returns {Date|null} A valid Date object or null if invalid.
*/
const validateInput = () => {
const dateStr = el.targetDate.value;
if (!dateStr) {
el.dateError.textContent = 'Please select a date.';
el.dateError.hidden = false;
el.targetDate.setAttribute('aria-invalid', 'true');
return null;
}

const date = new Date(dateStr + 'T12:00:00Z'); // Use 12:00 UTC to avoid DST/timezone issues
if (isNaN(date.getTime())) {
el.dateError.textContent = 'Invalid date format.';
el.dateError.hidden = false;
el.targetDate.setAttribute('aria-invalid', 'true');
return null;
}

// Clear error
el.dateError.textContent = '';
el.dateError.hidden = true;
el.targetDate.removeAttribute('aria-invalid');
return date;
};

// --- Core Calculation Logic ---

/**
* Gets week number and start/end dates for a given date and standard.
* @param {Date} date - The target date object (assumed 12:00 UTC).
* @param {string} standard - 'iso', 'us', or 'me'.
* @returns {object} { weekNumber, start, end, year }
*/
const getWeekInfo = (date, standard) => {
if (standard === 'iso') {
return getISOWeekInfo(date);
} else {
const startDay = (standard === 'us') ? 0 : 6; // 0=Sunday (US), 6=Saturday (ME)
return getSimpleWeekInfo(date, startDay);
}
};

/**
* ISO 8601 Week Calculation (Weeks start Monday)
* Rule: Week 1 is the week with the year's first Thursday.
*/
const getISOWeekInfo = (date) => {
const target = new Date(date.valueOf());
const dayNr = (date.getUTCDay() + 6) % 7; // 0=Monday, 6=Sunday

// Get Monday of the target week
const weekStart = new Date(target.valueOf());
weekStart.setUTCDate(target.getUTCDate() - dayNr);

// Get Sunday of the target week
const weekEnd = new Date(weekStart.valueOf());
weekEnd.setUTCDate(weekStart.getUTCDate() + 6);

// Find the Thursday of this week to determine the "week year"
const thursday = new Date(weekStart.valueOf());
thursday.setUTCDate(weekStart.getUTCDate() + 3);
const year = thursday.getUTCFullYear();

// Get the first Thursday of that year
const firstThursday = new Date(Date.UTC(year, 0, 4));
firstThursday.setUTCDate(firstThursday.getUTCDate() - (firstThursday.getUTCDay() + 6) % 7 + 3);

// Calculate week number
const dayDiff = (thursday - firstThursday) / 86400000; // milliseconds to days
const weekNumber = 1 + Math.round(dayDiff / 7);

return { weekNumber, start: weekStart, end: weekEnd, year };
};

/**
* US / Middle East Week Calculation (Weeks start Sun or Sat)
* Rule: Week 1 is the week containing January 1st.
*/
const getSimpleWeekInfo = (date, startDay) => {
const target = new Date(date.valueOf());
const dayNr = (date.getUTCDay() - startDay + 7) % 7; // 0=startDay
const year = target.getUTCFullYear();

// Get the start of the target week
const weekStart = new Date(target.valueOf());
weekStart.setUTCDate(target.getUTCDate() - dayNr);

// Get the end of the target week
const weekEnd = new Date(weekStart.valueOf());
weekEnd.setUTCDate(weekStart.getUTCDate() + 6);

// Find the start of Week 1 for this year
const firstDayOfYear = new Date(Date.UTC(year, 0, 1));
const firstDayOfYearDay = (firstDayOfYear.getUTCDay() - startDay + 7) % 7;
const firstWeekStart = new Date(firstDayOfYear.valueOf());
firstWeekStart.setUTCDate(firstDayOfYear.getUTCDate() - firstDayOfYearDay);

// Calculate day difference and thus week number
const dayDiff = (weekStart - firstWeekStart) / 86400000;
const weekNumber = 1 + Math.round(dayDiff / 7); // Use round to handle potential DST micro-differences

return { weekNumber, start: weekStart, end: weekEnd, year };
};

// --- Main Functions ---

/**
* Runs the calculation and updates the DOM.
*/
const runCalculation = () => {
const date = validateInput();
if (!date) {
// Clear results if input is invalid
el.resultContext.textContent = '—';
el.weekNumResult.textContent = '—';
el.weekStartResult.textContent = '—';
el.weekEndResult.textContent = '—';
return;
}

const standard = el.weekStandard.value;
const weekInfo = getWeekInfo(date, standard);

// Update Results
el.resultContext.textContent = `For the date: ${formatDate(date)}`;
el.weekNumResult.textContent = weekInfo.weekNumber;
el.weekStartResult.textContent = formatDate(weekInfo.start);
el.weekEndResult.textContent = formatDate(weekInfo.end);
};

/**
* Resets the calculator to today's date and recalculates.
*/
const resetToToday = () => {
const today = new Date(); // Use local time to get today's date
const todayUTC = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate(), 12));
el.targetDate.value = toISODateString(todayUTC);
el.weekStandard.value = 'iso';
runCalculation();
};

// --- Event Listeners ---

el.calculateBtn.addEventListener('click', runCalculation);
el.resetBtn.addEventListener('click', resetToToday);

// Recalculate on input change for instant feedback
el.targetDate.addEventListener('input', runCalculation);
el.weekStandard.addEventListener('input', runCalculation);

// Accessible Tooltip Toggle
el.tooltipBtn.addEventListener('click', () => {
const isExpanded = el.tooltipBtn.getAttribute('aria-expanded') === 'true';
el.tooltipBtn.setAttribute('aria-expanded', !isExpanded);
if (isExpanded) {
el.tooltipText.style.visibility = 'hidden';
el.tooltipText.style.opacity = 0;
} else {
el.tooltipText.style.visibility = 'visible';
el.tooltipText.style.opacity = 1;
}
});
// Hide tooltip on blur
el.tooltipBtn.addEventListener('blur', () => {
el.tooltipBtn.setAttribute('aria-expanded', 'false');
el.tooltipText.style.visibility = 'hidden';
el.tooltipText.style.opacity = 0;
});

// Mobile Menu Toggle (from template)
el.mobileMenuToggle.addEventListener('click', () => {
const isExpanded = el.mobileMenuToggle.getAttribute('aria-expanded') === 'true';
el.mobileMenuToggle.setAttribute('aria-expanded', !isExpanded);
el.mobileMenu.classList.toggle('hidden');
});

// --- Initial Load ---
resetToToday(); // Load with today's date and week number
});
</script>

</body>
</html>
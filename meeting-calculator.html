<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meeting Calculator — Estimate True Meeting Cost & ROI Signals</title>
  <meta name="description" content="Calculate the real cost of a meeting including attendees, hourly rates, prep/travel time, overhead and recurrence. Get cost per minute, per attendee, annualized cost, and a clear pie chart breakdown." />
  <link rel="canonical" href="https://calcdomain.com/meeting-calculator.html">
  <link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg" />
  <link rel="shortcut icon" href="https://calcdomain.com/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png" />
  <link rel="manifest" href="https://calcdomain.com/site.webmanifest" />

  <!-- Fonts & UI -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- MathJax for LaTeX formulas -->
  <script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root { --focus-ring: 3px solid #2563eb; }
    body { font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"; }
    .prose { max-width: 70ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: 0.75rem; }
    .prose h3 { font-size: 1.125rem; font-weight: 600; margin-top: 1.25rem; margin-bottom: 0.5rem; }
    .prose p { margin-bottom: 0.9rem; line-height: 1.7; }
    .prose ul, .prose ol { margin-left: 1.25rem; margin-bottom: 0.9rem; }
    .formula-box { background:#f3f4f6; border:1px solid #d1d5db; border-radius:10px; padding:1rem; overflow-x:auto; }
    .result-card { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:1rem; text-align:center; }
    .result-card h4 { font-size:0.95rem; color:#6b7280; margin-bottom:0.25rem; }
    .result-card p { font-size:1.65rem; font-weight:800; color:#0f172a; }
    .minh-results { min-height: 320px; } /* Prevent CLS in results */
    /* Focus visible */
    a:focus-visible, button:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible, summary:focus-visible {
      outline: none; box-shadow: 0 0 0 var(--focus-ring);
    }
    /* Touch target comfort */
    button, .btn-like { min-height: 48px; min-width: 48px; }
    label .req { color:#ef4444; font-weight:700; }
    /* Validation messages */
    .field-error { color:#b91c1c; font-size:0.875rem; margin-top:0.375rem; }
    /* Print */
    @media print {
      body * { visibility: hidden; }
      #print-section, #print-section * { visibility: visible; }
      #print-section { position: absolute; left: 0; top: 0; width: 100%; }
      #sidebar, #chart-annual { display:none !important; }
    }
  </style>

  <!-- JSON-LD: WebPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Meeting Calculator",
    "description": "Estimate the true cost of any meeting: attendees, hourly rates, prep & travel time, overhead and recurrence. Get total cost, per-minute and per-attendee metrics with a role breakdown.",
    "url": "https://calcdomain.com/meeting-calculator.html",
    "inLanguage": "en",
    "breadcrumb": {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
        {"@type":"ListItem","position":2,"name":"Everyday Life","item":"https://calcdomain.com/lifestyle-everyday.html"},
        {"@type":"ListItem","position":3,"name":"Time and Date","item":"https://calcdomain.com/subcategories/time-date.html"},
        {"@type":"ListItem","position":4,"name":"Meeting Calculator","item":"https://calcdomain.com/meeting-calculator.html"}
      ]
    },
    "author": {"@type":"Person","name":"Ugo Candido"},
    "publisher": {"@type":"Organization","name":"CalcDomain"}
  }
  </script>

  <!-- JSON-LD: HowTo -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to calculate the real cost of a meeting",
    "description": "A step-by-step guide to computing total meeting cost with attendees, hourly rates, overhead and recurrence.",
    "step": [
      {"@type":"HowToStep","name":"Enter meeting basics","text":"Provide meeting duration, currency, and recurrence."},
      {"@type":"HowToStep","name":"Add attendees","text":"For each role, set headcount and hourly cost or convert from annual salary."},
      {"@type":"HowToStep","name":"Include extras","text":"Optionally add prep time per attendee, travel time (in-person), and overhead percentage."},
      {"@type":"HowToStep","name":"Review results","text":"See total cost, per attendee, per minute, annualized cost, and a role breakdown chart."}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky per requirements) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
      <div class="flex items-center justify-between">
        <a href="index.html" class="text-2xl font-extrabold text-blue-700">CalcDomain</a>
        <div class="hidden md:flex items-center gap-6 text-sm">
          <a href="search.html" class="text-gray-700 hover:text-blue-700">Advanced Search</a>
          <a href="index.html#categories" class="text-gray-700 hover:text-blue-700">Categories</a>
        </div>
        <button id="mobile-menu-toggle" class="md:hidden p-2" aria-expanded="false" aria-controls="mobile-menu" aria-label="Open menu">
          <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></svg>
        </button>
      </div>
      <div id="mobile-menu" class="md:hidden mt-3 hidden">
        <div class="space-y-2">
          <a href="search.html" class="block py-2 text-gray-700 hover:text-blue-700">Advanced Search</a>
          <a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-700">Categories</a>
        </div>
      </div>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
      <a href="index.html" class="hover:text-blue-700">Home</a> &raquo;
      <a href="lifestyle-everyday.html" class="hover:text-blue-700">Lifestyle &amp; Everyday Life</a> &raquo;
      <a href="subcategories/time-date.html" class="hover:text-blue-700">Time and Date</a> &raquo;
      <span class="text-gray-900">Meeting Calculator</span>
    </nav>

    <div id="print-section" class="bg-white p-6 rounded-lg shadow-sm">
      <!-- 1) H1 -->
      <h1 class="text-3xl font-extrabold text-gray-900 mb-2">meeting calculator</h1>

      <!-- 2) Intro -->
      <p class="text-gray-700 mb-6">
        Estimate the <strong>true cost</strong> of any meeting—fast. Add attendees (by role and hourly cost or annual salary), include
        prep & travel time, apply overhead, set recurrence, and instantly see total cost, cost per attendee, cost per minute,
        and an annualized figure with a clear role breakdown chart. Built for managers, PMs, finance partners, and anyone
        who protects focus time.
      </p>

      <!-- 3) Calculator -->
      <section id="calculator-ui" class="space-y-6" aria-labelledby="calc-heading">
        <h2 id="calc-heading" class="sr-only">Meeting calculator inputs</h2>

        <!-- Meeting basics -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Duration -->
          <div>
            <label for="durationMinutes" class="block text-sm font-medium text-gray-800">
              Duration (minutes) <span class="req" aria-hidden="true">*</span>
            </label>
            <div class="flex gap-2 items-start">
              <input type="number" id="durationMinutes" inputmode="numeric" min="1" step="1" value="60"
                     aria-required="true" aria-describedby="duration-help duration-error"
                     class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600"
              />
              <button type="button" class="px-3 py-2 rounded-md border btn-like"
                      aria-expanded="false" aria-controls="duration-help" id="tt-duration" title="What counts as meeting time?">
                ?
              </button>
            </div>
            <p id="duration-help" class="text-gray-600 text-sm mt-1 hidden">
              Include active meeting time only. Prep and travel can be added separately below.
            </p>
            <p id="duration-error" class="field-error hidden">Please enter a duration of at least 1 minute.</p>
          </div>

          <!-- Recurrence -->
          <div>
            <label for="recurrence" class="block text-sm font-medium text-gray-800">
              Recurrence <span class="req" aria-hidden="true">*</span>
            </label>
            <select id="recurrence" aria-required="true" aria-describedby="recurrence-help"
                    class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600">
              <option value="oneoff" selected>One-off</option>
              <option value="weekly">Weekly</option>
              <option value="biweekly">Bi-weekly</option>
              <option value="monthly">Monthly</option>
              <option value="quarterly">Quarterly</option>
            </select>
            <p id="recurrence-help" class="text-gray-600 text-sm mt-1">Annualized cost uses 52, 26, 12, or 4 occurrences.</p>
          </div>

          <!-- Currency -->
          <div>
            <label for="currency" class="block text-sm font-medium text-gray-800">
              Currency <span class="req" aria-hidden="true">*</span>
            </label>
            <select id="currency" aria-required="true"
                    class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600">
              <option value="USD" selected>USD — $</option>
              <option value="EUR">EUR — €</option>
              <option value="GBP">GBP — £</option>
              <option value="CAD">CAD — $</option>
              <option value="AUD">AUD — $</option>
              <option value="JPY">JPY — ¥</option>
              <option value="INR">INR — ₹</option>
            </select>
          </div>
        </div>

        <!-- Extras -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <label for="prepPerAttendee" class="block text-sm font-medium text-gray-800">
              Prep time per attendee (min)
            </label>
            <input type="number" id="prepPerAttendee" inputmode="numeric" min="0" step="5" value="10"
                   aria-describedby="prep-help"
                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600">
            <p id="prep-help" class="text-gray-600 text-sm mt-1">Time each attendee spends preparing.</p>
          </div>
          <div>
            <label for="travelPerAttendee" class="block text-sm font-medium text-gray-800">
              Travel time per attendee (min, in-person)
            </label>
            <input type="number" id="travelPerAttendee" inputmode="numeric" min="0" step="5" value="0"
                   aria-describedby="travel-help"
                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600">
            <p id="travel-help" class="text-gray-600 text-sm mt-1">Set 0 for remote meetings.</p>
          </div>
          <div>
            <label for="overheadPct" class="block text-sm font-medium text-gray-800">
              Overhead &amp; benefits (%) 
            </label>
            <div class="flex gap-2 items-start">
              <input type="number" id="overheadPct" inputmode="decimal" min="0" step="1" value="30"
                     aria-describedby="overhead-help"
                     class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600">
              <button type="button" class="px-3 py-2 rounded-md border btn-like"
                      aria-expanded="false" aria-controls="overhead-help" id="tt-overhead" title="Why overhead?">?</button>
            </div>
            <p id="overhead-help" class="text-gray-600 text-sm mt-1 hidden">
              Employer on-costs (benefits, payroll taxes, facilities). US ECEC averages ~30% of total compensation.
            </p>
          </div>
        </div>

        <!-- Attendees table -->
        <div class="border rounded-lg p-4">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-lg font-semibold">Attendees</h3>
            <div class="flex gap-2">
              <button id="addRow" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Add role</button>
              <button id="resetRows" class="px-4 py-2 bg-gray-100 text-gray-900 rounded-md border">Reset</button>
            </div>
          </div>

          <div class="overflow-x-auto" role="region" aria-label="Attendees table">
            <table class="min-w-full text-sm">
              <thead class="bg-gray-100 text-gray-800">
                <tr>
                  <th class="text-left px-3 py-2">Role/Title</th>
                  <th class="text-right px-3 py-2">Headcount<span class="req" aria-hidden="true">*</span></th>
                  <th class="text-right px-3 py-2">Hourly cost</th>
                  <th class="text-right px-3 py-2">Annual salary</th>
                  <th class="text-right px-3 py-2">Use</th>
                  <th class="text-right px-3 py-2">Row cost (live)</th>
                  <th class="px-3 py-2">Action</th>
                </tr>
              </thead>
              <tbody id="attendeesBody" class="align-middle"></tbody>
            </table>
          </div>
          <p class="text-xs text-gray-600 mt-2">
            Enter either <em>Hourly cost</em> or <em>Annual salary</em>. Salary converts using 2080 hours/year.
          </p>
        </div>
      </section>

      <!-- 4) Results -->
      <section id="results" class="mt-8 minh-results">
        <h2 class="text-xl font-bold mb-3">Results</h2>

        <div class="flex flex-col lg:flex-row gap-6">
          <div class="w-full lg:w-2/3 grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="result-card">
              <h4>Total meeting cost</h4>
              <p id="totalCost">—</p>
            </div>
            <div class="result-card">
              <h4>Cost per attendee</h4>
              <p id="costPerAttendee">—</p>
            </div>
            <div class="result-card">
              <h4>Cost per minute</h4>
              <p id="costPerMinute">—</p>
            </div>
            <div class="result-card">
              <h4>Annualized cost</h4>
              <p id="annualCost">—</p>
            </div>
          </div>

          <div class="w-full lg:w-1/3">
            <div id="chart-container" class="h-56">
              <canvas id="roleChart" aria-label="Pie chart of cost by role"></canvas>
            </div>
          </div>
        </div>

        <details class="mt-6 bg-gray-50 border rounded-lg">
          <summary class="px-4 py-3 font-semibold cursor-pointer">Detailed breakdown</summary>
          <div class="p-4 overflow-x-auto">
            <table class="min-w-full text-sm">
              <thead class="bg-gray-100">
                <tr>
                  <th class="text-left px-3 py-2">Role</th>
                  <th class="text-right px-3 py-2">Headcount</th>
                  <th class="text-right px-3 py-2">Hourly (incl. overhead)</th>
                  <th class="text-right px-3 py-2">Time per person (min)</th>
                  <th class="text-right px-3 py-2">Row total</th>
                </tr>
              </thead>
              <tbody id="breakdownBody"></tbody>
            </table>
          </div>
        </details>
      </section>

      <!-- 5) Authoritative content -->
      <section class="prose mt-10">
        <h2>Data source &amp; methodology</h2>
        <p><strong>AuthoritativeDataSource:</strong> U.S. Bureau of Labor Statistics (BLS), <em>Employer Costs for Employee Compensation (ECEC)</em>, latest annual tables. Accessed via bls.gov.</p>
        <p><em>“Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.”</em></p>
        <ul>
          <li>Overhead/benefits proxy uses ECEC national averages (~30% of total compensation). Adjust the percentage to match your company.</li>
          <li>Annual salary converted to hourly assuming 2,080 hours per year (52 × 40).</li>
          <li>Annualized meeting cost multiplies one-meeting cost by recurrence (weekly 52, bi-weekly 26, monthly 12, quarterly 4).</li>
        </ul>

        <h2>The formula explained</h2>
        <div class="formula-box">
          Meeting cost (one-off): \\[
          C = \sum_{i=1}^{n}\Big( h_i \cdot \underbrace{r_i \cdot (1+\frac{o}{100})}_{\\text{loaded hourly}} \cdot
          \underbrace{\frac{t + p + v}{60}}_{\\text{hours per attendee}} \Big)
          \\]
          Where annualized cost is \\( C_{annual} = C \times f \\).
        </div>

        <h2>Glossary of variables</h2>
        <ul>
          <li><strong>n</strong>: number of distinct attendee roles/rows.</li>
          <li><strong>h<sub>i</sub></strong>: headcount for role <em>i</em>.</li>
          <li><strong>r<sub>i</sub></strong>: hourly cost for role <em>i</em> (converted from salary if provided).</li>
          <li><strong>o</strong>: overhead &amp; benefits percentage.</li>
          <li><strong>t</strong>: meeting duration (minutes).</li>
          <li><strong>p</strong>: prep time per attendee (minutes).</li>
          <li><strong>v</strong>: travel time per attendee (minutes; set 0 for remote).</li>
          <li><strong>f</strong>: recurrence factor (52, 26, 12, 4, or 1 for one-off).</li>
        </ul>

        <h2>How it works: a step-by-step example</h2>
        <h3>Example scenario</h3>
        <ul>
          <li>Duration = 60 min, Recurrence = Weekly, Overhead = 30%.</li>
          <li>Prep = 10 min per attendee, Travel = 0 (remote).</li>
          <li>Roles:
            <ul>
              <li>Executive: headcount 1, hourly $90</li>
              <li>Manager: headcount 2, hourly $60</li>
              <li>Staff: headcount 4, hourly $35</li>
            </ul>
          </li>
        </ul>
        <h3>Computation</h3>
        <p>
          Loaded hourly rates multiply by (1 + 0.30). Each attendee’s hours = (60 + 10 + 0)/60 = 1.1667 h.
          Sum across roles and multiply by headcount to get \\( C \\).
          Annualized cost multiplies \\( C \\) by 52.
        </p>

        <h2>FAQ</h2>
        <details>
          <summary>Should I use hourly cost or annual salary?</summary>
          <p>Either works. If salary is entered, the tool converts to hourly using 2,080 hours/year. If you have a precise hourly loaded rate from HR/Finance, prefer that.</p>
        </details>
        <details>
          <summary>What overhead percentage should I pick?</summary>
          <p>Start with 25–35% if you’re in the U.S. (based on BLS ECEC averages). Your company’s on-costs may differ; ask Finance for an internal burden rate.</p>
        </details>
        <details>
          <summary>Does prep and travel time really matter?</summary>
          <p>Yes. A 60-minute meeting with 10 minutes of prep for 10 people adds nearly two hours of extra time across the group.</p>
        </details>
        <details>
          <summary>How do I use annualized cost?</summary>
          <p>Compare the annualized figure to expected impact. If a weekly meeting costs $50k/year, it should clearly prevent more than $50k of waste or create at least that much value.</p>
        </details>
        <details>
          <summary>Is this a budgeting tool or a real-time ticker?</summary>
          <p>This calculator helps plan and compare. For a live ticker during meetings, use a timer and multiply by total loaded hourly rate per minute.</p>
        </details>
        <details>
          <summary>How accurate is the 2,080 hours/year assumption?</summary>
          <p>It’s a standard U.S. convention. If you prefer a different basis (e.g., 1,900 billable hours), adjust hourly costs accordingly.</p>
        </details>

        <div class="mt-6 p-4 bg-gray-50 border rounded-lg text-sm text-gray-700">
          <p><strong>Tool developed by Ugo Candido.</strong> Content verified by the CalcDomain Editorial Review Board.<br>
          Last accuracy review: <time datetime="2025-10-27">October 27, 2025</time></p>
        </div>
      </section>
    </div>
  </main>

  <aside id="sidebar" class="container mx-auto px-4 lg:px-6 pb-10">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div class="lg:col-start-3 space-y-6">
        <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
          Ad Placement (300×600)
        </div>
        <div class="bg-white p-6 rounded-lg border">
          <h3 class="font-bold text-lg mb-3">Why this calculator beats others</h3>
          <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
            <li>Includes prep & travel time (often ignored).</li>
            <li>Overhead/benefits loaded hourly rates for realism.</li>
            <li>Annualization by recurrence for budgeting.</li>
            <li>Accessible tooltips & inline validation (WCAG 2.1 AA).</li>
            <li>Clean role breakdown chart with export-ready layout.</li>
          </ul>
        </div>
        <div id="chart-annual" class="bg-white p-6 rounded-lg border">
          <h3 class="font-bold text-lg mb-3">Cost signals to watch</h3>
          <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
            <li>Cost per minute above your org’s threshold.</li>
            <li>Weekly recurring meetings exceeding team budget.</li>
            <li>Large groups where information could be async.</li>
          </ul>
        </div>
      </div>
    </div>
  </aside>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-700">About</a>
        <a href="contact.html" class="hover:text-blue-700">Contact</a>
        <a href="privacy.html" class="hover:text-blue-700">Privacy</a>
        <a href="terms.html" class="hover:text-blue-700">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator logic (defer) -->
  <script defer>
    (function(){
      // DOM
      const els = {
        durationMinutes: document.getElementById('durationMinutes'),
        recurrence: document.getElementById('recurrence'),
        currency: document.getElementById('currency'),
        prepPerAttendee: document.getElementById('prepPerAttendee'),
        travelPerAttendee: document.getElementById('travelPerAttendee'),
        overheadPct: document.getElementById('overheadPct'),
        attendeesBody: document.getElementById('attendeesBody'),
        totalCost: document.getElementById('totalCost'),
        costPerAttendee: document.getElementById('costPerAttendee'),
        costPerMinute: document.getElementById('costPerMinute'),
        annualCost: document.getElementById('annualCost'),
        breakdownBody: document.getElementById('breakdownBody'),
        addRow: document.getElementById('addRow'),
        resetRows: document.getElementById('resetRows'),
        ttDurationBtn: document.getElementById('tt-duration'),
        ttOverheadBtn: document.getElementById('tt-overhead'),
        durationHelp: document.getElementById('duration-help'),
        overheadHelp: document.getElementById('overhead-help'),
        durationError: document.getElementById('duration-error'),
        mobileToggle: document.getElementById('mobile-menu-toggle'),
        mobileMenu: document.getElementById('mobile-menu')
      };

      // Mobile nav
      els.mobileToggle?.addEventListener('click', () => {
        const open = els.mobileMenu.classList.toggle('hidden') ? 'false' : 'true';
        els.mobileToggle.setAttribute('aria-expanded', open);
      });

      // Accessible tooltips (toggle)
      function bindTooltip(btn, panel){
        if(!btn || !panel) return;
        btn.addEventListener('click', () => {
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          panel.classList.toggle('hidden');
        });
        btn.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' '){
            e.preventDefault(); btn.click();
          }
        });
      }
      bindTooltip(els.ttDurationBtn, els.durationHelp);
      bindTooltip(els.ttOverheadBtn, els.overheadHelp);

      // Intl currency formatter
      function fmtCurrency(v){
        const code = els.currency.value || 'USD';
        try {
          return new Intl.NumberFormat(undefined, { style: 'currency', currency: code, maximumFractionDigits: 2 }).format(v || 0);
        } catch {
          return (v || 0).toFixed(2) + ' ' + code;
        }
      }

      function fmtNumber(v){
        return new Intl.NumberFormat().format(v || 0);
      }

      // Recurrence factor
      function recurFactor(){
        const r = els.recurrence.value;
        return r === 'weekly' ? 52 :
               r === 'biweekly' ? 26 :
               r === 'monthly' ? 12 :
               r === 'quarterly' ? 4 : 1;
      }

      // Attendee row factory
      let rowIdCounter = 0;
      function addRow(role='Staff', headcount=1, hourly=35, salary=''){
        const id = ++rowIdCounter;
        const tr = document.createElement('tr');
        tr.setAttribute('data-row-id', String(id));
        tr.innerHTML = `
          <td class="px-3 py-2">
            <input type="text" value="${role}" aria-label="Role ${id}"
              class="w-full px-3 py-2 border rounded-md">
          </td>
          <td class="px-3 py-2 text-right">
            <input type="number" min="0" step="1" value="${headcount}" aria-label="Headcount ${id}"
              class="w-28 px-3 py-2 border rounded-md text-right">
          </td>
          <td class="px-3 py-2 text-right">
            <input type="number" min="0" step="1" value="${hourly}" aria-label="Hourly cost ${id}"
              class="w-32 px-3 py-2 border rounded-md text-right">
          </td>
          <td class="px-3 py-2 text-right">
            <input type="number" min="0" step="1000" value="${salary}" aria-label="Annual salary ${id}"
              class="w-36 px-3 py-2 border rounded-md text-right">
          </td>
          <td class="px-3 py-2 text-right">
            <select aria-label="Use salary or hourly ${id}" class="w-28 px-3 py-2 border rounded-md">
              <option value="hourly" ${salary===''?'selected':''}>Hourly</option>
              <option value="salary" ${salary!==''?'selected':''}>Salary</option>
            </select>
          </td>
          <td class="px-3 py-2 text-right">
            <span class="font-semibold" data-row-total>—</span>
          </td>
          <td class="px-3 py-2">
            <button class="px-3 py-2 border rounded-md text-red-700 hover:bg-red-50" aria-label="Remove row ${id}">Remove</button>
          </td>`;
        // Events
        tr.querySelectorAll('input,select,button').forEach(el=>{
          el.addEventListener('input', recalc);
          el.addEventListener('change', recalc);
          if(el.tagName.toLowerCase()==='button'){
            el.addEventListener('click', ()=>{
              tr.remove(); recalc();
            });
          }
        });
        els.attendeesBody.appendChild(tr);
      }

      // Seed defaults to beat competitors (exec/manager/staff)
      function seedDefaults(){
        els.attendeesBody.innerHTML = '';
        addRow('Executive', 1, 90, '');
        addRow('Manager', 2, 60, '');
        addRow('Staff', 4, 35, '');
      }
      seedDefaults();

      // Add/reset handlers
      els.addRow.addEventListener('click', ()=> addRow());
      els.resetRows.addEventListener('click', seedDefaults);

      // Validation (on blur per requirement)
      function validateFieldNumber(input, minVal=0){
        const val = parseFloat(input.value);
        if(isNaN(val) || val < minVal){
          input.setAttribute('aria-invalid','true');
          return false;
        }
        input.removeAttribute('aria-invalid');
        return true;
      }
      els.durationMinutes.addEventListener('blur', ()=>{
        const ok = validateFieldNumber(els.durationMinutes, 1);
        els.durationError.classList.toggle('hidden', ok);
      });

      // Chart
      let roleChart;
      function renderChart(labels, values){
        const ctx = document.getElementById('roleChart');
        if(!ctx) return;
        const data = { labels, datasets: [{ data: values }] };
        const options = { plugins:{ legend:{ position:'bottom' } }, responsive:true, maintainAspectRatio:false };
        if(roleChart){ roleChart.data = data; roleChart.update(); }
        else { roleChart = new Chart(ctx, { type:'pie', data, options }); }
      }

      // Recalc
      function recalc(){
        // Read inputs
        const tMin = Math.max(0, parseFloat(els.durationMinutes.value) || 0);
        const prepMin = Math.max(0, parseFloat(els.prepPerAttendee.value) || 0);
        const travelMin = Math.max(0, parseFloat(els.travelPerAttendee.value) || 0);
        const overhead = Math.max(0, parseFloat(els.overheadPct.value) || 0) / 100;
        const totalMinPerPerson = tMin + prepMin + travelMin;
        const totalHoursPerPerson = totalMinPerPerson / 60;
        const f = recurFactor();

        // Iterate rows
        let totalCost = 0;
        let totalPeople = 0;
        const labels = [];
        const values = [];
        const breakdownRows = [];

        els.attendeesBody.querySelectorAll('tr').forEach(tr=>{
          const role = tr.querySelector('td:nth-child(1) input')?.value?.trim() || 'Role';
          const headcount = Math.max(0, parseFloat(tr.querySelector('td:nth-child(2) input')?.value) || 0);
          const hourly = Math.max(0, parseFloat(tr.querySelector('td:nth-child(3) input')?.value) || 0);
          const salary = Math.max(0, parseFloat(tr.querySelector('td:nth-child(4) input')?.value) || 0);
          const use = tr.querySelector('td:nth-child(5) select')?.value || 'hourly';

          let hourlyBase = hourly;
          if(use === 'salary' && salary > 0){
            hourlyBase = salary / 2080; // 52*40
          }
          const loadedHourly = hourlyBase * (1 + overhead);
          const rowTotal = headcount * loadedHourly * totalHoursPerPerson;

          // Update row live total
          const rowTotalEl = tr.querySelector('[data-row-total]');
          if(rowTotalEl) rowTotalEl.textContent = fmtCurrency(rowTotal);

          if(headcount > 0){
            labels.push(role);
            values.push(rowTotal);
            totalCost += rowTotal;
            totalPeople += headcount;
            breakdownRows.push({
              role,
              headcount,
              loadedHourly,
              timeMin: totalMinPerPerson,
              rowTotal
            });
          }
        });

        // Totals
        const costPerAttendee = totalPeople > 0 ? (totalCost / totalPeople) : 0;
        const costPerMinute = tMin > 0 ? (totalCost / tMin) : 0;
        const annual = totalCost * f;

        // Render headline metrics
        els.totalCost.textContent = fmtCurrency(totalCost);
        els.costPerAttendee.textContent = fmtCurrency(costPerAttendee);
        els.costPerMinute.textContent = fmtCurrency(costPerMinute);
        els.annualCost.textContent = fmtCurrency(annual);

        // Breakdown table
        els.breakdownBody.innerHTML = '';
        breakdownRows.forEach(r=>{
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td class="px-3 py-2 text-left">${r.role}</td>
            <td class="px-3 py-2 text-right">${fmtNumber(r.headcount)}</td>
            <td class="px-3 py-2 text-right">${fmtCurrency(r.loadedHourly)}</td>
            <td class="px-3 py-2 text-right">${fmtNumber(r.timeMin)}</td>
            <td class="px-3 py-2 text-right font-semibold">${fmtCurrency(r.rowTotal)}</td>
          `;
          els.breakdownBody.appendChild(tr);
        });

        // Chart
        renderChart(labels, values);
      }

      // Wire inputs
      [
        'durationMinutes','recurrence','currency','prepPerAttendee',
        'travelPerAttendee','overheadPct'
      ].forEach(id=>{
        const el = document.getElementById(id);
        el.addEventListener('input', recalc);
        el.addEventListener('change', recalc);
      });

      // Initial calc
      recalc();
    })();
  </script>
</body>
</html>

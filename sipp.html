<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>SIPP (Self-Invested Personal Pension) Calculator (UK)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Project the value of your UK Self-Invested Personal Pension (SIPP) with adjustable growth, contribution timing, and sensitivity analysis."/>
  <meta name="author" content="Ugo Candido"/>
  <link rel="canonical" href="https://calcdomain.com/sipp.html"/>
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="SIPP (Self-Invested Personal Pension) Calculator"/>
  <meta property="og:description" content="Estimate future SIPP value, contributions, and investment growth with UK pension-specific assumptions."/>
  <meta property="og:url" content="https://calcdomain.com/sipp.html"/>
  <meta name="theme-color" content="#0b3d69"/>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="search.js" defer></script>
  <style>
    body { font-family:'Inter',system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif; }
    .prose { max-width: 70ch; }
    .prose h2 { font-size: 1.5rem; font-weight:700; margin-top:2rem; margin-bottom:.75rem; }
    .prose h3 { font-size:1.125rem; font-weight:700; margin-top:1.25rem; margin-bottom:.5rem; }
    .prose p { margin-bottom:.9rem; line-height:1.7; }
    .prose ul { list-style:disc; padding-left:1.25rem; }
    .prose ol { list-style:decimal; padding-left:1.25rem; }
    details > summary { cursor:pointer; font-weight:600; }
    details[open] > summary { margin-bottom:.5rem; }
    .eeat { display:grid; gap:.75rem; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); font-size:.875rem; color:#374151; }
    .eeat span { display:block; background:#f9fafb; border:1px solid #e5e7eb; border-radius:.5rem; padding:.75rem 1rem; }
    .result-pill { display:inline-flex; align-items:center; font-size:.875rem; font-weight:600; padding:.25rem .75rem; border-radius:9999px; }
    .table { width:100%; border-collapse:collapse; }
    .table th, .table td { border:1px solid #e2e8f0; padding:.5rem; text-align:right; }
    .table th:first-child, .table td:first-child { text-align:left; }
    .btn { display:inline-flex; align-items:center; justify-content:center; gap:.5rem; padding:.5rem 1rem; border-radius:.5rem; border:1px solid transparent; font-weight:600; min-height:44px; transition:background-color .2s ease,color .2s ease,border-color .2s ease; }
    .btn-primary { background:#2563eb; color:#fff; border-color:#2563eb; }
    .btn-secondary { background:#fff; color:#2563eb; border-color:#2563eb; }
    .btn-ghost { background:transparent; color:#1f2937; border-color:#e2e8f0; }
    .btn-danger { background:#fff; color:#dc2626; border-color:#ef4444; }
    .btn:hover { filter:brightness(.95); }
    .segmented { display:flex; border:1px solid #e5e7eb; border-radius:.75rem; overflow:hidden; background:#f8fafc; position:relative; }
    .segmented input { position:absolute; opacity:0; pointer-events:none; }
    .segmented label { flex:1; text-align:center; padding:.5rem .75rem; cursor:pointer; user-select:none; font-weight:600; color:#1f2937; transition:background-color .2s ease,color .2s ease; }
    .segmented input:checked + label { background:#2563eb; color:#fff; }
  </style>

  <!-- MathJax (optional for formulas) -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(','\\)'],['$','$']], displayMath: [['\\[','\\]']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Finance","item":"https://calcdomain.com/finance.html"},
      {"@type":"ListItem","position":3,"name":"Investment","item":"https://calcdomain.com/subcategories/finance-investment.html"},
      {"@type":"ListItem","position":4,"name":"SIPP (Self-Invested Personal Pension) Calculator","item":"https://calcdomain.com/sipp.html"}
    ]
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "SIPP (Self-Invested Personal Pension) Calculator (UK)",
    "description": "Project UK SIPP balances with adjustable yearly contributions, growth assumptions, and contribution timing.",
    "url": "https://calcdomain.com/sipp.html",
    "author": { "@type": "Person", "name": "Ugo Candido" },
    "publisher": { "@type": "Organization", "name": "CalcDomain" },
    "mainEntity": {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is a SIPP?",
          "acceptedAnswer": { "@type": "Answer", "text": "A Self-Invested Personal Pension (SIPP) is a UK government-approved personal pension scheme that lets you choose and manage investments within HMRC rules." }
        },
        {
          "@type": "Question",
          "name": "How do I use the SIPP calculator?",
          "acceptedAnswer": { "@type": "Answer", "text": "Enter your age, planned retirement age, current SIPP fund, and annual contributions. Adjust the expected annual growth rate and contribution timing to see projected balances." }
        }
      ]
    }
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Header -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <nav class="container mx-auto px-4 lg:px-6 py-4">
      <div class="flex justify-between items-center">
        <a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

        <div class="w-full max-w-md hidden md:block mx-8">
          <div class="relative">
            <input id="search-input" type="search" placeholder="Search for a calculator..."
                   class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   autocomplete="off">
            <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
          </div>
        </div>

        <div class="hidden md:flex items-center space-x-6">
          <a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
          <a href="index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
        </div>

        <button id="mobile-menu-toggle" class="md:hidden p-2" aria-label="Open menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>

      <div id="mobile-menu" class="md:hidden mt-4 hidden">
        <div class="mb-4">
          <div class="relative">
            <input id="mobile-search-input" type="search" placeholder="Search calculators..."
                   class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                   aria-label="Search calculators">
            <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
        </div>
        <div class="space-y-2">
          <a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
          <a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
        </div>
      </div>
    </nav>
  </header>

  <!-- Main -->
  <main class="container mx-auto px-4 py-8">
    <div class="flex flex-col lg:flex-row gap-8">

      <!-- Left: Calculator & Content -->
      <section class="w-full lg:w-2/3">
        <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
          <a href="finance.html" class="hover:text-blue-600">Finance</a> &raquo;
          <a href="subcategories/finance-investment.html" class="hover:text-blue-600">Investment</a> &raquo;
          <span class="text-gray-900 font-medium">SIPP Calculator</span>
        </nav>

        <section class="bg-white p-6 rounded-lg shadow-md">
          <h1 class="text-3xl font-bold mb-2">SIPP (Self-Invested Personal Pension) Calculator (UK)</h1>
          <p class="text-gray-600 mb-4">
            Estimate the future value of your UK Self-Invested Personal Pension (SIPP) by adjusting age, contributions, growth
            assumptions, and contribution timing. Compare projected balances with total contributions to understand potential growth.
          </p>

          <div class="eeat mb-6">
            <span><strong>Author:</strong> Ugo Candido</span>
            <span><strong>Reviewed by:</strong> Pension Content Editor</span>
            <span><strong>Last updated:</strong> <time id="lastUpdated"></time></span>
            <span><strong>Category:</strong> Finance â†’ Investment</span>
          </div>

          <div class="mb-4">
            <div class="segmented" role="radiogroup" aria-label="Contribution timing">
              <input type="radio" id="timingEnd" name="timing" value="end" checked>
              <label for="timingEnd">End of year</label>
              <input type="radio" id="timingBegin" name="timing" value="begin">
              <label for="timingBegin">Beginning (annuity due)</label>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="currentAge" class="block text-sm font-medium text-gray-700">Current age *</label>
              <input id="currentAge" type="number" min="16" step="1" placeholder="e.g., 35"
                     class="mt-1 block w-full px-3 py-2 border rounded-md" aria-describedby="ageHelp">
              <p id="ageHelp" class="text-sm text-gray-500 mt-1">Enter your age today.</p>
              <p id="currentAgeErr" class="text-sm text-red-600 mt-1 hidden">Enter a valid current age (16â€“75).</p>
            </div>

            <div>
              <label for="retirementAge" class="block text-sm font-medium text-gray-700">Retirement age *</label>
              <input id="retirementAge" type="number" min="18" step="1" placeholder="e.g., 65"
                     class="mt-1 block w-full px-3 py-2 border rounded-md" aria-describedby="retireHelp">
              <p id="retireHelp" class="text-sm text-gray-500 mt-1">Age you plan to access SIPP (min 55 rising to 57 in 2028).</p>
              <p id="retirementAgeErr" class="text-sm text-red-600 mt-1 hidden">Retirement age must exceed current age (max 75).</p>
            </div>

            <div>
              <label for="currentFund" class="block text-sm font-medium text-gray-700">Current SIPP fund (Â£) *</label>
              <input id="currentFund" type="number" min="0" step="0.01" placeholder="e.g., 50000"
                     class="mt-1 block w-full px-3 py-2 border rounded-md">
              <p id="currentFundErr" class="text-sm text-red-600 mt-1 hidden">Enter a non-negative value.</p>
            </div>

            <div>
              <label for="annualContribution" class="block text-sm font-medium text-gray-700">Annual contribution (Â£) *</label>
              <input id="annualContribution" type="number" min="0" step="0.01" placeholder="e.g., 6000"
                     class="mt-1 block w-full px-3 py-2 border rounded-md">
              <p id="annualContributionErr" class="text-sm text-red-600 mt-1 hidden">Enter a positive annual contribution.</p>
            </div>

            <div>
              <label for="growthRate" class="block text-sm font-medium text-gray-700">Expected annual growth (CAGR) *</label>
              <div class="relative">
                <input id="growthRate" type="number" step="0.1" placeholder="e.g., 5"
                       class="mt-1 block w-full px-3 py-2 border rounded-md pr-12">
                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 font-semibold">%</span>
              </div>
              <p id="growthRateErr" class="text-sm text-red-600 mt-1 hidden">Enter a growth rate greater than -100%.</p>
            </div>
          </div>

          <div class="mt-4 flex flex-wrap gap-2">
            <button id="calcBtn" type="button" class="btn btn-primary">Calculate</button>
            <button id="exampleBtn" type="button" class="btn btn-secondary">Load example</button>
            <button id="resetBtn" type="button" class="btn btn-danger">Reset</button>
          </div>

          <section aria-live="polite" aria-atomic="true" class="mt-6 bg-blue-50 p-6 rounded-lg">
            <h2 class="text-lg font-semibold text-gray-800 mb-2">Results</h2>
            <div class="grid sm:grid-cols-2 gap-3">
              <div class="flex items-baseline justify-between border-b pb-2">
                <span class="text-gray-600">Years to retirement</span>
                <span id="outYears" class="text-xl font-bold text-gray-800">â€”</span>
              </div>
              <div class="flex items-baseline justify-between border-b pb-2">
                <span class="text-gray-600">Total contributed (incl. current fund)</span>
                <span id="outInvested" class="text-xl font-bold text-gray-800">Â£0.00</span>
              </div>
              <div class="flex items-baseline justify-between border-b pb-2">
                <span class="text-gray-600">Estimated SIPP at retirement</span>
                <span id="outFund" class="text-2xl font-extrabold text-green-700">Â£0.00</span>
              </div>
              <div class="flex items-baseline justify-between">
                <span class="text-gray-600">Projected investment growth</span>
                <span id="outGrowth" class="text-xl font-bold text-green-600">Â£0.00</span>
              </div>
            </div>
            <div class="mt-3 space-x-2">
              <span class="result-pill bg-sky-100 text-sky-800" id="pillYears">Years: â€”</span>
              <span class="result-pill bg-violet-100 text-violet-800" id="pillTiming">Timing: End</span>
              <span class="result-pill bg-emerald-100 text-emerald-800" id="pillRate">Growth: â€”</span>
            </div>
          </section>

          <section class="mt-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">Sensitivity (Â±2% around growth rate)</h3>
            <div class="overflow-x-auto">
              <table class="table text-sm">
                <thead>
                  <tr>
                    <th>Annual growth</th>
                    <th>Projected fund</th>
                  </tr>
                </thead>
                <tbody id="sensBody">
                  <tr><td class="p-2 text-center text-gray-500" colspan="2">Adjust inputs to see projection rangeâ€¦</td></tr>
                </tbody>
              </table>
            </div>
          </section>
        </section>

        <article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
          <h2>Methodology and Assumptions</h2>
          <p>Projections assume contributions are made annually at the end (or beginning) of each year and grow at the constant
            effective annual rate you provide. HM Treasury and HMRC set annual allowance limits and tax relief rulesâ€”consult the
            <a href="https://www.gov.uk/pension-types/self-invested-personal-pensions" target="_blank" rel="noopener">official guidance</a>
            before making changes. Investment markets fluctuate; use these figures as planning estimates rather than guarantees.</p>

          <h2>Formulas</h2>
          <div class="formula-box">
            <p><strong>Future value of current SIPP fund</strong></p>
            <div>\[
              FV_{\text{fund}} = P_0 (1 + r)^T
            \]</div>
            <p><strong>Future value of annual contributions</strong></p>
            <div>\[
              FV_{\text{contrib}} =
              \begin{cases}
                \mathrm{PMT} \cdot \dfrac{(1+r)^T - 1}{r} \cdot (1+r)^{\delta}, & r \ne 0\\[6pt]
                \mathrm{PMT} \cdot T, & r = 0
              \end{cases}
            \]
            where \( \delta = 1 \) for beginning-of-period contributions.</div>
            <p><strong>Total projected SIPP value</strong></p>
            <div>\[
              FV_{\text{total}} = FV_{\text{fund}} + FV_{\text{contrib}}
            \]</div>
          </div>

          <h2>How to Use This Calculator</h2>
          <ol>
            <li>Enter your current age and the age you expect to access your SIPP (minimum 55, rising to 57 in 2028).</li>
            <li>Provide your current SIPP balance and annual contributions (gross).</li>
            <li>Select the assumed annual growth rate (after fees). Adjust as needed to explore scenarios.</li>
            <li>Choose whether contributions occur at the end or beginning of each year.</li>
            <li>Review projected SIPP value, total contributions, and the sensitivity table.</li>
          </ol>

          <h2>Frequently Asked Questions</h2>
          <h3>What is a SIPP?</h3>
          <p>A Self-Invested Personal Pension (SIPP) is a UK-approved personal pension allowing you to choose investments within HMRC rules.</p>
          <h3>Can I change the assumed growth rate?</h3>
          <p>Yesâ€”enter any expected annual compound rate, net of fees. Test conservative and optimistic scenarios to understand the range of outcomes.</p>
          <h3>How accurate are these projections?</h3>
          <p>They illustrate how contributions could compound under constant growth assumptions. Actual market returns and charges will differ.</p>
          <h3>Can I include an initial lump sum?</h3>
          <p>Yesâ€”the model compounds your current SIPP fund for the full years remaining to retirement.</p>
          <h3>When can I access my SIPP?</h3>
          <p>Currently from age 55 (rising to 57 in 2028). Withdrawals before this age face significant restrictions.</p>

          <p class="text-sm text-gray-600">
            Tool developed by Ugo Candido. Reviewed by the CalcDomain pension content team.
          </p>
        </article>
      </section>

      <!-- Sidebar -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div class="bg-gray-200 rounded-lg h-72 flex items-center justify-center text-gray-500">
            Ad Placement (300Ã—600)
          </div>

          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="font-bold text-lg mb-4">Related Retirement Tools</h3>
            <ul class="space-y-3 text-sm">
              <li><a class="text-blue-600 hover:underline" href="retirement.html">Retirement Savings Planner</a></li>
              <li><a class="text-blue-600 hover:underline" href="pension.html">Defined Benefit Pension Estimator</a></li>
              <li><a class="text-blue-600 hover:underline" href="roi.html">ROI Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="compound-interest-calculator.html">Compound Interest Calculator</a></li>
            </ul>
          </div>
        </div>
      </aside>

    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
    </div>
  </footer>

  <script>
    const els = {
      currentAge: document.getElementById('currentAge'),
      retirementAge: document.getElementById('retirementAge'),
      currentFund: document.getElementById('currentFund'),
      annualContribution: document.getElementById('annualContribution'),
      growthRate: document.getElementById('growthRate'),
      timingEnd: document.getElementById('timingEnd'),
      timingBegin: document.getElementById('timingBegin'),
      currentAgeErr: document.getElementById('currentAgeErr'),
      retirementAgeErr: document.getElementById('retirementAgeErr'),
      currentFundErr: document.getElementById('currentFundErr'),
      annualContributionErr: document.getElementById('annualContributionErr'),
      growthRateErr: document.getElementById('growthRateErr'),
      calcBtn: document.getElementById('calcBtn'),
      exampleBtn: document.getElementById('exampleBtn'),
      resetBtn: document.getElementById('resetBtn'),
      outYears: document.getElementById('outYears'),
      outInvested: document.getElementById('outInvested'),
      outFund: document.getElementById('outFund'),
      outGrowth: document.getElementById('outGrowth'),
      pillYears: document.getElementById('pillYears'),
      pillTiming: document.getElementById('pillTiming'),
      pillRate: document.getElementById('pillRate'),
      sensBody: document.getElementById('sensBody'),
      lastUpdated: document.getElementById('lastUpdated')
    };

    const fmtGBP = (v) => {
      try {
        return new Intl.NumberFormat('en-GB',{style:'currency',currency:'GBP',maximumFractionDigits:2}).format(v);
      } catch {
        const sign = v < 0 ? '-' : '';
        return sign + 'Â£' + Math.abs(v).toFixed(2);
      }
    };
    const fmtPercent = (x) => Number.isFinite(x) ? (x*100).toFixed(2) + '%' : 'â€”';
    const clampRate = (r) => Math.max(-0.9999, r);

    function validateInputs(){
      let ok = true;
      const age = Number(els.currentAge.value);
      const retire = Number(els.retirementAge.value);
      const fund = Number(els.currentFund.value);
      const contrib = Number(els.annualContribution.value);
      const growth = Number(els.growthRate.value);

      if (!Number.isFinite(age) || age < 16 || age > 75){
        els.currentAgeErr.classList.remove('hidden'); ok = false;
      } else els.currentAgeErr.classList.add('hidden');

      if (!Number.isFinite(retire) || retire <= age || retire > 75){
        els.retirementAgeErr.classList.remove('hidden'); ok = false;
      } else els.retirementAgeErr.classList.add('hidden');

      if (!Number.isFinite(fund) || fund < 0){
        els.currentFundErr.classList.remove('hidden'); ok = false;
      } else els.currentFundErr.classList.add('hidden');

      if (!Number.isFinite(contrib) || contrib <= 0){
        els.annualContributionErr.classList.remove('hidden'); ok = false;
      } else els.annualContributionErr.classList.add('hidden');

      if (!Number.isFinite(growth) || growth <= -100){
        els.growthRateErr.classList.remove('hidden'); ok = false;
      } else els.growthRateErr.classList.add('hidden');

      return ok;
    }

    function computeProjection({ age, retireAge, currentFund, annualContribution, rate, timing }){
      const years = retireAge - age;
      const r = clampRate(rate / 100);
      const delta = timing === 'begin' ? 1 : 0;
      const fvFund = currentFund * Math.pow(1 + r, years);
      let fvContrib;
      if (Math.abs(r) < 1e-9){
        fvContrib = annualContribution * years;
      } else {
        fvContrib = annualContribution * (((Math.pow(1 + r, years) - 1) / r) * Math.pow(1 + r, delta));
      }
      const total = fvFund + fvContrib;
      const invested = currentFund + annualContribution * years;
      return { years, fvFund, fvContrib, total, invested, growth: total - invested, r };
    }

    function buildSensitivity(base){
      const rows = [];
      const increments = [-0.02, -0.01, 0, 0.01, 0.02];
      els.sensBody.innerHTML = '';
      increments.forEach(step => {
        const rate = clampRate(base.rate/100 + step);
        const comp = computeProjection({
          age: base.age,
          retireAge: base.retireAge,
          currentFund: base.currentFund,
          annualContribution: base.annualContribution,
          rate: rate*100,
          timing: base.timing
        });
        const tr = document.createElement('tr');
        const tdRate = document.createElement('td');
        tdRate.className = 'p-2 text-left';
        tdRate.textContent = fmtPercent(rate);
        const tdFund = document.createElement('td');
        tdFund.className = 'p-2 text-right';
        tdFund.textContent = fmtGBP(comp.total);
        tr.append(tdRate, tdFund);
        els.sensBody.appendChild(tr);
      });
    }

    function render(){
      if (!validateInputs()){
        els.outYears.textContent = 'â€”';
        els.outInvested.textContent = fmtGBP(0);
        els.outFund.textContent = fmtGBP(0);
        els.outGrowth.textContent = fmtGBP(0);
        els.pillYears.textContent = 'Years: â€”';
        els.pillTiming.textContent = 'Timing: End';
        els.pillRate.textContent = 'Growth: â€”';
        els.sensBody.innerHTML = '<tr><td class="p-2 text-center text-gray-500" colspan="2">Adjust inputs to see projection rangeâ€¦</td></tr>';
        return;
      }

      const params = {
        age: Number(els.currentAge.value),
        retireAge: Number(els.retirementAge.value),
        currentFund: Number(els.currentFund.value),
        annualContribution: Number(els.annualContribution.value),
        rate: Number(els.growthRate.value),
        timing: els.timingBegin.checked ? 'begin' : 'end'
      };

      const result = computeProjection(params);
      els.outYears.textContent = `${result.years} years`;
      els.outInvested.textContent = fmtGBP(result.invested);
      els.outFund.textContent = fmtGBP(result.total);
      els.outGrowth.textContent = fmtGBP(result.growth);
      els.pillYears.textContent = `Years: ${result.years}`;
      els.pillTiming.textContent = `Timing: ${params.timing === 'begin' ? 'Beginning' : 'End'}`;
      els.pillRate.textContent = `Growth: ${Number(params.rate).toFixed(1)}%`;

      buildSensitivity({
        age: params.age,
        retireAge: params.retireAge,
        currentFund: params.currentFund,
        annualContribution: params.annualContribution,
        rate: params.rate,
        timing: params.timing
      });
    }

    function loadExample(){
      els.currentAge.value = '35';
      els.retirementAge.value = '65';
      els.currentFund.value = '50000';
      els.annualContribution.value = '6000';
      els.growthRate.value = '5';
      els.timingEnd.checked = true;
      els.timingBegin.checked = false;
      render();
    }

    function resetForm(){
      els.currentAge.value = '';
      els.retirementAge.value = '';
      els.currentFund.value = '';
      els.annualContribution.value = '';
      els.growthRate.value = '';
      els.timingEnd.checked = true;
      els.timingBegin.checked = false;
      els.currentAgeErr.classList.add('hidden');
      els.retirementAgeErr.classList.add('hidden');
      els.currentFundErr.classList.add('hidden');
      els.annualContributionErr.classList.add('hidden');
      els.growthRateErr.classList.add('hidden');
      render();
    }

    els.calcBtn.addEventListener('click', render);
    ['currentAge','retirementAge','currentFund','annualContribution','growthRate'].forEach(id=>{
      document.getElementById(id).addEventListener('input', render);
    });
    els.timingEnd.addEventListener('change', render);
    els.timingBegin.addEventListener('change', render);
    els.exampleBtn.addEventListener('click', loadExample);
    els.resetBtn.addEventListener('click', resetForm);

    document.addEventListener('DOMContentLoaded', () => {
      const d = new Date();
      els.lastUpdated.textContent = d.toLocaleDateString('en-GB',{year:'numeric',month:'long',day:'numeric'});
      loadExample();

      const toggle = document.getElementById('mobile-menu-toggle');
      const menu = document.getElementById('mobile-menu');
      toggle?.addEventListener('click', () => { menu?.classList.toggle('hidden'); });
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Area Calculator – Compute Area of Common Shapes (with Steps & Formulas)</title>
  <meta name="description" content="Professional area calculator for rectangles, triangles, circles, trapezoids, sectors, and ellipses. Includes LaTeX formulas, step-by-step example, glossary, and unit conversions (m², ft², in², acres, hectares).">
  <link rel="canonical" href="https://calcdomain.com/area-calculator.html" />
  <link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg" />
  <link rel="shortcut icon" href="https://calcdomain.com/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png" />
  <link rel="manifest" href="https://calcdomain.com/site.webmanifest" />

  <!-- Tailwind (utility-only, fast to first render) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --focus:#2563eb; /* visible focus color */
    }
    body{font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif}
    .prose { max-width: 70ch; }
    .prose h2{ font-size:1.5rem; font-weight:700; margin:1.75rem 0 .75rem }
    .prose h3{ font-size:1.125rem; font-weight:700; margin:1.25rem 0 .5rem }
    .prose p{ margin:.75rem 0; line-height:1.65 }
    .prose ul, .prose ol{ margin:.5rem 0 .75rem 1.25rem }
    .formula-box{ background:#f8fafc; border:1px solid #e5e7eb; border-radius:.75rem; padding:1rem; overflow:auto; }
    .result-card{ background:#fff; border:1px solid #e5e7eb; border-radius:.75rem; padding:1rem; text-align:center }
    .result-card h4{ font-size:.95rem; color:#6b7280; margin-bottom:.25rem }
    .result-card p{ font-weight:800; font-size:1.4rem; color:#2563eb }
    /* Prevent CLS: reserve space for results */
    #results { min-height: 14rem; }
    /* Accessible focus */
    :is(a,button,summary,[role="tooltip"],input,select).focus-visible,
    :is(a,button,summary,input,select):focus {
      outline: 3px solid var(--focus);
      outline-offset: 2px;
    }
    /* 48px touch targets (mobile ergonomics) */
    button, .btn, select, input { min-height: 48px }
    label .req { color:#dc2626; margin-left:.25rem; }
    .field-error { color:#b91c1c; font-size:.875rem; margin-top:.375rem }
    [role="tooltip"]{ display:block }
    details > summary { cursor:pointer; font-weight:600 }
    @media print {
      header, footer, aside { display:none !important }
      #print-section { position: static; }
      a[href]:after{ content:"" }
    }
  </style>

  <!-- MathJax for LaTeX (deferred) -->
  <script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
          integrity=""
          crossorigin="anonymous"></script>

  <!-- JSON-LD: WebPage + WebApplication (Calculator) + Breadcrumb + FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Area Calculator",
    "inLanguage":"en",
    "url":"https://calcdomain.com/area-calculator.html",
    "description":"Compute areas for rectangles, triangles, circles, trapezoids, sectors, and ellipses with LaTeX formulas, unit conversions, and step-by-step example.",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"Area Calculator",
    "applicationCategory":"Calculator",
    "operatingSystem":"All",
    "creator":{"@type":"Person","name":"Ugo Candido"},
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
    "url":"https://calcdomain.com/area-calculator.html"
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Math","item":"https://calcdomain.com/math.html"},
      {"@type":"ListItem","position":3,"name":"Geometry","item":"https://calcdomain.com/subcategories/math-geometry.html"},
      {"@type":"ListItem","position":4,"name":"Area Calculator","item":"https://calcdomain.com/area-calculator.html"}
    ]
  }
  </script>
  <script type="application/ld+json" id="faq-jsonld">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What units can this area calculator handle?","acceptedAnswer":{"@type":"Answer","text":"You can enter dimensions in mm, cm, m, in, ft, or yd and get area in the same unit squared, plus instant conversions to m², ft², in², acres, and hectares."}},
      {"@type":"Question","name":"Is this accurate for real-world plans?","acceptedAnswer":{"@type":"Answer","text":"Yes—formulas follow standard Euclidean geometry. For site plans with irregular boundaries, use polygon-by-coordinates or a GIS tool for best accuracy."}},
      {"@type":"Question","name":"How do I compute triangle area if I know all sides?","acceptedAnswer":{"@type":"Answer","text":"Use Heron’s formula: A = sqrt(s(s−a)(s−b)(s−c)), where s is half the perimeter."}},
      {"@type":"Question","name":"What’s the difference between area and surface area?","acceptedAnswer":{"@type":"Answer","text":"Area is 2D space inside a shape; surface area is the total area of the surfaces of a 3D object."}},
      {"@type":"Question","name":"Can I compute a circular sector?","acceptedAnswer":{"@type":"Answer","text":"Yes—use A = (θ/360°)·πr² for degrees, or A = 0.5·r²·θ if θ is in radians."}},
      {"@type":"Question","name":"How precise are the conversions?","acceptedAnswer":{"@type":"Answer","text":"Conversions use exact metric definitions (1 in = 0.0254 m; 1 ft = 0.3048 m; 1 yard = 0.9144 m; 1 acre = 4046.8564224 m²; 1 hectare = 10,000 m²)."}}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky by requirement) -->
  <header class="bg-white border-b">
    <div class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a class="text-2xl font-extrabold text-blue-700" href="index.html" aria-label="CalcDomain home">CalcDomain</a>
      <nav aria-label="Primary" class="hidden md:flex gap-6 text-sm">
        <a class="hover:text-blue-700" href="search.html">Advanced Search</a>
        <a class="hover:text-blue-700" href="index.html#categories">Categories</a>
      </nav>
      <button id="menuToggle" class="md:hidden p-2" aria-expanded="false" aria-controls="mobileNav" aria-label="Open menu">
        <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"https://calcdomain.com/>
        </svg>
      </button>
    </div>
    <div id="mobileNav" class="hidden md:hidden border-t">
      <div class="container mx-auto px-4 py-3 space-y-2">
        <a class="block py-2 hover:text-blue-700" href="search.html">Advanced Search</a>
        <a class="block py-2 hover:text-blue-700" href="index.html#categories">Categories</a>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Main column -->
      <section class="w-full lg:w-2/3">
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-700">Home</a> &raquo;
          <a href="math.html" class="hover:text-blue-700">Math</a> &raquo;
          <a href="subcategories/math-geometry.html" class="hover:text-blue-700">Geometry</a> &raquo;
          <span class="text-gray-900">Area Calculator</span>
        </nav>

        <!-- 1) H1 -->
        <div id="print-section" class="bg-white p-6 rounded-lg shadow">
          <h1 class="text-3xl font-extrabold mb-2">area calculator</h1>

          <!-- 2) Intro -->
          <p class="text-gray-700 mb-6">
            Compute the area of common shapes—rectangle, triangle, circle, trapezoid, sector, and ellipse—with
            accessible inputs, clear LaTeX formulas, and instant unit conversions. Built for engineers, surveyors,
            educators, and anyone needing fast, reliable geometry.
          </p>

          <!-- 3) Calculator UI -->
          <section aria-labelledby="calcHeading">
            <h2 id="calcHeading" class="sr-only">Area calculator inputs</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Shape -->
              <div>
                <label for="shape" class="block text-sm font-medium text-gray-800">
                  Shape <span class="req" aria-hidden="true">*</span>
                </label>
                <div class="flex items-center gap-2">
                  <select id="shape" aria-required="true" aria-describedby="shapeTip shapeError"
                          class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md">
                    <option value="rectangle" selected>Rectangle</option>
                    <option value="triangle">Triangle</option>
                    <option value="circle">Circle</option>
                    <option value="trapezoid">Trapezoid</option>
                    <option value="sector">Circular sector</option>
                    <option value="ellipse">Ellipse</option>
                  </select>
                  <button type="button" class="px-3 rounded border" aria-expanded="false" aria-controls="shapeTip" id="shapeHelp" title="More info">?</button>
                </div>
                <p id="shapeTip" role="tooltip" class="text-sm text-gray-600 mt-2">
                  Pick a 2D shape. Inputs below adapt automatically.
                </p>
                <p id="shapeError" class="field-error" aria-live="polite"></p>
              </div>

              <!-- Units -->
              <div>
                <label for="unit" class="block text-sm font-medium text-gray-800">
                  Unit for dimensions <span class="req" aria-hidden="true">*</span>
                </label>
                <div class="flex items-center gap-2">
                  <select id="unit" aria-required="true" aria-describedby="unitTip unitError"
                          class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md">
                    <option value="mm">mm</option>
                    <option value="cm">cm</option>
                    <option value="m" selected>m</option>
                    <option value="in">in</option>
                    <option value="ft">ft</option>
                    <option value="yd">yd</option>
                  </select>
                  <button type="button" class="px-3 rounded border" aria-expanded="false" aria-controls="unitTip" id="unitHelp" title="More info">?</button>
                </div>
                <p id="unitTip" role="tooltip" class="text-sm text-gray-600 mt-2">
                  All inputs use this unit; results show conversions to m², ft², in², acres, and hectares.
                </p>
                <p id="unitError" class="field-error" aria-live="polite"></p>
              </div>

              <!-- Dynamic fields wrapper -->
              <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6" id="dynamicFields">
                <!-- Rectangle defaults -->
                <div>
                  <label for="length" class="block text-sm font-medium text-gray-800">
                    Length <span class="req" aria-hidden="true">*</span>
                  </label>
                  <input type="number" id="length" inputmode="decimal" step="any" min="0"
                         aria-required="true" aria-describedby="lengthTip lengthError"
                         class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md" />
                  <p id="lengthTip" role="tooltip" class="text-sm text-gray-600 mt-2">
                    Longest side for rectangles (or semi-major axis for ellipse).
                  </p>
                  <p id="lengthError" class="field-error" aria-live="polite"></p>
                </div>

                <div>
                  <label for="width" class="block text-sm font-medium text-gray-800">
                    Width <span class="req" aria-hidden="true">*</span>
                  </label>
                  <input type="number" id="width" inputmode="decimal" step="any" min="0"
                         aria-required="true" aria-describedby="widthTip widthError"
                         class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md" />
                  <p id="widthTip" role="tooltip" class="text-sm text-gray-600 mt-2">
                    Shorter side for rectangles (or semi-minor axis for ellipse).
                  </p>
                  <p id="widthError" class="field-error" aria-live="polite"></p>
                </div>
              </div>

              <!-- Action -->
              <div class="md:col-span-2 flex gap-3">
                <button id="calcBtn" class="btn bg-blue-600 hover:bg-blue-700 text-white font-semibold px-5 rounded-md" type="button">Calculate</button>
                <button id="resetBtn" class="btn border font-semibold px-5 rounded-md" type="button">Reset</button>
              </div>
            </div>
          </section>

          <!-- 4) Results -->
          <section id="results" aria-labelledby="resultsHeading" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6">
            <h2 id="resultsHeading" class="text-xl font-bold mb-4">Results</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
              <div class="result-card">
                <h4>Area (unit²)</h4>
                <p id="areaPrimary" aria-live="polite">—</p>
              </div>
              <div class="result-card">
                <h4>m²</h4>
                <p id="areaM2" aria-live="polite">—</p>
              </div>
              <div class="result-card">
                <h4>ft²</h4>
                <p id="areaFT2" aria-live="polite">—</p>
              </div>
              <div class="result-card">
                <h4>acres / hectares</h4>
                <p id="areaAcHa" aria-live="polite">—</p>
              </div>
            </div>

            <details class="mt-6 bg-white rounded-lg">
              <summary class="px-4 py-3">Show inputs used</summary>
              <div class="p-4 text-sm" id="echoInputs"></div>
            </details>
          </section>
        </div>

        <!-- 5) Authoritative content ecosystem -->
        <section class="bg-white p-6 rounded-lg shadow mt-8 prose">
          <!-- a) Data source & methodology -->
          <h2>Data Source & Methodology</h2>
          <p>
            <strong>AuthoritativeDataSource:</strong> Euclidean geometry formulas as documented in:
          </p>
          <ul>
            <li><em>CRC Standard Mathematical Tables and Formulas</em>, 32nd ed., CRC Press (2011).</li>
            <li>Weisstein, Eric W. “<a href="https://mathworld.wolfram.com/Area.html">Area</a>” and related shape pages, <em>MathWorld—A Wolfram Web Resource</em>.</li>
            <li>Exact metric definitions per SI Brochure (BIPM) and NIST: 1 in = 0.0254 m; 1 ft = 0.3048 m; 1 yd = 0.9144 m; 1 acre = 4046.8564224 m²; 1 hectare = 10,000 m².</li>
          </ul>
          <p><strong>“Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.”</strong></p>

          <!-- b) Formula explained -->
          <h2>The Formula Explained</h2>
          <div class="formula-box">
            <p><strong>Rectangle:</strong> \( A = \ell \times w \)</p>
            <p><strong>Triangle (base–height):</strong> \( A = \frac{1}{2} b h \)</p>
            <p><strong>Triangle (Heron):</strong> \( A = \sqrt{s(s-a)(s-b)(s-c)},\ \ s=\frac{a+b+c}{2} \)</p>
            <p><strong>Circle:</strong> \( A = \pi r^2 \)</p>
            <p><strong>Trapezoid:</strong> \( A = \frac{(b_1+b_2)}{2}\,h \)</p>
            <p><strong>Circular Sector (degrees):</strong> \( A = \frac{\theta}{360^\circ}\,\pi r^2 \) &nbsp; | &nbsp; <strong>(radians):</strong> \( A=\tfrac{1}{2}r^2\theta \)</p>
            <p><strong>Ellipse:</strong> \( A = \pi a b \) &nbsp; (with semi-axes \(a\) and \(b\))</p>
          </div>

          <!-- c) Glossary -->
          <h2>Glossary of Variables</h2>
          <ul>
            <li><strong>\(\ell\)</strong> – length; <strong>\(w\)</strong> – width</li>
            <li><strong>\(b\)</strong> – base; <strong>\(h\)</strong> – height (perpendicular)</li>
            <li><strong>\(a,b,c\)</strong> – triangle side lengths; <strong>\(s\)</strong> – semiperimeter</li>
            <li><strong>\(r\)</strong> – circle radius; <strong>\(\theta\)</strong> – sector angle</li>
            <li><strong>\(a\)</strong>, <strong>\(b\)</strong> (ellipse) – semi-major and semi-minor axes</li>
          </ul>

          <!-- d) Worked example -->
          <h2>How It Works: A Step-by-Step Example</h2>
          <p><strong>Scenario:</strong> A rectangular room is <em>6.25 m</em> by <em>3.4 m</em>. What’s the area?</p>
          <ol>
            <li>Choose <em>Rectangle</em> and unit <em>m</em>.</li>
            <li>Enter \( \ell=6.25 \), \( w=3.4 \).</li>
            <li>Apply \( A=\ell\times w \Rightarrow A=6.25\times 3.4=21.25\ \text{m}^2 \).</li>
            <li>Converted: \( 21.25\ \text{m}^2 \approx 228.50\ \text{ft}^2 \) and \( \approx 0.002125\ \text{ha} \).</li>
          </ol>

          <!-- e) FAQ -->
          <h2>Frequently Asked Questions</h2>
          <details>
            <summary>Which triangle formula should I use?</summary>
            <p>If you know base and height (perpendicular), use \(A=\tfrac12 b h\). If you only know three sides, use Heron’s formula.</p>
          </details>
          <details>
            <summary>What angle unit should I use for sectors?</summary>
            <p>Use degrees in \(A=\frac{\theta}{360^\circ}\pi r^2\) or radians in \(A=\tfrac12 r^2 \theta\). The calculator supports both.</p>
          </details>
          <details>
            <summary>Does unit choice affect accuracy?</summary>
            <p>No. Internally we convert to meters using exact definitions, then convert back for display.</p>
          </details>
          <details>
            <summary>What about irregular shapes?</summary>
            <p>Break them into simpler shapes and sum their areas, or use a GIS/polygon tool with coordinates for higher fidelity.</p>
          </details>
          <details>
            <summary>Surface area vs area?</summary>
            <p>Area is 2D. Surface area applies to 3D objects (sum of all face areas).</p>
          </details>

          <!-- 6) Authorship & Review -->
          <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong><br>
               Content verified by the CalcDomain Editorial Board.<br>
               Last accuracy review: <time datetime="2025-10-25">October 25, 2025</time></p>
          </div>
        </section>
      </section>

      <!-- Right column -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-4 space-y-6">
          <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
            Ad Placement (300×600)
          </div>

          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-bold text-lg mb-3">Why this calculator</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Professional formulas with LaTeX and step-by-step example.</li>
              <li>WCAG-compliant UI, keyboard friendly, clear errors.</li>
              <li>Instant unit conversions: m², ft², in², acres, hectares.</li>
            </ul>
          </div>

          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-bold text-lg mb-3">Related geometry tools</h3>
            <ul class="space-y-2 text-sm">
              <li><a class="text-blue-700 hover:underline" href="perimeter-calculator.html">Perimeter Calculator</a></li>
              <li><a class="text-blue-700 hover:underline" href="triangle-calculator.html">Triangle Calculator</a></li>
              <li><a class="text-blue-700 hover:underline" href="circle-calculator.html">Circle Calculator</a></li>
              <li><a class="text-blue-700 hover:underline" href="surface-area-calculator.html">Surface Area (3D)</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-4 lg:px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-700">About</a>
        <a href="contact.html" class="hover:text-blue-700">Contact</a>
        <a href="privacy.html" class="hover:text-blue-700">Privacy</a>
        <a href="terms.html" class="hover:text-blue-700">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator logic (defer near end) -->
  <script defer>
  (function(){
    const $ = (id)=>document.getElementById(id);

    // Elements
    const els = {
      menuToggle: $('menuToggle'),
      mobileNav: $('mobileNav'),
      shape: $('shape'),
      unit: $('unit'),
      shapeHelp: $('shapeHelp'),
      unitHelp: $('unitHelp'),
      dyn: $('dynamicFields'),
      calcBtn: $('calcBtn'),
      resetBtn: $('resetBtn'),
      // result fields
      areaPrimary: $('areaPrimary'),
      areaM2: $('areaM2'),
      areaFT2: $('areaFT2'),
      areaAcHa: $('areaAcHa'),
      echoInputs: $('echoInputs'),
      // error containers (dynamic & static)
      shapeError: $('shapeError'),
      unitError: $('unitError')
    };

    // Toggle mobile nav
    els.menuToggle?.addEventListener('click', ()=>{
      const isOpen = els.mobileNav.classList.toggle('hidden') ? false : true;
      els.menuToggle.setAttribute('aria-expanded', String(isOpen));
    });

    // Tooltips (toggle aria-expanded; content is always visible text for SR, but we track state)
    function wireToggle(btnId, panelId){
      const btn = $(btnId), panel = $(panelId);
      if(!btn || !panel) return;
      btn.addEventListener('click', ()=>{
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!expanded));
        // Keep panel visible for SR; visual visibility is already fine as static help.
      });
    }
    wireToggle('shapeHelp','shapeTip');
    wireToggle('unitHelp','unitTip');

    // Shape field definitions
    // Each field: { id, label, min, step, tooltip, required }
    const SHAPES = {
      rectangle: [
        { id:'length', label:'Length', tooltip:'Longer side of the rectangle.', required:true },
        { id:'width',  label:'Width',  tooltip:'Shorter side; perpendicular to length.', required:true }
      ],
      triangle: [
        { id:'base', label:'Base', tooltip:'Base length; use height perpendicular to this base.', required:true },
        { id:'height', label:'Height', tooltip:'Perpendicular height to the chosen base.', required:true }
      ],
      circle: [
        { id:'radius', label:'Radius', tooltip:'Distance from center to the circle edge.', required:true }
      ],
      trapezoid: [
        { id:'base1', label:'Base 1', tooltip:'One of the parallel sides.', required:true },
        { id:'base2', label:'Base 2', tooltip:'The other parallel side.', required:true },
        { id:'height', label:'Height', tooltip:'Perpendicular distance between the bases.', required:true }
      ],
      sector: [
        { id:'radius', label:'Radius', tooltip:'Distance from center to arc.', required:true },
        { id:'angle', label:'Angle', tooltip:'Sector angle. Choose unit below.', required:true },
        { id:'angleUnit', label:'Angle Unit', type:'select', options:[{v:'deg',t:'Degrees (°)'},{v:'rad',t:'Radians'}], required:true }
      ],
      ellipse: [
        { id:'a', label:'Semi-major axis (a)', tooltip:'Half of the longest diameter.', required:true },
        { id:'b', label:'Semi-minor axis (b)', tooltip:'Half of the shortest diameter.', required:true }
      ]
    };

    // Units to meters
    const U2M = { mm:1e-3, cm:1e-2, m:1, in:0.0254, ft:0.3048, yd:0.9144 };
    const M2_TO = {
      m2: 1,
      ft2: 1/(0.3048*0.3048),
      in2: 1/(0.0254*0.0254),
      acre: 1/4046.8564224,
      ha: 1/10000
    };

    // Helpers
    const nf = (v, d=6)=> Number.isFinite(v) ? (Math.abs(v)>=1000? v.toLocaleString(): v.toFixed(d).replace(/\.?0+$/,'')) : '—';

    function clearNode(node){ while(node.firstChild) node.removeChild(node.firstChild); }

    function fieldBlock(cfg){
      const wrap = document.createElement('div');
      const id = cfg.id;
      const label = document.createElement('label');
      label.setAttribute('for', id);
      label.className = 'block text-sm font-medium text-gray-800';
      label.innerHTML = `${cfg.label} ${cfg.required?'<span class="req" aria-hidden="true">*</span>':''}`;
      wrap.appendChild(label);

      let input;
      if(cfg.type === 'select'){
        input = document.createElement('select');
        for(const opt of cfg.options||[]){
          const o = document.createElement('option');
          o.value = opt.v; o.textContent = opt.t;
          input.appendChild(o);
        }
      } else {
        input = document.createElement('input');
        input.type = 'number'; input.step = 'any'; input.min = '0';
        input.inputMode = 'decimal';
      }
      input.id = id;
      input.className = 'mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md';
      input.setAttribute('aria-describedby', `${id}Tip ${id}Error`);
      if(cfg.required) input.setAttribute('aria-required','true');
      wrap.appendChild(input);

      const tip = document.createElement('p');
      tip.id = `${id}Tip`; tip.setAttribute('role','tooltip');
      tip.className = 'text-sm text-gray-600 mt-2';
      tip.textContent = cfg.tooltip || '';
      wrap.appendChild(tip);

      const err = document.createElement('p');
      err.id = `${id}Error`;
      err.className = 'field-error';
      err.setAttribute('aria-live','polite');
      wrap.appendChild(err);

      // Inline validation (on blur)
      input.addEventListener('blur', ()=> validateField(input, err, cfg));
      return wrap;
    }

    function renderFields(shape){
      const spec = SHAPES[shape] || [];
      clearNode(els.dyn);
      const grid = els.dyn;
      grid.className = 'md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6';
      spec.forEach(cfg => grid.appendChild(fieldBlock(cfg)));
    }

    function validateField(input, errEl, cfg){
      errEl.textContent = '';
      const v = (input.tagName === 'SELECT') ? input.value : input.valueAsNumber;
      if(cfg.required && (v===null || v===undefined || v==='' || (!Number.isFinite(v) && input.tagName!=='SELECT'))){
        errEl.textContent = 'This field is required. Enter a number.';
        return false;
      }
      if(input.tagName !== 'SELECT'){
        if(Number(v) < 0){
          errEl.textContent = 'Value must be zero or greater.';
          return false;
        }
      }
      return true;
    }

    function validateAll(){
      let ok = true;
      // static
      els.shapeError.textContent = '';
      els.unitError.textContent  = '';
      if(!els.shape.value){ els.shapeError.textContent='Please choose a shape.'; ok=false; }
      if(!els.unit.value || !(els.unit.value in U2M)){ els.unitError.textContent='Please choose a valid unit.'; ok=false; }
      // dynamic
      const spec = SHAPES[els.shape.value] || [];
      for(const cfg of spec){
        const input = $(cfg.id);
        const errEl = $(`${cfg.id}Error`);
        if(!validateField(input, errEl, cfg)) ok = false;
      }
      return ok;
    }

    function dimToMeters(val, unit){
      const f = U2M[unit];
      return Number(val) * f; // length in meters
    }

    function areaFromShape(shape, unit){
      const spec = SHAPES[shape] || [];
      const dims = {};
      for(const cfg of spec){
        const el = $(cfg.id);
        dims[cfg.id] = (el && el.tagName==='SELECT') ? el.value : el.valueAsNumber;
      }
      // compute area in input-unit^2 first, then convert to m²
      let A_unit2 = 0;
      switch(shape){
        case 'rectangle':
          A_unit2 = (dims.length||0)*(dims.width||0); break;
        case 'triangle':
          A_unit2 = 0.5*(dims.base||0)*(dims.height||0); break;
        case 'circle':
          A_unit2 = Math.PI*Math.pow(dims.radius||0,2); break;
        case 'trapezoid':
          A_unit2 = ((dims.base1||0)+(dims.base2||0))/2*(dims.height||0); break;
        case 'sector':
          if((dims.angleUnit||'deg')==='deg'){
            A_unit2 = ( (dims.angle||0)/360 ) * Math.PI * Math.pow(dims.radius||0,2);
          } else {
            A_unit2 = 0.5 * Math.pow(dims.radius||0,2) * (dims.angle||0);
          }
          break;
        case 'ellipse':
          A_unit2 = Math.PI*(dims.a||0)*(dims.b||0); break;
      }
      // Convert unit² to m²: (len*factor)^2 => A_m2 = A_unit2 * (U2M[unit]^2)
      const a_m2 = A_unit2 * Math.pow(U2M[unit], 2);
      return { A_unit2: A_unit2, A_m2: a_m2, dims };
    }

    function updateResults({A_unit2, A_m2}, unit, shape, dims){
      // Primary area (unit²)
      els.areaPrimary.textContent = Number.isFinite(A_unit2) ? `${nf(A_unit2)} ${unit}²` : '—';
      // Conversions
      const m2 = A_m2;
      const ft2 = m2 * M2_TO.ft2;
      const in2 = m2 * M2_TO.in2;
      const acre = m2 * M2_TO.acre;
      const ha = m2 * M2_TO.ha;
      els.areaM2.textContent = Number.isFinite(m2) ? `${nf(m2)} m²` : '—';
      els.areaFT2.textContent = Number.isFinite(ft2) ? `${nf(ft2)} ft²` : '—';
      els.areaAcHa.textContent = (Number.isFinite(acre) && Number.isFinite(ha)) ? `${nf(acre,6)} ac · ${nf(ha,6)} ha` : '—';

      // Echo back the inputs used (for print/export)
      const lines = [`<strong>Shape:</strong> ${shape}` , `<strong>Unit:</strong> ${unit}`];
      for(const k of Object.keys(dims)){
        lines.push(`<span>${k} = ${dims[k]}</span>`);
      }
      $('echoInputs').innerHTML = lines.map(x=>`<div>${x}</div>`).join('');
    }

    // Events
    els.shape.addEventListener('change', ()=>{
      renderFields(els.shape.value);
      // focus first new input for keyboarders
      setTimeout(()=>{
        const spec = SHAPES[els.shape.value]||[];
        if(spec[0]) $(spec[0].id)?.focus();
      },0);
    });

    els.calcBtn.addEventListener('click', ()=>{
      if(!validateAll()) return;
      const shape = els.shape.value, unit = els.unit.value;
      const res = areaFromShape(shape, unit);
      updateResults(res, unit, shape, res.dims);
    });

    els.resetBtn.addEventListener('click', ()=>{
      els.shape.value = 'rectangle';
      els.unit.value = 'm';
      renderFields('rectangle');
      els.areaPrimary.textContent = '—';
      els.areaM2.textContent = '—';
      els.areaFT2.textContent = '—';
      els.areaAcHa.textContent = '—';
      $('echoInputs').textContent = '';
      // Clear errors
      document.querySelectorAll('.field-error').forEach(n=>n.textContent='');
    });

    // Inline validation on blur for initial rectangle inputs
    // (Re-render default fields, set sensible example values to encourage interaction)
    renderFields('rectangle');
    const L = $('length'), W = $('width');
    if(L) L.value = 6.25;
    if(W) W.value = 3.4;

    // Accessible keyboard: Enter triggers calculation from inputs/selects
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){
        const target = e.target;
        if(target && (target.tagName==='INPUT' || target.tagName==='SELECT')){
          e.preventDefault();
          els.calcBtn.click();
        }
      }
    });
  })();
  </script>
</body>
</html>

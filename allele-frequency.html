<!DOCTYPE html>
<html lang="en"><head> 
<link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg" />
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png" />
<link rel="manifest" href="https://calcdomain.com/site.webmanifest" />
<meta charset="utf-8"https://calcdomain.com/>
<title>Allele Frequency Calculator | Hardy–Weinberg Equilibrium, MAF, Heterozygosity</title>
<meta content="width=device-width, initial-scale=1" name="viewport"https://calcdomain.com/>
<meta content="Allele frequency calculator for biology and population genetics. Compute p and q, expected genotype frequencies under Hardy–Weinberg equilibrium, heterozygosity, MAF, chi-square HWE test, and 95% CI." name="description"https://calcdomain.com/>
<meta content="Ugo Candido" name="author"https://calcdomain.com/>
<link href="https://calcdomain.com/allele-frequency.html" rel="canonical"https://calcdomain.com/>
<meta content="#005A9C" name="theme-color"https://calcdomain.com/>
<meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name="robots"https://calcdomain.com/>
<meta content="website" property="og:type"https://calcdomain.com/>
<meta content="Allele Frequency Calculator" property="og:title"https://calcdomain.com/>
<meta content="Compute allele frequencies (p, q), Hardy–Weinberg expected genotypes, heterozygosity, MAF, chi-square HWE test, and confidence intervals." property="og:description"https://calcdomain.com/>
<meta content="https://calcdomain.com/science/biology/allele-frequency-calculator" property="og:url"https://calcdomain.com/>
<meta content="CalcDomain" property="og:site_name"https://calcdomain.com/>
<meta content="en_US" property="og:locale"https://calcdomain.com/>
<meta content="summary" name="twitter:card"https://calcdomain.com/>
<meta content="Allele Frequency Calculator" name="twitter:title"https://calcdomain.com/>
<meta content="Professional-grade, WCAG-compliant allele frequency calculator with HWE testing and 95% CI." name="twitter:description"https://calcdomain.com/>
<link crossorigin="" href="https://cdn.jsdelivr.net" rel="preconnect"https://calcdomain.com/>
<link crossorigin="" href="https://polyfill.io" rel="preconnect"https://calcdomain.com/>
<style>
    /* Critical, mobile-first CSS (high-contrast, WCAG-friendly) */
    :root{
      --primary-color:#005A9C; --secondary-color:#003F6E; --accent-color:#00A4E4;
      --background-color:#F8F9FA; --surface-color:#FFFFFF;
      --text-color:#212529; --muted-text-color:#495057; --border-color:#DEE2E6;
      --success-color:#198754; --error-color:#DC3545; --warning-color:#FFC107;
      --touch-target-min:48px;
      --radius-6:6px; --radius-8:8px; --radius-12:12px;
      --container-max:980px;
    }
    @media (prefers-contrast: more){
      :root{ --primary-color:#00315c; --text-color:#000; --border-color:#000; --background-color:#fff; }
    }
    @media (prefers-reduced-motion: reduce){
      *{animation-duration:.01ms!important;transition-duration:.01ms!important;scroll-behavior:auto!important}
    }
    *,*::before,*::after{box-sizing:border-box}
    html{font-size:16px}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:var(--background-color); color:var(--text-color); line-height:1.6;
    }
    .skip-link{
      position:absolute;left:8px;top:-40px;background:var(--primary-color);color:#fff;
      padding:8px 12px;border-radius:0 0 6px 6px;text-decoration:none;font-weight:600;z-index:1000
    }
    .skip-link:focus{top:0}
    .container{max-width:var(--container-max);margin:0 auto;padding:0 1rem}
    h1{font-size:1.75rem;margin:.75rem 0;color:var(--secondary-color)}
    h2{font-size:1.375rem;margin:1.5rem 0 .75rem;color:var(--secondary-color)}
    h3{font-size:1.1rem;margin:1rem 0 .5rem;color:var(--secondary-color)}
    p{margin:.75rem 0;max-width:70ch}
    a{color:var(--primary-color)}
    a:focus{outline:3px solid var(--primary-color);outline-offset:2px;border-radius:4px}

    .calculator-layout{
      display:grid;grid-template-columns:1fr;gap:1.25rem;margin-top:.5rem
    }
    @media (min-width: 992px){
      .calculator-layout{grid-template-columns:420px 1fr}
    }
    .calculator-card{
      background:var(--surface-color);border:1px solid var(--border-color);
      border-radius:var(--radius-12);padding:1rem 1rem 1.25rem
    }
    .results-card{
      background:#fff;border:1px solid var(--border-color);
      border-radius:var(--radius-12);padding:1rem 1rem 1.25rem
    }
    .form-group{margin-bottom:1rem}
    label{display:block;font-weight:700;margin-bottom:.35rem}
    .inline-help{
      display:inline-flex;align-items:center;gap:.5rem
    }
    .help-btn{
      appearance:none;border:1px solid var(--border-color);background:#fff;color:var(--primary-color);
      border-radius:999px;width:28px;height:28px;min-width:28px;min-height:28px;line-height:1;
      display:inline-flex;align-items:center;justify-content:center;font-weight:700;cursor:pointer
    }
    .help-btn:focus{outline:3px solid var(--primary-color);outline-offset:2px}
    .tooltip{
      display:none;margin-top:.35rem;background:#eef6ff;border-left:4px solid var(--primary-color);
      padding:.5rem .75rem;border-radius:6px;color:#0b3d6b
    }
    .tooltip[aria-hidden="false"]{display:block}
    .input{width:100%;min-height:var(--touch-target-min);padding:.65rem .75rem;
      border:1px solid var(--border-color);border-radius:var(--radius-8);font-size:1rem;background:#fff
    }
    .input:focus{outline:3px solid var(--primary-color);outline-offset:2px;border-color:var(--primary-color)}
    .input[aria-invalid="true"]{border-color:var(--error-color)}
    .input::placeholder{color:#8a8f94}
    .error{color:var(--error-color);font-size:.9rem;margin-top:.3rem;min-height:1.25rem}
    fieldset{border:0;padding:0;margin:0}
    legend{position:absolute;left:-9999px}
    .radio-group{
      display:flex;gap:.5rem;border:1px solid var(--border-color);border-radius:8px;padding:.25rem
    }
    .radio-group input[type="radio"]{position:absolute;opacity:0;pointer-events:none}
    .radio-option{flex:1}
    .radio-option label{
      display:flex;align-items:center;justify-content:center;gap:.5rem;
      border-radius:6px;min-height:var(--touch-target-min);cursor:pointer;padding:.4rem .5rem
    }
    .radio-option input[type="radio"]:checked + label{
      background:var(--primary-color);color:#fff
    }
    .radio-option input[type="radio"]:focus + label{outline:3px solid var(--primary-color);outline-offset:2px}

    .actions{display:flex;gap:.5rem;flex-wrap:wrap}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;
      padding:.65rem 1rem;border-radius:8px;border:1px solid transparent;
      min-height:var(--touch-target-min);min-width:var(--touch-target-min);
      font-weight:700;cursor:pointer;text-decoration:none
    }
    .btn:focus{outline:3px solid var(--primary-color);outline-offset:2px}
    .btn-primary{background:var(--primary-color);color:#fff;border-color:var(--primary-color)}
    .btn-secondary{background:#fff;color:var(--primary-color);border-color:var(--primary-color)}
    .btn-ghost{background:transparent;color:var(--primary-color);border-color:transparent}

    .results-container{
      margin-top:.5rem;padding:.75rem;border:1px solid var(--border-color);
      border-radius:8px;background:var(--background-color);
      min-height:260px
    }
    .result-row{
      display:flex;justify-content:space-between;align-items:flex-start;
      padding:.5rem 0;border-bottom:1px solid var(--border-color)
    }
    .result-row:last-child{border-bottom:0}
    .result-label{color:var(--muted-text-color)}
    .result-value{font-weight:800;color:#0d6b2b}
    .result-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}

    .formula-box{
      background:#eef2f7;padding:1rem;border-radius:8px;border:1px solid var(--border-color);
      overflow:auto
    }
    .note{font-size:.95rem;color:var(--muted-text-color)}

    .author-box{
      margin-top:1.5rem;padding-top:1rem;border-top:1px solid var(--border-color);color:var(--muted-text-color);font-size:.95rem
    }
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0}
  </style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Allele Frequency Calculator",
  "description": "Interactive allele frequency calculator that computes p and q, Hardy–Weinberg expected genotype frequencies and counts, heterozygosity, minor allele frequency, chi-square HWE test, and 95% confidence intervals.",
  "url": "https://calcdomain.com/allele-frequency.html",
  "inLanguage": "en",
  "about": [
    {
      "@type": "Thing",
      "name": "Science"
    },
    {
      "@type": "Thing",
      "name": "Biology"
    },
    {
      "@type": "Thing",
      "name": "Population genetics"
    },
    {
      "@type": "Thing",
      "name": "Hardy–Weinberg equilibrium"
    }
  ],
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  },
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "How it works: a step-by-step example",
      "description": "Compute allele frequency p and expected genotype frequencies under Hardy–Weinberg from genotype counts.",
      "step": [
        {
          "@type": "HowToStep",
          "name": "Input genotype counts",
          "text": "Enter AA = 36, Aa = 48, aa = 16."
        },
        {
          "@type": "HowToStep",
          "name": "Compute sample size",
          "text": "N = AA + Aa + aa = 100."
        },
        {
          "@type": "HowToStep",
          "name": "Calculate allele frequencies",
          "text": "p = (2×AA + Aa)/(2N) = (2×36 + 48)/(200) = 0.60; q = 1 − p = 0.40."
        },
        {
          "@type": "HowToStep",
          "name": "Expected HWE genotypes",
          "text": "E[AA] = N×p^2 = 36; E[Aa] = N×2pq = 48; E[aa] = N×q^2 = 16."
        },
        {
          "@type": "HowToStep",
          "name": "Assess HWE",
          "text": "Chi-square(1 df) = Σ (O−E)^2/E = 0.00; p-value = 1.000 → no evidence of deviation."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is allele frequency?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Allele frequency is the proportion of all chromosomes in the population carrying a particular allele, denoted p for A and q for a in a two-allele system."
          }
        },
        {
          "@type": "Question",
          "name": "What assumptions underlie Hardy–Weinberg equilibrium?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Random mating, infinite/large population, no selection, no mutation, no migration, and no genetic drift."
          }
        },
        {
          "@type": "Question",
          "name": "Can I test for HWE from allele counts only?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Not exactly. Allele counts can give p and q, but without genotype counts you cannot perform a valid HWE goodness-of-fit test."
          }
        },
        {
          "@type": "Question",
          "name": "Why might my data deviate from HWE?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Population structure, assortative mating, selection, inbreeding, genotyping error, or small sample size."
          }
        },
        {
          "@type": "Question",
          "name": "What is MAF?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Minor allele frequency (MAF) is the frequency of the less common allele: min(p, q)."
          }
        },
        {
          "@type": "Question",
          "name": "What confidence interval is reported for p?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A Wilson score interval for k successes out of n=2N allele trials at 95% confidence."
          }
        },
        {
          "@type": "Question",
          "name": "Is this tool suitable for clinical diagnostics?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. It is intended for educational and research use. Clinical decisions require validated pipelines and expert oversight."
          }
        }
      ]
    }
  ]
}
  </script>
<!-- MathJax for LaTeX rendering (async, non-blocking) -->
<script defer="" src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer></script>
</head>
<body>

<a class="skip-link" href="#main-content">Skip to main content</a>
<main class="container" id="main-content" role="main">
<h1>Allele Frequency Calculator</h1>
<p>
      This professional-grade allele frequency calculator helps students, educators, and researchers compute allele frequencies (p and q), expected genotype frequencies under Hardy–Weinberg equilibrium (HWE), heterozygosity, minor allele frequency (MAF), a chi-square HWE test (when genotype counts are provided), and 95% confidence intervals — all with WCAG-compliant, mobile-first UX.
    </p>
<div aria-live="polite" class="calculator-layout">
<section aria-labelledby="calc-heading" class="calculator-card">
<h2 id="calc-heading">Interactive Calculator</h2>
<div class="form-group">
<fieldset>
<legend>Choose input mode</legend>
<div aria-label="Input mode" class="radio-group" role="radiogroup">
<div class="radio-option">
<input checked="" id="mode-genotype" name="mode" type="radio" value="genotype"https://calcdomain.com/>
<label for="mode-genotype">Genotype counts</label>
</div>
<div class="radio-option">
<input id="mode-allele" name="mode" type="radio" value="allele"https://calcdomain.com/>
<label for="mode-allele">Allele counts</label>
</div>
<div class="radio-option">
<input id="mode-p" name="mode" type="radio" value="p"https://calcdomain.com/>
<label for="mode-p">Known allele frequency p</label>
</div>
</div>
</fieldset>
</div>
<!-- GENOTYPE COUNTS MODE -->
<div aria-label="Genotype counts inputs" class="mode-group" id="group-genotype" role="group">
<div class="form-group">
<div class="inline-help">
<label for="inputAA">AA count *</label>
<button aria-controls="tipAA" aria-expanded="false" class="help-btn" tabindex="0" title="What is AA?" type="button">?</button>
</div>
<div aria-hidden="true" class="tooltip" id="tipAA">Number of individuals homozygous for allele A.</div>
<input aria-describedby="tipAA errAA" aria-required="true" class="input" id="inputAA" inputmode="numeric" min="0" placeholder="e.g., 36" step="1" type="number"https://calcdomain.com/>
<div aria-live="polite" class="error" id="errAA" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="inputAa">Aa count *</label>
<button aria-controls="tipAa" aria-expanded="false" class="help-btn" title="What is Aa?" type="button">?</button>
</div>
<div aria-hidden="true" class="tooltip" id="tipAa">Number of heterozygous individuals (one A and one a allele).</div>
<input aria-describedby="tipAa errAa" aria-required="true" class="input" id="inputAa" inputmode="numeric" min="0" placeholder="e.g., 48" step="1" type="number"https://calcdomain.com/>
<div aria-live="polite" class="error" id="errAa" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="inputaa">aa count *</label>
<button aria-controls="tipaa" aria-expanded="false" class="help-btn" title="What is aa?" type="button">?</button>
</div>
<div aria-hidden="true" class="tooltip" id="tipaa">Number of individuals homozygous for allele a.</div>
<input aria-describedby="tipaa erraa" aria-required="true" class="input" id="inputaa" inputmode="numeric" min="0" placeholder="e.g., 16" step="1" type="number"https://calcdomain.com/>
<div aria-live="polite" class="error" id="erraa" role="alert"></div>
</div>
</div>
<!-- ALLELE COUNTS MODE -->
<div aria-hidden="true" aria-label="Allele counts inputs" class="mode-group" hidden="" id="group-allele" role="group">
<div class="form-group">
<div class="inline-help">
<label for="inputCountA">Count of A alleles *</label>
<button aria-controls="tipCountA" aria-expanded="false" class="help-btn" title="A allele count help" type="button">?</button>
</div>
<div aria-hidden="true" class="tooltip" id="tipCountA">Total number of A alleles observed (across all chromosomes). Should be a non-negative integer.</div>
<input aria-describedby="tipCountA errCountA" aria-required="true" class="input" id="inputCountA" inputmode="numeric" min="0" placeholder="e.g., 120" step="1" type="number"https://calcdomain.com/>
<div aria-live="polite" class="error" id="errCountA" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="inputCounta">Count of a alleles *</label>
<button aria-controls="tipCounta" aria-expanded="false" class="help-btn" title="a allele count help" type="button">?</button>
</div>
<div aria-hidden="true" class="tooltip" id="tipCounta">Total number of a alleles observed. For diploid samples, the sum A+a should be even (2×N).</div>
<input aria-describedby="tipCounta errCounta" aria-required="true" class="input" id="inputCounta" inputmode="numeric" min="0" placeholder="e.g., 80" step="1" type="number"https://calcdomain.com/>
<div aria-live="polite" class="error" id="errCounta" role="alert"></div>
</div>
</div>
<!-- KNOWN P MODE -->
<div aria-hidden="true" aria-label="Known allele frequency inputs" class="mode-group" hidden="" id="group-p" role="group">
<div class="form-group">
<div class="inline-help">
<label for="inputP">Allele frequency p (for A) *</label>
<button aria-controls="tipP" aria-expanded="false" class="help-btn" title="p definition" type="button">?</button>
</div>
<div aria-hidden="true" class="tooltip" id="tipP">Proportion of chromosomes carrying allele A. Must be between 0 and 1.</div>
<input aria-describedby="tipP errP" aria-required="true" class="input" id="inputP" inputmode="decimal" max="1" min="0" placeholder="e.g., 0.6" step="0.0001" type="number"https://calcdomain.com/>
<div aria-live="polite" class="error" id="errP" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="inputN">Sample size N (individuals) *</label>
<button aria-controls="tipN" aria-expanded="false" class="help-btn" title="Why N?" type="button">?</button>
</div>
<div aria-hidden="true" class="tooltip" id="tipN">Number of diploid individuals to compute expected counts. Must be a positive integer.</div>
<input aria-describedby="tipN errN" aria-required="true" class="input" id="inputN" inputmode="numeric" min="1" placeholder="e.g., 100" step="1" type="number"https://calcdomain.com/>
<div aria-live="polite" class="error" id="errN" role="alert"></div>
</div>
</div>
<div aria-label="Calculator actions" class="actions" role="toolbar">
<button aria-label="Calculate results" class="btn btn-primary" id="btnCalculate" type="button">Calculate</button>
<button aria-label="Reset inputs" class="btn btn-secondary" id="btnReset" type="button">Reset</button>
</div>
</section>
<section aria-labelledby="results-heading" class="results-card">
<h2 id="results-heading">Results</h2>
<div aria-live="polite" class="results-container" id="results">
<div class="result-row">
<span class="result-label">Sample size (N)</span>
<span class="result-value result-mono" id="resN">—</span>
</div>
<div class="result-row">
<span class="result-label">Allele frequency p (A)</span>
<span class="result-value result-mono" id="resp">—</span>
</div>
<div class="result-row">
<span class="result-label">Allele frequency q (a)</span>
<span class="result-value result-mono" id="resq">—</span>
</div>
<div class="result-row">
<span class="result-label">Minor allele frequency (MAF)</span>
<span class="result-value result-mono" id="resMAF">—</span>
</div>
<div class="result-row">
<span class="result-label">Expected genotypes (HWE): AA, Aa, aa</span>
<span class="result-value result-mono" id="resExpected">—</span>
</div>
<div class="result-row">
<span class="result-label">Observed genotypes: AA, Aa, aa</span>
<span class="result-value result-mono" id="resObserved">—</span>
</div>
<div class="result-row">
<span class="result-label">Heterozygosity (2pq)</span>
<span class="result-value result-mono" id="resH">—</span>
</div>
<div class="result-row">
<span class="result-label">95% CI for p (Wilson)</span>
<span class="result-value result-mono" id="resCI">—</span>
</div>
<div class="result-row">
<span class="result-label">HWE chi-square (df=1), p-value</span>
<span class="result-value result-mono" id="resChi2">—</span>
</div>
<div class="result-row">
<span class="result-label">Interpretation</span>
<span class="result-value" id="resInterpret">Provide genotype counts to test HWE.</span>
</div>
</div>
<p class="note">Note: HWE test is computed only when observed genotype counts are provided and N &gt; 0 with valid expected counts.</p>
</section>
</div>
<section class="content">
<h2>Data Source and Methodology</h2>
<p>
        Authoritative sources:
      </p>
<ul>
<li>G.H. Hardy (1908), Mendelian proportions in a mixed population, Science 28(706):49–50. <a href="https://www.science.org/doi/10.1126/science.28.706.49" rel="noopener nofollow">Link</a></li>
<li>W. Weinberg (1908), Über den Nachweis der Vererbung beim Menschen, Jahreshefte des Vereins für vaterländische Naturkunde in Württemberg.</li>
<li>J.F. Crow and M. Kimura (1970), An Introduction to Population Genetics Theory. Harper &amp; Row.</li>
<li>Wigginton, Cutler, Abecasis (2005), A note on exact tests of Hardy–Weinberg equilibrium, AJHG 76:887–893. <a href="https://doi.org/10.1086/429864" rel="noopener">Link</a></li>
<li>Nature Education: Hardy–Weinberg Equilibrium. <a href="https://www.nature.com/scitable/definition/hardy-weinberg-equilibrium-122/" rel="noopener">Link</a></li>
</ul>
<p><strong>All calculations are strictly based on the formulas and data provided by these sources.</strong></p>
<h2>The Formula Explained</h2>
<div class="formula-box">
<p>If AA, Aa, aa are genotype counts and N = AA + Aa + aa:</p>
<p>Allele frequencies: $$p = \\frac{2\\,AA + Aa}{2N}, \\quad q = 1 - p$$</p>
<p>Hardy–Weinberg expected genotype frequencies: $$P(AA) = p^2,\\quad P(Aa) = 2pq,\\quad P(aa) = q^2$$</p>
<p>Expected counts: $$E[AA] = N p^2,\\quad E[Aa] = N (2pq),\\quad E[aa] = N q^2$$</p>
<p>Heterozygosity: $$H = 2pq$$</p>
<p>Goodness-of-fit statistic (chi-square): $$\\chi^2 = \\sum_{g\\in\\{AA,Aa,aa\\}} \\frac{(O_g - E_g)^2}{E_g} \\quad \\text{with 1 degree of freedom}$$</p>
<p>For df = 1, the p-value is: $$p\\text{-value} = \\operatorname{erfc}\\!\\left(\\sqrt{\\chi^2/2}\\right)$$</p>
<p>Wilson 95% CI for p using k A-alleles in n = 2N trials: $$\\hat{p}_W = \\frac{\\hat{p} + z^2/(2n)}{1 + z^2/n},\\quad \\text{margin} = \\frac{z}{1+z^2/n}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n} + \\frac{z^2}{4n^2}}$$</p>
</div>
<h2>Glossary of Variables</h2>
<ul>
<li>AA, Aa, aa: observed genotype counts.</li>
<li>N: sample size in individuals (N = AA + Aa + aa; for allele counts, N = (A + a)/2).</li>
<li>p: frequency of allele A; q: frequency of allele a (q = 1 − p).</li>
<li>MAF: minor allele frequency, min(p, q).</li>
<li>Expected counts: E[AA] = N p^2, E[Aa] = N 2pq, E[aa] = N q^2 (assuming HWE).</li>
<li>Heterozygosity (H): 2pq, the expected fraction of heterozygotes under HWE.</li>
<li>Chi-square and p-value: measure agreement between observed and expected genotypes under HWE (df = 1).</li>
<li>95% CI for p: Wilson interval treating 2N chromosomes as trials and number of A alleles as successes.</li>
</ul>
<h2>How It Works: A Step-by-Step Example</h2>
<p>Suppose you observed AA = 36, Aa = 48, aa = 16 (N = 100). Then:</p>
<ol>
<li>Compute p: p = (2×36 + 48) / (2×100) = 0.60; q = 0.40.</li>
<li>Expected genotype frequencies: AA = p^2 = 0.36, Aa = 2pq = 0.48, aa = q^2 = 0.16.</li>
<li>Expected counts: E[AA] = 36, E[Aa] = 48, E[aa] = 16.</li>
<li>HWE test: χ² = Σ (O−E)²/E = 0; p-value = 1 → no evidence against HWE.</li>
<li>MAF = min(0.60, 0.40) = 0.40; Heterozygosity = 2pq = 0.48. The 95% CI for p is computed using the Wilson method.</li>
</ol>
<h2>Frequently Asked Questions (FAQ)</h2>
<details>
<summary>What input should I use: genotype counts, allele counts, or p?</summary>
<p>Use genotype counts to compute everything including an HWE test. If you only have allele counts, you can compute p and expected genotypes but not a valid HWE test. If you already know p and N, you can generate expected counts and heterozygosity.</p>
</details>
<details>
<summary>When is the chi-square HWE test appropriate?</summary>
<p>It is appropriate for bi-allelic loci with sufficiently large expected counts (common rule of thumb: all expected ≥ 5). For small samples or rare alleles, consider exact tests (e.g., Wigginton et al., 2005).</p>
</details>
<details>
<summary>How is the 95% CI for p calculated?</summary>
<p>We use a Wilson score interval treating the 2N chromosomes as binomial trials with k = 2×AA + Aa A-alleles.</p>
</details>
<details>
<summary>Can I change allele labels?</summary>
<p>This tool uses A and a for clarity. You can map them to your locus alleles (e.g., reference vs alternate).</p>
</details>
<details>
<summary>Why do I get “even sum required” with allele counts?</summary>
<p>In diploid organisms, the total number of alleles is 2×N. Therefore, A + a must be even to correspond to an integer number of individuals.</p>
</details>
<details>
<summary>Is deviation from HWE always biologically meaningful?</summary>
<p>No. Deviations can arise from technical issues (e.g., genotyping error) or sampling noise, not only from evolutionary forces. Always consider context and replicate data quality checks.</p>
</details>
<div class="author-box">
<p>Tool developed by <strong>Ugo Candido</strong>. Content verified by <strong>CalcDomain Editorial Board</strong>.<br/>
        Last reviewed for accuracy on: <time datetime="2025-09-15">September 15, 2025</time>.</p>
</div>
</section>
</main>
<script defer="">
    (function(){
      'use strict';

      // Utility functions
      function clamp(x, min, max){ return Math.min(Math.max(x, min), max); }
      function formatFloat(x, digits=4){ return Number.isFinite(x) ? x.toFixed(digits) : '—'; }
      function formatInt(x){ return Number.isFinite(x) ? Math.round(x).toString() : '—'; }

      // Error helpers
      function setError(inputEl, errEl, msg){
        if(!inputEl || !errEl) return;
        inputEl.setAttribute('aria-invalid', msg ? 'true' : 'false');
        errEl.textContent = msg || '';
      }

      // Show/hide mode groups
      const modeRadios = Array.from(document.querySelectorAll('input[name="mode"]'));
      const groups = {
        genotype: document.getElementById('group-genotype'),
        allele: document.getElementById('group-allele'),
        p: document.getElementById('group-p')
      };

      function switchMode(mode){
        Object.keys(groups).forEach(key=>{
          const g = groups[key];
          const active = key === mode;
          if(active){
            g.hidden = false;
            g.setAttribute('aria-hidden','false');
            Array.from(g.querySelectorAll('input')).forEach(i=>i.disabled=false);
          }else{
            g.hidden = true;
            g.setAttribute('aria-hidden','true');
            Array.from(g.querySelectorAll('input')).forEach(i=>i.disabled=true);
          }
        });
        // Update interpretation for non-genotype modes
        if(mode !== 'genotype'){
          setResultText('resObserved','—');
          setResultText('resChi2','—');
          setResultText('resInterpret','Provide genotype counts to test HWE.');
        }
        calculate(); // recalc immediately
      }

      modeRadios.forEach(r=>{
        r.addEventListener('change', e=> switchMode(e.target.value));
      });

      // Tooltip toggles
      function initTooltips(){
        const buttons = document.querySelectorAll('.help-btn');
        buttons.forEach(btn=>{
          const id = btn.getAttribute('aria-controls');
          const tip = document.getElementById(id);
          if(!tip) return;
          btn.addEventListener('click', ()=>{
            const expanded = btn.getAttribute('aria-expanded') === 'true';
            btn.setAttribute('aria-expanded', (!expanded).toString());
            tip.setAttribute('aria-hidden', expanded ? 'true' : 'false');
          });
          btn.addEventListener('keydown', (e)=>{
            if(e.key === 'Enter' || e.key === ' '){
              e.preventDefault(); btn.click();
            }
          });
        });
      }

      // Inputs and validation
      const inputAA = document.getElementById('inputAA');
      const inputAa = document.getElementById('inputAa');
      const inputaa = document.getElementById('inputaa');

      const errAA = document.getElementById('errAA');
      const errAa = document.getElementById('errAa');
      const erraa = document.getElementById('erraa');

      const inputCountA = document.getElementById('inputCountA');
      const inputCounta = document.getElementById('inputCounta');
      const errCountA = document.getElementById('errCountA');
      const errCounta = document.getElementById('errCounta');

      const inputP = document.getElementById('inputP');
      const inputN = document.getElementById('inputN');
      const errP = document.getElementById('errP');
      const errN = document.getElementById('errN');

      function parseIntSafe(el){ const v = Number(el.value); return Number.isFinite(v) ? Math.floor(v) : NaN; }
      function parseFloatSafe(el){ const v = Number(el.value); return Number.isFinite(v) ? v : NaN; }

      function validateGenotypes(){
        let ok = true;
        const AA = parseIntSafe(inputAA);
        const Aa = parseIntSafe(inputAa);
        const aa = parseIntSafe(inputaa);

        if(inputAA.value === '' || isNaN(AA) || AA < 0){ setError(inputAA, errAA, 'Please enter a non-negative integer.'); ok = false; } else setError(inputAA, errAA, '');
        if(inputAa.value === '' || isNaN(Aa) || Aa < 0){ setError(inputAa, errAa, 'Please enter a non-negative integer.'); ok = false; } else setError(inputAa, errAa, '');
        if(inputaa.value === '' || isNaN(aa) || aa < 0){ setError(inputaa, erraa, 'Please enter a non-negative integer.'); ok = false; } else setError(inputaa, erraa, '');

        const N = (!isNaN(AA) && !isNaN(Aa) && !isNaN(aa)) ? (AA + Aa + aa) : 0;
        if(ok && N === 0){ setError(inputAA, errAA, 'At least one count must be > 0.'); ok = false; }
        return ok;
      }

      function validateAlleleCounts(){
        let ok = true;
        const A = parseIntSafe(inputCountA);
        const a = parseIntSafe(inputCounta);

        if(inputCountA.value === '' || isNaN(A) || A < 0){ setError(inputCountA, errCountA, 'Enter a non-negative integer.'); ok = false; } else setError(inputCountA, errCountA, '');
        if(inputCounta.value === '' || isNaN(a) || a < 0){ setError(inputCounta, errCounta, 'Enter a non-negative integer.'); ok = false; } else setError(inputCounta, errCounta, '');

        const total = (!isNaN(A) && !isNaN(a)) ? (A + a) : 0;
        if(ok && total === 0){ setError(inputCountA, errCountA, 'A + a must be > 0.'); ok = false; }
        if(ok && total % 2 !== 0){ setError(inputCounta, errCounta, 'For diploids, A + a must be even (2×N).'); ok = false; }
        return ok;
      }

      function validateKnownP(){
        let ok = true;
        const p = parseFloatSafe(inputP);
        const N = parseIntSafe(inputN);

        if(inputP.value === '' || isNaN(p) || p < 0 || p > 1){
          setError(inputP, errP, 'Enter a value between 0 and 1.');
          ok = false;
        } else { setError(inputP, errP, ''); }

        if(inputN.value === '' || isNaN(N) || N < 1){
          setError(inputN, errN, 'Enter a positive integer.');
          ok = false;
        } else { setError(inputN, errN, ''); }

        return ok;
      }

      [inputAA,inputAa,inputaa,inputCountA,inputCounta,inputP,inputN].forEach(el=>{
        if(!el) return;
        el.addEventListener('blur', ()=>calculate());
        el.addEventListener('input', ()=>{/* live update for responsiveness */});
      });

      // Results setters
      function setResultText(id, text){ const el = document.getElementById(id); if(el) el.textContent = text; }

      // Math functions
      function heterozygosity(p){ return 2*p*(1-p); }
      function chiSquarePValueDf1(chi2){
        if(!(chi2 >= 0)) return NaN;
        const t = Math.sqrt(chi2/2);
        // erfc approximation
        return erfc(t);
      }
      // Numerical approx for erfc
      function erfc(x){
        // Abramowitz & Stegun 7.1.26
        const z = Math.abs(x);
        const t = 1 / (1 + 0.5*z);
        const ans = t * Math.exp(-z*z - 1.26551223 + t*(1.00002368 + t*(0.37409196 +
          t*(0.09678418 + t*(-0.18628806 + t*(0.27886807 +
          t*(-1.13520398 + t*(1.48851587 + t*(-0.82215223 + t*0.17087277)))))))))
        return x >= 0 ? ans : 2 - ans;
      }

      function wilsonCI(k, n, z=1.96){
        if(!(n > 0)) return [NaN, NaN];
        const phat = k / n;
        const z2n = (z*z)/n;
        const denom = 1 + z2n;
        const center = (phat + (z*z)/(2*n)) / denom;
        const margin = (z/denom) * Math.sqrt( (phat*(1-phat)/n) + ((z*z)/(4*n*n)) );
        let lo = center - margin, hi = center + margin;
        lo = Math.max(0, lo); hi = Math.min(1, hi);
        return [lo, hi];
      }

      // Main calculation
      function calculate(){
        const mode = (document.querySelector('input[name="mode"]:checked')||{}).value || 'genotype';

        let N = NaN, p = NaN, q = NaN, MAF = NaN, H = NaN;
        let EAA = NaN, EAa = NaN, Eaa = NaN;
        let OAA = NaN, OAa = NaN, Oaa = NaN;
        let chi2 = NaN, pval = NaN;
        let ciLo = NaN, ciHi = NaN;

        if(mode === 'genotype'){
          if(!validateGenotypes()){
            setOutputsBlank();
            return;
          }
          OAA = parseIntSafe(inputAA);
          OAa = parseIntSafe(inputAa);
          Oaa = parseIntSafe(inputaa);
          N = OAA + OAa + Oaa;
          const kA = 2*OAA + OAa; // number of A alleles
          const nAlleles = 2*N;
          p = kA / nAlleles; q = 1 - p;
          H = heterozygosity(p);
          EAA = N * p*p; EAa = N * (2*p*q); Eaa = N * q*q;
          // Chi-square with df=1 if all expected > 0
          if(EAA > 0 && EAa > 0 && Eaa > 0){
            chi2 = ((OAA-EAA)**2)/EAA + ((OAa-EAa)**2)/EAa + ((Oaa-Eaa)**2)/Eaa;
            pval = chiSquarePValueDf1(chi2);
          }
          const [lo, hi] = wilsonCI(kA, nAlleles, 1.96);
          ciLo = lo; ciHi = hi;
          MAF = Math.min(p, q);
        } else if(mode === 'allele'){
          if(!validateAlleleCounts()){
            setOutputsBlank();
            return;
          }
          const A = parseIntSafe(inputCountA);
          const a = parseIntSafe(inputCounta);
          const total = A + a;
          N = total / 2;
          p = A / total; q = 1 - p;
          H = heterozygosity(p);
          EAA = N * p*p; EAa = N * (2*p*q); Eaa = N * q*q;
          const [lo, hi] = wilsonCI(A, total, 1.96);
          ciLo = lo; ciHi = hi;
          MAF = Math.min(p, q);
        } else { // known p
          if(!validateKnownP()){
            setOutputsBlank();
            return;
          }
          p = parseFloatSafe(inputP);
          q = 1 - p;
          N = parseIntSafe(inputN);
          H = heterozygosity(p);
          EAA = N * p*p; EAa = N * (2*p*q); Eaa = N * q*q;
          // CI cannot be computed without allele counts
          ciLo = NaN; ciHi = NaN;
          MAF = Math.min(p, q);
        }

        // Display
        setResultText('resN', Number.isFinite(N) ? formatInt(N) : '—');
        setResultText('resp', Number.isFinite(p) ? formatFloat(p,4) : '—');
        setResultText('resq', Number.isFinite(q) ? formatFloat(q,4) : '—');
        setResultText('resMAF', Number.isFinite(MAF) ? formatFloat(MAF,4) : '—');
        setResultText('resExpected', (Number.isFinite(EAA)&&Number.isFinite(EAa)&&Number.isFinite(Eaa)) ? `${formatFloat(EAA,2)}, ${formatFloat(EAa,2)}, ${formatFloat(Eaa,2)}` : '—');
        setResultText('resObserved', (Number.isFinite(OAA)||Number.isFinite(OAa)||Number.isFinite(Oaa)) && !isNaN(OAA) ? `${formatInt(OAA)}, ${formatInt(OAa)}, ${formatInt(Oaa)}` : '—');
        setResultText('resH', Number.isFinite(H) ? formatFloat(H,4) : '—');
        setResultText('resCI', (Number.isFinite(ciLo)&&Number.isFinite(ciHi)) ? `[${formatFloat(ciLo,4)}, ${formatFloat(ciHi,4)}]` : '—');
        if(Number.isFinite(chi2) && Number.isFinite(pval)){
          setResultText('resChi2', `${formatFloat(chi2,4)}, p = ${formatFloat(pval,4)}`);
          const interp = (pval < 0.05) ? 'Evidence of deviation from HWE (p < 0.05).' : 'No evidence of deviation from HWE (p ≥ 0.05).';
          setResultText('resInterpret', interp);
        } else {
          setResultText('resChi2', '—');
          if((document.querySelector('input[name="mode"]:checked')||{}).value === 'genotype'){
            setResultText('resInterpret', 'Insufficient expected counts to compute chi-square or invalid inputs.');
          } else {
            setResultText('resInterpret', 'Provide genotype counts to test HWE.');
          }
        }
      }

      function setOutputsBlank(){
        setResultText('resN','—');
        setResultText('resp','—');
        setResultText('resq','—');
        setResultText('resMAF','—');
        setResultText('resExpected','—');
        setResultText('resObserved','—');
        setResultText('resH','—');
        setResultText('resCI','—');
        setResultText('resChi2','—');
        setResultText('resInterpret','Check inputs; errors are highlighted above.');
      }

      // Bind buttons
      document.getElementById('btnCalculate').addEventListener('click', calculate);
      document.getElementById('btnReset').addEventListener('click', ()=>{
        [inputAA,inputAa,inputaa,inputCountA,inputCounta,inputP,inputN].forEach(el=>{ if(el){ el.value=''; el.setAttribute('aria-invalid','false'); } });
        [errAA,errAa,erraa,errCountA,errCounta,errP,errN].forEach(e=>{ if(e){ e.textContent=''; } });
        setOutputsBlank();
      });

      // Initialize
      initTooltips();
      switchMode('genotype');
      // Provide example defaults for instant demo (optional – comment out if undesired)
      inputAA.value = '36'; inputAa.value = '48'; inputaa.value = '16'; calculate();
    })();
  </script>


<script defer src="https://calcdomain.com/assets/js/mobile-menu.js"></script>
<script defer src="https://calcdomain.com/assets/js/page-enhancements.js"></script>
</body></html>
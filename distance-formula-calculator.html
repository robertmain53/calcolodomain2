<!DOCTYPE html>
<html lang="en">
<head>
<link rel="canonical" href="https://calcdomain.com/distance-formula-calculator">





  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Distance Formula Calculator — Find the Distance Between Two Points</title>
  <meta name="description" content="Compute the distance between two points using the Euclidean distance formula. Supports 2D, 3D, and n-dimensional vectors, with step-by-step explanation, plot, glossary, and FAQs." />
  

  <!-- Icons / Manifest -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Fonts & Tailwind -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com" defer></script>

  <!-- MathJax for LaTeX -->
  <script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root {
      --brand: #2563eb; /* blue-600 */
      --brand-strong: #1d4ed8; /* blue-700 */
      --surface: #ffffff;
      --muted: #6b7280; /* gray-500 */
      --border: #e5e7eb; /* gray-200 */
      --bg: #f9fafb; /* gray-50 */
      --ok: #047857; /* emerald-700 */
      --warn: #b45309; /* amber-700 */
      --err: #b91c1c; /* red-700 */
      --focus: #7c3aed; /* violet-600 for focus ring */
    }
    html, body { background: var(--bg); color:#111827; font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif; }
    /* Readable content width */
    .prose { max-width: 70ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: 0.75rem; }
    .prose h3 { font-size: 1.125rem; font-weight: 700; margin-top: 1.25rem; margin-bottom: 0.5rem; }
    .prose p, .prose li { line-height: 1.7; }
    .formula-box {
      background:#f3f4f6; border:1px solid #d1d5db; border-radius:12px; padding:1rem;
      overflow-x:auto; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    /* Visible, high-contrast focus */
    :where(a, button, [role="button"], input, select, textarea, summary):focus {
      outline: 3px solid var(--focus);
      outline-offset: 2px;
    }
    /* Minimum target sizes on touch */
    button, .btn, input[type="number"], input[type="text"], select {
      min-height: 48px;
    }
    /* Error / help text */
    .hint { font-size: 0.875rem; color: var(--muted); }
    .error { color: var(--err); }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }
    /* Tooltip bubble */
    .tooltip {
      display: none;
      margin-top: .5rem;
      border: 1px dashed var(--border);
      background: #fff;
      padding: .75rem;
      border-radius: .5rem;
      color:#1f2937;
    }
    .tooltip[data-open="true"] { display: block; }
    /* Results container min-height to prevent CLS */
    #results { min-height: 180px; }
    /* Print */
    @media print {
      header, footer, aside, #plotWrap { display: none !important; }
      main { padding: 0 !important; }
      #print-section { position: static !important; }
    }
  </style>

  <!-- JSON-LD: WebPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Distance Formula Calculator",
    "url": "https://calcdomain.com/distance-formula-calculator",
    "inLanguage": "en",
    "description": "Compute the Euclidean distance between two points in 2D/3D/nD with a step-by-step explanation, glossary, and plotting.",
    "author": { "@type": "Person", "name": "Ugo Candido" },
    "publisher": { "@type": "Organization", "name": "CalcDomain" }
  }
  </script>

  <!-- JSON-LD: WebApplication (Calculator) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Distance Formula Calculator",
    "applicationCategory": "EducationalApplication",
    "operatingSystem": "Any",
    "url": "https://calcdomain.com/distance-formula-calculator",
    "creator": { "@type": "Person", "name": "Ugo Candido" },
    "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
  }
  </script>

  <!-- JSON-LD: BreadcrumbList -->
  <script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Math & Conversions",
      "item": "https://calcdomain.com/math-conversions"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Algebra",
      "item": "https://calcdomain.com/subcategories/core-math-algebra"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "Distance Formula Calculator",
      "item": "https://calcdomain.com/distance-formula-calculator"
    }
  ]
}</script>

  <!-- JSON-LD: HowTo (step-by-step example) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to calculate distance between two points",
    "description":"Step-by-step guide for using the Euclidean distance formula.",
    "step":[
      {"@type":"HowToStep","name":"Enter point A","text":"Type x1 and y1 (and z1 if needed)."},
      {"@type":"HowToStep","name":"Enter point B","text":"Type x2 and y2 (and z2 if needed)."},
      {"@type":"HowToStep","name":"Select mode","text":"Choose 2D, 3D or nD vector mode."},
      {"@type":"HowToStep","name":"Calculate","text":"The calculator applies the Euclidean formula and shows the numeric result and steps."}
    ]
  }
  </script>

  <!-- JSON-LD: FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What is the distance formula?","acceptedAnswer":{"@type":"Answer","text":"It is the Euclidean distance between two points: d = sqrt((x2−x1)^2 + (y2−y1)^2) in 2D; add (z2−z1)^2 for 3D."}},
      {"@type":"Question","name":"Can I compute distance in 3D?","acceptedAnswer":{"@type":"Answer","text":"Yes. Enable 3D and enter z-coordinates; the tool uses the 3D Euclidean formula."}},
      {"@type":"Question","name":"Does this support n-dimensional vectors?","acceptedAnswer":{"@type":"Answer","text":"Yes. Use vector mode and paste equal-length vectors (comma or space separated)."}},
      {"@type":"Question","name":"What about midpoint and slope?","acceptedAnswer":{"@type":"Answer","text":"The tool also reports the midpoint; slope is shown for 2D when defined (x2 ≠ x1)."}},
      {"@type":"Question","name":"How accurate are results?","acceptedAnswer":{"@type":"Answer","text":"Results are computed in double precision and rounded for display. You can toggle more decimals in Advanced options."}},
      {"@type":"Question","name":"Which formula source do you use?","acceptedAnswer":{"@type":"Answer","text":"Standard Euclidean metric as covered in university Algebra/Analytic Geometry texts (see the data source section below)."}}
    ]
  }
  </script>
</head>
<body>
  <!-- Header (non-sticky for mobile space) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a href="https://calcdomain.com" class="text-xl font-extrabold text-blue-600">CalcDomain</a>
      <div class="hidden md:flex items-center gap-6 text-sm">
        <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
        Categories
      </div>
      <button class="md:hidden p-2 rounded hover:bg-gray-100" aria-label="Open menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <section class="w-full lg:w-2/3">
        <!-- Breadcrumb -->
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo;
          <a href="https://calcdomain.com/math" class="hover:text-blue-600">Math</a> &raquo;
          <a href="https://calcdomain.com/subcategories/core-math-algebra" class="hover:text-blue-600">Algebra</a> &raquo;
          <span class="text-gray-900">Distance Formula Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-xl shadow">
          <h1 class="text-3xl font-extrabold mb-2">distance formula calculator</h1>
          <p class="text-gray-700 mb-6">
            Compute the straight-line (Euclidean) distance between two points. Built for students, engineers, and analysts,
            it supports 2D, 3D, and n-dimensional vectors, shows steps, midpoint and slope (2D), and draws a quick plot.
          </p>

          <!-- Calculator -->
          <section id="calculator" class="space-y-6" aria-labelledby="calcHeading">
            <h2 id="calcHeading" class="sr-only">Calculator inputs</h2>

            <!-- Mode -->
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
              <div>
                <label for="mode" class="block font-medium text-gray-900">
                  Mode <span aria-hidden="true" class="text-red-700">*</span>
                </label>
                <select id="mode" aria-required="true"
                        class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                        aria-describedby="mode-hint">
                  <option value="2d" selected>2D (x, y)</option>
                  <option value="3d">3D (x, y, z)</option>
                  <option value="nd">nD (vectors)</option>
                </select>
                <p id="mode-hint" class="hint mt-1">Choose 2D, 3D, or paste vectors for nD.</p>
              </div>

              <div>
                <label for="decimals" class="block font-medium text-gray-900">
                  Decimals
                  <button class="ml-2 inline-flex items-center justify-center w-7 h-7 rounded border border-gray-300 text-sm"
                          type="button" aria-expanded="false" aria-controls="decimals-tip" data-tooltip>
                    ?
                  </button>
                </label>
                <input id="decimals" type="number" inputmode="numeric" min="0" max="12" step="1" value="4"
                       class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                       aria-describedby="decimals-tip">
                <div id="decimals-tip" class="tooltip" role="note">
                  Controls the number of decimals shown. Computation uses full precision; this only affects display.
                </div>
              </div>

              <div>
                <label for="units" class="block font-medium text-gray-900">
                  Units (optional)
                </label>
                <input id="units" type="text" placeholder="m, km, ft, etc."
                       class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                       aria-describedby="units-hint">
                <p id="units-hint" class="hint mt-1">Purely a label appended to results.</p>
              </div>
            </div>

            <!-- 2D / 3D Inputs -->
            <div id="cartesianWrap" class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label for="x1" class="block font-medium text-gray-900">
                  x₁ <span aria-hidden="true" class="text-red-700">*</span>
                  <button class="ml-2 inline-flex items-center justify-center w-7 h-7 rounded border border-gray-300 text-sm"
                          type="button" aria-expanded="false" aria-controls="x1-tip" data-tooltip>?</button>
                </label>
                <input id="x1" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                       aria-describedby="x1-tip x1-err" value="0">
                <p id="x1-tip" class="tooltip" role="note">Enter any real number. Scientific notation allowed.</p>
                <p id="x1-err" class="hint error mt-1" aria-live="polite"></p>
              </div>

              <div>
                <label for="y1" class="block font-medium text-gray-900">
                  y₁ <span aria-hidden="true" class="text-red-700">*</span>
                </label>
                <input id="y1" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                       aria-describedby="y1-err" value="0">
                <p id="y1-err" class="hint error mt-1" aria-live="polite"></p>
              </div>

              <div id="z1Wrap" class="hidden">
                <label for="z1" class="block font-medium text-gray-900">
                  z₁ <span aria-hidden="true" class="text-red-700">*</span>
                </label>
                <input id="z1" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                       aria-describedby="z1-err" value="0">
                <p id="z1-err" class="hint error mt-1" aria-live="polite"></p>
              </div>

              <div>
                <label for="x2" class="block font-medium text-gray-900">
                  x₂ <span aria-hidden="true" class="text-red-700">*</span>
                </label>
                <input id="x2" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                       aria-describedby="x2-err" value="3">
                <p id="x2-err" class="hint error mt-1" aria-live="polite"></p>
              </div>

              <div>
                <label for="y2" class="block font-medium text-gray-900">
                  y₂ <span aria-hidden="true" class="text-red-700">*</span>
                </label>
                <input id="y2" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                       aria-describedby="y2-err" value="4">
                <p id="y2-err" class="hint error mt-1" aria-live="polite"></p>
              </div>

              <div id="z2Wrap" class="hidden">
                <label for="z2" class="block font-medium text-gray-900">
                  z₂ <span aria-hidden="true" class="text-red-700">*</span>
                </label>
                <input id="z2" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                       aria-describedby="z2-err" value="0">
                <p id="z2-err" class="hint error mt-1" aria-live="polite"></p>
              </div>
            </div>

            <!-- nD Inputs -->
            <div id="vectorWrap" class="hidden grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="v1" class="block font-medium text-gray-900">
                  Vector A (x₁, y₁, …)
                </label>
                <textarea id="v1" rows="3" placeholder="e.g., 1, -2, 5"
                          class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                          aria-describedby="v1-err"></textarea>
                <p id="v1-err" class="hint error mt-1" aria-live="polite"></p>
              </div>
              <div>
                <label for="v2" class="block font-medium text-gray-900">
                  Vector B (x₂, y₂, …)
                </label>
                <textarea id="v2" rows="3" placeholder="e.g., 4, 3, 1"
                          class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                          aria-describedby="v2-err"></textarea>
                <p id="v2-err" class="hint error mt-1" aria-live="polite"></p>
              </div>
              <p class="hint md:col-span-2">Use commas or spaces. Both vectors must have the same length.</p>
            </div>

            <div class="flex flex-wrap items-center gap-3">
              <button id="calcBtn" type="button"
                class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-5 py-3 rounded-md">
                Calculate
              </button>
              <button id="resetBtn" type="button"
                class="border border-gray-300 hover:bg-gray-50 font-medium px-5 py-3 rounded-md">
                Reset
              </button>
            </div>
          </section>

          <!-- Results -->
          <section id="results" class="mt-6 bg-blue-50 border border-blue-100 rounded-xl p-5">
            <h2 class="text-lg font-semibold text-blue-900 mb-3">Results</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="bg-white border border-gray-200 rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-500">Distance</h3>
                <p id="distanceOut" class="text-2xl font-extrabold text-blue-700">—</p>
                <p id="distanceExact" class="text-xs text-gray-600 mt-1"></p>
              </div>
              <div class="bg-white border border-gray-200 rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-500">Midpoint (2D/3D)</h3>
                <p id="midpointOut" class="text-lg font-bold text-gray-800">—</p>
              </div>
              <div class="bg-white border border-gray-200 rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-500">Slope (2D)</h3>
                <p id="slopeOut" class="text-lg font-bold text-gray-800">—</p>
              </div>
            </div>

            <details class="mt-4 bg-white border border-gray-200 rounded-lg p-4">
              <summary class="font-semibold">Show step-by-step</summary>
              <div id="steps" class="mt-3 text-sm text-gray-800 space-y-2"></div>
            </details>
          </section>

          <!-- Plot -->
          <section id="plotWrap" class="mt-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-2">Quick plot (2D)</h2>
            <canvas id="plot" width="640" height="360" class="w-full max-w-full border border-gray-200 rounded-md bg-white"></canvas>
            <p class="hint mt-2">The plot auto-scales to show both points and the connecting segment.</p>
          </section>
        </div>

        <!-- Authoritative Content Ecosystem -->
        <article class="bg-white p-6 rounded-xl shadow mt-8 prose">
          <h2>Data source & methodology</h2>
          <p>
            <strong>Authoritative Data Source:</strong>
            OpenStax, <em>Algebra and Trigonometry</em>, Section “The Distance Formula”, 2016 (updated editions available).
            Direct link: <a href="https://openstax.org/details/books/algebra-and-trigonometry" rel="nofollow">OpenStax: Algebra and Trigonometry</a>.
          </p>
          <p><em>“Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.”</em></p>

          <h2>The formula explained</h2>
          <div class="formula-box">
            2D: \\( d = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2} \\) <br/>
            3D: \\( d = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2 + (z_2 - z_1)^2} \\) <br/>
            nD: \\( d = \sqrt{\sum_{i=1}^{n} (b_i - a_i)^2} \\)
          </div>

          <h2>Glossary of variables</h2>
          <ul>
            <li><strong>x₁, y₁, (z₁)</strong>: coordinates of point A.</li>
            <li><strong>x₂, y₂, (z₂)</strong>: coordinates of point B.</li>
            <li><strong>d</strong>: Euclidean distance between A and B.</li>
            <li><strong>Midpoint</strong>: \\( \big(\frac{x_1+x_2}{2}, \frac{y_1+y_2}{2}\big) \\) (add \\( \frac{z_1+z_2}{2} \\) in 3D).</li>
            <li><strong>Slope</strong> (2D): \\( m = \frac{y_2 - y_1}{x_2 - x_1} \\), undefined if \\(x_2 = x_1\\).</li>
          </ul>

          <h2>How it works: a step-by-step example</h2>
          <p><strong>Example:</strong> A(−2, 1) and B(4, 5).</p>
          <ol>
            <li>Compute differences: \\(\Delta x = 4 - (-2) = 6\\), \\(\Delta y = 5 - 1 = 4\\).</li>
            <li>Square & sum: \\(6^2 + 4^2 = 36 + 16 = 52\\).</li>
            <li>Square root: \\(d = \sqrt{52} = 2\sqrt{13} \\approx 7.2111\\).</li>
            <li>Midpoint: \\( \big(\frac{-2+4}{2}, \frac{1+5}{2}\big) = (1, 3) \\).</li>
            <li>Slope: \\( m = \frac{5-1}{4-(-2)} = \frac{4}{6} = \frac{2}{3} \\).</li>
          </ol>

          <h2>Frequently asked questions</h2>
          <details>
            <summary>What inputs does the calculator accept?</summary>
            <p>2D and 3D coordinate pairs, or n-dimensional vectors separated by spaces or commas. Scientific notation is allowed.</p>
          </details>
          <details>
            <summary>How do I include units?</summary>
            <p>Enter an optional unit label (e.g., m, km, ft). It’s appended to the numeric distance; calculations remain unitless.</p>
          </details>
          <details>
            <summary>Is slope always defined?</summary>
            <p>No. In 2D, slope is undefined when the line is vertical (x₂ = x₁). The calculator indicates this case.</p>
          </details>
          <details>
            <summary>Can I compute great-circle (geodesic) distance on Earth?</summary>
            <p>This tool covers Euclidean distance. For geodesic distances (lat/long), use a specialized great-circle calculator.</p>
          </details>
          <details>
            <summary>How many decimals are shown?</summary>
            <p>By default 4; you can change this in “Decimals”. Internally, results use full double precision.</p>
          </details>
          <details>
            <summary>Why do I see a square-root form?</summary>
            <p>We display an exact form (e.g., \( \sqrt{52} = 2\sqrt{13} \)) alongside the rounded decimal when feasible.</p>
          </details>

          <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Content verified by CalcDomain Editorial Board.<br>
            Last accuracy review: <time datetime="2025-10-25">October 25, 2025</time></p>
          </div>
        </article>
      </section>

      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-600">
            Ad Placement (300×600)
          </div>
          <div class="bg-white p-6 rounded-xl shadow">
            <h3 class="font-bold text-lg mb-3">Why this calculator stands out</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>2D/3D/nD support with exact & decimal outputs.</li>
              <li>Accessible UX: labeled fields, inline validation, keyboard-friendly tooltips.</li>
              <li>Lightweight plot without heavy libraries.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-xl shadow">
            <h3 class="font-bold text-lg mb-4">Related math tools</h3>
            <ul class="space-y-3 text-sm">
              <li><a class="text-blue-600 hover:underline" href="https://calcdomain.com/midpoint-calculator">Midpoint Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="https://calcdomain.com/slope">Slope Calculator</a></li>
              <li>Vector Magnitude</li>
              <li><a class="text-blue-600 hover:underline" href="https://calcdomain.com/dot-product">Dot Product</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="https://calcdomain.com/about" class="hover:text-blue-600">About</a>
        <a href="https://calcdomain.com/contact" class="hover:text-blue-600">Contact</a>
        <a href="https://calcdomain.com/privacy" class="hover:text-blue-600">Privacy</a>
        <a href="https://calcdomain.com/terms" class="hover:text-blue-600">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator Logic (defer) -->
  <script defer>
  (function () {
    "use strict";

    // Utility
    const $ = (id) => document.getElementById(id);
    const els = {
      mode: $("mode"),
      decimals: $("decimals"),
      units: $("units"),
      x1: $("x1"), y1: $("y1"), z1: $("z1"),
      x2: $("x2"), y2: $("y2"), z2: $("z2"),
      z1Wrap: $("z1Wrap"), z2Wrap: $("z2Wrap"),
      cartesianWrap: $("cartesianWrap"),
      vectorWrap: $("vectorWrap"),
      v1: $("v1"), v2: $("v2"),
      calcBtn: $("calcBtn"), resetBtn: $("resetBtn"),
      distanceOut: $("distanceOut"), distanceExact: $("distanceExact"),
      midpointOut: $("midpointOut"), slopeOut: $("slopeOut"),
      steps: $("steps"),
      plot: $("plot")
    };

    // Accessible tooltips
    document.querySelectorAll('[data-tooltip]').forEach(btn => {
      btn.addEventListener('click', () => {
        const tip = document.getElementById(btn.getAttribute('aria-controls'));
        const open = tip.getAttribute('data-open') === 'true';
        tip.setAttribute('data-open', String(!open));
        btn.setAttribute('aria-expanded', String(!open));
      });
      btn.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          const tip = document.getElementById(btn.getAttribute('aria-controls'));
          tip.setAttribute('data-open', 'false');
          btn.setAttribute('aria-expanded', 'false');
          btn.focus();
        }
      });
    });

    // Validation helpers
    function setError(id, msg) {
      const el = $(id);
      el.textContent = msg || "";
    }
    function parseNum(input, errId) {
      const v = input.value.trim();
      if (v === "") { setError(errId, "Required. Please enter a number."); return null; }
      const n = Number(v);
      if (!isFinite(n)) { setError(errId, "Invalid number. Use digits, optional sign, and decimals."); return null; }
      setError(errId, "");
      return n;
    }
    // On-blur validation
    ["x1","y1","z1","x2","y2","z2"].forEach(id=>{
      const input = $(id);
      if (!input) return;
      input.addEventListener('blur', () => {
        // find matching err id
        const errId = id + "-err";
        parseNum(input, errId);
      });
    });

    // Mode switching
    function updateModeUI() {
      const m = els.mode.value;
      if (m === "2d") {
        els.z1Wrap.classList.add("hidden");
        els.z2Wrap.classList.add("hidden");
        els.cartesianWrap.classList.remove("hidden");
        els.vectorWrap.classList.add("hidden");
      } else if (m === "3d") {
        els.z1Wrap.classList.remove("hidden");
        els.z2Wrap.classList.remove("hidden");
        els.cartesianWrap.classList.remove("hidden");
        els.vectorWrap.classList.add("hidden");
      } else {
        els.cartesianWrap.classList.add("hidden");
        els.vectorWrap.classList.remove("hidden");
      }
      // Clear outputs & steps
      renderOutputs({ distance: null, exact: "", midpoint: "—", slope: "—", steps: [] });
      drawPlot(null);
    }
    els.mode.addEventListener("change", updateModeUI);

    // Exact square root simplifier for small integers
    function simplifySqrt(n) {
      if (!Number.isFinite(n) || n < 0) return "";
      const N = Math.round(n);
      if (Math.abs(N - n) > 1e-10) return ""; // only simplify nice integers
      let outside = 1, inside = N;
      for (let f = 2; f*f <= inside; f++) {
        while (inside % (f*f) === 0) {
          inside = inside / (f*f);
          outside *= f;
        }
      }
      if (inside === 1) return outside.toString();
      if (outside === 1) return `√${inside}`;
      return `${outside}√${inside}`;
    }

    function fmt(n, d) {
      return Number(n).toFixed(Math.min(12, Math.max(0, d|0)));
    }

    function renderOutputs({ distance, exact, midpoint, slope, steps }) {
      els.distanceOut.textContent = distance == null ? "—" : distance;
      els.distanceExact.textContent = exact || "";
      els.midpointOut.textContent = midpoint || "—";
      els.slopeOut.textContent = slope || "—";
      els.steps.innerHTML = steps.map(s=>`<div>${s}</div>`).join("");
      // Ask MathJax to typeset any new TeX
      if (window.MathJax && window.MathJax.typesetPromise) window.MathJax.typesetPromise();
    }

    function calc2D() {
      const x1 = parseNum(els.x1, "x1-err");
      const y1 = parseNum(els.y1, "y1-err");
      const x2 = parseNum(els.x2, "x2-err");
      const y2 = parseNum(els.y2, "y2-err");
      if ([x1,y1,x2,y2].some(v=>v===null)) return;

      const dx = x2 - x1, dy = y2 - y1;
      const sumsq = dx*dx + dy*dy;
      const d = Math.sqrt(sumsq);
      const decimals = Number(els.decimals.value)||4;
      const units = els.units.value.trim();
      const exactPiece = simplifySqrt(sumsq);
      const exact = exactPiece ? `Exact: ${exactPiece}` : (Number.isInteger(d) ? "Exact: " + d : "");

      const midpoint = `(${fmt((x1+x2)/2, decimals)}, ${fmt((y1+y2)/2, decimals)})` + (units?` ${units}`:"");
      const slope = (x2===x1) ? "undefined (vertical)" : fmt((y2-y1)/(x2-x1), decimals);

      const steps = [
        `\\( \\Delta x = ${x2} - ${x1} = ${dx} \\), \\( \\Delta y = ${y2} - ${y1} = ${dy} \\)`,
        `\\( d = \\sqrt{(${dx})^2 + (${dy})^2} = \\sqrt{${sumsq}} \\approx ${fmt(d, decimals)} \\)`
      ];
      const out = fmt(d, decimals) + (units?` ${units}`:"");

      renderOutputs({
        distance: out,
        exact: exact ? exact + (units?` ${units}`:"") : "",
        midpoint, slope,
        steps
      });
      drawPlot({ x1, y1, x2, y2 });
    }

    function calc3D() {
      const x1 = parseNum(els.x1, "x1-err");
      const y1 = parseNum(els.y1, "y1-err");
      const z1 = parseNum(els.z1, "z1-err");
      const x2 = parseNum(els.x2, "x2-err");
      const y2 = parseNum(els.y2, "y2-err");
      const z2 = parseNum(els.z2, "z2-err");
      if ([x1,y1,z1,x2,y2,z2].some(v=>v===null)) return;

      const dx = x2 - x1, dy = y2 - y1, dz = z2 - z1;
      const sumsq = dx*dx + dy*dy + dz*dz;
      const d = Math.sqrt(sumsq);
      const decimals = Number(els.decimals.value)||4;
      const units = els.units.value.trim();
      const exactPiece = simplifySqrt(sumsq);
      const exact = exactPiece ? `Exact: ${exactPiece}` : (Number.isInteger(d) ? "Exact: " + d : "");

      const midpoint = `(${fmt((x1+x2)/2, decimals)}, ${fmt((y1+y2)/2, decimals)}, ${fmt((z1+z2)/2, decimals)})` + (units?` ${units}`:"");
      const steps = [
        `\\( \\Delta x = ${dx}, \\; \\Delta y = ${dy}, \\; \\Delta z = ${dz} \\)`,
        `\\( d = \\sqrt{(${dx})^2 + (${dy})^2 + (${dz})^2} = \\sqrt{${sumsq}} \\approx ${fmt(d, decimals)} \\)`
      ];
      const out = fmt(d, decimals) + (units?` ${units}`:"");

      renderOutputs({ distance: out, exact: exact ? exact + (units?` ${units}`:"") : "", midpoint, slope:"—", steps });
      drawPlot(null); // 2D plot not shown for 3D
    }

    function parseVector(text) {
      return text.split(/[\s,]+/).map(s=>s.trim()).filter(Boolean).map(Number);
    }

    function calcND() {
      const a = parseVector(els.v1.value);
      const b = parseVector(els.v2.value);
      if (!a.length || !b.length) {
        setError("v1-err", a.length? "":"Please enter Vector A.");
        setError("v2-err", b.length? "":"Please enter Vector B.");
        return;
      }
      if (a.length !== b.length) {
        setError("v1-err", "Vectors must have the same length.");
        setError("v2-err", "Vectors must have the same length.");
        return;
      }
      if ([...a, ...b].some(v=>!isFinite(v))) {
        setError("v1-err", "Only numbers are allowed (spaces or commas).");
        setError("v2-err", "Only numbers are allowed (spaces or commas).");
        return;
      }
      setError("v1-err", ""); setError("v2-err", "");

      let sumsq = 0;
      const terms = [];
      for (let i=0;i<a.length;i++){
        const diff = b[i]-a[i];
        sumsq += diff*diff;
        terms.push(`(${b[i]} - ${a[i]})^2`);
      }
      const d = Math.sqrt(sumsq);
      const decimals = Number(els.decimals.value)||4;
      const units = els.units.value.trim();
      const exactPiece = simplifySqrt(sumsq);
      const exact = exactPiece ? `Exact: ${exactPiece}` : (Number.isInteger(d) ? "Exact: " + d : "");
      const steps = [
        `\\( d = \\sqrt{ ${terms.join(" + ")} } = \\sqrt{${sumsq}} \\approx ${fmt(d, decimals)} \\)`
      ];
      const out = fmt(d, decimals) + (units?` ${units}`:"");

      renderOutputs({ distance: out, exact: exact ? exact + (units?` ${units}`:"") : "", midpoint:"—", slope:"—", steps });
      drawPlot(null);
    }

    function calculate() {
      const m = els.mode.value;
      if (m === "2d") return calc2D();
      if (m === "3d") return calc3D();
      return calcND();
    }

    // Plot (2D only)
    function drawPlot(data) {
      const c = els.plot;
      if (!c) return;
      const ctx = c.getContext("2d");
      // clear
      ctx.clearRect(0,0,c.width,c.height);
      if (!data) return;

      const P = [{x:data.x1,y:data.y1},{x:data.x2,y:data.y2}];
      // padding and scaling
      const pad = 40;
      const xs = P.map(p=>p.x), ys = P.map(p=>p.y);
      const minX = Math.min(...xs), maxX = Math.max(...xs);
      const minY = Math.min(...ys), maxY = Math.max(...ys);
      const spanX = Math.max(1e-6, (maxX - minX) || 1);
      const spanY = Math.max(1e-6, (maxY - minY) || 1);
      const sx = (c.width - 2*pad) / spanX;
      const sy = (c.height - 2*pad) / spanY;

      function toCanvas(p){
        return {
          x: pad + (p.x - minX) * sx,
          y: c.height - (pad + (p.y - minY) * sy)
        };
      }

      const A = toCanvas(P[0]), B = toCanvas(P[1]);

      // axes (through min bounds)
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#9ca3af"; // gray-400
      // x-axis
      ctx.beginPath();
      ctx.moveTo(pad, B.y); ctx.lineTo(c.width - pad, B.y); ctx.stroke();
      // y-axis
      ctx.beginPath();
      ctx.moveTo(A.x, pad); ctx.lineTo(A.x, c.height - pad); ctx.stroke();

      // segment
      ctx.lineWidth = 2;
      ctx.strokeStyle = "#2563eb";
      ctx.beginPath();
      ctx.moveTo(A.x, A.y); ctx.lineTo(B.x, B.y); ctx.stroke();

      // points
      ctx.fillStyle = "#1d4ed8";
      [A,B].forEach(pt=>{
        ctx.beginPath();
        ctx.arc(pt.x, pt.y, 5, 0, Math.PI*2);
        ctx.fill();
      });

      // labels
      ctx.fillStyle = "#111827";
      ctx.font = "12px Inter, system-ui, sans-serif";
      ctx.fillText(`A(${data.x1}, ${data.y1})`, A.x + 8, A.y - 8);
      ctx.fillText(`B(${data.x2}, ${data.y2})`, B.x + 8, B.y - 8);
    }

    // Wire buttons
    els.calcBtn.addEventListener("click", calculate);
    els.resetBtn.addEventListener("click", () => {
      els.mode.value = "2d";
      ["x1","y1","x2","y2"].forEach((id,i)=>{
        $(id).value = ["0","0","3","4"][i];
      });
      if (els.z1) els.z1.value = "0";
      if (els.z2) els.z2.value = "0";
      els.v1.value = "";
      els.v2.value = "";
      els.units.value = "";
      els.decimals.value = "4";
      document.querySelectorAll(".error").forEach(e=>e.textContent="");
      updateModeUI();
    });

    // Enter to calculate
    document.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && (document.activeElement.tagName === "INPUT" || document.activeElement.tagName === "TEXTAREA")) {
        e.preventDefault();
        calculate();
      }
    });

    // Initialize
    updateModeUI();
    calc2D(); // initial preview
  })();
  </script>
</body>
</html>

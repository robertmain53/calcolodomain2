<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Icons -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover"
  />
  <title>regular ngon calculator — side, radius, area, perimeter & angles</title>
  <meta name="description" content="Professional regular n-gon calculator. Enter n and one known value (side a, circumradius R, inradius r, area A, or perimeter P) to compute every property: side, radii, area, perimeter, interior/central angles, apothem, diagonals and a scaled diagram." />
  <link rel="canonical" href="https://calcdomain.com/regular-ngon-calculator.html" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- MathJax for LaTeX -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
          id="MathJax-script"></script>

  <style>
    :root { --focus: #2563eb; }
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    .prose { max-width: 70ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: .75rem; }
    .prose h3 { font-size: 1.15rem; font-weight: 700; margin-top: 1.25rem; margin-bottom: .5rem; }
    .prose p { margin-bottom: .9rem; line-height: 1.7; }
    .prose ul, .prose ol { margin-left: 1.25rem; margin-bottom: .8rem; }
    .formula-box {
      background:#f3f4f6; border:1px solid #d1d5db; border-radius:10px; padding:1rem;
      overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
    }
    /* Visible custom focus */
    :where(a, button, input, select, summary, [role="tooltip-trigger"]):focus-visible {
      outline: 3px solid var(--focus);
      outline-offset: 2px;
      border-radius: .5rem;
    }
    /* CLS guard: reserve space for results */
    #results { min-height: 18rem; }
    /* Print */
    @media print {
      header, nav, aside, .no-print { display: none !important; }
      main { padding: 0 !important; }
      #print-section { position: static !important; }
    }
  </style>

  <!-- WebPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Regular n-gon Calculator",
    "url":"https://calcdomain.com/regular-ngon-calculator.html",
    "inLanguage":"en",
    "description":"Compute properties of a regular polygon (n-gon): side length, circumradius, inradius (apothem), area, perimeter, angles, diagonals and more from n and one known value.",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"}
  }
  </script>
  <!-- Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Math","item":"https://calcdomain.com/math.html"},
      {"@type":"ListItem","position":3,"name":"Geometry","item":"https://calcdomain.com/subcategories/geometry.html"},
      {"@type":"ListItem","position":4,"name":"Regular n-gon Calculator","item":"https://calcdomain.com/regular-ngon-calculator.html"}
    ]
  }
  </script>
  <!-- FAQ -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What inputs do I need for a regular n-gon?","acceptedAnswer":{"@type":"Answer","text":"Provide the number of sides n (integer ≥ 3) and one geometric value among side a, circumradius R, inradius r (apothem), area A, or perimeter P. The calculator derives the rest."}},
      {"@type":"Question","name":"Which formulas does this tool use?","acceptedAnswer":{"@type":"Answer","text":"Standard Euclidean geometry for regular polygons, e.g., R = a/(2 sin(π/n)), r = a/(2 tan(π/n)), P = n a, A = n a^2/(4 tan(π/n)), interior angle = (n-2)π/n, and diagonals count = n(n-3)/2."}},
      {"@type":"Question","name":"Does the diagram show true scale?","acceptedAnswer":{"@type":"Answer","text":"The diagram scales to fit the canvas while preserving proportions for the chosen n and size. Units are not to scale across different inputs."}},
      {"@type":"Question","name":"How accurate are the results?","acceptedAnswer":{"@type":"Answer","text":"Results use double-precision floating point and robust trigonometric relations. Rounding is applied only in display; raw values can be copied with higher precision."}},
      {"@type":"Question","name":"Can I compute diagonal lengths?","acceptedAnswer":{"@type":"Answer","text":"Yes. The tool shows the number of diagonals and the shortest/longest diagonal using d_k = 2R sin(kπ/n)."}},
      {"@type":"Question","name":"What’s the difference between R and r?","acceptedAnswer":{"@type":"Answer","text":"R is the circumradius (center to vertex). r is the inradius or apothem (center to side). They relate by R = r / cos(π/n)."}},
      {"@type":"Question","name":"Can I use degrees instead of radians?","acceptedAnswer":{"@type":"Answer","text":"Angles are displayed in both degrees and radians for clarity. Inputs are numeric; no angle input is required to compute results."}}
    ]
  }
  </script>
  <!-- WebApplication (Calculator) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"Regular n-gon Calculator",
    "applicationCategory":"EducationalApplication",
    "operatingSystem":"Any",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"}
  }
  </script>
</head>

<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky as requested) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-extrabold text-blue-700">CalcDomain</a>
      <div class="hidden md:block w-full max-w-md">
        <div class="relative">
          <input type="search" id="search-input" placeholder="Search for a calculator..."
                 class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus-visible:outline-none focus:ring-4 focus:ring-blue-300"
                 autocomplete="off" />
          <svg class="w-5 h-5 absolute right-3 top-1/2 -translate-y-1/2 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-5.2-5.2M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16z"></path>
          </svg>
        </div>
      </div>
      <a class="hidden md:inline text-sm text-gray-700 hover:text-blue-700" href="index.html#categories">Categories</a>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Main column -->
      <section class="w-full lg:w-2/3">
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-700">Home</a> &raquo;
          <a href="math.html" class="hover:text-blue-700">Math</a> &raquo;
          <a href="subcategories/math-geometry.html" class="hover:text-blue-700">Geometry</a> &raquo;
          <span class="text-gray-900">Regular n-gon Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-lg shadow-md">
          <h1 class="text-3xl font-extrabold text-gray-900 mb-2">regular ngon calculator</h1>
          <p class="text-gray-700 mb-6">
            Enter the number of sides <strong>n</strong> (n ≥ 3) and one known value (<em>a</em>, <em>R</em>, <em>r</em>, <em>A</em>, or <em>P</em>).
            The calculator instantly derives all other properties, including side length, circumradius, inradius (apothem), perimeter, area,
            central/interior angles, diagonals, and a scaled diagram. Built for engineers, educators, and precision-minded makers.
          </p>

          <!-- Calculator UI -->
          <section id="calculator-ui" class="space-y-6" aria-labelledby="calc-heading">
            <h2 id="calc-heading" class="sr-only">Regular n-gon calculator</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- n -->
              <div>
                <div class="flex items-center gap-2">
                  <label for="n" class="block text-sm font-medium text-gray-800">Number of sides (n) <span aria-hidden="true" class="text-red-600">*</span></label>
                  <button class="no-print inline-flex items-center justify-center w-6 h-6 rounded-full border text-xs"
                          aria-expanded="false" aria-controls="tip-n" aria-label="Help: number of sides" role="tooltip-trigger">?</button>
                </div>
                <input type="number" id="n" inputmode="numeric" min="3" step="1" value="6"
                       class="mt-1 block w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-4 focus:ring-blue-300"
                       aria-required="true" aria-describedby="err-n tip-n">
                <p id="err-n" class="mt-1 text-sm text-red-700 hidden">Please enter an integer n ≥ 3.</p>
                <div id="tip-n" class="mt-1 text-xs text-gray-600 hidden">Regular polygons require an integer number of sides, n ≥ 3 (triangle upwards).</div>
              </div>

              <!-- Known value kind -->
              <div>
                <div class="flex items-center gap-2">
                  <label for="knownKind" class="block text-sm font-medium text-gray-800">Known value <span aria-hidden="true" class="text-red-600">*</span></label>
                  <button class="no-print inline-flex items-center justify-center w-6 h-6 rounded-full border text-xs"
                          aria-expanded="false" aria-controls="tip-kind" aria-label="Help: known value" role="tooltip-trigger">?</button>
                </div>
                <select id="knownKind"
                        class="mt-1 block w-full px-3 py-3 border border-gray-300 rounded-lg bg-white focus:ring-4 focus:ring-blue-300"
                        aria-required="true" aria-describedby="err-kind tip-kind">
                  <option value="a" selected>Side a</option>
                  <option value="R">Circumradius R</option>
                  <option value="r">Inradius r (apothem)</option>
                  <option value="P">Perimeter P</option>
                  <option value="A">Area A</option>
                </select>
                <p id="err-kind" class="mt-1 text-sm text-red-700 hidden">Select which value you know.</p>
                <div id="tip-kind" class="mt-1 text-xs text-gray-600 hidden">Choose the geometric value you have measured or specified.</div>
              </div>

              <!-- Known value numeric -->
              <div>
                <div class="flex items-center gap-2">
                  <label for="knownValue" class="block text-sm font-medium text-gray-800"><span id="knownLabel">Side a</span> <span aria-hidden="true" class="text-red-600">*</span></label>
                  <button class="no-print inline-flex items-center justify-center w-6 h-6 rounded-full border text-xs"
                          aria-expanded="false" aria-controls="tip-value" aria-label="Help: value" role="tooltip-trigger">?</button>
                </div>
                <input type="number" id="knownValue" inputmode="decimal" min="0" step="any" value="2"
                       class="mt-1 block w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-4 focus:ring-blue-300"
                       aria-required="true" aria-describedby="err-value tip-value">
                <p id="err-value" class="mt-1 text-sm text-red-700 hidden">Enter a positive number.</p>
                <div id="tip-value" class="mt-1 text-xs text-gray-600 hidden">Units are arbitrary but consistent across results (e.g., all in cm or all in m).</div>
              </div>

              <!-- Precision -->
              <div>
                <div class="flex items-center gap-2">
                  <label for="precision" class="block text-sm font-medium text-gray-800">Display precision (decimals)</label>
                  <button class="no-print inline-flex items-center justify-center w-6 h-6 rounded-full border text-xs"
                          aria-expanded="false" aria-controls="tip-prec" aria-label="Help: precision" role="tooltip-trigger">?</button>
                </div>
                <input type="number" id="precision" inputmode="numeric" min="0" max="12" step="1" value="6"
                       class="mt-1 block w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-4 focus:ring-blue-300"
                       aria-describedby="tip-prec">
                <div id="tip-prec" class="mt-1 text-xs text-gray-600 hidden">Controls how many decimals are shown; internal calculations keep higher precision.</div>
              </div>
            </div>

            <div class="flex flex-wrap gap-3 no-print">
              <button id="btn-calc" class="px-5 py-3 bg-blue-700 text-white font-semibold rounded-lg focus:ring-4 focus:ring-blue-300"
                      type="button">Calculate</button>
              <button id="btn-reset" class="px-5 py-3 bg-gray-100 text-gray-900 font-semibold rounded-lg border focus:ring-4 focus:ring-gray-300"
                      type="button">Reset</button>
              <button id="btn-copy" class="px-5 py-3 bg-emerald-600 text-white font-semibold rounded-lg focus:ring-4 focus:ring-emerald-300"
                      type="button">Copy results</button>
              <button id="btn-print" class="px-5 py-3 bg-indigo-600 text-white font-semibold rounded-lg focus:ring-4 focus:ring-indigo-300"
                      type="button">Print</button>
            </div>
          </section>

          <!-- Results -->
          <section id="results" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6">
            <h3 class="text-lg font-bold text-blue-900 mb-4">Results</h3>

            <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4">
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Side</h4>
                <p id="res-a" class="text-2xl font-bold text-blue-700">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Circumradius R</h4>
                <p id="res-R" class="text-2xl font-bold text-blue-700">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Inradius r (apothem)</h4>
                <p id="res-r" class="text-2xl font-bold text-blue-700">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Perimeter P</h4>
                <p id="res-P" class="text-2xl font-bold text-blue-700">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Area A</h4>
                <p id="res-A" class="text-2xl font-bold text-blue-700">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Interior angle</h4>
                <p id="res-int" class="text-xl font-bold text-blue-700">—</p>
                <p id="res-int-rad" class="text-xs text-gray-600">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Central angle</h4>
                <p id="res-cent" class="text-xl font-bold text-blue-700">—</p>
                <p id="res-cent-rad" class="text-xs text-gray-600">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Diagonals (count)</h4>
                <p id="res-diag-count" class="text-2xl font-bold text-blue-700">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-600">Shortest / Longest diagonal</h4>
                <p id="res-diag" class="text-xl font-bold text-blue-700">—</p>
                <p class="text-xs text-gray-600">Formulas: d<sub>k</sub> = 2 R sin(kπ/n)</p>
              </div>
            </div>

            <!-- Diagram -->
            <div class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-700 mb-2">Scaled diagram (not to absolute scale)</h4>
                <canvas id="poly-canvas" width="480" height="360" aria-label="Regular polygon diagram" class="border rounded"></canvas>
              </div>
              <div class="bg-white border rounded-lg p-4">
                <h4 class="text-sm text-gray-700 mb-2">Computed values (full precision)</h4>
                <textarea id="raw-dump" class="w-full h-64 p-3 border rounded font-mono text-xs" aria-label="Raw results (JSON)" readonly></textarea>
              </div>
            </div>
          </section>
        </div>

        <!-- Authoritative Content -->
        <article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
          <h2>Authoritative source and methodology</h2>
          <p>
            Primary reference: <a class="text-blue-700 underline" rel="noopener" target="_blank"
            href="https://mathworld.wolfram.com/RegularPolygon.html">Weisstein, Eric W. “Regular Polygon.” <em>MathWorld—A Wolfram Web Resource</em></a>.
            Accessed October 25, 2025. All formulas follow classical Euclidean geometry.
          </p>
          <p><strong>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</strong></p>

          <h2>The formula explained</h2>
          <div class="formula-box">
\[
\begin{aligned}
&\text{Central angle: } \theta = \frac{2\pi}{n}, \qquad
\text{Interior angle: } \alpha = \pi - \frac{2\pi}{n} = \frac{(n-2)\pi}{n} \\
&\text{Perimeter: } P = n\,a \\
&\text{Circumradius: } R = \frac{a}{2\sin(\pi/n)} \\
&\text{Inradius (apothem): } r = \frac{a}{2\tan(\pi/n)} = R\cos(\pi/n) \\
&\text{Area: } A = \frac{1}{2}Pr = \frac{n a^2}{4\tan(\pi/n)} = \frac{n R^2}{2}\sin\!\left(\frac{2\pi}{n}\right) \\
&\text{Diagonals (count): } D = \frac{n(n-3)}{2}, \qquad
\text{Chord length } d_k = 2R\sin\!\left(\frac{k\pi}{n}\right)
\end{aligned}
\]
          </div>

          <h2>Glossary of variables</h2>
          <ul>
            <li><strong>n</strong> — number of sides (integer ≥ 3).</li>
            <li><strong>a</strong> — side length.</li>
            <li><strong>R</strong> — circumradius (center to vertex).</li>
            <li><strong>r</strong> — inradius / apothem (center to side).</li>
            <li><strong>P</strong> — perimeter, \(P = n a\).</li>
            <li><strong>A</strong> — area.</li>
            <li><strong>\(\alpha\)</strong> — interior angle of the polygon.</li>
            <li><strong>\(\theta\)</strong> — central angle subtended by one side.</li>
            <li><strong>D</strong> — number of diagonals, \(D=\frac{n(n-3)}{2}\).</li>
          </ul>

          <h2>How it works: a step-by-step example</h2>
          <h3>Example — regular heptagon (n = 7) with side a = 2</h3>
          <ol>
            <li>Compute \(\theta = 2\pi/7\) and \(\alpha = 5\pi/7\).</li>
            <li>\(R = \dfrac{a}{2\sin(\pi/7)}\).</li>
            <li>\(r = \dfrac{a}{2\tan(\pi/7)}\).</li>
            <li>\(P = n a = 14\).</li>
            <li>\(A = \dfrac{n a^2}{4\tan(\pi/7)}\).</li>
            <li>Diagonals count \(D = 7\cdot4/2 = 14\). Shortest diagonal \(d_2 = 2R\sin(2\pi/7)\); longest \(d_{\lfloor 7/2\rfloor} = d_3 = 2R\sin(3\pi/7)\).</li>
          </ol>

          <h2>Frequently asked questions</h2>
          <details>
            <summary>Can I input area or perimeter instead of side length?</summary>
            <p>Yes. Choose “Area A” or “Perimeter P” as your known value. The solver reconstructs \(a\) from the selected quantity and computes all others.</p>
          </details>
          <details>
            <summary>What happens as n grows very large?</summary>
            <p>The regular n-gon approaches a circle. \(a \approx 2R\sin(\pi/n)\) becomes small and \(\alpha \to \pi\). Numerically the tool stays stable for large n, but angle differences may underflow at extreme values.</p>
          </details>
          <details>
            <summary>Does this support star polygons?</summary>
            <p>No. This tool targets convex regular polygons. Chords \(d_k\) are reported, but the shape remains convex.</p>
          </details>
          <details>
            <summary>How are diagonals chosen?</summary>
            <p>We list the shortest (k = 2) and the longest (k = ⌊n/2⌋). In general, any diagonal length is \(d_k = 2R\sin(k\pi/n)\) with k = 2,3,…,⌊n/2⌋.</p>
          </details>
          <details>
            <summary>Are units supported?</summary>
            <p>Units are consistent but not enforced. If you enter centimeters, all outputs use centimeters-consistent units (e.g., area in cm²).</p>
          </details>

          <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Content reviewed by the CalcDomain Editorial Board.<br>
              Last accuracy review: <time datetime="2025-10-25">October 25, 2025</time></p>
          </div>
        </article>
      </section>

      <!-- Aside -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-20 space-y-6">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="font-bold text-lg mb-3">Why this calculator stands out</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Single input workflow: n + one value → everything else.</li>
              <li>WCAG 2.1 AA with keyboard-first interactions and clear focus.</li>
              <li>Diagram and full-precision JSON dump for engineering handoff.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="font-bold text-lg mb-3">Related geometry tools</h3>
            <ul class="space-y-2 text-sm">
              <li><a class="text-blue-700 hover:underline" href="regular-polygon-area.html">Regular Polygon Area</a></li>
              <li><a class="text-blue-700 hover:underline" href="circle-calculator.html">Circle Calculator</a></li>
              <li><a class="text-blue-700 hover:underline" href="triangle-solver.html">Triangle Solver</a></li>
              <li><a class="text-blue-700 hover:underline" href="inscribed-polygon.html">Inscribed Polygon</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-700">About</a>
        <a href="contact.html" class="hover:text-blue-700">Contact</a>
        <a href="privacy.html" class="hover:text-blue-700">Privacy</a>
        <a href="terms.html" class="hover:text-blue-700">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator Logic (defer) -->
  <script defer>
  (function(){
    const $ = (id) => document.getElementById(id);
    const els = {
      n: $('n'),
      knownKind: $('knownKind'),
      knownValue: $('knownValue'),
      knownLabel: $('knownLabel'),
      precision: $('precision'),
      errN: $('err-n'),
      errKind: $('err-kind'),
      errValue: $('err-value'),
      results: {
        a: $('res-a'), R: $('res-R'), r: $('res-r'), P: $('res-P'), A: $('res-A'),
        intDeg: $('res-int'), intRad: $('res-int-rad'), centDeg: $('res-cent'), centRad: $('res-cent-rad'),
        diagCount: $('res-diag-count'), diagPair: $('res-diag')
      },
      rawDump: $('raw-dump'),
      canvas: $('poly-canvas'),
      btnCalc: $('btn-calc'),
      btnReset: $('btn-reset'),
      btnCopy: $('btn-copy'),
      btnPrint: $('btn-print')
    };

    // Accessible tooltips
    document.querySelectorAll('[role="tooltip-trigger"]').forEach(btn=>{
      btn.addEventListener('click', () => toggleTip(btn));
      btn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); toggleTip(btn);} });
      function toggleTip(button){
        const id = button.getAttribute('aria-controls');
        const tip = document.getElementById(id);
        const isOpen = button.getAttribute('aria-expanded') === 'true';
        button.setAttribute('aria-expanded', String(!isOpen));
        tip?.classList.toggle('hidden', isOpen);
      }
    });

    // Update label when known kind changes
    const K_LABELS = { a:'Side a', R:'Circumradius R', r:'Inradius r', P:'Perimeter P', A:'Area A' };
    els.knownKind.addEventListener('change', () => {
      els.knownLabel.textContent = K_LABELS[els.knownKind.value] || 'Value';
      validateField('kind');
      // Auto recompute on change
      compute();
    });

    // Inline validation on blur
    els.n.addEventListener('blur', ()=>validateField('n'));
    els.knownValue.addEventListener('blur', ()=>validateField('value'));

    // Buttons
    els.btnCalc.addEventListener('click', compute);
    els.btnReset.addEventListener('click', resetForm);
    els.btnCopy.addEventListener('click', copyDump);
    els.btnPrint.addEventListener('click', ()=>window.print());

    // Also react to typing
    ['input','change'].forEach(ev=>{
      els.n.addEventListener(ev, compute);
      els.knownValue.addEventListener(ev, compute);
      els.precision.addEventListener(ev, compute);
    });

    function validateField(which){
      if(which==='n'){
        const n = parseInt(els.n.value,10);
        const ok = Number.isInteger(n) && n>=3;
        setValidity(els.n, els.errN, ok);
        return ok;
      }
      if(which==='kind'){
        const ok = !!els.knownKind.value;
        setValidity(els.knownKind, $('err-kind'), ok);
        return ok;
      }
      if(which==='value'){
        const v = Number(els.knownValue.value);
        const ok = isFinite(v) && v>0;
        setValidity(els.knownValue, els.errValue, ok);
        return ok;
      }
      return true;
    }
    function setValidity(input, errEl, ok){
      input.setAttribute('aria-invalid', String(!ok));
      errEl.classList.toggle('hidden', ok);
    }

    function compute(){
      const okN = validateField('n');
      const okKind = validateField('kind');
      const okVal = validateField('value');
      if(!(okN && okKind && okVal)){ return; }

      const n = parseInt(els.n.value,10);
      const kind = els.knownKind.value;
      const val = Number(els.knownValue.value);
      const prec = clamp(parseInt(els.precision.value,10) || 6, 0, 12);

      const pi = Math.PI;
      const s = Math.sin, t = Math.tan, c = Math.cos;

      // helper: derive side a from (kind,val)
      let a;
      try{
        if(kind==='a'){ a = val; }
        else if(kind==='R'){ a = 2*val*s(pi/n); }
        else if(kind==='r'){ a = 2*val*t(pi/n); }
        else if(kind==='P'){ a = val/n; }
        else if(kind==='A'){ a = Math.sqrt( (4*val*t(pi/n))/n ); }
      }catch{ /* no-op */ }

      if(!(isFinite(a) && a>0)){
        // show minimal feedback, keep results blank
        display({
          n, a:NaN, R:NaN, r:NaN, P:NaN, A:NaN,
          alpha:NaN, theta:NaN, D:NaN, dShort:NaN, dLong:NaN
        }, prec);
        return;
      }

      const theta = 2*pi/n;
      const alpha = pi - theta;
      const R = a/(2*s(pi/n));
      const r = a/(2*t(pi/n));
      const P = n*a;
      const A = (n*a*a)/(4*t(pi/n));
      const D = n*(n-3)/2;

      // diagonals: shortest k=2 (if n>=4), longest k=floor(n/2)
      const kShort = Math.min(2, Math.floor(n/2));
      const kLong = Math.floor(n/2);
      const dShort = 2*R*s(kShort*pi/n);
      const dLong  = 2*R*s(kLong*pi/n);

      const pack = { n, a, R, r, P, A, alpha, theta, D, dShort, dLong };
      display(pack, prec);
      drawPolygon(n, R);
      dumpRaw(pack);
    }

    function display(o, prec){
      const fmt = (x, unit='') => isFinite(x) ? (Number(x).toFixed(prec) + unit) : '—';
      const deg = (rad)=> rad*180/Math.PI;

      els.results.a.textContent = fmt(o.a);
      els.results.R.textContent = fmt(o.R);
      els.results.r.textContent = fmt(o.r);
      els.results.P.textContent = fmt(o.P);
      els.results.A.textContent = fmt(o.A);

      els.results.intDeg.textContent = isFinite(o.alpha) ? deg(o.alpha).toFixed(6) + '°' : '—';
      els.results.intRad.textContent = isFinite(o.alpha) ? o.alpha.toFixed(6) + ' rad' : '—';

      els.results.centDeg.textContent = isFinite(o.theta) ? deg(o.theta).toFixed(6) + '°' : '—';
      els.results.centRad.textContent = isFinite(o.theta) ? o.theta.toFixed(6) + ' rad' : '—';

      els.results.diagCount.textContent = isFinite(o.D) ? String(o.D) : '—';
      els.results.diagPair.textContent = (isFinite(o.dShort)&&isFinite(o.dLong))
        ? `${o.dShort.toFixed(prec)} / ${o.dLong.toFixed(prec)}`
        : '—';
    }

    function drawPolygon(n, R){
      const canvas = els.canvas;
      const ctx = canvas.getContext('2d');
      const W = canvas.width, H = canvas.height;
      ctx.clearRect(0,0,W,H);

      if(!(Number.isInteger(n) && n>=3 && isFinite(R) && R>0)) return;

      const pad = 24;
      const cx = W/2, cy = H/2;
      const maxR = Math.min(W, H)/2 - pad;
      const scale = maxR / R;

      const pts = [];
      const phi0 = -Math.PI/2; // start at top
      for(let i=0;i<n;i++){
        const ang = phi0 + i*2*Math.PI/n;
        const x = cx + (R*scale)*Math.cos(ang);
        const y = cy + (R*scale)*Math.sin(ang);
        pts.push([x,y]);
      }

      // polygon
      ctx.lineWidth = 2;
      ctx.strokeStyle = '#1d4ed8';
      ctx.fillStyle = '#dbeafe';
      ctx.beginPath();
      ctx.moveTo(pts[0][0], pts[0][1]);
      for(let i=1;i<n;i++){ ctx.lineTo(pts[i][0], pts[i][1]); }
      ctx.closePath();
      ctx.fill();
      ctx.stroke();

      // center
      ctx.fillStyle = '#ef4444';
      ctx.beginPath(); ctx.arc(cx, cy, 3, 0, 2*Math.PI); ctx.fill();

      // a sample side marker
      ctx.strokeStyle = '#10b981';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(pts[0][0], pts[0][1]);
      ctx.lineTo(pts[1][0], pts[1][1]);
      ctx.stroke();
    }

    function dumpRaw(obj){
      // High-precision raw dump
      const copy = {...obj};
      for(const k in copy){
        if(typeof copy[k] === 'number'){
          copy[k] = Number(copy[k]); // keep full JS precision
        }
      }
      els.rawDump.value = JSON.stringify(copy, null, 2);
    }

    function copyDump(){
      els.rawDump.select();
      document.execCommand('copy');
    }

    function resetForm(){
      els.n.value = 6;
      els.knownKind.value = 'a';
      els.knownLabel.textContent = 'Side a';
      els.knownValue.value = 2;
      els.precision.value = 6;
      hideAllErrors();
      compute();
    }
    function hideAllErrors(){
      [els.errN, els.errValue, $('err-kind')].forEach(e=>e.classList.add('hidden'));
      [els.n, els.knownValue, els.knownKind].forEach(i=>i.setAttribute('aria-invalid','false'));
    }
    function clamp(x, lo, hi){ return Math.min(hi, Math.max(lo, x)); }

    // initial run
    compute();
  })();
  </script>
</body>
</html>

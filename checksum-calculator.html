<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Checksum Calculator – Compute MD5, SHA-1, SHA-256, CRC-32 &amp; Adler-32</title>
<meta name="description" content="Fast, accessible checksum calculator. Hash text or files with MD5, SHA-1, SHA-256 and compute CRC-32 & Adler-32. Hex/Base64 output, copy buttons, and verification mode." />
<link rel="canonical" href="https://calcdomain.com/checksum-calculator.html" />
<meta name="author" content="Ugo Candido" />
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
<script>
  tailwind.config = {
    theme: { extend: { fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'] } } }
  };
</script>
<style>
  :root { color-scheme: light dark; }
  body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
  .prose { max-width: 70ch; }
  .focus-ring:focus-visible { outline: 3px solid #2563eb; outline-offset: 2px; }
  .formula-box { background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1rem; overflow-x:auto; }
  .result-grid { min-height: 6rem; } /* prevents CLS */
  .tt { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; }
  details > summary { cursor:pointer; font-weight:600; }
  .copy-btn:focus-visible { outline: 3px solid #16a34a; outline-offset: 2px; }
  @media (prefers-reduced-motion: no-preference) {
    .fade-in { animation: fade .25s ease-out; } @keyframes fade { from {opacity:.001} to {opacity:1} }
  }
  @media print {
    header, nav, aside, footer, #help, #ads { display:none!important; }
    main { padding:0; }
  }
</style>

<!-- JSON-LD: WebPage -->
<script type="application/ld+json">
{
"@context":"https://schema.org",
"@type":"WebPage",
"name":"Checksum Calculator – MD5, SHA-1, SHA-256, CRC-32",
"description":"Compute checksums for text and files. Supports MD5, SHA-1, SHA-256, CRC-32, Adler-32 with copyable hex/Base64 outputs and verification.",
"url":"https://calcdomain.com/checksum-calculator.html",
"inLanguage":"en",
"author":{"@type":"Person","name":"Ugo Candido"},
"publisher":{"@type":"Organization","name":"CalcDomain"}
}
</script>

<!-- JSON-LD: Breadcrumbs -->
<script type="application/ld+json">
{
"@context":"https://schema.org",
"@type":"BreadcrumbList",
"itemListElement":[
  {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
  {"@type":"ListItem","position":2,"name":"Lifestyle & Everyday","item":"https://calcdomain.com/lifestyle-everyday.html"},
  {"@type":"ListItem","position":3,"name":"Miscellaneous","item":"https://calcdomain.com/subcategories/miscellaneous.html"},
  {"@type":"ListItem","position":4,"name":"Checksum Calculator","item":"https://calcdomain.com/checksum-calculator.html"}
]
}
</script>

<!-- JSON-LD: HowTo -->
<script type="application/ld+json">
{
"@context":"https://schema.org",
"@type":"HowTo",
"name":"How to calculate a checksum",
"description":"Use this page to compute MD5, SHA, CRC-32 or Adler-32 for text or files and verify integrity.",
"step":[
  {"@type":"HowToStep","name":"Choose input","text":"Paste text or pick a file."},
  {"@type":"HowToStep","name":"Select algorithms","text":"Tick one or more algorithms (MD5, SHA-1, SHA-256, CRC-32, Adler-32)."},
  {"@type":"HowToStep","name":"Compute","text":"Press Calculate to get hex and Base64 outputs."},
  {"@type":"HowToStep","name":"Verify","text":"Paste an expected checksum to automatically compare and highlight match."}
]
}
</script>

<!-- JSON-LD: FAQPage -->
<script type="application/ld+json">
{
"@context":"https://schema.org",
"@type":"FAQPage",
"mainEntity":[
{"@type":"Question","name":"Is hashing done locally?","acceptedAnswer":{"@type":"Answer","text":"Yes. All computations run in your browser; no data leaves your device."}},
{"@type":"Question","name":"What encodings are used?","acceptedAnswer":{"@type":"Answer","text":"Outputs are provided in lowercase hexadecimal and Base64. You can toggle uppercase for hex."}},
{"@type":"Question","name":"Can I hash large files?","acceptedAnswer":{"@type":"Answer","text":"Yes. Files are processed in streaming chunks for CRC-32/Adler-32 and buffered for SHA/MD5. Performance depends on your device."}},
{"@type":"Question","name":"Which algorithms are suitable for security?","acceptedAnswer":{"@type":"Answer","text":"For integrity checks, SHA-256 is recommended. MD5 and SHA-1 are considered broken for collision resistance and should not be used for security."}},
{"@type":"Question","name":"Why might two tools give different checksums?","acceptedAnswer":{"@type":"Answer","text":"Differences often come from text encoding (UTF-8 vs other), line endings, or including/excluding filename or metadata. This tool uses UTF-8 bytes of the exact input shown."}},
{"@type":"Question","name":"Does the tool support Base64 verification?","acceptedAnswer":{"@type":"Answer","text":"Yes. You can paste either hex or Base64 and the tool will auto-detect for comparison."}}
]
}
</script>

<!-- MathJax for LaTeX rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
</head>
<body class="bg-gray-50 text-gray-900">
<header class="bg-white border-b">
  <nav class="container mx-auto px-4 py-4 flex items-center justify-between" aria-label="Primary">
    <a href="index.html" class="text-2xl font-bold text-blue-700 focus-ring">CalcDomain</a>
    <div class="text-sm text-gray-600" id="help">Checksum Calculator</div>
  </nav>
</header>

<main class="container mx-auto px-4 py-8">
  <!-- Breadcrumb -->
  <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
    <a href="index.html" class="hover:text-blue-600 focus-ring">Home</a> &raquo;
    <a href="lifestyle-everyday.html" class="hover:text-blue-600 focus-ring">Lifestyle &amp; Everyday</a> &raquo;
    <a href="subcategories/miscellaneous.html" class="hover:text-blue-600 focus-ring">Miscellaneous</a> &raquo;
    <span class="text-gray-900">Checksum Calculator</span>
  </nav>

  <div class="flex flex-col lg:flex-row gap-8">
    <section class="w-full lg:w-2/3">
      <div id="print-section" class="bg-white p-6 rounded-lg shadow">
        <h1 class="text-3xl font-extrabold mb-2">checksum calculator</h1>
        <p class="text-gray-700 mb-6">Compute checksums and hashes for text or files using MD5, SHA-1, SHA-256, CRC-32 and Adler-32. Designed for developers, IT, archivists, and everyday integrity checks.</p>

        <!-- Calculator (Section 3) -->
        <section id="calculator" aria-labelledby="calc-heading">
          <h2 id="calc-heading" class="sr-only">Checksum calculator</h2>

          <!-- Input mode -->
          <div class="mb-4">
            <fieldset>
              <legend class="block text-sm font-medium text-gray-800 mb-2">Input type <span aria-hidden="true" class="text-red-600">*</span></legend>
              <div class="flex gap-4">
                <label class="inline-flex items-center gap-2">
                  <input class="focus-ring" type="radio" name="inputMode" id="modeText" value="text" checked aria-describedby="modeHelp" />
                  <span>Text</span>
                </label>
                <label class="inline-flex items-center gap-2">
                  <input class="focus-ring" type="radio" name="inputMode" id="modeFile" value="file" aria-describedby="modeHelp" />
                  <span>File</span>
                </label>
              </div>
              <p id="modeHelp" class="text-sm text-gray-600 mt-1">Choose whether to hash the text you paste or a file from your device.</p>
            </fieldset>
          </div>

          <!-- Text input -->
          <div id="textBoxWrap" class="mb-4">
            <label for="textInput" class="block text-sm font-medium text-gray-800">Text to hash <span class="text-red-600" aria-hidden="true">*</span>
              <button type="button" class="ml-2 rounded-full w-8 h-8 border focus-ring" id="textTipBtn" aria-controls="textTip" aria-expanded="false" aria-label="Show help">?</button>
            </label>
            <div id="textTip" class="hidden mt-2 text-sm text-gray-600">We hash the UTF-8 bytes of this exact text, including spaces and line breaks.</div>
            <textarea id="textInput" class="mt-2 w-full min-h-[120px] p-3 border rounded focus-ring" aria-required="true" aria-describedby="textErr textTip" placeholder="Paste or type here..."></textarea>
            <p id="textErr" class="mt-2 text-sm text-red-700 hidden"></p>
          </div>

          <!-- File input -->
          <div id="fileBoxWrap" class="mb-4 hidden">
            <label for="fileInput" class="block text-sm font-medium text-gray-800">Choose a file <span class="text-red-600" aria-hidden="true">*</span></label>
            <input id="fileInput" class="mt-2 block w-full border rounded p-2 focus-ring" type="file" aria-required="true" aria-describedby="fileErr fileHelp" />
            <p id="fileHelp" class="text-sm text-gray-600 mt-1">Your file is processed locally in your browser. No upload occurs.</p>
            <p id="fileErr" class="mt-2 text-sm text-red-700 hidden"></p>
            <div id="dropZone" class="mt-3 p-4 border-2 border-dashed rounded text-sm text-gray-600">Or drag & drop a file here</div>
            <div id="progressWrap" class="hidden mt-2 text-sm"><span id="progressText">0%</span></div>
          </div>

          <!-- Algorithms -->
          <fieldset class="mb-4">
            <legend class="block text-sm font-medium text-gray-800">Algorithms</legend>
            <div class="grid grid-cols-2 sm:grid-cols-3 gap-3 mt-2">
              <label class="inline-flex items-center gap-2"><input class="focus-ring" type="checkbox" id="algMD5" checked /> MD5</label>
              <label class="inline-flex items-center gap-2"><input class="focus-ring" type="checkbox" id="algSHA1" /> SHA-1</label>
              <label class="inline-flex items-center gap-2"><input class="focus-ring" type="checkbox" id="algSHA256" checked /> SHA-256</label>
              <label class="inline-flex items-center gap-2"><input class="focus-ring" type="checkbox" id="algCRC32" checked /> CRC-32</label>
              <label class="inline-flex items-center gap-2"><input class="focus-ring" type="checkbox" id="algAdler32" /> Adler-32</label>
            </div>
          </fieldset>

          <!-- Output options -->
          <div class="mb-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
            <label class="inline-flex items-center gap-2"><input class="focus-ring" type="checkbox" id="upperHex" /> Uppercase HEX</label>
            <label class="inline-flex items-center gap-2"><input class="focus-ring" type="checkbox" id="showBase64" checked /> Show Base64</label>
          </div>

          <!-- Actions -->
          <div class="flex flex-wrap gap-3">
            <button id="calcBtn" class="px-5 py-3 bg-blue-600 text-white rounded focus-ring" type="button">Calculate</button>
            <button id="clearBtn" class="px-5 py-3 bg-gray-100 text-gray-900 rounded border focus-ring" type="button">Clear</button>
            <button id="copyAllBtn" class="px-5 py-3 bg-green-600 text-white rounded focus-ring" type="button">Copy all</button>
          </div>
        </section>

        <!-- Results (Section 4) -->
        <section id="results" class="mt-8">
          <h2 class="text-xl font-semibold mb-3">Results</h2>
          <div id="resultGrid" class="result-grid grid gap-4">
            <!-- Results injected here -->
          </div>

          <!-- Verification -->
          <div class="mt-6">
            <label for="verifyInput" class="block text-sm font-medium text-gray-800">Verify against a known checksum</label>
            <input id="verifyInput" class="mt-2 w-full p-3 border rounded focus-ring" type="text" placeholder="Paste expected hash (hex or Base64)…" aria-describedby="verifyHelp" />
            <p id="verifyHelp" class="text-sm text-gray-600 mt-1">We auto-detect encoding and highlight matches below.</p>
          </div>
        </section>
      </div>

      <!-- Authoritative Content (Section 5) -->
      <section class="bg-white p-6 rounded-lg shadow mt-8 prose">
        <h2>Authoritative data source &amp; methodology</h2>
        <ul>
          <li><strong>MD5:</strong> RFC&nbsp;1321 (R. Rivest), April 1992.</li>
          <li><strong>SHA-1 / SHA-256:</strong> FIPS&nbsp;PUB&nbsp;180-4 Secure Hash Standard, NIST, August 2015.</li>
          <li><strong>CRC-32 (IEEE 802.3 polynomial):</strong> ISO/IEC&nbsp;3309 / ITU-T V.42, widely referenced for the CRC-32 (0xEDB88320) generator.</li>
          <li><strong>Adler-32:</strong> RFC&nbsp;1950 (ZLIB), May 1996.</li>
        </ul>
        <p><em>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</em></p>

        <h2>The formula explained</h2>
        <div class="formula-box">
          For a hash function \(H\): \( d = H(m) \) where \(m\) is the input byte string and \(d\) is the digest.<br/><br/>
          For CRC-32 using polynomial arithmetic over \( \mathrm{GF}(2) \):<br/>
          \( R(x) = \left( M(x)\,x^{32} \bmod G(x) \right) \), where \(G(x)\) is the generator polynomial. The transmitted/check value is the 32-bit remainder \(R\).<br/><br/>
          Adler-32 splits a 32-bit state into \(A\) and \(B\):<br/>
          \( A = \sum_{i=1}^{n} m_i \bmod 65521,\quad B = \sum_{i=1}^{n} A_i \bmod 65521,\quad \text{Adler32}=(B \ll 16) + A. \)
        </div>

        <h2>Glossary of variables</h2>
        <ul>
          <li><strong>Input (text/file)</strong>: The exact bytes to be processed (UTF-8 for text).</li>
          <li><strong>MD5/SHA-1/SHA-256</strong>: Cryptographic hashes producing 128/160/256-bit digests.</li>
          <li><strong>CRC-32</strong>: 32-bit cyclic redundancy check for error detection.</li>
          <li><strong>Adler-32</strong>: 32-bit checksum (faster, less robust than CRC-32).</li>
          <li><strong>Hex/Base64</strong>: Encodings used to display the digest.</li>
          <li><strong>Verify</strong>: Field to compare against a known checksum.</li>
        </ul>

        <h2>How it works: a step-by-step example</h2>
        <h3 class="mt-0">Example input</h3>
        <p>Text: <code class="tt">hello</code></p>
        <h3>Computation</h3>
        <ul>
          <li>MD5: <code class="tt">5d41402abc4b2a76b9719d911017c592</code></li>
          <li>SHA-1: <code class="tt">aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d</code></li>
          <li>SHA-256: <code class="tt">2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824</code></li>
          <li>CRC-32: <code class="tt">3610a686</code></li>
          <li>Adler-32: <code class="tt">062c0215</code></li>
        </ul>
        <p>These values are produced by applying each algorithm to the UTF-8 bytes of <code class="tt">hello</code>.</p>

        <h2>FAQ</h2>
        <details><summary>Do you normalize line endings?</summary><p>No. We hash the bytes exactly as provided. If you need CRLF normalization, adjust the text before hashing.</p></details>
        <details><summary>Why is MD5 still included?</summary><p>It is widely used for legacy integrity checks and quick file de-duplication. Do not use MD5 for cryptographic security.</p></details>
        <details><summary>Can I copy all results at once?</summary><p>Yes. Use the “Copy all” button to copy an organized, multi-algorithm summary.</p></details>
        <details><summary>Uppercase vs lowercase HEX—does it matter?</summary><p>No; they represent the same value. This tool lets you toggle uppercase for convenience.</p></details>
        <details><summary>What about SHA-3 or BLAKE2?</summary><p>Not included here for bundle size and performance reasons; for integrity checks SHA-256 is widely accepted.</p></details>

        <div class="mt-6 p-4 bg-gray-50 border rounded text-sm text-gray-700">
          <p><strong>Tool developed by Ugo Candido.</strong> Content verified by the CalcDomain editorial team.<br>
          Last accuracy review: <time datetime="2025-10-26">October 26, 2025</time></p>
        </div>
      </section>
    </section>

    <aside class="w-full lg:w-1/3">
      <div class="sticky top-6 space-y-6" id="ads">
        <div class="bg-gray-200 h-72 rounded flex items-center justify-center text-gray-600">Ad Placement (300×600)</div>
        <div class="bg-white p-6 rounded shadow">
          <h3 class="font-semibold mb-3">Why this beats competitors</h3>
          <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
            <li>Accessible (WCAG 2.1 AA): labels, focus, keyboard, error hints.</li>
            <li>Multi-algorithm, multi-encoding; copy & verify workflow.</li>
            <li>Local-only processing; privacy by default.</li>
            <li>Mobile-first layout with drag-and-drop file hashing.</li>
          </ul>
        </div>
        <div class="bg-white p-6 rounded shadow">
          <h3 class="font-semibold mb-3">Related tools</h3>
          <ul class="space-y-2 text-sm">
            <li><a class="text-blue-600 hover:underline" href="base64-encoder-decoder.html">Base64 Encoder/Decoder</a></li>
            <li><a class="text-blue-600 hover:underline" href="uuid-generator.html">UUID Generator</a></li>
            <li><a class="text-blue-600 hover:underline" href="hex-binary-converter.html">HEX ⇄ Binary Converter</a></li>
          </ul>
        </div>
      </div>
    </aside>
  </div>
</main>

<footer class="bg-white border-t">
  <div class="container mx-auto px-4 py-8 text-center text-gray-600 text-sm">
    <p>&copy; 2025 CalcDomain. All rights reserved.</p>
    <div class="mt-3 space-x-4">
      <a href="about.html" class="hover:text-blue-600">About</a>
      <a href="contact.html" class="hover:text-blue-600">Contact</a>
      <a href="privacy.html" class="hover:text-blue-600">Privacy</a>
      <a href="terms.html" class="hover:text-blue-600">Terms</a>
    </div>
  </div>
</footer>

<!-- Logic (placed before </body> for performance) -->
<script>
/* ===== Utilities ===== */
const q = sel => document.querySelector(sel);
const el = (tag, attrs={}, children=[]) => {
  const n = document.createElement(tag);
  Object.entries(attrs).forEach(([k,v]) => (k in n) ? n[k]=v : n.setAttribute(k,v));
  children.forEach(c => n.append(c));
  return n;
};
const toHex = (buf, upper=false) => {
  const v = Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
  return upper ? v.toUpperCase() : v;
};
const hexToBytes = (hex) => {
  const clean = hex.replace(/\s+/g,'').toLowerCase();
  if (!/^[0-9a-f]*$/.test(clean) || clean.length%2) return null;
  const u8 = new Uint8Array(clean.length/2);
  for (let i=0;i<u8.length;i++) u8[i]=parseInt(clean.slice(i*2,i*2+2),16);
  return u8.buffer;
};
const base64ToBytes = (b64) => {
  try {
    const bin = atob(b64.replace(/\s+/g,''));
    const u8 = new Uint8Array(bin.length);
    for (let i=0;i<bin.length;i++) u8[i]=bin.charCodeAt(i);
    return u8.buffer;
  } catch { return null; }
};
const bytesToBase64 = (buf) => {
  const u8 = new Uint8Array(buf);
  let s=''; for (let i=0;i<u8.length;i++) s+=String.fromCharCode(u8[i]);
  return btoa(s);
};
const textToBytes = (s) => (new TextEncoder()).encode(s).buffer;

/* ===== Algorithms ===== */
// WebCrypto digests
async function digest(alg, data) {
  const subtleAlg = alg.toUpperCase()==='SHA-1' ? 'SHA-1' : alg.toUpperCase();
  return crypto.subtle.digest(subtleAlg, data);
}

// MD5 in JS (compact, public-domain style implementation)
/* eslint-disable */
function md5ArrayBuffer(ab) {
  function md5cycle(x, k) {
    let [a,b,c,d]=x;
    a = ff(a,b,c,d, k[0], 7, -680876936); d = ff(d,a,b,c, k[1],12,-389564586);
    c = ff(c,d,a,b, k[2],17,  606105819); b = ff(b,c,d,a, k[3],22,-1044525330);
    a = ff(a,b,c,d, k[4], 7,-176418897); d = ff(d,a,b,c, k[5],12, 1200080426);
    c = ff(c,d,a,b, k[6],17,-1473231341); b = ff(b,c,d,a, k[7],22,-45705983);
    a = ff(a,b,c,d, k[8], 7, 1770035416); d = ff(d,a,b,c, k[9],12,-1958414417);
    c = ff(c,d,a,b,k[10],17,     -42063); b = ff(b,c,d,a,k[11],22,-1990404162);
    a = ff(a,b,c,d,k[12], 7, 1804603682); d = ff(d,a,b,c,k[13],12, -40341101);
    c = ff(c,d,a,b,k[14],17,-1502002290); b = ff(b,c,d,a,k[15],22, 1236535329);

    a = gg(a,b,c,d, k[1], 5,-165796510); d = gg(d,a,b,c, k[6], 9,-1069501632);
    c = gg(c,d,a,b,k[11],14,  643717713); b = gg(b,c,d,a, k[0],20,-373897302);
    a = gg(a,b,c,d, k[5], 5,-701558691); d = gg(d,a,b,c,k[10], 9, 38016083);
    c = gg(c,d,a,b,k[15],14,-660478335); b = gg(b,c,d,a, k[4],20,-405537848);
    a = gg(a,b,c,d, k[9], 5, 568446438); d = gg(d,a,b,c,k[14], 9,-1019803690);
    c = gg(c,d,a,b, k[3],14,-187363961); b = gg(b,c,d,a, k[8],20, 1163531501);
    a = gg(a,b,c,d,k[13], 5,-1444681467); d = gg(d,a,b,c, k[2], 9,-51403784);
    c = gg(c,d,a,b, k[7],14, 1735328473); b = gg(b,c,d,a,k[12],20,-1926607734);

    a = hh(a,b,c,d, k[5], 4,-378558); d = hh(d,a,b,c, k[8],11,-2022574463);
    c = hh(c,d,a,b,k[11],16, 1839030562); b = hh(b,c,d,a,k[14],23,-35309556);
    a = hh(a,b,c,d, k[1], 4,-1530992060); d = hh(d,a,b,c, k[4],11, 1272893353);
    c = hh(c,d,a,b, k[7],16,-155497632); b = hh(b,c,d,a,k[10],23,-1094730640);
    a = hh(a,b,c,d,k[13], 4, 681279174); d = hh(d,a,b,c, k[0],11,-358537222);
    c = hh(c,d,a,b, k[3],16, -722521979); b = hh(b,c,d,a, k[6],23, 76029189);
    a = hh(a,b,c,d, k[9], 4,-640364487); d = hh(d,a,b,c,k[12],11,-421815835);
    c = hh(c,d,a,b,k[15],16, 530742520); b = hh(b,c,d,a, k[2],23,-995338651);

    a = ii(a,b,c,d, k[0], 6,-198630844); d = ii(d,a,b,c, k[7],10, 1126891415);
    c = ii(c,d,a,b,k[14],15,-1416354905); b = ii(b,c,d,a, k[5],21, -57434055);
    a = ii(a,b,c,d,k[12], 6, 1700485571); d = ii(d,a,b,c, k[3],10,-1894986606);
    c = ii(c,d,a,b,k[10],15, -1051523); b = ii(b,c,d,a, k[1],21,-2054922799);
    a = ii(a,b,c,d, k[8], 6, 1873313359); d = ii(d,a,b,c,k[15],10,-30611744);
    c = ii(c,d,a,b, k[6],15, -1560198380); b = ii(b,c,d,a, k[13],21, 1309151649);
    x[0]=(x[0]+a)|0; x[1]=(x[1]+b)|0; x[2]=(x[2]+c)|0; x[3]=(x[3]+d)|0;
  }
  function cmn(q,a,b,x,s,t){ a=(a+q+x+t)|0; return (((a<<s)|(a>>> (32-s)))+b)|0; }
  function ff(a,b,c,d,x,s,t){ return cmn((b & c) | ((~b) & d), a,b,x,s,t); }
  function gg(a,b,c,d,x,s,t){ return cmn((b & d) | (c & (~d)), a,b,x,s,t); }
  function hh(a,b,c,d,x,s,t){ return cmn(b ^ c ^ d, a,b,x,s,t); }
  function ii(a,b,c,d,x,s,t){ return cmn(c ^ (b | (~d))), a,b,x,s,t; } // eslint-disable-line no-sequences
  function md51Array(u8) {
    const n=u8.length; const state=[1732584193,-271733879,-1732584194,271733878];
    let i; for (i=64;i<=n;i+=64) md5cycle(state, md5blk(u8.subarray(i-64,i)));
    const tail=new Uint8Array(64); tail.set(u8.subarray(i-64,n));
    tail[n&63]=128; const len = n*8;
    if ((n & 63) > 55) { md5cycle(state, md5blk(tail)); tail.fill(0); }
    for (let j=0;j<8;j++) tail[56+j]=(len >>> (j*8)) & 255;
    md5cycle(state, md5blk(tail)); return state;
  }
  function md5blk(u8) {
    const blks=new Array(16);
    for (let i=0;i<16;i++) blks[i] = (u8[i*4]) | (u8[i*4+1]<<8) | (u8[i*4+2]<<16) | (u8[i*4+3]<<24);
    return blks;
  }
  const u8 = new Uint8Array(ab);
  const st = md51Array(u8);
  const out = new ArrayBuffer(16); const dv= new DataView(out);
  for (let i=0;i<4;i++) dv.setInt32(i*4, st[i], true);
  return out;
}
/* eslint-enable */

// CRC-32 (IEEE) with precomputed table
const crcTable = (()=>{ let c, table=new Uint32Array(256);
  for (let n=0;n<256;n++){ c=n; for (let k=0;k<8;k++) c = (c & 1) ? (0xEDB88320 ^ (c>>>1)) : (c>>>1); table[n]=c>>>0; }
  return table;
})();
function crc32ArrayBuffer(ab) {
  let crc = 0xFFFFFFFF; const u8 = new Uint8Array(ab);
  for (let i=0;i<u8.length;i++) crc = crcTable[(crc ^ u8[i]) & 0xFF] ^ (crc >>> 8);
  return new Uint32Array([ (crc ^ 0xFFFFFFFF) >>> 0 ]).buffer;
}
// Adler-32
function adler32ArrayBuffer(ab) {
  const MOD = 65521; let a=1, b=0; const u8=new Uint8Array(ab);
  for (let i=0;i<u8.length;i++){ a+=u8[i]; b+=a; if (i%3850===0){ a%=MOD; b%=MOD; } }
  a%=MOD; b%=MOD; const out = new ArrayBuffer(4); new DataView(out).setUint32(0, (b<<16|a)>>>0);
  return out;
}

/* ===== UI & Behavior ===== */
const state = {
  inputMode: 'text',
  upperHex: false,
  showBase64: true,
  lastBytes: null
};

function setHidden(id, hidden) { const n=q(id); if (!n) return; n.classList.toggle('hidden', hidden); }

function showError(node, msg) {
  node.textContent = msg;
  node.classList.toggle('hidden', !msg);
}

function readCurrentInput() {
  if (state.inputMode==='text') {
    const v = q('#textInput').value;
    if (!v) { showError(q('#textErr'), 'Please enter some text to hash.'); return null; }
    showError(q('#textErr'), '');
    return textToBytes(v);
  } else {
    const f = q('#fileInput').files[0];
    if (!f) { showError(q('#fileErr'), 'Please choose a file or drop one in the area above.'); return null; }
    showError(q('#fileErr'), '');
    return new Promise((resolve,reject)=>{
      const fr = new FileReader();
      fr.onload = () => resolve(fr.result);
      fr.onerror = () => reject(new Error('File read failed'));
      fr.readAsArrayBuffer(f);
    });
  }
}

function resultRow(name, hex, b64) {
  const wrap = el('div',{className:'border rounded p-4 fade-in'});
  const header = el('div',{className:'flex items-center justify-between mb-2'},
    [ el('h3',{className:'font-semibold'},[name]),
      el('div',{},[])
    ]);
  const hexLabel = el('div',{className:'text-xs text-gray-600'},['HEX']);
  const hexBox = el('div',{className:'tt break-all text-sm bg-gray-50 border rounded p-2', id:''},[hex]);
  const hexBtns = el('div',{className:'mt-2 flex gap-2'},
    [
      el('button',{className:'copy-btn px-3 py-2 bg-green-600 text-white rounded',onclick:()=>navigator.clipboard.writeText(hex)},['Copy HEX']),
    ]);
  const nodes=[header,hexLabel,hexBox,hexBtns];
  if (state.showBase64) {
    nodes.push(el('div',{className:'mt-3 text-xs text-gray-600'},['Base64']));
    nodes.push(el('div',{className:'tt break-all text-sm bg-gray-50 border rounded p-2'},[b64]));
    nodes.push(el('div',{className:'mt-2'},
      [el('button',{className:'copy-btn px-3 py-2 bg-green-600 text-white rounded',onclick:()=>navigator.clipboard.writeText(b64)},['Copy Base64'])]));
  }
  wrap.append(...nodes);
  return wrap;
}

function updateVerify() {
  const exp = q('#verifyInput').value.trim();
  const container = q('#resultGrid');
  container.querySelectorAll('[data-dhex]').forEach(block => {
    block.classList.remove('ring-2','ring-green-500','ring-red-500');
  });
  if (!exp) return;
  // Try hex, then base64
  let buf = hexToBytes(exp);
  if (!buf) buf = base64ToBytes(exp);
  if (!buf) return;
  const hexExp = toHex(buf, state.upperHex);
  container.querySelectorAll('[data-dhex]').forEach(block => {
    const val = block.getAttribute('data-dhex');
    if (val.toLowerCase() === hexExp.toLowerCase()) {
      block.classList.add('ring-2','ring-green-500');
      block.scrollIntoView({behavior:'smooth', block:'center'});
    } else {
      block.classList.add('ring-2','ring-red-500');
    }
  });
}

async function calculate() {
  try {
    const dataMaybe = readCurrentInput();
    const data = dataMaybe instanceof Promise ? await dataMaybe : dataMaybe;
    if (!data) return;
    state.lastBytes = data;

    const want = {
      md5: q('#algMD5').checked,
      sha1: q('#algSHA1').checked,
      sha256: q('#algSHA256').checked,
      crc32: q('#algCRC32').checked,
      adler32: q('#algAdler32').checked
    };
    const tasks = [];
    if (want.md5) tasks.push(['MD5', md5ArrayBuffer(data)]);
    if (want.sha1) tasks.push(['SHA-1', await digest('SHA-1', data)]);
    if (want.sha256) tasks.push(['SHA-256', await digest('SHA-256', data)]);
    if (want.crc32) tasks.push(['CRC-32', crc32ArrayBuffer(data)]);
    if (want.adler32) tasks.push(['Adler-32', adler32ArrayBuffer(data)]);

    const grid = q('#resultGrid'); grid.innerHTML='';
    const linesForCopy = [];

    tasks.forEach(([name, buf]) => {
      const hex = toHex(buf, state.upperHex);
      const b64 = bytesToBase64(buf);
      const card = resultRow(name, hex, b64);
      // mark for verification highlighting
      const hexBox = card.querySelector('.tt');
      card.setAttribute('data-dalg', name);
      card.setAttribute('data-dhex', hex);
      grid.append(card);
      linesForCopy.push(`${name}\nHEX: ${hex}${state.showBase64 ? `\nBase64: ${b64}`:''}`);
    });

    q('#copyAllBtn').onclick = () => {
      navigator.clipboard.writeText(linesForCopy.join('\n\n'));
    };

    updateVerify();
  } catch (e) {
    alert('Unexpected error while calculating: ' + (e && e.message ? e.message : e));
  }
}

function switchMode(mode) {
  state.inputMode = mode;
  setHidden('#textBoxWrap', mode!=='text');
  setHidden('#fileBoxWrap', mode!=='file');
}

/* ===== Event wiring ===== */
document.addEventListener('DOMContentLoaded', () => {
  // Mode toggle
  q('#modeText').addEventListener('change', ()=>switchMode('text'));
  q('#modeFile').addEventListener('change', ()=>switchMode('file'));

  // Tooltip
  const tipBtn = q('#textTipBtn'), tip = q('#textTip');
  tipBtn.addEventListener('click', ()=>{
    const open = tip.classList.toggle('hidden');
    tipBtn.setAttribute('aria-expanded', (!open).toString());
  });

  // Validation on blur
  q('#textInput').addEventListener('blur', () => {
    if (state.inputMode==='text' && !q('#textInput').value) showError(q('#textErr'),'Please enter some text to hash.');
    else showError(q('#textErr'),'');
  });
  q('#fileInput').addEventListener('blur', () => {
    if (state.inputMode==='file' && !q('#fileInput').files.length) showError(q('#fileErr'),'Please choose a file.');
    else showError(q('#fileErr'),'');
  });

  // Drag & drop
  const dz = q('#fileBoxWrap'); const drop = q('#dropZone');
  ['dragenter','dragover'].forEach(ev => drop.addEventListener(ev, e => { e.preventDefault(); drop.classList.add('bg-blue-50'); }));
  ['dragleave','drop'].forEach(ev => drop.addEventListener(ev, e => { e.preventDefault(); drop.classList.remove('bg-blue-50'); }));
  drop.addEventListener('drop', e => {
    const f = e.dataTransfer.files && e.dataTransfer.files[0];
    if (f) { q('#fileInput').files = e.dataTransfer.files; showError(q('#fileErr'),''); }
  });

  // Options
  q('#upperHex').addEventListener('change', (e)=>{ state.upperHex = e.target.checked; if (state.lastBytes) calculate(); });
  q('#showBase64').addEventListener('change', (e)=>{ state.showBase64 = e.target.checked; if (state.lastBytes) calculate(); });

  // Actions
  q('#calcBtn').addEventListener('click', calculate);
  q('#clearBtn').addEventListener('click', ()=>{
    q('#textInput').value=''; q('#verifyInput').value=''; q('#resultGrid').innerHTML=''; state.lastBytes=null;
    showError(q('#textErr'),''); showError(q('#fileErr'),'');
  });
  q('#verifyInput').addEventListener('input', updateVerify);

  // Defaults
  calculate();
});
</script>
</body>
</html>

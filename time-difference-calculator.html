<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Time Difference Calculator - Calculate Time Zone Offset</title>
<meta name="description" content="Calculate the exact time difference in hours between two cities or time zones. Accounts for Daylight Saving Time (DST) for any given date.">
<link rel="canonical" href="https://calcdomain.com/time-difference-calculator.html"/>
<meta name="author" content="Ugo Candido">

<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; font-weight: 500; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }

/* Stili di accessibilit√† */
.form-input, .form-select {
appearance: none;
-webkit-appearance: none;
-moz-appearance: none;
display: block;
width: 100%;
padding-left: 0.75rem;
padding-right: 0.75rem;
padding-top: 0.5rem;
padding-bottom: 0.5rem;
border-width: 1px;
border-color: #d1d5db;
border-radius: 0.375rem;
box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
}
.form-input:focus, .form-select:focus {
outline: 2px solid transparent;
outline-offset: 2px;
border-color: #2563eb;
box-shadow: 0 0 0 2px #2563eb;
}
.form-label {
display: block;
font-size: 0.875rem;
line-height: 1.25rem;
font-weight: 500;
color: #374151;
margin-bottom: 0.25rem;
}

@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
}
</style>

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "WebPage",
"name": "Time Difference Calculator",
"description": "Calculate the exact time difference in hours between two cities or time zones. Accounts for Daylight Saving Time (DST) for any given date.",
"url": "https://calcdomain.com/time-difference-calculator.html",
"inLanguage": "en",
"author": { "@type": "Person", "name": "Ugo Candido" },
"publisher": { "@type": "Organization", "name": "CalcDomain" },
"mainEntity": { "@type": "HowTo", "name": "How to Calculate Time Zone Difference", "description": "A step-by-step guide to calculating the time difference between two locations, accounting for DST.", "step": [ { "@type": "HowToStep", "name": "Select Date", "text": "Choose a specific date. This is crucial for ensuring the calculator uses the correct Daylight Saving Time (DST) rules for both locations." }, { "@type": "HowToStep", "name": "Choose First Location", "text": "Select your 'From' location or time zone from the first dropdown list." }, { "@type": "HowToStep", "name": "Choose Second Location", "text": "Select your 'To' location or time zone from the second dropdown list." }, { "@type": "HowToStep", "name": "Review Results", "text": "The calculator instantly displays the exact time difference in hours and provides a conversion example (e.g., '12:00 PM in Location A is 6:00 PM in Location B')." } ] }
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "BreadcrumbList",
"itemListElement": [
{ "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/" },
{ "@type": "ListItem", "position": 2, "name": "Everyday Life", "item": "https://calcdomain.com/lifestyle-everyday.html" },
{ "@type": "ListItem", "position": 3, "name": "Time and Date", "item": "https://calcdomain.com/subcategories/time-date.html" },
{ "@type": "ListItem", "position": 4, "name": "Time Difference Calculator", "item": "https://calcdomain.com/time-difference-calculator.html" }
]
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "FAQPage",
"mainEntity": [
{
"@type": "Question",
"name": "Why is selecting a date important?",
"acceptedAnswer": {
"@type": "Answer",
"text": "The date is critical for accurately calculating time differences because of Daylight Saving Time (DST). Different regions start and end DST on different dates. Selecting a specific date ensures our calculator uses the correct UTC offset for that exact day, providing a precise result."
}
},
{
"@type": "Question",
"name": "What's the difference between UTC, GMT, and time zones?",
"acceptedAnswer": {
"@type": "Answer",
"text": "<strong>UTC (Coordinated Universal Time)</strong> is the modern, scientific standard for time. <strong>GMT (Greenwich Mean Time)</strong> is an older standard based on the Royal Observatory in Greenwich, London, and is now often used interchangeably with UTC (specifically UTC+0). A <strong>Time Zone</strong> (like 'America/New_York' or 'Europe/Paris') is a geographical region that observes a uniform standard time, including its specific rules for DST."
}
},
{
"@type->: "Question",
"name": "Does this calculator handle the International Date Line?",
"acceptedAnswer": {
"@type": "Answer",
"text": "Yes. When you compare time zones on opposite sides of the International Date Line (e.g., New Zealand and Hawaii), the calculator will correctly show a large time difference (often > 20 hours) and the resulting time conversion will land on a different calendar day."
}
},
{
"@type": "Question",
"name": "What does 'IANA Time Zone' mean?",
"acceptedAnswer": {
"@type": "Answer",
"text": "IANA (Internet Assigned Numbers Authority) maintains the official database of global time zones (e.g., 'America/Los_Angeles', 'Asia/Tokyo'). This calculator uses these standard IANA names to ensure the highest level of accuracy for DST rules and offsets worldwide."
}
},
{
"@type": "Question",
"name": "Why is the time difference between two cities not always the same?",
"acceptedAnswer": {
"@type": "Answer",
"text": "This is almost always due to Daylight Saving Time (DST). For example, the difference between London and New York is 5 hours for part of the year, but it can become 4 or 6 hours for short periods in spring and autumn because the UK and the US switch to/from DST on different weekends."
}
]
}
</script>

<script src="search.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">
<div class="flex justify-between items-center">
<a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>
<div class="w-full max-w-md hidden md:block mx-8">
<div class="relative">
<input type="search" id="search-input" placeholder="Search for a calculator..."
class="w-full py-2 px-4 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
autocomplete="off">
<svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
</svg>
<div id="search-results" class="absolute top-full left-0 right-0 hidden bg-white border border-gray-200 rounded-lg shadow-lg mt-2 max-h-96 overflow-y-auto z-50"></div>
</div>
</div>
<div class="hidden md:flex items-center space-x-6 text-sm">
<a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
</div>
<button id="mobile-menu-toggle" class="md:hidden p-2" aria-label="Open menu">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M4 6h16M4 12h16M4 18h16"></path>
</svg>
</button>
</div>
<div id="mobile-menu" class="md:hidden mt-4 hidden">
<div class="space-y-2">
<a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
</div>
</div>
</nav>
</header>

<main class="container mx-auto px-4 lg:px-6 py-10">
<div class="flex flex-col lg:flex-row gap-8">

<section class="w-full lg:w-2/3">
<nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
<a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
<a href="lifestyle-everyday.html" class="hover:text-blue-600">Everyday Life</a> &raquo;
<a href="subcategories/time-date.html" class="hover:text-blue-600">Time and Date</a> &raquo;
<span class="text-gray-900">Time Difference Calculator</span>
</nav>

<div id="print-section" class="bg-white p-6 rounded-lg shadow-md">
<h1 class="text-3xl font-extrabold text-gray-900 mb-2">Time Difference Calculator</h1>
<p class="text-gray-600 mb-6">Quickly calculate the exact time difference (in hours) between two locations worldwide. This tool automatically accounts for Daylight Saving Time (DST) for any selected date, helping you coordinate meetings, calls, and travel.</p>

<section id="calculator-ui" aria-labelledby="calculator-heading">
<h2 id="calculator-heading" class="sr-only">Calculator Inputs</h2>
<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
<div>
<label for="calcDate" class="form-label">Date (for DST accuracy)</label>
<input type="date" id="calcDate" class="form-input">
</div>
<div class="md:col-span-1">
<label for="timezone1" class="form-label">From Location (Time Zone 1) <span class="text-red-600">*</span></label>
<select id="timezone1" class="form-select" aria-required="true" aria-describedby="error-container"></select>
</div>
<div class="md:col-span-1">
<label for="timezone2" class="form-label">To Location (Time Zone 2) <span class="text-red-600">*</span></label>
<select id="timezone2" class="form-select" aria-required="true" aria-describedby="error-container"></select>
</div>
</div>
<div id="error-container" class="text-red-600 text-sm mt-2" aria-live="assertive"></div>
</section>

<section id="results" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6 min-h-[200px]" aria-live="polite" aria-atomic="true">
<h2 class="sr-only">Calculator Results</h2>

<h3 id="resultSummary" class="text-2xl font-bold text-center text-blue-800 mb-6">
Please select two locations.
</h3>

<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
<div class="result-card">
<h4>Time Difference</h4>
<p id="timeDifferenceResult" class="text-blue-600">‚Äî</p>
</div>
<div class="result-card">
<h4>Example Conversion</h4>
<p id="conversionResult" class="text-blue-600 text-base md:text-lg lg:text-xl font-medium">‚Äî</p>
</div>
</div>
</section>
</div>

<article class="bg-white p-6 rounded-lg shadow-md mt-8 prose prose-blue">
<section id="methodology">
<h2>Data Source and Methodology</h2>
<p>This calculator uses the <strong>JavaScript Internationalization API (Intl)</strong>, which relies on the official <strong>IANA Time Zone Database (TZDB)</strong>. The TZDB is the industry-standard source for global time zone information and Daylight Saving Time (DST) rules.</p>
<p>
<strong>Authoritative Source:</strong> Internet Assigned Numbers Authority (IANA)
<br>
<strong>Reference:</strong> Time Zone Database (TZDB)
<br>
<strong>Link:</strong> <a href="https://www.iana.org/time-zones" target="_blank" rel="nofollow noopener">https://www.iana.org/time-zones</a>
</p>
<p>All calculations are based strictly on the official UTC offsets provided by this database for the selected date, which automatically includes all complex DST rules.</p>
</section>

<hr class="my-6">

<section id="formula">
<h2>The "Formula" Explained</h2>
<p>The time difference is not a static number but an algorithm that finds the precise UTC offset for each time zone on a specific date. The formula is:</p>
<div class="formula-box">
$$Difference (hours) = Offset_{TZ2} - Offset_{TZ1}$$
</div>
<p>Where:</p>
<ul>
<li>$Offset_{TZ1}$ = The UTC offset (in hours) for <strong>Timezone 1</strong> on the selected date.</li>
<li>$Offset_{TZ2}$ = The UTC offset (in hours) for <strong>Timezone 2</strong> on the selected date.</li>
</ul>
<p>The calculator determines each offset by querying the IANA database via the browser's <code>Intl</code> API, which handles all DST logic automatically.</p>
</section>

<hr class="my-6">

<section id="glossary">
<h2>Glossary of Variables</h2>
<dl class="space-y-4">
<div>
<dt class="font-semibold">Date</dt>
<dd class="ml-4">The specific date used for the calculation. This is essential because a time zone's UTC offset can change due to Daylight Saving Time (DST).</dd>
</div>
<div>
<dt class="font-semibold">From Location (Time Zone 1)</dt>
<dd class="ml-4">The base location for the comparison, using its IANA time zone name (e.g., 'America/New_York'). This is $Offset_{TZ1}$.</dd>
</div>
<div>
<dt class="font-semibold">To Location (Time Zone 2)</dt>
<dd class="ml-4">The target location for the comparison (e.g., 'Europe/Rome'). This is $Offset_{TZ2}$.</dd>
</div>
<div>
<dt class="font-semibold">Time Difference</dt>
<dd class="ml-4">The final result, in hours. A positive number means the 'To' location is <strong>ahead</strong> of the 'From' location. A negative number means it is <strong>behind</strong>.</dd>
</div>
</dl>
</section>

<hr class="my-6">

<section id="example">
<h2>How It Works: A Step-by-Step Example</h2>
<p>Let's calculate the time difference between <strong>New York</strong> and <strong>Rome</strong> for two different dates.</p>

<h3>Example 1: Date is August 15, 2025 (Summer)</h3>
<ol>
<li><strong>Date Selected:</strong> August 15, 2025.</li>
<li><strong>Timezone 1 (New York):</strong> The tool finds the offset for 'America/New_York'. In August, New York is on Eastern Daylight Time (EDT).
<ul><li>$Offset_{TZ1} = \text{UTC-4.0 hours}$</li></ul>
</li>
<li><strong>Timezone 2 (Rome):</strong> The tool finds the offset for 'Europe/Rome'. In August, Rome is on Central European Summer Time (CEST).
<ul><li>$Offset_{TZ2} = \text{UTC+2.0 hours}$</li></ul>
</li>
<li><strong>Calculation:</strong>
<ul><li>$Difference = (+2.0) - (-4.0) = 6.0 \text{ hours}$</li></ul>
</li>
<li><strong>Result:</strong> Rome is 6 hours ahead of New York.</li>
</ol>

<h3>Example 2: Date is January 15, 2026 (Winter)</h3>
<ol>
<li><strong>Date Selected:</strong> January 15, 2026.</li>
<li><strong>Timezone 1 (New York):</strong> In January, New York is on Eastern Standard Time (EST).
<ul><li>$Offset_{TZ1} = \text{UTC-5.0 hours}$</li></ul>
</li>
<li><strong>Timezone 2 (Rome):</strong> In January, Rome is on Central European Time (CET).
<ul><li>$Offset_{TZ2} = \text{UTC+1.0 hours}$</li></ul>
</li>
<li><strong>Calculation:</strong>
<ul><li>$Difference = (+1.0) - (-5.0) = 6.0 \text{ hours}$</li></ul>
</li>
<li><strong>Result:</strong> Rome is 6 hours ahead of New York. (In this specific case, the difference remains the same, but this is not always true for all city pairs, like London/New York).</li>
</ol>
</section>

<hr class="my-6">

<section id="faq">
<h2>Frequently Asked Questions (FAQ)</h2>
<details>
<summary>Why is selecting a date important?</summary>
<p>The date is critical for accurately calculating time differences because of Daylight Saving Time (DST). Different regions start and end DST on different dates. Selecting a specific date ensures our calculator uses the correct UTC offset for that exact day, providing a precise result.</p>
</details>
<details>
<summary>What's the difference between UTC, GMT, and time zones?</summary>
<p><strong>UTC (Coordinated Universal Time)</strong> is the modern, scientific standard for time. <strong>GMT (Greenwich Mean Time)</strong> is an older standard based on the Royal Observatory in Greenwich, London, and is now often used interchangeably with UTC (specifically UTC+0). A <strong>Time Zone</strong> (like 'America/New_York' or 'Europe/Paris') is a geographical region that observes a uniform standard time, including its specific rules for DST.</p>
</details>
<details>
<summary>Does this calculator handle the International Date Line?</summary>
<p>Yes. When you compare time zones on opposite sides of the International Date Line (e.g., New Zealand and Hawaii), the calculator will correctly show a large time difference (often > 20 hours) and the resulting time conversion will land on a different calendar day.</p>
</details>
<details>
<summary>What does 'IANA Time Zone' mean?</summary>
<p>IANA (Internet Assigned Numbers Authority) maintains the official database of global time zones (e.g., 'America/Los_Angeles', 'Asia/Tokyo'). This calculator uses these standard IANA names to ensure the highest level of accuracy for DST rules and offsets worldwide.</p>
</details>
<details>
<summary>Why is the time difference between two cities not always the same?</summary>
<p>This is almost always due to Daylight Saving Time (DST). For example, the difference between London and New York is 5 hours for part of the year, but it can become 4 or 6 hours for short periods in spring and autumn because the UK and the US switch to/from DST on different weekends.</p>
</details>
</section>

<div class="mt-8 pt-6 border-t border-gray-200 text-sm text-gray-600">
<p><strong>Tool developed by Ugo Candido.</strong> Contents verified by the CalcDomain Editorial Board.<br>
Last accuracy review: <time datetime="2025-10-24">October 24, 2025</time></p>
</div>
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why Use This Calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Get instant, accurate time offsets.</li>
<li>Automatically handles all Daylight Saving Time (DST) rules.</li>
<li>Perfect for scheduling international meetings or calls.</li>
<li>Plan travel across multiple time zones.</li>
<li>Based on the official IANA time zone database.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Time Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="time-duration-calculator.html" class="text-blue-600 hover:underline">Time Duration Calculator</a></li>
<li><a href="date-calculator.html" class="text-blue-600 hover:underline">Date Calculator</a></li>
<li><a href="meeting-planner.html" class="text-blue-600 hover:underline">World Meeting Planner</a></li>
<li><a href="hours-calculator.html" class="text-blue-600 hover:underline">Hours Calculator</a></li>
</ul>
</div>
<div class="bg-gray-200 h-64 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300x250)
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-white border-t mt-12">
<div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
<p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
<div class="mt-4 space-x-4">
<a href="about.html" class="hover:text-blue-600">About</a>
<a href="contact.html" class="hover:text-blue-600">Contact</a>
<a href="privacy.html" class="hover:text-blue-600">Privacy</a>
<a href="terms.html" class="hover:text-blue-600">Terms</a>
</div>
</div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
// --- 1. Elementi DOM ---
const elements = {
calcDate: document.getElementById('calcDate'),
timezone1: document.getElementById('timezone1'),
timezone2: document.getElementById('timezone2'),
resultSummary: document.getElementById('resultSummary'),
timeDifferenceResult: document.getElementById('timeDifferenceResult'),
conversionResult: document.getElementById('conversionResult'),
errorContainer: document.getElementById('errorContainer')
};

// --- 2. Database Timezone (sottogruppo comune IANA) ---
const timezones = [
{ iana: "Pacific/Midway", name: "Midway (UTC-11:00)" },
{ iana: "Pacific/Honolulu", name: "Honolulu (UTC-10:00)" },
{ iana: "America/Anchorage", name: "Anchorage (UTC-09:00)" },
{ iana: "America/Los_Angeles", name: "Los Angeles (PST/PDT)" },
{ iana: "America/Denver", name: "Denver (MST/MDT)" },
{ iana: "America/Chicago", name: "Chicago (CST/CDT)" },
{ iana: "America/New_York", name: "New York (EST/EDT)" },
{ iana: "America/Caracas", name: "Caracas (UTC-04:00)" },
{ iana: "America/Halifax", name: "Halifax (AST/ADT)" },
{ iana: "America/Sao_Paulo", name: "S√£o Paulo (UTC-03:00)" },
{ iana: "America/Argentina/Buenos_Aires", name: "Buenos Aires (UTC-03:00)" },
{ iana: "Atlantic/South_Georgia", name: "South Georgia (UTC-02:00)" },
{ iana: "Atlantic/Azores", name: "Azores (UTC-01:00)" },
{ iana: "Europe/London", name: "London (GMT/BST)" },
{ iana: "UTC", name: "UTC (UTC+00:00)" },
{ iana: "Europe/Rome", name: "Rome, Berlin (CET/CEST)" },
{ iana: "Europe/Athens", name: "Athens, Cairo (EET/EEST)" },
{ iana: "Europe/Moscow", name: "Moscow (UTC+03:00)" },
{ iana: "Asia/Dubai", name: "Dubai (UTC+04:00)" },
{ iana: "Asia/Karachi", name: "Karachi (UTC+05:00)" },
{ iana: "Asia/Dhaka", name: "Dhaka (UTC+06:00)" },
{ iana: "Asia/Bangkok", name: "Bangkok (UTC+07:00)" },
{ iana: "Asia/Shanghai", name: "Shanghai, Perth (UTC+08:00)" },
{ iana: "Asia/Tokyo", name: "Tokyo (UTC+09:00)" },
{ iana: "Australia/Sydney", name: "Sydney (AEST/AEDT)" },
{ iana: "Pacific/Guadalcanal", name: "Solomon Is. (UTC+11:00)" },
{ iana: "Pacific/Auckland", name: "Auckland (UTC+12:00)" },
{ iana: "Pacific/Fiji", name: "Fiji (UTC+12:00)" }
];

// --- 3. Funzioni Helper ---

/**
* Popola i dropdown delle timezone
*/
function populateTimezones() {
const fragment1 = document.createDocumentFragment();
const fragment2 = document.createDocumentFragment();

const placeholder = document.createElement('option');
placeholder.value = "";
placeholder.textContent = "Select a location...";
placeholder.disabled = true;
fragment1.appendChild(placeholder);
fragment2.appendChild(placeholder.cloneNode(true));

timezones.forEach(tz => {
const option = document.createElement('option');
option.value = tz.iana;
option.textContent = tz.name;
fragment1.appendChild(option);
fragment2.appendChild(option.cloneNode(true));
});

elements.timezone1.appendChild(fragment1);
elements.timezone2.appendChild(fragment2);
}

/**
* Ottiene l'offset UTC in ore per una data timezone in una data specifica
* @param {string} tz - IANA time zone name
* @param {Date} date - La data per cui calcolare l'offset
* @returns {number} - L'offset in ore (es. -4, +5.5)
*/
function getOffsetHours(tz, date) {
try {
const formatter = new Intl.DateTimeFormat('en', {
timeZone: tz,
timeZoneName: 'longOffset',
});
const parts = formatter.formatToParts(date);
const offsetPart = parts.find(p => p.type === 'timeZoneName');

if (!offsetPart) return 0; // Fallback

// Stringa in formato "GMT-04:00" or "GMT+05:30"
const offsetStr = offsetPart.value.replace('GMT', ''); // "-04:00" or "+05:30"
const timeParts = offsetStr.split(':');
const hours = parseFloat(timeParts[0]); // -4 or +5
const minutes = parseFloat(timeParts[1]) || 0; // 0 or 30
const sign = hours < 0 || Object.is(hours, -0) ? -1 : 1; // Gestisce -0

return hours + (sign * (minutes / 60));
} catch (e) {
console.error(`Invalid time zone: ${tz}`, e);
elements.errorContainer.textContent = `Error: Could not parse time zone '${tz}'. Please refresh.`;
return NaN;
}
}

/**
* Funzione di calcolo principale
*/
function calculateDifference() {
const tz1 = elements.timezone1.value;
const tz2 = elements.timezone2.value;
const dateStr = elements.calcDate.value;

// Validazione
if (!tz1 || !tz2) {
elements.resultSummary.textContent = 'Please select two locations.';
elements.timeDifferenceResult.textContent = '‚Äî';
elements.conversionResult.textContent = '‚Äî';
elements.errorContainer.textContent = 'Both a "From" and "To" location are required.';
return;
}
elements.errorContainer.textContent = ''; // Pulisce errori

// Usa mezzogiorno sulla data selezionata per evitare transizioni DST
const date = dateStr ? new Date(dateStr + 'T12:00:00Z') : new Date();
if (isNaN(date)) {
elements.errorContainer.textContent = 'Invalid date selected.';
return;
}


// Calcola offset
const offset1 = getOffsetHours(tz1, date);
const offset2 = getOffsetHours(tz2, date);

if (isNaN(offset1) || isNaN(offset2)) return; // Errore gestito in getOffsetHours

const diff = offset2 - offset1;
const absDiff = Math.abs(diff);

// Ottiene nomi puliti
const tz1Name = timezones.find(t => t.iana === tz1).name.split(' (')[0];
const tz2Name = timezones.find(t => t.iana === tz2).name.split(' (')[0];

// --- Aggiorna UI ---

// 1. Riepilogo testuale
let summary = '';
if (diff === 0) {
summary = `<strong>${tz1Name}</strong> and <strong>${tz2Name}</strong> are in the same time zone.`;
} else if (diff > 0) {
summary = `<strong>${tz2Name}</strong> is <strong>${absDiff}</strong> hours <strong>ahead</strong> of <strong>${tz1Name}</strong>.`;
} else {
summary = `<strong>${tz2Name}</strong> is <strong>${absDiff}</strong> hours <strong>behind</strong> of <strong>${tz1Name}</strong>.`;
}
elements.resultSummary.innerHTML = summary;

// 2. Scheda Differenza Oraria
elements.timeDifferenceResult.textContent = `${diff.toFixed(1)} hours`;

// 3. Scheda Esempio Conversione
// Crea una data di esempio (12:00 PM) e applica la differenza
const exampleDate = new Date('2025-01-01T12:00:00'); // 12:00
exampleDate.setHours(exampleDate.getHours() + diff); // Applica offset
const targetTime = exampleDate.toLocaleTimeString('en-US', {
hour: 'numeric',
minute: '2-digit',
hour12: true
});

elements.conversionResult.innerHTML = `12:00 PM in ${tz1Name} is <br><strong>${targetTime} in ${tz2Name}</strong>`;
}

// --- 4. Inizializzazione ---

// Popola i dropdown
populateTimezones();

// Imposta la data di oggi
try {
elements.calcDate.value = new Date().toISOString().split('T')[0];
} catch (e) {
// Fallback per browser vecchi
elements.calcDate.value = '2025-10-27';
}


// Imposta valori predefiniti
elements.timezone1.value = 'America/New_York';
elements.timezone2.value = 'Europe/London';

// Aggiungi listener
elements.calcDate.addEventListener('input', calculateDifference);
elements.timezone1.addEventListener('input', calculateDifference);
elements.timezone2.addEventListener('input', calculateDifference);

// Calcola al caricamento
calculateDifference();
});
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en"><head> 
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
<meta charset="utf-8"/>
<title>Factor of Safety Calculator | Mechanical Engineering Tool</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="Professional factor of safety (FoS) calculator for mechanical engineers. Compute FoS, margin of safety, and allowable stress from material strength and applied stress. WCAG 2.1 AA accessible, mobile-first, and optimized for Core Web Vitals." name="description"/>
<meta content="Ugo Candido" name="author"/>
<link href="https://calcdomain.com/factor-of-safety.html" rel="canonical"/>
<meta content="index, follow, max-image-preview:large" name="robots"/>
<meta content="#005A9C" name="theme-color"/>
<meta content="website" property="og:type"/>
<meta content="Factor of Safety Calculator" property="og:title"/>
<meta content="Compute factor of safety (FoS), margin of safety, and allowable stress based on strength and applied stress." property="og:description"/>
<meta content="https://calcdomain.com/engineering/mechanical/factor-of-safety-calculator" property="og:url"/>
<meta content="CalcDomain" property="og:site_name"/>
<meta content="factor of safety calculator, safety factor calculator, mechanical engineering, margin of safety, allowable stress" name="keywords"/>
<style>
    /* Design Tokens */
    :root{
      --primary:#005A9C; --secondary:#003F6E; --accent:#00A4E4;
      --bg:#F8F9FA; --surface:#FFFFFF;
      --text:#212529; --muted:#6C757D;
      --border:#DEE2E6; --success:#198754; --danger:#DC3545; --warn:#FFC107;
      --radius:12px; --radius-sm:8px;
      --shadow:0 4px 10px rgba(0,0,0,.06);
      --touch:48px;
    }
    /* Base */
    *,*::before,*::after{box-sizing:border-box}
    html{font-size:clamp(16px,2.4vw,18px); -webkit-text-size-adjust:100%}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial,sans-serif; line-height:1.6; background:var(--bg); color:var(--text)}
    a{color:var(--primary); text-decoration:none}
    a:hover{color:#00345d; text-decoration:underline}
    img{max-width:100%; height:auto}
    h1,h2,h3{line-height:1.25; color:var(--secondary); margin:.25rem 0 .75rem}
    h1{font-size:clamp(1.8rem,4.5vw,2.5rem)}
    h2{font-size:clamp(1.4rem,3.5vw,2rem)}
    h3{font-size:clamp(1.2rem,3vw,1.6rem)}
    p{margin:0 0 1rem}
    .container{max-width:1200px; margin:0 auto; padding:0 clamp(1rem,4vw,2rem)}
    .skip-link{position:absolute; left:8px; top:-40px; background:var(--primary); color:#fff; padding:.5rem .75rem; border-radius:6px; z-index:1000}
    .skip-link:focus{top:8px; outline:3px solid #fff; outline-offset:2px}

    /* Header (non-sticky for best mobile viewport usage) */
    header{background:var(--surface); border-bottom:1px solid var(--border)}
    .header-inner{display:grid; grid-template-columns:auto 1fr; gap:.75rem; align-items:center; padding:.75rem 0}
    .brand{font-weight:800; color:var(--primary); font-size:1.25rem}
    nav ul{list-style:none; margin:0; padding:0; display:flex; gap:.75rem; flex-wrap:wrap}
    nav a{display:inline-block; padding:.5rem .6rem; border-radius:8px}
    nav a:focus{outline:3px solid var(--primary); outline-offset:2px}

    /* Main layout */
    .main{padding:1.25rem 0 2rem}
    .breadcrumb{font-size:.95rem; color:var(--muted); margin:0 0 .75rem}
    .layout{display:grid; grid-template-columns:1fr; gap:1.5rem}
    @media (min-width: 992px){
      .layout{grid-template-columns: minmax(300px,420px) 1fr}
    }

    /* Card/Panel */
    .card{background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); padding:1.25rem; box-shadow:var(--shadow)}
    .panel-title{margin:0 0 .75rem}

    /* Form */
    .form-group{margin-bottom:1rem}
    .form-row{display:grid; grid-template-columns:1fr auto; gap:.5rem; align-items:end}
    label{display:inline-flex; align-items:center; gap:.5rem; font-weight:700}
    .required::after{content:" *"; color:var(--danger); font-weight:700}
    .help-btn{appearance:none; border:1px solid var(--border); background:var(--surface); color:var(--primary); border-radius:999px; width:var(--touch); height:var(--touch); min-width:var(--touch); display:inline-flex; align-items:center; justify-content:center; font-weight:800; cursor:pointer}
    .help-btn:hover{background:#eef6ff}
    .help-btn:focus{outline:3px solid var(--primary); outline-offset:2px}
    .tooltip{margin:.5rem 0 0; background:#eef6ff; border:1px solid #b6d7ff; color:#0A2A43; padding:.75rem; border-radius:8px}
    .hid{display:none}
    .control{
      width:100%; padding:.75rem 1rem; min-height:var(--touch);
      border:1px solid var(--border); border-radius:10px; font-size:1rem; background:#fff
    }
    .control:focus{outline:3px solid rgba(0,90,156,.2); border-color:var(--primary)}
    .control[aria-invalid="true"]{border-color:var(--danger)}
    .unit-select{min-width:90px}
    .radio-group{display:flex; gap:.5rem; flex-wrap:wrap}
    .radio-pill{position:relative}
    .radio-pill input{position:absolute; inset:0; opacity:0}
    .radio-pill span{
      display:inline-flex; align-items:center; justify-content:center; padding:.5rem .75rem; min-height:var(--touch);
      border:1px solid var(--border); border-radius:999px; font-weight:600; cursor:pointer
    }
    .radio-pill input:checked + span{background:var(--primary); color:#fff; border-color:var(--primary)}
    .radio-pill input:focus-visible + span{outline:3px solid var(--primary); outline-offset:2px}

    .error{color:var(--danger); font-size:.93rem; margin-top:.35rem}

    /* Results */
    .results{margin-top:1rem; border:1px solid var(--border); border-radius:var(--radius); background:#FBFCFD; padding:1rem; min-height:240px}
    .result-row{display:flex; justify-content:space-between; gap:1rem; padding:.6rem 0; border-bottom:1px solid var(--border)}
    .result-row:last-child{border-bottom:0}
    .label{color:var(--muted)}
    .value{font-weight:800; font-size:1.15rem; color:#0a5230}
    .value.bad{color:#7a0611}
    .status{display:inline-flex; align-items:center; gap:.5rem; padding:.35rem .6rem; border-radius:999px; border:1px solid var(--border); font-weight:700}
    .pass{background:#e8f6ee; color:#0f6b3d; border-color:#cdebd9}
    .fail{background:#fdeaea; color:#7a0611; border-color:#f3c6c6}

    /* Content sections */
    .content h2{border-bottom:1px solid var(--border); padding-bottom:.35rem; margin-top:1.25rem}
    .formula-box{background:#eef2f7; border:1px solid #d9e2ef; padding:1rem; border-radius:10px; overflow:auto}
    .latex{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; font-size:1.05rem}

    /* Footer */
    footer{background:var(--secondary); color:#fff; margin-top:2rem}
    .footer-inner{display:grid; gap:1.5rem; grid-template-columns:repeat(auto-fit, minmax(220px,1fr)); padding:1.5rem 0}
    .footer-bottom{text-align:center; border-top:1px solid rgba(255,255,255,.25); padding:1rem 0; font-size:.95rem}
    footer a{color:#fff}
    footer a:hover{color:#cfe8ff; text-decoration:none}

    /* Utilities */
    .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
  </style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Factor of Safety Calculator",
  "description": "Compute factor of safety (FoS), margin of safety, and allowable stress from material strength and applied stress. Accessible, mobile-first, and optimized for Core Web Vitals.",
  "url": "https://calcdomain.com/factor-of-safety.html",
  "inLanguage": "en",
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  },
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "Calculate factor of safety",
      "description": "Use material strength and applied stress to compute FoS, margin of safety, and allowable stress.",
      "totalTime": "PT0M",
      "estimatedCost": {
        "@type": "MonetaryAmount",
        "currency": "USD",
        "value": "0"
      },
      "tool": [
        {
          "@type": "HowToTool",
          "name": "Online Factor of Safety Calculator"
        }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "name": "Select strength basis",
          "text": "Choose Yield (Sy) or Ultimate (Su) strength and pick your preferred unit system."
        },
        {
          "@type": "HowToStep",
          "name": "Enter material strength",
          "text": "Provide the material strength value (e.g., 250 MPa)."
        },
        {
          "@type": "HowToStep",
          "name": "Enter applied stress",
          "text": "Provide the maximum expected working stress (e.g., 120 MPa)."
        },
        {
          "@type": "HowToStep",
          "name": "Optional: Set target FoS",
          "text": "Adjust the target FoS to compute allowable stress and pass/fail status."
        },
        {
          "@type": "HowToStep",
          "name": "Review results",
          "text": "Read FoS, Margin of Safety, Allowable Stress, and Pass/Fail status."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is factor of safety (FoS)?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "FoS is the ratio of material strength to the actual applied stress. A FoS above 1 indicates the design can carry the load under the assumed conditions."
          }
        },
        {
          "@type": "Question",
          "name": "Should I use yield or ultimate strength?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Use yield strength (Sy) for ductile materials when permanent deformation is the limiting state. Use ultimate strength (Su) for brittle materials or when fracture is the limiting state."
          }
        },
        {
          "@type": "Question",
          "name": "Is factor of safety unitless?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. FoS is a ratio of two stresses (strength and applied stress), so units cancel out."
          }
        },
        {
          "@type": "Question",
          "name": "What is margin of safety (MS)?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Margin of Safety is MS = FoS − 1. A positive MS indicates additional capacity beyond the working load."
          }
        },
        {
          "@type": "Question",
          "name": "What are typical target FoS values?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Typical targets vary by industry and uncertainty. For well-controlled, tested components FoS can be 1.2–1.5; for common mechanical designs 1.5–2.0; for high uncertainty or life-safety systems, higher values may be mandated by codes or standards."
          }
        },
        {
          "@type": "Question",
          "name": "How does stress concentration affect FoS?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Applied stress should include local peak stresses (e.g., Kt effects). Using a lower, averaged stress can overestimate FoS."
          }
        },
        {
          "@type": "Question",
          "name": "What happens if applied stress is zero?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "FoS tends to infinity mathematically. In practice, verify that your loading and stress computation are correct."
          }
        }
      ]
    }
  ]
}
  </script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer></script>
<!-- MathJax for LaTeX formulas -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\(','\)'], ['$', '$']],
      displayMath: [['\[','\]']]
    },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="preload" href="/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="/assets/js/page-enhancements.js" as="script">

</head>
<body>

<a class="skip-link" href="#main-content">Skip to main content</a>
<header aria-label="Site header">
<div class="container header-inner">
<a aria-label="CalcDomain home" class="brand" href="/">CalcDomain</a>
<nav aria-label="Primary">
<ul>
<li><a href="https://calcdomain.com/engineering.html">Engineering</a></li>
<li><a href="https://calcdomain.com/mechanical.html">Mechanical</a></li>
<li><a href="https://calcdomain.com/about.html">About</a></li>
</ul>
</nav>
</div>
</header>
<main class="main" id="main-content" role="main">
<div class="container">
<nav aria-label="Breadcrumb" class="breadcrumb">
<a href="/">Home</a> / <a href="https://calcdomain.com/engineering.html">Engineering</a> / <a href="https://calcdomain.com/mechanical.html">Mechanical</a> / Factor of Safety Calculator
      </nav>
<h1>Factor of Safety Calculator</h1>
<p>This professional-grade calculator helps engineers and students quickly compute Factor of Safety (FoS), Margin of Safety, and Allowable Stress from material strength and applied stress. It is ideal for preliminary sizing, design checks, and instruction in mechanical design principles.</p>
<div class="layout" id="calculator-area">
<!-- Calculator -->
<aside aria-labelledby="calc-title" class="card" id="fos-calculator">
<h2 class="panel-title" id="calc-title">Calculator</h2>
<div class="form-group">
<fieldset>
<legend class="sr-only">Strength basis</legend>
<div aria-label="Strength basis" class="radio-group" role="radiogroup">
<label class="radio-pill">
<input checked="" id="basisYield" name="strengthBasis" type="radio" value="yield"/>
<span>Yield strength (Sy)</span>
</label>
<label class="radio-pill">
<input id="basisUltimate" name="strengthBasis" type="radio" value="ultimate"/>
<span>Ultimate strength (Su)</span>
</label>
</div>
</fieldset>
</div>
<div class="form-group">
<div class="form-row">
<label class="required" for="strengthValue" id="strengthLabel">
                Material strength
                <button aria-controls="strengthHelp" aria-expanded="false" aria-label="Help: Material strength" class="help-btn" id="strengthHelpBtn" type="button">?</button>
</label>
<select aria-label="Strength unit" class="control unit-select" id="strengthUnit">
<option value="Pa">Pa</option>
<option value="kPa">kPa</option>
<option selected="" value="MPa">MPa</option>
<option value="GPa">GPa</option>
<option value="psi">psi</option>
<option value="ksi">ksi</option>
</select>
</div>
<input aria-describedby="strengthHelp strengthError" aria-required="true" class="control" id="strengthValue" inputmode="decimal" min="0" placeholder="e.g., 250" step="any" type="number"/>
<div class="tooltip hid" id="strengthHelp" role="note">
              Enter the material strength in the selected basis (Yield for ductile, Ultimate for brittle). Example: Steel Sy ≈ 250 MPa.
            </div>
<div aria-live="polite" class="error" id="strengthError" role="alert"></div>
</div>
<div class="form-group">
<div class="form-row">
<label class="required" for="stressValue">
                Applied (working) stress
                <button aria-controls="stressHelp" aria-expanded="false" aria-label="Help: Applied stress" class="help-btn" id="stressHelpBtn" type="button">?</button>
</label>
<select aria-label="Applied stress unit" class="control unit-select" id="stressUnit">
<option value="Pa">Pa</option>
<option value="kPa">kPa</option>
<option selected="" value="MPa">MPa</option>
<option value="GPa">GPa</option>
<option value="psi">psi</option>
<option value="ksi">ksi</option>
</select>
</div>
<input aria-describedby="stressHelp stressError" aria-required="true" class="control" id="stressValue" inputmode="decimal" min="0" placeholder="e.g., 120" step="any" type="number"/>
<div class="tooltip hid" id="stressHelp" role="note">
              Use the maximum expected service stress, including factors like stress concentrations (Kt) where appropriate. If needed, compute stress as σ = F / A.
            </div>
<div aria-live="polite" class="error" id="stressError" role="alert"></div>
</div>
<div class="form-group">
<label for="targetFos">
              Target FoS (optional)
              <button aria-controls="targetHelp" aria-expanded="false" aria-label="Help: Target FoS" class="help-btn" id="targetHelpBtn" type="button">?</button>
</label>
<input aria-describedby="targetHelp targetError" class="control" id="targetFos" inputmode="decimal" min="0" placeholder="e.g., 1.8" step="any" type="number"/>
<div class="tooltip hid" id="targetHelp" role="note">
              Set your desired minimum FoS to compute the allowable stress and a pass/fail status. Typical ranges: 1.5–2.0 for general mechanical design; follow your governing code.
            </div>
<div aria-live="polite" class="error" id="targetError" role="alert"></div>
</div>
<section aria-labelledby="resultsTitle" aria-live="polite" class="results">
<h3 class="sr-only" id="resultsTitle">Results</h3>
<div class="result-row">
<span class="label">Factor of Safety (FoS)</span>
<span class="value" id="fosOut">—</span>
</div>
<div class="result-row">
<span class="label">Margin of Safety (MS)</span>
<span class="value" id="msOut">—</span>
</div>
<div class="result-row">
<span class="label">Allowable stress (for target FoS)</span>
<span class="value" id="allowOut">—</span>
</div>
<div class="result-row">
<span class="label">Status</span>
<span aria-live="polite" class="status" id="statusOut" role="status">Awaiting input</span>
</div>
</section>
</aside>
<!-- Content -->
<article class="content card">
<h2>Data Source and Methodology</h2>
<p><strong>Authoritative Sources:</strong></p>
<ul>
<li>J. E. Shigley, C. R. Mischke, R. G. Budynas, Shigley's Mechanical Engineering Design, 11th ed., McGraw-Hill, 2020. <a href="https://www.mheducation.com/highered/product/shigley-s-mechanical-engineering-design-budynas-nisbett/M9781260367051.html" rel="nofollow noopener" target="_blank">Publisher page</a></li>
<li>NASA-STD-5001 Rev E (2022), Structural Design and Test Factors of Safety for Spaceflight Hardware. <a href="https://standards.nasa.gov/standard/nasa/nasa-std-5001" rel="nofollow noopener" target="_blank">Official NASA standard</a></li>
</ul>
<p>All calculations are strictly based on the definitions and formulas provided by these sources. This tool implements the fundamental relationships for Factor of Safety (FoS), Margin of Safety (MS), and Allowable Stress.</p>
<h2>The Formula Explained</h2>
<div class="formula-box">
<div class="latex">FoS = Strength / AppliedStress</div>
<div class="latex" style="margin-top:.5rem">MS = FoS - 1</div>
<div class="latex" style="margin-top:.5rem">σ_allow = Strength / FoS_target</div>
<div class="latex" style="margin-top:.5rem">σ = F / A</div>
<p style="margin-top:.5rem">Select strength as Sy (yield) for ductile design or Su (ultimate) for brittle/fracture-limited design.</p>
</div>
<h2>Glossary of Variables</h2>
<ul>
<li>Strength (Sy or Su): Material resistance to yielding (Sy) or fracture (Su), in units of stress.</li>
<li>Applied stress (σ): Maximum expected working stress under service loads.</li>
<li>FoS: Factor of Safety, unitless ratio Strength/Applied stress.</li>
<li>MS: Margin of Safety, unitless, MS = FoS − 1.</li>
<li>σ_allow: Allowable stress that meets a chosen target FoS.</li>
<li>FoS_target: Designer’s chosen minimum factor of safety.</li>
</ul>
<h2>How It Works: A Step-by-Step Example</h2>
<p>Suppose a ductile steel has yield strength Sy = 250 MPa and the maximum working stress is σ = 120 MPa. You want a target FoS of 1.8.</p>
<ol>
<li>Compute FoS: FoS = 250 / 120 ≈ 2.083.</li>
<li>Margin of Safety: MS = 2.083 − 1 = 1.083.</li>
<li>Allowable stress for target: σ_allow = 250 / 1.8 ≈ 138.89 MPa.</li>
<li>Status: Since 120 MPa ≤ 138.89 MPa, the design passes the 1.8 target.</li>
</ol>
<h2>Frequently Asked Questions (FAQ)</h2>
<h3>Is the factor of safety dimensionless?</h3>
<p>Yes. It is a ratio of two stresses, so units cancel out.</p>
<h3>Which strength should I use?</h3>
<p>Use yield strength (Sy) when preventing permanent deformation is critical (ductile materials). Use ultimate strength (Su) when fracture controls (brittle materials) or when required by your code.</p>
<h3>What is a typical FoS?</h3>
<p>There is no universal value. Common ranges are 1.5–2.0 for general mechanical design, lower for highly controlled and tested systems, and higher for life-safety or high-uncertainty situations. Follow your governing standards.</p>
<h3>Does load combination or dynamic effects matter?</h3>
<p>Yes. You should include appropriate load factors, dynamic amplification, and stress concentration factors so the applied stress reflects worst-case conditions within your design framework.</p>
<h3>What is Margin of Safety?</h3>
<p>MS = FoS − 1. A positive MS means reserve capacity beyond the working load; zero means at the limit; negative means overstressed.</p>
<h3>Can I mix units?</h3>
<p>Enter both strength and stress in the same unit family using the unit menus. The calculator handles conversions consistently.</p>
<h3>Where can I learn more?</h3>
<p>Consult Shigley’s Mechanical Engineering Design and NASA-STD-5001 for formal definitions and recommended safety factors. For a general overview, see the topic page on factor of safety by reputable institutions.</p>
<div class="author" style="margin-top:1rem; padding-top:1rem; border-top:1px solid var(--border); color:var(--muted); font-size:.95rem">
            Tool developed by <strong>Ugo Candido</strong>. Content verified by <strong>Mechanical Engineering QA Team</strong>.<br/>
            Last reviewed for accuracy on: September 15, 2025.
          </div>
</article>
</div>
</div>
</main>
<!-- Standard Footer --> 
<script defer="">
    (function(){
      "use strict";

      // Unit factors to Pascals
      const unitFactor = {
        Pa: 1,
        kPa: 1e3,
        MPa: 1e6,
        GPa: 1e9,
        psi: 6894.757293168,
        ksi: 6894.757293168 * 1000
      };

      // DOM elements
      const strengthValue = document.getElementById('strengthValue');
      const stressValue   = document.getElementById('stressValue');
      const targetFos     = document.getElementById('targetFos');

      const strengthUnit  = document.getElementById('strengthUnit');
      const stressUnit    = document.getElementById('stressUnit');

      const basisYield    = document.getElementById('basisYield');
      const basisUltimate = document.getElementById('basisUltimate');

      const strengthError = document.getElementById('strengthError');
      const stressError   = document.getElementById('stressError');
      const targetError   = document.getElementById('targetError');

      const fosOut   = document.getElementById('fosOut');
      const msOut    = document.getElementById('msOut');
      const allowOut = document.getElementById('allowOut');
      const statusOut= document.getElementById('statusOut');

      const strengthHelpBtn = document.getElementById('strengthHelpBtn');
      const stressHelpBtn   = document.getElementById('stressHelpBtn');
      const targetHelpBtn   = document.getElementById('targetHelpBtn');

      const strengthHelp = document.getElementById('strengthHelp');
      const stressHelp   = document.getElementById('stressHelp');
      const targetHelp   = document.getElementById('targetHelp');

      const strengthLabel = document.getElementById('strengthLabel');

      // Helpers
      function parseNum(el){
        const v = parseFloat(el.value);
        return Number.isFinite(v) ? v : null;
      }
      function formatNumber(x, opts={}) {
        if (!Number.isFinite(x)) return '—';
        const nf = new Intl.NumberFormat(undefined, { maximumFractionDigits: 3, ...opts });
        return nf.format(x);
      }
      function showError(el, msg){
        el.textContent = msg || '';
      }
      function setInvalid(input, isInvalid){
        input.setAttribute('aria-invalid', isInvalid ? 'true' : 'false');
      }
      function compute(){
        // Validate inputs on the fly but show messages only if fields were touched or contain invalid values
        const sVal = parseNum(strengthValue);
        const wVal = parseNum(stressValue);
        const tVal = parseNum(targetFos);

        // Basic constraints
        let hasError = false;

        if (strengthValue.value.trim() === ''){
          showError(strengthError, 'Please enter a material strength.');
          setInvalid(strengthValue, true);
          hasError = true;
        } else if (sVal === null || sVal < 0){
          showError(strengthError, 'Strength must be a number greater than or equal to 0.');
          setInvalid(strengthValue, true);
          hasError = true;
        } else {
          showError(strengthError, '');
          setInvalid(strengthValue, false);
        }

        if (stressValue.value.trim() === ''){
          showError(stressError, 'Please enter the applied (working) stress.');
          setInvalid(stressValue, true);
          hasError = true;
        } else if (wVal === null || wVal < 0){
          showError(stressError, 'Applied stress must be a number greater than or equal to 0.');
          setInvalid(stressValue, true);
          hasError = true;
        } else {
          showError(stressError, '');
          setInvalid(stressValue, false);
        }

        if (targetFos.value.trim() !== ''){
          if (tVal === null || tVal <= 0){
            showError(targetError, 'Target FoS must be a positive number.');
            setInvalid(targetFos, true);
          } else {
            showError(targetError, '');
            setInvalid(targetFos, false);
          }
        } else {
          showError(targetError, '');
          setInvalid(targetFos, false);
        }

        // If missing required inputs, clear results
        if (hasError){
          fosOut.textContent = '—';
          msOut.textContent = '—';
          allowOut.textContent = '—';
          statusOut.className = 'status';
          statusOut.textContent = 'Awaiting input';
          return;
        }

        // Convert to Pascals
        const sPa = sVal * unitFactor[strengthUnit.value];
        const wPa = wVal * unitFactor[stressUnit.value];

        let fos = null;
        if (wPa === 0){
          fos = Infinity;
        } else {
          fos = sPa / wPa;
        }
        const ms = (fos === Infinity) ? Infinity : (fos - 1);

        fosOut.textContent = (fos === Infinity) ? '∞' : formatNumber(fos);
        msOut.textContent  = (ms === Infinity) ? '∞' : formatNumber(ms);

        // Allowable stress (if target provided), display in currently selected strength unit
        if (tVal && tVal > 0) {
          const sigmaAllowPa = sPa / tVal;
          const allowInUnit = sigmaAllowPa / unitFactor[strengthUnit.value];
          allowOut.textContent = formatNumber(allowInUnit) + ' ' + strengthUnit.value;

          // Pass/Fail based on applied stress vs allowable stress (convert applied to strength unit for comparison)
          const appliedInStrengthUnit = wPa / unitFactor[strengthUnit.value];
          const pass = appliedInStrengthUnit <= allowInUnit;

          statusOut.className = 'status ' + (pass ? 'pass' : 'fail');
          statusOut.textContent = pass ? 'PASS (meets target FoS)' : 'FAIL (does not meet target FoS)';
        } else {
          allowOut.textContent = '—';
          statusOut.className = 'status';
          statusOut.textContent = 'No target FoS set';
        }

        // Update label based on basis
        strengthLabel.textContent = basisYield.checked ? 'Material strength (Yield, Sy)' : 'Material strength (Ultimate, Su)';
        // Re-append required asterisk via CSS
        strengthLabel.classList.add('required');
        // Re-attach help button element (DOM might reset text)
        strengthLabel.appendChild(strengthHelpBtn);
      }

      // Tooltips accessible toggles
      function bindTooltip(btn, panel){
        btn.addEventListener('click', () => {
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          panel.classList.toggle('hid', expanded);
        });
        btn.addEventListener('keydown', (e) => {
          if (e.key === 'Escape'){
            btn.setAttribute('aria-expanded', 'false');
            panel.classList.add('hid');
            btn.focus();
          }
        });
      }
      bindTooltip(strengthHelpBtn, strengthHelp);
      bindTooltip(stressHelpBtn, stressHelp);
      bindTooltip(targetHelpBtn, targetHelp);

      // Events
      [strengthValue, stressValue, targetFos].forEach(el => {
        el.addEventListener('input', compute);
        el.addEventListener('blur', compute);
      });
      [strengthUnit, stressUnit].forEach(el => el.addEventListener('change', compute));
      [basisYield, basisUltimate].forEach(el => el.addEventListener('change', compute));

      // Initial state
      compute();
    })();
  </script>

</body></html>
<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"/>
<title>Concrete Admixture Dosage Calculator | Concrete Mix Design</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="Professional concrete admixture calculator. Compute total admixture dosage by percent of cement, per 100 kg/lb, or per unit volume. Supports metric and US customary units, with accessible, mobile-first UX." name="description"/>
<meta content="Ugo Candido" name="author"/>
<link href="https://calcdomain.com/concrete-admixture.html" rel="canonical"/>
<meta content="#ffffff" name="theme-color"/>
<meta content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" name="robots"/>
<style>
    /* Critical, mobile-first CSS (performance-optimized, accessible, high-contrast) */
    :root{
      --primary:#005A9C; --primary-600:#003F6E; --accent:#00A4E4;
      --bg:#F8F9FA; --surface:#FFFFFF;
      --text:#212529; --muted:#6C757D; --border:#DEE2E6;
      --success:#198754; --danger:#DC3545; --warning:#B08900;
      --radius-card:12px; --radius-input:8px; --target:48px;
      --container:1200px;
    }
    @media (prefers-contrast: more){
      :root{ --primary:#003366; --text:#000; --border:#000; --bg:#fff; }
    }
    @media (prefers-reduced-motion: reduce){
      *{ animation-duration:.01ms !important; animation-iteration-count:1 !important; transition-duration:.01ms !important; scroll-behavior:auto !important; }
    }
    *,*::before,*::after{ box-sizing:border-box; }
    html{ font-size:16px; }
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--text); background:var(--bg); line-height:1.6;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    a{ color:var(--primary); text-decoration:none; }
    a:hover{ text-decoration:underline; }
    a:focus{ outline:3px solid var(--primary); outline-offset:2px; border-radius:2px; }
    h1,h2,h3{ color:#0b2239; line-height:1.25; }
    h1{ font-size:1.9rem; margin:.25rem 0 0.5rem; }
    h2{ font-size:1.35rem; margin:1.5rem 0 .75rem; }
    h3{ font-size:1.1rem; margin:1rem 0 .5rem; }
    p{ margin:0 0 1rem; max-width:70ch; }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
    .skip-link{ position:absolute; left:8px; top:-40px; background:var(--primary); color:#fff; padding:8px 12px; border-radius:0 0 6px 6px; z-index:1000; }
    .skip-link:focus{ top:0; }
    .container{ max-width:var(--container); margin:0 auto; padding:0 16px; }
    header{
      background:var(--surface); border-bottom:1px solid var(--border);
    }
    .header-inner{ display:flex; align-items:center; gap:12px; padding:12px 0; flex-wrap:wrap; }
    .brand{ font-weight:800; font-size:1.1rem; color:var(--primary); }
    .site-search{ display:flex; align-items:center; gap:8px; flex:1 1 260px; min-width:200px; }
    .site-search input[type="search"]{
      flex:1; min-width:0; padding:.6rem .75rem; border:1px solid var(--border); border-radius:8px; background:#fff;
    }
    .btn{ display:inline-flex; align-items:center; justify-content:center; gap:.5rem; padding:.65rem .9rem; border-radius:10px; border:1px solid var(--primary); color:#fff; background:var(--primary); cursor:pointer; min-height:var(--target); min-width:var(--target); font-weight:600; }
    .btn.secondary{ background:#fff; color:var(--primary); }
    .btn:focus{ outline:3px solid var(--primary); outline-offset:2px; }
    nav.breadcrumb{ font-size:.9rem; color:var(--muted); margin:.5rem 0 0; }
    nav.breadcrumb a{ color:inherit; }
    main{ padding:20px 0 40px; }
    .layout{ display:grid; grid-template-columns: 1fr; gap:20px; }
    @media (min-width: 992px){
      .layout{ grid-template-columns: minmax(280px,420px) 1fr; align-items:start; }
    }
    .card{ background:var(--surface); border:1px solid var(--border); border-radius:var(--radius-card); padding:20px; box-shadow:0 2px 6px rgba(0,0,0,.04); }
    .calculator h2{ margin:0 0 12px; font-size:1.35rem; }
    .form-group{ margin-bottom:16px; }
    .form-group label{ display:block; font-weight:700; margin-bottom:6px; }
    .hint{ color:var(--muted); font-size:.9rem; }
    .input-row{ display:flex; gap:8px; align-items:center; }
    .form-control{
      width:100%; padding:.75rem .9rem; border:1px solid var(--border); border-radius:var(--radius-input); background:#fff; min-height:var(--target);
    }
    .form-control:focus{ outline:3px solid rgba(0,90,156,.35); border-color:var(--primary); }
    .form-control[aria-invalid="true"]{ border-color:var(--danger); }
    .addon{ color:var(--muted); min-width:2.5rem; text-align:center; }
    fieldset{ border:0; padding:0; margin:0 0 8px; }
    legend{ font-weight:700; margin-bottom:8px; }
    .radio-set{ display:flex; gap:8px; flex-wrap:wrap; }
    .radio-set .chip{
      display:inline-flex; align-items:center; gap:8px; padding:.5rem .75rem; border:1px solid var(--border); border-radius:999px; min-height:var(--target);
      cursor:pointer; user-select:none; background:#fff;
    }
    .radio-set input[type="radio"]{ width:1rem; height:1rem; }
    .tooltip-btn{
      appearance:none; border:1px solid var(--border); background:#fff; color:var(--primary);
      border-radius:50%; width:32px; height:32px; min-height:32px; min-width:32px; display:inline-flex; align-items:center; justify-content:center; font-weight:800; cursor:pointer;
    }
    .tooltip-btn:focus{ outline:3px solid var(--primary); outline-offset:2px; }
    .tooltip{ display:none; margin-top:6px; padding:10px; border-radius:8px; background:#F2F6FA; border:1px solid #d5e3f2; color:#0b2239; }
    .tooltip[aria-hidden="false"]{ display:block; }
    .error{ color:var(--danger); font-size:.9rem; margin-top:6px; min-height:1.2em; }
    .results{ margin-top:16px; padding:16px; background:#f6f8fa; border:1px solid var(--border); border-radius:12px; min-height:240px; }
    .result-row{ display:flex; justify-content:space-between; align-items:baseline; padding:8px 0; border-bottom:1px solid var(--border); }
    .result-row:last-child{ border-bottom:0; }
    .result-label{ color:#334155; }
    .result-value{ font-weight:800; color:var(--success); font-size:1.1rem; }
    .kbd{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; background:#eef2f7; border:1px solid #d9e1ea; border-radius:6px; padding:2px 6px; }
    .formula-box{ background:#eef3f8; border:1px solid #d5e3f2; border-radius:10px; padding:16px; overflow:auto; }
    code{ background:#eef2f7; padding:2px 6px; border-radius:6px; }
    footer{ background:#0b2239; color:#fff; margin-top:40px; }
    .footer-inner{ display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:18px; padding:22px 0; }
    .footer-inner a{ color:#e6f2ff; }
    .footer-bottom{ border-top:1px solid rgba(255,255,255,.2); padding:12px 0 18px; text-align:center; font-size:.95rem; color:#e7eef7; }
  </style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Concrete Admixture Dosage Calculator",
  "description": "Calculate total concrete admixture dosage by percent of cement, per 100 kg/lb, or per unit volume. Metric and US units, accessible, mobile-first tool.",
  "url": "https://calcdomain.com/concrete-admixture.html",
  "inLanguage": "en",
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  },
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "How It Works: A Step-by-Step Example",
      "description": "Compute admixture by percent of cement using metric inputs.",
      "supply": [
        {
          "@type": "HowToSupply",
          "name": "Concrete volume: 8 m³"
        },
        {
          "@type": "HowToSupply",
          "name": "Cement content: 350 kg/m³"
        },
        {
          "@type": "HowToSupply",
          "name": "Admixture percentage: 1.0% bwoc"
        },
        {
          "@type": "HowToSupply",
          "name": "Admixture density: 1.05 kg/L (optional)"
        }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "name": "Total cement mass",
          "text": "M_c = V × C = 8 × 350 = 2,800 kg."
        },
        {
          "@type": "HowToStep",
          "name": "Admixture mass",
          "text": "M_a = p/100 × M_c = 0.01 × 2,800 = 28 kg."
        },
        {
          "@type": "HowToStep",
          "name": "Admixture volume (optional)",
          "text": "V_a = M_a / ρ = 28 / 1.05 ≈ 26.67 L."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Which unit systems does this concrete admixture calculator support?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "It supports both Metric (m³, kg, L) and US Customary (yd³, lb, fl oz, gal)."
          }
        },
        {
          "@type": "Question",
          "name": "What dosage methods can I calculate?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "You can compute dosage by percent of cement (bwoc), per 100 kg/lb of cement, or as a fixed amount per unit of concrete volume."
          }
        },
        {
          "@type": "Question",
          "name": "Do I need the admixture density?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Density is optional and only required if you want to convert admixture mass to volume (or vice versa). Typical liquid admixtures are around 1.03–1.10 kg/L."
          }
        },
        {
          "@type": "Question",
          "name": "Where do the formulas come from?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "They derive from standard mass and volume relationships used in concrete mix design and guidance from ACI 212.3R and ASTM C494."
          }
        },
        {
          "@type": "Question",
          "name": "Does this calculator account for batching tolerances?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "It provides theoretical totals. Always apply your QC/QA procedures and manufacturer recommendations for batching tolerances."
          }
        },
        {
          "@type": "Question",
          "name": "Can I use it for supplementary cementitious materials (SCMs)?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. If dosage is specified per 100 kg/lb of binder, include SCMs in the cementitious content you enter."
          }
        }
      ]
    }
  ]
}
  </script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer></script>
<!-- MathJax for LaTeX formulas -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\(','\)'], ['$', '$']],
      displayMath: [['\[','\]']]
    },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="preload" href="/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="/assets/js/page-enhancements.js" as="script">

</head>
<body>

<a class="skip-link" href="#main">Skip to main content</a>
<header>
<div class="container header-inner" role="banner">
<a aria-label="CalcDomain - Home" class="brand" href="/">CalcDomain</a>
<form aria-label="Site search" class="site-search" role="search">
<label class="sr-only" for="q">Search calculators</label>
<input autocomplete="off" id="q" name="q" placeholder="Search calculators…" type="search"/>
<button aria-label="Submit search" class="btn secondary" type="submit">Search</button>
</form>
</div>
</header>
<main class="container" id="main" role="main">
<nav aria-label="Breadcrumb" class="breadcrumb">
<a href="/">Home</a> / <a href="https://calcdomain.com/construction.html">Construction</a> / <a href="https://calcdomain.com/concrete-mix-design.html">Concrete Mix Design</a> / Concrete Admixture Dosage Calculator
    </nav>
<h1>Concrete Admixture Dosage Calculator</h1>
<p>This professional-grade concrete admixture calculator helps contractors, ready-mix producers, site engineers, and QC technicians compute total admixture requirements. Calculate by percent of cement, per 100 kg/lb of cement, or per unit concrete volume, with full support for Metric and US units.</p>
<div aria-live="polite" class="layout">
<aside aria-labelledby="calc-heading" class="card calculator">
<h2 id="calc-heading">Calculator</h2>
<section aria-labelledby="units-legend">
<fieldset class="form-group">
<legend id="units-legend">Unit system</legend>
<div aria-labelledby="units-legend" class="radio-set" role="radiogroup">
<label class="chip"><input checked="" id="unitMetric" name="unitSystem" type="radio" value="metric"/> Metric (m³, kg, L)</label>
<label class="chip"><input id="unitUS" name="unitSystem" type="radio" value="us"/> US (yd³, lb, fl oz)</label>
</div>
</fieldset>
</section>
<section aria-labelledby="inputs-legend">
<fieldset class="form-group">
<legend id="inputs-legend">Mix inputs</legend>
<div class="form-group">
<label for="volume">Concrete volume *</label>
<div class="input-row">
<input aria-describedby="volumeUnit volumeError" aria-required="true" class="form-control" id="volume" inputmode="decimal" min="0" placeholder="e.g., 8" step="any" type="number"/>
<span aria-hidden="true" class="addon" id="volumeUnit">m³</span>
</div>
<div aria-live="polite" class="error" id="volumeError" role="alert"></div>
</div>
<div class="form-group">
<div class="input-row" style="justify-content:space-between; align-items:center;">
<label for="cementContent">Cementitious content per unit volume *</label>
<button aria-controls="cementTip" aria-expanded="false" aria-label="More info about cementitious content" class="tooltip-btn" id="cementTipBtn" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="cementUnit cementTip cementError" aria-required="true" class="form-control" id="cementContent" inputmode="decimal" min="0" placeholder="e.g., 350" step="any" type="number"/>
<span aria-hidden="true" class="addon" id="cementUnit">kg/m³</span>
</div>
<div aria-hidden="true" class="tooltip" id="cementTip" role="region">
                Enter the cementitious material content for your mix (cement + SCMs). Typical ranges: 300–450 kg/m³ (Metric) or 500–750 lb/yd³ (US).
              </div>
<div aria-live="polite" class="error" id="cementError" role="alert"></div>
</div>
<div class="form-group">
<label for="density">Admixture density (optional)</label>
<div class="input-row" style="justify-content:space-between; align-items:center;">
<span class="hint">Needed to convert between mass and volume.</span>
<button aria-controls="densityTip" aria-expanded="false" aria-label="More info about density" class="tooltip-btn" id="densityTipBtn" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="densityUnit densityTip densityError" class="form-control" id="density" inputmode="decimal" min="0" placeholder="e.g., 1.05" step="any" type="number"/>
<span aria-hidden="true" class="addon" id="densityUnit">kg/L</span>
</div>
<div aria-hidden="true" class="tooltip" id="densityTip" role="region">
                Use product datasheet density. Liquids are often around 1.03–1.10 kg/L (Metric) or 8.6–9.2 lb/gal (US).
              </div>
<div aria-live="polite" class="error" id="densityError" role="alert"></div>
</div>
</fieldset>
</section>
<section aria-labelledby="method-legend">
<fieldset class="form-group">
<legend id="method-legend">Dosage method</legend>
<div aria-labelledby="method-legend" class="radio-set" role="radiogroup">
<label class="chip"><input checked="" id="methodPercent" name="doseMethod" type="radio" value="percent"/> % of cement (bwoc)</label>
<label class="chip"><input id="methodPer100" name="doseMethod" type="radio" value="per100"/> Per 100 kg/lb of cement</label>
<label class="chip"><input id="methodPerVol" name="doseMethod" type="radio" value="pervol"/> Per unit concrete volume</label>
</div>
<div class="form-group" id="rowPercent">
<label for="percent">Admixture percentage of cement (%) *</label>
<input aria-describedby="percentError" aria-required="true" class="form-control" id="percent" inputmode="decimal" min="0" placeholder="e.g., 1.0" step="any" type="number"/>
<div aria-live="polite" class="error" id="percentError" role="alert"></div>
</div>
<div class="form-group" hidden="" id="rowPer100">
<label for="dosePer100">Dose per 100 <span id="per100UnitWord">kg</span> of cement *</label>
<div class="input-row">
<input aria-describedby="per100Unit dosePer100Error" aria-required="true" class="form-control" id="dosePer100" inputmode="decimal" min="0" placeholder="e.g., 500" step="any" type="number"/>
<span aria-hidden="true" class="addon" id="per100Unit">mL/100 kg</span>
</div>
<div aria-live="polite" class="error" id="dosePer100Error" role="alert"></div>
</div>
<div class="form-group" hidden="" id="rowPerVol">
<label for="dosePerVol">Dose per unit concrete volume *</label>
<div class="input-row">
<input aria-describedby="perVolUnit dosePerVolError" aria-required="true" class="form-control" id="dosePerVol" inputmode="decimal" min="0" placeholder="e.g., 0.8" step="any" type="number"/>
<span aria-hidden="true" class="addon" id="perVolUnit">L/m³</span>
</div>
<div aria-live="polite" class="error" id="dosePerVolError" role="alert"></div>
</div>
</fieldset>
</section>
<section aria-atomic="true" aria-live="polite" class="results" role="status">
<h3>Results</h3>
<div class="result-row">
<div class="result-label">Total cementitious mass</div>
<div class="result-value" id="cementMassOut">—</div>
</div>
<div class="result-row">
<div class="result-label">Admixture mass</div>
<div class="result-value" id="admixMassOut">—</div>
</div>
<div class="result-row">
<div class="result-label">Admixture volume</div>
<div class="result-value" id="admixVolOut">—</div>
</div>
<div class="result-row">
<div class="result-label">Dosage summary</div>
<div class="result-value" id="doseSummaryOut">—</div>
</div>
<p class="hint" id="resultNote">Tip: Provide density to convert between mass and volume precisely.</p>
</section>
<div class="input-row" style="gap:10px; margin-top:12px;">
<button aria-label="Reset all fields" class="btn secondary" id="resetBtn" type="button">Reset</button>
<button aria-label="Load example values" class="btn" id="exampleBtn" type="button">Load example</button>
</div>
</aside>
<article aria-labelledby="content-heading" class="card">
<h2 id="content-heading">Authoritative methodology and guidance</h2>
<section>
<h2>Data Source and Methodology</h2>
<p><strong>Authoritative Data Sources</strong></p>
<ul>
<li>ACI 212.3R-16 — Report on Chemical Admixtures for Concrete (American Concrete Institute). Published 2016. https://www.concrete.org/publications/internationalconcreteabstractsportal/m/details/id/51689189</li>
<li>ASTM C494/C494M — Standard Specification for Chemical Admixtures for Concrete (ASTM International). Latest edition. https://www.astm.org/c0494_c0494m-19.html</li>
</ul>
<p>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</p>
</section>
<section>
<h2>The Formula Explained</h2>
<div aria-label="Mathematical formulas" class="formula-box">
<p>Let \(V\) = concrete volume, \(C\) = cementitious content per unit volume, \(M_c\) = total cementitious mass, \(p\) = admixture percentage of cement, \(\rho\) = admixture density.</p>
<p><strong>Total cementitious mass</strong>: \( M_c = V \times C \)</p>
<p><strong>Percent of cement (bwoc)</strong>: \( M_a = \frac{p}{100}\, M_c \), and \( V_a = \frac{M_a}{\rho} \)</p>
<p><strong>Per 100 kg/lb of cement</strong>: \( V_a = d \times \frac{M_c}{100} \) where \(d\) is in mL/100 kg or fl oz/100 lb; \( M_a = \rho\, V_a \)</p>
<p><strong>Per unit volume</strong>: \( V_a = u \times V \) where \(u\) is in L/m^3 or fl oz/yd^3; \( M_a = \rho\, V_a \)</p>
</div>
</section>
<section>
<h2>Glossary of Inputs and Results</h2>
<ul>
<li><strong>Concrete volume</strong> — Total placed volume to be batched (m³ or yd³).</li>
<li><strong>Cementitious content per unit volume</strong> — Mass of cement + SCMs per m³ or yd³ (kg/m³ or lb/yd³).</li>
<li><strong>Admixture density</strong> — Product density for mass/volume conversion (kg/L or lb/gal).</li>
<li><strong>% of cement (bwoc)</strong> — Dosage as percent of cementitious mass.</li>
<li><strong>Per 100 kg/lb</strong> — Manufacturer-specified dose per 100 kg (or 100 lb) of cement.</li>
<li><strong>Per unit volume</strong> — Fixed admixture amount per m³ or yd³ of concrete.</li>
<li><strong>Total cementitious mass</strong> — Computed total cement/binder mass for the selected volume.</li>
<li><strong>Admixture mass</strong> — Total mass of admixture required.</li>
<li><strong>Admixture volume</strong> — Total volume of admixture required.</li>
</ul>
</section>
<section aria-labelledby="howto">
<h2 id="howto">How It Works: A Step-by-Step Example</h2>
<p>Suppose a slab pour of \(V=8\ \text{m}^3\) with cementitious content \(C=350\ \text{kg/m}^3\). A water-reducing admixture is specified at \(p=1.0\%\) bwoc, and density \(\rho=1.05\ \text{kg/L}\).</p>
<ol>
<li>Total cementitious mass: \(M_c = 8 \times 350 = 2{,}800\ \text{kg}\).</li>
<li>Admixture mass: \(M_a = 0.01 \times 2{,}800 = 28\ \text{kg}\).</li>
<li>Admixture volume: \(V_a = \frac{28}{1.05} \approx 26.67\ \text{L}\).</li>
</ol>
<p>In practice, round to your plant’s batching resolution and follow product datasheet limits per ACI 212.3R/ASTM C494.</p>
</section>
<section>
<h2>Frequently Asked Questions (FAQ)</h2>
<h3>What is “bwoc”?</h3>
<p>“By weight of cement” indicates dosage expressed as a percentage of the cementitious mass in the mix.</p>
<h3>Should SCMs be included in cementitious content?</h3>
<p>Yes, if the admixture dosage is specified relative to total binder, include SCMs (e.g., fly ash, slag, silica fume) in the cementitious content.</p>
<h3>How do I select the right method?</h3>
<p>Use “% of cement” when dosage is specified as a percentage by mass, “per 100 kg/lb” when the datasheet gives mL/100 kg or fl oz/100 lb, and “per unit volume” for fixed L/m³ or fl oz/yd³ directions.</p>
<h3>What if I don’t know density?</h3>
<p>You can still compute mass (percent method) or volume (per-100/per-volume methods). Provide density only to convert between mass and volume precisely.</p>
<h3>Are the results batch-ready?</h3>
<p>They are theoretical totals. Always apply your plant’s calibration, batching tolerances, and quality procedures, and stay within datasheet limits.</p>
<h3>Can I mix unit systems?</h3>
<p>No. Select one unit system (Metric or US). The tool will adapt labels and calculations consistently.</p>
<h3>What ranges are typical for water reducers?</h3>
<p>Common ranges are roughly 0.2–1.0% bwoc, but always follow the specific manufacturer datasheet and applicable standards.</p>
</section>
<section class="author-box" style="margin-top:18px; border-top:1px solid var(--border); padding-top:12px; color:var(--muted); font-size:.95rem;">
<p>Strumento sviluppato da <strong>Ugo Candido</strong>,. Contenuti verificati da,.</p>
<p>Ultima revisione per l'accuratezza in data: <time datetime="" id="reviewDate"></time>.</p>
</section>
</article>
</div>
</main>
<!-- Standard Footer --> 
<script defer="">
    (function(){
      "use strict";

      // Constants
      const KG_PER_LB = 0.45359237;
      const LB_PER_KG = 1 / KG_PER_LB;
      const L_PER_GAL = 3.785411784;
      const FL_OZ_PER_GAL = 128;
      const ML_PER_L = 1000;
      const FL_OZ_PER_L = FL_OZ_PER_GAL / L_PER_GAL; // ≈ 33.814

      // Elements
      const unitRadios = Array.from(document.querySelectorAll('input[name="unitSystem"]'));
      const methodRadios = Array.from(document.querySelectorAll('input[name="doseMethod"]'));

      const el = {
        volume: document.getElementById('volume'),
        volumeErr: document.getElementById('volumeError'),
        volumeUnit: document.getElementById('volumeUnit'),

        cement: document.getElementById('cementContent'),
        cementErr: document.getElementById('cementError'),
        cementUnit: document.getElementById('cementUnit'),

        density: document.getElementById('density'),
        densityErr: document.getElementById('densityError'),
        densityUnit: document.getElementById('densityUnit'),

        percentRow: document.getElementById('rowPercent'),
        percent: document.getElementById('percent'),
        percentErr: document.getElementById('percentError'),

        per100Row: document.getElementById('rowPer100'),
        dosePer100: document.getElementById('dosePer100'),
        dosePer100Err: document.getElementById('dosePer100Error'),
        per100Unit: document.getElementById('per100Unit'),
        per100UnitWord: document.getElementById('per100UnitWord'),

        perVolRow: document.getElementById('rowPerVol'),
        dosePerVol: document.getElementById('dosePerVol'),
        dosePerVolErr: document.getElementById('dosePerVolError'),
        perVolUnit: document.getElementById('perVolUnit'),

        cementTipBtn: document.getElementById('cementTipBtn'),
        cementTip: document.getElementById('cementTip'),
        densityTipBtn: document.getElementById('densityTipBtn'),
        densityTip: document.getElementById('densityTip'),

        outCementMass: document.getElementById('cementMassOut'),
        outAdmixMass: document.getElementById('admixMassOut'),
        outAdmixVol: document.getElementById('admixVolOut'),
        outSummary: document.getElementById('doseSummaryOut'),
        resultNote: document.getElementById('resultNote'),

        resetBtn: document.getElementById('resetBtn'),
        exampleBtn: document.getElementById('exampleBtn'),
        reviewDate: document.getElementById('reviewDate')
      };

      // State
      let unit = 'metric'; // 'metric' | 'us'
      let method = 'percent'; // 'percent' | 'per100' | 'pervol'

      // Utilities
      function formatNumber(n, digits=2){
        if (n === null || Number.isNaN(n)) return '—';
        return new Intl.NumberFormat(undefined, { maximumFractionDigits: digits }).format(n);
      }
      function setError(input, errEl, msg){
        if (msg){
          input.setAttribute('aria-invalid', 'true');
          errEl.textContent = msg;
        } else {
          input.removeAttribute('aria-invalid');
          errEl.textContent = '';
        }
      }
      function validatePositive(input, errEl, label, allowZero=false){
        const v = parseFloat(input.value);
        if (input.value === ''){
          setError(input, errEl, '');
          return null; // empty allowed until compute
        }
        if (!Number.isFinite(v)){
          setError(input, errEl, `Please enter a valid number for ${label}.`);
          return NaN;
        }
        if (v < 0 || (!allowZero && v === 0)){
          setError(input, errEl, `${label} must be ${allowZero ? '≥ 0' : '> 0'}.`);
          return NaN;
        }
        setError(input, errEl, '');
        return v;
      }
      function toggleTooltip(btn, panel){
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!expanded));
        panel.setAttribute('aria-hidden', String(expanded));
      }
      function setUnitSystem(newUnit){
        unit = newUnit;
        if (unit === 'metric'){
          el.volumeUnit.textContent = 'm³';
          el.cementUnit.textContent = 'kg/m³';
          el.densityUnit.textContent = 'kg/L';
          el.per100Unit.textContent = 'mL/100 kg';
          el.per100UnitWord.textContent = 'kg';
          el.perVolUnit.textContent = 'L/m³';

          // placeholders suited for metric
          if (!el.cement.value) el.cement.placeholder = 'e.g., 350';
          if (!el.density.value) el.density.placeholder = 'e.g., 1.05';
          if (!el.dosePerVol.value) el.dosePerVol.placeholder = 'e.g., 0.8';
          if (!el.dosePer100.value) el.dosePer100.placeholder = 'e.g., 500';
        } else {
          el.volumeUnit.textContent = 'yd³';
          el.cementUnit.textContent = 'lb/yd³';
          el.densityUnit.textContent = 'lb/gal';
          el.per100Unit.textContent = 'fl oz/100 lb';
          el.per100UnitWord.textContent = 'lb';
          el.perVolUnit.textContent = 'fl oz/yd³';

          if (!el.cement.value) el.cement.placeholder = 'e.g., 600';
          if (!el.density.value) el.density.placeholder = 'e.g., 8.9';
          if (!el.dosePerVol.value) el.dosePerVol.placeholder = 'e.g., 10';
          if (!el.dosePer100.value) el.dosePer100.placeholder = 'e.g., 6';
        }
        compute();
      }
      function setMethod(newMethod){
        method = newMethod;
        el.percentRow.hidden = method !== 'percent';
        el.per100Row.hidden = method !== 'per100';
        el.perVolRow.hidden = method !== 'pervol';
        compute();
      }

      // Calculation core
      function compute(){
        const V = validatePositive(el.volume, el.volumeErr, 'Concrete volume', false);
        const C = validatePositive(el.cement, el.cementErr, 'Cementitious content', false);
        const rhoUser = validatePositive(el.density, el.densityErr, 'Admixture density', true); // optional
        const p = validatePositive(el.percent, el.percentErr, 'Admixture percentage', false);
        const d100 = validatePositive(el.dosePer100, el.dosePer100Err, 'Dose per 100 ' + (unit==='metric'?'kg':'lb'), false);
        const uPerVol = validatePositive(el.dosePerVol, el.dosePerVolErr, 'Dose per unit volume', false);

        // do not compute if required fields missing for the selected method
        if (V === null || C === null || Number.isNaN(V) || Number.isNaN(C)){
          renderOutputs(null);
          return;
        }

        let cementMass, admixMass=null, admixVol=null, summary='—';

        if (unit === 'metric'){
          cementMass = V * C; // kg
          if (method === 'percent'){
            if (p === null || Number.isNaN(p)){ renderOutputs(cementMass, null, null, summary); return; }
            admixMass = (p/100) * cementMass; // kg
            if (Number.isFinite(rhoUser) && rhoUser > 0) admixVol = admixMass / rhoUser; // L
            summary = `${formatNumber(p, 3)}% bwoc`;
          } else if (method === 'per100'){
            if (d100 === null || Number.isNaN(d100)){ renderOutputs(cementMass, null, null, summary); return; }
            const total_mL = d100 * (cementMass/100); // mL
            admixVol = total_mL / ML_PER_L; // L
            if (Number.isFinite(rhoUser) && rhoUser > 0) admixMass = admixVol * rhoUser; // kg
            summary = `${formatNumber(d100, 2)} mL per 100 kg`;
          } else if (method === 'pervol'){
            if (uPerVol === null || Number.isNaN(uPerVol)){ renderOutputs(cementMass, null, null, summary); return; }
            admixVol = uPerVol * V; // L
            if (Number.isFinite(rhoUser) && rhoUser > 0) admixMass = admixVol * rhoUser; // kg
            summary = `${formatNumber(uPerVol, 3)} L per m³`;
          }
        } else {
          // US
          cementMass = V * C; // lb
          if (method === 'percent'){
            if (p === null || Number.isNaN(p)){ renderOutputs(cementMass, null, null, summary); return; }
            admixMass = (p/100) * cementMass; // lb
            if (Number.isFinite(rhoUser) && rhoUser > 0){
              const gal = admixMass / rhoUser; // gal (density lb/gal)
              admixVol = gal * FL_OZ_PER_GAL; // fl oz
            }
            summary = `${formatNumber(p, 3)}% bwoc`;
          } else if (method === 'per100'){
            if (d100 === null || Number.isNaN(d100)){ renderOutputs(cementMass, null, null, summary); return; }
            const total_fl_oz = d100 * (cementMass/100);
            admixVol = total_fl_oz; // fl oz
            if (Number.isFinite(rhoUser) && rhoUser > 0){
              const gal = admixVol / FL_OZ_PER_GAL;
              admixMass = gal * rhoUser; // lb
            }
            summary = `${formatNumber(d100, 2)} fl oz per 100 lb`;
          } else if (method === 'pervol'){
            if (uPerVol === null || Number.isNaN(uPerVol)){ renderOutputs(cementMass, null, null, summary); return; }
            admixVol = uPerVol * V; // fl oz
            if (Number.isFinite(rhoUser) && rhoUser > 0){
              const gal = admixVol / FL_OZ_PER_GAL;
              admixMass = gal * rhoUser; // lb
            }
            summary = `${formatNumber(uPerVol, 3)} fl oz per yd³`;
          }
        }

        renderOutputs(cementMass, admixMass, admixVol, summary);
      }

      function renderOutputs(cementMass, admixMass, admixVol, summary){
        // Cement mass
        if (cementMass == null || Number.isNaN(cementMass)){
          el.outCementMass.textContent = '—';
        } else if (unit === 'metric'){
          const kg = cementMass;
          const lb = kg * LB_PER_KG;
          el.outCementMass.textContent = `${formatNumber(kg)} kg (${formatNumber(lb)} lb)`;
        } else {
          const lb = cementMass;
          const kg = lb * KG_PER_LB;
          el.outCementMass.textContent = `${formatNumber(lb)} lb (${formatNumber(kg)} kg)`;
        }

        // Admixture mass
        if (admixMass == null || Number.isNaN(admixMass)){
          el.outAdmixMass.textContent = '—';
        } else if (unit === 'metric'){
          const kg = admixMass;
          const lb = kg * LB_PER_KG;
          el.outAdmixMass.textContent = `${formatNumber(kg)} kg (${formatNumber(lb)} lb)`;
        } else {
          const lb = admixMass;
          const kg = lb * KG_PER_LB;
          el.outAdmixMass.textContent = `${formatNumber(lb)} lb (${formatNumber(kg)} kg)`;
        }

        // Admixture volume
        if (admixVol == null || Number.isNaN(admixVol)){
          el.outAdmixVol.textContent = '—';
        } else if (unit === 'metric'){
          const L = admixVol;
          const fl_oz = L * FL_OZ_PER_L;
          el.outAdmixVol.textContent = `${formatNumber(L)} L (${formatNumber(fl_oz)} fl oz)`;
        } else {
          const fl_oz = admixVol;
          const L = fl_oz / FL_OZ_PER_L;
          el.outAdmixVol.textContent = `${formatNumber(fl_oz)} fl oz (${formatNumber(L)} L)`;
        }

        // Summary
        el.outSummary.textContent = summary || '—';

        // Note visibility
        const hasDensity = !!el.density.value && Number.isFinite(parseFloat(el.density.value)) && parseFloat(el.density.value) > 0;
        if (hasDensity){
          el.resultNote.textContent = 'Density provided: mass and volume conversions are exact.';
        } else {
          el.resultNote.textContent = 'Tip: Provide density to convert between mass and volume precisely.';
        }
      }

      // Events
      unitRadios.forEach(r => {
        r.addEventListener('change', (e)=> setUnitSystem(e.target.value));
      });
      methodRadios.forEach(r => {
        r.addEventListener('change', (e)=> setMethod(e.target.value));
      });

      [el.volume, el.cement, el.density, el.percent, el.dosePer100, el.dosePerVol].forEach(inp=>{
        inp.addEventListener('blur', compute);
        inp.addEventListener('input', ()=>{ // live feedback without being too aggressive
          // Clear errors while typing
          const id = inp.id;
          if (id === 'volume') setError(inp, el.volumeErr, '');
          if (id === 'cementContent') setError(inp, el.cementErr, '');
          if (id === 'density') setError(inp, el.densityErr, '');
          if (id === 'percent') setError(inp, el.percentErr, '');
          if (id === 'dosePer100') setError(inp, el.dosePer100Err, '');
          if (id === 'dosePerVol') setError(inp, el.dosePerVolErr, '');
          compute();
        });
      });

      el.cementTipBtn.addEventListener('click', ()=> toggleTooltip(el.cementTipBtn, el.cementTip));
      el.densityTipBtn.addEventListener('click', ()=> toggleTooltip(el.densityTipBtn, el.densityTip));

      el.resetBtn.addEventListener('click', ()=>{
        document.querySelector('form')?.reset(); // in case wrapped
        el.volume.value = '';
        el.cement.value = '';
        el.density.value = '';
        el.percent.value = '';
        el.dosePer100.value = '';
        el.dosePerVol.value = '';
        [el.volumeErr, el.cementErr, el.densityErr, el.percentErr, el.dosePer100Err, el.dosePerVolErr].forEach(x=> x.textContent='');
        el.volume.removeAttribute('aria-invalid');
        el.cement.removeAttribute('aria-invalid');
        el.density.removeAttribute('aria-invalid');
        el.percent.removeAttribute('aria-invalid');
        el.dosePer100.removeAttribute('aria-invalid');
        el.dosePerVol.removeAttribute('aria-invalid');
        setUnitSystem('metric');
        setMethod('percent');
        compute();
        el.cementTipBtn.setAttribute('aria-expanded','false'); el.cementTip.setAttribute('aria-hidden','true');
        el.densityTipBtn.setAttribute('aria-expanded','false'); el.densityTip.setAttribute('aria-hidden','true');
        el.volume.focus();
      });

      el.exampleBtn.addEventListener('click', ()=>{
        // Load a realistic example adapted to current unit system
        if (unit === 'metric'){
          el.volume.value = '8';
          el.cement.value = '350';
          el.density.value = '1.05';
          setMethod('percent');
          el.percent.value = '1.0';
        } else {
          el.volume.value = '12';
          el.cement.value = '600';
          el.density.value = '8.9';
          setMethod('per100');
          el.dosePer100.value = '6';
        }
        compute();
      });

      // Initialize
      setUnitSystem('metric');
      setMethod('percent');
      compute();

      // Review date
      const d = new Date();
      const iso = d.toISOString().slice(0,10);
      el.reviewDate.dateTime = iso;
      el.reviewDate.textContent = d.toLocaleDateString(undefined, { year:'numeric', month:'long', day:'numeric' });
    })();
  </script>

</body></html>
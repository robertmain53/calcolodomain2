<!DOCTYPE html>
<html lang="en">
<head>
<link rel="canonical" href="https://calcdomain.com/date-difference-calculator.html">




  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Date Difference Calculator – Days, Weeks, Months & Years</title>
  <meta name="description" content="Free date difference calculator. Compute exact days, weeks, business days, months and years between two dates. Inclusive/exclusive modes, holidays, and clear step‑by‑step method." />
  

  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    body{font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
    .prose{max-width:72ch}
    .prose h2{font-size:1.5rem;font-weight:700;margin-top:2rem;margin-bottom:0.75rem}
    .prose h3{font-size:1.125rem;font-weight:600;margin-top:1.25rem;margin-bottom:0.5rem}
    .prose p{margin-bottom:0.75rem;line-height:1.7}
    .prose ul,.prose ol{margin-left:1.25rem;margin-bottom:0.75rem}
    .formula-box{background:#f3f4f6;border:1px solid #d1d5db;border-radius:.5rem;padding:1rem;overflow:auto;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .result-card{background:#fff;border:1px solid #e5e7eb;border-radius:.75rem;padding:1rem;text-align:center}
    .result-card h4{font-size:.95rem;color:#6b7280;margin-bottom:.25rem}
    .result-card p{font-size:1.5rem;font-weight:800;color:#1f2937}
    /* Focus styles (WCAG) */
    :focus{outline:3px solid #2563eb;outline-offset:2px}
    /* Prevent CLS in results */
    #results{min-height:12rem}
    @media (prefers-reduced-motion:no-preference){.fade-in{animation:fade .25s ease-in}}
    @keyframes fade{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}
    @media print{body *{visibility:hidden} #print-section,#print-section *{visibility:visible} #print-section{position:absolute;inset:0} #ad-slot{display:none!important}}
  </style>

  <!-- JSON-LD: WebPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Date Difference Calculator",
    "description": "Compute exact date differences: total days, weeks, business days, and calendar years-months-days.",
    "url": "https://calcdomain.com/date-difference-calculator.html",
    "inLanguage": "en",
    "author": {"@type": "Person","name": "Ugo Candido"},
    "publisher": {"@type": "Organization","name": "CalcDomain"},
    "about": [{"@type":"Thing","name":"Date and time calculation"}],
    "isPartOf": {"@type":"Collection","name":"Lifestyle – Everyday"}
  }
  </script>
  <!-- JSON-LD: Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Lifestyle<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Date Difference Calculator – Days, Weeks, Months & Years</title>
  <meta name="description" content="Free date difference calculator. Compute exact days, weeks, business days, months and years between two dates. Inclusive/exclusive modes, holidays, and clear step‑by‑step method." />
  

  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    body{font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
    .prose{max-width:72ch}
    .prose h2{font-size:1.5rem;font-weight:700;margin-top:2rem;margin-bottom:0.75rem}
    .prose h3{font-size:1.125rem;font-weight:600;margin-top:1.25rem;margin-bottom:0.5rem}
    .prose p{margin-bottom:0.75rem;line-height:1.7}
    .prose ul,.prose ol{margin-left:1.25rem;margin-bottom:0.75rem}
    .formula-box{background:#f3f4f6;border:1px solid #d1d5db;border-radius:.5rem;padding:1rem;overflow:auto;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .result-card{background:#fff;border:1px solid #e5e7eb;border-radius:.75rem;padding:1rem;text-align:center}
    .result-card h4{font-size:.95rem;color:#6b7280;margin-bottom:.25rem}
    .result-card p{font-size:1.5rem;font-weight:800;color:#1f2937}
    /* Focus styles (WCAG) */
    :focus{outline:3px solid #2563eb;outline-offset:2px}
    /* Prevent CLS in results */
    #results{min-height:12rem}
    @media (prefers-reduced-motion:no-preference){.fade-in{animation:fade .25s ease-in}}
    @keyframes fade{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}
    @media print{body *{visibility:hidden} #print-section,#print-section *{visibility:visible} #print-section{position:absolute;inset:0} #ad-slot{display:none!important}}
  </style>

  <!-- JSON-LD: WebPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Date Difference Calculator",
    "description": "Compute exact date differences: total days, weeks, business days, and calendar years-months-days.",
    "url": "https://calcdomain.com/date-difference-calculator.html",
    "inLanguage": "en",
    "author": {"@type": "Person","name": "Ugo Candido"},
    "publisher": {"@type": "Organization","name": "CalcDomain"},
    "about": [{"@type":"Thing","name":"Date and time calculation"}],
    "isPartOf": {"@type":"Collection","name":"Lifestyle – Everyday"}
  }
  </script>
  <!-- JSON-LD: Breadcrumbs -->
  <script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Lifestyle & Everyday",
      "item": "https://calcdomain.com/lifestyle-everyday.html"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Time and Date",
      "item": "https://calcdomain.com/subcategories/time-date.html"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "Date Difference Calculator",
      "item": "https://calcdomain.com/date-difference-calculator.html"
    }
  ]
}</script>
  <!-- JSON-LD: FAQPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "Is the end date included or excluded?",
        "acceptedAnswer": {"@type":"Answer","text":"You can choose inclusive (counts both start and end) or exclusive (counts whole days in between). The default is exclusive, which matches most scheduling conventions."}
      },
      {
        "@type": "Question",
        "name": "How are business days calculated?",
        "acceptedAnswer": {"@type":"Answer","text":"Business days skip Saturdays and Sundays by default. You can also enter holiday dates to exclude them from the count."}
      },
      {
        "@type": "Question",
        "name": "Does the calculator use leap years correctly?",
        "acceptedAnswer": {"@type":"Answer","text":"Yes. Calculations follow the proleptic Gregorian calendar (ISO 8601) including leap years (e.g., 2000 and 2024)."}
      },
      {
        "@type": "Question",
        "name": "What is the difference between total days and Y–M–D breakdown?",
        "acceptedAnswer": {"@type":"Answer","text":"Total days is a simple count of calendar days. The Y–M–D result expresses the exact calendar interval in whole years and months plus remaining days."}
      },
      {
        "@type": "Question",
        "name": "Which holidays format is supported?",
        "acceptedAnswer": {"@type":"Answer","text":"Use ISO format YYYY-MM-DD, separated by commas or new lines. Example: 2025-12-25, 2025-12-26."}
      }
    ]
  }
  </script>
  <!-- JSON-LD: HowTo -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to calculate days between dates",
    "step": [
      {"@type":"HowToStep","name":"Enter start date","text":"Pick the start date."},
      {"@type":"HowToStep","name":"Enter end date","text":"Pick the end date (must be on or after the start date)."},
      {"@type":"HowToStep","name":"Choose inclusive or exclusive","text":"Inclusive counts both start and end; exclusive counts days between."},
      {"@type":"HowToStep","name":"Optional: add holidays","text":"Paste or type known holidays to exclude from business-day counts."},
      {"@type":"HowToStep","name":"Review results","text":"See total days, weeks, business days, and precise years–months–days breakdown."}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky per spec) -->
  <header class="bg-white border-b">
    <div class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>
      <nav class="hidden md:flex gap-6 text-sm">
        <a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
        Categories
      </nav>
    </div>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <section class="w-full lg:w-2/3">
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
          <a href="lifestyle-everyday.html" ctime-date.htmllass="hover:text-blue-600">Everyday Life</a> &raquo;
          <a href="subcategories/time-date.html" class="hover:text-blue-600">Time and Date</a> &raquo;
          <span class="text-gray-900">Date Difference Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-lg shadow-sm">
          <h1 class="text-3xl font-extrabold mb-2">date difference calculator</h1>
          <p class="text-gray-700 mb-6">Quickly compute the exact time between two calendar dates: total days, weeks, business days (skipping weekends and optional holidays), and a precise Years–Months–Days breakdown. Built for planners, HR, legal, academic and everyday scheduling.</p>

          <!-- Calculator UI -->
          <section id="calculator" class="space-y-6" aria-labelledby="calcHeading">
            <h2 id="calcHeading" class="sr-only">Calculator Inputs</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Start date -->
              <div>
                <label for="startDate" class="block text-sm font-medium text-gray-800">Start date <span aria-hidden="true" class="text-red-600">*</span></label>
                <div class="flex items-start gap-2">
                  <input type="date" id="startDate" aria-required="true" aria-describedby="startDateHelp startDateError" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" />
                  <button type="button" class="mt-1 px-3 py-2 border rounded-md" aria-expanded="false" aria-controls="startDateHelp" aria-label="What counts as start date?">?</button>
                </div>
                <p id="startDateHelp" class="text-sm text-gray-600 mt-1 hidden">The first day of the period. For inclusive mode it is counted; for exclusive mode it is not.</p>
                <p id="startDateError" class="text-sm text-red-700 mt-1" role="alert" hidden></p>
              </div>

              <!-- End date -->
              <div>
                <label for="endDate" class="block text-sm font-medium text-gray-800">End date <span aria-hidden="true" class="text-red-600">*</span></label>
                <div class="flex items-start gap-2">
                  <input type="date" id="endDate" aria-required="true" aria-describedby="endDateHelp endDateError" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" />
                  <button type="button" class="mt-1 px-3 py-2 border rounded-md" aria-expanded="false" aria-controls="endDateHelp" aria-label="What counts as end date?">?</button>
                </div>
                <p id="endDateHelp" class="text-sm text-gray-600 mt-1 hidden">The last day of the period. In inclusive mode it is counted; in exclusive mode it is not.</p>
                <p id="endDateError" class="text-sm text-red-700 mt-1" role="alert" hidden></p>
              </div>

              <!-- Mode -->
              <div>
                <label for="mode" class="block text-sm font-medium text-gray-800">Counting mode</label>
                <select id="mode" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" aria-describedby="modeHelp">
                  <option value="exclusive" selected>Exclusive (days in-between)</option>
                  <option value="inclusive">Inclusive (count start and end)</option>
                </select>
                <p id="modeHelp" class="text-sm text-gray-600 mt-1">Choose whether to include both boundary dates.</p>
              </div>

              <!-- Business days toggle -->
              <div>
                <label for="biz" class="block text-sm font-medium text-gray-800">Business days</label>
                <select id="biz" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" aria-describedby="bizHelp">
                  <option value="skip-weekends" selected>Skip weekends</option>
                  <option value="count-all">Count all days</option>
                </select>
                <p id="bizHelp" class="text-sm text-gray-600 mt-1">Skip Saturdays and Sundays for business-day totals.</p>
              </div>

              <!-- Holidays -->
              <div class="md:col-span-2">
                <label for="holidays" class="block text-sm font-medium text-gray-800">Holidays to exclude (optional)</label>
                <textarea id="holidays" rows="3" placeholder="YYYY-MM-DD, one per line or separated by commas" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" aria-describedby="holidayHelp"></textarea>
                <p id="holidayHelp" class="text-sm text-gray-600 mt-1">These dates are excluded from business-day counts.</p>
              </div>
            </div>

            <div class="flex items-center gap-3">
              <button id="calcBtn" class="px-5 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus-visible:outline-none" aria-label="Calculate difference">Calculate</button>
              <button id="resetBtn" class="px-5 py-3 bg-gray-100 text-gray-800 font-semibold rounded-lg hover:bg-gray-200" aria-label="Reset inputs">Reset</button>
              <button id="printBtn" class="px-5 py-3 bg-white border text-gray-800 font-semibold rounded-lg hover:bg-gray-50" aria-label="Print results">Print</button>
            </div>
          </section>

          <!-- Results -->
          <section id="results" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6 fade-in" aria-live="polite">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="result-card">
                <h4>Total days</h4>
                <p id="totalDays">—</p>
              </div>
              <div class="result-card">
                <h4>Business days</h4>
                <p id="businessDays">—</p>
              </div>
              <div class="result-card">
                <h4>Weeks & days</h4>
                <p id="weeksDays">—</p>
              </div>
              <div class="result-card">
                <h4>Years–Months–Days</h4>
                <p id="ymd">—</p>
              </div>
            </div>
            <div class="mt-6 text-sm text-gray-700" id="notes"></div>
          </section>
        </div>

        <!-- Authoritative ecosystem content -->
        <article class="bg-white p-6 rounded-lg shadow-sm mt-8 prose">
          <h2>Data source & methodology</h2>
          <p><strong>AuthoritativeDataSource:</strong> ISO 8601 (Parts 1 & 2, 2019) – Data elements and interchange formats — Information interchange — Representation of dates and times; and RFC 3339 (2002) Internet profile. See the <a class="text-blue-600" href="https://www.iso.org/standard/70907.html">ISO 8601 standard</a> and <a class="text-blue-600" href="https://www.rfc-editor.org/rfc/rfc3339">RFC 3339</a>. All computations assume the <em>proleptic Gregorian calendar</em> used by ISO 8601. <br><em>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</em></p>

          <h2>The formula explained</h2>
          <div class="formula-box" aria-label="Mathematical formulas in LaTeX">
<pre>\(\textbf{TotalDays} = d_2 - d_1 + \mathbb{1}_{\{\text{inclusive}\}}\)

\(\textbf{Weeks}\,=\,\left\lfloor\dfrac{\text{TotalDays}}{7}\right\rfloor,\quad \textbf{RemainderDays}=\text{TotalDays}\bmod 7\)

For calendar breakdown (Years–Months–Days), let \(d_1\) be the start date and \(d_2\) the end date (with \(d_2\ge d_1\)). We find integers \(y,m,\delta\) such that:
\[ d_1 + (y\,\text{years}) + (m\,\text{months}) + (\delta\,\text{days}) = d_2,\]
with \(0\le m<12\) and \(0\le \delta < \text{daysInMonth}(d_1+y\,\text{years}+m\,\text{months})\). This is computed by advancing years then months, adjusting for month lengths and leap years per Gregorian rules.

Business days count excludes Saturdays and Sundays and removes any listed holidays \(H\subseteq[d_1,d_2]\):
\[\textbf{BusinessDays} = |\{ d\in[d_1,d_2] : d\notin H,\; \text{weekday}(d)\in\{\text{Mon..Fri}\}\}|.\]
</pre>
          </div>

          <h2>Glossary of variables</h2>
          <ul>
            <li><strong>Start date (d₁):</strong> First day of the interval.</li>
            <li><strong>End date (d₂):</strong> Last day of the interval.</li>
            <li><strong>Inclusive/Exclusive:</strong> Whether to count both boundaries.</li>
            <li><strong>Total days:</strong> Number of calendar days in the interval.</li>
            <li><strong>Weeks & days:</strong> Equivalent weeks plus remaining days.</li>
            <li><strong>Years–Months–Days:</strong> Exact calendar interval using Gregorian month lengths.</li>
            <li><strong>Business days:</strong> Days excluding weekends and user-listed holidays.</li>
          </ul>

          <h2>How it works: a step‑by‑step example</h2>
          <p><strong>Example:</strong> Start <code>2025‑01‑15</code>, End <code>2025‑03‑02</code>, inclusive, skip weekends, no holidays.</p>
          <ol>
            <li>TotalDays = (Mar 2 − Jan 15) + 1 = 47 + 1 = <strong>48</strong>.</li>
            <li>Weeks = ⌊48/7⌋ = 6, RemainderDays = 48 mod 7 = 6 ⇒ <strong>6 weeks 6 days</strong>.</li>
            <li>Y–M–D: from 2025‑01‑15 → +1 month = 2025‑02‑15; +0 months more (since 2025‑03‑15 would overshoot); remaining days = 15 → <strong>0 years, 1 month, 15 days</strong>.</li>
            <li>Business days: iterate 48 dates, remove Saturdays/Sundays ⇒ <strong>34 business days</strong> (no holidays).</li>
          </ol>

          <h2>FAQ</h2>
          <details>
            <summary>What happens if the end date is before the start date?</summary>
            <p>The calculator requires the end date to be on or after the start date. You’ll see a clear error message if that rule is violated.</p>
          </details>
          <details>
            <summary>Do partial days or time zones matter?</summary>
            <p>This tool counts whole calendar days using local time (00:00). For time‑of‑day differences, use a time duration calculator.</p>
          </details>
          <details>
            <summary>Are leap days counted?</summary>
            <p>Yes. February 29 is counted when it falls within the interval. Month lengths and leap year rules follow the proleptic Gregorian calendar.</p>
          </details>
          <details>
            <summary>Can I paste holidays from a spreadsheet?</summary>
            <p>Yes. Paste a column of YYYY‑MM‑DD dates; the tool ignores empty lines and trims whitespace.</p>
          </details>
          <details>
            <summary>Is inclusive mode standard?</summary>
            <p>Both conventions exist. Legal and HR contexts often prefer inclusive; project scheduling commonly uses exclusive. Set what you need explicitly.</p>
          </details>

          <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Content verified by the CalcDomain Editorial Board.<br />
              Last accuracy review: <time datetime="2025-10-27">October 27, 2025</time></p>
          </div>
        </article>
      </section>

      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div id="ad-slot" class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">Ad Placement (300×600)</div>
          <div class="bg-white p-6 rounded-lg shadow-sm">
            <h3 class="font-bold text-lg mb-3">Why this calculator</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Accurate leap‑year and month‑length handling (ISO 8601).</li>
              <li>Business days with optional holidays.</li>
              <li>Accessible, mobile‑first and print‑friendly.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-sm">
            <h3 class="font-bold text-lg mb-3">Related tools</h3>
            <ul class="space-y-2 text-sm">
              <li><a href="time-duration-calculator.html" class="text-blue-600 hover:underline">Time Duration Calculator</a></li>
              <li><a href="workdays-calculator.html" class="text-blue-600 hover:underline">Workdays Calculator</a></li>
              <li><a href="age-calculator.html" class="text-blue-600 hover:underline">Age Calculator</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-600">About</a>
        <a href="contact.html" class="hover:text-blue-600">Contact</a>
        <a href="privacy.html" class="hover:text-blue-600">Privacy</a>
        <a href="terms.html" class="hover:text-blue-600">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator logic (placed before </body> for performance) -->
  <script>
    (function(){
      const el = id => document.getElementById(id);
      const startDate = el('startDate');
      const endDate = el('endDate');
      const mode = el('mode');
      const biz = el('biz');
      const holidays = el('holidays');
      const calcBtn = el('calcBtn');
      const resetBtn = el('resetBtn');
      const printBtn = el('printBtn');

      const totalDaysEl = el('totalDays');
      const businessDaysEl = el('businessDays');
      const weeksDaysEl = el('weeksDays');
      const ymdEl = el('ymd');
      const notesEl = el('notes');

      const startErr = el('startDateError');
      const endErr = el('endDateError');

      // Accessible tooltips (toggle next sibling help)
      document.querySelectorAll('label + div > button[aria-controls]')
        .forEach(btn => {
          btn.addEventListener('click', () => {
            const id = btn.getAttribute('aria-controls');
            const panel = el(id);
            const open = panel.classList.toggle('hidden');
            btn.setAttribute('aria-expanded', String(!open));
          });
          btn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); btn.click(); }});
        });

      function parseDate(value){
        if(!value) return null;
        const [y,m,d] = value.split('-').map(Number);
        if(!y||!m||!d) return null;
        const dt = new Date(Date.UTC(y,m-1,d)); // UTC midnight to avoid TZ drift
        // validate round-trip
        return (dt.getUTCFullYear()===y && dt.getUTCMonth()===m-1 && dt.getUTCDate()===d) ? dt : null;
      }

      function daysBetween(a,b){
        const MS = 86400000;
        return Math.round((b - a)/MS);
      }

      function isWeekend(utcDate){
        // Convert to local weekday consistently using UTC fields
        const day = new Date(utcDate.getUTCFullYear(), utcDate.getUTCMonth(), utcDate.getUTCDate()).getDay();
        return day===0 || day===6; // Sun(0) or Sat(6)
      }

      function parseHolidaySet(text){
        const set = new Set();
        if(!text) return set;
        text.split(/[,\n]+/).map(s=>s.trim()).filter(Boolean).forEach(v=>{
          const dt = parseDate(v);
          if(dt) set.add(dt.toISOString().slice(0,10));
        });
        return set;
      }

      function addMonthsUTC(dt, months){
        const y = dt.getUTCFullYear();
        const m = dt.getUTCMonth();
        const d = dt.getUTCDate();
        const targetM = m + months;
        const tmp = new Date(Date.UTC(y, targetM, 1));
        const daysInTargetMonth = new Date(Date.UTC(tmp.getUTCFullYear(), tmp.getUTCMonth()+1, 0)).getUTCDate();
        const day = Math.min(d, daysInTargetMonth);
        return new Date(Date.UTC(tmp.getUTCFullYear(), tmp.getUTCMonth(), day));
      }

      function diffYMD(d1, d2){
        // assumes d2 >= d1 and both UTC dates
        let years = d2.getUTCFullYear() - d1.getUTCFullYear();
        let months = d2.getUTCMonth() - d1.getUTCMonth();
        let days = d2.getUTCDate() - d1.getUTCDate();

        if(days < 0){
          const prevMonth = new Date(Date.UTC(d2.getUTCFullYear(), d2.getUTCMonth(), 0));
          days += prevMonth.getUTCDate();
          months -= 1;
        }
        if(months < 0){
          months += 12;
          years -= 1;
        }

        // Ensure canonical form by reconstructing
        let cursor = new Date(Date.UTC(d1.getUTCFullYear(), d1.getUTCMonth(), d1.getUTCDate()));
        cursor = addMonthsUTC(cursor, years*12 + months);
        if(cursor > d2){
          // adjust back a month if overshoot (edge cases around month-end)
          cursor = addMonthsUTC(cursor, -1);
          months = (months + 11) % 12;
          if(months === 11) years -= 1;
        }
        days = daysBetween(cursor, d2);
        return {years, months, days};
      }

      function countBusinessDays(d1, d2, inclusive, holidaySet){
        const step = 86400000;
        let count = 0;
        let start = new Date(d1);
        let end = new Date(d2);
        if(!inclusive){
          start = new Date(start.getTime()+step); // start+1
        }
        for(let t = start.getTime(); t <= end.getTime(); t += step){
          const cur = new Date(t);
          const iso = cur.toISOString().slice(0,10);
          if(!isWeekend(cur) && !holidaySet.has(iso)) count++;
        }
        return count;
      }

      function validate(){
        let ok = true;
        startErr.hidden = true; startErr.textContent = '';
        endErr.hidden = true; endErr.textContent = '';

        const a = parseDate(startDate.value);
        const b = parseDate(endDate.value);
        if(!a){ ok = false; startErr.hidden = false; startErr.textContent = 'Please enter a valid start date (YYYY-MM-DD).'; }
        if(!b){ ok = false; endErr.hidden = false; endErr.textContent = 'Please enter a valid end date (YYYY-MM-DD).'; }
        if(a && b && b < a){ ok = false; endErr.hidden = false; endErr.textContent = 'End date must be the same as or after the start date.'; }
        return ok;
      }

      function calculate(){
        if(!validate()) return;
        const a = parseDate(startDate.value);
        const b0 = parseDate(endDate.value);
        const inclusive = (mode.value === 'inclusive');
        const holidaySet = parseHolidaySet(holidays.value);

        // Total days
        let total = daysBetween(a, b0);
        if(inclusive) total += 1;

        // Weeks and days
        const weeks = Math.floor(total / 7);
        const remDays = total % 7;

        // YMD: for inclusive, use b = b0; for exclusive, use b = b0 but interpretation is same — YMD based on boundaries
        const b = b0; // We express exact calendar span from a to b
        const {years, months, days} = diffYMD(a, b);

        // Business days
        const bizDays = (biz.value === 'skip-weekends') ? countBusinessDays(a, b, inclusive, holidaySet) : total;

        // Render
        totalDaysEl.textContent = new Intl.NumberFormat().format(total);
        businessDaysEl.textContent = new Intl.NumberFormat().format(bizDays);
        weeksDaysEl.textContent = `${weeks} wk ${remDays} d`;
        ymdEl.textContent = `${years} yr ${months} mo ${days} d`;

        notesEl.innerHTML = inclusive
          ? '<em>Inclusive mode:</em> both boundary dates are counted in Total days and Business days.'
          : '<em>Exclusive mode:</em> counts whole days strictly between the two dates.';
      }

      // Inline validation on blur per spec
      [startDate, endDate].forEach(inp => inp.addEventListener('blur', validate));

      calcBtn.addEventListener('click', calculate);
      resetBtn.addEventListener('click', () => {
        startDate.value = '';
        endDate.value = '';
        mode.value = 'exclusive';
        biz.value = 'skip-weekends';
        holidays.value = '';
        [totalDaysEl,businessDaysEl,weeksDaysEl,ymdEl].forEach(n=>n.textContent='—');
        notesEl.textContent = '';
        startErr.hidden = true; endErr.hidden = true;
      });
      printBtn.addEventListener('click', ()=>window.print());

      // Sensible defaults: today and +30 days
      const today = new Date();
      const isoToday = today.toISOString().slice(0,10);
      const plus30 = new Date(today.getTime() + 30*86400000).toISOString().slice(0,10);
      startDate.value = isoToday;
      endDate.value = plus30;
      calculate();
    })();
  </script>
</body>
</html>
","item":"https://calcdomain.com/lifestyle-everyday.html"},
      {"@type":"ListItem","position":3,"name":"Time and Date","item":"https://calcdomain.com/subcategories/time-date.html"},
      {"@type":"ListItem","position":4,"name":"Date Difference Calculator","item":"https://calcdomain.com/date-difference-calculator.html"}
    ]
  }
  </script>
  <!-- JSON-LD: FAQPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "Is the end date included or excluded?",
        "acceptedAnswer": {"@type":"Answer","text":"You can choose inclusive (counts both start and end) or exclusive (counts whole days in between). The default is exclusive, which matches most scheduling conventions."}
      },
      {
        "@type": "Question",
        "name": "How are business days calculated?",
        "acceptedAnswer": {"@type":"Answer","text":"Business days skip Saturdays and Sundays by default. You can also enter holiday dates to exclude them from the count."}
      },
      {
        "@type": "Question",
        "name": "Does the calculator use leap years correctly?",
        "acceptedAnswer": {"@type":"Answer","text":"Yes. Calculations follow the proleptic Gregorian calendar (ISO 8601) including leap years (e.g., 2000 and 2024)."}
      },
      {
        "@type": "Question",
        "name": "What is the difference between total days and Y–M–D breakdown?",
        "acceptedAnswer": {"@type":"Answer","text":"Total days is a simple count of calendar days. The Y–M–D result expresses the exact calendar interval in whole years and months plus remaining days."}
      },
      {
        "@type": "Question",
        "name": "Which holidays format is supported?",
        "acceptedAnswer": {"@type":"Answer","text":"Use ISO format YYYY-MM-DD, separated by commas or new lines. Example: 2025-12-25, 2025-12-26."}
      }
    ]
  }
  </script>
  <!-- JSON-LD: HowTo -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to calculate days between dates",
    "step": [
      {"@type":"HowToStep","name":"Enter start date","text":"Pick the start date."},
      {"@type":"HowToStep","name":"Enter end date","text":"Pick the end date (must be on or after the start date)."},
      {"@type":"HowToStep","name":"Choose inclusive or exclusive","text":"Inclusive counts both start and end; exclusive counts days between."},
      {"@type":"HowToStep","name":"Optional: add holidays","text":"Paste or type known holidays to exclude from business-day counts."},
      {"@type":"HowToStep","name":"Review results","text":"See total days, weeks, business days, and precise years–months–days breakdown."}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky per spec) -->
  <header class="bg-white border-b">
    <div class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>
      <nav class="hidden md:flex gap-6 text-sm">
        <a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
        Categories
      </nav>
    </div>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <section class="w-full lg:w-2/3">
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
          <a href="lifestyle-everyday.html" class="hover:text-blue-600">Lifestyle</a> &raquo;
          <a href="subcategories/time-date.html" class="hover:text-blue-600">Time and Date</a> &raquo;
          <span class="text-gray-900">Date Difference Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-lg shadow-sm">
          <h1 class="text-3xl font-extrabold mb-2">date difference calculator</h1>
          <p class="text-gray-700 mb-6">Quickly compute the exact time between two calendar dates: total days, weeks, business days (skipping weekends and optional holidays), and a precise Years–Months–Days breakdown. Built for planners, HR, legal, academic and everyday scheduling.</p>

          <!-- Calculator UI -->
          <section id="calculator" class="space-y-6" aria-labelledby="calcHeading">
            <h2 id="calcHeading" class="sr-only">Calculator Inputs</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Start date -->
              <div>
                <label for="startDate" class="block text-sm font-medium text-gray-800">Start date <span aria-hidden="true" class="text-red-600">*</span></label>
                <div class="flex items-start gap-2">
                  <input type="date" id="startDate" aria-required="true" aria-describedby="startDateHelp startDateError" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" />
                  <button type="button" class="mt-1 px-3 py-2 border rounded-md" aria-expanded="false" aria-controls="startDateHelp" aria-label="What counts as start date?">?</button>
                </div>
                <p id="startDateHelp" class="text-sm text-gray-600 mt-1 hidden">The first day of the period. For inclusive mode it is counted; for exclusive mode it is not.</p>
                <p id="startDateError" class="text-sm text-red-700 mt-1" role="alert" hidden></p>
              </div>

              <!-- End date -->
              <div>
                <label for="endDate" class="block text-sm font-medium text-gray-800">End date <span aria-hidden="true" class="text-red-600">*</span></label>
                <div class="flex items-start gap-2">
                  <input type="date" id="endDate" aria-required="true" aria-describedby="endDateHelp endDateError" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" />
                  <button type="button" class="mt-1 px-3 py-2 border rounded-md" aria-expanded="false" aria-controls="endDateHelp" aria-label="What counts as end date?">?</button>
                </div>
                <p id="endDateHelp" class="text-sm text-gray-600 mt-1 hidden">The last day of the period. In inclusive mode it is counted; in exclusive mode it is not.</p>
                <p id="endDateError" class="text-sm text-red-700 mt-1" role="alert" hidden></p>
              </div>

              <!-- Mode -->
              <div>
                <label for="mode" class="block text-sm font-medium text-gray-800">Counting mode</label>
                <select id="mode" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" aria-describedby="modeHelp">
                  <option value="exclusive" selected>Exclusive (days in-between)</option>
                  <option value="inclusive">Inclusive (count start and end)</option>
                </select>
                <p id="modeHelp" class="text-sm text-gray-600 mt-1">Choose whether to include both boundary dates.</p>
              </div>

              <!-- Business days toggle -->
              <div>
                <label for="biz" class="block text-sm font-medium text-gray-800">Business days</label>
                <select id="biz" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" aria-describedby="bizHelp">
                  <option value="skip-weekends" selected>Skip weekends</option>
                  <option value="count-all">Count all days</option>
                </select>
                <p id="bizHelp" class="text-sm text-gray-600 mt-1">Skip Saturdays and Sundays for business-day totals.</p>
              </div>

              <!-- Holidays -->
              <div class="md:col-span-2">
                <label for="holidays" class="block text-sm font-medium text-gray-800">Holidays to exclude (optional)</label>
                <textarea id="holidays" rows="3" placeholder="YYYY-MM-DD, one per line or separated by commas" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500" aria-describedby="holidayHelp"></textarea>
                <p id="holidayHelp" class="text-sm text-gray-600 mt-1">These dates are excluded from business-day counts.</p>
              </div>
            </div>

            <div class="flex items-center gap-3">
              <button id="calcBtn" class="px-5 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus-visible:outline-none" aria-label="Calculate difference">Calculate</button>
              <button id="resetBtn" class="px-5 py-3 bg-gray-100 text-gray-800 font-semibold rounded-lg hover:bg-gray-200" aria-label="Reset inputs">Reset</button>
              <button id="printBtn" class="px-5 py-3 bg-white border text-gray-800 font-semibold rounded-lg hover:bg-gray-50" aria-label="Print results">Print</button>
            </div>
          </section>

          <!-- Results -->
          <section id="results" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6 fade-in" aria-live="polite">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="result-card">
                <h4>Total days</h4>
                <p id="totalDays">—</p>
              </div>
              <div class="result-card">
                <h4>Business days</h4>
                <p id="businessDays">—</p>
              </div>
              <div class="result-card">
                <h4>Weeks & days</h4>
                <p id="weeksDays">—</p>
              </div>
              <div class="result-card">
                <h4>Years–Months–Days</h4>
                <p id="ymd">—</p>
              </div>
            </div>
            <div class="mt-6 text-sm text-gray-700" id="notes"></div>
          </section>
        </div>

        <!-- Authoritative ecosystem content -->
        <article class="bg-white p-6 rounded-lg shadow-sm mt-8 prose">
          <h2>Data source & methodology</h2>
          <p><strong>AuthoritativeDataSource:</strong> ISO 8601 (Parts 1 & 2, 2019) – Data elements and interchange formats — Information interchange — Representation of dates and times; and RFC 3339 (2002) Internet profile. See the <a class="text-blue-600" href="https://www.iso.org/standard/70907.html">ISO 8601 standard</a> and <a class="text-blue-600" href="https://www.rfc-editor.org/rfc/rfc3339">RFC 3339</a>. All computations assume the <em>proleptic Gregorian calendar</em> used by ISO 8601. <br><em>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</em></p>

          <h2>The formula explained</h2>
          <div class="formula-box" aria-label="Mathematical formulas in LaTeX">
<pre>\(\textbf{TotalDays} = d_2 - d_1 + \mathbb{1}_{\{\text{inclusive}\}}\)

\(\textbf{Weeks}\,=\,\left\lfloor\dfrac{\text{TotalDays}}{7}\right\rfloor,\quad \textbf{RemainderDays}=\text{TotalDays}\bmod 7\)

For calendar breakdown (Years–Months–Days), let \(d_1\) be the start date and \(d_2\) the end date (with \(d_2\ge d_1\)). We find integers \(y,m,\delta\) such that:
\[ d_1 + (y\,\text{years}) + (m\,\text{months}) + (\delta\,\text{days}) = d_2,\]
with \(0\le m<12\) and \(0\le \delta < \text{daysInMonth}(d_1+y\,\text{years}+m\,\text{months})\). This is computed by advancing years then months, adjusting for month lengths and leap years per Gregorian rules.

Business days count excludes Saturdays and Sundays and removes any listed holidays \(H\subseteq[d_1,d_2]\):
\[\textbf{BusinessDays} = |\{ d\in[d_1,d_2] : d\notin H,\; \text{weekday}(d)\in\{\text{Mon..Fri}\}\}|.\]
</pre>
          </div>

          <h2>Glossary of variables</h2>
          <ul>
            <li><strong>Start date (d₁):</strong> First day of the interval.</li>
            <li><strong>End date (d₂):</strong> Last day of the interval.</li>
            <li><strong>Inclusive/Exclusive:</strong> Whether to count both boundaries.</li>
            <li><strong>Total days:</strong> Number of calendar days in the interval.</li>
            <li><strong>Weeks & days:</strong> Equivalent weeks plus remaining days.</li>
            <li><strong>Years–Months–Days:</strong> Exact calendar interval using Gregorian month lengths.</li>
            <li><strong>Business days:</strong> Days excluding weekends and user-listed holidays.</li>
          </ul>

          <h2>How it works: a step‑by‑step example</h2>
          <p><strong>Example:</strong> Start <code>2025‑01‑15</code>, End <code>2025‑03‑02</code>, inclusive, skip weekends, no holidays.</p>
          <ol>
            <li>TotalDays = (Mar 2 − Jan 15) + 1 = 47 + 1 = <strong>48</strong>.</li>
            <li>Weeks = ⌊48/7⌋ = 6, RemainderDays = 48 mod 7 = 6 ⇒ <strong>6 weeks 6 days</strong>.</li>
            <li>Y–M–D: from 2025‑01‑15 → +1 month = 2025‑02‑15; +0 months more (since 2025‑03‑15 would overshoot); remaining days = 15 → <strong>0 years, 1 month, 15 days</strong>.</li>
            <li>Business days: iterate 48 dates, remove Saturdays/Sundays ⇒ <strong>34 business days</strong> (no holidays).</li>
          </ol>

          <h2>FAQ</h2>
          <details>
            <summary>What happens if the end date is before the start date?</summary>
            <p>The calculator requires the end date to be on or after the start date. You’ll see a clear error message if that rule is violated.</p>
          </details>
          <details>
            <summary>Do partial days or time zones matter?</summary>
            <p>This tool counts whole calendar days using local time (00:00). For time‑of‑day differences, use a time duration calculator.</p>
          </details>
          <details>
            <summary>Are leap days counted?</summary>
            <p>Yes. February 29 is counted when it falls within the interval. Month lengths and leap year rules follow the proleptic Gregorian calendar.</p>
          </details>
          <details>
            <summary>Can I paste holidays from a spreadsheet?</summary>
            <p>Yes. Paste a column of YYYY‑MM‑DD dates; the tool ignores empty lines and trims whitespace.</p>
          </details>
          <details>
            <summary>Is inclusive mode standard?</summary>
            <p>Both conventions exist. Legal and HR contexts often prefer inclusive; project scheduling commonly uses exclusive. Set what you need explicitly.</p>
          </details>

          <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Content verified by the CalcDomain Editorial Board.<br />
              Last accuracy review: <time datetime="2025-10-27">October 27, 2025</time></p>
          </div>
        </article>
      </section>

      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div id="ad-slot" class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">Ad Placement (300×600)</div>
          <div class="bg-white p-6 rounded-lg shadow-sm">
            <h3 class="font-bold text-lg mb-3">Why this calculator</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Accurate leap‑year and month‑length handling (ISO 8601).</li>
              <li>Business days with optional holidays.</li>
              <li>Accessible, mobile‑first and print‑friendly.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-sm">
            <h3 class="font-bold text-lg mb-3">Related tools</h3>
            <ul class="space-y-2 text-sm">
              <li><a href="time-duration-calculator.html" class="text-blue-600 hover:underline">Time Duration Calculator</a></li>
              <li><a href="workdays-calculator.html" class="text-blue-600 hover:underline">Workdays Calculator</a></li>
              <li><a href="age-calculator.html" class="text-blue-600 hover:underline">Age Calculator</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-600">About</a>
        <a href="contact.html" class="hover:text-blue-600">Contact</a>
        <a href="privacy.html" class="hover:text-blue-600">Privacy</a>
        <a href="terms.html" class="hover:text-blue-600">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator logic (placed before </body> for performance) -->
  <script>
    (function(){
      const el = id => document.getElementById(id);
      const startDate = el('startDate');
      const endDate = el('endDate');
      const mode = el('mode');
      const biz = el('biz');
      const holidays = el('holidays');
      const calcBtn = el('calcBtn');
      const resetBtn = el('resetBtn');
      const printBtn = el('printBtn');

      const totalDaysEl = el('totalDays');
      const businessDaysEl = el('businessDays');
      const weeksDaysEl = el('weeksDays');
      const ymdEl = el('ymd');
      const notesEl = el('notes');

      const startErr = el('startDateError');
      const endErr = el('endDateError');

      // Accessible tooltips (toggle next sibling help)
      document.querySelectorAll('label + div > button[aria-controls]')
        .forEach(btn => {
          btn.addEventListener('click', () => {
            const id = btn.getAttribute('aria-controls');
            const panel = el(id);
            const open = panel.classList.toggle('hidden');
            btn.setAttribute('aria-expanded', String(!open));
          });
          btn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); btn.click(); }});
        });

      function parseDate(value){
        if(!value) return null;
        const [y,m,d] = value.split('-').map(Number);
        if(!y||!m||!d) return null;
        const dt = new Date(Date.UTC(y,m-1,d)); // UTC midnight to avoid TZ drift
        // validate round-trip
        return (dt.getUTCFullYear()===y && dt.getUTCMonth()===m-1 && dt.getUTCDate()===d) ? dt : null;
      }

      function daysBetween(a,b){
        const MS = 86400000;
        return Math.round((b - a)/MS);
      }

      function isWeekend(utcDate){
        // Convert to local weekday consistently using UTC fields
        const day = new Date(utcDate.getUTCFullYear(), utcDate.getUTCMonth(), utcDate.getUTCDate()).getDay();
        return day===0 || day===6; // Sun(0) or Sat(6)
      }

      function parseHolidaySet(text){
        const set = new Set();
        if(!text) return set;
        text.split(/[,\n]+/).map(s=>s.trim()).filter(Boolean).forEach(v=>{
          const dt = parseDate(v);
          if(dt) set.add(dt.toISOString().slice(0,10));
        });
        return set;
      }

      function addMonthsUTC(dt, months){
        const y = dt.getUTCFullYear();
        const m = dt.getUTCMonth();
        const d = dt.getUTCDate();
        const targetM = m + months;
        const tmp = new Date(Date.UTC(y, targetM, 1));
        const daysInTargetMonth = new Date(Date.UTC(tmp.getUTCFullYear(), tmp.getUTCMonth()+1, 0)).getUTCDate();
        const day = Math.min(d, daysInTargetMonth);
        return new Date(Date.UTC(tmp.getUTCFullYear(), tmp.getUTCMonth(), day));
      }

      function diffYMD(d1, d2){
        // assumes d2 >= d1 and both UTC dates
        let years = d2.getUTCFullYear() - d1.getUTCFullYear();
        let months = d2.getUTCMonth() - d1.getUTCMonth();
        let days = d2.getUTCDate() - d1.getUTCDate();

        if(days < 0){
          const prevMonth = new Date(Date.UTC(d2.getUTCFullYear(), d2.getUTCMonth(), 0));
          days += prevMonth.getUTCDate();
          months -= 1;
        }
        if(months < 0){
          months += 12;
          years -= 1;
        }

        // Ensure canonical form by reconstructing
        let cursor = new Date(Date.UTC(d1.getUTCFullYear(), d1.getUTCMonth(), d1.getUTCDate()));
        cursor = addMonthsUTC(cursor, years*12 + months);
        if(cursor > d2){
          // adjust back a month if overshoot (edge cases around month-end)
          cursor = addMonthsUTC(cursor, -1);
          months = (months + 11) % 12;
          if(months === 11) years -= 1;
        }
        days = daysBetween(cursor, d2);
        return {years, months, days};
      }

      function countBusinessDays(d1, d2, inclusive, holidaySet){
        const step = 86400000;
        let count = 0;
        let start = new Date(d1);
        let end = new Date(d2);
        if(!inclusive){
          start = new Date(start.getTime()+step); // start+1
        }
        for(let t = start.getTime(); t <= end.getTime(); t += step){
          const cur = new Date(t);
          const iso = cur.toISOString().slice(0,10);
          if(!isWeekend(cur) && !holidaySet.has(iso)) count++;
        }
        return count;
      }

      function validate(){
        let ok = true;
        startErr.hidden = true; startErr.textContent = '';
        endErr.hidden = true; endErr.textContent = '';

        const a = parseDate(startDate.value);
        const b = parseDate(endDate.value);
        if(!a){ ok = false; startErr.hidden = false; startErr.textContent = 'Please enter a valid start date (YYYY-MM-DD).'; }
        if(!b){ ok = false; endErr.hidden = false; endErr.textContent = 'Please enter a valid end date (YYYY-MM-DD).'; }
        if(a && b && b < a){ ok = false; endErr.hidden = false; endErr.textContent = 'End date must be the same as or after the start date.'; }
        return ok;
      }

      function calculate(){
        if(!validate()) return;
        const a = parseDate(startDate.value);
        const b0 = parseDate(endDate.value);
        const inclusive = (mode.value === 'inclusive');
        const holidaySet = parseHolidaySet(holidays.value);

        // Total days
        let total = daysBetween(a, b0);
        if(inclusive) total += 1;

        // Weeks and days
        const weeks = Math.floor(total / 7);
        const remDays = total % 7;

        // YMD: for inclusive, use b = b0; for exclusive, use b = b0 but interpretation is same — YMD based on boundaries
        const b = b0; // We express exact calendar span from a to b
        const {years, months, days} = diffYMD(a, b);

        // Business days
        const bizDays = (biz.value === 'skip-weekends') ? countBusinessDays(a, b, inclusive, holidaySet) : total;

        // Render
        totalDaysEl.textContent = new Intl.NumberFormat().format(total);
        businessDaysEl.textContent = new Intl.NumberFormat().format(bizDays);
        weeksDaysEl.textContent = `${weeks} wk ${remDays} d`;
        ymdEl.textContent = `${years} yr ${months} mo ${days} d`;

        notesEl.innerHTML = inclusive
          ? '<em>Inclusive mode:</em> both boundary dates are counted in Total days and Business days.'
          : '<em>Exclusive mode:</em> counts whole days strictly between the two dates.';
      }

      // Inline validation on blur per spec
      [startDate, endDate].forEach(inp => inp.addEventListener('blur', validate));

      calcBtn.addEventListener('click', calculate);
      resetBtn.addEventListener('click', () => {
        startDate.value = '';
        endDate.value = '';
        mode.value = 'exclusive';
        biz.value = 'skip-weekends';
        holidays.value = '';
        [totalDaysEl,businessDaysEl,weeksDaysEl,ymdEl].forEach(n=>n.textContent='—');
        notesEl.textContent = '';
        startErr.hidden = true; endErr.hidden = true;
      });
      printBtn.addEventListener('click', ()=>window.print());

      // Sensible defaults: today and +30 days
      const today = new Date();
      const isoToday = today.toISOString().slice(0,10);
      const plus30 = new Date(today.getTime() + 30*86400000).toISOString().slice(0,10);
      startDate.value = isoToday;
      endDate.value = plus30;
      calculate();
    })();
  </script>
</body>
</html>

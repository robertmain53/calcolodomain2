<!DOCTYPE html>
<html lang="en"><head> 
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Markup Calculator | Business Finance Tool</title>
<meta content="Professional-grade markup calculator for businesses. Compute selling price, markup %, profit, and gross margin from cost. Mobile-first, WCAG-accessible, and optimized for Core Web Vitals." name="description"/>
<meta content="Ugo Candido" name="author"/>
<meta content="index, follow" name="robots"/>
<link href="https://calcdomain.com/markup.html" rel="canonical"/>
<meta content="#0b5cab" name="theme-color"/>
<meta content="website" property="og:type"/>
<meta content="Markup Calculator | Business Finance Tool" property="og:title"/>
<meta content="Compute selling price, markup %, profit, and gross margin from cost. WCAG-accessible and mobile-first." property="og:description"/>
<meta content="https://calcdomain.com/markup.html" property="og:url"/>
<meta content="CalcDomain" property="og:site_name"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="Markup Calculator | Business Finance Tool" name="twitter:title"/>
<meta content="Compute selling price, markup %, profit, and gross margin from cost. WCAG-accessible and mobile-first." name="twitter:description"/>
<link as="style" href="style.css" onload="this.onload=null;this.rel='stylesheet'" rel="preload"/>
<noscript><link href="style.css" rel="stylesheet"/></noscript>
<style>
    :root{
      --primary:#0b5cab; --primary-contrast:#ffffff;
      --text:#1a1f36; --muted:#5b6475; --bg:#f7f8fa; --surface:#ffffff;
      --border:#d9dee6; --success:#1e7f4d; --error:#c1272d;
      --radius:12px; --gap:1rem;
      --touch:48px;
    }
    *,*::before,*::after{ box-sizing:border-box; }
    html{ font-size:16px; }
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color:var(--text); background:var(--bg); line-height:1.6;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    a{ color:var(--primary); text-decoration:none; }
    a:hover{ text-decoration:underline; }
    h1,h2,h3{ color:#0b2a57; line-height:1.25; margin:0 0 .75rem; }
    h1{ font-size:clamp(1.6rem,4.5vw,2.2rem); }
    h2{ font-size:clamp(1.3rem,3.5vw,1.75rem); margin-top:2rem; }
    h3{ font-size:clamp(1.1rem,3vw,1.25rem); margin-top:1rem; }
    p{ margin:.75rem 0 1rem; max-width:72ch; }
    ul{ padding-left:1.25rem; }
    code, kbd{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#eef2f7; padding:.15em .35em; border-radius:4px; }
    .container{ max-width:1000px; margin:0 auto; padding:clamp(1rem,3vw,2rem); }
    /* Page order wrapper */
    main{ display:block; }
    /* Calculator layout */
    .calc-shell{
      display:grid; gap:clamp(1rem,3vw,1.25rem);
      grid-template-columns:1fr; margin-top:.5rem;
    }
    @media (min-width: 992px){
      .calc-shell{ grid-template-columns:minmax(280px,420px) 1fr; align-items:start; }
    }
    .card{
      background:var(--surface); border:1px solid var(--border); border-radius:var(--radius);
      padding:clamp(1rem,3vw,1.5rem); box-shadow:0 2px 8px rgba(16,24,40,.04);
    }
    .calculator section, .results section{ margin:0; }
    .form-group{ margin-bottom:1rem; }
    .form-group:last-child{ margin-bottom:0; }
    label{ display:block; font-weight:600; margin-bottom:.5rem; }
    .help-inline{ display:inline-flex; align-items:center; gap:.25rem; }
    .tooltip-btn{
      margin-left:.5rem; inline-size:var(--touch); block-size:var(--touch);
      border:1px solid var(--border); background:var(--surface); color:var(--primary);
      border-radius:50%; cursor:pointer; font-weight:700; line-height:1;
    }
    .tooltip-btn:focus-visible{ outline:3px solid var(--primary); outline-offset:2px; }
    .tooltip{
      display:none; margin:.5rem 0 0; padding:.75rem; border-radius:8px;
      background:#eef6ff; color:#0b2a57; border:1px solid #bfd8ff;
    }
    .tooltip[data-open="true"]{ display:block; }
    .input-group{ position:relative; }
    .input-suffix, .input-prefix{
      position:absolute; inset-inline-end:.75rem; inset-block-start:50%; transform:translateY(-50%);
      color:var(--muted); pointer-events:none;
    }
    .input-prefix{ inset-inline-start:.75rem; inset-inline-end:auto; }
    .form-control{
      width:100%; min-height:var(--touch);
      padding:.75rem 2.25rem; /* room for suffix/prefix */
      border:1px solid var(--border); border-radius:10px; font-size:1rem; background:#fff;
      transition:box-shadow .2s ease, border-color .2s ease;
    }
    .form-control:focus-visible{
      outline:3px solid #98c6ff; outline-offset:2px; border-color:#5aa3ff;
      box-shadow:0 0 0 3px rgba(11,92,171,.15);
    }
    .form-control[aria-invalid="true"]{ border-color:var(--error); }
    .error-message{ color:var(--error); font-size:.9rem; margin-top:.35rem; min-height:1.25rem; }
    fieldset{ border:0; padding:0; margin:0 0 1rem; }
    .segmented{
      display:flex; gap:.5rem; flex-wrap:wrap; border:1px solid var(--border); border-radius:10px; padding:.35rem;
    }
    .segmented input[type="radio"]{ position:absolute; opacity:0; width:0; height:0; }
    .segmented label{
      flex:1 1 auto; text-align:center; padding:.6rem .75rem; border-radius:8px; cursor:pointer; user-select:none; min-width:calc(var(--touch)*3);
    }
    .segmented input[type="radio"]:focus-visible + label{ outline:3px solid var(--primary); outline-offset:2px; }
    .segmented input[type="radio"]:checked + label{ background:var(--primary); color:var(--primary-contrast); }
    .actions{ display:flex; gap:.75rem; flex-wrap:wrap; margin-top:.5rem; }
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:.5rem;
      min-height:var(--touch); min-width:var(--touch); padding:.7rem 1rem;
      border-radius:10px; border:1px solid transparent; cursor:pointer; font-weight:700;
    }
    .btn-primary{ background:var(--primary); color:#fff; border-color:var(--primary); }
    .btn-secondary{ background:#eff3f8; color:#0b2a57; border-color:#d0d7e2; }
    .btn:focus-visible{ outline:3px solid #98c6ff; outline-offset:2px; }
    .results .result-grid{
      display:grid; gap:.75rem; grid-template-columns:1fr; margin-top:.5rem;
    }
    @media (min-width: 640px){
      .results .result-grid{ grid-template-columns:repeat(2,1fr); }
    }
    .result{
      display:flex; align-items:center; justify-content:space-between;
      background:#f4f7fb; border:1px solid var(--border); border-radius:10px; padding:.9rem 1rem;
    }
    .result .label{ color:var(--muted); }
    .result .value{ font-weight:800; color:var(--success); font-size:1.15rem; }
    .results .card{ min-height:240px; } /* Prevent CLS */
    .formula-box{
      background:#eef2f7; border:1px solid var(--border); border-radius:10px; padding:1rem; overflow:auto;
      font-size:1.05rem;
    }
    .author-box{ margin-top:2rem; padding-top:1rem; border-top:1px solid var(--border); color:var(--muted); font-size:.95rem; }
    /* Header non-sticky guard in case external CSS attempts otherwise */
    .site-header{ position:static !important; }
    /* Visually hidden for a11y */
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
    /* Reduce motion preference */
    @media (prefers-reduced-motion: reduce){
      *{ scroll-behavior:auto !important; transition:none !important; animation:none !important; }
    }
  </style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Markup Calculator",
  "description": "Compute selling price, markup %, profit, and gross margin from cost. WCAG 2.1 AA accessible, mobile-first, and optimized for Core Web Vitals.",
  "url": "https://calcdomain.com/markup.html",
  "inLanguage": "en",
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  },
  "dateModified": "2025-09-13",
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "How It Works: A Step-by-Step Example",
      "description": "Example showing how to go from cost and markup to selling price, profit, and margin.",
      "totalTime": "PT1M",
      "step": [
        {
          "@type": "HowToStep",
          "name": "Inputs",
          "text": "Cost = $250, Markup = 40%."
        },
        {
          "@type": "HowToStep",
          "name": "Compute selling price",
          "text": "Selling Price = Cost × (1 + Markup/100) = 250 × 1.40 = $350."
        },
        {
          "@type": "HowToStep",
          "name": "Compute profit",
          "text": "Profit = Selling Price − Cost = 350 − 250 = $100."
        },
        {
          "@type": "HowToStep",
          "name": "Compute gross margin",
          "text": "Margin % = Profit / Selling Price × 100 = 100 / 350 × 100 = 28.57%."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is markup?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Markup is the percentage added to cost to arrive at the selling price. It is calculated as (Selling Price − Cost) / Cost × 100."
          }
        },
        {
          "@type": "Question",
          "name": "What is the difference between markup and margin?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Markup is based on cost, while margin (gross margin) is based on selling price. They are related: Margin % = 100 × Markup % / (100 + Markup %)."
          }
        },
        {
          "@type": "Question",
          "name": "Can markup be negative?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. A negative markup means the selling price is below cost (a markdown or loss)."
          }
        },
        {
          "@type": "Question",
          "name": "How accurate is this calculator?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "It uses standard business math formulas. Make sure your inputs are correct and use consistent units and currency."
          }
        },
        {
          "@type": "Question",
          "name": "Do I need to include taxes in cost?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "It depends on your internal costing. If you price before tax, use net cost. If your policy includes tax in cost, include it consistently."
          }
        },
        {
          "@type": "Question",
          "name": "What fields are required to calculate results?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Pick a mode and provide the two required inputs for that mode: Cost + Markup %, Cost + Selling Price, Selling Price + Markup %, or Cost + Margin %."
          }
        }
      ]
    }
  ]
}
  </script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer></script>
<!-- MathJax for LaTeX formulas -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\(','\)'], ['$', '$']],
      displayMath: [['\[','\]']]
    },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="preload" href="/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="/assets/js/page-enhancements.js" as="script">

</head>
<body>

<main class="container" id="main">
<h1>Markup Calculator</h1>
<p>
      This professional-grade markup calculator helps founders, contractors, and finance teams quickly convert costs into profitable selling prices. Enter any pair of known values (e.g., cost and markup %) to instantly get selling price, profit, and gross margin—optimized for mobile, accessible by design, and ready for everyday decisions.
    </p>
<div class="calc-shell">
<!-- Calculator (Interactive) -->
<section aria-labelledby="calc-heading" class="calculator card">
<h2 id="calc-heading">Calculator</h2>
<fieldset class="form-group">
<legend class="sr-only">Choose calculation mode</legend>
<div aria-label="Solve using" class="segmented" role="radiogroup">
<input checked="" id="mode-cost-markup" name="mode" type="radio" value="cost-markup"/>
<label for="mode-cost-markup">Cost + Markup %</label>
<input id="mode-cost-sell" name="mode" type="radio" value="cost-sell"/>
<label for="mode-cost-sell">Cost + Selling Price</label>
<input id="mode-sell-markup" name="mode" type="radio" value="sell-markup"/>
<label for="mode-sell-markup">Selling Price + Markup %</label>
<input id="mode-cost-margin" name="mode" type="radio" value="cost-margin"/>
<label for="mode-cost-margin">Cost + Margin %</label>
</div>
</fieldset>
<div class="form-group">
<label class="help-inline" for="currencySelect">
            Currency symbol
            <button aria-controls="tt-currency" aria-expanded="false" aria-label="More info about currency symbol" class="tooltip-btn" id="tt-currency-btn" type="button">?</button>
</label>
<div class="input-group">
<select aria-describedby="tt-currency" class="form-control" id="currencySelect">
<option selected="" value="$">$ (Dollar)</option>
<option value="€">€ (Euro)</option>
<option value="£">£ (Pound)</option>
<option value="₹">₹ (Rupee)</option>
<option value="¥">¥ (Yen)</option>
<option value="">No symbol</option>
</select>
</div>
<div class="tooltip" data-open="false" id="tt-currency" role="note">
            The symbol is used for display only. Enter numeric values below without any symbol.
          </div>
</div>
<div class="form-group">
<label class="help-inline" for="cost">
            Cost *
            <button aria-controls="tt-cost" aria-expanded="false" aria-label="What counts as cost?" class="tooltip-btn" id="tt-cost-btn" type="button">?</button>
</label>
<div class="input-group">
<span class="input-prefix" id="costPrefix">$</span>
<input aria-describedby="costError tt-cost" aria-required="true" class="form-control" id="cost" inputmode="decimal" min="0" placeholder="e.g., 250" step="0.01" type="number"/>
</div>
<div class="tooltip" data-open="false" id="tt-cost" role="note">
            Use your fully loaded cost (materials, labor, overhead) in the same currency for consistency.
          </div>
<div aria-live="polite" class="error-message" id="costError" role="alert"></div>
</div>
<div class="form-group" data-field="markup">
<label class="help-inline" for="markup">
            Markup % *
            <button aria-controls="tt-markup" aria-expanded="false" aria-label="Explain markup" class="tooltip-btn" id="tt-markup-btn" type="button">?</button>
</label>
<div class="input-group">
<input aria-describedby="markupError tt-markup" aria-required="true" class="form-control" id="markup" inputmode="decimal" placeholder="e.g., 40" step="0.01" type="number"/>
<span class="input-suffix">%</span>
</div>
<div class="tooltip" data-open="false" id="tt-markup" role="note">
            Markup is based on cost. Example: 40% markup on a $250 cost gives a $350 selling price.
          </div>
<div aria-live="polite" class="error-message" id="markupError" role="alert"></div>
</div>
<div class="form-group" data-field="sell">
<label class="help-inline" for="sell">
            Selling Price *
            <button aria-controls="tt-sell" aria-expanded="false" aria-label="About selling price" class="tooltip-btn" id="tt-sell-btn" type="button">?</button>
</label>
<div class="input-group">
<span class="input-prefix" id="sellPrefix">$</span>
<input aria-describedby="sellError tt-sell" aria-required="true" class="form-control" id="sell" inputmode="decimal" min="0" placeholder="e.g., 350" step="0.01" type="number"/>
</div>
<div class="tooltip" data-open="false" id="tt-sell" role="note">
            The price you charge your customer, before taxes unless your policy is tax-inclusive.
          </div>
<div aria-live="polite" class="error-message" id="sellError" role="alert"></div>
</div>
<div class="form-group" data-field="margin">
<label class="help-inline" for="margin">
            Margin % *
            <button aria-controls="tt-margin" aria-expanded="false" aria-label="Explain margin" class="tooltip-btn" id="tt-margin-btn" type="button">?</button>
</label>
<div class="input-group">
<input aria-describedby="marginError tt-margin" aria-required="true" class="form-control" id="margin" inputmode="decimal" placeholder="e.g., 30" step="0.01" type="number"/>
<span class="input-suffix">%</span>
</div>
<div class="tooltip" data-open="false" id="tt-margin" role="note">
            Margin (gross) is based on selling price: Profit ÷ Selling Price × 100.
          </div>
<div aria-live="polite" class="error-message" id="marginError" role="alert"></div>
</div>
<div class="actions">
<button aria-label="Calculate results" class="btn btn-primary" id="calcBtn" type="button">Calculate</button>
<button aria-label="Reset all fields" class="btn btn-secondary" id="resetBtn" type="button">Reset</button>
</div>
</section>
<!-- Results -->
<section aria-labelledby="results-heading" class="results card">
<h2 id="results-heading">Results</h2>
<div aria-atomic="true" aria-live="polite" class="result-grid">
<div class="result">
<span class="label">Selling Price</span>
<span class="value" id="r-sell">$0.00</span>
</div>
<div class="result">
<span class="label">Profit</span>
<span class="value" id="r-profit">$0.00</span>
</div>
<div class="result">
<span class="label">Markup %</span>
<span class="value" id="r-markup">0.00%</span>
</div>
<div class="result">
<span class="label">Gross Margin %</span>
<span class="value" id="r-margin">0.00%</span>
</div>
</div>
</section>
</div>
<!-- Authoritative content ecosystem -->
<section aria-labelledby="datasource">
<h2 id="datasource">Data Source and Methodology</h2>
<p>
        Authoritative Data Source: Investopedia — “Markup Definition,” updated 2024. Available at:
        <a href="https://www.investopedia.com/terms/m/markup.asp" rel="nofollow noopener" target="_blank">https://www.investopedia.com/terms/m/markup.asp</a>.
        Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.
      </p>
</section>
<section aria-labelledby="formula">
<h2 id="formula">The Formula Explained</h2>
<div aria-live="off" class="formula-box">
<p>Primary relationships:</p>
<p>$$ \text{Markup \%} = \frac{P_{\text{sell}} - C}{C} \times 100 $$</p>
<p>$$ P_{\text{sell}} = C \times \left(1 + \frac{\text{Markup \%}}{100}\right) $$</p>
<p>$$ \text{Profit} = P_{\text{sell}} - C $$</p>
<p>$$ \text{Margin \%} = \frac{\text{Profit}}{P_{\text{sell}}} \times 100 $$</p>
<p>Markup–Margin conversions:</p>
<p>$$ \text{Margin \%} = \frac{100 \times \text{Markup \%}}{100 + \text{Markup \%}} \quad ; \quad
           \text{Markup \%} = \frac{100 \times \text{Margin \%}}{100 - \text{Margin \%}} $$</p>
</div>
</section>
<section aria-labelledby="glossary">
<h2 id="glossary">Glossary of Variables</h2>
<ul>
        - Cost (C): The fully loaded internal cost to produce or procure the item/service.<br/>
        - Markup %: Percentage added on top of cost to reach the selling price.<br/>
        - Selling Price (P_sell): The price charged to the customer (typically pre-tax).<br/>
        - Profit: Difference between selling price and cost; Profit = P_sell − C.<br/>
        - Margin %: Profit expressed over selling price; Margin % = Profit / P_sell × 100.
      </ul>
</section>
<section aria-labelledby="example">
<h2 id="example">Worked Example</h2>
<h3>How It Works: A Step-by-Step Example</h3>
<p>
        Suppose your cost is $250 and you want a 40% markup.
      </p>
<ol>
<li>Compute the selling price: P_sell = 250 × (1 + 40/100) = 250 × 1.40 = $350.</li>
<li>Compute the profit: Profit = 350 − 250 = $100.</li>
<li>Compute the margin: Margin % = 100 ÷ 350 × 100 = 28.57%.</li>
</ol>
<p>
        If instead you know the selling price and the cost, you can derive markup % and margin % directly from the formulas above.
      </p>
</section>
<section aria-labelledby="faq">
<h2 id="faq">Frequently Asked Questions (FAQ)</h2>
<div>
<h3>Is markup the same as profit?</h3>
<p>No. Markup is a percentage over cost; profit is the absolute dollar (or currency) difference between selling price and cost.</p>
<h3>What is a good markup?</h3>
<p>It depends on your industry, competition, and cost structure. Many service businesses target 20–60% markup, while some retail categories can exceed 100%.</p>
<h3>How do I convert a target margin to markup?</h3>
<p>Use: Markup % = 100 × Margin % / (100 − Margin %). For a 30% margin, the markup is 42.857%.</p>
<h3>Can I include overhead in cost?</h3>
<p>Yes. Best practice is to include all relevant costs (materials, labor, variable and allocated overhead) so the markup truly covers expenses and desired profit.</p>
<h3>Does this calculator support markdowns (negative markup)?</h3>
<p>Yes. Enter a negative markup to see how a discount affects price, profit, and margin. Note that margin must remain below 100%.</p>
<h3>Why is margin always lower than markup for positive profits?</h3>
<p>Because margin divides profit by selling price, which is larger than cost. With positive profits, Margin % &lt; Markup %.</p>
<h3>Will taxes change the calculations?</h3>
<p>The formulas are tax-agnostic. If your pricing is pre-tax, enter pre-tax values; if tax is part of cost or price, keep it consistent across inputs.</p>
</div>
</section>
<div class="author-box">
<p>
        Strumento sviluppato da <strong>Ugo Candido</strong>,. Contenuti verificati da, <strong>CalcDomain Editorial Board</strong>.<br/>
        Ultima revisione per l'accuratezza in data: <time datetime="2025-09-13">September 13, 2025</time>.
      </p>
</div>
</main>
<script defer="">
    (function(){
      'use strict';

      // Elements
      const currencySelect = document.getElementById('currencySelect');
      const costPrefix = document.getElementById('costPrefix');
      const sellPrefix = document.getElementById('sellPrefix');

      const costEl = document.getElementById('cost');
      const markupEl = document.getElementById('markup');
      const sellEl = document.getElementById('sell');
      const marginEl = document.getElementById('margin');

      const costError = document.getElementById('costError');
      const markupError = document.getElementById('markupError');
      const sellError = document.getElementById('sellError');
      const marginError = document.getElementById('marginError');

      const modeRadios = document.querySelectorAll('input[name="mode"]');
      const calcBtn = document.getElementById('calcBtn');
      const resetBtn = document.getElementById('resetBtn');

      const rSell = document.getElementById('r-sell');
      const rProfit = document.getElementById('r-profit');
      const rMarkup = document.getElementById('r-markup');
      const rMargin = document.getElementById('r-margin');

      // Tooltips
      const tooltipPairs = [
        ['tt-currency-btn','tt-currency'],
        ['tt-cost-btn','tt-cost'],
        ['tt-markup-btn','tt-markup'],
        ['tt-sell-btn','tt-sell'],
        ['tt-margin-btn','tt-margin']
      ];
      tooltipPairs.forEach(([btnId,panelId]) => {
        const btn = document.getElementById(btnId);
        const panel = document.getElementById(panelId);
        btn.addEventListener('click', () => {
          const open = panel.getAttribute('data-open') === 'true';
          panel.setAttribute('data-open', open ? 'false' : 'true');
          btn.setAttribute('aria-expanded', open ? 'false' : 'true');
        });
        btn.addEventListener('keydown', (e) => {
          if(e.key === 'Escape'){
            panel.setAttribute('data-open','false');
            btn.setAttribute('aria-expanded','false');
            btn.focus();
          }
        });
      });

      // Update currency symbol
      const updateSymbols = () => {
        const sym = currencySelect.value || '';
        costPrefix.textContent = sym;
        sellPrefix.textContent = sym;
        // Repaint results with new symbol
        lastResults && paintResults(lastResults);
      };
      currencySelect.addEventListener('change', updateSymbols);

      // Modes
      const fieldGroups = {
        markup: document.querySelector('[data-field="markup"]'),
        sell: document.querySelector('[data-field="sell"]'),
        margin: document.querySelector('[data-field="margin"]')
      };

      function setMode(mode){
        // Reset required flags, visibility and values for clarity
        // Show/hide fields according to mode and set aria-required
        const show = (key, visible) => {
          fieldGroups[key].style.display = visible ? '' : 'none';
          const input = fieldGroups[key].querySelector('input');
          input.setAttribute('aria-required', visible ? 'true' : 'false');
        };

        // Base visibility
        // Always show Cost
        document.getElementById('cost').closest('.form-group').style.display = '';

        if(mode === 'cost-markup'){
          show('markup', true);
          show('sell', false);
          show('margin', false);
          markupEl.disabled = false;
          sellEl.disabled = true;
          marginEl.disabled = true;
        } else if(mode === 'cost-sell'){
          show('markup', false);
          show('sell', true);
          show('margin', false);
          markupEl.disabled = true;
          sellEl.disabled = false;
          marginEl.disabled = true;
        } else if(mode === 'sell-markup'){
          show('markup', true);
          show('sell', true);
          show('margin', false);
          markupEl.disabled = false;
          sellEl.disabled = false;
          marginEl.disabled = true;
        } else if(mode === 'cost-margin'){
          show('markup', false);
          show('sell', false);
          show('margin', true);
          markupEl.disabled = true;
          sellEl.disabled = true;
          marginEl.disabled = false;
        }
        // Clear any error states when switching modes
        [costEl, markupEl, sellEl, marginEl].forEach(clearError);
      }

      modeRadios.forEach(r => r.addEventListener('change', e => setMode(e.target.value)));
      // Initialize default mode
      setMode(document.querySelector('input[name="mode"]:checked').value);

      // Validation helpers
      function setError(inputEl, errorEl, message){
        inputEl.setAttribute('aria-invalid', 'true');
        errorEl.textContent = message;
      }
      function clearError(inputEl){
        if(!inputEl) return;
        inputEl.setAttribute('aria-invalid', 'false');
        const id = inputEl.getAttribute('id') + 'Error';
        const err = document.getElementById(id);
        if(err) err.textContent = '';
      }

      function validateNumber(inputEl, errorEl, {min = -Infinity, max = Infinity, required = false, name = 'Value'} = {}){
        const v = inputEl.value.trim();
        if(required && v === ''){
          setError(inputEl, errorEl, `${name} is required. Please enter a number.`);
          return null;
        }
        if(v === ''){ // not required or left empty
          clearError(inputEl);
          return null;
        }
        const num = Number(v);
        if(!Number.isFinite(num)){
          setError(inputEl, errorEl, `${name} must be a valid number.`);
          return null;
        }
        if(num < min){
          setError(inputEl, errorEl, `${name} must be ≥ ${min}.`);
          return null;
        }
        if(num > max){
          setError(inputEl, errorEl, `${name} must be ≤ ${max}.`);
          return null;
        }
        clearError(inputEl);
        return num;
      }

      // On blur validation rules per field (mode-aware)
      function validateOnBlur(){
        const mode = document.querySelector('input[name="mode"]:checked').value;
        // Cost
        costEl.addEventListener('blur', () => {
          validateNumber(costEl, costError, { min: 0, required: true, name: 'Cost' });
        });
        // Markup
        markupEl.addEventListener('blur', () => {
          const required = (mode === 'cost-markup' || mode === 'sell-markup');
          validateNumber(markupEl, markupError, { min: -100, max: 1000, required, name: 'Markup %' });
        });
        // Selling price
        sellEl.addEventListener('blur', () => {
          const required = (mode === 'cost-sell' || mode === 'sell-markup');
          validateNumber(sellEl, sellError, { min: 0, required, name: 'Selling Price' });
        });
        // Margin
        marginEl.addEventListener('blur', () => {
          const required = (mode === 'cost-margin');
          // Constrain to (-100, 99.999] for practicality
          validateNumber(marginEl, marginError, { min: -100, max: 99.9999, required, name: 'Margin %' });
        });
      }
      validateOnBlur();

      // Calculation
      function formatMoney(n){
        const sym = currencySelect.value || '';
        const v = Number.isFinite(n) ? n : 0;
        return sym + v.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      }
      function formatPct(n){
        const v = Number.isFinite(n) ? n : 0;
        return v.toFixed(2) + '%';
      }

      let lastResults = null;
      function paintResults(res){
        if(!res){ // reset
          rSell.textContent = formatMoney(0);
          rProfit.textContent = formatMoney(0);
          rMarkup.textContent = formatPct(0);
          rMargin.textContent = formatPct(0);
          return;
        }
        rSell.textContent = formatMoney(res.sell);
        rProfit.textContent = formatMoney(res.profit);
        rMarkup.textContent = formatPct(res.markup);
        rMargin.textContent = formatPct(res.margin);
      }

      function compute(){
        const mode = document.querySelector('input[name="mode"]:checked').value;

        const c = validateNumber(costEl, costError, { min: 0, required: true, name: 'Cost' });
        let mu = null, s = null, mg = null;

        if(mode === 'cost-markup'){
          mu = validateNumber(markupEl, markupError, { min: -100, max: 1000, required: true, name: 'Markup %' });
          if(c === null || mu === null){ lastResults=null; paintResults(null); return; }
          s = c * (1 + mu/100);
          const profit = s - c;
          mg = s !== 0 ? (profit / s) * 100 : 0;
          lastResults = { sell: s, profit, markup: mu, margin: mg };
        }
        else if(mode === 'cost-sell'){
          s = validateNumber(sellEl, sellError, { min: 0, required: true, name: 'Selling Price' });
          if(c === null || s === null){ lastResults=null; paintResults(null); return; }
          const profit = s - c;
          mu = c !== 0 ? (profit / c) * 100 : 0;
          mg = s !== 0 ? (profit / s) * 100 : 0;
          lastResults = { sell: s, profit, markup: mu, margin: mg };
        }
        else if(mode === 'sell-markup'){
          mu = validateNumber(markupEl, markupError, { min: -100, max: 1000, required: true, name: 'Markup %' });
          s = validateNumber(sellEl, sellError, { min: 0, required: true, name: 'Selling Price' });
          if(mu === null || s === null){ lastResults=null; paintResults(null); return; }
          const c2 = (1 + mu/100) !== 0 ? s / (1 + mu/100) : NaN;
          if(!Number.isFinite(c2) || c2 < 0){
            setError(sellEl, sellError, 'Selling Price and Markup % combination is not valid.');
            lastResults=null; paintResults(null); return;
          }
          clearError(sellEl);
          const profit = s - c2;
          mg = s !== 0 ? (profit / s) * 100 : 0;
          // Show computed cost back into the Cost field (non-destructive)
          costEl.value = c2.toFixed(2);
          lastResults = { sell: s, profit, markup: mu, margin: mg };
        }
        else if(mode === 'cost-margin'){
          mg = validateNumber(marginEl, marginError, { min: -100, max: 99.9999, required: true, name: 'Margin %' });
          if(c === null || mg === null){ lastResults=null; paintResults(null); return; }
          if((1 - mg/100) === 0){
            setError(marginEl, marginError, 'Margin % must be less than 100%.');
            lastResults=null; paintResults(null); return;
          }
          s = c / (1 - mg/100);
          const profit = s - c;
          mu = c !== 0 ? (profit / c) * 100 : 0;
          lastResults = { sell: s, profit, markup: mu, margin: mg };
        } else {
          lastResults=null;
        }
        paintResults(lastResults);
      }

      // Live symbols and auto-calc
      updateSymbols();
      [costEl, markupEl, sellEl, marginEl].forEach(el => {
        el.addEventListener('input', () => {
          // Clear errors as the user types, but keep validation on blur
          const id = el.id + 'Error';
          const err = document.getElementById(id);
          if(err && err.textContent) { err.textContent = ''; el.setAttribute('aria-invalid','false'); }
          compute();
        });
      });

      calcBtn.addEventListener('click', compute);

      resetBtn.addEventListener('click', () => {
        [costEl, markupEl, sellEl, marginEl].forEach(el => {
          el.value = '';
          clearError(el);
        });
        lastResults = null;
        paintResults(null);
        // Reset mode and currency
        document.getElementById('mode-cost-markup').checked = true;
        setMode('cost-markup');
        currencySelect.value = '$';
        updateSymbols();
        // Close any tooltips
        document.querySelectorAll('.tooltip').forEach(t => t.setAttribute('data-open','false'));
        document.querySelectorAll('.tooltip-btn').forEach(b => b.setAttribute('aria-expanded','false'));
        costEl.focus();
      });

      // Initial compute (blank)
      paintResults(null);

      // Prevent form submission behavior (if any button type misunderstood by browsers)
      calcBtn.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); compute(); }
      });
      resetBtn.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); }
      });
    })();
  </script>


</body></html>
<!DOCTYPE html>
<html lang="en">
<head>
<link rel="canonical" href="https://calcdomain.com/factoring-calculator.html">





  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Factoring Calculator — Prime & Polynomial Factorization with Steps</title>
  <meta name="description" content="Factor integers into primes and factor univariate polynomials over the rationals. Shows GCF extraction, rational root tests, synthetic division, and fully factored form with steps." />
  
  <link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg" />
  <link rel="shortcut icon" href="https://calcdomain.com/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png" />
  <link rel="manifest" href="https://calcdomain.com/site.webmanifest" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- MathJax for LaTeX rendering -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
          id="MathJax-script"></script>

  <style>
    :root {
      --brand:#1d4ed8; /* blue-700 */
      --accent:#0ea5e9; /* sky-500 */
      --danger:#b91c1c; /* red-700 */
      --focus:#22c55e;  /* green-500 */
    }
    html, body { height: 100%; }
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji'; }
    /* Focus styles (visible, WCAG) */
    :focus {
      outline: 3px solid var(--focus);
      outline-offset: 2px;
    }
    /* Min-heights to prevent CLS when results render */
    #results, #stepsContainer { min-height: 140px; }
    .formula-box {
      background:#f3f4f6; border:1px solid #d1d5db; border-radius:12px; padding:1rem;
      overflow-x:auto; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New",monospace;
    }
    .result-card { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:1rem; }
    .result-card h4 { font-size:0.95rem; color:#374151; margin-bottom:0.25rem; }
    .result-card p { font-size:1.25rem; font-weight:700; color:var(--brand); word-break:break-word; }
    details > summary { cursor:pointer; font-weight:600; padding:0.5rem 0; }
    details[open] > summary { margin-bottom:0.5rem; }
    /* Tooltip panel (hidden by default, toggled by JS) */
    .tip-panel[hidden] { display:none; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New",monospace; border:1px solid #d1d5db; border-radius:6px; padding:0 0.375rem; background:#f9fafb; }
    /* Touch targets */
    .btn, button, .tab-btn { min-height:48px; }
    /* High-contrast text */
    .text-strong { color:#111827; }
    @media print {
      body * { visibility:hidden; }
      #print-section, #print-section * { visibility:visible; }
      #print-section { position:absolute; left:0; top:0; width:100%; }
    }
  </style>

  <!-- JSON-LD: WebPage + BreadCrumb + HowTo + FAQ + WebApplication -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Factoring Calculator",
    "url":"https://calcdomain.com/factoring-calculator.html",
    "inLanguage":"en",
    "description":"Factor integers into primes and factor univariate polynomials over the rationals with steps.",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"}
  }
  </script>
  <script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Math & Conversions",
      "item": "https://calcdomain.com/math-conversions.html"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Algebra",
      "item": "https://calcdomain.com/subcategories/core-math-algebra.html"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "Factoring Calculator",
      "item": "https://calcdomain.com/factoring-calculator.html"
    }
  ]
}</script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"Factoring Calculator",
    "applicationCategory":"EducationalApplication",
    "operatingSystem":"Web",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"},
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to factor a polynomial over the rationals",
    "description":"Extract the GCF, apply the Rational Root Theorem, use synthetic division to peel off linear factors, and factor any remaining quadratic.",
    "step":[
      {"@type":"HowToStep","name":"Normalize & GCF","text":"Arrange in descending powers of x and factor out the integer GCF."},
      {"@type":"HowToStep","name":"Rational Root Theorem","text":"Test p/q where p|constant term and q|leading coefficient."},
      {"@type":"HowToStep","name":"Synthetic division","text":"When a root r is found, divide by (x - r) and repeat."},
      {"@type":"HowToStep","name":"Quadratic remainder","text":"If a quadratic remains, compute the discriminant and factor if possible."}
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What domains does this calculator factor over?","acceptedAnswer":{"@type":"Answer","text":"Integers (prime factorization) and univariate polynomials with integer coefficients factored over the rationals (ℚ)."}},
      {"@type":"Question","name":"Which algorithms are used for polynomials?","acceptedAnswer":{"@type":"Answer","text":"Greatest common factor extraction, the Rational Root Theorem, synthetic division, and closed-form factoring for quadratics."}},
      {"@type":"Question","name":"Can it factor any polynomial?","acceptedAnswer":{"@type":"Answer","text":"It handles most single-variable integer-coefficient polynomials of moderate degree where rational factors exist. Irreducible over ℚ forms are reported if no rational factorization exists."}},
      {"@type":"Question","name":"Does it show steps?","acceptedAnswer":{"@type":"Answer","text":"Yes. You can toggle step-by-step explanations for both integer and polynomial factoring."}},
      {"@type":"Question","name":"What about multiple variables or radicals?","acceptedAnswer":{"@type":"Answer","text":"This version focuses on univariate polynomials in a single symbol (default x) with integer coefficients."}},
      {"@type":"Question","name":"How do I enter polynomials correctly?","acceptedAnswer":{"@type":"Answer","text":"Use standard notation like 2x^3-5x^2+4x-2. Multiplication signs are optional (2x is fine). Spaces are ignored."}},
      {"@type":"Question","name":"Is the integer factorization exact?","acceptedAnswer":{"@type":"Answer","text":"Yes, prime factorization uses exact arithmetic via trial division with small optimizations adequate for numbers up to ~10^12 in typical browsers."}}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky per spec) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
      <div class="flex justify-between items-center">
        <a href="index.html" class="text-2xl font-bold text-blue-700">CalcDomain</a>
        <div class="hidden md:flex items-center gap-6 text-sm">
          <a href="search.html" class="text-gray-700 hover:text-blue-700">Advanced Search</a>
          Categories
        </div>
        <button class="md:hidden p-2 rounded hover:bg-gray-100" aria-label="Open menu">
          <span class="sr-only">Open menu</span>
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Main content -->
      <section class="w-full lg:w-2/3">
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-700">Home</a> &raquo;
          <a href="math.html" class="hover:text-blue-700">Math</a> &raquo;
          <a href="subcategories/core-math-algebra.html" class="hover:text-blue-700">Algebra</a> &raquo;
          <span class="text-gray-900">Factoring Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-xl shadow-md">
          <h1 class="text-3xl font-extrabold text-gray-900 mb-2">factoring calculator</h1>
          <p class="text-gray-700 mb-6">
            Factor integers into primes and factor univariate polynomials (over ℚ) with clear steps. Built for students, educators, and professionals who need reliable, explainable results fast.
          </p>

          <!-- Calculator -->
          <section aria-labelledby="calc-heading" class="mb-6">
            <h2 id="calc-heading" class="sr-only">Interactive factoring calculator</h2>

            <!-- Tabs -->
            <div class="flex gap-2 mb-4" role="tablist" aria-label="Mode selector">
              <button id="tab-int" role="tab" aria-controls="panel-int" aria-selected="true"
                      class="tab-btn px-3 py-2 rounded-lg border text-sm font-medium bg-blue-50 border-blue-200 text-blue-800 focus:outline-none">
                Integer
              </button>
              <button id="tab-poly" role="tab" aria-controls="panel-poly" aria-selected="false"
                      class="tab-btn px-3 py-2 rounded-lg border text-sm font-medium bg-white border-gray-300 text-gray-800 hover:bg-gray-50">
                Polynomial
              </button>
            </div>

            <!-- Integer panel -->
            <div id="panel-int" role="tabpanel" aria-labelledby="tab-int" class="space-y-5">
              <div>
                <label for="intInput" class="block text-sm font-medium text-gray-800">
                  Integer to factor <span class="text-red-700" aria-hidden="true">*</span>
                </label>
                <div class="flex items-start gap-2">
                  <input type="text" inputmode="numeric" pattern="[0-9- ]+"
                         id="intInput" aria-required="true" aria-describedby="intHelp intError"
                         class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
                                focus:outline-none focus:ring-2 focus:ring-blue-500"
                         placeholder="e.g., 360 or 1000003" />
                  <button type="button" class="btn px-2 py-2 rounded-md border border-gray-300"
                          aria-expanded="false" aria-controls="intTip" id="intTipBtn" title="What can I enter?">?</button>
                </div>
                <p id="intHelp" class="text-sm text-gray-600 mt-1">
                  Positive or negative integers up to ~10<sup>12</sup> recommended for instant results.
                </p>
                <div id="intTip" class="tip-panel text-sm text-gray-700 bg-blue-50 border border-blue-200 rounded-md p-3 mt-2" hidden>
                  You can include spaces or a leading minus sign. The tool returns prime factorization like \( 360 = 2^3 \cdot 3^2 \cdot 5 \).
                </div>
                <p id="intError" class="text-sm mt-1 text-red-700" aria-live="polite"></p>
              </div>

              <div class="flex items-center gap-4">
                <label class="inline-flex items-center gap-2">
                  <input type="checkbox" id="intSteps" class="w-5 h-5 border-gray-300 rounded" />
                  <span class="text-sm">Show step-by-step</span>
                </label>
                <button id="btnFactorInt" class="btn px-4 py-2 rounded-lg bg-blue-700 text-white hover:bg-blue-800 focus:outline-none"
                        type="button">Factor integer</button>
              </div>
            </div>

            <!-- Polynomial panel -->
            <div id="panel-poly" role="tabpanel" aria-labelledby="tab-poly" class="space-y-5 hidden">
              <div>
                <label for="polyInput" class="block text-sm font-medium text-gray-800">
                  Polynomial (single variable) <span class="text-red-700" aria-hidden="true">*</span>
                </label>
                <div class="flex items-start gap-2">
                  <input type="text" id="polyInput" aria-required="true" aria-describedby="polyHelp polyError polyTipText"
                         class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
                                focus:outline-none focus:ring-2 focus:ring-blue-500"
                         placeholder="e.g., 2x^3 - 5x^2 + 4x - 2" />
                  <button type="button" class="btn px-2 py-2 rounded-md border border-gray-300"
                          aria-expanded="false" aria-controls="polyTipText" id="polyTipBtn" title="Input help">?</button>
                </div>
                <p id="polyHelp" class="text-sm text-gray-600 mt-1">
                  Use standard notation: coefficients, one variable (default <span class="kbd">x</span>), integer coefficients.
                </p>
                <div id="polyTipText" class="tip-panel text-sm text-gray-700 bg-blue-50 border border-blue-200 rounded-md p-3 mt-2" hidden>
                  Accepts forms like <span class="kbd">x^4-5x^2+4</span>, <span class="kbd">3x^2+6x</span>. Spaces ignored. Use ^ for exponents.
                </div>
                <p id="polyError" class="text-sm mt-1 text-red-700" aria-live="polite"></p>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <label for="varSymbol" class="block text-sm font-medium text-gray-800">Variable symbol</label>
                  <input type="text" id="varSymbol" maxlength="1" value="x" aria-describedby="varHelp"
                         class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
                                focus:outline-none focus:ring-2 focus:ring-blue-500" />
                  <p id="varHelp" class="text-sm text-gray-600 mt-1">Single letter, e.g., x</p>
                </div>
                <div>
                  <label for="domain" class="block text-sm font-medium text-gray-800">Factor over</label>
                  <select id="domain" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
                                           focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="Q" selected>Rationals (ℚ)</option>
                  </select>
                </div>
                <div class="flex items-end">
                  <label class="inline-flex items-center gap-2">
                    <input type="checkbox" id="polySteps" class="w-5 h-5 border-gray-300 rounded" />
                    <span class="text-sm">Show step-by-step</span>
                  </label>
                </div>
              </div>

              <div class="flex items-center gap-4">
                <button id="btnFactorPoly" class="btn px-4 py-2 rounded-lg bg-blue-700 text-white hover:bg-blue-800 focus:outline-none"
                        type="button">Factor polynomial</button>
              </div>
            </div>
          </section>

          <!-- Results -->
          <section aria-labelledby="results-heading" id="results" class="bg-blue-50 border border-blue-100 rounded-xl p-5">
            <h2 id="results-heading" class="sr-only">Results</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="result-card">
                <h4>Fully factored form</h4>
                <p id="factoredOut" class="select-all">—</p>
              </div>
              <div class="result-card">
                <h4>Canonical form</h4>
                <p id="canonicalOut" class="select-all">—</p>
              </div>
              <div class="result-card">
                <h4>Status</h4>
                <p id="statusOut">Waiting for input…</p>
              </div>
            </div>

            <details id="stepsDetails" class="mt-5 bg-white rounded-xl p-4">
              <summary class="text-strong">View steps</summary>
              <div id="stepsContainer" class="prose max-w-none text-sm leading-6 text-gray-800"></div>
            </details>
          </section>

          <!-- Authoritative Content Ecosystem -->
          <section class="prose max-w-none mt-8">
            <h2>Data source &amp; methodology</h2>
            <p>
              <strong>AuthoritativeDataSource:</strong>
              <a class="text-blue-700 underline" href="https://mathworld.wolfram.com/PolynomialFactorization.html">Wolfram MathWorld — Polynomial Factorization</a>
              (accessed 2025) and
              <a class="text-blue-700 underline" href="https://mathworld.wolfram.com/PrimeFactorization.html">Wolfram MathWorld — Prime Factorization</a>.
              Algorithms: integer GCF extraction, Rational Root Theorem testing \( p \mid a_0,\, q \mid a_n \), synthetic division, and quadratic factoring via discriminant.
              <br/><em>All computations strictly follow the formulas and data provided by this source.</em>
            </p>

            <h2>The formulas explained</h2>
            <div class="formula-box">
\[
\textbf{Integer factorization: } n=\prod_{i=1}^{k} p_i^{\,e_i},\quad p_i \text{ primes},\ e_i\in\mathbb{N}.
\]
\[
\textbf{Polynomial GCF: } \gcd(a_0,a_1,\dots,a_n)=g\ \Rightarrow\ f(x)=g\cdot \hat f(x).
\]
\[
\textbf{Rational Root Theorem: } \text{If } r=\frac{p}{q}\in\mathbb{Q} \text{ is a root of } f(x),\ \text{then } p\mid a_0,\ q\mid a_n.
\]
\[
\textbf{Synthetic division: } f(x)=(x-r)q(x)+f(r).
\]
\[
\textbf{Quadratic factoring: } ax^2+bx+c=a\left(x-\frac{-b-\sqrt{b^2-4ac}}{2a}\right)\left(x-\frac{-b+\sqrt{b^2-4ac}}{2a}\right).
\]
            </div>

            <h2>Glossary of variables</h2>
            <ul>
              <li><strong>Integer to factor</strong>: the whole number \( n \) to decompose into primes.</li>
              <li><strong>Polynomial</strong>: univariate expression with integer coefficients, e.g., \( 2x^3-5x^2+4x-2 \).</li>
              <li><strong>Variable symbol</strong>: the single symbol (default \( x \)) used in the polynomial.</li>
              <li><strong>Fully factored form</strong>: product of prime/polynomial factors with exponents.</li>
              <li><strong>Canonical form</strong>: normalized presentation (e.g., sorted primes; monic content separated).</li>
            </ul>

            <h2>How it works: a step-by-step example</h2>
            <h3>Example 1 — Integer</h3>
            <p><strong>Input:</strong> \( n=360 \).</p>
            <p><strong>Process:</strong> Divide by small primes: \( 360=2^3\cdot 3^2\cdot 5 \).</p>
            <p><strong>Output:</strong> \( 360=2^3\cdot 3^2\cdot 5 \).</p>

            <h3>Example 2 — Polynomial</h3>
            <p><strong>Input:</strong> \( f(x)=2x^3-5x^2+4x-2 \).</p>
            <ol>
              <li>GCF \( =1 \). Test rational roots \( \pm1,\pm2,\pm\frac{1}{2} \).</li>
              <li>Evaluate \( f(1)= -1 \), \( f(2)= 2 \), \( f\left(\frac{1}{2}\right)=0 \Rightarrow (x-\tfrac{1}{2}) \) is a factor.</li>
              <li>Synthetic division yields \( f(x)=(x-\tfrac{1}{2})(2x^2-4x+4) \).</li>
              <li>Quadratic \( 2x^2-4x+4 = 2(x^2-2x+2) \) has discriminant \( b^2-4ac=4-8=-4<0 \Rightarrow \) irreducible over \( \mathbb{Q} \).</li>
            </ol>
            <p><strong>Output over \( \mathbb{Q} \):</strong> \( f(x)=\left(x-\tfrac{1}{2}\right)\,2(x^2-2x+2) \).</p>

            <h2>Frequently asked questions</h2>
            <details><summary>How is this different from symbolic CAS tools?</summary>
              <p>This tool targets clear, rational-factor workflows (GCF, rational roots, synthetic division) with explainable steps, not a full CAS.</p>
            </details>
            <details><summary>Can I factor negative integers?</summary>
              <p>Yes. A leading -1 factor is shown, e.g., \( -360 = -1\cdot 2^3\cdot 3^2\cdot 5 \).</p>
            </details>
            <details><summary>What if no rational roots exist?</summary>
              <p>The polynomial is reported irreducible over \( \mathbb{Q} \) (or reduced to irreducible quadratics).</p>
            </details>
            <details><summary>Does order of terms matter?</summary>
              <p>The parser reorders terms into descending powers; spacing is ignored.</p>
            </details>
            <details><summary>What if coefficients share a GCF?</summary>
              <p>The integer content is factored out first so the remaining polynomial is primitive (Gauss’s lemma).</p>
            </details>
          </section>

          <!-- Signature / Review -->
          <article class="mt-8 p-4 bg-gray-50 border border-gray-200 rounded-xl text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Content reviewed by CalcDomain Editorial Board.<br/>
              Last accuracy review: <time datetime="2025-10-25">October 25, 2025</time>
            </p>
          </article>
        </div>
      </section>

      <!-- Sidebar -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div class="bg-gray-200 h-72 rounded-xl flex items-center justify-center text-gray-600">Ad Placement (300×600)</div>
          <div class="bg-white p-6 rounded-xl shadow-md">
            <h3 class="font-bold text-lg mb-3">Why this beats competitors</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Both integer and polynomial factoring in one tool.</li>
              <li>Explainable steps (GCF → rational roots → division → quadratic test).</li>
              <li>Accessible UI (WCAG 2.1 AA), mobile-first, fast rendering.</li>
              <li>Clear LaTeX math and copy-friendly outputs.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-xl shadow-md">
            <h3 class="font-bold text-lg mb-3">Related algebra tools</h3>
            <ul class="space-y-2 text-sm">
              <li>Quadratic Factorer</li>
              <li>Polynomial Simplifier</li>
              <li><a class="text-blue-700 hover:underline" href="gcf-calculator.html">GCF Calculator</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-700">About</a>
        <a href="contact.html" class="hover:text-blue-700">Contact</a>
        <a href="privacy.html" class="hover:text-blue-700">Privacy</a>
        <a href="terms.html" class="hover:text-blue-700">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator logic (placed before </body>; uses inline defer attribute as requested) -->
  <script defer>
  (function () {
    // Utility: safe text
    const esc = (s) => String(s).replace(/[&<>]/g, ch => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[ch]));
    // Tabs
    const tabInt = document.getElementById('tab-int');
    const tabPoly = document.getElementById('tab-poly');
    const panelInt = document.getElementById('panel-int');
    const panelPoly = document.getElementById('panel-poly');

    function switchTab(to) {
      const intActive = (to === 'int');
      tabInt.setAttribute('aria-selected', String(intActive));
      tabPoly.setAttribute('aria-selected', String(!intActive));
      panelInt.classList.toggle('hidden', !intActive);
      panelPoly.classList.toggle('hidden', intActive);
      // Update status text
      setStatus('Waiting for input…');
      setFactored('—');
      setCanonical('—');
      document.getElementById('stepsContainer').innerHTML = '';
    }
    tabInt.addEventListener('click', () => switchTab('int'));
    tabPoly.addEventListener('click', () => switchTab('poly'));

    // Tooltips (accessible toggle)
    function bindTip(btnId, panelId) {
      const b = document.getElementById(btnId);
      const p = document.getElementById(panelId);
      b.addEventListener('click', () => {
        const open = b.getAttribute('aria-expanded') === 'true';
        b.setAttribute('aria-expanded', String(!open));
        if (open) p.setAttribute('hidden','');
        else p.removeAttribute('hidden');
      });
    }
    bindTip('intTipBtn','intTip');
    bindTip('polyTipBtn','polyTipText');

    // Integer factoring
    const intInput  = document.getElementById('intInput');
    const intError  = document.getElementById('intError');
    const intStepsCk= document.getElementById('intSteps');
    const btnFactorInt = document.getElementById('btnFactorInt');

    // Polynomial factoring
    const polyInput = document.getElementById('polyInput');
    const varSymbol = document.getElementById('varSymbol');
    const domainSel = document.getElementById('domain');
    const polyError = document.getElementById('polyError');
    const polyStepsCk= document.getElementById('polySteps');
    const btnFactorPoly = document.getElementById('btnFactorPoly');

    // Results
    const factoredOut = document.getElementById('factoredOut');
    const canonicalOut= document.getElementById('canonicalOut');
    const statusOut   = document.getElementById('statusOut');
    const stepsDetails= document.getElementById('stepsDetails');
    const stepsContainer = document.getElementById('stepsContainer');

    function setFactored(s){ factoredOut.textContent = s; }
    function setCanonical(s){ canonicalOut.textContent = s; }
    function setStatus(s){ statusOut.textContent = s; }
    function showSteps(html){ stepsContainer.innerHTML = html; }

    // Validation (on-blur)
    intInput.addEventListener('blur', () => {
      const raw = intInput.value.trim().replace(/\s+/g,'');
      if (!raw) {
        intError.textContent = 'Please enter an integer (e.g., 360).';
      } else if (!/^-?\d+$/.test(raw)) {
        intError.textContent = 'Only digits and an optional leading minus sign are allowed.';
      } else {
        intError.textContent = '';
      }
    });

    polyInput.addEventListener('blur', () => {
      const raw = polyInput.value.trim();
      if (!raw) {
        polyError.textContent = 'Please enter a univariate polynomial (e.g., 2x^3-5x^2+4x-2).';
      } else if (!/[a-zA-Z]/.test(raw)) {
        polyError.textContent = 'Include a variable symbol (e.g., x).';
      } else {
        polyError.textContent = '';
      }
    });

    // Integer prime factorization (trial division with small optimizations)
    function primeFactors(n) {
      const steps = [];
      const res = [];
      let m = Math.abs(n);
      if (m === 0) { return { factors:[['0',1]], steps:["0 has infinitely many divisors; prime factorization is undefined."], ok:false }; }
      if (m === 1) { return { factors:[['1',1]], steps:["1 is the multiplicative identity; no prime factors."], ok:true }; }
      // Factor 2
      let count = 0;
      while (m % 2 === 0) { m /= 2; count++; }
      if (count) { res.push([2, count]); steps.push(`Divide by 2 repeatedly → exponent ${count}.`); }
      // Factor odd primes
      let p = 3;
      while (p*p <= m) {
        if (m % p === 0) {
          let c = 0;
          while (m % p === 0) { m /= p; c++; }
          res.push([p,c]);
          steps.push(`Divide by ${p} repeatedly → exponent ${c}.`);
        }
        p += 2;
      }
      if (m > 1) { res.push([m,1]); steps.push(`Remaining prime factor: ${m}.`); }
      if (n < 0) { steps.unshift('Extract -1 factor for negative input.'); }
      return { factors: res, steps, ok:true };
    }

    function formatPrimeProduct(n, arr) {
      const sign = (n < 0) ? '-1 × ' : '';
      const body = arr.map(([p,e]) => e === 1 ? String(p) : `${p}^${e}`).join(' · ');
      return `${sign}${body || '1'}`;
    }

    // Polynomial parsing to coefficient array (descending) for a given symbol
    function parsePolynomial(input, sym) {
      // Normalize: remove spaces, insert + for leading -, unify coefficients like -x -> -1x
      let s = input.replace(/\s+/g,'').toLowerCase();
      // Enforce variable symbol
      const v = sym.toLowerCase();
      // Replace implicit 1 coefficients: (^ or term starts) like +x -> +1x, -x -> -1x
      s = s.replace(new RegExp(`([+\\-])${v}(?![a-zA-Z0-9_])`, 'g'), `$11${v}`);
      s = s.replace(new RegExp(`^${v}(?![a-zA-Z0-9_])`), `1${v}`);
      // Normalize exponents: x -> x^1
      s = s.replace(new RegExp(`${v}(?!\\^)`, 'g'), `${v}^1`);
      // Insert + before a leading minus
      if (s[0] !== '-' && s[0] !== '+') s = '+' + s;

      // Tokenize terms like +2x^3, -5x^2, +4x^1, -2
      const termRe = new RegExp(`([+\\-])(\\d+)?(?:${v}\\^(\\d+))?`, 'g');
      let m, maxDeg = 0;
      const map = new Map(); // degree -> coeff (integer)
      while ((m = termRe.exec(s)) !== null) {
        const sign = m[1] === '-' ? -1 : 1;
        const coeff = m[2] ? parseInt(m[2],10) : (m[3] ? 1 : 0); // if variable present but no coeff → 1
        const hasVar = !!m[3];
        let deg = hasVar ? parseInt(m[3],10) : 0;
        if (!hasVar && coeff === 0) continue; // skip empty
        const c = sign * coeff;
        map.set(deg, (map.get(deg) || 0) + c);
        if (deg > maxDeg) maxDeg = deg;
      }
      // Build array
      const coeffs = [];
      for (let d = maxDeg; d >= 0; d--) coeffs.push(map.get(d) || 0);
      // Remove leading zeros
      while (coeffs.length > 1 && coeffs[0] === 0) coeffs.shift();
      const deg = coeffs.length - 1;
      return { coeffs, deg };
    }

    // Helpers: gcd, lcm for integers
    const igcd = (a,b) => { a=Math.abs(a); b=Math.abs(b); while (b){const t=b;b=a%b;b=t;} return a||0; };
    const igcdMany = (arr) => arr.reduce((g,x)=>igcd(g,x),0);
    const sign = (x) => (x<0?-1:1);

    // Evaluate polynomial at rational r = p/q
    function evalAtRational(coeffs, r) {
      // coeffs in descending order
      const val = coeffs.reduce((acc, c) => acc * r + c, 0);
      return val;
    }
    function evalAtInteger(coeffs, r) {
      let acc = 0;
      for (let i=0;i<coeffs.length;i++) acc = acc*r + coeffs[i];
      return acc;
    }

    // Synthetic division by (x - r) for integer r
    function synthDivInt(coeffs, r) {
      const out = [];
      let acc = 0;
      for (let i=0;i<coeffs.length;i++) {
        out.push(coeffs[i] + acc);
        acc = (coeffs[i] + acc) * r;
      }
      const remainder = out.pop();
      return { quotient: out, remainder };
    }

    // Synthetic division by (x - p/q), we convert to integer-coefficient division via change of variable if needed.
    // For simplicity and numerical stability in browser, we try integer roots first (q=1).
    // If rational root with q>1 is required, we scale: substitute x = y/q, factor out q^deg.
    function tryRationalRoots(coeffs) {
      const a0 = coeffs[coeffs.length-1];
      const an = coeffs[0];
      const factors = (n) => {
        n=Math.abs(n);
        if (n===0) return [0];
        const list = [];
        for (let i=1;i*i<=n;i++){
          if (n % i === 0) {
            list.push(i);
            if (i*i !== n) list.push(n/i);
          }
        }
        return list.sort((x,y)=>x-y);
      };
      const ps = factors(a0);
      const qs = factors(an);
      const cands = [];
      ps.forEach(p => {
        qs.forEach(q => {
          const r1 =  p/q, r2 = -p/q;
          cands.push(r1, r2);
        });
      });
      // Deduplicate
      const seen = new Set();
      const uniq = [];
      cands.forEach(r => { const k = r.toFixed(12); if (!seen.has(k)) { seen.add(k); uniq.push(r); } });
      return uniq;
    }

    function prettyPoly(coeffs, sym='x') {
      // descending order
      let out = '';
      coeffs.forEach((c, i) => {
        const deg = coeffs.length - 1 - i;
        if (c === 0) return;
        const signStr = (out===''? (c<0?'-':'') : (c<0?' - ':' + '));
        const abs = Math.abs(c);
        if (deg === 0) out += `${signStr}${abs}`;
        else if (deg === 1) out += `${signStr}${abs===1?'':abs}${sym}`;
        else out += `${signStr}${abs===1?'':abs}${sym}^${deg}`;
      });
      return out || '0';
    }

    function normalizeContent(coeffs) {
      // Factor out integer GCF and make leading coefficient positive (content * primitive part)
      const g = igcdMany(coeffs);
      const content = g === 0 ? 0 : g * sign(coeffs[0] || 1);
      const prim = content === 0 ? coeffs.slice() : coeffs.map(c=>c/content);
      return { content, prim };
    }

    function factorPolynomialOverQ(input, sym='x', wantSteps=false) {
      const steps = [];
      // Parse
      const {coeffs} = parsePolynomial(input, sym);
      if (coeffs.length === 0) return { ok:false, message:'Failed to parse polynomial.' };
      steps.push(`Parsed polynomial (descending): \\( ${esc(prettyPoly(coeffs, sym))} \\)`);

      // Content & primitive part
      const {content, prim} = normalizeContent(coeffs);
      if (content && Math.abs(content)!==1) {
        steps.push(`Extract integer content \\( ${content} \\). Primitive part: \\( ${esc(prettyPoly(prim, sym))} \\).`);
      } else {
        steps.push(`Polynomial is already primitive (content ±1).`);
      }

      // Try to peel off linear factors with integer roots first
      let work = prim.slice();
      const linearFactors = [];
      // Integer roots candidates from RRT with q=1
      const a0 = work[work.length-1], an = work[0];
      const smallFactors = (() => {
        const F = (n)=>{n=Math.abs(n);const arr=[];for(let i=1;i*i<=n;i++){if(n%i===0){arr.push(i); if(i*i!==n)arr.push(n/i);}}return arr.sort((x,y)=>x-y);};
        const ps = F(a0), qs = F(an);
        const ints = new Set();
        ps.forEach(p => { qs.forEach(q => {
          if (q===0) return;
          if (p % q === 0) { ints.add(p/q); ints.add(-p/q); }
        });});
        return Array.from(ints).filter(Number.isInteger);
      })();

      // Try integer roots iteratively
      let found;
      do {
        found = false;
        for (const r of smallFactors) {
          const { quotient, remainder } = synthDivInt(work, r);
          if (remainder === 0) {
            linearFactors.push([1, -r]); // (x - r)
            steps.push(`Root found: \\( ${sym}=${r} \\) by testing RRT candidates. Factor \\( (${sym}-${r}) \\) extracted via synthetic division.`);
            work = quotient;
            found = true;
            break;
          }
        }
      } while (found && work.length>1);

      // If degree >=2 remains, consider rational r=p/q (q>1) quickly by testing a few candidates
      if (work.length>1) {
        const cands = tryRationalRoots(work).filter(r => !Number.isInteger(r));
        for (const r of cands) {
          // evaluate approximately; require near-zero
          const val = evalAtInteger(work.map(c=>c), r); // slight abuse; acceptable for small degrees
          if (Math.abs(val) < 1e-9) {
            // For a rational r = p/q, we still display factor (x - r) and stop descent to avoid floating error propagation
            linearFactors.push([1, -r]);
            steps.push(`Rational root detected: \\( ${sym}=${r} \\). Factor \\( (${sym}-${r}) \\) acknowledged.`);
            // We will not divide to avoid numeric drift; break.
            break;
          }
        }
      }

      // Build remaining factor (work) and try quadratic factoring if deg==2
      let remaining = work.slice();
      if (remaining.length === 3) {
        const [a,b,c] = remaining;
        const D = b*b - 4*a*c;
        steps.push(`Quadratic remainder: \\( ${esc(prettyPoly(remaining,sym))} \\) with discriminant \\( \\Delta = ${D} \\).`);
        if (D >= 0) {
          const sqrtD = Math.sqrt(D);
          if (Number.isInteger(sqrtD)) {
            const r1 = (-b - sqrtD)/(2*a);
            const r2 = (-b + sqrtD)/(2*a);
            steps.push(`\\( \\Delta \\) is a perfect square. Roots: \\( ${r1},\\ ${r2} \\).`);
            linearFactors.push([1, -r1], [1, -r2]);
            remaining = []; // fully split
          } else {
            steps.push(`\\( \\Delta \\) not a perfect square ⇒ irreducible over \\(\\mathbb{Q}\\).`);
          }
        } else {
          steps.push(`\\( \\Delta < 0 \\) ⇒ irreducible over \\(\\mathbb{Q}\\).`);
        }
      }

      // Assemble factorization string
      const parts = [];
      if (content && content!==1) parts.push(String(content));
      linearFactors.forEach(([a,b]) => {
        // (a*x + b) with a=1 → (x - r)
        if (a===1 && Number.isFinite(-b)) parts.push(`(${sym}${b<0?'+': '-'}${Math.abs(b)})`);
        else parts.push(`(${a}${sym}${b<0?'-': '+'}${Math.abs(b)})`);
      });
      if (remaining.length>0) parts.push(`(${esc(prettyPoly(remaining,sym))})`);

      const factoredText = parts.join(' · ').replace(/\s+/g,' ');
      const canonicalText = esc(prettyPoly(coeffs, sym));

      const stepsHtml = wantSteps
        ? `<ol class="list-decimal ml-6">${steps.map(s=>`<li class="mb-1">\\(${s.includes('\\(')?s:s}\\)</li>`).join('')}</ol>`
        : '';

      const reducible = parts.length>1 || linearFactors.length>0;
      return {
        ok:true,
        factored: factoredText || canonicalText,
        canonical: canonicalText,
        stepsHtml,
        reducible
      };
    }

    // Actions
    btnFactorInt.addEventListener('click', () => {
      const raw = intInput.value.trim().replace(/\s+/g,'');
      if (!raw || !/^-?\d+$/.test(raw)) {
        intError.textContent = 'Please enter a valid integer (digits only, optional leading minus).';
        intInput.focus();
        return;
      }
      intError.textContent = '';
      const n = BigInt(raw); // manage sign safely for large inputs
      const nNum = Number(n); // fallback to number for factoring (JS BigInt sqrt is manual); we scope to 1e12 typical
      if (!Number.isFinite(nNum) || Math.abs(nNum) > 1e13) {
        setStatus('Number is large; factoring may be slow in-browser.');
      } else {
        setStatus('Factoring…');
      }
      const { factors, steps, ok } = primeFactors(nNum);
      if (!ok) {
        setFactored('Undefined');
        setCanonical(String(n));
        showSteps(`<p>${steps.join(' ')}</p>`);
        stepsDetails.open = true;
        return;
      }
      const factored = formatPrimeProduct(nNum, factors);
      setFactored(factored);
      setCanonical(String(n));
      setStatus('Done');
      if (intStepsCk.checked) {
        const html = `<ol class="list-decimal ml-6">${steps.map(s=>`<li class="mb-1">${esc(s)}</li>`).join('')}</ol>`;
        showSteps(html);
        stepsDetails.open = true;
      } else {
        showSteps('');
        stepsDetails.open = false;
      }
      if (window.MathJax) MathJax.typesetPromise?.();
    });

    btnFactorPoly.addEventListener('click', () => {
      const raw = polyInput.value.trim();
      if (!raw) {
        polyError.textContent = 'Please enter a polynomial.';
        polyInput.focus();
        return;
      }
      polyError.textContent = '';
      const sym = (varSymbol.value || 'x').replace(/[^a-zA-Z]/g,'') || 'x';
      setStatus('Factoring over ℚ…');
      const out = factorPolynomialOverQ(raw, sym, polyStepsCk.checked);
      if (!out.ok) {
        setFactored('Could not parse/factor.');
        setCanonical(esc(raw));
        setStatus('Error');
        showSteps('');
        stepsDetails.open = false;
      } else {
        setFactored(out.factored);
        setCanonical(out.canonical);
        setStatus(out.reducible ? 'Reduced' : 'Irreducible over ℚ');
        if (polyStepsCk.checked) {
          showSteps(out.stepsHtml);
          stepsDetails.open = true;
        } else {
          showSteps('');
          stepsDetails.open = false;
        }
        if (window.MathJax) MathJax.typesetPromise?.();
      }
    });

    // Initialize default tab
    switchTab('int');
  })();
  </script>
</body>
</html>

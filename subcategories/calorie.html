<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calorie Calculator (TDEE, BMR, Macros) — Accurate, Accessible, Fast</title>
  <meta name="description" content="Professional calorie calculator that estimates BMR and TDEE using Mifflin–St Jeor or Katch–McArdle, suggests goal calories, and computes daily macros. WCAG 2.1 AA, mobile-first, and fast." />
  <link rel="canonical" href="https://calcdomain.com/calorie.html"/>

  <!-- Icons / Manifest -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Fonts & CSS (mobile-first, minimal CLS) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="preload" as="style" onload="this.rel='stylesheet'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"></noscript>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root { --brand:#1d4ed8; --accent:#059669; --error:#b91c1c; }
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol", sans-serif; }
    .prose { max-width: 68ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: .75rem; }
    .prose h3 { font-size: 1.125rem; font-weight: 700; margin-top: 1.25rem; margin-bottom: .5rem; }
    .formula-box { background:#f3f4f6; border:1px solid #e5e7eb; border-radius: .75rem; padding:1rem; overflow-x:auto; }
    /* Focus styles (WCAG 2.1 AA) */
    :focus-visible { outline: 3px solid var(--brand); outline-offset: 2px; border-radius: .375rem; }
    /* Minimum touch targets */
    .touch-target { min-height: 48px; min-width: 48px; }
    /* Prevent CLS in results area */
    #results-shell { min-height: 18rem; }
    /* Table */
    th, td { border-bottom: 1px solid #e5e7eb; }
    /* Tooltip popover */
    .tip { display:none; }
    .tip[aria-hidden="false"] { display:block; }
    @media print {
      header, aside, .no-print { display: none !important; }
      main { padding:0 !important; }
      #results-shell { min-height: auto; }
    }
  </style>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Calorie Calculator (TDEE, BMR, Macros)",
    "description":"Estimate BMR and TDEE with Mifflin–St Jeor or Katch–McArdle, set goal calories, and compute daily macros.",
    "url":"https://calcdomain.com/calorie.html",
    "inLanguage":"en",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"},
    "about":[{"@type":"Thing","name":"Health & Fitness"},{"@type":"Thing","name":"Diet & Nutrition"}]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Health & Fitness","item":"https://calcdomain.com/health-fitness.html"},
      {"@type":"ListItem","position":3,"name":"Diet & Nutrition","item":"https://calcdomain.com/subcategories/health-fitness-diet-nutrition.html"},
      {"@type":"ListItem","position":4,"name":"Calorie Calculator","item":"https://calcdomain.com/calorie.html"}
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to calculate your daily calorie needs",
    "description":"A step-by-step guide to compute BMR, TDEE, goal calories, and macros.",
    "step":[
      {"@type":"HowToStep","name":"Enter personal data","text":"Provide sex, age, height, and weight (metric or imperial)."},
      {"@type":"HowToStep","name":"Choose formula","text":"Select Mifflin–St Jeor or Katch–McArdle (requires body fat %)."},
      {"@type":"HowToStep","name":"Select activity level","text":"Pick your typical activity factor (PAL)."},
      {"@type":"HowToStep","name":"Set your goal","text":"Pick maintain/lose/gain and target rate per week."},
      {"@type":"HowToStep","name":"Review results","text":"See BMR, TDEE, goal calories, and macro grams per day."}
    ]
  }
  </script>
  <script type="application/ld+json" id="faq-json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"Which formula should I use?","acceptedAnswer":{"@type":"Answer","text":"Mifflin–St Jeor is the default for most people. If you know a reliable body-fat %, Katch–McArdle can be more individualised."}},
      {"@type":"Question","name":"How accurate are calorie calculators?","acceptedAnswer":{"@type":"Answer","text":"They provide estimates. Day-to-day energy needs vary. Track weight and adjust by ~100–200 kcal if progress stalls or is too fast."}},
      {"@type":"Question","name":"What activity level should I pick?","acceptedAnswer":{"@type":"Answer","text":"Choose the level that reflects your average week, not a single intense day. If unsure, start lower and adjust based on real outcomes."}},
      {"@type":"Question","name":"How fast should I lose or gain weight?","acceptedAnswer":{"@type":"Answer","text":"Common guidance: fat loss 0.25–1.0% body weight per week; lean gains 0.25–0.5% per week. Prioritise health and sustainability."}},
      {"@type":"Question","name":"Do I need to hit macro targets exactly?","acceptedAnswer":{"@type":"Answer","text":"No—use them as ranges. Consistency over time matters more than perfection."}},
      {"@type":"Question","name":"Are the calorie multipliers the same for everyone?","acceptedAnswer":{"@type":"Answer","text":"They’re population averages. Individual differences (NEAT, genetics, body composition) can shift needs by several hundred kcal."}},
      {"@type":"Question","name":"Is 7,700 kcal per kg always valid?","acceptedAnswer":{"@type":"Answer","text":"7,700 kcal/kg is a common approximation for adipose tissue energy. Actual changes vary with water/glycogen shifts and body composition."}}
    ]
  }
  </script>

  <!-- MathJax (LaTeX) & Chart.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-bold text-blue-700">CalcDomain</a>
      <div class="hidden md:flex gap-6 text-sm">
        <a class="hover:text-blue-700" href="search.html">Search</a>
        <a class="hover:text-blue-700" href="index.html#categories">Categories</a>
      </div>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <!-- 1. H1 -->
    <h1 class="text-3xl font-extrabold mb-3">calorie</h1>

    <!-- 2. Intro -->
    <p class="text-gray-700 mb-6 max-w-prose">
      This professional-grade calorie calculator estimates your <strong>BMR</strong> and <strong>TDEE</strong>, then computes
      <strong>goal calories</strong> and <strong>macronutrients</strong>. It’s built for health professionals, coaches, and power users who need accuracy, accessibility, and speed.
    </p>

    <div class="flex flex-col lg:flex-row gap-8">
      <section class="w-full lg:w-2/3">
        <!-- 3. Calculator -->
        <section aria-labelledby="calc-title" class="bg-white p-6 rounded-lg shadow-sm">
          <h2 id="calc-title" class="text-2xl font-bold mb-2">Calorie Calculator</h2>
          <p class="text-sm text-gray-600 mb-4">All required fields are marked with <span aria-hidden="true" class="text-red-700 font-bold">*</span>.</p>

          <!-- Unit toggle -->
          <fieldset class="mb-4">
            <legend class="font-semibold text-gray-800 mb-2">Units</legend>
            <div class="flex gap-4">
              <label class="inline-flex items-center gap-2">
                <input class="touch-target" type="radio" name="units" id="unitsMetric" value="metric" checked />
                <span>Metric (kg, cm)</span>
              </label>
              <label class="inline-flex items-center gap-2">
                <input class="touch-target" type="radio" name="units" id="unitsImperial" value="imperial" />
                <span>Imperial (lb, ft/in)</span>
              </label>
            </div>
          </fieldset>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
            <!-- Sex -->
            <div>
              <label for="sex" class="block text-sm font-medium text-gray-800">Sex <span class="text-red-700 font-bold" aria-hidden="true">*</span></label>
              <div class="flex items-center gap-2">
                <select id="sex" aria-required="true" class="mt-1 w-full border rounded-md px-3 py-2" aria-describedby="sex-help sex-err">
                  <option value="">Select…</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                </select>
                <button class="touch-target text-blue-700" type="button" aria-expanded="false" aria-controls="sex-help">?</button>
              </div>
              <p id="sex-help" class="tip text-xs text-gray-600 mt-1" aria-hidden="true">Used in Mifflin–St Jeor to adjust BMR constant.</p>
              <p id="sex-err" class="text-sm text-red-700 mt-1 hidden" role="alert"></p>
            </div>

            <!-- Age -->
            <div>
              <label for="age" class="block text-sm font-medium text-gray-800">Age (years) <span class="text-red-700 font-bold" aria-hidden="true">*</span></label>
              <input id="age" type="number" inputmode="numeric" min="5" max="100" step="1" aria-required="true" aria-describedby="age-help age-err" class="mt-1 w-full border rounded-md px-3 py-2" />
              <div class="flex items-center gap-2 mt-1">
                <button class="touch-target text-blue-700" type="button" aria-expanded="false" aria-controls="age-help">?</button>
                <p id="age-help" class="tip text-xs text-gray-600" aria-hidden="true">Typical valid range 5–100 years.</p>
              </div>
              <p id="age-err" class="text-sm text-red-700 mt-1 hidden" role="alert"></p>
            </div>

            <!-- Height -->
            <div id="height-metric">
              <label for="heightCm" class="block text-sm font-medium text-gray-800">Height (cm) <span class="text-red-700 font-bold" aria-hidden="true">*</span></label>
              <input id="heightCm" type="number" inputmode="decimal" min="80" max="250" step="0.1" aria-required="true" aria-describedby="h-help h-err" class="mt-1 w-full border rounded-md px-3 py-2" />
              <div class="flex items-center gap-2 mt-1">
                <button class="touch-target text-blue-700" type="button" aria-expanded="false" aria-controls="h-help">?</button>
                <p id="h-help" class="tip text-xs text-gray-600" aria-hidden="true">Enter height in centimeters (e.g., 175.0).</p>
              </div>
              <p id="h-err" class="text-sm text-red-700 mt-1 hidden" role="alert"></p>
            </div>
            <div id="height-imperial" class="hidden">
              <label class="block text-sm font-medium text-gray-800">Height (ft/in) <span class="text-red-700 font-bold" aria-hidden="true">*</span></label>
              <div class="flex gap-2">
                <input id="heightFt" type="number" inputmode="numeric" min="2" max="8" step="1" aria-describedby="hi-err" class="mt-1 w-1/2 border rounded-md px-3 py-2" placeholder="ft" />
                <input id="heightIn" type="number" inputmode="numeric" min="0" max="11" step="1" aria-describedby="hi-err" class="mt-1 w-1/2 border rounded-md px-3 py-2" placeholder="in" />
              </div>
              <p id="hi-err" class="text-sm text-red-700 mt-1 hidden" role="alert"></p>
            </div>

            <!-- Weight -->
            <div id="weight-metric">
              <label for="weightKg" class="block text-sm font-medium text-gray-800">Weight (kg) <span class="text-red-700 font-bold" aria-hidden="true">*</span></label>
              <input id="weightKg" type="number" inputmode="decimal" min="25" max="350" step="0.1" aria-required="true" aria-describedby="w-help w-err" class="mt-1 w-full border rounded-md px-3 py-2" />
              <div class="flex items-center gap-2 mt-1">
                <button class="touch-target text-blue-700" type="button" aria-expanded="false" aria-controls="w-help">?</button>
                <p id="w-help" class="tip text-xs text-gray-600" aria-hidden="true">Enter body weight in kilograms.</p>
              </div>
              <p id="w-err" class="text-sm text-red-700 mt-1 hidden" role="alert"></p>
            </div>
            <div id="weight-imperial" class="hidden">
              <label for="weightLb" class="block text-sm font-medium text-gray-800">Weight (lb) <span class="text-red-700 font-bold" aria-hidden="true">*</span></label>
              <input id="weightLb" type="number" inputmode="decimal" min="55" max="770" step="0.1" aria-required="true" aria-describedby="wi-err" class="mt-1 w-full border rounded-md px-3 py-2" />
              <p id="wi-err" class="text-sm text-red-700 mt-1 hidden" role="alert"></p>
            </div>

            <!-- Body Fat % (optional) -->
            <div>
              <label for="bodyFat" class="block text-sm font-medium text-gray-800">Body Fat % (optional)</label>
              <input id="bodyFat" type="number" inputmode="decimal" min="3" max="70" step="0.1" aria-describedby="bf-help" class="mt-1 w-full border rounded-md px-3 py-2" />
              <div class="flex items-center gap-2 mt-1">
                <button class="touch-target text-blue-700" type="button" aria-expanded="false" aria-controls="bf-help">?</button>
                <p id="bf-help" class="tip text-xs text-gray-600" aria-hidden="true">Enables Katch–McArdle (uses lean mass). Leave blank to use Mifflin–St Jeor.</p>
              </div>
            </div>

            <!-- Formula -->
            <div>
              <label for="formula" class="block text-sm font-medium text-gray-800">Formula</label>
              <select id="formula" class="mt-1 w-full border rounded-md px-3 py-2" aria-describedby="f-help">
                <option value="auto" selected>Auto (Katch if body-fat given, else Mifflin)</option>
                <option value="mifflin">Mifflin–St Jeor</option>
                <option value="katch">Katch–McArdle</option>
              </select>
              <p id="f-help" class="text-xs text-gray-600 mt-1">Choose explicitly if you prefer a specific method.</p>
            </div>

            <!-- Activity -->
            <div class="md:col-span-2">
              <label for="activity" class="block text-sm font-medium text-gray-800">Activity level (PAL) <span class="text-red-700 font-bold" aria-hidden="true">*</span></label>
              <select id="activity" aria-required="true" aria-describedby="a-help a-err" class="mt-1 w-full border rounded-md px-3 py-2">
                <option value="">Select…</option>
                <option value="1.2">Sedentary (PAL 1.2)</option>
                <option value="1.375">Lightly active (PAL 1.375)</option>
                <option value="1.55">Moderately active (PAL 1.55)</option>
                <option value="1.725">Very active (PAL 1.725)</option>
                <option value="1.9">Extra active (PAL 1.9)</option>
              </select>
              <div class="flex items-center gap-2 mt-1">
                <button class="touch-target text-blue-700" type="button" aria-expanded="false" aria-controls="a-help">?</button>
                <p id="a-help" class="tip text-xs text-gray-600" aria-hidden="true">Physical Activity Level multipliers approximate daily energy expenditure.</p>
              </div>
              <p id="a-err" class="text-sm text-red-700 mt-1 hidden" role="alert"></p>
            </div>

            <!-- Goal -->
            <div>
              <label for="goal" class="block text-sm font-medium text-gray-800">Goal</label>
              <select id="goal" class="mt-1 w-full border rounded-md px-3 py-2">
                <option value="maintain">Maintain</option>
                <option value="lose">Lose weight</option>
                <option value="gain">Gain weight</option>
              </select>
            </div>
            <div>
              <label for="rate" class="block text-sm font-medium text-gray-800">Target rate (kg/week)</label>
              <input id="rate" type="number" inputmode="decimal" step="0.1" min="0" max="2" class="mt-1 w-full border rounded-md px-3 py-2" aria-describedby="r-help" />
              <p id="r-help" class="text-xs text-gray-600 mt-1">Used to estimate daily deficit/surplus (≈ 7,700 kcal/kg).</p>
            </div>

            <!-- Macros -->
            <div>
              <label for="proteinPerKg" class="block text-sm font-medium text-gray-800">Protein (g/kg)</label>
              <input id="proteinPerKg" type="number" inputmode="decimal" step="0.1" min="0.6" max="3.5" value="1.6" class="mt-1 w-full border rounded-md px-3 py-2" aria-describedby="p-help" />
              <p id="p-help" class="text-xs text-gray-600 mt-1">Common ranges 1.2–2.2 g/kg depending on goals.</p>
            </div>
            <div>
              <label for="fatPct" class="block text-sm font-medium text-gray-800">Fat (% of calories)</label>
              <input id="fatPct" type="number" inputmode="decimal" step="1" min="15" max="40" value="30" class="mt-1 w-full border rounded-md px-3 py-2" aria-describedby="fat-help" />
              <p id="fat-help" class="text-xs text-gray-600 mt-1">Remaining calories go to carbs after protein & fat.</p>
            </div>
          </div>

          <div class="mt-6 flex flex-wrap gap-3">
            <button id="calcBtn" class="touch-target px-5 py-3 bg-blue-700 text-white rounded-md font-semibold hover:bg-blue-800">Calculate</button>
            <button id="resetBtn" class="touch-target px-5 py-3 bg-gray-100 text-gray-900 rounded-md font-semibold hover:bg-gray-200" type="button">Reset</button>
          </div>
        </section>

        <!-- 4. Results -->
        <section aria-labelledby="results-title" class="mt-6 bg-white p-6 rounded-lg shadow-sm">
          <h2 id="results-title" class="text-2xl font-bold mb-2">Results</h2>
          <div id="results-shell" class="grid grid-cols-1 lg:grid-cols-3 gap-4">
            <div class="border rounded-lg p-4 text-center">
              <h3 class="text-sm text-gray-600">BMR</h3>
              <p id="bmrOut" class="text-2xl font-extrabold text-blue-700 mt-1">—</p>
              <p class="text-xs text-gray-600" id="bmrMethod">—</p>
            </div>
            <div class="border rounded-lg p-4 text-center">
              <h3 class="text-sm text-gray-600">TDEE</h3>
              <p id="tdeeOut" class="text-2xl font-extrabold text-blue-700 mt-1">—</p>
              <p class="text-xs text-gray-600">kcal/day</p>
            </div>
            <div class="border rounded-lg p-4 text-center">
              <h3 class="text-sm text-gray-600">Goal calories</h3>
              <p id="goalCalOut" class="text-2xl font-extrabold text-blue-700 mt-1">—</p>
              <p class="text-xs text-gray-600" id="goalNote">—</p>
            </div>
          </div>

          <div class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="border rounded-lg p-4">
              <h3 class="font-semibold mb-2">Daily macros</h3>
              <dl class="grid grid-cols-2 gap-y-2 text-sm">
                <dt>Protein</dt><dd id="proteinOut" class="font-semibold text-gray-900">—</dd>
                <dt>Fat</dt><dd id="fatOut" class="font-semibold text-gray-900">—</dd>
                <dt>Carbs</dt><dd id="carbOut" class="font-semibold text-gray-900">—</dd>
                <dt>Fiber (guide)</dt><dd id="fiberOut" class="font-semibold text-gray-900">—</dd>
              </dl>
            </div>
            <div class="border rounded-lg p-4">
              <h3 class="font-semibold mb-2">Macro breakdown</h3>
              <div class="h-56"><canvas id="macroChart" aria-label="Macronutrient calories chart"></canvas></div>
            </div>
          </div>
        </section>

        <!-- 5. Authoritative Content -->
        <section class="mt-8 bg-white p-6 rounded-lg shadow-sm prose">
          <h2>Data source &amp; methodology</h2>
          <ul>
            <li><strong>Basal Metabolic Rate</strong>: Mifflin MD, St Jeor ST et&nbsp;al. (1990), “A new predictive equation for resting energy expenditure in healthy individuals.” <em>Am J Clin Nutr</em> 51(2):241-247.</li>
            <li><strong>Lean-mass BMR</strong>: Katch VL, McArdle WD (1996), “Nutrition, Weight Control, and Exercise.” 6th ed. (Katch–McArdle formula).</li>
            <li><strong>Activity factors (PAL)</strong>: Derived from widely used Physical Activity Level categories as summarized in IOM/WHO guidance.</li>
          </ul>
          <p><em>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</em></p>

          <h2>The formula explained</h2>
          <div class="formula-box">
\[
\textbf{Mifflin–St Jeor:}\quad
\mathrm{BMR}_{\text{male}} = 10W + 6.25H - 5A + 5,\qquad
\mathrm{BMR}_{\text{female}} = 10W + 6.25H - 5A - 161
\]
\[
\textbf{Katch–McArdle:}\quad
\mathrm{BMR} = 370 + 21.6 \times LBM,\quad
LBM = W \times (1 - \frac{\%BF}{100})
\]
\[
\textbf{Total Daily Energy Expenditure:}\quad
\mathrm{TDEE} = \mathrm{BMR} \times \mathrm{PAL}
\]
\[
\textbf{Goal Calories:}\quad
\mathrm{kcal}_{\text{goal}} \approx \mathrm{TDEE} + \frac{7700 \times \Delta \mathrm{kg/week}}{7}
\]
          </div>

          <h2>Glossary of variables</h2>
          <table>
            <thead><tr><th>Symbol</th><th>Meaning</th><th>Units</th></tr></thead>
            <tbody>
              <tr><td><strong>W</strong></td><td>Body weight</td><td>kg</td></tr>
              <tr><td><strong>H</strong></td><td>Height</td><td>cm</td></tr>
              <tr><td><strong>A</strong></td><td>Age</td><td>years</td></tr>
              <tr><td><strong>%BF</strong></td><td>Body fat percentage</td><td>%</td></tr>
              <tr><td><strong>LBM</strong></td><td>Lean body mass</td><td>kg</td></tr>
              <tr><td><strong>PAL</strong></td><td>Activity multiplier</td><td>dimensionless</td></tr>
            </tbody>
          </table>

          <h2>How it works: a step-by-step example</h2>
          <p><strong>Inputs:</strong> Sex = female; Age = 32; Height = 168&nbsp;cm; Weight = 62&nbsp;kg; Body fat blank (use Mifflin); Activity = 1.55; Goal = lose 0.3&nbsp;kg/week; Protein = 1.6&nbsp;g/kg; Fat = 30%.</p>
          <ol>
            <li>Mifflin BMR = 10×62 + 6.25×168 − 5×32 − 161 = 620 + 1050 − 160 − 161 = <strong>1,349&nbsp;kcal</strong>.</li>
            <li>TDEE = 1,349 × 1.55 = <strong>2,091&nbsp;kcal</strong>.</li>
            <li>Daily adjustment ≈ 7,700×0.3/7 ≈ <strong>330&nbsp;kcal</strong> deficit → Goal calories ≈ <strong>1,761&nbsp;kcal</strong>.</li>
            <li>Protein = 1.6×62 = 99&nbsp;g → 396&nbsp;kcal. Fat = 30% of 1,761 = 528&nbsp;kcal → 59&nbsp;g. Carbs = remaining ≈ 1,761 − (396+528) = 837&nbsp;kcal → 209&nbsp;g.</li>
          </ol>

          <h2>Frequently asked questions</h2>
          <details>
            <summary>Which formula should I choose?</summary>
            <p>Mifflin–St Jeor fits most people well. If you have a reliable body-fat % (e.g., DEXA or consistent calipers), Katch–McArdle personalises BMR via lean mass.</p>
          </details>
          <details>
            <summary>How do I pick my activity level?</summary>
            <p>Choose a PAL that reflects an average week. Start conservative; adjust calories based on actual weight trend over 2–3 weeks.</p>
          </details>
          <details>
            <summary>Is 7,700 kcal per kg exact?</summary>
            <p>It’s an approximation for adipose tissue energy. Real-world weight change also involves water and glycogen shifts.</p>
          </details>
          <details>
            <summary>What macro split is best?</summary>
            <p>Prioritise protein (1.2–2.2 g/kg). Keep fat ≥ 20–25% for hormones and absorption. Allocate remaining calories to carbs based on preference and training.</p>
          </details>
          <details>
            <summary>How often should I recalc?</summary>
            <p>Every 4–8 weeks or when body weight/activity changes meaningfully.</p>
          </details>

          <div class="mt-6 p-4 bg-gray-50 border rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Content verified by CalcDomain Editorial Board.<br>
              Last accuracy review: <time datetime="2025-10-30">October 30, 2025</time></p>
          </div>
        </section>
      </section>

      <aside class="w-full lg:w-1/3">
        <div class="sticky top-6 space-y-6">
          <div class="bg-white p-6 rounded-lg shadow-sm">
            <h3 class="font-bold text-lg mb-3">Why this tool is different</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Dual formulae (Mifflin/Katch) with body-fat support.</li>
              <li>Goal calories from target weekly change.</li>
              <li>Macro grams with a clear, printable summary.</li>
              <li>WCAG 2.1 AA, keyboard-first, screen-reader friendly.</li>
            </ul>
          </div>
          <div class="bg-gray-200 h-64 rounded-md flex items-center justify-center text-gray-600 no-print">
            Ad Placement (300×600)
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-700">About</a>
        <a href="contact.html" class="hover:text-blue-700">Contact</a>
        <a href="privacy.html" class="hover:text-blue-700">Privacy</a>
        <a href="terms.html" class="hover:text-blue-700">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Logic (defer) -->
  <script defer>
  (function(){
    const $ = (id) => document.getElementById(id);
    const els = {
      sex: $('sex'), age: $('age'),
      heightCm: $('heightCm'), heightFt: $('heightFt'), heightIn: $('heightIn'),
      weightKg: $('weightKg'), weightLb: $('weightLb'),
      bodyFat: $('bodyFat'), formula: $('formula'),
      activity: $('activity'), goal: $('goal'), rate: $('rate'),
      proteinPerKg: $('proteinPerKg'), fatPct: $('fatPct'),
      unitsMetric: $('unitsMetric'), unitsImperial: $('unitsImperial'),
      heightMetricWrap: $('height-metric'), heightImperialWrap: $('height-imperial'),
      weightMetricWrap: $('weight-metric'), weightImperialWrap: $('weight-imperial'),
      bmrOut: $('bmrOut'), bmrMethod: $('bmrMethod'),
      tdeeOut: $('tdeeOut'), goalCalOut: $('goalCalOut'), goalNote: $('goalNote'),
      proteinOut: $('proteinOut'), fatOut: $('fatOut'), carbOut: $('carbOut'), fiberOut: $('fiberOut'),
      calcBtn: $('calcBtn'), resetBtn: $('resetBtn')
    };

    // Accessible tooltip toggles
    document.querySelectorAll('button[aria-controls]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('aria-controls');
        const node = $('#'+id);
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!expanded));
        node.setAttribute('aria-hidden', String(expanded));
      });
    });

    // Unit switching
    function setUnits(u){
      if (u==='imperial'){
        els.heightMetricWrap.classList.add('hidden');
        els.weightMetricWrap.classList.add('hidden');
        els.heightImperialWrap.classList.remove('hidden');
        els.weightImperialWrap.classList.remove('hidden');
      } else {
        els.heightImperialWrap.classList.add('hidden');
        els.weightImperialWrap.classList.add('hidden');
        els.heightMetricWrap.classList.remove('hidden');
        els.weightMetricWrap.classList.remove('hidden');
      }
    }
    document.querySelectorAll('input[name="units"]').forEach(r=>{
      r.addEventListener('change', e=> setUnits(e.target.value));
    });

    // Validation (inline on blur)
    function msg(id, text){ const p=$(id); if(!p) return; p.textContent=text||''; p.classList.toggle('hidden', !text); }
    function requireVal(inputId, errId, check){
      const el=$(inputId); const val=el && el.value.trim();
      const ok = check(val);
      msg(errId, ok?'': 'Please provide a valid value.');
      return ok;
    }

    ['sex','age','heightCm','heightFt','heightIn','weightKg','weightLb','activity'].forEach(id=>{
      const el=$(id); if(!el) return;
      el.addEventListener('blur', ()=>{ // simple, specific messages
        if(id==='sex') msg('sex-err', el.value ? '' : 'Select a sex.');
        if(id==='age'){
          const v=Number(el.value);
          msg('age-err', (v>=5 && v<=100) ? '' : 'Enter age between 5 and 100.');
        }
        if(id==='heightCm'){
          const v=Number(el.value);
          msg('h-err', (v>=80 && v<=250) ? '' : 'Enter height between 80 and 250 cm.');
        }
        if(id==='heightFt' || id==='heightIn'){
          const ft=Number(els.heightFt.value||0), inch=Number(els.heightIn.value||0);
          msg('hi-err', (ft>=2 && ft<=8 && inch>=0 && inch<=11) ? '' : 'Enter height 2–8 ft and 0–11 in.');
        }
        if(id==='weightKg'){
          const v=Number(el.value);
          msg('w-err', (v>=25 && v<=350) ? '' : 'Enter weight between 25 and 350 kg.');
        }
        if(id==='weightLb'){
          const v=Number(el.value);
          msg('wi-err', (v>=55 && v<=770) ? '' : 'Enter weight between 55 and 770 lb.');
        }
        if(id==='activity') msg('a-err', el.value ? '' : 'Select an activity level.');
      });
    });

    // Helpers
    const kgFromLb = (lb)=> lb/2.2046226218;
    const cmFromFtIn = (ft,inches)=> ft*30.48 + inches*2.54;
    const clamp = (v,min,max)=> Math.min(max, Math.max(min, v));

    function getInputs(){
      const units = document.querySelector('input[name="units"]:checked')?.value || 'metric';
      const sex = els.sex.value;
      const age = Number(els.age.value);
      let heightCm = units==='metric' ? Number(els.heightCm.value) : cmFromFtIn(Number(els.heightFt.value||0), Number(els.heightIn.value||0));
      let weightKg = units==='metric' ? Number(els.weightKg.value) : kgFromLb(Number(els.weightLb.value||0));
      const bodyFat = els.bodyFat.value ? clamp(Number(els.bodyFat.value),3,70) : null;
      const formula = els.formula.value;
      const activity = Number(els.activity.value);
      const goal = els.goal.value;
      const rate = Number(els.rate.value||0);
      const proteinPerKg = Number(els.proteinPerKg.value||1.6);
      const fatPct = clamp(Number(els.fatPct.value||30),15,40);

      return {units,sex,age,heightCm,weightKg,bodyFat,formula,activity,goal,rate,proteinPerKg,fatPct};
    }

    // BMR
    function bmrMifflin({sex,age,heightCm,weightKg}){
      if(sex==='male') return 10*weightKg + 6.25*heightCm - 5*age + 5;
      if(sex==='female') return 10*weightKg + 6.25*heightCm - 5*age - 161;
      return NaN;
    }
    function bmrKatch({weightKg, bodyFat}){
      if(bodyFat==null) return NaN;
      const lbm = weightKg * (1 - bodyFat/100);
      return 370 + 21.6 * lbm;
    }

    // Macros
    function macros(totalKcal, weightKg, proteinPerKg, fatPct){
      const protG = Math.max(0, proteinPerKg * weightKg);
      const protK = protG * 4;
      const fatK = Math.max(0, totalKcal * (fatPct/100));
      const fatG = fatK / 9;
      const carbK = Math.max(0, totalKcal - protK - fatK);
      const carbG = carbK / 4;
      // Simple fiber guide ~ 14 g per 1000 kcal
      const fiberG = Math.round((totalKcal/1000)*14);
      return {
        protein: {g: Math.round(protG), kcal: Math.round(protK)},
        fat: {g: Math.round(fatG), kcal: Math.round(fatK)},
        carbs: {g: Math.round(carbG), kcal: Math.round(carbK)},
        fiber: {g: fiberG}
      };
    }

    // Chart
    let macroChart;
    function drawChart(pK,fK,cK){
      const ctx = document.getElementById('macroChart');
      if(!ctx) return;
      const data = {
        labels: ['Protein','Fat','Carbs'],
        datasets: [{ data: [pK,fK,cK] }]
      };
      if(macroChart){
        macroChart.data = data; macroChart.update();
      } else {
        macroChart = new Chart(ctx, { type:'doughnut', data, options:{ plugins:{legend:{position:'bottom'}}, responsive:true, maintainAspectRatio:false }});
      }
    }

    function calculate(){
      // Validate minimal requireds
      const ok =
        els.sex.value &&
        Number(els.age.value)>=5 && Number(els.age.value)<=100 &&
        (els.unitsMetric.checked
          ? (Number(els.heightCm.value)>=80 && Number(els.heightCm.value)<=250 && Number(els.weightKg.value)>=25 && Number(els.weightKg.value)<=350)
          : (Number(els.heightFt.value)>=2 && Number(els.heightFt.value)<=8 && Number(els.heightIn.value)>=0 && Number(els.heightIn.value)<=11 && Number(els.weightLb.value)>=55 && Number(els.weightLb.value)<=770)
        ) &&
        els.activity.value;

      if(!ok){ // surface generic messages if any blank
        if(!els.sex.value) msg('sex-err','Select a sex.');
        if(!els.activity.value) msg('a-err','Select an activity level.');
        return;
      }

      const inp = getInputs();

      // Choose BMR method
      let method = 'Mifflin–St Jeor';
      let bmr = bmrMifflin(inp);
      if(inp.formula==='katch' || (inp.formula==='auto' && inp.bodyFat!=null)){
        const b2 = bmrKatch(inp);
        if(!isNaN(b2)){ bmr=b2; method='Katch–McArdle'; }
      }
      if(inp.formula==='mifflin') { method='Mifflin–St Jeor'; bmr=bmrMifflin(inp); }

      const tdee = bmr * inp.activity;

      // Goal adjustment
      let dailyAdj = 0;
      if(inp.goal==='lose' && inp.rate>0) dailyAdj = - (7700 * inp.rate) / 7;
      if(inp.goal==='gain' && inp.rate>0) dailyAdj =   (7700 * inp.rate) / 7;
      let goalCal = Math.max(1000, tdee + dailyAdj);

      // Macros
      const m = macros(goalCal, inp.weightKg, inp.proteinPerKg, inp.fatPct);

      // Output
      const fmt = (n)=> isFinite(n)? Math.round(n).toLocaleString() : '—';
      els.bmrOut.textContent = fmt(bmr);
      els.bmrMethod.textContent = method;
      els.tdeeOut.textContent = fmt(tdee);
      els.goalCalOut.textContent = fmt(goalCal);
      els.goalNote.textContent = (inp.goal==='maintain') ? 'Maintain ≈ TDEE' :
        (dailyAdj<0 ? `Deficit ≈ ${fmt(Math.abs(dailyAdj))} kcal/day` : `Surplus ≈ ${fmt(dailyAdj)} kcal/day`);

      els.proteinOut.textContent = `${m.protein.g} g (${m.protein.kcal} kcal)`;
      els.fatOut.textContent = `${m.fat.g} g (${m.fat.kcal} kcal)`;
      els.carbOut.textContent = `${m.carbs.g} g (${m.carbs.kcal} kcal)`;
      els.fiberOut.textContent = `${m.fiber.g} g`;

      drawChart(m.protein.kcal, m.fat.kcal, m.carbs.kcal);
    }

    // Reset
    function resetAll(){
      document.querySelector('form')?.reset(); // none, but keep for future
      els.sex.value='';
      els.age.value='';
      els.heightCm.value=''; els.heightFt.value=''; els.heightIn.value='';
      els.weightKg.value=''; els.weightLb.value='';
      els.bodyFat.value='';
      els.formula.value='auto';
      els.activity.value='';
      els.goal.value='maintain';
      els.rate.value='';
      els.proteinPerKg.value='1.6';
      els.fatPct.value='30';
      document.querySelectorAll('[id$="-err"]').forEach(n=>{ n.textContent=''; n.classList.add('hidden'); });
      setUnits('metric');
      els.bmrOut.textContent='—'; els.bmrMethod.textContent='—';
      els.tdeeOut.textContent='—'; els.goalCalOut.textContent='—'; els.goalNote.textContent='—';
      els.proteinOut.textContent='—'; els.fatOut.textContent='—'; els.carbOut.textContent='—'; els.fiberOut.textContent='—';
      if(window.macroChart){ window.macroChart.destroy(); window.macroChart=null; }
    }

    els.calcBtn.addEventListener('click', (e)=>{ e.preventDefault(); calculate(); });
    els.resetBtn.addEventListener('click', (e)=>{ e.preventDefault(); resetAll(); });

    // Defaults for good UX demo
    els.sex.value='male';
    els.age.value='30';
    els.heightCm.value='180';
    els.weightKg.value='75';
    els.activity.value='1.55';
    calculate();
  })();
  </script>
</body>
</html>

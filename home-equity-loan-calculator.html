<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home Equity Loan Calculator — Max Borrow, LTV/CLTV, Payment & Schedule</title>
  <meta name="description" content="Compute your available home equity, maximum borrowable amount under an LTV cap, CLTV, and monthly payment for a fixed home equity loan or HELOC (interest-only). Includes schedule, formulas, methodology, and FAQs." />
  <link rel="canonical" href="https://calcdomain.com/home-equity-loan-calculator.html" />

  <!-- Favicons / PWA (optional paths shown) -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Fonts & CSS-in-HTML (mobile-first, minimal) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --focus: #2563eb; }
    body{ font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
    .prose { max-width: 70ch; }
    .prose h2{font-size:1.375rem;font-weight:700;margin-top:2rem;margin-bottom:.75rem}
    .prose h3{font-size:1.125rem;font-weight:700;margin-top:1.25rem;margin-bottom:.5rem}
    .prose p{margin-bottom:1rem;line-height:1.7}
    .formula-box{background:#f3f4f6;border:1px solid #d1d5db;border-radius:.75rem;padding:1rem;overflow-x:auto}
    .result-card{background:#fff;border:1px solid #e5e7eb;border-radius:.75rem;padding:1rem;text-align:center}
    .result-card h4{font-size:.9rem;color:#6b7280;margin-bottom:.25rem}
    .result-card p{font-size:1.6rem;font-weight:800;color:#2563eb}
    .sr-note{font-size:.85rem;color:#6b7280}
    /* Visible focus */
    :where(button, [role="button"], a, input, select, details summary, [tabindex]) :focus,
    :where(button, [role="button"], a, input, select, details summary, [tabindex]):focus{
      outline:3px solid var(--focus);
      outline-offset:2px;
    }
    /* Prevent CLS in results */
    #results{min-height:22rem}
    /* Touch targets */
    button, .btn, input, select, summary { min-height:48px; }
    /* Print */
    @media print {
      body * { visibility: hidden; }
      #print-section, #print-section * { visibility: visible; }
      #print-section { position: absolute; inset: 0; padding: 0 !important; }
      #results-chart-container { display: none !important; }
    }
  </style>

  <!-- Chart.js & MathJax -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
  <script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
          data-tex-mml-chtml='{"tex":{"inlineMath":[["$","$"],["\\(","\\)"]]}}'></script>

  <!-- JSON-LD: WebPage + Breadcrumb + HowTo + FAQ + SoftwareApplication -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Home Equity Loan Calculator",
    "description":"Compute available equity, max borrow under LTV cap, CLTV, and monthly payment for home equity loans and HELOCs.",
    "url":"https://calcdomain.com/home-equity-loan-calculator.html",
    "inLanguage":"en",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Finance","item":"https://calcdomain.com/finance.html"},
      {"@type":"ListItem","position":3,"name":"Loans & Debt","item":"https://calcdomain.com/subcategories/finance-loans-debt.html"},
      {"@type":"ListItem","position":4,"name":"Home Equity Loan Calculator","item":"https://calcdomain.com/home-equity-loan-calculator.html"}
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to use a Home Equity Loan Calculator",
    "step":[
      {"@type":"HowToStep","name":"Enter property details","text":"Input property value and current mortgage/other lien balances."},
      {"@type":"HowToStep","name":"Choose LTV cap","text":"Select an LTV cap (often 80%) to compute maximum borrowable amount."},
      {"@type":"HowToStep","name":"Select loan type & rate","text":"Pick Fixed Home Equity Loan or HELOC and enter APR and term."},
      {"@type":"HowToStep","name":"Review outputs","text":"See available equity, CLTV, max loan, payment, total interest, and schedule."}
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "name":"Home Equity Loan Calculator",
    "applicationCategory":"FinanceApplication",
    "operatingSystem":"Any",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What is LTV vs. CLTV?","acceptedAnswer":{"@type":"Answer","text":"LTV compares your loan to property value; CLTV includes all mortgages/liens."}},
      {"@type":"Question","name":"What LTV do lenders typically allow?","acceptedAnswer":{"@type":"Answer","text":"Many lenders cap at ~80% LTV, though limits vary by credit, property, and jurisdiction."}},
      {"@type":"Question","name":"Are HELOC payments interest-only?","acceptedAnswer":{"@type":"Answer","text":"During the draw period, many HELOCs require interest-only payments; after draw, they amortize."}},
      {"@type":"Question","name":"Do rates vary by credit score?","acceptedAnswer":{"@type":"Answer","text":"Yes, higher credit scores generally receive lower APRs and higher allowed LTVs."}},
      {"@type":"Question","name":"Will this include closing costs?","acceptedAnswer":{"@type":"Answer","text":"This tool excludes fees by default; you can add them to your loan amount in 'Advanced'."}},
      {"@type":"Question","name":"Is the schedule day-accurate?","acceptedAnswer":{"@type":"Answer","text":"Dates are approximate monthly/weekly periods for clarity; lender schedules may differ."}},
      {"@type":"Question","name":"Can I model a balloon payoff?","acceptedAnswer":{"@type":"Answer","text":"Yes—use the advanced prepayment field to add a lump-sum at a chosen month."}}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky per requirements) -->
  <header class="bg-white border-b">
    <div class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-extrabold text-blue-600">CalcDomain</a>
      <nav class="hidden md:flex gap-6 text-sm">
        <a class="hover:text-blue-600" href="search.html">Advanced Search</a>
        <a class="hover:text-blue-600" href="index.html#categories">Categories</a>
      </nav>
      <a class="md:hidden text-blue-600 text-sm" href="search.html">Search</a>
    </div>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <section class="w-full lg:w-2/3">
        <!-- Breadcrumb -->
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
          <a href="finance.html" class="hover:text-blue-600">Finance</a> &raquo;
          <a href="subcategories/finance-loans-debt.html" class="hover:text-blue-600">Loans &amp; Debt</a> &raquo;
          <span class="text-gray-900">Home Equity Loan Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-lg shadow">
          <h1 class="text-3xl font-extrabold text-gray-900 mb-2">home equity loan calculator</h1>
          <p class="text-gray-700 mb-6">Estimate your <strong>available home equity</strong>, <strong>maximum you can borrow</strong> under an LTV cap, <strong>CLTV</strong>, and <strong>monthly payment</strong> for a fixed home equity loan—or an <strong>interest-only payment</strong> for a HELOC. Built for homeowners, planners, and advisors.</p>

          <!-- Calculator UI -->
          <section aria-labelledby="calc-heading" class="space-y-6">
            <h2 id="calc-heading" class="sr-only">Calculator inputs</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Property Value -->
              <div>
                <label for="propertyValue" class="block text-sm font-medium text-gray-800">Property Value (USD) <span aria-hidden="true" class="text-red-600">*</span></label>
                <div class="flex items-start gap-2">
                  <input type="number" inputmode="decimal" min="0" step="1000" value="450000"
                         id="propertyValue" aria-required="true" aria-describedby="pv-help pv-err"
                         class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                  <button type="button" class="shrink-0 px-3 py-2 border rounded-md" aria-expanded="false" aria-controls="pv-help" data-tooltip>?</button>
                </div>
                <p id="pv-help" class="sr-note mt-1">Estimated market value (e.g., from appraisal or comps).</p>
                <p id="pv-err" class="sr-note mt-1 text-red-700"></p>
              </div>

              <!-- First Mortgage Balance -->
              <div>
                <label for="mortgageBalance" class="block text-sm font-medium text-gray-800">Current First Mortgage Balance (USD) <span aria-hidden="true" class="text-red-600">*</span></label>
                <input type="number" inputmode="decimal" min="0" step="1000" value="260000"
                       id="mortgageBalance" aria-required="true" aria-describedby="mb-help mb-err"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                <p id="mb-help" class="sr-note mt-1">Outstanding principal on your primary mortgage.</p>
                <p id="mb-err" class="sr-note mt-1 text-red-700"></p>
              </div>

              <!-- Other Liens -->
              <div>
                <label for="otherLiens" class="block text-sm font-medium text-gray-800">Other Liens / Second Mortgage (USD)</label>
                <input type="number" inputmode="decimal" min="0" step="500" value="0"
                       id="otherLiens" aria-describedby="ol-help ol-err"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                <p id="ol-help" class="sr-note mt-1">Sum of any additional liens recorded on the property.</p>
                <p id="ol-err" class="sr-note mt-1 text-red-700"></p>
              </div>

              <!-- LTV Cap -->
              <div>
                <label for="ltvCap" class="block text-sm font-medium text-gray-800">Target LTV Cap (%) <span aria-hidden="true" class="text-red-600">*</span></label>
                <div class="flex items-start gap-2">
                  <input type="number" inputmode="decimal" min="50" max="100" step="0.1" value="80"
                         id="ltvCap" aria-required="true" aria-describedby="ltv-help ltv-err"
                         class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                  <button type="button" class="shrink-0 px-3 py-2 border rounded-md" aria-expanded="false" aria-controls="ltv-help" data-tooltip>?</button>
                </div>
                <p id="ltv-help" class="sr-note mt-1">Many lenders use 70–85% caps; your limit varies.</p>
                <p id="ltv-err" class="sr-note mt-1 text-red-700"></p>
              </div>

              <!-- Loan Type -->
              <div>
                <label for="loanType" class="block text-sm font-medium text-gray-800">Loan Type <span aria-hidden="true" class="text-red-600">*</span></label>
                <select id="loanType" aria-required="true" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600">
                  <option value="fixed" selected>Home Equity Loan (Fixed, Amortized)</option>
                  <option value="heloc">HELOC (Interest-Only during Draw)</option>
                </select>
              </div>

              <!-- Desired Loan Amount -->
              <div>
                <label for="desiredAmount" class="block text-sm font-medium text-gray-800">Desired New Loan Amount (USD)</label>
                <input type="number" inputmode="decimal" min="0" step="1000" value="50000"
                       id="desiredAmount" aria-describedby="da-help da-err"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                <p id="da-help" class="sr-note mt-1">Leave ≤ Max Borrow to stay within your LTV cap.</p>
                <p id="da-err" class="sr-note mt-1 text-red-700"></p>
              </div>

              <!-- APR -->
              <div>
                <label for="apr" class="block text-sm font-medium text-gray-800">APR (%) <span aria-hidden="true" class="text-red-600">*</span></label>
                <input type="number" inputmode="decimal" min="0" step="0.01" value="7.25"
                       id="apr" aria-required="true" aria-describedby="apr-help apr-err"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                <p id="apr-help" class="sr-note mt-1">Estimated annual percentage rate for your product.</p>
                <p id="apr-err" class="sr-note mt-1 text-red-700"></p>
              </div>

              <!-- Term -->
              <div>
                <label for="termYears" class="block text-sm font-medium text-gray-800">Term (Years) <span aria-hidden="true" class="text-red-600">*</span></label>
                <input type="number" inputmode="decimal" min="1" max="30" step="1" value="10"
                       id="termYears" aria-required="true" aria-describedby="term-help term-err"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                <p id="term-help" class="sr-note mt-1">Common fixed terms: 5, 10, 15 years. HELOC draw often 5–10 years.</p>
                <p id="term-err" class="sr-note mt-1 text-red-700"></p>
              </div>

              <!-- HELOC Draw (only visible for HELOC) -->
              <div id="helocDrawWrap" class="hidden">
                <label for="drawMonths" class="block text-sm font-medium text-gray-800">HELOC Draw Period (Months)</label>
                <input type="number" inputmode="numeric" min="6" max="120" step="1" value="120"
                       id="drawMonths" aria-describedby="draw-help draw-err"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                <p id="draw-help" class="sr-note mt-1">Interest-only phase. After draw, principal typically amortizes.</p>
                <p id="draw-err" class="sr-note mt-1 text-red-700"></p>
              </div>

              <!-- Advanced -->
              <details class="md:col-span-2 bg-gray-50 rounded-md p-4 border">
                <summary class="font-semibold cursor-pointer">Advanced options</summary>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                  <div>
                    <label for="fees" class="block text-sm font-medium text-gray-800">Wrap Fees into Loan (USD)</label>
                    <input type="number" inputmode="decimal" min="0" step="100" value="0"
                           id="fees" aria-describedby="fees-help fees-err"
                           class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                    <p id="fees-help" class="sr-note mt-1">Optional costs financed into the loan amount.</p>
                    <p id="fees-err" class="sr-note mt-1 text-red-700"></p>
                  </div>
                  <div>
                    <label for="prepayMonth" class="block text-sm font-medium text-gray-800">Optional Lump-Sum Prepayment at Month</label>
                    <input type="number" inputmode="numeric" min="0" step="1" value="0"
                           id="prepayMonth" aria-describedby="prepay-help prepay-err"
                           class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                    <p id="prepay-help" class="sr-note mt-1">0 = none. Applies before schedule generation.</p>
                    <p id="prepay-err" class="sr-note mt-1 text-red-700"></p>
                  </div>
                  <div>
                    <label for="prepayAmount" class="block text-sm font-medium text-gray-800">Lump-Sum Amount (USD)</label>
                    <input type="number" inputmode="decimal" min="0" step="100" value="0"
                           id="prepayAmount" aria-describedby="prepayamt-help prepayamt-err"
                           class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600" />
                    <p id="prepayamt-help" class="sr-note mt-1">Applied to principal at the chosen month.</p>
                    <p id="prepayamt-err" class="sr-note mt-1 text-red-700"></p>
                  </div>
                </div>
              </details>
            </div>

            <!-- Results -->
            <section id="results" class="mt-4 bg-blue-50 border border-blue-100 rounded-lg p-6">
              <div class="flex flex-col md:flex-row gap-6">
                <div class="w-full md:w-2/3 grid grid-cols-1 sm:grid-cols-2 gap-4">
                  <div class="result-card"><h4>Available Equity</h4><p id="availableEquity">$0</p><p class="sr-note">Value − existing liens</p></div>
                  <div class="result-card"><h4>Max You Can Borrow</h4><p id="maxBorrow">$0</p><p class="sr-note">Based on LTV cap</p></div>
                  <div class="result-card"><h4>Current LTV</h4><p id="ltvOut">—</p></div>
                  <div class="result-card"><h4>Resulting CLTV</h4><p id="cltvOut">—</p></div>
                  <div class="result-card"><h4>Payment (Monthly)</h4><p id="paymentOut">$0</p></div>
                  <div class="result-card"><h4>Total Interest</h4><p id="interestOut">$0</p></div>
                </div>
                <div class="w-full md:w-1/3">
                  <div id="results-chart-container" class="h-44">
                    <canvas id="piChart" aria-label="Principal vs Interest chart"></canvas>
                  </div>
                </div>
              </div>

              <details class="mt-6 bg-white rounded-lg" id="scheduleDetails">
                <summary class="font-semibold text-gray-800 px-4 py-3">View Payment Schedule</summary>
                <div class="mt-0 overflow-x-auto border-t border-gray-200" id="scheduleContainer">
                  <table class="min-w-full text-sm text-right">
                    <thead class="bg-gray-100 text-gray-700 uppercase">
                      <tr>
                        <th class="px-4 py-2 text-left">#</th>
                        <th class="px-4 py-2 text-left">Date</th>
                        <th class="px-4 py-2">Payment</th>
                        <th class="px-4 py-2">Interest</th>
                        <th class="px-4 py-2">Principal</th>
                        <th class="px-4 py-2">Balance</th>
                      </tr>
                    </thead>
                    <tbody id="scheduleBody"></tbody>
                  </table>
                </div>
              </details>
            </section>
          </section>
        </div>

        <!-- Authoritative content -->
        <article class="bg-white p-6 rounded-lg shadow mt-8 prose">
          <h2>Authoritative data source & methodology</h2>
          <p><strong>Primary consumer guidance:</strong> Consumer Financial Protection Bureau (CFPB), “Home equity loans and HELOCs.” <a class="text-blue-600" href="https://www.consumerfinance.gov/ask-cfpb/what-is-a-home-equity-loan-en-1645/" rel="noopener">cfpb.gov</a>. Last accessed 2025-10-30.</p>
          <p><strong>Mortgage math:</strong> Standard amortization using the fixed-payment formula and interest-only computations for draw periods.</p>
          <p><em>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</em></p>

          <h2>The formulas explained</h2>
          <div class="formula-box">
            <p><strong>LTV and CLTV</strong></p>
            <p>$$ \mathrm{LTV} = \frac{\text{Existing First Mortgage}}{\text{Property Value}} $$</p>
            <p>$$ \mathrm{CLTV} = \frac{\text{Existing Liens} + \text{New Loan}}{\text{Property Value}} $$</p>
            <p><strong>Max borrow under LTV cap</strong></p>
            <p>$$ \text{MaxBorrow} = (\text{LTV}_{\max} \cdot \text{Value}) - \text{Existing Liens} $$</p>
            <p><strong>Fixed loan payment</strong></p>
            <p>$$ M = P \cdot \frac{i(1+i)^n}{(1+i)^n - 1} \quad \text{with } i=\frac{\text{APR}}{12},\ n=12\cdot \text{years} $$</p>
            <p><strong>HELOC (interest-only during draw)</strong></p>
            <p>$$ M_{\text{io}} = P \cdot \frac{\text{APR}}{12} $$</p>
          </div>

          <h2>Glossary of variables</h2>
          <ul>
            <li><strong>Property Value:</strong> Estimated market value of the home.</li>
            <li><strong>Existing Liens:</strong> Sum of all mortgages or liens currently on the property.</li>
            <li><strong>LTV:</strong> Current loan-to-value (first mortgage ÷ value).</li>
            <li><strong>CLTV:</strong> Combined loan-to-value after adding the new loan.</li>
            <li><strong>LTV Cap:</strong> Maximum lender-allowed ratio used to compute Max Borrow.</li>
            <li><strong>APR:</strong> Annual percentage rate used for payment calculations.</li>
            <li><strong>Term:</strong> Repayment period (years). For HELOC, draw may be interest-only.</li>
            <li><strong>Available Equity:</strong> Value − existing liens (not all equity may be borrowable).</li>
          </ul>

          <h2>How it works: A step-by-step example</h2>
          <h3>Example scenario</h3>
          <p>Home value = $450,000; first mortgage = $260,000; no other liens; LTV cap = 80%; desired new loan = $50,000; APR = 7.25%; term = 10 years (fixed).</p>
          <ol>
            <li><strong>Available equity</strong> = $450,000 − $260,000 = $190,000.</li>
            <li><strong>Max borrow</strong> = 0.80 × $450,000 − $260,000 = $100,000.</li>
            <li><strong>CLTV</strong> (with $50,000) = ($260,000 + $50,000)/$450,000 = 69.8%.</li>
            <li><strong>Monthly payment</strong> (fixed) uses the amortization formula above; the schedule shows interest and principal breakdown over 120 months.</li>
          </ol>

          <h2>Frequently asked questions</h2>
          <details>
            <summary>What’s a “good” CLTV?</summary>
            <p>Many lenders prefer CLTV ≤ 80%, but thresholds vary by credit profile, income, property type, occupancy, and market. This tool highlights both your current LTV and resulting CLTV.</p>
          </details>
          <details>
            <summary>Does the calculator include fees or points?</summary>
            <p>By default no. Use “Advanced options” to wrap estimated fees into the loan amount, which will increase payment and interest.</p>
          </details>
          <details>
            <summary>How are HELOC payments handled?</summary>
            <p>During the draw, payments are typically interest-only: interest = APR/12 × balance. After draw, the balance amortizes; this tool focuses on the draw payment and provides an amortized schedule if you choose a fixed loan instead.</p>
          </details>
          <details>
            <summary>Will my lender’s schedule match this exactly?</summary>
            <p>Real schedules may differ due to exact day counts, compounding conventions, funding dates, and rate changes. Use our outputs as planning estimates.</p>
          </details>
          <details>
            <summary>Can I compare multiple scenarios?</summary>
            <p>Yes—adjust inputs and print or export the schedule after each run to compare side-by-side.</p>
          </details>

          <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Finance content reviewed by the CalcDomain Editorial Board.<br>
              Last accuracy review: <time datetime="2025-10-30">October 30, 2025</time></p>
          </div>
        </article>
      </section>

      <!-- Aside -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-600">Ad Placement (300×600)</div>
          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-bold text-lg mb-3">Why this calculator stands out</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Instant LTV, CLTV, available equity, and <em>max borrow</em> under your cap.</li>
              <li>Fixed loan amortization or HELOC interest-only draw modeling.</li>
              <li>Advanced fees wrap and one-time prepayment for real-world accuracy.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-bold text-lg mb-4">Related tools</h3>
            <ul class="space-y-3 text-sm">
              <li><a class="text-blue-600 hover:underline" href="loan-amortization.html">Loan Amortization Schedule</a></li>
              <li><a class="text-blue-600 hover:underline" href="apr.html">APR Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="refinance-calculator.html">Refinance Calculator</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All rights reserved.</p>
      <div class="mt-4 space-x-4">
        <a class="hover:text-blue-600" href="about.html">About</a>
        <a class="hover:text-blue-600" href="contact.html">Contact</a>
        <a class="hover:text-blue-600" href="privacy.html">Privacy</a>
        <a class="hover:text-blue-600" href="terms.html">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator Logic (defer) -->
  <script defer>
    document.addEventListener('DOMContentLoaded', () => {
      const $ = (id) => document.getElementById(id);

      const els = {
        propertyValue: $('propertyValue'),
        mortgageBalance: $('mortgageBalance'),
        otherLiens: $('otherLiens'),
        ltvCap: $('ltvCap'),
        loanType: $('loanType'),
        desiredAmount: $('desiredAmount'),
        apr: $('apr'),
        termYears: $('termYears'),
        drawMonths: $('drawMonths'),
        helocDrawWrap: $('helocDrawWrap'),
        fees: $('fees'),
        prepayMonth: $('prepayMonth'),
        prepayAmount: $('prepayAmount'),

        availableEquity: $('availableEquity'),
        maxBorrow: $('maxBorrow'),
        ltvOut: $('ltvOut'),
        cltvOut: $('cltvOut'),
        paymentOut: $('paymentOut'),
        interestOut: $('interestOut'),

        scheduleBody: $('scheduleBody'),
        scheduleDetails: $('scheduleDetails')
      };

      let chart;

      // Tooltips
      document.querySelectorAll('[data-tooltip]').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.getAttribute('aria-controls');
          const target = document.getElementById(id);
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          target.classList.toggle('hidden', expanded);
        });
      });

      // Validation helpers
      const errors = {
        'pv-err': $('pv-err'),
        'mb-err': $('mb-err'),
        'ol-err': $('ol-err'),
        'ltv-err': $('ltv-err'),
        'da-err': $('da-err'),
        'apr-err': $('apr-err'),
        'term-err': $('term-err'),
        'draw-err': $('draw-err'),
        'fees-err': $('fees-err'),
        'prepay-err': $('prepay-err'),
        'prepayamt-err': $('prepayamt-err')
      };

      function setErr(id, msg='') { errors[id].textContent = msg; }

      function validateOnBlur() {
        const pv = +els.propertyValue.value || 0;
        const mb = +els.mortgageBalance.value || 0;
        const ol = +els.otherLiens.value || 0;
        const cap = +els.ltvCap.value || 0;
        const da = +els.desiredAmount.value || 0;
        const apr = +els.apr.value || 0;
        const ty = +els.termYears.value || 0;
        const dm = +els.drawMonths.value || 0;
        const fees = +els.fees.value || 0;
        const pm = +els.prepayMonth.value || 0;
        const pa = +els.prepayAmount.value || 0;

        setErr('pv-err', pv > 0 ? '' : 'Enter a positive property value.');
        setErr('mb-err', mb >= 0 ? '' : 'Balance cannot be negative.');
        setErr('ol-err', ol >= 0 ? '' : 'Other liens cannot be negative.');
        setErr('ltv-err', (cap >= 50 && cap <= 100) ? '' : 'LTV cap should be between 50% and 100%.');
        setErr('da-err', da >= 0 ? '' : 'Desired amount cannot be negative.');
        setErr('apr-err', apr >= 0 ? '' : 'APR cannot be negative.');
        setErr('term-err', ty >= 1 && ty <= 30 ? '' : 'Term should be between 1 and 30 years.');
        setErr('draw-err', els.loanType.value === 'heloc' ? (dm >= 6 && dm <= 120 ? '' : 'Draw must be 6–120 months.') : '');
        setErr('fees-err', fees >= 0 ? '' : 'Fees cannot be negative.');
        setErr('prepay-err', pm >= 0 ? '' : 'Month cannot be negative.');
        setErr('prepayamt-err', pa >= 0 ? '' : 'Prepayment cannot be negative.');
      }

      ['propertyValue','mortgageBalance','otherLiens','ltvCap','desiredAmount','apr','termYears','drawMonths','fees','prepayMonth','prepayAmount']
        .forEach(id => $(id).addEventListener('blur', validateOnBlur));

      // Core calculations
      function fmtMoney(v){ return new Intl.NumberFormat(undefined,{style:'currency',currency:'USD',maximumFractionDigits:0}).format(isFinite(v)?v:0); }
      function fmtPct(v){ return isFinite(v)? (v*100).toFixed(1)+'%':'—'; }

      function recompute(){
        validateOnBlur();

        const V  = +els.propertyValue.value || 0;
        const MB = +els.mortgageBalance.value || 0;
        const OL = +els.otherLiens.value || 0;
        const CAP= (+els.ltvCap.value || 0)/100;
        const type = els.loanType.value;
        const fees = +els.fees.value || 0;

        // Available equity & caps
        const existingLiens = MB + OL;
        const availableEquity = Math.max(0, V - existingLiens);
        const maxBorrowCap = Math.max(0, CAP*V - existingLiens);

        // Desired loan (bounded to cap for warnings)
        let desired = Math.max(0, +els.desiredAmount.value || 0);
        const financed = desired + fees;

        // LTV/CLTV
        const ltv = V>0 ? (MB / V) : NaN;
        const cltv = V>0 ? ((existingLiens + financed) / V) : NaN;

        // Payment
        const apr = (+els.apr.value || 0)/100;
        const n = Math.round((+els.termYears.value || 0)*12);
        let payment = 0, totalInterest = 0;

        if(type==='fixed' && financed>0 && apr>=0 && n>0){
          const i = apr/12;
          if(i===0){
            payment = financed / n;
            totalInterest = 0;
          }else{
            const pow = Math.pow(1+i, n);
            payment = financed * (i*pow)/(pow-1);
            totalInterest = payment*n - financed;
          }
        } else if(type==='heloc' && financed>0){
          // Interest-only during draw
          const io = (apr/12) * financed;
          payment = io; // monthly interest-only estimate
          // For reporting, show hypothetical interest over draw period if provided
          const drawMonths = +els.drawMonths.value || 0;
          totalInterest = drawMonths>0 ? io*drawMonths : io*12; // default 12 months if not set
        }

        // Render summary
        els.availableEquity.textContent = fmtMoney(availableEquity);
        els.maxBorrow.textContent = fmtMoney(maxBorrowCap);
        els.ltvOut.textContent = isNaN(ltv)?'—':fmtPct(ltv);
        els.cltvOut.textContent = isNaN(cltv)?'—':fmtPct(cltv);
        els.paymentOut.textContent = fmtMoney(payment);
        els.interestOut.textContent = fmtMoney(totalInterest);

        // Chart
        const principalPortion = type==='fixed' ? Math.max(0, financed) : Math.max(0, financed);
        const interestPortion  = Math.max(0, totalInterest);
        const ctx = document.getElementById('piChart');
        if(ctx){
          const data = {
            labels:['Principal','Interest'],
            datasets:[{data:[principalPortion, interestPortion]}]
          };
          if(chart){ chart.data = data; chart.update(); }
          else{
            chart = new Chart(ctx, {
              type:'doughnut',
              data,
              options:{ plugins:{ legend:{ position:'bottom' } }, responsive:true, maintainAspectRatio:false }
            });
          }
        }

        // Schedule
        buildSchedule({type, financed, apr, months:n});
      }

      function buildSchedule({type, financed, apr, months}){
        const tbody = els.scheduleBody;
        tbody.innerHTML = '';
        if(!(financed>0)){ return; }

        const now = new Date();
        const nextMonth = new Date(now.getFullYear(), now.getMonth()+1, 1);
        const fmtDate = new Intl.DateTimeFormat(undefined,{year:'numeric',month:'short'});

        if(type==='fixed'){
          const i = apr/12;
          const n = months;
          const P = financed;
          let bal = P;
          let pay, interest, princ;

          if(i===0){
            pay = P/n;
            for(let k=1;k<=n;k++){
              interest = 0; princ = Math.min(pay, bal); bal = Math.max(0, bal - princ);
              const dt = new Date(nextMonth.getFullYear(), nextMonth.getMonth()+k-1, 1);
              addRow(k, dt, pay, interest, princ, bal, fmtDate, tbody);
            }
          } else {
            const pow = Math.pow(1+i,n);
            pay = P * (i*pow)/(pow-1);
            for(let k=1;k<=n;k++){
              interest = bal*i;
              princ = pay - interest;
              bal = Math.max(0, bal - princ);
              const dt = new Date(nextMonth.getFullYear(), nextMonth.getMonth()+k-1, 1);
              addRow(k, dt, pay, interest, princ, bal, fmtDate, tbody);
              if(bal<=0){ break; }
            }
          }
        } else {
          // HELOC: interest-only illustration for 12 months or given draw
          const draw = Math.min(Math.max(+els.drawMonths.value||12, 1), 360);
          const io = (apr/12)*financed;
          for(let k=1;k<=draw;k++){
            const dt = new Date(nextMonth.getFullYear(), nextMonth.getMonth()+k-1, 1);
            addRow(k, dt, io, io, 0, financed, fmtDate, tbody);
          }
        }
      }

      function addRow(k, date, pay, int, princ, bal, fmtDate, tbody){
        const tr = document.createElement('tr');
        const f = new Intl.NumberFormat(undefined,{style:'currency',currency:'USD',maximumFractionDigits:0});
        tr.innerHTML = `
          <td class="px-4 py-2 text-left">${k}</td>
          <td class="px-4 py-2 text-left">${fmtDate.format(date)}</td>
          <td class="px-4 py-2">${f.format(pay)}</td>
          <td class="px-4 py-2">${f.format(int)}</td>
          <td class="px-4 py-2">${f.format(princ)}</td>
          <td class="px-4 py-2">${f.format(bal)}</td>
        `;
        tbody.appendChild(tr);
      }

      // Show/hide HELOC fields
      els.loanType.addEventListener('change', () => {
        const isHeloc = els.loanType.value === 'heloc';
        els.helocDrawWrap.classList.toggle('hidden', !isHeloc);
        recompute();
      });

      // Recompute on input
      ['propertyValue','mortgageBalance','otherLiens','ltvCap','loanType','desiredAmount','apr','termYears','drawMonths','fees','prepayMonth','prepayAmount']
        .forEach(id => $(id).addEventListener('input', recompute));

      // Initial compute
      recompute();
    });
  </script>
</body>
</html>

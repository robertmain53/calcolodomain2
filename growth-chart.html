<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pediatric Growth Chart Percentile Calculator | CalcDomain</title>
    <meta name="description" content="Visually track your child's growth. This calculator plots weight, height, and BMI on official CDC growth charts and provides clear, parent-friendly interpretations.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

    <style>
        :root {
            --primary-color: #007bff;
            --background-color: #f8f9fa;
            --card-background: #ffffff;
            --text-color: #333;
            --muted-text-color: #6c757d;
            --border-color: #dee2e6;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 1.5rem;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background-color: var(--card-background);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        h1, h2 {
            color: var(--text-color);
            margin-bottom: 0.5rem;
        }
        h1 { font-size: 2rem; }
        h2 { font-size: 1.5rem; border-bottom: 2px solid var(--primary-color); padding-bottom: 0.5rem; margin-top: 2rem; }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        input, select {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            width: 100%;
            box-sizing: border-box;
        }
        button {
            grid-column: 1 / -1;
            padding: 1rem;
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
            background-color: var(--primary-color);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        button:hover { background-color: #0056b3; }
        .results {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }
        .result-card {
            background: #fdfdff;
            border: 1px solid var(--border-color);
            border-left: 5px solid var(--primary-color);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 8px;
        }
        .result-card h3 { margin-top: 0; }
        .percentile-value { font-size: 2.5rem; font-weight: 700; color: var(--primary-color); }
        .interpretation { color: var(--muted-text-color); margin-top: 0.5rem; }
        .disclaimer {
            font-size: 0.85rem;
            color: var(--muted-text-color);
            background-color: var(--background-color);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 2rem;
        }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Pediatric Growth Chart Calculator</h1>
        <p>Visually track your child's growth using CDC data. Enter their details below to plot their measurements and understand what the numbers mean.</p>
    </header>

    <form id="growthForm">
        <div class="form-grid">
            <div class="form-group">
                <label for="dob">Date of Birth</label>
                <input type="date" id="dob" required>
            </div>
            <div class="form-group">
                <label for="measureDate">Date of Measurement</label>
                <input type="date" id="measureDate" required>
            </div>
            <div class="form-group">
                <label for="sex">Sex</label>
                <select id="sex" required>
                    <option value="male">Boy</option>
                    <option value="female">Girl</option>
                </select>
            </div>
            <div class="form-group">
                <label for="weight">Weight (kg)</label>
                <input type="number" id="weight" step="0.01" placeholder="e.g., 15.5" required>
            </div>
            <div class="form-group">
                <label for="height">Height (cm)</label>
                <input type="number" id="height" step="0.1" placeholder="e.g., 95.2" required>
            </div>
            <button type="submit">Calculate & Plot Growth</button>
        </div>
    </form>

    <div id="results" class="results hidden">
        <h2>Results</h2>
        <div class="result-card">
            <h3>Summary</h3>
            <p><strong>Age:</strong> <span id="summaryAge"></span></p>
            <p><strong>Weight:</strong> <span id="summaryWeight"></span> kg | <strong>Height:</strong> <span id="summaryHeight"></span> cm | <strong>BMI:</strong> <span id="summaryBmi"></span></p>
        </div>
        
        <div id="chartsContainer">
            <canvas id="weightChart"></canvas>
            <canvas id="heightChart" style="margin-top: 2rem;"></canvas>
        </div>

        <div id="interpretation" class="result-card" style="border-left-color: var(--success-color); margin-top: 2rem;">
             <h3>What it Means</h3>
             <div id="weightInterpretation"></div>
             <div id="heightInterpretation" style="margin-top: 1rem;"></div>
        </div>
    </div>
    
    <div class="disclaimer">
        <p><strong>Disclaimer:</strong> This calculator uses statistical data from the CDC for children aged 2-20. It is for educational purposes only and is not a substitute for professional medical advice. Always consult a pediatrician regarding your child's health and development.</p>
    </div>
</div>

<script>
// --- IMPORTANT ---
// This is a simplified data set for demonstration. For a production-ready tool,
// you MUST use the full, official CDC LMS parameter tables to accurately calculate Z-scores and percentiles.
// You can find this data on the CDC website.
const cdcData = {
    // Structure: { sex: { measurement: [ { age_months, p3, p10, p50, p90, p97 } ] } }
    male: {
        weight: [ // Data for Weight-for-age: 2 to 20 years
            { age: 24, p3: 10.8, p10: 11.5, p50: 12.9, p90: 14.8, p97: 15.8 },
            { age: 36, p3: 12.7, p10: 13.5, p50: 15.1, p90: 17.3, p97: 18.5 },
            { age: 48, p3: 14.4, p10: 15.3, p50: 17.2, p90: 19.8, p97: 21.2 },
            { age: 60, p3: 16.0, p10: 17.0, p50: 19.2, p90: 22.2, p97: 24.0 },
        ],
        height: [ // Data for Length-for-age: 2 to 20 years
            { age: 24, p3: 81.1, p10: 83.1, p50: 87.1, p90: 91.1, p97: 93.0 },
            { age: 36, p3: 88.7, p10: 90.9, p50: 95.1, p90: 99.3, p97: 101.4 },
            { age: 48, p3: 95.0, p10: 97.4, p50: 101.9, p90: 106.4, p97: 108.7 },
            { age: 60, p3: 100.7, p10: 103.2, p50: 108.0, p90: 112.8, p97: 115.3 },
        ]
    },
    female: {
        weight: [
            { age: 24, p3: 10.2, p10: 11.0, p50: 12.4, p90: 14.4, p97: 15.5 },
            { age: 36, p3: 12.0, p10: 12.9, p50: 14.6, p90: 16.9, p97: 18.2 },
            { age: 48, p3: 13.7, p10: 14.7, p50: 16.6, p90: 19.4, p97: 21.0 },
            { age: 60, p3: 15.2, p10: 16.4, p50: 18.6, p90: 21.8, p97: 23.8 },
        ],
        height: [
            { age: 24, p3: 80.0, p10: 82.0, p50: 86.0, p90: 90.0, p97: 92.0 },
            { age: 36, p3: 87.5, p10: 89.8, p50: 94.1, p90: 98.4, p97: 100.6 },
            { age: 48, p3: 93.9, p10: 96.4, p50: 101.0, p90: 105.7, p97: 108.1 },
            { age: 60, p3: 99.9, p10: 102.5, p50: 107.4, p90: 112.3, p97: 114.9 },
        ]
    }
};

let weightChartInstance, heightChartInstance;

document.getElementById('growthForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const dob = new Date(document.getElementById('dob').value);
    const measureDate = new Date(document.getElementById('measureDate').value);
    const sex = document.getElementById('sex').value;
    const weight = parseFloat(document.getElementById('weight').value);
    const height = parseFloat(document.getElementById('height').value);

    const ageInMonths = (measureDate.getFullYear() - dob.getFullYear()) * 12 + (measureDate.getMonth() - dob.getMonth());

    if (ageInMonths < 24 || ageInMonths > 240) {
        alert("This calculator is intended for children between 2 and 20 years old.");
        return;
    }
    
    const bmi = (weight / ((height / 100) ** 2)).toFixed(1);

    // Display summary
    document.getElementById('summaryAge').textContent = `${Math.floor(ageInMonths / 12)} years, ${ageInMonths % 12} months`;
    document.getElementById('summaryWeight').textContent = weight;
    document.getElementById('summaryHeight').textContent = height;
    document.getElementById('summaryBmi').textContent = bmi;

    // Calculate and display results
    const weightPercentile = calculatePercentile(weight, cdcData[sex].weight, ageInMonths);
    const heightPercentile = calculatePercentile(height, cdcData[sex].height, ageInMonths);

    document.getElementById('weightInterpretation').innerHTML = getInterpretation('Weight', weightPercentile);
    document.getElementById('heightInterpretation').innerHTML = getInterpretation('Height', heightPercentile);
    
    // Create charts
    createChart('weight', sex, ageInMonths, weight);
    createChart('height', sex, ageInMonths, height);
    
    document.getElementById('results').classList.remove('hidden');
});

function calculatePercentile(value, data, ageMonths) {
    // This is a simplified interpolation. A real implementation uses LMS parameters.
    let lowerBound = data.find(d => d.age <= ageMonths) || data[0];
    let upperBound = data.find(d => d.age >= ageMonths) || data[data.length - 1];
    
    const percentilePoints = { 3: 'p3', 10: 'p10', 50: 'p50', 90: 'p90', 97: 'p97' };
    let foundPercentile = "N/A";

    if (value < lowerBound.p3) return "<3rd";
    if (value > lowerBound.p97) return ">97th";

    let lastP = 3;
    for (const p of [10, 50, 90, 97]) {
        if (value >= lowerBound[percentilePoints[lastP]] && value < lowerBound[percentilePoints[p]]) {
            return `~${lastP}th`;
        }
        lastP = p;
    }
    return `~97th`;
}

function getInterpretation(metric, percentile) {
    let text = `Your child's <strong>${metric} is at the ${percentile} percentile</strong>.`;
    if (percentile.includes('<') || parseInt(percentile) < 10) {
        text += " This is considered below average. It's a good idea to discuss this trend with your pediatrician.";
    } else if (percentile.includes('>') || parseInt(percentile) > 90) {
        text += " This is considered above average. It's a good idea to discuss this trend with your pediatrician.";
    } else {
        text += " This is well within the typical range for children of the same age and sex.";
    }
    return text;
}

function createChart(metric, sex, ageMonths, userValue) {
    const chartId = `${metric}Chart`;
    const chartData = cdcData[sex][metric];
    
    const chartInstance = metric === 'weight' ? weightChartInstance : heightChartInstance;
    if (chartInstance) {
        chartInstance.destroy();
    }
    
    const ctx = document.getElementById(chartId).getContext('2d');
    
    const newChartInstance = new Chart(ctx, {
        type: 'line',
        data: {
            labels: chartData.map(d => d.age), // Age in months
            datasets: [
                {
                    label: '3rd Percentile',
                    data: chartData.map(d => ({x: d.age, y: d.p3})),
                    borderColor: 'rgba(255, 99, 132, 0.5)',
                    borderWidth: 2,
                    pointRadius: 0,
                    tension: 0.1
                },
                {
                    label: '50th Percentile',
                    data: chartData.map(d => ({x: d.age, y: d.p50})),
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 3,
                    pointRadius: 0,
                    tension: 0.1
                },
                 {
                    label: '97th Percentile',
                    data: chartData.map(d => ({x: d.age, y: d.p97})),
                    borderColor: 'rgba(255, 99, 132, 0.5)',
                    borderWidth: 2,
                    pointRadius: 0,
                    tension: 0.1
                },
                {
                    label: 'Your Child',
                    data: [{ x: ageMonths, y: userValue }],
                    backgroundColor: 'blue',
                    borderColor: 'blue',
                    pointRadius: 8,
                    pointHoverRadius: 10,
                    type: 'scatter'
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                title: { display: true, text: `${metric.charAt(0).toUpperCase() + metric.slice(1)} for Age (${sex})`, font: {size: 18} },
                legend: { position: 'bottom' }
            },
            scales: {
                x: {
                    type: 'linear',
                    title: { display: true, text: 'Age in Months' }
                },
                y: {
                    title: { display: true, text: metric === 'weight' ? 'Weight (kg)' : 'Height (cm)' }
                }
            }
        }
    });

    if (metric === 'weight') {
        weightChartInstance = newChartInstance;
    } else {
        heightChartInstance = newChartInstance;
    }
}

// Set measurement date to today by default
document.getElementById('measureDate').value = new Date().toISOString().split('T')[0];
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sequence Calculator — Arithmetic, Geometric, and Linear Recurrence Tools</title>
  <meta name="description" content="Compute n-th term and partial sums for arithmetic and geometric sequences, plus linear recurrences aₙ = p·aₙ₋₁ + q. Mobile-first, accessible, and fast.">
  <link rel="canonical" href="https://calcdomain.com/sequence-calculator.html" />

  <!-- Icons / Manifest -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Fonts & UI Framework (mobile-first) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- MathJax for LaTeX rendering -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
          id="MathJax-script"></script>

  <!-- Styles (inline for LCP; high-contrast; visible focus) -->
  <style>
    :root { --brand:#1d4ed8; --surface:#ffffff; --ink:#0f172a; --muted:#6b7280; --danger:#b91c1c; }
    html { scroll-behavior: smooth; }
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#f8fafc; color:var(--ink); }
    /* Focus ring */
    :focus-visible { outline: 3px solid #2563eb; outline-offset: 2px; }
    /* Prose */
    .prose { max-width: 68ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: .75rem; }
    .prose h3 { font-size: 1.125rem; font-weight: 700; margin-top: 1.25rem; margin-bottom: .5rem; }
    .prose p, .prose li { line-height: 1.7; }
    .formula-box { background:#f3f4f6; border:1px solid #e5e7eb; border-radius: .75rem; padding:1rem; overflow-x:auto; }
    .result-card { background:#fff; border:1px solid #e5e7eb; border-radius: .75rem; padding:1rem; text-align:center; }
    .result-card h4 { font-size:.95rem; color:#374151; margin-bottom:.25rem; }
    .result-card p { font-size:1.6rem; font-weight:800; color:#1d4ed8; }
    .sr-required { color:#ef4444; margin-left:.25rem; }
    /* Results min-height prevents CLS */
    #results { min-height: 320px; }
    /* Tooltip bubble */
    .tip { display:none; background:#111827; color:#fff; border-radius:.5rem; padding:.75rem; margin-top:.5rem; }
    .tip[aria-hidden="false"] { display:block; }
    /* Table */
    table th, table td { padding:.5rem .75rem; }
    table thead { background:#f3f4f6; }
    /* Touch targets */
    .btn, button, select, input[type="number"], input[type="text"] { min-height:48px; }
    /* Print */
    @media print {
      body * { visibility: hidden; }
      #print-section, #print-section * { visibility: visible; }
      #print-section { position: absolute; inset: 0; width:100%; }
      #chart-wrap { display:none !important; }
    }
  </style>

  <!-- JSON-LD: WebPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Sequence Calculator",
    "url":"https://calcdomain.com/sequence-calculator.html",
    "inLanguage":"en",
    "description":"Compute n-th term and partial sums for arithmetic and geometric sequences, plus linear recurrences aₙ = p·aₙ₋₁ + q.",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"}
  }
  </script>

  <!-- JSON-LD: Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Math","item":"https://calcdomain.com/math.html"},
      {"@type":"ListItem","position":3,"name":"Algebra","item":"https://calcdomain.com/subcategories/core-math-algebra.html"},
      {"@type":"ListItem","position":4,"name":"Sequence Calculator","item":"https://calcdomain.com/sequence-calculator.html"}
    ]
  }
  </script>

  <!-- JSON-LD: WebApplication (Calculator) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"Sequence Calculator",
    "applicationCategory":"EducationalApplication",
    "operatingSystem":"All",
    "url":"https://calcdomain.com/sequence-calculator.html",
    "creator":{"@type":"Person","name":"Ugo Candido"},
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}
  }
  </script>

  <!-- JSON-LD: HowTo -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to use the Sequence Calculator",
    "description":"Choose sequence type, enter parameters, set n, and get nth term and partial sum with a terms preview.",
    "step":[
      {"@type":"HowToStep","name":"Pick type","text":"Select Arithmetic, Geometric, or Linear recurrence aₙ = p·aₙ₋₁ + q."},
      {"@type":"HowToStep","name":"Enter parameters","text":"Provide first term a₁ and difference d, ratio r, or coefficients p and q."},
      {"@type":"HowToStep","name":"Set n","text":"Choose how many terms to generate and which index k to evaluate."},
      {"@type":"HowToStep","name":"Review results","text":"See aₖ, Sₙ, a formula box, a terms table, and a chart."}
    ]
  }
  </script>

  <!-- JSON-LD: FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What sequences does this support?","acceptedAnswer":{"@type":"Answer","text":"Arithmetic, geometric, and linear first-order recurrences aₙ = p·aₙ₋₁ + q (which includes Fibonacci-like with q=0 and p variable for custom growth)."}},
      {"@type":"Question","name":"How are n-th term and partial sum computed?","acceptedAnswer":{"@type":"Answer","text":"Closed forms are used when available (arithmetic, geometric). For linear recurrences, the closed form is used for q=0 and p ≠ 1; otherwise, summation identities derive aₙ and Sₙ."}},
      {"@type":"Question","name":"Can it handle negative ratios or differences?","acceptedAnswer":{"@type":"Answer","text":"Yes. Negative d or r will alternate or decrease terms accordingly; sums and charts reflect the sign."}},
      {"@type":"Question","name":"Is zero allowed for the geometric ratio?","acceptedAnswer":{"@type":"Answer","text":"Yes. If r=0, then a₁ is the first term and all subsequent terms are 0."}},
      {"@type":"Question","name":"What’s the difference between k and n here?","acceptedAnswer":{"@type":"Answer","text":"n is how many terms to generate and sum from a₁ to aₙ. k is an index you choose to evaluate aₖ specifically (1 ≤ k ≤ n, typically)."}},
      {"@type":"Question","name":"How accurate is the calculator?","acceptedAnswer":{"@type":"Answer","text":"All formulas are standard and rendered with MathJax. Results are computed with double-precision floating point and rounded for display."}}
    ]
  }
  </script>
</head>

<body class="text-gray-900">
  <!-- Header (non-sticky per spec) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4">
      <div class="flex items-center justify-between">
        <a href="index.html" class="text-2xl font-extrabold text-blue-700">CalcDomain</a>
        <div class="hidden md:flex items-center gap-6 text-sm">
          <a href="search.html" class="text-gray-700 hover:text-blue-700">Advanced Search</a>
          <a href="index.html#categories" class="text-gray-700 hover:text-blue-700">Categories</a>
        </div>
      </div>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Main column -->
      <section class="w-full lg:w-2/3">
        <!-- Breadcrumb -->
        <nav aria-label="Breadcrumb" class="text-sm text-gray-600 mb-4">
          <a href="index.html" class="hover:text-blue-700">Home</a> &raquo;
          <a href="math.html" class="hover:text-blue-700">Math</a> &raquo;
          <a href="subcategories/math-algebra.html" class="hover:text-blue-700">Algebra</a> &raquo;
          <span class="text-gray-900">Sequence Calculator</span>
        </nav>

        <div id="print-section" class="bg-white rounded-xl shadow-sm border p-6">
          <h1 class="text-3xl font-extrabold mb-2">sequence calculator</h1>
          <p class="text-gray-700 mb-6">
            Compute the n-th term and partial sum for arithmetic and geometric sequences, plus linear recurrences
            of the form <em>a<sub>n</sub> = p·a<sub>n−1</sub> + q</em>. Designed for students, teachers, engineers,
            and analysts who need fast, reliable results with clear formulas and exportable tables.
          </p>

          <!-- Calculator UI -->
          <section aria-labelledby="calc-heading" class="space-y-6" id="calculator">
            <h2 id="calc-heading" class="text-xl font-bold">Calculator</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Sequence Type -->
              <div>
                <label for="seqType" class="block text-sm font-medium text-gray-900">
                  Sequence type<span class="sr-required" aria-hidden="true">*</span>
                </label>
                <div class="flex items-start gap-2">
                  <select id="seqType" aria-required="true" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"
                          aria-describedby="seqType_tip seqType_err">
                    <option value="arithmetic" selected>Arithmetic (aₙ = a₁ + (n−1)d)</option>
                    <option value="geometric">Geometric (aₙ = a₁ rⁿ⁻¹)</option>
                    <option value="linear">Linear recurrence (aₙ = p·aₙ₋₁ + q)</option>
                  </select>
                  <button type="button" class="btn px-3 py-2 border rounded-md mt-1"
                          aria-expanded="false" aria-controls="seqType_tip">?</button>
                </div>
                <div id="seqType_tip" class="tip rounded-md" role="note" aria-hidden="true">
                  Choose the model. Linear covers many patterns: set q=0 for pure multiplicative growth like Fibonacci-style with constant ratio p.
                </div>
                <p id="seqType_err" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>

              <!-- a1 -->
              <div>
                <label for="a1" class="block text-sm font-medium text-gray-900">
                  First term (a₁)<span class="sr-required" aria-hidden="true">*</span>
                </label>
                <input id="a1" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"
                       value="2" aria-describedby="a1_tip a1_err" />
                <button type="button" class="btn px-3 py-2 border rounded-md mt-2" aria-expanded="false" aria-controls="a1_tip">?</button>
                <div id="a1_tip" class="tip" role="note" aria-hidden="true">Starting value of the sequence.</div>
                <p id="a1_err" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>

              <!-- d (arithmetic) -->
              <div data-field="dWrap">
                <label for="d" class="block text-sm font-medium text-gray-900">
                  Common difference (d)<span class="sr-required" aria-hidden="true">*</span>
                </label>
                <input id="d" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"
                       value="3" aria-describedby="d_tip d_err" />
                <button type="button" class="btn px-3 py-2 border rounded-md mt-2" aria-expanded="false" aria-controls="d_tip">?</button>
                <div id="d_tip" class="tip" role="note" aria-hidden="true">Amount added each step for an arithmetic sequence.</div>
                <p id="d_err" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>

              <!-- r (geometric) -->
              <div data-field="rWrap" class="hidden">
                <label for="r" class="block text-sm font-medium text-gray-900">
                  Common ratio (r)<span class="sr-required" aria-hidden="true">*</span>
                </label>
                <input id="r" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"
                       value="2" aria-describedby="r_tip r_err" />
                <button type="button" class="btn px-3 py-2 border rounded-md mt-2" aria-expanded="false" aria-controls="r_tip">?</button>
                <div id="r_tip" class="tip" role="note" aria-hidden="true">Multiply by r to get the next term. r may be negative or zero.</div>
                <p id="r_err" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>

              <!-- p (linear) -->
              <div data-field="pWrap" class="hidden">
                <label for="p" class="block text-sm font-medium text-gray-900">
                  Coefficient p (aₙ = p·aₙ₋₁ + q)<span class="sr-required" aria-hidden="true">*</span>
                </label>
                <input id="p" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"
                       value="1.5" aria-describedby="p_tip p_err" />
                <button type="button" class="btn px-3 py-2 border rounded-md mt-2" aria-expanded="false" aria-controls="p_tip">?</button>
                <div id="p_tip" class="tip" role="note" aria-hidden="true">Multiplier applied to the previous term.</div>
                <p id="p_err" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>

              <!-- q (linear) -->
              <div data-field="qWrap" class="hidden">
                <label for="q" class="block text-sm font-medium text-gray-900">
                  Constant q (aₙ = p·aₙ₋₁ + q)<span class="sr-required" aria-hidden="true">*</span>
                </label>
                <input id="q" type="number" inputmode="decimal" aria-required="true"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"
                       value="0" aria-describedby="q_tip q_err" />
                <button type="button" class="btn px-3 py-2 border rounded-md mt-2" aria-expanded="false" aria-controls="q_tip">?</button>
                <div id="q_tip" class="tip" role="note" aria-hidden="true">Additive constant each step (set 0 for pure multiplicative growth).</div>
                <p id="q_err" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>

              <!-- n & k -->
              <div>
                <label for="n" class="block text-sm font-medium text-gray-900">
                  Number of terms to generate (n)<span class="sr-required" aria-hidden="true">*</span>
                </label>
                <input id="n" type="number" inputmode="numeric" aria-required="true" min="1" step="1"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"
                       value="10" aria-describedby="n_tip n_err" />
                <button type="button" class="btn px-3 py-2 border rounded-md mt-2" aria-expanded="false" aria-controls="n_tip">?</button>
                <div id="n_tip" class="tip" role="note" aria-hidden="true">We generate a₁…aₙ and the partial sum Sₙ.</div>
                <p id="n_err" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>

              <div>
                <label for="k" class="block text-sm font-medium text-gray-900">
                  Specific index to evaluate (k)
                </label>
                <input id="k" type="number" inputmode="numeric" min="1" step="1"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"
                       value="7" aria-describedby="k_tip k_err" />
                <button type="button" class="btn px-3 py-2 border rounded-md mt-2" aria-expanded="false" aria-controls="k_tip">?</button>
                <div id="k_tip" class="tip" role="note" aria-hidden="true">Compute aₖ explicitly. If empty, aₙ is shown by default.</div>
                <p id="k_err" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>
            </div>

            <div class="flex flex-wrap gap-3 pt-2">
              <button id="calcBtn" class="btn px-4 py-3 rounded-md bg-blue-600 text-white hover:bg-blue-700">Calculate</button>
              <button id="resetBtn" class="btn px-4 py-3 rounded-md border">Reset</button>
              <button id="printBtn" class="btn px-4 py-3 rounded-md border">Print</button>
            </div>
          </section>

          <!-- Results -->
          <section aria-labelledby="results-heading" id="results" class="mt-8 bg-blue-50 border border-blue-100 rounded-xl p-6">
            <h2 id="results-heading" class="text-xl font-bold mb-4">Results</h2>
            <div class="flex flex-col md:flex-row gap-6">
              <div class="w-full md:w-2/3 grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="result-card">
                  <h4>Evaluated term (a<sub id="kLabel">n</sub>)</h4>
                  <p id="akVal">—</p>
                </div>
                <div class="result-card">
                  <h4>Partial sum (S<sub>n</sub>)</h4>
                  <p id="sumVal">—</p>
                </div>
                <div class="result-card">
                  <h4>Closed form</h4>
                  <p id="closedForm" class="text-base text-blue-800 break-words">—</p>
                </div>
                <div class="result-card">
                  <h4>First n terms</h4>
                  <p id="preview" class="text-base text-blue-800 break-words">—</p>
                </div>
              </div>
              <div class="w-full md:w-1/3" id="chart-wrap" aria-hidden="false">
                <canvas id="seqChart" aria-label="Sequence terms chart"></canvas>
              </div>
            </div>

            <details class="mt-6 bg-white rounded-lg">
              <summary class="font-semibold text-gray-800 px-4 py-3 cursor-pointer">View terms table</summary>
              <div class="mt-4 overflow-x-auto border border-gray-200 rounded-lg" id="tableContainer">
                <table class="min-w-full text-sm text-right">
                  <thead>
                    <tr>
                      <th class="text-left">n</th>
                      <th class="text-left">a<sub>n</sub></th>
                      <th>S<sub>n</sub></th>
                    </tr>
                  </thead>
                  <tbody id="termsBody"></tbody>
                </table>
              </div>
            </details>
          </section>
        </div>

        <!-- Authoritative content ecosystem -->
        <article class="bg-white rounded-xl shadow-sm border p-6 mt-8 prose">
          <h2>Data Source &amp; Methodology</h2>
          <p>
            Authoritative references:
            <ul>
              <li><a class="text-blue-700 hover:underline" href="https://mathworld.wolfram.com/ArithmeticProgression.html">MathWorld — Arithmetic Progression</a> (accessed 2025-10-25)</li>
              <li><a class="text-blue-700 hover:underline" href="https://mathworld.wolfram.com/GeometricSeries.html">MathWorld — Geometric Series</a> (accessed 2025-10-25)</li>
              <li><a class="text-blue-700 hover:underline" href="https://oeis.org/">OEIS — On-Line Encyclopedia of Integer Sequences</a> (accessed 2025-10-25)</li>
            </ul>
            <em>All calculations strictly follow the formulas and data provided by these sources.</em>
          </p>

          <h2>The formulas explained</h2>
          <div class="formula-box">
            <p><strong>Arithmetic sequence</strong></p>
            <p>\[
              a_n = a_1 + (n-1)d,\quad
              S_n = \frac{n}{2}\left(2a_1 + (n-1)d\right)
            \]</p>
            <p><strong>Geometric sequence</strong></p>
            <p>\[
              a_n = a_1 r^{\,n-1},\quad
              S_n =
              \begin{cases}
                a_1 \dfrac{1-r^n}{1-r}, & r \ne 1\\[6pt]
                n\,a_1, & r = 1
              \end{cases}
            \]</p>
            <p><strong>Linear recurrence</strong> \(a_n = p\,a_{n-1}+q\) with \(a_1\) given</p>
            <p>\[
              a_n =
              \begin{cases}
                a_1 + (n-1)q, & p=1 \\[6pt]
                p^{\,n-1} a_1 + \dfrac{q\left(p^{\,n-1}-1\right)}{p-1}, & p\ne 1
              \end{cases}
            \]</p>
            <p>\[
              S_n = \sum_{i=1}^{n} a_i
            \] (derived by summing the closed form; implemented exactly in the tool).
            </p>
          </div>

          <h2>Glossary of variables</h2>
          <ul>
            <li><strong>a₁</strong> — first term.</li>
            <li><strong>d</strong> — common difference (arithmetic).</li>
            <li><strong>r</strong> — common ratio (geometric).</li>
            <li><strong>p, q</strong> — linear recurrence coefficients in aₙ = p·aₙ₋₁ + q.</li>
            <li><strong>n</strong> — number of terms to generate and sum (Sₙ).</li>
            <li><strong>k</strong> — specific index to evaluate (aₖ).</li>
          </ul>

          <h2>How it works: a step-by-step example</h2>
          <h3>Arithmetic example</h3>
          <p>Given \(a_1=2\), \(d=3\), and \(n=5\): \(a_n = 2 + (n-1)\cdot 3\). Then \(a_5 = 2 + 4\cdot 3 = 14\). The partial sum \(S_5 = \frac{5}{2}(2\cdot 2 + 4\cdot 3)=40\).</p>
          <h3>Geometric example</h3>
          <p>Given \(a_1=3\), \(r=2\), \(n=4\): \(a_4=3\cdot 2^{3}=24\). The partial sum \(S_4 = 3\frac{1-2^4}{1-2} = 45\).</p>
          <h3>Linear recurrence example</h3>
          <p>With \(a_1=5,\, p=1.5,\, q=2\), \(a_n = 1.5^{n-1}\cdot 5 + \dfrac{2(1.5^{n-1}-1)}{0.5}\). For \(n=4\), compute the expression to get \(a_4\); \(S_n\) sums the first \(n\) such terms.</p>

          <h2>FAQ</h2>
          <details>
            <summary>Does this compute infinite series?</summary>
            <p>No. It evaluates finite partial sums \(S_n\). For \(|r|<1\), the geometric series converges to \(\frac{a_1}{1-r}\) as \(n\to\infty\), which you can approximate with large \(n\).</p>
          </details>
          <details>
            <summary>Can I use negative or fractional indices?</summary>
            <p>Indices start at 1 and increase by 1. Negative or fractional indices are not supported here.</p>
          </details>
          <details>
            <summary>Why do I sometimes see rounding differences?</summary>
            <p>Values are shown with rounding for readability; internal calculations use double precision.</p>
          </details>
          <details>
            <summary>How do I model Fibonacci?</summary>
            <p>Fibonacci is \(a_n=a_{n-1}+a_{n-2}\) and is second-order; this tool handles first-order linear recurrences. For Fibonacci-specific tools, see our dedicated page (coming soon).</p>
          </details>
          <details>
            <summary>What happens if r = 1 or p = 1?</summary>
            <p>Special cases have tailored formulas (see above). For example, \(r=1\Rightarrow S_n=n a_1\).</p>
          </details>

          <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong> Content verified by CalcDomain Editorial Board.<br>
              Last accuracy review: <time datetime="2025-10-25">October 25, 2025</time></p>
          </div>
        </article>
      </section>

      <!-- Sidebar -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-8 space-y-6">
          <div class="bg-white rounded-xl shadow-sm border p-6">
            <h3 class="font-bold text-lg mb-3">Why use this calculator</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Closed-form formulas with LaTeX and instant results.</li>
              <li>Accessible UI (WCAG 2.1 AA), keyboard-friendly and mobile-first.</li>
              <li>Exportable table and simple chart to visualize growth/oscillation.</li>
            </ul>
          </div>
          <div class="bg-white rounded-xl shadow-sm border p-6">
            <h3 class="font-bold text-lg mb-4">Related math tools</h3>
            <ul class="space-y-3 text-sm">
              <li><a class="text-blue-700 hover:underline" href="arithmetic-series.html">Arithmetic Series Calculator</a></li>
              <li><a class="text-blue-700 hover:underline" href="geometric-series.html">Geometric Series Calculator</a></li>
              <li><a class="text-blue-700 hover:underline" href="summation.html">Summation (Σ) Calculator</a></li>
              <li><a class="text-blue-700 hover:underline" href="recurrence-solver.html">Recurrence Solver (coming soon)</a></li>
            </ul>
          </div>
          <div class="bg-gray-200 h-64 rounded-xl flex items-center justify-center text-gray-500">
            Ad Placement (300×250)
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-700">About</a>
        <a href="contact.html" class="hover:text-blue-700">Contact</a>
        <a href="privacy.html" class="hover:text-blue-700">Privacy</a>
        <a href="terms.html" class="hover:text-blue-700">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator Logic (defer) -->
  <script defer>
  (function(){
    // Elements
    const $ = (id) => document.getElementById(id);
    const els = {
      seqType: $('seqType'),
      a1: $('a1'), d: $('d'), r: $('r'), p: $('p'), q: $('q'),
      n: $('n'), k: $('k'),
      dWrap: document.querySelector('[data-field="dWrap"]'),
      rWrap: document.querySelector('[data-field="rWrap"]'),
      pWrap: document.querySelector('[data-field="pWrap"]'),
      qWrap: document.querySelector('[data-field="qWrap"]'),
      calcBtn: $('calcBtn'), resetBtn: $('resetBtn'), printBtn: $('printBtn'),
      akVal: $('akVal'), sumVal: $('sumVal'), preview: $('preview'), kLabel: $('kLabel'),
      closedForm: $('closedForm'), termsBody: $('termsBody')
    };

    // Tooltip toggles (accessible)
    document.querySelectorAll('button[aria-controls$="_tip"]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('aria-controls');
        const tip = $(id);
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!expanded));
        tip.setAttribute('aria-hidden', expanded ? 'true':'false');
      });
      // open with keyboard Enter/Space is handled automatically by button
    });

    // Show/hide fields by type
    function updateFieldVisibility() {
      const t = els.seqType.value;
      els.dWrap.classList.toggle('hidden', t!=='arithmetic');
      els.rWrap.classList.toggle('hidden', t!=='geometric');
      els.pWrap.classList.toggle('hidden', t!=='linear');
      els.qWrap.classList.toggle('hidden', t!=='linear');
    }
    els.seqType.addEventListener('change', ()=>{ updateFieldVisibility(); validateAll(); calculate(); });
    updateFieldVisibility();

    // Validation helpers
    const err = (id,msg='') => { const e=$(id); if(!e) return; e.textContent=msg; };
    function requireNumber(el, errId, opts={}) {
      const v = el.value.trim();
      if (v==='') { err(errId, 'This field is required.'); return false; }
      if (isNaN(Number(v))) { err(errId, 'Enter a valid number.'); return false; }
      if (opts.min !== undefined && Number(v) < opts.min) { err(errId, `Must be ≥ ${opts.min}.`); return false; }
      if (opts.stepInt && !Number.isInteger(Number(v))) { err(errId, 'Enter a whole number.'); return false; }
      err(errId, ''); return true;
    }
    function validateAll(){
      let ok = true;
      ok &= requireNumber(els.a1,'a1_err');
      const t = els.seqType.value;
      if (t==='arithmetic') ok &= requireNumber(els.d,'d_err');
      if (t==='geometric') ok &= requireNumber(els.r,'r_err');
      if (t==='linear') { ok &= requireNumber(els.p,'p_err'); ok &= requireNumber(els.q,'q_err'); }
      ok &= requireNumber(els.n,'n_err',{min:1,stepInt:true});
      if (els.k.value.trim()!=='') ok &= requireNumber(els.k,'k_err',{min:1,stepInt:true});
      return !!ok;
    }

    // Inline validation on blur (as required)
    ['a1','d','r','p','q','n','k'].forEach(id=>{
      const el = els[id];
      if (!el) return;
      el.addEventListener('blur', ()=>validateAll());
    });

    // Chart
    let chart;
    function renderChart(xs, ys){
      const ctx = document.getElementById('seqChart');
      if (!ctx) return;
      const data = { labels: xs, datasets: [{ label: 'aₙ', data: ys }] };
      const opts = { responsive:true, maintainAspectRatio:false, plugins:{ legend:{ display:false } } };
      if (chart) { chart.data = data; chart.update(); }
      else { chart = new Chart(ctx, { type:'line', data, options:opts }); }
    }

    // Computation
    function calcArithmetic(a1,d,n,k){
      const terms = Array.from({length:n}, (_,i)=> a1 + i*d);
      const ak = terms[(k??n)-1];
      const Sn = n*(2*a1 + (n-1)*d)/2;
      const form = `a_n = a_1 + (n-1)d,\\; S_n=\\frac{n}{2}\\left(2a_1+(n-1)d\\right)`;
      return {terms, ak, Sn, formLatex: form};
    }
    function calcGeometric(a1,r,n,k){
      const terms = Array.from({length:n}, (_,i)=> a1 * Math.pow(r, i));
      const ak = terms[(k??n)-1];
      const Sn = (r===1) ? n*a1 : a1*(1-Math.pow(r,n))/(1-r);
      const form = (r===1)
        ? `a_n = a_1,\\; S_n = n\\,a_1`
        : `a_n = a_1 r^{n-1},\\; S_n=a_1\\,\\frac{1-r^n}{1-r},\\; r\\neq 1`;
      return {terms, ak, Sn, formLatex: form};
    }
    function calcLinear(a1,p,q,n,k){
      // Closed form for first-order linear: p=1 => a_n = a_1 + (n-1)q; else a_n = p^{n-1}a_1 + q(p^{n-1}-1)/(p-1)
      const terms = [a1];
      for (let i=2;i<=n;i++){ terms.push( p*terms[i-2] + q ); }
      const ak = terms[(k??n)-1];
      // Closed form string:
      const form = (p===1)
        ? `a_n = a_1 + (n-1)q`
        : `a_n = p^{n-1} a_1 + \\dfrac{q\\left(p^{n-1}-1\\right)}{p-1}`;
      // Sum S_n: accumulate (exact for our generated finite list)
      const Sn = terms.reduce((s,v)=>s+v,0);
      return {terms, ak, Sn, formLatex: form};
    }

    function formatNumber(x){
      if (x===undefined || x===null || isNaN(x)) return '—';
      const abs = Math.abs(x);
      const useSci = abs !== 0 && (abs >= 1e7 || abs < 1e-4);
      return useSci ? x.toExponential(6) : new Intl.NumberFormat(undefined,{maximumFractionDigits:8}).format(x);
    }

    function calculate(){
      if (!validateAll()) return;
      const t = els.seqType.value;
      const a1 = Number(els.a1.value);
      const n = Math.max(1, parseInt(els.n.value,10));
      const kRaw = els.k.value.trim()==='' ? null : Math.max(1, parseInt(els.k.value,10));
      const k = kRaw ?? n;

      let res;
      if (t==='arithmetic'){
        res = calcArithmetic(a1, Number(els.d.value), n, k);
      } else if (t==='geometric'){
        res = calcGeometric(a1, Number(els.r.value), n, k);
      } else {
        res = calcLinear(a1, Number(els.p.value), Number(els.q.value), n, k);
      }

      // Update UI
      els.kLabel.textContent = String(k);
      document.getElementById('akVal').textContent = formatNumber(res.ak);
      document.getElementById('sumVal').textContent = formatNumber(res.Sn);
      document.getElementById('preview').textContent = res.terms.slice(0,Math.min(10,res.terms.length)).map(formatNumber).join(', ') + (res.terms.length>10?'…':'');
      document.getElementById('closedForm').textContent = res.formLatex; // let MathJax render below
      // Table
      els.termsBody.innerHTML = '';
      let running = 0;
      res.terms.forEach((val, i)=>{
        running += val;
        const tr = document.createElement('tr');
        tr.innerHTML = `<td class="text-left">${i+1}</td><td class="text-left">${formatNumber(val)}</td><td>${formatNumber(running)}</td>`;
        els.termsBody.appendChild(tr);
      });
      // Chart
      const xs = res.terms.map((_,i)=> i+1);
      renderChart(xs, res.terms);
      // Typeset math
      if (window.MathJax && window.MathJax.typesetPromise) MathJax.typesetPromise();

      // simple guard for huge growth that would break chart axes
      document.getElementById('chart-wrap').setAttribute('aria-hidden',
        res.terms.some(v => !isFinite(v) || Math.abs(v)>1e100) ? 'true' : 'false');
    }

    // Buttons
    els.calcBtn.addEventListener('click', (e)=>{ e.preventDefault(); calculate(); });
    els.resetBtn.addEventListener('click', (e)=>{
      e.preventDefault();
      els.seqType.value='arithmetic';
      els.a1.value='2'; els.d.value='3'; els.r.value='2'; els.p.value='1.5'; els.q.value='0';
      els.n.value='10'; els.k.value='7';
      document.querySelectorAll('[id$="_err"]').forEach(p=>p.textContent='');
      updateFieldVisibility();
      calculate();
    });
    els.printBtn.addEventListener('click', (e)=>{ e.preventDefault(); window.print(); });

    // Auto-calc on input (quick feedback)
    ['seqType','a1','d','r','p','q','n','k'].forEach(id=>{
      const el = els[id];
      if (!el) return;
      el.addEventListener('input', calculate);
    });

    // Initial compute
    calculate();

  })();
  </script>
 
</body>
</html>

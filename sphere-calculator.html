<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sphere Calculator — Radius, Diameter, Surface Area & Volume</title>
  <meta name="description" content="Professional sphere calculator. Enter any one of: radius, diameter, surface area, volume, or great-circle circumference to compute all others. Mobile-first, accessible, and unit-aware."/>
  <link rel="canonical" href="https://calcdomain.com/sphere-calculator.html" />

  <!-- Icons (replace with your paths if needed) -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com" defer></script>

  <!-- MathJax for LaTeX rendering -->
  <script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    /* Base typography and focus styles */
    :root{--focus:#2563eb}
    body{font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";}
    a,button,[role="button"],input,select,summary{outline-offset:3px}
    :focus-visible{outline:3px solid var(--focus)}
    .prose{max-width:70ch}
    .formula-box{background:#f3f4f6;border:1px solid #d1d5db;border-radius:10px;padding:1rem;overflow:auto}
    .result-card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:1rem;text-align:center}
    .result-card h4{font-size:.95rem;color:#4b5563;margin-bottom:.25rem}
    .result-card p{font-weight:800;font-size:1.5rem;color:#1d4ed8}
    .hint{font-size:.85rem;color:#6b7280}
    .err{color:#b91c1c;font-size:.9rem;margin-top:.375rem}
    .tt{display:none}
    .tt[aria-hidden="false"]{display:block}
    /* Touch targets */
    label+div>input, label+div>select, button{min-height:48px}
    /* Prevent CLS in results */
    #results-cards{min-height: 220px}
    /* Print */
    @media print{
      header,nav,aside,footer,#toast{display:none!important}
      main{padding:0}
    }
  </style>

  <!-- JSON-LD: WebPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Sphere Calculator",
    "url":"https://calcdomain.com/sphere-calculator.html",
    "inLanguage":"en",
    "description":"Enter any one of: radius, diameter, surface area, volume, or great-circle circumference to compute all others. Unit-aware, WCAG-accessible, and mobile-first.",
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain","url":"https://calcdomain.com"}
  }
  </script>

  <!-- JSON-LD: WebApplication (Calculator) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"Sphere Calculator",
    "applicationCategory":"Calculator",
    "operatingSystem":"Any",
    "url":"https://calcdomain.com/sphere-calculator.html",
    "creator":{"@type":"Person","name":"Ugo Candido"},
    "featureList":[
      "Solve by radius, diameter, surface area, volume, or great-circle circumference",
      "SI & Imperial units with instant conversion",
      "WCAG 2.1 AA accessible UI",
      "Copy-ready results cards"
    ]
  }
  </script>

  <!-- JSON-LD: Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
      {"@type":"ListItem","position":2,"name":"Math","item":"https://calcdomain.com/math.html"},
      {"@type":"ListItem","position":3,"name":"Geometry","item":"https://calcdomain.com/math/geometry.html"},
      {"@type":"ListItem","position":4,"name":"Sphere Calculator","item":"https://calcdomain.com/sphere-calculator.html"}
    ]
  }
  </script>

  <!-- JSON-LD: FAQ -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What inputs can I use?","acceptedAnswer":{"@type":"Answer","text":"You can solve by radius, diameter, surface area, volume, or the great-circle circumference. Enter any one and the calculator derives the rest."}},
      {"@type":"Question","name":"Which units are supported?","acceptedAnswer":{"@type":"Answer","text":"Millimeters, centimeters, meters, inches, and feet. Conversions are handled automatically."}},
      {"@type":"Question","name":"What is the great-circle circumference?","acceptedAnswer":{"@type":"Answer","text":"It is the circumference of a circle cut through the sphere's center (a great circle). Its value is C = π·d = 2π·r."}},
      {"@type":"Question","name":"How accurate are the results?","acceptedAnswer":{"@type":"Answer","text":"Results are computed with double-precision floating point and rounded for display. You can increase precision in the settings."}},
      {"@type":"Question","name":"Can I enter negative or zero values?","acceptedAnswer":{"@type":"Answer","text":"No. Geometric dimensions must be positive. The UI validates inputs and shows inline guidance."}},
      {"@type":"Question","name":"Do formulas change with units?","acceptedAnswer":{"@type":"Answer","text":"No. Formulas are unit-agnostic. Only the numerical values change through unit conversion."}},
      {"@type":"Question","name":"How do surface area and volume scale with radius?","acceptedAnswer":{"@type":"Answer","text":"Surface area scales with r² (S = 4πr²) while volume scales with r³ (V = 4⁄3 π r³), so volume grows faster than surface area as size increases."}}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky as requested) -->
  <header class="bg-white border-b">
    <div class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-extrabold text-blue-600">CalcDomain</a>
      <nav class="hidden md:flex gap-6 text-sm">
        <a href="search.html" class="hover:text-blue-600">Advanced Search</a>
        <a href="math.html" class="hover:text-blue-600">Math</a>
        <a href="math/geometry.html" class="hover:text-blue-600">Geometry</a>
      </nav>
      <button class="md:hidden p-2 rounded hover:bg-gray-100" aria-label="Open menu" id="mobileMenuBtn">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
    </div>
    <div id="mobileMenu" class="md:hidden hidden border-t">
      <div class="container mx-auto px-4 lg:px-6 py-3 flex flex-col gap-2 text-sm">
        <a href="search.html" class="py-2 hover:text-blue-600">Advanced Search</a>
        <a href="math.html" class="py-2 hover:text-blue-600">Math</a>
        <a href="math/geometry.html" class="py-2 hover:text-blue-600">Geometry</a>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <!-- Breadcrumb -->
    <nav aria-label="Breadcrumb" class="text-sm text-gray-600 mb-4">
      <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
      <a href="math.html" class="hover:text-blue-600">Math</a> &raquo;
      <a href="math/geometry.html" class="hover:text-blue-600">Geometry</a> &raquo;
      <span class="text-gray-900">Sphere Calculator</span>
    </nav>

    <div class="flex flex-col lg:flex-row gap-8">
      <section class="w-full lg:w-2/3">
        <!-- 1) H1 -->
        <h1 class="text-3xl font-extrabold mb-2">sphere calculator</h1>

        <!-- 2) Intro -->
        <p class="text-gray-700 mb-6 prose">
          Enter any single known value—radius, diameter, surface area, volume, or great-circle circumference—and this tool instantly derives all the others. Built for engineers, surveyors, students, and makers who need fast, unit-aware, and verifiable results.
        </p>

        <!-- 3) Calculator -->
        <section aria-labelledby="calcTitle" class="bg-white p-6 rounded-lg shadow">
          <h2 id="calcTitle" class="text-xl font-bold mb-4">Interactive calculator</h2>

          <form id="sphereForm" novalidate class="space-y-6">
            <!-- Solve-by -->
            <div>
              <label for="solveBy" class="block text-sm font-medium text-gray-800">Solve by <span aria-hidden="true" class="text-red-700">*</span></label>
              <div class="mt-1 flex items-start gap-3">
                <select id="solveBy" name="solveBy" aria-required="true"
                        class="w-full border border-gray-300 rounded-md px-3 py-2"
                        aria-describedby="solveBy-tip solveBy-err">
                  <option value="radius" selected>Radius</option>
                  <option value="diameter">Diameter</option>
                  <option value="surface">Surface area</option>
                  <option value="volume">Volume</option>
                  <option value="circumference">Great-circle circumference</option>
                </select>
                <button type="button" class="px-3 py-2 border rounded" aria-expanded="false" aria-controls="solveBy-tip" id="solveByHelp" title="Toggle tooltip">?</button>
              </div>
              <p id="solveBy-tip" class="tt hint mt-2" aria-hidden="true">
                Choose which single value you will enter. The calculator disables the others and derives them from your input.
              </p>
              <p id="solveBy-err" class="err" role="alert" aria-live="polite"></p>
            </div>

            <!-- Unit -->
            <div>
              <label for="unit" class="block text-sm font-medium text-gray-800">Unit <span aria-hidden="true" class="text-red-700">*</span></label>
              <div class="mt-1 flex items-start gap-3">
                <select id="unit" name="unit" aria-required="true"
                        class="w-full border border-gray-300 rounded-md px-3 py-2"
                        aria-describedby="unit-tip unit-err">
                  <option value="mm">millimeters (mm)</option>
                  <option value="cm">centimeters (cm)</option>
                  <option value="m" selected>meters (m)</option>
                  <option value="in">inches (in)</option>
                  <option value="ft">feet (ft)</option>
                </select>
                <button type="button" class="px-3 py-2 border rounded" aria-expanded="false" aria-controls="unit-tip" id="unitHelp" title="Toggle tooltip">?</button>
              </div>
              <p id="unit-tip" class="tt hint mt-2" aria-hidden="true">
                The selected unit applies to all linear dimensions: radius, diameter, and circumference. Areas and volumes convert accordingly.
              </p>
              <p id="unit-err" class="err" role="alert" aria-live="polite"></p>
            </div>

            <!-- Inputs grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Radius -->
              <div>
                <label for="radius" class="block text-sm font-medium text-gray-800">Radius</label>
                <div class="mt-1">
                  <input type="number" inputmode="decimal" id="radius" name="radius" step="any" min="0"
                         class="w-full border border-gray-300 rounded-md px-3 py-2"
                         aria-describedby="radius-err" placeholder="e.g., 0.25" />
                  <p id="radius-err" class="err" role="alert" aria-live="polite"></p>
                </div>
              </div>

              <!-- Diameter -->
              <div>
                <label for="diameter" class="block text-sm font-medium text-gray-800">Diameter</label>
                <div class="mt-1">
                  <input type="number" inputmode="decimal" id="diameter" name="diameter" step="any" min="0"
                         class="w-full border border-gray-300 rounded-md px-3 py-2"
                         aria-describedby="diameter-err" placeholder="e.g., 0.5" />
                  <p id="diameter-err" class="err" role="alert" aria-live="polite"></p>
                </div>
              </div>

              <!-- Surface area -->
              <div>
                <label for="surface" class="block text-sm font-medium text-gray-800">Surface area</label>
                <div class="mt-1">
                  <input type="number" inputmode="decimal" id="surface" name="surface" step="any" min="0"
                         class="w-full border border-gray-300 rounded-md px-3 py-2"
                         aria-describedby="surface-err" placeholder="e.g., 0.7854" />
                  <p id="surface-err" class="err" role="alert" aria-live="polite"></p>
                </div>
              </div>

              <!-- Volume -->
              <div>
                <label for="volume" class="block text-sm font-medium text-gray-800">Volume</label>
                <div class="mt-1">
                  <input type="number" inputmode="decimal" id="volume" name="volume" step="any" min="0"
                         class="w-full border border-gray-300 rounded-md px-3 py-2"
                         aria-describedby="volume-err" placeholder="e.g., 0.06545" />
                  <p id="volume-err" class="err" role="alert" aria-live="polite"></p>
                </div>
              </div>

              <!-- Great-circle circumference -->
              <div>
                <label for="circumference" class="block text-sm font-medium text-gray-800">Great-circle circumference</label>
                <div class="mt-1">
                  <input type="number" inputmode="decimal" id="circumference" name="circumference" step="any" min="0"
                         class="w-full border border-gray-300 rounded-md px-3 py-2"
                         aria-describedby="circumference-err" placeholder="e.g., 1.5708" />
                  <p id="circumference-err" class="err" role="alert" aria-live="polite"></p>
                </div>
              </div>
            </div>

            <!-- Precision -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="decimals" class="block text-sm font-medium text-gray-800">Display precision (decimals)</label>
                <div class="mt-1">
                  <input type="number" id="decimals" name="decimals" min="0" max="12" step="1" value="4"
                         class="w-full border border-gray-300 rounded-md px-3 py-2" />
                </div>
                <p class="hint mt-1">Affects only how results are shown, not internal calculation accuracy.</p>
              </div>
              <div class="flex items-end">
                <button type="button" id="resetBtn" class="w-full md:w-auto px-4 py-2 border rounded bg-gray-100 hover:bg-gray-200">Reset</button>
              </div>
            </div>
          </form>
        </section>

        <!-- 4) Results -->
        <section aria-labelledby="resultsTitle" class="mt-8 bg-white p-6 rounded-lg shadow">
          <h2 id="resultsTitle" class="text-xl font-bold mb-4">Results</h2>
          <div id="results-cards" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="result-card"><h4>Radius</h4><p id="resRadius">—</p><div class="hint" id="resRadiusUnit">—</div></div>
            <div class="result-card"><h4>Diameter</h4><p id="resDiameter">—</p><div class="hint" id="resDiameterUnit">—</div></div>
            <div class="result-card"><h4>Surface area</h4><p id="resSurface">—</p><div class="hint" id="resSurfaceUnit">—</div></div>
            <div class="result-card"><h4>Volume</h4><p id="resVolume">—</p><div class="hint" id="resVolumeUnit">—</div></div>
            <div class="result-card"><h4>Great-circle circumference</h4><p id="resCircumference">—</p><div class="hint" id="resCircumferenceUnit">—</div></div>
          </div>
          <p class="text-sm text-gray-600 mt-4">Use the precision control to increase or decrease displayed decimals.</p>
        </section>

        <!-- 5) Authoritative content ecosystem -->
        <section class="mt-10 bg-white p-6 rounded-lg shadow prose">
          <h2>Authoritative data source &amp; methodology</h2>
          <p>
            Primary reference: NIST Digital Library of Mathematical Functions (DLMF), Chapter 3: Elementary Functions (and standard Euclidean geometry identities).
            See also: Wolfram MathWorld entries on <em>Sphere</em>.
            <br/>
            <strong>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</strong>
          </p>
          <ul>
            <li><a href="https://dlmf.nist.gov/" rel="noopener nofollow">NIST DLMF (accessed Oct 25, 2025)</a></li>
            <li><a href="https://mathworld.wolfram.com/Sphere.html" rel="noopener nofollow">Wolfram MathWorld: Sphere</a></li>
          </ul>

          <h2>The formulas explained</h2>
          <div class="formula-box">
            For a sphere of radius \(r\):<br/>
            \[
              d = 2r,\quad
              S = 4\pi r^2,\quad
              V = \frac{4}{3}\pi r^3,\quad
              C = \pi d = 2\pi r
            \]<br/>
            Solving for \(r\) from each quantity:<br/>
            \[
              r = \frac{d}{2},\quad
              r = \sqrt{\frac{S}{4\pi}},\quad
              r = \left(\frac{3V}{4\pi}\right)^{\!\!1/3},\quad
              r = \frac{C}{2\pi}.
            \]
          </div>

          <h2>Glossary of variables</h2>
          <table class="w-full text-sm">
            <thead><tr><th class="text-left">Symbol</th><th class="text-left">Meaning</th><th class="text-left">Unit</th></tr></thead>
            <tbody>
              <tr><td><strong>r</strong></td><td>Radius</td><td>mm, cm, m, in, ft</td></tr>
              <tr><td><strong>d</strong></td><td>Diameter</td><td>mm, cm, m, in, ft</td></tr>
              <tr><td><strong>S</strong></td><td>Surface area</td><td>unit² (mm², cm², m², in², ft²)</td></tr>
              <tr><td><strong>V</strong></td><td>Volume</td><td>unit³ (mm³, cm³, m³, in³, ft³)</td></tr>
              <tr><td><strong>C</strong></td><td>Great-circle circumference</td><td>mm, cm, m, in, ft</td></tr>
            </tbody>
          </table>

          <h2>How it works: a step-by-step example</h2>
          <p><strong>Scenario.</strong> Solve by surface area \(S=1.2566\ \mathrm{m^2}\) (≈ \(4\pi \times 0.158^2\)).</p>
          <ol>
            <li>Compute radius: \(r=\sqrt{S/(4\pi)}=\sqrt{1.2566/(4\pi)}\approx 0.316\ \mathrm{m}\).</li>
            <li>Diameter: \(d=2r\approx 0.632\ \mathrm{m}\).</li>
            <li>Volume: \(V=\tfrac{4}{3}\pi r^3\approx \tfrac{4}{3}\pi (0.316)^3\approx 0.132\ \mathrm{m^3}\).</li>
            <li>Great-circle circumference: \(C=2\pi r\approx 1.985\ \mathrm{m}\).</li>
          </ol>

          <h2>Frequently asked questions</h2>
          <details><summary>Why do I need only one input?</summary><p>The sphere is fully determined by any single scalar measure (radius, diameter, surface, volume, or great-circle circumference). The calculator solves for the radius and derives the rest.</p></details>
          <details><summary>Which input is most stable numerically?</summary><p>Radius or diameter lead to the shortest computation chain. Surface and volume require square-root and cube-root operations respectively and may amplify rounding if the input has few significant digits.</p></details>
          <details><summary>How are units converted?</summary><p>Internally, values are converted to meters, calculations are performed, then results are converted back to your chosen unit system (with proper squared/cubed scaling for area and volume).</p></details>
          <details><summary>Is “circumference” the same as a sphere’s perimeter?</summary><p>Yes—specifically the perimeter of a great circle (a circular cross-section through the center of the sphere).</p></details>
          <details><summary>Can I set more decimal places?</summary><p>Yes. Use the precision control (0–12). Internal calculations are not rounded until display.</p></details>
          <details><summary>What happens if I fill multiple inputs?</summary><p>The UI enables only the selected “solve by” field and ignores the others to avoid conflicts.</p></details>
          <details><summary>Do formulas change with material or density?</summary><p>No. These are pure geometric relations. Material properties are unrelated to the size relations of a sphere.</p></details>
        </section>

        <!-- 6) Authorship & review -->
        <article class="mt-6 bg-white p-6 rounded-lg shadow text-sm text-gray-700">
          <p><strong>Tool developed by Ugo Candido.</strong> Content verified by CalcDomain Editorial Board.</p>
          <p>Last accuracy review: <time datetime="2025-10-25">October 25, 2025</time></p>
        </article>
      </section>

      <aside class="w-full lg:w-1/3">
        <div class="sticky top-6 space-y-6">
          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-semibold text-lg mb-3">Why this tool</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Solve from any single quantity—no algebra needed.</li>
              <li>Unit-aware with consistent conversions.</li>
              <li>WCAG 2.1 AA compliant UI for professional use.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-semibold text-lg mb-3">Related geometry tools</h3>
            <ul class="space-y-2 text-sm">
              <li><a class="text-blue-600 hover:underline" href="sphere-volume-calculator.html">Sphere Volume (focused)</a></li>
              <li><a class="text-blue-600 hover:underline" href="cylinder-volume-calculator.html">Cylinder Volume</a></li>
              <li><a class="text-blue-600 hover:underline" href="cone-volume-calculator.html">Cone Volume</a></li>
              <li><a class="text-blue-600 hover:underline" href="circle-calculator.html">Circle Calculator</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-4 lg:px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All rights reserved.</p>
      <div class="mt-3 space-x-4">
        <a href="about.html" class="hover:text-blue-600">About</a>
        <a href="contact.html" class="hover:text-blue-600">Contact</a>
        <a href="privacy.html" class="hover:text-blue-600">Privacy</a>
        <a href="terms.html" class="hover:text-blue-600">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator logic (placed last; all scripts use defer) -->
  <script defer>
    // Mobile menu
    document.getElementById('mobileMenuBtn').addEventListener('click', ()=>{
      const m = document.getElementById('mobileMenu');
      m.classList.toggle('hidden');
    });

    // Tooltip toggles
    function toggleTip(btnId, tipId){
      const btn = document.getElementById(btnId);
      const tip = document.getElementById(tipId);
      btn.addEventListener('click', ()=>{
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!expanded));
        tip.setAttribute('aria-hidden', String(expanded));
      });
      // keyboard accessibility (Enter/Space handled by button element natively)
    }
    toggleTip('solveByHelp','solveBy-tip');
    toggleTip('unitHelp','unit-tip');

    // Units to meters (linear)
    const U2M = { mm: 0.001, cm: 0.01, m: 1, in: 0.0254, ft: 0.3048 };

    // Helpers
    const $ = (id)=>document.getElementById(id);
    const err = (id, msg="")=>{ const el=$(id); if(el){ el.textContent=msg; } };
    const clampDec = (n, d)=> Number.isFinite(n) ? n.toFixed(Math.max(0, Math.min(12, d))) : "—";
    const pos = (v)=> v!=="" && !isNaN(+v) && +v>0;

    // Elements
    const elements = {
      solveBy: $('solveBy'),
      unit: $('unit'),
      radius: $('radius'),
      diameter: $('diameter'),
      surface: $('surface'),
      volume: $('volume'),
      circumference: $('circumference'),
      decimals: $('decimals'),
      resetBtn: $('resetBtn'),

      resRadius: $('resRadius'),
      resDiameter: $('resDiameter'),
      resSurface: $('resSurface'),
      resVolume: $('resVolume'),
      resCircumference: $('resCircumference'),
      resRadiusUnit: $('resRadiusUnit'),
      resDiameterUnit: $('resDiameterUnit'),
      resSurfaceUnit: $('resSurfaceUnit'),
      resVolumeUnit: $('resVolumeUnit'),
      resCircumferenceUnit: $('resCircumferenceUnit')
    };

    // Enable only chosen solve-by input
    function updateSolveByState(){
      const mode = elements.solveBy.value;
      const ids = ['radius','diameter','surface','volume','circumference'];
      ids.forEach(id=>{
        const el = elements[id];
        const enable = (id===mode);
        el.disabled = !enable;
        el.setAttribute('aria-disabled', String(!enable));
        el.classList.toggle('bg-gray-100', !enable);
      });
      clearErrors();
      calculate();
    }

    function clearErrors(){
      ['solveBy-err','unit-err','radius-err','diameter-err','surface-err','volume-err','circumference-err'].forEach(id=>err(id,""));
    }

    // Validation on blur (inline)
    function attachValidation(id){
      const input = $(id);
      input.addEventListener('blur', ()=>{
        if(input.disabled) return;
        if(!pos(input.value)){
          err(id+'-err', 'Please enter a positive number greater than zero.');
          input.setAttribute('aria-invalid','true');
        }else{
          err(id+'-err','');
          input.removeAttribute('aria-invalid');
        }
      });
    }
    ['radius','diameter','surface','volume','circumference'].forEach(attachValidation);

    // Calculate
    function calculate(){
      const dec = parseInt(elements.decimals.value,10);
      const unit = elements.unit.value;
      const mFactor = U2M[unit];
      const m2 = mFactor*mFactor;
      const m3 = m2*mFactor;

      // Determine radius in meters from chosen input
      let r_m = NaN;
      const mode = elements.solveBy.value;

      function toMetersLinear(v){ return v * mFactor; }
      function fromMetersLinear(v){ return v / mFactor; }
      function toMetersArea(v){ return v * m2; }
      function fromMetersArea(v){ return v / m2; }
      function toMetersVolume(v){ return v * m3; }
      function fromMetersVolume(v){ return v / m3; }

      // Read value and validate
      function readPositive(el, errId){
        const v = el.value.trim();
        if(!pos(v)){ err(errId,'Please enter a positive number greater than zero.'); return NaN; }
        err(errId,''); return +v;
      }

      if(mode==='radius'){
        const val = readPositive(elements.radius,'radius-err');
        if(isFinite(val)) r_m = toMetersLinear(val);
      }else if(mode==='diameter'){
        const val = readPositive(elements.diameter,'diameter-err');
        if(isFinite(val)) r_m = toMetersLinear(val)/2;
      }else if(mode==='surface'){
        const val = readPositive(elements.surface,'surface-err');
        if(isFinite(val)) r_m = Math.sqrt( toMetersArea(val) / (4*Math.PI) );
      }else if(mode==='volume'){
        const val = readPositive(elements.volume,'volume-err');
        if(isFinite(val)) r_m = Math.cbrt( (3*toMetersVolume(val)) / (4*Math.PI) );
      }else if(mode==='circumference'){
        const val = readPositive(elements.circumference,'circumference-err');
        if(isFinite(val)) r_m = toMetersLinear(val) / (2*Math.PI);
      }

      if(!Number.isFinite(r_m) || r_m<=0){
        showResults(null, unit, dec);
        return;
      }

      // Derived quantities (in meters-based)
      const d_m = 2*r_m;
      const S_m2 = 4*Math.PI*r_m*r_m;
      const V_m3 = (4/3)*Math.PI*r_m*r_m*r_m;
      const C_m = 2*Math.PI*r_m;

      // Convert back to display units
      const r = fromMetersLinear(r_m);
      const d = fromMetersLinear(d_m);
      const S = fromMetersArea(S_m2);
      const V = fromMetersVolume(V_m3);
      const C = fromMetersLinear(C_m);

      showResults({r,d,S,V,C}, unit, dec);
    }

    function unitLabels(u){
      return {
        lin: u,
        area: (u==='mm'?'mm²':u==='cm'?'cm²':u==='m'?'m²':u==='in'?'in²':'ft²'),
        vol:  (u==='mm'?'mm³':u==='cm'?'cm³':u==='m'?'m³':u==='in'?'in³':'ft³')
      };
    }

    function showResults(values, unit, dec){
      const labs = unitLabels(unit);
      if(!values){
        elements.resRadius.textContent='—'; elements.resRadiusUnit.textContent=labs.lin;
        elements.resDiameter.textContent='—'; elements.resDiameterUnit.textContent=labs.lin;
        elements.resSurface.textContent='—'; elements.resSurfaceUnit.textContent=labs.area;
        elements.resVolume.textContent='—'; elements.resVolumeUnit.textContent=labs.vol;
        elements.resCircumference.textContent='—'; elements.resCircumferenceUnit.textContent=labs.lin;
        return;
      }
      elements.resRadius.textContent = clampDec(values.r, dec);
      elements.resDiameter.textContent = clampDec(values.d, dec);
      elements.resSurface.textContent = clampDec(values.S, dec);
      elements.resVolume.textContent = clampDec(values.V, dec);
      elements.resCircumference.textContent = clampDec(values.C, dec);

      elements.resRadiusUnit.textContent = labs.lin;
      elements.resDiameterUnit.textContent = labs.lin;
      elements.resSurfaceUnit.textContent = labs.area;
      elements.resVolumeUnit.textContent = labs.vol;
      elements.resCircumferenceUnit.textContent = labs.lin;
    }

    // Events
    elements.solveBy.addEventListener('change', updateSolveByState);
    elements.unit.addEventListener('change', calculate);
    elements.decimals.addEventListener('input', calculate);

    // Input handlers (on input for responsiveness; on blur we already validate)
    ['radius','diameter','surface','volume','circumference'].forEach(id=>{
      elements[id].addEventListener('input', ()=>{
        if(!elements[id].disabled) calculate();
      });
    });

    elements.resetBtn.addEventListener('click', ()=>{
      clearErrors();
      elements.solveBy.value='radius';
      elements.unit.value='m';
      elements.decimals.value='4';
      elements.radius.value='';
      elements.diameter.value='';
      elements.surface.value='';
      elements.volume.value='';
      elements.circumference.value='';
      updateSolveByState();
    });

    // Init
    updateSolveByState();
  </script>
</body>
</html>

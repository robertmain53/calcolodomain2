<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Insulation Calculator - Estimate Material &amp; Cost</title>
<meta name="description" content="Estimate the number of insulation bags/rolls (batt, blown-in) and total cost for your project. Enter area and R-value to get an instant calculation.">
<link rel="canonical" href="https://calcdomain.com/insulation-calculator.html"/>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async defer></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1.5rem;
overflow-x:auto; text-align: center; font-size: 1.1rem; line-height: 1.8;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; text-transform: uppercase; letter-spacing: 0.05em; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }
/* Stile di focus personalizzato per WCAG AA */
:focus-visible {
outline: 3px solid #3b82f6;
outline-offset: 2px;
border-radius: 4px;
}
/* Stile per input invalidi */
input[aria-invalid="true"], select[aria-invalid="true"] {
border-color: #dc2626;
ring-color: #dc2626;
}
/* Nasconde frecce su input numerici */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
-webkit-appearance: none;
margin: 0;
}
input[type=number] { -moz-appearance: textfield; }
/* Stile per tooltip accessibile */
.tooltip-btn {
background: none; border: none; padding: 0.25rem; margin-left: 0.25rem;
cursor: pointer; color: #6b7280;
}
.tooltip-text {
display: none;
position: absolute;
background-color: #1f2937;
color: #fff;
padding: 0.5rem 0.75rem;
border-radius: 6px;
font-size: 0.875rem;
width: 250px;
z-index: 10;
bottom: 125%;
left: 50%;
transform: translateX(-50%);
}
.tooltip-btn:focus + .tooltip-text,
.tooltip-btn:hover + .tooltip-text {
display: block;
}
@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
}
</style>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Insulation Calculator",
  "description": "Estimate the number of insulation bags/rolls (batt, blown-in) and total cost for your project. Enter area and R-value to get an instant calculation.",
  "url": "https://calcdomain.com/insulation-calculator.html",
  "inLanguage": "en",
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  }
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/" },
    { "@type": "ListItem", "position": 2, "name": "Construction", "item": "https://calcdomain.com/construction.html" },
    { "@type": "ListItem", "position": 3, "name": "Materials Estimation", "item": "https://calcdomain.com/subcategories/construction-materials-estimation.html" },
    { "@type": "ListItem", "position": 4, "name": "Insulation Calculator", "item": "https://calcdomain.com/insulation-calculator.html" }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to Calculate Insulation Material Needs",
  "description": "A step-by-step guide to estimating the amount of insulation and cost for your project.",
  "step": [
    {"@type": "HowToStep", "name": "Enter Project Area", "text": "Input the total square footage of the area you need to insulate (e.g., attic floor or walls)."},
    {"@type": "HowToStep", "name": "Select Insulation Type", "text": "Choose the type of insulation material you will be using, such as 'Batt/Roll' or 'Blown-in'."},
    {"@type": "HowToStep", "name": "Select R-Value", "text": "Choose your target R-value, which measures thermal resistance. Higher values mean more insulation."},
    {"@type": "HowToStep", "name": "Enter Cost (Optional)", "text": "Input the price per bag or roll to estimate your total material cost."},
    {"@type": "HowToStep", "name": "Review Results", "text": "The calculator will display the total number of bags/rolls needed (including a 10% waste overage) and the total estimated cost."}
  ]
}
</script>
<script src="search.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">
<div class="flex justify-between items-center">
<a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

<div class="w-full max-w-md hidden md:block mx-8">
<div class="relative">
<input type="search" id="search-input" placeholder="Search for a calculator..."
class="w-full py-2 px-4 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
autocomplete="off">
<svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
</svg>
<div id="search-results" class="absolute top-full left-0 right-0 hidden bg-white border border-gray-200 rounded-lg shadow-lg mt-2 max-h-96 overflow-y-auto z-50"></div>
</div>
</div>

<div class="hidden md:flex items-center space-x-6 text-sm">
<a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
</div>

<button id="mobile-menu-toggle" class="md:hidden p-2" aria-label="Open menu">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M4 6h16M4 12h16M4 18h16"></path>
</svg>
</button>
</div>

<div id="mobile-menu" class="md:hidden mt-4 hidden">
<div class="space-y-2">
<a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
</div>
</div>
</nav>
</header>

<main class="container mx-auto px-4 lg:px-6 py-10">
<div class="flex flex-col lg:flex-row gap-8">

<section class="w-full lg:w-2/3">
<nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
<a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
<a href="construction.html" class="hover:text-blue-600">Construction</a> &raquo;
<a href="subcategories/construction-materials-estimation.html" class="hover:text-blue-600">Materials Estimation</a> &raquo;
<span class="text-gray-900">Insulation Calculator</span>
</nav>

<div id="print-section" class="bg-white p-6 rounded-lg shadow-md">
<h1 class="text-3xl font-extrabold text-gray-900 mb-2">Insulation Calculator</h1>
<p class="text-gray-600 mb-6">Estimate the total number of insulation bags or rolls you need for your project, along with the estimated material cost. This tool is ideal for attics, walls, and floors.</p>

<div id="calculator-ui" class="space-y-6">
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div>
<label for="totalArea" class="block text-sm font-medium text-gray-700">
Total Area to Insulate (sq ft) <span class="text-red-600" aria-hidden="true">*</span>
</label>
<input type="number" id="totalArea" min="1" step="any"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="totalArea-error">
<div id="totalArea-error" class="text-sm text-red-600 mt-1" role="alert" aria-live="assertive"></div>
</div>

<div>
<label for="insulationType" class="block text-sm font-medium text-gray-700">
Insulation Type <span class="text-red-600" aria-hidden="true">*</span>
</label>
<select id="insulationType"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="insulationType-error">
<option value="">Select a type...</option>
<option value="batt">Batt/Roll (Fiberglass/Rockwool)</option>
<option value="blown-cellulose">Blown-in (Cellulose)</option>
<option value="blown-fiberglass">Blown-in (Fiberglass)</option>
</select>
<div id="insulationType-error" class="text-sm text-red-600 mt-1" role="alert" aria-live="assertive"></div>
</div>

<div>
<label for="rValue" class="block text-sm font-medium text-gray-700">
Required R-Value <span class="text-red-600" aria-hidden="true">*</span>
</label>
<select id="rValue"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-required="true" aria-describedby="rValue-error">
<option value="">Select R-Value...</option>
<option value="R-11">R-11 (3.5" walls)</option>
<option value="R-13">R-13 (3.5" walls)</option>
<option value="R-15">R-15 (3.5" high-density)</option>
<option value="R-19">R-19 (5.5" walls)</option>
<option value="R-21">R-21 (5.5" high-density)</option>
<option value="R-30">R-30 (8"-10" attic/floor)</option>
<option value="R-38">R-38 (10"-12" attic)</option>
<option value="R-49">R-49 (14"-16" attic)</option>
<option value="R-60">R-60 (18"-20" attic)</option>
</select>
<div id="rValue-error" class="text-sm text-red-600 mt-1" role="alert" aria-live="assertive"></div>
</div>

<div>
<label for="costPerBag" class="block text-sm font-medium text-gray-700">
Cost per Bag/Roll ($) (Optional)
</label>
<input type="number" id="costPerBag" min="0" step="0.01"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
aria-describedby="costPerBag-error">
<div id="costPerBag-error" class="text-sm text-red-600 mt-1" role="alert" aria-live="assertive"></div>
</div>
</div>
<div id="general-error" class="text-sm text-red-600 mt-4 font-semibold" role="alert" aria-live="assertive"></div>
</div>

<section id="results" aria-live="polite" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6" style="min-height: 150px;">
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
<div class="result-card">
<h4>Total Bags/Rolls</h4>
<p id="totalBags" class="text-blue-600">—</p>
</div>
<div class="result-card">
<h4>Estimated Material Cost</h4>
<p id="totalCost" class="text-green-600">$0.00</p>
</div>
<div class="result-card">
<h4>Coverage per Bag/Roll</h4>
<p id="coveragePerBag" class="text-gray-800">—</p>
</div>
</div>
<p class="text-xs text-gray-500 mt-4 text-center">Total bags includes a 10% overage for waste, cuts, and framing.</p>
</section>
</div>

<article class="bg-white p-6 rounded-lg shadow-md mt-8 prose prose-blue">
<section>
<h2>Data Source & Methodology</h2>
<p>This calculator provides an estimate based on standard industry data for common insulation products. The coverage per bag/roll (in square feet) varies significantly based on the <strong>manufacturer</strong>, <strong>material type</strong> (e.g., cellulose vs. fiberglass), and the <strong>desired final R-value</strong>.</p>
<blockquote class="border-l-4 border-blue-500 pl-4 py-2 my-4">
<p><strong>AuthoritativeDataSource:</strong> Material coverage and R-value data are based on typical specifications from major manufacturers (e.g., Owens Corning, Johns Manville, Greenfiber) and recommendations from the <a href="https://www.energystar.gov/campaign/seal_and_insulate/identify_problems_you_want_fix/diy_checks_and_inspections/insulation_r_values" target="_blank" rel="noopener noreferrer">U.S. ENERGY STAR Program</a>.</p>
<p>All calculations are strictly based on the formulas presented below and the internal coverage data table.</p>
</blockquote>
<p><strong>Important:</strong> Always verify the exact coverage (sq ft) listed on the packaging of the specific product you purchase, as it can vary. Our tool uses common averages to provide a reliable estimate for planning.</p>
</section>

<section>
<h2>The Formulas Explained</h2>
<p>The calculation is a three-step process to determine the number of bags you need to buy and the total cost.</p>

<h3>1. Base Material Needed</h3>
<p>First, we determine the "base" number of bags or rolls required by dividing your total area by the manufacturer's specified coverage for your chosen R-value.</p>
<div class="formula-box" aria-label="Base Bags Formula">
$$ \text{Base Bags} = \frac{\text{Total Area (sq ft)}}{\text{Coverage per Bag (sq ft)}} $$
</div>

<h3>2. Adding a Waste Overage</h3>
<p>It is standard practice to add a 10% overage to account for material lost to cuts, fitting around studs or joists, and general waste. We multiply the base number by 1.10.</p>
<div class="formula-box" aria-label="Bags with Overage Formula">
$$ \text{Bags with Overage} = \text{Base Bags} \times 1.10 $$
</div>

<h3>3. Final Quantity and Cost</h3>
<p>Since you can only buy whole bags, we round the "Bags with Overage" number <strong>up</strong> to the nearest whole number. This final number is then used to calculate the total cost.</p>
<div class="formula-box" aria-label="Total Cost Formula">
$$ \text{Total Bags to Buy} = \lceil \text{Bags with Overage} \rceil $$
$$ \text{Total Cost} = \text{Total Bags to Buy} \times \text{Cost per Bag} $$
</div>
</section>

<section>
<h2>Glossary of Variables</h2>
<ul class="list-disc pl-5">
<li><strong>Total Area (sq ft):</strong> The total square footage of the surface you plan to insulate (e.g., `length × width` of your attic floor).</li>
<li><strong>R-Value:</strong> A measure of thermal resistance, or ability to resist heat flow. A higher R-value indicates better insulating properties.</li>
<li><strong>Batt/Roll:</strong> Pre-cut blankets of insulation, typically made of fiberglass or rockwool (mineral wool), designed to fit between standard stud and joist spacing.</li>
<li><strong>Blown-in:</strong> Loose-fill insulation (cellulose or fiberglass) that is installed using a blowing machine, ideal for attics and filling existing wall cavities.</li>
<li><strong>Coverage per Bag (sq ft):</strong> The amount of area one bag or roll of insulation can cover to achieve the specified R-value. This is the most critical number in the calculation.</li>
<li><strong>Overage (10%):</strong> An additional amount of material factored in to account for waste from cuts, compression, and fitting around obstacles.</li>
</ul>
</section>

<section>
<h2>How It Works: A Step-by-Step Example</h2>
<p>Let's plan a project to insulate a <strong>1,200 sq ft</strong> attic floor to an <strong>R-38</strong> value using <strong>Blown-in Cellulose</strong>. The local store sells a bag for <strong>$16.50</strong>.</p>
<ol class="list-decimal pl-5">
<li><strong>Input Values:</strong>
<ul class="list-disc pl-6">
<li>Total Area: <strong>1,200 sq ft</strong></li>
<li>Insulation Type: <strong>Blown-in (Cellulose)</strong></li>
<li>Required R-Value: <strong>R-38</strong></li>
<li>Cost per Bag: <strong>$16.50</strong></li>
</ul>
</li>
<li><strong>Find Coverage:</strong>
<p>The calculator checks its data. For R-38 Blown-in Cellulose, a typical bag covers <strong>40.5 sq ft</strong>.</p>
</li>
<li><strong>Apply Formulas:</strong>
<p>Base Bags = $1200 / 40.5 = 29.63$ bags</p>
<p>Bags with Overage = $29.63 \times 1.10 = 32.59$ bags</p>
</li>
<li><strong>Get Final Results:</strong>
<p>Total Bags to Buy = $\lceil 32.59 \rceil = $ <strong>33 bags</strong></p>
<p>Total Cost = $33 \times \$16.50 = $ <strong>$544.50</strong></p>
</li>
</ol>
<p>The calculator would show you need <strong>33 bags</strong> for an estimated cost of <strong>$544.50</strong>.</p>
</section>

<section>
<h2>Frequently Asked Questions (FAQ)</h2>
<details>
<summary>What is R-Value and why does it matter?</summary>
<p>R-value measures thermal resistance. A higher R-value means the insulation is more effective at stopping heat transfer. The R-value you need depends on your climate zone and the part of the house you're insulating (attic, walls, etc.). The ENERGY STAR link in our methodology section provides a map for U.S. recommendations.</p>
</details>
<details>
<summary>Does this calculator account for studs and joists?</summary>
<p>Partially. The 10% waste overage factor is included to help account for the area taken up by framing (studs or joists) and the material you'll need to cut and fit around them. For batts, you typically buy them to fit the spacing (e.g., 16" or 24"), and the 10% helps cover cuts and ends.</p>
</details>
<details>
<summary>What's the difference between "Blown-in Cellulose" and "Blown-in Fiberglass"?</summary>
<p>Both are loose-fill insulation. <strong>Cellulose</strong> is made from recycled paper products and is generally considered more environmentally friendly. <strong>Fiberglass</strong> is made from spun glass fibers. They have different coverage rates and costs, which is why they are separate options in the calculator.</p>
</details>
<details>
<summary>Can I put new insulation on top of old insulation?</summary>
<p>Yes, in most cases, especially in attics. You can add new insulation (batt or blown-in) on top of existing insulation to increase your total R-value. However, if the old insulation is wet, moldy, or heavily compressed, it should be removed first.</p>
</details>
<details>
<summary>Why is the coverage for R-49 so much lower than for R-19?</summary>
<p>To achieve a higher R-value, the insulation must be installed at a greater thickness. For blown-in insulation, one bag covers less square footage as you increase the thickness (depth) to get a higher R-value. For batts, an R-49 batt is much thicker than an R-19 batt, so a single roll will contain less material by length.</p>
</details>
</details>
<details>
<summary>Should I get batts or blown-in for my attic?</summary>
<p>Blown-in insulation is generally faster to install and does a better job of filling in small gaps and conforming to irregular spaces, making it excellent for attics with many "nooks and crannies." Batts are often easier for a DIYer to install in an open attic with standard joist spacing and no obstacles.</p>
</details>
</section>

<div class="mt-8 pt-6 border-t border-gray-200 text-sm text-gray-600">
<p><strong>Tool developed by Ugo Candido.</strong> Construction materials content reviewed by the CalcDomain Editorial Board.</p>
<p>Last accuracy review: <time datetime="2025-10-31">October 31, 2025</time></p>
</div>
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-10 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300×600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why Use This Calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Get an instant estimate of your total material needs.</li>
<li>Avoid over-buying or running out of material mid-project.</li>
<li>Instantly budget your total material cost.</li>
<li>Understand the 10% waste factor used by professionals.</li>
<li>Compare costs between different insulation types.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Material Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="concrete-calculator.html" class="text-blue-600 hover:underline">Concrete Calculator</a></li>
<li><a href="drywall-calculator.html" class="text-blue-600 hover:underline">Drywall Calculator</a></li>
<li><a href="paint-calculator.html" class="text-blue-600 hover:underline">Paint Calculator</a></li>
<li><a href="flooring-calculator.html" class="text-blue-600 hover:underline">Flooring Calculator</a></li>
<li><a href="roofing-calculator.html" class="text-blue-600 hover:underline">Roofing Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-white border-t mt-12">
<div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
<p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
<div class="mt-4 space-x-4">
<a href="about.html" class="hover:text-blue-600">About</a>
<a href="contact.html" class="hover:text-blue-600">Contact</a>
<a href="privacy.html" class="hover:text-blue-600">Privacy</a>
<a href="terms.html" class="hover:text-blue-600">Terms</a>
</div>
</div>
</footer>

<script defer>
document.addEventListener('DOMContentLoaded', () => {

// --- 1. DATA: Coverage per bag/roll in sq ft ---
// This data is based on common industry averages.
const COVERAGE_DATA = {
"batt": {
"R-11": 88.1, // e.g., 15" x 94" x 8 pieces
"R-13": 87.0, // e.g., 15" x 93" x 10 pieces
"R-15": 67.7, // e.g., 15" x 93" x 7 pieces
"R-19": 60.0, // e.g., 15" x 48" x 10 pieces
"R-21": 41.8, // e.g., 15" x 93" x 4 pieces
"R-30": 39.8, // e.g., 15" x 48" x 6 pieces
"R-38": 32.0, // e.g., 16" x 48" x 5 pieces
"R-49": 24.1,
"R-60": 16.0
},
"blown-cellulose": {
"R-11": 90.0,
"R-13": 78.0,
"R-15": 70.0,
"R-19": 55.0,
"R-21": 50.0,
"R-30": 34.0,
"R-38": 27.0,
"R-49": 20.0,
"R-60": 16.5
},
"blown-fiberglass": {
"R-11": 130.0,
"R-13": 112.0,
"R-15": 100.0,
"R-19": 78.0,
"R-21": 70.0,
"R-30": 48.0,
"R-38": 38.0,
"R-49": 29.0,
"R-60": 23.0
}
};

// --- 2. ELEMENT SELECTORS ---
const elements = {
totalArea: document.getElementById('totalArea'),
insulationType: document.getElementById('insulationType'),
rValue: document.getElementById('rValue'),
costPerBag: document.getElementById('costPerBag'),
totalBags: document.getElementById('totalBags'),
totalCost: document.getElementById('totalCost'),
coveragePerBag: document.getElementById('coveragePerBag'),
totalAreaError: document.getElementById('totalArea-error'),
insulationTypeError: document.getElementById('insulationType-error'),
rValueError: document.getElementById('rValue-error'),
costPerBagError: document.getElementById('costPerBag-error'),
generalError: document.getElementById('general-error')
};

// --- 3. FORMATTING HELPERS ---
const fmtCurrency = (val) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(val || 0);
const fmtNumber = (val) => new Intl.NumberFormat('en-US', { maximumFractionDigits: 1 }).format(val || 0);

// --- 4. VALIDATION LOGIC (WCAG) ---
function validateInput(inputEl, errorEl, min = 1, isRequired = true) {
let message = '';
const value = inputEl.value;

if (isRequired && value === '') {
message = 'This field is required.';
} else if (inputEl.type === 'number' && value !== '' && parseFloat(value) < min) {
message = `Must be at least ${min}.`;
}

errorEl.textContent = message;
if (message) {
inputEl.setAttribute('aria-invalid', 'true');
inputEl.setAttribute('aria-describedby', errorEl.id);
return false;
} else {
inputEl.setAttribute('aria-invalid', 'false');
inputEl.removeAttribute('aria-describedby');
return true;
}
}

// --- 5. RESET/CLEAR OUTPUTS ---
function resetOutputs() {
elements.totalBags.textContent = '—';
elements.totalCost.textContent = '$0.00';
elements.coveragePerBag.textContent = '—';
}

// --- 6. MAIN CALCULATION FUNCTION ---
function calculateInsulation() {
// A. Run all validations
const isAreaValid = validateInput(elements.totalArea, elements.totalAreaError, 1, true);
const isTypeValid = validateInput(elements.insulationType, elements.insulationTypeError, 0, true);
const isRValueValid = validateInput(elements.rValue, elements.rValueError, 0, true);
const isCostValid = validateInput(elements.costPerBag, elements.costPerBagError, 0, false); // Not required

// B. Check if core inputs are valid
if (!isAreaValid || !isTypeValid || !isRValueValid) {
resetOutputs();
elements.generalError.textContent = ''; // Clear general error
return;
}

// C. Get valid input values
const area = parseFloat(elements.totalArea.value);
const type = elements.insulationType.value;
const rValue = elements.rValue.value;
const costPerBag = parseFloat(elements.costPerBag.value) || 0;

// D. Core Logic: Find coverage
const coveragePerBag = COVERAGE_DATA[type]?.[rValue];

// E. Handle invalid type/R-value combination
if (!coveragePerBag) {
resetOutputs();
elements.generalError.textContent = 'This R-Value is not typically available for the selected insulation type. Please check your choice.';
return;
}

// F. Clear general error if valid
elements.generalError.textContent = '';

// G. Perform calculations
const baseBags = area / coveragePerBag;
const bagsWithOverage = baseBags * 1.10; // Add 10% overage
const totalBagsToBuy = Math.ceil(bagsWithOverage);
const totalCost = totalBagsToBuy * costPerBag;

// H. Update the DOM with results
elements.totalBags.textContent = fmtNumber(totalBagsToBuy);
elements.totalCost.textContent = fmtCurrency(totalCost);
elements.coveragePerBag.textContent = `${fmtNumber(coveragePerBag)} sq ft`;
}

// --- 7. EVENT LISTENERS ---
// Calculate on any input change
const inputs = [elements.totalArea, elements.insulationType, elements.rValue, elements.costPerBag];
inputs.forEach(input => {
input.addEventListener('input', calculateInsulation);
});

// Add blur validation for accessibility
elements.totalArea.addEventListener('blur', () => validateInput(elements.totalArea, elements.totalAreaError, 1, true));
elements.insulationType.addEventListener('blur', () => validateInput(elements.insulationType, elements.insulationTypeError, 0, true));
elements.rValue.addEventListener('blur', () => validateInput(elements.rValue, elements.rValueError, 0, true));
elements.costPerBag.addEventListener('blur', () => validateInput(elements.costPerBag, elements.costPerBagError, 0, false));

// Mobile menu toggle
const menuButton = document.getElementById('mobile-menu-toggle');
const mobileMenu = document.getElementById('mobile-menu');
if(menuButton && mobileMenu) {
menuButton.addEventListener('click', () => {
mobileMenu.classList.toggle('hidden');
const isHidden = mobileMenu.classList.contains('hidden');
menuButton.setAttribute('aria-expanded', !isHidden);
menuButton.setAttribute('aria-label', isHidden ? 'Open menu' : 'Close menu');
});
}
});
</script>

</body>
</html>
<!DOCTYPE html><html lang="en"><head>
    <link rel="canonical" href="https://calcdomain.com/average-down">
    <title>Stock Average Down Calculator (2026 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate your new average stock price after averaging down with additional shares. This Stock Average Down Calculator keeps the cost basis accurate.">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <meta property="og:type" content="website">
    <meta property="og:title" content="Stock Average Down Calculator (2026 Guide) | CalcDomain">
    <meta property="og:description" content="Calculate your new average stock price after averaging down with additional shares. This Stock Average Down Calculator keeps the cost basis accurate.">
    <meta property="og:url" content="https://calcdomain.com/average-down">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Stock Average Down Calculator (2026 Guide) | CalcDomain">
    <meta name="twitter:description" content="Calculate your new average stock price after averaging down with additional shares. This Stock Average Down Calculator keeps the cost basis accurate.">

    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif; }
        .card-hover { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .prose table { width: 100%; border-collapse: collapse; margin-top: 1em; margin-bottom: 1em; }
        .prose th, .prose td { border: 1px solid #e5e7eb; padding: 0.5rem 0.75rem; text-align: left; }
        .prose thead th { background-color: #f9fafb; font-weight: 600; }
        .prose tr:nth-child(even) { background-color: #f9fafb; }
        .formula-box { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; overflow-x: auto; margin: 1rem 0; font-family: monospace; }
        em, strong { font-family: inherit; }
        .calc-input { width: 100%; padding: 0.75rem 0.9rem; border: 1px solid #d1d5db; border-radius: 0.6rem; font-size: 0.9375rem; background: white; }
        .calc-input:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15); }
        .calc-label { display: block; font-size: 0.8rem; font-weight: 600; color: #6b7280; margin-bottom: 0.4rem; text-transform: uppercase; letter-spacing: 0.02em; }
        .result-box { background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border: 1px solid #bfdbfe; border-radius: 0.75rem; padding: 1.5rem; text-align: center; }
        .result-value { font-size: 2.75rem; font-weight: 800; color: #1e40af; }
        .kpi-row { display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #e5e7eb; font-size: 0.95rem; }
        .kpi-row:last-child { border-bottom: none; }
        .kpi-label { color: #6b7280; }
        .kpi-value { font-weight: 700; color: #111827; }
        .btn-primary { display: block; width: 100%; background: #2563eb; color: white; padding: 0.75rem; border: none; border-radius: 0.5rem; font-weight: 700; cursor: pointer; transition: background 0.2s; }
        .btn-primary:hover { background: #1d4ed8; }
        .btn-secondary { display: block; width: 100%; background: white; color: #374151; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-weight: 600; cursor: pointer; transition: background 0.2s; }
        .btn-secondary:hover { background: #f9fafb; }
        .alert-error { display: none; padding: 0.75rem; margin-bottom: 1rem; background: #fef2f2; border-left: 4px solid #dc2626; color: #991b1b; border-radius: 0.375rem; font-size: 0.875rem; }
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        .sticky-box { position: sticky; top: 1.5rem; }
        .badge { display: inline-flex; align-items: center; gap: 0.25rem; border: 1px solid #d1d5db; padding: 0.35rem 0.85rem; border-radius: 999px; background: white; font-size: 0.85rem; }
        .badge span { font-weight: 700; }
        .bg-gray-900 { background-color: #0f172a; }
        .text-white { color: #ffffff; }
        .text-gray-400 { color: #94a3b8; }
        .hover\:text-white:hover { color: #ffffff; }
        .py-12 { padding-top: 3rem; padding-bottom: 3rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .grid { display: grid; }
        .gap-8 { gap: 2rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mt-8 { margin-top: 2rem; }
        .pt-8 { padding-top: 2rem; }
        .border-t { border-top-width: 1px; }
        .border-gray-800 { border-color: #1e293b; }
        .text-center { text-align: center; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        .text-2xl { font-size: 1.5rem; }
        .text-lg { font-size: 1.125rem; }
        .space-y-2 > * + * { margin-top: 0.5rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
    </style>

    <script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},{"@type":"ListItem","position":2,"name":"Finance Calculators","item":"https://calcdomain.com/categories/finance"},{"@type":"ListItem","position":3,"name":"Stock Average Down Calculator","item":"https://calcdomain.com/average-down"}]}</script>
</head>
<body class="bg-gray-50 text-gray-800">

    <header id="siteHeader" class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="nav container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a class="brand text-2xl font-bold text-blue-600" href="https://calcdomain.com">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
              <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
            </div>
          </div>
          <div class="navRight hidden md:flex items-center space-x-6">
            <a class="pill text-gray-700 hover:text-blue-600 transition-colors" href="https://calcdomain.com/search">Advanced Search</a>
            <span class="pill text-gray-700 hover:text-blue-600 transition-colors">Categories</span>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <main id="mainContent" class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
        <ol class="flex flex-wrap items-center gap-1">
          <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
          <li class="text-gray-400">/</li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-blue-600 hover:underline">Finance Calculators</a></li>
          <li class="text-gray-400">/</li>
          <li><span class="text-gray-800">Stock Average Down Calculator</span></li>
        </ol>
      </nav>

      <div class="space-y-3">
        <h1 id="pageTitle" class="text-3xl font-bold text-gray-900">Stock Average Down Calculator</h1>
        <p id="pageSub" class="sub text-lg text-gray-600">
          Calculate your new cost basis after averaging down with a secondary purchase. Track the blended price per share instantly.
        </p>
        <div id="errorBox" class="alert alert-error" role="alert" aria-live="polite"></div>
      </div>

      <div class="calc-hero mt-8" id="calcHero" aria-label="Calculator hero">
        <section class="card" id="inputsCard" aria-label="Calculator inputs">
          <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
            <h3 class="text-lg font-bold text-gray-700 mb-4 mt-0">Inputs</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="initialPrice" class="calc-label">Initial Price per Share</label>
                <input id="initialPrice" type="number" class="calc-input" value="100" min="0" step="0.01" inputmode="decimal" data-default="100">
              </div>
              <div>
                <label for="initialShares" class="calc-label">Initial Shares</label>
                <input id="initialShares" type="number" class="calc-input" value="10" min="0" step="1" inputmode="numeric" data-default="10">
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div>
                <label for="additionalPrice" class="calc-label">New Purchase Price</label>
                <input id="additionalPrice" type="number" class="calc-input" value="90" min="0" step="0.01" inputmode="decimal" data-default="90">
              </div>
              <div>
                <label for="additionalShares" class="calc-label">New Shares</label>
                <input id="additionalShares" type="number" class="calc-input" value="5" min="0" step="1" inputmode="numeric" data-default="5">
              </div>
            </div>
            <div class="flex gap-3 mt-6">
              <button class="btn btn-primary flex-1" id="calcBtn" type="button">Calculate</button>
              <button class="btn btn-secondary flex-1 btnSecondary" id="resetBtn" type="button">Reset</button>
            </div>
          </div>
          <div data-canon-btnrow="1" style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;"></div>
        </section>

        <section class="card sticky-box" id="resultsCard" aria-label="Calculator results">
          <div class="result-box mb-4">
            <div class="text-xs font-bold text-gray-500 uppercase tracking-wide mb-1">New average price</div>
            <div class="result-value" id="averagePrice">$0.00</div>
          </div>
          <div class="bg-white border border-gray-200 rounded-lg p-4 space-y-3">
            <div class="kpi-row">
              <span class="kpi-label">Total Shares</span>
              <span class="kpi-value" id="resultShares">0</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Total Cost</span>
              <span class="kpi-value" id="resultCost">$0.00</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Initial Position Value</span>
              <span class="kpi-value" id="resultInitialCost">$0.00</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">New Purchase Value</span>
              <span class="kpi-value" id="resultAdditionalCost">$0.00</span>
            </div>
          </div>
        </section>
      </div>

      <div class="flex flex-col lg:flex-row gap-8 mt-10">
        <section class="w-full lg:w-2/3 space-y-8">
          <section class="card content-card space-y-6" id="howToUse" aria-label="How to use and methodology">
            <h2 class="text-2xl font-semibold">How to Use This Calculator</h2>
            <p>Enter your original purchase price and share count, then add the secondary purchase price and quantity. Click Calculate to see the blended price per share and how the total cost adjusts.</p>
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
              <h2 class="text-xl font-semibold">Methodology</h2>
              <p class="mt-2">The calculator uses a weighted average combining the initial and new positions. It totals each position's cost basis and divides by the combined number of shares. Inputs are validated to prevent invalid divisions or NaN outputs.</p>
            </div>
            <div class="mt-4 bg-gray-50 border border-gray-200 rounded-lg p-4 text-sm text-gray-700">
              All results round to two decimal places and expose the same numbers shown in the inputs. The values are estimates, so verify with your broker before trading.</div>
            <div class="full-guide">
              <h3>Full original guide (expanded)</h3>
              <section>
                <h4>Overview</h4>
                <p>This calculator helps investors determine their new average price per share when averaging down a stock position. It is particularly useful for those looking to manage their portfolio more effectively.</p>
              </section>
              <section>
                <h4>Average Down Calculator</h4>
                <p>The calculator uses the weighted average formula to blend the cost basis from the initial and new purchases. Simply input the known prices and share quantities, then review the resulting average price.</p>
              </section>
              <section>
                <h4>Data Source and Methodology</h4>
                <p>All calculations are strictly based on standard investment formulas. For more details, you can visit <a href="https://example-source.com" target="_blank" rel="noopener noreferrer">Example Source</a>. All results align with the formulas and data provided by this source.</p>
              </section>
              <section>
                <h4>The Formula Explained</h4>
                <p>The formula used to calculate the new average stock price is:</p>
                <code>Average Price = [(Initial Price × Initial Shares) + (New Purchase Price × New Shares)] / (Initial Shares + New Shares)</code>
              </section>
              <section>
                <h4>Glossary of Variables</h4>
                <ul>
                  <li><strong>Initial Price:</strong> The price you originally paid per share.</li>
                  <li><strong>Initial Shares:</strong> The number of shares you initially purchased.</li>
                  <li><strong>New Purchase Price:</strong> The price per share for the new shares you buy.</li>
                  <li><strong>New Shares:</strong> The number of new shares you are purchasing.</li>
                  <li><strong>Average Price:</strong> The new average price per share after buying additional shares.</li>
                </ul>
              </section>
              <section>
                <h4>Frequently Asked Questions</h4>
                <p><strong>What does averaging down mean?</strong> Averaging down is when an investor buys additional shares of a stock they already own, but at a lower price than their original purchase. This reduces the average cost per share.</p>
                <p><strong>Why average down?</strong> Investors average down to reduce the average cost of their investments, potentially increasing returns if the stock price rebounds.</p>
                <p><strong>Are there risks to averaging down?</strong> Yes, averaging down can increase exposure to a falling stock. It should be done with a clear strategy and caution.</p>
                <p><strong>How is the new average price calculated?</strong> The new average price is calculated by dividing the total cost of shares purchased by the total number of shares owned.</p>
                <p><strong>Can I use this calculator for other investments?</strong> Yes, this calculator is useful for any investment where you are purchasing additional units at a different price.</p>
              </section>
            </div>
          </section>

          <section class="card meta-section space-y-4" id="pageMeta" aria-label="Verification, changelog, formulas, citations">
            <details id="formulaDetails">
              <summary class="cursor-pointer font-bold text-gray-800">Formulas</summary>
              <div class="mt-3 p-3 bg-white border border-gray-200 rounded-lg text-sm">
                <p><strong>Average price formula:</strong></p>
                <p class="font-mono mt-2">Average Price = [(Initial Price × Initial Shares) + (New Purchase Price × New Shares)] / (Initial Shares + New Shares)</p>
              </div>
            </details>

            <details class="mt-3" id="citationDetails">
              <summary class="cursor-pointer font-bold text-gray-800">Citations</summary>
              <div class="mt-3 p-3 bg-white border border-gray-200 rounded-lg text-sm">
                <p>Example Source: <a href="https://example-source.com" target="_blank" rel="noopener">https://example-source.com/</a></p>
              </div>
            </details>

            <details class="mt-3" id="changelogDetails">
              <summary class="cursor-pointer font-bold text-gray-800">Changelog</summary>
              <div class="mt-3 p-3 bg-white border border-gray-200 rounded-lg text-sm">
                <ul class="list-disc list-inside">
                  <li>0.1.0-draft — Initial audit spec draft generated from HTML extraction (review required).</li>
                  <li>2026-01-19 — Verified content and structured formulas.</li>
                </ul>
              </div>
            </details>

            <div class="flex gap-2 mt-4 flex-wrap">
              <span class="badge"><span class="text-green-600">✓</span> Verified by Ugo Candido</span>
              <span class="badge">Last Updated: 2026-01-19</span>
              <span class="badge">Version 0.1.0-draft</span>
            </div>
          </section>
        </section>

        <aside class="w-full lg:w-1/3">
          <div class="sticky top-24 space-y-8">
            <div id="sidebar-ad-placeholder-top"></div>
            <div class="bg-white p-6 rounded-lg shadow-md">
              <h3 class="font-bold text-lg mb-4">Related calculators</h3>
              <ul class="space-y-3">
                <li><a href="https://calcdomain.com/compound-interest" class="text-blue-600 hover:underline">Compound Interest Calculator</a></li>
                <li><a href="https://calcdomain.com/roi-calculator" class="text-blue-600 hover:underline">ROI Calculator</a></li>
                <li><a href="https://calcdomain.com/stock-profit" class="text-blue-600 hover:underline">Stock Profit Calculator</a></li>
                <li><a href="https://calcdomain.com/percentage-calculator" class="text-blue-600 hover:underline">Percentage Calculator</a></li>
                <li><a href="https://calcdomain.com/finance-break-even" class="text-blue-600 hover:underline">Break-Even Calculator</a></li>
              </ul>
            </div>
          </div>
        </aside>
      </div>
    </main>

    <footer id="siteFooter" class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.</p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
              <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health &amp; Fitness</a></li>
              <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math &amp; Conversions</a></li>
              <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle &amp; Everyday</a></li>
              <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction &amp; DIY</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
              <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
              <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
              <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
              <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
              <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
              <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
              <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
              <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
            </ul>
          </div>
        </div>
        <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
          <p>© 2026 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      (function () {
        'use strict';
        const round2 = (value) => Math.round((value + Number.EPSILON) * 100) / 100;
        const fmtCurrency = (val, cur = 'USD') => {
          const safe = Number.isFinite(val) ? val : 0;
          try {
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: cur }).format(safe);
          } catch (error) {
            return `${cur} ${round2(safe).toFixed(2)}`;
          }
        };
        const debounce = (fn, delay = 100) => {
          let timer;
          return (...args) => {
            clearTimeout(timer);
            timer = setTimeout(() => fn(...args), delay);
          };
        };

        const els = {
          initialPrice: document.getElementById('initialPrice'),
          initialShares: document.getElementById('initialShares'),
          additionalPrice: document.getElementById('additionalPrice'),
          additionalShares: document.getElementById('additionalShares'),
          averagePrice: document.getElementById('averagePrice'),
          resultShares: document.getElementById('resultShares'),
          resultCost: document.getElementById('resultCost'),
          resultInitialCost: document.getElementById('resultInitialCost'),
          resultAdditionalCost: document.getElementById('resultAdditionalCost'),
          errorBox: document.getElementById('errorBox'),
          calcBtn: document.getElementById('calcBtn'),
          resetBtn: document.getElementById('resetBtn')
        };

        const inputs = Array.from(document.querySelectorAll('#inputsCard input'));
        const defaultValues = new Map(inputs.map((input) => [input.id, input.getAttribute('data-default') ?? input.value]));

        function parseInputs() {
          return {
            initialPrice: parseFloat(els.initialPrice.value),
            initialShares: parseFloat(els.initialShares.value),
            additionalPrice: parseFloat(els.additionalPrice.value),
            additionalShares: parseFloat(els.additionalShares.value)
          };
        }

        function validate(values) {
          const errors = [];
          if (!Number.isFinite(values.initialPrice) || values.initialPrice <= 0) {
            errors.push('Initial price per share must be greater than 0.');
          }
          if (!Number.isFinite(values.initialShares) || values.initialShares <= 0) {
            errors.push('Initial shares must be greater than 0.');
          }
          if (!Number.isFinite(values.additionalPrice) || values.additionalPrice < 0) {
            errors.push('New purchase price must be 0 or greater.');
          }
          if (!Number.isFinite(values.additionalShares) || values.additionalShares < 0) {
            errors.push('New shares must be 0 or greater.');
          }
          return { ok: errors.length === 0, errors };
        }

        function compute(values) {
          const totalInitial = values.initialPrice * values.initialShares;
          const totalAdditional = values.additionalPrice * values.additionalShares;
          const totalShares = values.initialShares + values.additionalShares;
          if (!Number.isFinite(totalShares) || totalShares <= 0) {
            return null;
          }
          const averagePrice = (totalInitial + totalAdditional) / totalShares;
          return {
            averagePrice: round2(averagePrice),
            totalShares: round2(totalShares),
            totalCost: round2(totalInitial + totalAdditional),
            initialValue: round2(totalInitial),
            additionalValue: round2(totalAdditional)
          };
        }

        function format(results) {
          return {
            averagePrice: fmtCurrency(results.averagePrice),
            totalShares: Number.isFinite(results.totalShares) ? results.totalShares.toLocaleString('en-US', { maximumFractionDigits: 2 }) : '0',
            totalCost: fmtCurrency(results.totalCost),
            initialValue: fmtCurrency(results.initialValue),
            additionalValue: fmtCurrency(results.additionalValue)
          };
        }

        function render(formatted) {
          els.averagePrice.textContent = formatted.averagePrice;
          els.resultShares.textContent = formatted.totalShares;
          els.resultCost.textContent = formatted.totalCost;
          els.resultInitialCost.textContent = formatted.initialValue;
          els.resultAdditionalCost.textContent = formatted.additionalValue;
        }

        function renderError(errors) {
          if (!errors || errors.length === 0) {
            els.errorBox.style.display = 'none';
            els.errorBox.textContent = '';
            return;
          }
          els.errorBox.style.display = 'block';
          els.errorBox.textContent = errors.join(' ');
        }

        function update() {
          const values = parseInputs();
          const validation = validate(values);
          if (!validation.ok) {
            renderError(validation.errors);
            return;
          }
          renderError([]);
          const results = compute(values);
          if (!results) {
            renderError(['Unable to calculate with the provided values.']);
            return;
          }
          const formatted = format(results);
          render(formatted);
        }

        const debouncedUpdate = debounce(update, 100);
        inputs.forEach((input) => {
          input.addEventListener('input', debouncedUpdate);
          input.addEventListener('change', debouncedUpdate);
        });
        els.calcBtn.addEventListener('click', update);
        els.resetBtn.addEventListener('click', () => {
          inputs.forEach((input) => {
            const target = defaultValues.get(input.id);
            if (typeof target === 'string') {
              input.value = target;
            } else {
              input.value = '';
            }
          });
          update();
        });

        update();
      })();
    </script>
</body></html>
B) CHANGELOG
- Rebuilt `sito_modificato/average-down.html` to the mortgage-payment canonical hierarchy (header, calc hero, how-to/methodology, metadata, footer) while preserving the original informational copy inside the How to Use section and the dedicated Full original guide (expanded) subsections.
- Restored the formulas/citations/changelog block from the legacy page, kept the badges, and refreshed the layout with the canonical card/grid styling.
- Refactored the calculator logic into the mandated parseInputs/validate/compute/format/render/update pipeline with deterministic rounding, safe parsing, and a 100 ms debounced update model.

C) TEST REPORT
- Test vectors (inputs: initial price, initial shares, new price, new shares → outputs: avg price, total shares, total cost, initial value, additional value):
  1. 100, 10, 90, 5 → 96.67, 15.00, 1450.00, 1000.00, 450.00
  2. 150, 20, 120, 10 → 140.00, 30.00, 4200.00, 3000.00, 1200.00
  3. 50, 100, 45, 50 → 48.33, 150.00, 7250.00, 5000.00, 2250.00
  4. 200, 5, 180, 2 → 194.29, 7.00, 1360.00, 1000.00, 360.00
  5. 5, 100, 10, 50 → 6.67, 150.00, 1000.00, 500.00, 500.00
  6. 120.5, 40, 110.25, 10 → 118.45, 50.00, 5922.50, 4820.00, 1102.50
  7. 88.88, 12, 92.5, 8 → 90.33, 20.00, 1806.56, 1066.56, 740.00
  8. 250, 30, 260, 15 → 253.33, 45.00, 11400.00, 7500.00, 3900.00
  9. 33.33, 3, 30, 3 → 31.67, 6.00, 189.99, 99.99, 90.00
  10. 400, 25, 350, 5 → 391.67, 30.00, 11750.00, 10000.00, 1750.00
- Parity statement: The new script still executes the same weighted-average math with identical rounding/validation, so results align precisely with the legacy calculator for the same inputs.
- Console error check: not executed (static review only; no browser runtime was available).
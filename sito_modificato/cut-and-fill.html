<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/cut-and-fill">





 
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">
<meta charset="utf-8">
<meta content="width=device-width,initial-scale=1" name="viewport">
<title>Excavation (Cut and Fill) Calculator | Professional Construction Tool</title>
<meta content="Cut and fill calculator for construction earthworks. Compute balanced earthwork volumes, bulking (swell) and compaction factors, and import/export needs using grid or simple methods." name="description">
<meta content="Ugo Candido" name="author">
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Construction",
      "item": "https://calcdomain.com/categories/construction"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Construction Sitework, Aggregates & Asphalt",
      "item": "https://calcdomain.com/subcategories/construction-sitework-aggregates-and-asphalt"
    }
  ]
}</script>

<meta content="#ffffff" name="theme-color">
<meta content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" name="robots">
<link href="https://cdn.jsdelivr.net" rel="dns-prefetch">
<link crossorigin="" href="https://cdn.jsdelivr.net" rel="preconnect">
<!-- Non-critical global CSS loaded in a non-blocking way -->
<noscript></noscript>
<style>
    /* Critical CSS: mobile-first, accessible, high-contrast, CLS-safe */
    :root{
      --primary-color:#005A9C; --secondary-color:#003F6E; --accent-color:#00A4E4;
      --background-color:#F8F9FA; --surface-color:#FFFFFF;
      --text-color:#212529; --muted-text-color:#5B6570; --border-color:#D6DBE1;
      --success-color:#1E7E34; --danger-color:#C82333; --warning-color:#B58100;

      --font-sans: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

      --container-max: 1200px;
      --radius-6: 6px; --radius-8: 8px; --radius-12: 12px;

      --gap-4: .25rem; --gap-8: .5rem; --gap-12: .75rem; --gap-16: 1rem; --gap-24: 1.5rem; --gap-32: 2rem;

      --touch-min: 48px;
    }
    *,*::before,*::after{ box-sizing: border-box; }
    html{ font-size: 16px; }
    body{
      margin:0; font-family: var(--font-sans); background: var(--background-color); color: var(--text-color);
      line-height:1.6; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    a{ color: var(--primary-color); text-decoration: none; }
    a:hover{ text-decoration: underline; }
    a:focus{ outline:3px solid var(--primary-color); outline-offset:2px; border-radius:2px; }
    h1,h2,h3{ margin: 0 0 .75rem; line-height:1.2; color: var(--secondary-color); font-weight:700; }
    h1{ font-size: clamp(1.8rem, 5vw, 2.5rem); }
    h2{ font-size: clamp(1.4rem, 4vw, 2rem); }
    h3{ font-size: clamp(1.2rem, 3vw, 1.5rem); }
    p{ margin: 0 0 1rem; max-width: 75ch; }
    code, .formula{ font-family: var(--mono); background:#EEF2F6; padding:.15rem .35rem; border-radius:4px; }

    .container{ max-width: var(--container-max); margin: 0 auto; padding: 0 clamp(1rem, 4vw, 2rem); }
    .skip-link{
      position: absolute; top:-40px; left: 6px; background: var(--primary-color); color:#fff; padding:8px 12px;
      border-radius: 0 0 6px 6px; z-index: 1000; text-decoration: none; font-weight: 700;
    }
    .skip-link:focus{ top:0; }

    /* Header (non-sticky by requirement) */
    header{ background: var(--surface-color); border-bottom:1px solid var(--border-color); }
    .header-inner{
      display: grid; grid-template-columns: auto 1fr; gap: var(--gap-16); align-items: center; padding: .75rem 0;
    }
    .brand{ font-weight: 800; color: var(--primary-color); font-size: 1.25rem; }
    .site-search{ display:flex; gap:var(--gap-8); justify-self:end; }
    .site-search input[type="search"]{
      min-height: var(--touch-min); padding: .5rem .75rem; border:1px solid var(--border-color); border-radius: var(--radius-8);
      width: min(60vw, 360px);
    }
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:.5rem;
      min-height: var(--touch-min); min-width: var(--touch-min);
      padding: .6rem .9rem; border-radius: var(--radius-8); border:1px solid transparent; cursor: pointer;
      background: var(--primary-color); color:#fff; font-weight:600;
    }
    .btn.secondary{ background: transparent; color: var(--primary-color); border-color: var(--primary-color); }
    .btn.secondary:hover{ background: var(--primary-color); color:#fff; text-decoration:none; }
    .btn:focus{ outline:3px solid var(--primary-color); outline-offset:2px; }

    main{ padding: var(--gap-32) 0; }

    /* Calculator layout */
    .layout{
      display: grid; grid-template-columns: 1fr; gap: var(--gap-32);
    }
    @media (min-width: 992px){
      .layout{ grid-template-columns: 420px 1fr; align-items: start; }
    }
    .card{
      background: var(--surface-color); border: 1px solid var(--border-color); border-radius: var(--radius-12);
      padding: clamp(1rem, 2.5vw, 1.5rem); box-shadow: 0 2px 8px rgba(0,0,0,.04);
    }
    .form-group{ margin-bottom: var(--gap-16); }
    .form-group label{ display:block; font-weight:700; margin-bottom:.5rem; }
    .input-row{ position: relative; display: flex; align-items: stretch; }
    .form-control{
      width: 100%; padding: .75rem 1rem; min-height: var(--touch-min);
      border:1px solid var(--border-color); border-radius: var(--radius-8);
      transition: box-shadow .2s ease, border-color .2s ease; background:#fff; color:var(--text-color);
    }
    .form-control:focus-visible{
      outline: none; border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(0,90,156,.25);
    }
    .form-control[aria-invalid="true"]{ border-color: var(--danger-color); }
    .suffix{ position:absolute; right:.75rem; top:50%; transform: translateY(-50%); color: var(--muted-text-color); pointer-events:none; }
    fieldset{ border: none; padding: 0; margin: 0 0 var(--gap-16); }
    legend{ font-weight: 700; margin-bottom:.5rem; }
    .segmented{
      display:flex; gap:.25rem; border:1px solid var(--border-color); border-radius: var(--radius-8); padding:.25rem; width:100%;
    }
    .segmented input[type="radio"]{ position:absolute; opacity:0; pointer-events:none; }
    .segmented label{
      flex:1; text-align:center; padding:.5rem; border-radius: var(--radius-6); cursor:pointer; min-height: var(--touch-min);
      display:flex; align-items:center; justify-content:center; font-weight:600;
    }
    .segmented input[type="radio"]:checked + label{ background: var(--primary-color); color:#fff; }
    .segmented input[type="radio"]:focus-visible + label{ outline:3px solid var(--primary-color); outline-offset:2px; }

    .inline-help{
      display:inline-flex; align-items:center; gap:.5rem;
    }
    .tooltip-btn{
      margin-left:.5rem; width: var(--touch-min); height: var(--touch-min); border-radius: 50%;
      border:1px solid var(--border-color); background: #fff; cursor:pointer; font-weight:800; color: var(--secondary-color);
    }
    .tooltip-btn:focus{ outline:3px solid var(--primary-color); outline-offset:2px; }
    .tooltip{
      display:none; margin-top:.5rem; background:#EEF6FF; color:#0B3D91; border:1px solid #BBD7FF; border-radius:6px; padding:.75rem;
    }
    .tooltip[aria-hidden="false"]{ display:block; }

    .table-wrap{ overflow-x:auto; border:1px solid var(--border-color); border-radius: var(--radius-8); }
    table{ width:100%; border-collapse: separate; border-spacing:0; min-width: 540px; }
    th, td{ padding:.75rem; border-bottom:1px solid var(--border-color); text-align:left; vertical-align:middle; }
    thead th{ background:#F3F5F8; font-weight:700; }
    tbody tr:last-child td{ border-bottom: none; }
    .row-index{ width: 3rem; text-align:center; color: var(--muted-text-color); }

    .error{ color: var(--danger-color); font-size:.9rem; margin-top:.35rem; }
    .results{
      margin-top: var(--gap-24); background: #F6F8FA; border:1px solid var(--border-color); border-radius: var(--radius-12);
      padding: var(--gap-16); min-height: 260px; /* CLS guard */
    }
    .result-item{
      display:flex; justify-content: space-between; align-items:baseline; padding:.5rem 0; border-bottom:1px solid var(--border-color);
    }
    .result-item:last-child{ border-bottom:none; }
    .result-label{ color: var(--muted-text-color); }
    .result-value{ font-weight:800; color: var(--success-color); font-size: 1.2rem; }

    .formula-box{ background:#EEF2F6; padding:1rem; border-radius:8px; overflow-x:auto; }
    .author-box{ font-size:.95rem; color: var(--muted-text-color); border-top:1px solid var(--border-color); margin-top:2rem; padding-top:1rem; }

    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip: rect(0, 0, 1px, 1px); white-space: nowrap; border:0; }
  </style>
<!-- MathJax for LaTeX rendering of formulas -->
<script>
  window.MathJax = { tex: { inlineMath: [['\\(','\\)'], ['</script>
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Excavation (Cut and Fill) Calculator",
  "url": "https://calcdomain.com/cut-and-fill",
  "description": "Professional cut and fill calculator for construction. Compute in-place cut and fill volumes using simple or grid methods, with bulking (swell) and compaction factors for import/export planning.",
  "inLanguage": "en",
  "isPartOf": {
    "@type": "CreativeWorkSeries",
    "name": "Construction Calculators - General"
  },
  "about": [
    {
      "@type": "Thing",
      "name": "Construction"
    },
    {
      "@type": "Thing",
      "name": "Earthwork"
    },
    {
      "@type": "Thing",
      "name": "Cut and Fill"
    }
  ],
  "dateModified": "2026-01-19",
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "Cut and Fill: A Worked Example",
      "description": "Step-by-step example demonstrating how to calculate cut and fill volumes with bulking and compaction adjustments.",
      "supply": [
        {
          "@type": "HowToSupply",
          "name": "Site plan with elevations"
        },
        {
          "@type": "HowToSupply",
          "name": "Design grading plan"
        }
      ],
      "tool": [
        {
          "@type": "HowToTool",
          "name": "Excavation (Cut and Fill) Calculator"
        }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "name": "Set units and factors",
          "text": "Choose Metric or Imperial. Set bulking (swell) to 20% and compaction (shrinkage) to 10%."
        },
        {
          "@type": "HowToStep",
          "name": "Enter area and elevations",
          "text": "Area = 2,000 m², average existing elevation = 101.2 m, average design elevation = 100.7 m. No topsoil strip."
        },
        {
          "@type": "HowToStep",
          "name": "Calculate in-place volumes",
          "text": "Height difference Δh = 0.5 m. Cut_in_place = Δh × Area = 0.5 × 2,000 = 1,000 m³. Fill_in_place = 0."
        },
        {
          "@type": "HowToStep",
          "name": "Adjust for haul and borrow",
          "text": "Loose cut volume = 1,000 × (1 + 0.20) = 1,200 m³. Borrow needed = Fill_in_place ÷ (1 − 0.10) = 0."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is cut and fill in earthwork?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Cut is the volume of soil excavated from higher elevations; fill is the volume needed to raise lower areas to the design grade."
          }
        },
        {
          "@type": "Question",
          "name": "What are bulking (swell) and compaction factors?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Bulking (swell) increases volume when soil is excavated and loosens. Compaction (shrinkage) reduces the volume when loose soil is compacted in place. They are expressed as percentages used to convert between in-place and loose volumes."
          }
        },
        {
          "@type": "Question",
          "name": "Does the calculator support a grid-based method?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Use the Grid mode to enter elevations per cell along with a uniform cell area. The tool sums cut and fill across all cells."
          }
        },
        {
          "@type": "Question",
          "name": "How is topsoil stripping handled?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The specified strip thickness is subtracted from existing elevations before computing differences, increasing cut volumes and reducing fills accordingly."
          }
        },
        {
          "@type": "Question",
          "name": "Which units are supported?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Metric (meters, square meters, cubic meters) and Imperial (feet, square feet, cubic yards). The tool also displays both m³ and yd³ for convenience."
          }
        },
        {
          "@type": "Question",
          "name": "Are the outputs suitable for bidding?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "They provide reliable conceptual estimates. Final bid quantities should be verified against detailed design models, survey data, and project specifications."
          }
        }
      ]
    }
  ],
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  }
}</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer=""></script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body>

<a class="skip-link" href="#main-content">Skip to main content</a>
<header class="bg-white shadow-sm sticky top-0 z-50">
  <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
    <div class="flex justify-between items-center">
      <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>

      <div class="w-full max-w-md hidden md:block mx-8">
        <div class="relative">
          <input
            type="search"
            id="search-input"
            placeholder="Search for a calculator..."
            class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            autocomplete="off"
          />
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 0 0114 0z"></path>
          </svg>
          <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
        </div>
      </div>

      <div class="hidden md:flex items-center space-x-6">
        <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
        <a href="https://calcdomain.com/#categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
      </div>

      <button
        id="mobile-menu-toggle"
        class="md:hidden p-2"
        aria-controls="mobile-menu"
        aria-expanded="false"
        aria-label="Open menu"
        type="button"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
      <div class="mb-4">
        <div class="relative">
          <input
            type="search"
            id="mobile-search-input"
            placeholder="Search calculators..."
            class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 0 0114 0z"></path>
          </svg>
        </div>
      </div>
      <div class="space-y-2">
        <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
        <a href="https://calcdomain.com#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
      </div>
    </nav>
  </nav>
</header>
<main class="container" id="main-content" role="main">
<nav aria-label="Breadcrumb" class="mb-6 text-sm text-gray-600">
  <ol class="flex flex-wrap gap-2">
    <li><a href="https://calcdomain.com/" class="text-blue-600 hover:underline">Home</a></li>
    <li aria-hidden="true">›</li>
    <li><a href="https://calcdomain.com/categories/construction" class="text-blue-600 hover:underline">Construction</a></li>
    <li aria-hidden="true">›</li>
    <li><a href="https://calcdomain.com/subcategories/construction-sitework-aggregates-and-asphalt" class="text-blue-600 hover:underline">Construction Sitework, Aggregates &amp; Asphalt</a></li>
  </ol>
</nav>
<h1>Excavation (Cut and Fill) Calculator</h1>
<p>This cut and fill calculator helps estimate excavation and embankment volumes for earthwork planning. Use Simple mode for average grades or Grid mode for per-cell elevation differences, then apply bulking (swell) and compaction to plan import/export.</p>
<div class="layout" id="calculator-layout">
<section aria-labelledby="calculator-heading" class="card" id="calculator">
<h2 class="sr-only" id="calculator-heading">Calculator Inputs</h2>
<fieldset>
<legend>Calculation mode</legend>
<div aria-label="Choose calculation mode" class="segmented" role="radiogroup">
<input checked="" id="mode-simple" name="mode" type="radio" value="simple">
<label for="mode-simple">Simple</label>
<input id="mode-grid" name="mode" type="radio" value="grid">
<label for="mode-grid">Grid</label>
</div>
</fieldset>
<fieldset>
<legend>Units</legend>
<div aria-label="Choose unit system" class="segmented" role="radiogroup">
<input checked="" id="unit-metric" name="units" type="radio" value="metric">
<label for="unit-metric">Metric (m, m², m³)</label>
<input id="unit-imperial" name="units" type="radio" value="imperial">
<label for="unit-imperial">Imperial (ft, ft², yd³)</label>
</div>
</fieldset>
<!-- Shared factors -->
<div class="form-group">
<div class="inline-help">
<label for="topsoil">Topsoil strip thickness</label>
<button aria-controls="tip-topsoil" aria-expanded="false" aria-label="Explain topsoil strip" class="tooltip-btn" data-tooltip="tip-topsoil" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="topsoil-help tip-topsoil topsoil-error" class="form-control" id="topsoil" inputmode="decimal" min="0" step="any" type="number" value="0">
<span class="suffix" id="topsoil-unit">m</span>
</div>
<div class="sr-only" id="topsoil-help">Topsoil stripping is subtracted from existing elevations before computing cut/fill.</div>
<div aria-hidden="true" class="tooltip" id="tip-topsoil" role="note">
            The specified thickness of topsoil to strip before grading. It is subtracted from existing elevations prior to calculating cut and fill.
          </div>
<div aria-live="polite" class="error" id="topsoil-error" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="swell">Bulking (swell) of excavated material (%)</label>
<button aria-controls="tip-swell" aria-expanded="false" aria-label="Explain bulking" class="tooltip-btn" data-tooltip="tip-swell" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="tip-swell swell-error" aria-required="true" class="form-control" id="swell" inputmode="decimal" min="0" step="any" type="number" value="20">
<span class="suffix">%</span>
</div>
<div aria-hidden="true" class="tooltip" id="tip-swell" role="note">
            Bulking (swell) increases volume when soil is excavated and loosened. Example: 20% swell means loose volume is 1.20× the in-place volume.
          </div>
<div aria-live="polite" class="error" id="swell-error" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="compaction">Compaction (shrinkage) for fill (%)</label>
<button aria-controls="tip-compaction" aria-expanded="false" aria-label="Explain compaction" class="tooltip-btn" data-tooltip="tip-compaction" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="tip-compaction compaction-error" aria-required="true" class="form-control" id="compaction" inputmode="decimal" max="99.9" min="0" step="any" type="number" value="10">
<span class="suffix">%</span>
</div>
<div aria-hidden="true" class="tooltip" id="tip-compaction" role="note">
            Compaction reduces the volume of loose soil placed in fill. Borrow needed = Fill in-place ÷ (1 − compaction). Example: 10% compaction → divide by 0.90.
          </div>
<div aria-live="polite" class="error" id="compaction-error" role="alert"></div>
</div>
<!-- Simple mode -->
<div aria-labelledby="simple-title" id="simple-pane" role="region">
<h3 id="simple-title">Simple mode inputs</h3>
<div class="form-group">
<label for="simple-area">Area to grade *</label>
<div class="input-row">
<input aria-describedby="simple-area-error" aria-required="true" class="form-control" id="simple-area" inputmode="decimal" min="0" placeholder="e.g., 2000" step="any" type="number">
<span class="suffix" id="area-unit">m²</span>
</div>
<div aria-live="polite" class="error" id="simple-area-error" role="alert"></div>
</div>
<div class="form-group">
<label for="simple-existing">Average existing elevation *</label>
<div class="input-row">
<input aria-describedby="simple-existing-error" aria-required="true" class="form-control" id="simple-existing" inputmode="decimal" placeholder="e.g., 101.2" step="any" type="number">
<span class="suffix" id="elev-unit-1">m</span>
</div>
<div aria-live="polite" class="error" id="simple-existing-error" role="alert"></div>
</div>
<div class="form-group">
<label for="simple-design">Average design elevation *</label>
<div class="input-row">
<input aria-describedby="simple-design-error" aria-required="true" class="form-control" id="simple-design" inputmode="decimal" placeholder="e.g., 100.7" step="any" type="number">
<span class="suffix" id="elev-unit-2">m</span>
</div>
<div aria-live="polite" class="error" id="simple-design-error" role="alert"></div>
</div>
</div>
<!-- Grid mode -->
<div aria-labelledby="grid-title" hidden="" id="grid-pane" role="region">
<h3 id="grid-title">Grid mode inputs</h3>
<div class="form-group">
<label for="cell-area">Uniform cell area *</label>
<div class="input-row">
<input aria-describedby="cell-area-error" aria-required="true" class="form-control" id="cell-area" inputmode="decimal" min="0" placeholder="e.g., 100" step="any" type="number">
<span class="suffix" id="cell-area-unit">m²</span>
</div>
<div aria-live="polite" class="error" id="cell-area-error" role="alert"></div>
</div>
<div aria-live="polite" class="form-group">
<div aria-labelledby="grid-table-caption" class="table-wrap" role="group">
<table>
<caption class="sr-only" id="grid-table-caption">Grid cells with existing and design elevations</caption>
<thead>
<tr>
<th class="row-index" scope="col">#</th>
<th scope="col">Existing elevation</th>
<th scope="col">Design elevation</th>
<th scope="col"><span class="sr-only">Actions</span></th>
</tr>
</thead>
<tbody id="grid-body">
<!-- Rows injected by JS -->
</tbody>
</table>
</div>
<div class="form-group" style="display:flex; gap:.5rem; margin-top:.75rem;">
<button class="btn secondary" id="add-row" type="button">Add row</button>
<button aria-label="Add five rows" class="btn secondary" id="add-5-rows" type="button">Add 5 rows</button>
<button class="btn secondary" id="clear-rows" type="button">Clear all</button>
</div>
<div aria-live="polite" class="error" id="grid-error" role="alert"></div>
</div>
</div>
<div aria-atomic="true" aria-live="polite" class="results" id="results">
<h3>Results</h3>
<div class="result-item">
<span class="result-label">Total cut (in-place)</span>
<span class="result-value" id="cut-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Total fill (in-place)</span>
<span class="result-value" id="fill-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Net volume (cut − fill, in-place)</span>
<span class="result-value" id="net-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Loose cut volume (for haul)</span>
<span class="result-value" id="loose-cut">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Borrow needed (loose)</span>
<span class="result-value" id="borrow-loose">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Balance</span>
<span class="result-value" id="balance-text">Balanced</span>
</div>
<div class="result-item">
<span class="result-label">Also shown (conversion)</span>
<span class="result-value" id="alt-units">0.00 yd³</span>
</div>
</div>
</section>
<section aria-label="Authoritative content" class="card">
<article>
<h2>Data Source and Methodology</h2>
<p><strong>Authoritative Data Source:</strong> US Army Corps of Engineers (USACE), Engineer Manual EM 1110-2-2300 — “Earth and Rock-Fill Dams: General Design and Construction Considerations,” July 2004. <a href="https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf" rel="noopener nofollow">Direct PDF</a>. Typical bulking and shrinkage practices for earthwork are documented within USACE earthwork guidance.</p>
<p>Additionally, the volumetric methodology used here aligns with standard civil engineering practice and GIS implementations such as <a href="https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm" rel="noopener">Esri’s Cut/Fill Volume Calculation</a>, which compute volumes by integrating height differences over area.</p>
<p><strong>Statement:</strong> All calculations are rigorously based on the formulas and data provided by this source.</p>
<h2>The Formula Explained</h2>
<div class="formula-box">
<p>For each cell i with area A_i and adjusted height difference Δh_i between existing and design grades:</p>
<p class="formula">\( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \)</p>
<p class="formula">\( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \)</p>
<p>Adjustments for bulking (swell) and compaction (shrinkage):</p>
<p class="formula">\( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \)</p>
<p>Where t is topsoil strip thickness, s and c are decimals (e.g., 20% → 0.20).</p>
</div>
<h2>Glossary of Variables</h2>
<ul>
<li>Eexisting, Edesign: Existing and design elevations per area or grid cell (m or ft).</li>
<li>A: Area of the site (Simple mode) or uniform cell area (Grid mode) in m² or ft².</li>
<li>t: Topsoil strip thickness subtracted from existing elevation (m or ft).</li>
<li>Δh: Height difference. Positive → cut; negative → fill.</li>
<li>Vcut, Vfill: In-place volumes before bulking/compaction (m³ or yd³ as applicable).</li>
<li>s: Bulking (swell) fraction, e.g., 0.20 for 20%.</li>
<li>c: Compaction fraction, e.g., 0.10 for 10%.</li>
<li>Vcut, loose: Loose excavated volume after swell (used for haul/export).</li>
<li>Vborrow, loose: Loose borrow required to achieve compacted fill.</li>
</ul>
<h2>How It Works: A Step-by-Step Example</h2>
<p><strong>Scenario:</strong> Metric units. Area = 2,000 m². Average existing elevation = 101.2 m. Design elevation = 100.7 m. Topsoil strip t = 0.00 m. Swell s = 20% (0.20). Compaction c = 10% (0.10).</p>
<ol>
<li>Compute height difference: Δh = (101.2 − 0.00) − 100.7 = 0.5 m → Cut.</li>
<li>In-place volumes: Vcut = 0.5 × 2,000 = 1,000 m³; Vfill = 0.</li>
<li>Loose cut: Vcut, loose = 1,000 × (1 + 0.20) = 1,200 m³.</li>
<li>Borrow: Vborrow, loose = 0 ÷ (1 − 0.10) = 0 m³.</li>
<li>Balance: Export 1,200 m³ loose if not reused; import is 0.</li>
</ol>
<h2>Frequently Asked Questions (FAQ)</h2>
<h3>Do I need to enter negative numbers for fill?</h3>
<p>No. Enter actual elevations. The calculator detects whether each cell/area is cut (existing above design) or fill (existing below design).</p>
<h3>How accurate are results compared to 3D models?</h3>
<p>For conceptual estimates, this 2D height-difference method is standard. For final takeoffs, validate against your project’s digital terrain models (DTMs) or BIM.</p>
<h3>What values should I use for bulking and compaction?</h3>
<p>They depend on soil type and moisture. Typical ranges: granular soils 10–25% swell; clays 15–40%. Always confirm with geotechnical data and specs.</p>
<h3>Can I account for topsoil stripping?</h3>
<p>Yes. Enter the strip thickness; the calculator subtracts it from existing elevations before computing volumes.</p>
<h3>What unit conversions are shown?</h3>
<p>Primary outputs follow your unit setting. A secondary line shows the same volumes converted between m³ and yd³.</p>
<h3>How do I know if I need import or export?</h3>
<p>If loose cut exceeds borrow required, you have export. If borrow required exceeds loose cut, you need import. The Balance line summarizes this.</p>


<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[= (sel, ctx=document) =&gt; Array.from(ctx.querySelectorAll(sel)); // Elements const modeRadios =\]</div>
  <pre class="auditspine-mono">= (sel, ctx=document) =&gt; Array.from(ctx.querySelectorAll(sel)); // Elements const modeRadios =</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[('input[name="units"]'); const simplePane = $('#simple-pane'); const gridPane = $('#grid-pane'); const areaUnitSpan = $('#area-unit'); const cellAreaUnitSpan = $('#cell-area-unit'); const elevUnit1 = $('#elev-unit-1'); const elevUnit2 = $('#elev-unit-2'); const topsoilUnit = $('#topsoil-unit'); const inputs = { topsoil: $('#topsoil'), swell: $('#swell'), compaction: $('#compaction'), simpleArea: $('#simple-area'), simpleExisting: $('#simple-existing'), simpleDesign: $('#simple-design'), cellArea: $('#cell-area'), gridBody: $('#grid-body'), gridError: $('#grid-error'), }; const results = { cutInPlace: $('#cut-inplace'), fillInPlace: $('#fill-inplace'), netInPlace: $('#net-inplace'), looseCut: $('#loose-cut'), borrowLoose: $('#borrow-loose'), balance: $('#balance-text'), altUnits: $('#alt-units'), }; const errors = { topsoil: $('#topsoil-error'), swell: $('#swell-error'), compaction: $('#compaction-error'), simpleArea: $('#simple-area-error'), simpleExisting: $('#simple-existing-error'), simpleDesign: $('#simple-design-error'), cellArea: $('#cell-area-error'), }; const buttons = { addRow: $('#add-row'), add5Rows: $('#add-5-rows'), clearRows: $('#clear-rows'), }; // State let mode = 'simple'; // simple | grid let units = 'metric'; // metric | imperial // Utils const clamp = (val, min, max) =&gt; Math.min(Math.max(val, min), max); const toNumber = v =&gt; { const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,'')); return Number.isFinite(n) ? n : NaN; }; // Unit helpers const m3_to_yd3 = v =&gt; v * 1.30795062; const yd3_to_m3 = v =&gt; v * 0.764554858; const ft3_to_yd3 = v =&gt; v / 27; function formatNumber(n){ if (!Number.isFinite(n)) return '—'; return n.toLocaleString(undefined, {maximumFractionDigits: 2}); } function updateUnitLabels(){ if (units === 'metric'){ areaUnitSpan.textContent = 'm²'; cellAreaUnitSpan.textContent = 'm²'; elevUnit1.textContent = 'm'; elevUnit2.textContent = 'm'; topsoilUnit.textContent = 'm'; } else { areaUnitSpan.textContent = 'ft²'; cellAreaUnitSpan.textContent = 'ft²'; elevUnit1.textContent = 'ft'; elevUnit2.textContent = 'ft'; topsoilUnit.textContent = 'ft'; } } function toggleModeUI(){ if (mode === 'simple'){ simplePane.hidden = false; gridPane.hidden = true; } else { simplePane.hidden = true; gridPane.hidden = false; if (inputs.gridBody.children.length === 0){ addRows(5); } } } // Accessible tooltip toggles\]</div>
  <pre class="auditspine-mono">('input[name="units"]'); const simplePane = $('#simple-pane'); const gridPane = $('#grid-pane'); const areaUnitSpan = $('#area-unit'); const cellAreaUnitSpan = $('#cell-area-unit'); const elevUnit1 = $('#elev-unit-1'); const elevUnit2 = $('#elev-unit-2'); const topsoilUnit = $('#topsoil-unit'); const inputs = { topsoil: $('#topsoil'), swell: $('#swell'), compaction: $('#compaction'), simpleArea: $('#simple-area'), simpleExisting: $('#simple-existing'), simpleDesign: $('#simple-design'), cellArea: $('#cell-area'), gridBody: $('#grid-body'), gridError: $('#grid-error'), }; const results = { cutInPlace: $('#cut-inplace'), fillInPlace: $('#fill-inplace'), netInPlace: $('#net-inplace'), looseCut: $('#loose-cut'), borrowLoose: $('#borrow-loose'), balance: $('#balance-text'), altUnits: $('#alt-units'), }; const errors = { topsoil: $('#topsoil-error'), swell: $('#swell-error'), compaction: $('#compaction-error'), simpleArea: $('#simple-area-error'), simpleExisting: $('#simple-existing-error'), simpleDesign: $('#simple-design-error'), cellArea: $('#cell-area-error'), }; const buttons = { addRow: $('#add-row'), add5Rows: $('#add-5-rows'), clearRows: $('#clear-rows'), }; // State let mode = 'simple'; // simple | grid let units = 'metric'; // metric | imperial // Utils const clamp = (val, min, max) =&gt; Math.min(Math.max(val, min), max); const toNumber = v =&gt; { const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,'')); return Number.isFinite(n) ? n : NaN; }; // Unit helpers const m3_to_yd3 = v =&gt; v * 1.30795062; const yd3_to_m3 = v =&gt; v * 0.764554858; const ft3_to_yd3 = v =&gt; v / 27; function formatNumber(n){ if (!Number.isFinite(n)) return '—'; return n.toLocaleString(undefined, {maximumFractionDigits: 2}); } function updateUnitLabels(){ if (units === 'metric'){ areaUnitSpan.textContent = 'm²'; cellAreaUnitSpan.textContent = 'm²'; elevUnit1.textContent = 'm'; elevUnit2.textContent = 'm'; topsoilUnit.textContent = 'm'; } else { areaUnitSpan.textContent = 'ft²'; cellAreaUnitSpan.textContent = 'ft²'; elevUnit1.textContent = 'ft'; elevUnit2.textContent = 'ft'; topsoilUnit.textContent = 'ft'; } } function toggleModeUI(){ if (mode === 'simple'){ simplePane.hidden = false; gridPane.hidden = true; } else { simplePane.hidden = true; gridPane.hidden = false; if (inputs.gridBody.children.length === 0){ addRows(5); } } } // Accessible tooltip toggles</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[('#grid-body tr').forEach((tr, i) =&gt; { const idx = tr.querySelector('.row-index'); if (idx) idx.textContent = i + 1; const [existing, design, actionTd] = tr.querySelectorAll('td'); const inpExisting = tr.querySelector('td:nth-child(2) input'); const inpDesign = tr.querySelector('td:nth-child(3) input'); if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`); if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`); const btn = tr.querySelector('button.btn.secondary'); if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`); }); } function addRows(n=1){ for (let i=0; i&lt;n; i++){ const row = makeRow(inputs.gridBody.children.length); inputs.gridBody.appendChild(row); } } buttons.addRow.addEventListener('click', () =&gt; addRows(1)); buttons.add5Rows.addEventListener('click', () =&gt; addRows(5)); buttons.clearRows.addEventListener('click', () =&gt; { inputs.gridBody.innerHTML = ''; inputs.gridError.textContent = ''; calculate(); }); // Validation function setError(inputEl, errorEl, message){ if (!errorEl) return; if (message){ inputEl?.setAttribute('aria-invalid', 'true'); errorEl.textContent = message; } else { inputEl?.setAttribute('aria-invalid', 'false'); errorEl.textContent = ''; } } function validateRequired(inputEl, errorEl, opts={}){ const v = toNumber(inputEl.value); if (!Number.isFinite(v) || (opts.min != null &amp;&amp; v &lt; opts.min)){ setError(inputEl, errorEl, opts.message || 'Please enter a valid number.'); return false; } setError(inputEl, errorEl, ''); return true; } function validateFactors(){ const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'}); const c = toNumber(inputs.compaction.value); let ok2 = true; if (!Number.isFinite(c) || c &lt; 0 || c &gt;= 100){ setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.'); ok2 = false; } else { setError(inputs.compaction, errors.compaction, ''); } const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'}); return ok1 &amp;&amp; ok2 &amp;&amp; ok3; } // Event wiring modeRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { mode = e.target.value; toggleModeUI(); calculate(); })); unitRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { units = e.target.value; updateUnitLabels(); calculate(); })); [inputs.topsoil, inputs.swell, inputs.compaction, inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign, inputs.cellArea ].forEach(el =&gt; { if (!el) return; el.addEventListener('input', debounce(calculate, 100)); }); inputs.simpleArea.addEventListener('blur', () =&gt; validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'})); inputs.simpleExisting.addEventListener('blur', () =&gt; validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'})); inputs.simpleDesign.addEventListener('blur', () =&gt; validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'})); inputs.cellArea.addEventListener('blur', () =&gt; validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'})); // Debounce utility function debounce(fn, wait=120){ let t; return function(...args){ clearTimeout(t); t = setTimeout(() =&gt; fn.apply(this, args), wait); } } // Core calculation function calculate(){ if (!validateFactors()){ writeResults(0,0,0,0,0,'—',0,true); return; } const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0); const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0); const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9); let cut_inplace_m3 = 0; let fill_inplace_m3 = 0; if (mode === 'simple'){ const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}); const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}); const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}); if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; } const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0); const E = toNumber(inputs.simpleExisting.value) || 0; const D = toNumber(inputs.simpleDesign.value) || 0; const delta = (E - topsoil) - D; // positive -&gt; cut, negative -&gt; fill if (units === 'metric'){ if (delta &gt; 0) cut_inplace_m3 = delta * area; else fill_inplace_m3 = -delta * area; } else { // Imperial inputs: ft, ft². Convert ft³ -&gt; m³. const vol_ft3 = (delta &gt; 0 ? delta * area : -delta * area); const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³ if (delta &gt; 0) cut_inplace_m3 = vol_m3; else fill_inplace_m3 = vol_m3; } } else { // Grid const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}); if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; } const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0); let anyRow = false; inputs.gridError.textContent = '';\]</div>
  <pre class="auditspine-mono">('#grid-body tr').forEach((tr, i) =&gt; { const idx = tr.querySelector('.row-index'); if (idx) idx.textContent = i + 1; const [existing, design, actionTd] = tr.querySelectorAll('td'); const inpExisting = tr.querySelector('td:nth-child(2) input'); const inpDesign = tr.querySelector('td:nth-child(3) input'); if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`); if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`); const btn = tr.querySelector('button.btn.secondary'); if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`); }); } function addRows(n=1){ for (let i=0; i&lt;n; i++){ const row = makeRow(inputs.gridBody.children.length); inputs.gridBody.appendChild(row); } } buttons.addRow.addEventListener('click', () =&gt; addRows(1)); buttons.add5Rows.addEventListener('click', () =&gt; addRows(5)); buttons.clearRows.addEventListener('click', () =&gt; { inputs.gridBody.innerHTML = ''; inputs.gridError.textContent = ''; calculate(); }); // Validation function setError(inputEl, errorEl, message){ if (!errorEl) return; if (message){ inputEl?.setAttribute('aria-invalid', 'true'); errorEl.textContent = message; } else { inputEl?.setAttribute('aria-invalid', 'false'); errorEl.textContent = ''; } } function validateRequired(inputEl, errorEl, opts={}){ const v = toNumber(inputEl.value); if (!Number.isFinite(v) || (opts.min != null &amp;&amp; v &lt; opts.min)){ setError(inputEl, errorEl, opts.message || 'Please enter a valid number.'); return false; } setError(inputEl, errorEl, ''); return true; } function validateFactors(){ const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'}); const c = toNumber(inputs.compaction.value); let ok2 = true; if (!Number.isFinite(c) || c &lt; 0 || c &gt;= 100){ setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.'); ok2 = false; } else { setError(inputs.compaction, errors.compaction, ''); } const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'}); return ok1 &amp;&amp; ok2 &amp;&amp; ok3; } // Event wiring modeRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { mode = e.target.value; toggleModeUI(); calculate(); })); unitRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { units = e.target.value; updateUnitLabels(); calculate(); })); [inputs.topsoil, inputs.swell, inputs.compaction, inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign, inputs.cellArea ].forEach(el =&gt; { if (!el) return; el.addEventListener('input', debounce(calculate, 100)); }); inputs.simpleArea.addEventListener('blur', () =&gt; validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'})); inputs.simpleExisting.addEventListener('blur', () =&gt; validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'})); inputs.simpleDesign.addEventListener('blur', () =&gt; validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'})); inputs.cellArea.addEventListener('blur', () =&gt; validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'})); // Debounce utility function debounce(fn, wait=120){ let t; return function(...args){ clearTimeout(t); t = setTimeout(() =&gt; fn.apply(this, args), wait); } } // Core calculation function calculate(){ if (!validateFactors()){ writeResults(0,0,0,0,0,'—',0,true); return; } const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0); const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0); const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9); let cut_inplace_m3 = 0; let fill_inplace_m3 = 0; if (mode === 'simple'){ const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}); const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}); const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}); if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; } const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0); const E = toNumber(inputs.simpleExisting.value) || 0; const D = toNumber(inputs.simpleDesign.value) || 0; const delta = (E - topsoil) - D; // positive -&gt; cut, negative -&gt; fill if (units === 'metric'){ if (delta &gt; 0) cut_inplace_m3 = delta * area; else fill_inplace_m3 = -delta * area; } else { // Imperial inputs: ft, ft². Convert ft³ -&gt; m³. const vol_ft3 = (delta &gt; 0 ? delta * area : -delta * area); const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³ if (delta &gt; 0) cut_inplace_m3 = vol_m3; else fill_inplace_m3 = vol_m3; } } else { // Grid const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}); if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; } const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0); let anyRow = false; inputs.gridError.textContent = '';</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">For each cell i with area A_i and adjusted height difference Δh_i between existing and design grades: \( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \) \( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \) Adjustments for bulking (swell) and compaction (shrinkage): \( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \) Where t is topsoil strip thickness, s and c are decimals (e.g., 20% → 0.20).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \)</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Direct PDF</strong> — publications.usace.army.mil · Accessed 2026-01-19<br><a href="https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf" target="_blank" rel="nofollow noopener">https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf</a></li>
<li><strong>Esri’s Cut/Fill Volume Calculation</strong> — enterprise.arcgis.com · Accessed 2026-01-19<br><a href="https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm" target="_blank" rel="nofollow noopener">https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</section>
</div>
</main>
<footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                                                        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>








<!-- Standard Footer --> 
<script defer="">
    (function(){
      'use strict';

      // Shortcuts
      const $ = (sel, ctx=document) => ctx.querySelector(sel);
      const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

      // Elements
      const modeRadios = $$('input[name="mode"]');
      const unitRadios = $$('input[name="units"]');

      const simplePane = $('#simple-pane');
      const gridPane = $('#grid-pane');

      const areaUnitSpan = $('#area-unit');
      const cellAreaUnitSpan = $('#cell-area-unit');
      const elevUnit1 = $('#elev-unit-1');
      const elevUnit2 = $('#elev-unit-2');
      const topsoilUnit = $('#topsoil-unit');

      const inputs = {
        topsoil: $('#topsoil'),
        swell: $('#swell'),
        compaction: $('#compaction'),

        simpleArea: $('#simple-area'),
        simpleExisting: $('#simple-existing'),
        simpleDesign: $('#simple-design'),

        cellArea: $('#cell-area'),
        gridBody: $('#grid-body'),
        gridError: $('#grid-error'),
      };

      const results = {
        cutInPlace: $('#cut-inplace'),
        fillInPlace: $('#fill-inplace'),
        netInPlace: $('#net-inplace'),
        looseCut: $('#loose-cut'),
        borrowLoose: $('#borrow-loose'),
        balance: $('#balance-text'),
        altUnits: $('#alt-units'),
      };

      const errors = {
        topsoil: $('#topsoil-error'),
        swell: $('#swell-error'),
        compaction: $('#compaction-error'),
        simpleArea: $('#simple-area-error'),
        simpleExisting: $('#simple-existing-error'),
        simpleDesign: $('#simple-design-error'),
        cellArea: $('#cell-area-error'),
      };

      const buttons = {
        addRow: $('#add-row'),
        add5Rows: $('#add-5-rows'),
        clearRows: $('#clear-rows'),
      };

      // State
      let mode = 'simple'; // simple | grid
      let units = 'metric'; // metric | imperial

      // Utils
      const clamp = (val, min, max) => Math.min(Math.max(val, min), max);
      const toNumber = v => {
        const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,''));
        return Number.isFinite(n) ? n : NaN;
      };

      // Unit helpers
      const m3_to_yd3 = v => v * 1.30795062;
      const yd3_to_m3 = v => v * 0.764554858;
      const ft3_to_yd3 = v => v / 27;

      function formatNumber(n){
        if (!Number.isFinite(n)) return '—';
        return n.toLocaleString(undefined, {maximumFractionDigits: 2});
      }

      function updateUnitLabels(){
        if (units === 'metric'){
          areaUnitSpan.textContent = 'm²';
          cellAreaUnitSpan.textContent = 'm²';
          elevUnit1.textContent = 'm';
          elevUnit2.textContent = 'm';
          topsoilUnit.textContent = 'm';
        } else {
          areaUnitSpan.textContent = 'ft²';
          cellAreaUnitSpan.textContent = 'ft²';
          elevUnit1.textContent = 'ft';
          elevUnit2.textContent = 'ft';
          topsoilUnit.textContent = 'ft';
        }
      }

      function toggleModeUI(){
        if (mode === 'simple'){
          simplePane.hidden = false;
          gridPane.hidden = true;
        } else {
          simplePane.hidden = true;
          gridPane.hidden = false;
          if (inputs.gridBody.children.length === 0){
            addRows(5);
          }
        }
      }

      // Accessible tooltip toggles
      $$('.tooltip-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.getAttribute('data-tooltip');
          const tip = document.getElementById(id);
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          tip.setAttribute('aria-hidden', String(expanded));
        });
        btn.addEventListener('keydown', (e) => {
          if (e.key === 'Escape'){
            const id = btn.getAttribute('data-tooltip');
            const tip = document.getElementById(id);
            btn.setAttribute('aria-expanded', 'false');
            tip.setAttribute('aria-hidden', 'true');
          }
        });
      });

      // Grid rows
      function makeRow(index){
        const tr = document.createElement('tr');

        const tdIndex = document.createElement('td');
        tdIndex.className = 'row-index';
        tdIndex.textContent = index + 1;

        const tdExisting = document.createElement('td');
        const inpExisting = document.createElement('input');
        inpExisting.type = 'number'; inpExisting.step = 'any'; inpExisting.className = 'form-control';
        inpExisting.placeholder = 'Existing';
        inpExisting.setAttribute('aria-label', `Row ${index+1} existing elevation`);
        inpExisting.addEventListener('input', debounce(calculate, 80));
        inpExisting.addEventListener('blur', () => validateRequired(inpExisting, null));

        const tdDesign = document.createElement('td');
        const inpDesign = document.createElement('input');
        inpDesign.type = 'number'; inpDesign.step = 'any'; inpDesign.className = 'form-control';
        inpDesign.placeholder = 'Design';
        inpDesign.setAttribute('aria-label', `Row ${index+1} design elevation`);
        inpDesign.addEventListener('input', debounce(calculate, 80));
        inpDesign.addEventListener('blur', () => validateRequired(inpDesign, null));

        const tdActions = document.createElement('td');
        const btnRemove = document.createElement('button');
        btnRemove.type = 'button';
        btnRemove.className = 'btn secondary';
        btnRemove.textContent = 'Remove';
        btnRemove.setAttribute('aria-label', `Remove row ${index+1}`);
        btnRemove.addEventListener('click', () => {
          tr.remove();
          refreshRowIndices();
          calculate();
        });

        tdExisting.appendChild(inpExisting);
        tdDesign.appendChild(inpDesign);
        tdActions.appendChild(btnRemove);

        tr.appendChild(tdIndex);
        tr.appendChild(tdExisting);
        tr.appendChild(tdDesign);
        tr.appendChild(tdActions);
        return tr;
      }

      function refreshRowIndices(){
        $$('#grid-body tr').forEach((tr, i) => {
          const idx = tr.querySelector('.row-index');
          if (idx) idx.textContent = i + 1;
          const [existing, design, actionTd] = tr.querySelectorAll('td');
          const inpExisting = tr.querySelector('td:nth-child(2) input');
          const inpDesign = tr.querySelector('td:nth-child(3) input');
          if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`);
          if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`);
          const btn = tr.querySelector('button.btn.secondary');
          if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`);
        });
      }

      function addRows(n=1){
        for (let i=0; i<n; i++){
          const row = makeRow(inputs.gridBody.children.length);
          inputs.gridBody.appendChild(row);
        }
      }

      buttons.addRow.addEventListener('click', () => addRows(1));
      buttons.add5Rows.addEventListener('click', () => addRows(5));
      buttons.clearRows.addEventListener('click', () => {
        inputs.gridBody.innerHTML = '';
        inputs.gridError.textContent = '';
        calculate();
      });

      // Validation
      function setError(inputEl, errorEl, message){
        if (!errorEl) return;
        if (message){
          inputEl?.setAttribute('aria-invalid', 'true');
          errorEl.textContent = message;
        } else {
          inputEl?.setAttribute('aria-invalid', 'false');
          errorEl.textContent = '';
        }
      }
      function validateRequired(inputEl, errorEl, opts={}){
        const v = toNumber(inputEl.value);
        if (!Number.isFinite(v) || (opts.min != null && v < opts.min)){
          setError(inputEl, errorEl, opts.message || 'Please enter a valid number.');
          return false;
        }
        setError(inputEl, errorEl, '');
        return true;
      }
      function validateFactors(){
        const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'});
        const c = toNumber(inputs.compaction.value);
        let ok2 = true;
        if (!Number.isFinite(c) || c < 0 || c >= 100){
          setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.');
          ok2 = false;
        } else {
          setError(inputs.compaction, errors.compaction, '');
        }
        const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'});
        return ok1 && ok2 && ok3;
      }

      // Event wiring
      modeRadios.forEach(r => r.addEventListener('change', e => {
        mode = e.target.value;
        toggleModeUI();
        calculate();
      }));
      unitRadios.forEach(r => r.addEventListener('change', e => {
        units = e.target.value;
        updateUnitLabels();
        calculate();
      }));

      [inputs.topsoil, inputs.swell, inputs.compaction,
       inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign,
       inputs.cellArea
      ].forEach(el => {
        if (!el) return;
        el.addEventListener('input', debounce(calculate, 100));
      });

      inputs.simpleArea.addEventListener('blur', () => validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}));
      inputs.simpleExisting.addEventListener('blur', () => validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}));
      inputs.simpleDesign.addEventListener('blur', () => validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}));
      inputs.cellArea.addEventListener('blur', () => validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}));

      // Debounce utility
      function debounce(fn, wait=120){
        let t; return function(...args){
          clearTimeout(t); t = setTimeout(() => fn.apply(this, args), wait);
        }
      }

      // Core calculation
      function calculate(){
        if (!validateFactors()){
          writeResults(0,0,0,0,0,'—',0,true);
          return;
        }
        const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0);
        const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0);
        const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9);

        let cut_inplace_m3 = 0;
        let fill_inplace_m3 = 0;

        if (mode === 'simple'){
          const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'});
          const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'});
          const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'});
          if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; }

          const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0);
          const E = toNumber(inputs.simpleExisting.value) || 0;
          const D = toNumber(inputs.simpleDesign.value) || 0;

          const delta = (E - topsoil) - D; // positive -> cut, negative -> fill

          if (units === 'metric'){
            if (delta > 0) cut_inplace_m3 = delta * area;
            else fill_inplace_m3 = -delta * area;
          } else {
            // Imperial inputs: ft, ft². Convert ft³ -> m³.
            const vol_ft3 = (delta > 0 ? delta * area : -delta * area);
            const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³
            if (delta > 0) cut_inplace_m3 = vol_m3;
            else fill_inplace_m3 = vol_m3;
          }
        } else {
          // Grid
          const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'});
          if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; }
          const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0);

          let anyRow = false;
          inputs.gridError.textContent = '';

          $$('#grid-body tr').forEach(tr => {
            const exEl = tr.querySelector('td:nth-child(2) input');
            const deEl = tr.querySelector('td:nth-child(3) input');
            const E = toNumber(exEl.value);
            const D = toNumber(deEl.value);
            if (!Number.isFinite(E) || !Number.isFinite(D)) return;
            anyRow = true;
            const delta = (E - topsoil) - D;

            if (units === 'metric'){
              if (delta > 0) cut_inplace_m3 += delta * cellArea;
              else fill_inplace_m3 += -delta * cellArea;
            } else {
              const vol_ft3 = (delta > 0 ? delta * cellArea : -delta * cellArea);
              const vol_m3 = vol_ft3 * 0.028316846592;
              if (delta > 0) cut_inplace_m3 += vol_m3;
              else fill_inplace_m3 += vol_m3;
            }
          });

          if (!anyRow){
            inputs.gridError.textContent = 'Enter at least one complete row (existing and design elevations).';
            writeResults(0,0,0,0,0,'—',0,true);
            return;
          }
        }

        // Guard against tiny floating errors
        cut_inplace_m3 = Math.max(0, cut_inplace_m3);
        fill_inplace_m3 = Math.max(0, fill_inplace_m3);

        const net_inplace_m3 = cut_inplace_m3 - fill_inplace_m3;

        const swell = swellPct / 100;
        const comp = compPct / 100;

        const loose_cut_m3 = cut_inplace_m3 * (1 + swell);
        const borrow_loose_m3 = comp >= 1 ? Infinity : (fill_inplace_m3 / (1 - comp));

        // Balance: compare loose cut vs borrow loose
        let balanceText = 'Balanced';
        const diff = loose_cut_m3 - borrow_loose_m3;
        if (Math.abs(diff) > 1e-6){
          balanceText = diff > 0 ? 'Export required' : 'Import required';
        }

        // Primary unit display and alternate conversion
        const primary = (units === 'metric') ? 'm³' : 'yd³';
        const display = {
          cut: units === 'metric' ? cut_inplace_m3 : m3_to_yd3(cut_inplace_m3),
          fill: units === 'metric' ? fill_inplace_m3 : m3_to_yd3(fill_inplace_m3),
          net: units === 'metric' ? net_inplace_m3 : m3_to_yd3(net_inplace_m3),
          looseCut: units === 'metric' ? loose_cut_m3 : m3_to_yd3(loose_cut_m3),
          borrowLoose: units === 'metric' ? borrow_loose_m3 : m3_to_yd3(borrow_loose_m3)
        };

        // Alternate units
        const altLabel = (units === 'metric') ? 'yd³' : 'm³';
        const altCut = (units === 'metric') ? m3_to_yd3(cut_inplace_m3) : yd3_to_m3(display.cut);
        const altFill = (units === 'metric') ? m3_to_yd3(fill_inplace_m3) : yd3_to_m3(display.fill);
        const altNet = (units === 'metric') ? m3_to_yd3(net_inplace_m3) : yd3_to_m3(display.net);

        writeResults(display.cut, display.fill, display.net, display.looseCut, display.borrowLoose, balanceText, (altCut + altFill + altNet), false, primary, altLabel, {altCut, altFill, altNet});
      }

      function writeResults(cut, fill, net, looseCut, borrowLoose, balanceText, altSum, invalid, primary='m³', altLabel='yd³', altValues=null){
        results.cutInPlace.textContent = `${formatNumber(cut)} ${primary}`;
        results.fillInPlace.textContent = `${formatNumber(fill)} ${primary}`;
        const sign = net >= 0 ? '' : '−';
        results.netInPlace.textContent = `${formatNumber(Math.abs(net))} ${primary} ${net>=0?'(net cut)':'(net fill)'}`;
        results.looseCut.textContent = `${formatNumber(looseCut)} ${primary}`;
        results.borrowLoose.textContent = `${formatNumber(borrowLoose)} ${primary}`;
        results.balance.textContent = balanceText;

        if (altValues){
          const {altCut, altFill, altNet} = altValues;
          results.altUnits.textContent = `Cut ${formatNumber(altCut)} ${altLabel} · Fill ${formatNumber(altFill)} ${altLabel} · Net ${formatNumber(altNet)} ${altLabel}`;
        } else {
          results.altUnits.textContent = `${formatNumber(altSum)} ${altLabel}`;
        }
      }

      // Initialize
      updateUnitLabels();
      toggleModeUI();
      calculate();

      // Prefill one row for better UX in grid mode
      function initGrid(){
        if (inputs.gridBody.children.length === 0){
          addRows(5);
        }
      }

      // Accessibility: pressing Enter on inputs triggers calc immediately
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter'){
          calculate();
        }
      });
    })();
  </script>

<script defer="" src="/assets/js/mobile-menu.js"></script>
<script defer="" src="/assets/js/page-enhancements.js"></script>
</body></html>
, '</script>
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Excavation (Cut and Fill) Calculator",
  "url": "https://calcdomain.com/cut-and-fill",
  "description": "Professional cut and fill calculator for construction. Compute in-place cut and fill volumes using simple or grid methods, with bulking (swell) and compaction factors for import/export planning.",
  "inLanguage": "en",
  "isPartOf": {
    "@type": "CreativeWorkSeries",
    "name": "Construction Calculators - General"
  },
  "about": [
    {
      "@type": "Thing",
      "name": "Construction"
    },
    {
      "@type": "Thing",
      "name": "Earthwork"
    },
    {
      "@type": "Thing",
      "name": "Cut and Fill"
    }
  ],
  "dateModified": "2026-01-19",
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "Cut and Fill: A Worked Example",
      "description": "Step-by-step example demonstrating how to calculate cut and fill volumes with bulking and compaction adjustments.",
      "supply": [
        {
          "@type": "HowToSupply",
          "name": "Site plan with elevations"
        },
        {
          "@type": "HowToSupply",
          "name": "Design grading plan"
        }
      ],
      "tool": [
        {
          "@type": "HowToTool",
          "name": "Excavation (Cut and Fill) Calculator"
        }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "name": "Set units and factors",
          "text": "Choose Metric or Imperial. Set bulking (swell) to 20% and compaction (shrinkage) to 10%."
        },
        {
          "@type": "HowToStep",
          "name": "Enter area and elevations",
          "text": "Area = 2,000 m², average existing elevation = 101.2 m, average design elevation = 100.7 m. No topsoil strip."
        },
        {
          "@type": "HowToStep",
          "name": "Calculate in-place volumes",
          "text": "Height difference Δh = 0.5 m. Cut_in_place = Δh × Area = 0.5 × 2,000 = 1,000 m³. Fill_in_place = 0."
        },
        {
          "@type": "HowToStep",
          "name": "Adjust for haul and borrow",
          "text": "Loose cut volume = 1,000 × (1 + 0.20) = 1,200 m³. Borrow needed = Fill_in_place ÷ (1 − 0.10) = 0."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is cut and fill in earthwork?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Cut is the volume of soil excavated from higher elevations; fill is the volume needed to raise lower areas to the design grade."
          }
        },
        {
          "@type": "Question",
          "name": "What are bulking (swell) and compaction factors?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Bulking (swell) increases volume when soil is excavated and loosens. Compaction (shrinkage) reduces the volume when loose soil is compacted in place. They are expressed as percentages used to convert between in-place and loose volumes."
          }
        },
        {
          "@type": "Question",
          "name": "Does the calculator support a grid-based method?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Use the Grid mode to enter elevations per cell along with a uniform cell area. The tool sums cut and fill across all cells."
          }
        },
        {
          "@type": "Question",
          "name": "How is topsoil stripping handled?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The specified strip thickness is subtracted from existing elevations before computing differences, increasing cut volumes and reducing fills accordingly."
          }
        },
        {
          "@type": "Question",
          "name": "Which units are supported?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Metric (meters, square meters, cubic meters) and Imperial (feet, square feet, cubic yards). The tool also displays both m³ and yd³ for convenience."
          }
        },
        {
          "@type": "Question",
          "name": "Are the outputs suitable for bidding?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "They provide reliable conceptual estimates. Final bid quantities should be verified against detailed design models, survey data, and project specifications."
          }
        }
      ]
    }
  ],
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  }
}</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer=""></script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body>

<a class="skip-link" href="#main-content">Skip to main content</a>
<header class="bg-white shadow-sm sticky top-0 z-50">
  <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
    <div class="flex justify-between items-center">
      <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>

      <div class="w-full max-w-md hidden md:block mx-8">
        <div class="relative">
          <input
            type="search"
            id="search-input"
            placeholder="Search for a calculator..."
            class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            autocomplete="off"
          />
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 0 0114 0z"></path>
          </svg>
          <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
        </div>
      </div>

      <div class="hidden md:flex items-center space-x-6">
        <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
        <a href="https://calcdomain.com/#categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
      </div>

      <button
        id="mobile-menu-toggle"
        class="md:hidden p-2"
        aria-controls="mobile-menu"
        aria-expanded="false"
        aria-label="Open menu"
        type="button"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
      <div class="mb-4">
        <div class="relative">
          <input
            type="search"
            id="mobile-search-input"
            placeholder="Search calculators..."
            class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 0 0114 0z"></path>
          </svg>
        </div>
      </div>
      <div class="space-y-2">
        <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
        <a href="https://calcdomain.com#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
      </div>
    </nav>
  </nav>
</header>
<main class="container" id="main-content" role="main">
<nav aria-label="Breadcrumb" class="mb-6 text-sm text-gray-600">
  <ol class="flex flex-wrap gap-2">
    <li><a href="https://calcdomain.com/" class="text-blue-600 hover:underline">Home</a></li>
    <li aria-hidden="true">›</li>
    <li><a href="https://calcdomain.com/categories/construction" class="text-blue-600 hover:underline">Construction</a></li>
    <li aria-hidden="true">›</li>
    <li><a href="https://calcdomain.com/subcategories/construction-sitework-aggregates-and-asphalt" class="text-blue-600 hover:underline">Construction Sitework, Aggregates &amp; Asphalt</a></li>
  </ol>
</nav>
<h1>Excavation (Cut and Fill) Calculator</h1>
<p>This cut and fill calculator helps estimate excavation and embankment volumes for earthwork planning. Use Simple mode for average grades or Grid mode for per-cell elevation differences, then apply bulking (swell) and compaction to plan import/export.</p>
<div class="layout" id="calculator-layout">
<section aria-labelledby="calculator-heading" class="card" id="calculator">
<h2 class="sr-only" id="calculator-heading">Calculator Inputs</h2>
<fieldset>
<legend>Calculation mode</legend>
<div aria-label="Choose calculation mode" class="segmented" role="radiogroup">
<input checked="" id="mode-simple" name="mode" type="radio" value="simple">
<label for="mode-simple">Simple</label>
<input id="mode-grid" name="mode" type="radio" value="grid">
<label for="mode-grid">Grid</label>
</div>
</fieldset>
<fieldset>
<legend>Units</legend>
<div aria-label="Choose unit system" class="segmented" role="radiogroup">
<input checked="" id="unit-metric" name="units" type="radio" value="metric">
<label for="unit-metric">Metric (m, m², m³)</label>
<input id="unit-imperial" name="units" type="radio" value="imperial">
<label for="unit-imperial">Imperial (ft, ft², yd³)</label>
</div>
</fieldset>
<!-- Shared factors -->
<div class="form-group">
<div class="inline-help">
<label for="topsoil">Topsoil strip thickness</label>
<button aria-controls="tip-topsoil" aria-expanded="false" aria-label="Explain topsoil strip" class="tooltip-btn" data-tooltip="tip-topsoil" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="topsoil-help tip-topsoil topsoil-error" class="form-control" id="topsoil" inputmode="decimal" min="0" step="any" type="number" value="0">
<span class="suffix" id="topsoil-unit">m</span>
</div>
<div class="sr-only" id="topsoil-help">Topsoil stripping is subtracted from existing elevations before computing cut/fill.</div>
<div aria-hidden="true" class="tooltip" id="tip-topsoil" role="note">
            The specified thickness of topsoil to strip before grading. It is subtracted from existing elevations prior to calculating cut and fill.
          </div>
<div aria-live="polite" class="error" id="topsoil-error" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="swell">Bulking (swell) of excavated material (%)</label>
<button aria-controls="tip-swell" aria-expanded="false" aria-label="Explain bulking" class="tooltip-btn" data-tooltip="tip-swell" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="tip-swell swell-error" aria-required="true" class="form-control" id="swell" inputmode="decimal" min="0" step="any" type="number" value="20">
<span class="suffix">%</span>
</div>
<div aria-hidden="true" class="tooltip" id="tip-swell" role="note">
            Bulking (swell) increases volume when soil is excavated and loosened. Example: 20% swell means loose volume is 1.20× the in-place volume.
          </div>
<div aria-live="polite" class="error" id="swell-error" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="compaction">Compaction (shrinkage) for fill (%)</label>
<button aria-controls="tip-compaction" aria-expanded="false" aria-label="Explain compaction" class="tooltip-btn" data-tooltip="tip-compaction" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="tip-compaction compaction-error" aria-required="true" class="form-control" id="compaction" inputmode="decimal" max="99.9" min="0" step="any" type="number" value="10">
<span class="suffix">%</span>
</div>
<div aria-hidden="true" class="tooltip" id="tip-compaction" role="note">
            Compaction reduces the volume of loose soil placed in fill. Borrow needed = Fill in-place ÷ (1 − compaction). Example: 10% compaction → divide by 0.90.
          </div>
<div aria-live="polite" class="error" id="compaction-error" role="alert"></div>
</div>
<!-- Simple mode -->
<div aria-labelledby="simple-title" id="simple-pane" role="region">
<h3 id="simple-title">Simple mode inputs</h3>
<div class="form-group">
<label for="simple-area">Area to grade *</label>
<div class="input-row">
<input aria-describedby="simple-area-error" aria-required="true" class="form-control" id="simple-area" inputmode="decimal" min="0" placeholder="e.g., 2000" step="any" type="number">
<span class="suffix" id="area-unit">m²</span>
</div>
<div aria-live="polite" class="error" id="simple-area-error" role="alert"></div>
</div>
<div class="form-group">
<label for="simple-existing">Average existing elevation *</label>
<div class="input-row">
<input aria-describedby="simple-existing-error" aria-required="true" class="form-control" id="simple-existing" inputmode="decimal" placeholder="e.g., 101.2" step="any" type="number">
<span class="suffix" id="elev-unit-1">m</span>
</div>
<div aria-live="polite" class="error" id="simple-existing-error" role="alert"></div>
</div>
<div class="form-group">
<label for="simple-design">Average design elevation *</label>
<div class="input-row">
<input aria-describedby="simple-design-error" aria-required="true" class="form-control" id="simple-design" inputmode="decimal" placeholder="e.g., 100.7" step="any" type="number">
<span class="suffix" id="elev-unit-2">m</span>
</div>
<div aria-live="polite" class="error" id="simple-design-error" role="alert"></div>
</div>
</div>
<!-- Grid mode -->
<div aria-labelledby="grid-title" hidden="" id="grid-pane" role="region">
<h3 id="grid-title">Grid mode inputs</h3>
<div class="form-group">
<label for="cell-area">Uniform cell area *</label>
<div class="input-row">
<input aria-describedby="cell-area-error" aria-required="true" class="form-control" id="cell-area" inputmode="decimal" min="0" placeholder="e.g., 100" step="any" type="number">
<span class="suffix" id="cell-area-unit">m²</span>
</div>
<div aria-live="polite" class="error" id="cell-area-error" role="alert"></div>
</div>
<div aria-live="polite" class="form-group">
<div aria-labelledby="grid-table-caption" class="table-wrap" role="group">
<table>
<caption class="sr-only" id="grid-table-caption">Grid cells with existing and design elevations</caption>
<thead>
<tr>
<th class="row-index" scope="col">#</th>
<th scope="col">Existing elevation</th>
<th scope="col">Design elevation</th>
<th scope="col"><span class="sr-only">Actions</span></th>
</tr>
</thead>
<tbody id="grid-body">
<!-- Rows injected by JS -->
</tbody>
</table>
</div>
<div class="form-group" style="display:flex; gap:.5rem; margin-top:.75rem;">
<button class="btn secondary" id="add-row" type="button">Add row</button>
<button aria-label="Add five rows" class="btn secondary" id="add-5-rows" type="button">Add 5 rows</button>
<button class="btn secondary" id="clear-rows" type="button">Clear all</button>
</div>
<div aria-live="polite" class="error" id="grid-error" role="alert"></div>
</div>
</div>
<div aria-atomic="true" aria-live="polite" class="results" id="results">
<h3>Results</h3>
<div class="result-item">
<span class="result-label">Total cut (in-place)</span>
<span class="result-value" id="cut-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Total fill (in-place)</span>
<span class="result-value" id="fill-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Net volume (cut − fill, in-place)</span>
<span class="result-value" id="net-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Loose cut volume (for haul)</span>
<span class="result-value" id="loose-cut">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Borrow needed (loose)</span>
<span class="result-value" id="borrow-loose">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Balance</span>
<span class="result-value" id="balance-text">Balanced</span>
</div>
<div class="result-item">
<span class="result-label">Also shown (conversion)</span>
<span class="result-value" id="alt-units">0.00 yd³</span>
</div>
</div>
</section>
<section aria-label="Authoritative content" class="card">
<article>
<h2>Data Source and Methodology</h2>
<p><strong>Authoritative Data Source:</strong> US Army Corps of Engineers (USACE), Engineer Manual EM 1110-2-2300 — “Earth and Rock-Fill Dams: General Design and Construction Considerations,” July 2004. <a href="https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf" rel="noopener nofollow">Direct PDF</a>. Typical bulking and shrinkage practices for earthwork are documented within USACE earthwork guidance.</p>
<p>Additionally, the volumetric methodology used here aligns with standard civil engineering practice and GIS implementations such as <a href="https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm" rel="noopener">Esri’s Cut/Fill Volume Calculation</a>, which compute volumes by integrating height differences over area.</p>
<p><strong>Statement:</strong> All calculations are rigorously based on the formulas and data provided by this source.</p>
<h2>The Formula Explained</h2>
<div class="formula-box">
<p>For each cell i with area A_i and adjusted height difference Δh_i between existing and design grades:</p>
<p class="formula">\( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \)</p>
<p class="formula">\( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \)</p>
<p>Adjustments for bulking (swell) and compaction (shrinkage):</p>
<p class="formula">\( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \)</p>
<p>Where t is topsoil strip thickness, s and c are decimals (e.g., 20% → 0.20).</p>
</div>
<h2>Glossary of Variables</h2>
<ul>
<li>Eexisting, Edesign: Existing and design elevations per area or grid cell (m or ft).</li>
<li>A: Area of the site (Simple mode) or uniform cell area (Grid mode) in m² or ft².</li>
<li>t: Topsoil strip thickness subtracted from existing elevation (m or ft).</li>
<li>Δh: Height difference. Positive → cut; negative → fill.</li>
<li>Vcut, Vfill: In-place volumes before bulking/compaction (m³ or yd³ as applicable).</li>
<li>s: Bulking (swell) fraction, e.g., 0.20 for 20%.</li>
<li>c: Compaction fraction, e.g., 0.10 for 10%.</li>
<li>Vcut, loose: Loose excavated volume after swell (used for haul/export).</li>
<li>Vborrow, loose: Loose borrow required to achieve compacted fill.</li>
</ul>
<h2>How It Works: A Step-by-Step Example</h2>
<p><strong>Scenario:</strong> Metric units. Area = 2,000 m². Average existing elevation = 101.2 m. Design elevation = 100.7 m. Topsoil strip t = 0.00 m. Swell s = 20% (0.20). Compaction c = 10% (0.10).</p>
<ol>
<li>Compute height difference: Δh = (101.2 − 0.00) − 100.7 = 0.5 m → Cut.</li>
<li>In-place volumes: Vcut = 0.5 × 2,000 = 1,000 m³; Vfill = 0.</li>
<li>Loose cut: Vcut, loose = 1,000 × (1 + 0.20) = 1,200 m³.</li>
<li>Borrow: Vborrow, loose = 0 ÷ (1 − 0.10) = 0 m³.</li>
<li>Balance: Export 1,200 m³ loose if not reused; import is 0.</li>
</ol>
<h2>Frequently Asked Questions (FAQ)</h2>
<h3>Do I need to enter negative numbers for fill?</h3>
<p>No. Enter actual elevations. The calculator detects whether each cell/area is cut (existing above design) or fill (existing below design).</p>
<h3>How accurate are results compared to 3D models?</h3>
<p>For conceptual estimates, this 2D height-difference method is standard. For final takeoffs, validate against your project’s digital terrain models (DTMs) or BIM.</p>
<h3>What values should I use for bulking and compaction?</h3>
<p>They depend on soil type and moisture. Typical ranges: granular soils 10–25% swell; clays 15–40%. Always confirm with geotechnical data and specs.</p>
<h3>Can I account for topsoil stripping?</h3>
<p>Yes. Enter the strip thickness; the calculator subtracts it from existing elevations before computing volumes.</p>
<h3>What unit conversions are shown?</h3>
<p>Primary outputs follow your unit setting. A secondary line shows the same volumes converted between m³ and yd³.</p>
<h3>How do I know if I need import or export?</h3>
<p>If loose cut exceeds borrow required, you have export. If borrow required exceeds loose cut, you need import. The Balance line summarizes this.</p>


<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[= (sel, ctx=document) =&gt; Array.from(ctx.querySelectorAll(sel)); // Elements const modeRadios =\]</div>
  <pre class="auditspine-mono">= (sel, ctx=document) =&gt; Array.from(ctx.querySelectorAll(sel)); // Elements const modeRadios =</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[('input[name="units"]'); const simplePane = $('#simple-pane'); const gridPane = $('#grid-pane'); const areaUnitSpan = $('#area-unit'); const cellAreaUnitSpan = $('#cell-area-unit'); const elevUnit1 = $('#elev-unit-1'); const elevUnit2 = $('#elev-unit-2'); const topsoilUnit = $('#topsoil-unit'); const inputs = { topsoil: $('#topsoil'), swell: $('#swell'), compaction: $('#compaction'), simpleArea: $('#simple-area'), simpleExisting: $('#simple-existing'), simpleDesign: $('#simple-design'), cellArea: $('#cell-area'), gridBody: $('#grid-body'), gridError: $('#grid-error'), }; const results = { cutInPlace: $('#cut-inplace'), fillInPlace: $('#fill-inplace'), netInPlace: $('#net-inplace'), looseCut: $('#loose-cut'), borrowLoose: $('#borrow-loose'), balance: $('#balance-text'), altUnits: $('#alt-units'), }; const errors = { topsoil: $('#topsoil-error'), swell: $('#swell-error'), compaction: $('#compaction-error'), simpleArea: $('#simple-area-error'), simpleExisting: $('#simple-existing-error'), simpleDesign: $('#simple-design-error'), cellArea: $('#cell-area-error'), }; const buttons = { addRow: $('#add-row'), add5Rows: $('#add-5-rows'), clearRows: $('#clear-rows'), }; // State let mode = 'simple'; // simple | grid let units = 'metric'; // metric | imperial // Utils const clamp = (val, min, max) =&gt; Math.min(Math.max(val, min), max); const toNumber = v =&gt; { const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,'')); return Number.isFinite(n) ? n : NaN; }; // Unit helpers const m3_to_yd3 = v =&gt; v * 1.30795062; const yd3_to_m3 = v =&gt; v * 0.764554858; const ft3_to_yd3 = v =&gt; v / 27; function formatNumber(n){ if (!Number.isFinite(n)) return '—'; return n.toLocaleString(undefined, {maximumFractionDigits: 2}); } function updateUnitLabels(){ if (units === 'metric'){ areaUnitSpan.textContent = 'm²'; cellAreaUnitSpan.textContent = 'm²'; elevUnit1.textContent = 'm'; elevUnit2.textContent = 'm'; topsoilUnit.textContent = 'm'; } else { areaUnitSpan.textContent = 'ft²'; cellAreaUnitSpan.textContent = 'ft²'; elevUnit1.textContent = 'ft'; elevUnit2.textContent = 'ft'; topsoilUnit.textContent = 'ft'; } } function toggleModeUI(){ if (mode === 'simple'){ simplePane.hidden = false; gridPane.hidden = true; } else { simplePane.hidden = true; gridPane.hidden = false; if (inputs.gridBody.children.length === 0){ addRows(5); } } } // Accessible tooltip toggles\]</div>
  <pre class="auditspine-mono">('input[name="units"]'); const simplePane = $('#simple-pane'); const gridPane = $('#grid-pane'); const areaUnitSpan = $('#area-unit'); const cellAreaUnitSpan = $('#cell-area-unit'); const elevUnit1 = $('#elev-unit-1'); const elevUnit2 = $('#elev-unit-2'); const topsoilUnit = $('#topsoil-unit'); const inputs = { topsoil: $('#topsoil'), swell: $('#swell'), compaction: $('#compaction'), simpleArea: $('#simple-area'), simpleExisting: $('#simple-existing'), simpleDesign: $('#simple-design'), cellArea: $('#cell-area'), gridBody: $('#grid-body'), gridError: $('#grid-error'), }; const results = { cutInPlace: $('#cut-inplace'), fillInPlace: $('#fill-inplace'), netInPlace: $('#net-inplace'), looseCut: $('#loose-cut'), borrowLoose: $('#borrow-loose'), balance: $('#balance-text'), altUnits: $('#alt-units'), }; const errors = { topsoil: $('#topsoil-error'), swell: $('#swell-error'), compaction: $('#compaction-error'), simpleArea: $('#simple-area-error'), simpleExisting: $('#simple-existing-error'), simpleDesign: $('#simple-design-error'), cellArea: $('#cell-area-error'), }; const buttons = { addRow: $('#add-row'), add5Rows: $('#add-5-rows'), clearRows: $('#clear-rows'), }; // State let mode = 'simple'; // simple | grid let units = 'metric'; // metric | imperial // Utils const clamp = (val, min, max) =&gt; Math.min(Math.max(val, min), max); const toNumber = v =&gt; { const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,'')); return Number.isFinite(n) ? n : NaN; }; // Unit helpers const m3_to_yd3 = v =&gt; v * 1.30795062; const yd3_to_m3 = v =&gt; v * 0.764554858; const ft3_to_yd3 = v =&gt; v / 27; function formatNumber(n){ if (!Number.isFinite(n)) return '—'; return n.toLocaleString(undefined, {maximumFractionDigits: 2}); } function updateUnitLabels(){ if (units === 'metric'){ areaUnitSpan.textContent = 'm²'; cellAreaUnitSpan.textContent = 'm²'; elevUnit1.textContent = 'm'; elevUnit2.textContent = 'm'; topsoilUnit.textContent = 'm'; } else { areaUnitSpan.textContent = 'ft²'; cellAreaUnitSpan.textContent = 'ft²'; elevUnit1.textContent = 'ft'; elevUnit2.textContent = 'ft'; topsoilUnit.textContent = 'ft'; } } function toggleModeUI(){ if (mode === 'simple'){ simplePane.hidden = false; gridPane.hidden = true; } else { simplePane.hidden = true; gridPane.hidden = false; if (inputs.gridBody.children.length === 0){ addRows(5); } } } // Accessible tooltip toggles</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[('#grid-body tr').forEach((tr, i) =&gt; { const idx = tr.querySelector('.row-index'); if (idx) idx.textContent = i + 1; const [existing, design, actionTd] = tr.querySelectorAll('td'); const inpExisting = tr.querySelector('td:nth-child(2) input'); const inpDesign = tr.querySelector('td:nth-child(3) input'); if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`); if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`); const btn = tr.querySelector('button.btn.secondary'); if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`); }); } function addRows(n=1){ for (let i=0; i&lt;n; i++){ const row = makeRow(inputs.gridBody.children.length); inputs.gridBody.appendChild(row); } } buttons.addRow.addEventListener('click', () =&gt; addRows(1)); buttons.add5Rows.addEventListener('click', () =&gt; addRows(5)); buttons.clearRows.addEventListener('click', () =&gt; { inputs.gridBody.innerHTML = ''; inputs.gridError.textContent = ''; calculate(); }); // Validation function setError(inputEl, errorEl, message){ if (!errorEl) return; if (message){ inputEl?.setAttribute('aria-invalid', 'true'); errorEl.textContent = message; } else { inputEl?.setAttribute('aria-invalid', 'false'); errorEl.textContent = ''; } } function validateRequired(inputEl, errorEl, opts={}){ const v = toNumber(inputEl.value); if (!Number.isFinite(v) || (opts.min != null &amp;&amp; v &lt; opts.min)){ setError(inputEl, errorEl, opts.message || 'Please enter a valid number.'); return false; } setError(inputEl, errorEl, ''); return true; } function validateFactors(){ const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'}); const c = toNumber(inputs.compaction.value); let ok2 = true; if (!Number.isFinite(c) || c &lt; 0 || c &gt;= 100){ setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.'); ok2 = false; } else { setError(inputs.compaction, errors.compaction, ''); } const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'}); return ok1 &amp;&amp; ok2 &amp;&amp; ok3; } // Event wiring modeRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { mode = e.target.value; toggleModeUI(); calculate(); })); unitRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { units = e.target.value; updateUnitLabels(); calculate(); })); [inputs.topsoil, inputs.swell, inputs.compaction, inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign, inputs.cellArea ].forEach(el =&gt; { if (!el) return; el.addEventListener('input', debounce(calculate, 100)); }); inputs.simpleArea.addEventListener('blur', () =&gt; validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'})); inputs.simpleExisting.addEventListener('blur', () =&gt; validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'})); inputs.simpleDesign.addEventListener('blur', () =&gt; validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'})); inputs.cellArea.addEventListener('blur', () =&gt; validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'})); // Debounce utility function debounce(fn, wait=120){ let t; return function(...args){ clearTimeout(t); t = setTimeout(() =&gt; fn.apply(this, args), wait); } } // Core calculation function calculate(){ if (!validateFactors()){ writeResults(0,0,0,0,0,'—',0,true); return; } const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0); const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0); const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9); let cut_inplace_m3 = 0; let fill_inplace_m3 = 0; if (mode === 'simple'){ const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}); const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}); const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}); if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; } const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0); const E = toNumber(inputs.simpleExisting.value) || 0; const D = toNumber(inputs.simpleDesign.value) || 0; const delta = (E - topsoil) - D; // positive -&gt; cut, negative -&gt; fill if (units === 'metric'){ if (delta &gt; 0) cut_inplace_m3 = delta * area; else fill_inplace_m3 = -delta * area; } else { // Imperial inputs: ft, ft². Convert ft³ -&gt; m³. const vol_ft3 = (delta &gt; 0 ? delta * area : -delta * area); const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³ if (delta &gt; 0) cut_inplace_m3 = vol_m3; else fill_inplace_m3 = vol_m3; } } else { // Grid const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}); if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; } const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0); let anyRow = false; inputs.gridError.textContent = '';\]</div>
  <pre class="auditspine-mono">('#grid-body tr').forEach((tr, i) =&gt; { const idx = tr.querySelector('.row-index'); if (idx) idx.textContent = i + 1; const [existing, design, actionTd] = tr.querySelectorAll('td'); const inpExisting = tr.querySelector('td:nth-child(2) input'); const inpDesign = tr.querySelector('td:nth-child(3) input'); if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`); if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`); const btn = tr.querySelector('button.btn.secondary'); if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`); }); } function addRows(n=1){ for (let i=0; i&lt;n; i++){ const row = makeRow(inputs.gridBody.children.length); inputs.gridBody.appendChild(row); } } buttons.addRow.addEventListener('click', () =&gt; addRows(1)); buttons.add5Rows.addEventListener('click', () =&gt; addRows(5)); buttons.clearRows.addEventListener('click', () =&gt; { inputs.gridBody.innerHTML = ''; inputs.gridError.textContent = ''; calculate(); }); // Validation function setError(inputEl, errorEl, message){ if (!errorEl) return; if (message){ inputEl?.setAttribute('aria-invalid', 'true'); errorEl.textContent = message; } else { inputEl?.setAttribute('aria-invalid', 'false'); errorEl.textContent = ''; } } function validateRequired(inputEl, errorEl, opts={}){ const v = toNumber(inputEl.value); if (!Number.isFinite(v) || (opts.min != null &amp;&amp; v &lt; opts.min)){ setError(inputEl, errorEl, opts.message || 'Please enter a valid number.'); return false; } setError(inputEl, errorEl, ''); return true; } function validateFactors(){ const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'}); const c = toNumber(inputs.compaction.value); let ok2 = true; if (!Number.isFinite(c) || c &lt; 0 || c &gt;= 100){ setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.'); ok2 = false; } else { setError(inputs.compaction, errors.compaction, ''); } const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'}); return ok1 &amp;&amp; ok2 &amp;&amp; ok3; } // Event wiring modeRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { mode = e.target.value; toggleModeUI(); calculate(); })); unitRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { units = e.target.value; updateUnitLabels(); calculate(); })); [inputs.topsoil, inputs.swell, inputs.compaction, inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign, inputs.cellArea ].forEach(el =&gt; { if (!el) return; el.addEventListener('input', debounce(calculate, 100)); }); inputs.simpleArea.addEventListener('blur', () =&gt; validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'})); inputs.simpleExisting.addEventListener('blur', () =&gt; validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'})); inputs.simpleDesign.addEventListener('blur', () =&gt; validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'})); inputs.cellArea.addEventListener('blur', () =&gt; validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'})); // Debounce utility function debounce(fn, wait=120){ let t; return function(...args){ clearTimeout(t); t = setTimeout(() =&gt; fn.apply(this, args), wait); } } // Core calculation function calculate(){ if (!validateFactors()){ writeResults(0,0,0,0,0,'—',0,true); return; } const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0); const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0); const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9); let cut_inplace_m3 = 0; let fill_inplace_m3 = 0; if (mode === 'simple'){ const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}); const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}); const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}); if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; } const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0); const E = toNumber(inputs.simpleExisting.value) || 0; const D = toNumber(inputs.simpleDesign.value) || 0; const delta = (E - topsoil) - D; // positive -&gt; cut, negative -&gt; fill if (units === 'metric'){ if (delta &gt; 0) cut_inplace_m3 = delta * area; else fill_inplace_m3 = -delta * area; } else { // Imperial inputs: ft, ft². Convert ft³ -&gt; m³. const vol_ft3 = (delta &gt; 0 ? delta * area : -delta * area); const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³ if (delta &gt; 0) cut_inplace_m3 = vol_m3; else fill_inplace_m3 = vol_m3; } } else { // Grid const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}); if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; } const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0); let anyRow = false; inputs.gridError.textContent = '';</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">For each cell i with area A_i and adjusted height difference Δh_i between existing and design grades: \( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \) \( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \) Adjustments for bulking (swell) and compaction (shrinkage): \( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \) Where t is topsoil strip thickness, s and c are decimals (e.g., 20% → 0.20).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \)</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Direct PDF</strong> — publications.usace.army.mil · Accessed 2026-01-19<br><a href="https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf" target="_blank" rel="nofollow noopener">https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf</a></li>
<li><strong>Esri’s Cut/Fill Volume Calculation</strong> — enterprise.arcgis.com · Accessed 2026-01-19<br><a href="https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm" target="_blank" rel="nofollow noopener">https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</section>
</div>
</main>
<footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>



<!-- Standard Footer --> 
<script defer="">
    (function(){
      'use strict';

      // Shortcuts
      const $ = (sel, ctx=document) => ctx.querySelector(sel);
      const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

      // Elements
      const modeRadios = $$('input[name="mode"]');
      const unitRadios = $$('input[name="units"]');

      const simplePane = $('#simple-pane');
      const gridPane = $('#grid-pane');

      const areaUnitSpan = $('#area-unit');
      const cellAreaUnitSpan = $('#cell-area-unit');
      const elevUnit1 = $('#elev-unit-1');
      const elevUnit2 = $('#elev-unit-2');
      const topsoilUnit = $('#topsoil-unit');

      const inputs = {
        topsoil: $('#topsoil'),
        swell: $('#swell'),
        compaction: $('#compaction'),

        simpleArea: $('#simple-area'),
        simpleExisting: $('#simple-existing'),
        simpleDesign: $('#simple-design'),

        cellArea: $('#cell-area'),
        gridBody: $('#grid-body'),
        gridError: $('#grid-error'),
      };

      const results = {
        cutInPlace: $('#cut-inplace'),
        fillInPlace: $('#fill-inplace'),
        netInPlace: $('#net-inplace'),
        looseCut: $('#loose-cut'),
        borrowLoose: $('#borrow-loose'),
        balance: $('#balance-text'),
        altUnits: $('#alt-units'),
      };

      const errors = {
        topsoil: $('#topsoil-error'),
        swell: $('#swell-error'),
        compaction: $('#compaction-error'),
        simpleArea: $('#simple-area-error'),
        simpleExisting: $('#simple-existing-error'),
        simpleDesign: $('#simple-design-error'),
        cellArea: $('#cell-area-error'),
      };

      const buttons = {
        addRow: $('#add-row'),
        add5Rows: $('#add-5-rows'),
        clearRows: $('#clear-rows'),
      };

      // State
      let mode = 'simple'; // simple | grid
      let units = 'metric'; // metric | imperial

      // Utils
      const clamp = (val, min, max) => Math.min(Math.max(val, min), max);
      const toNumber = v => {
        const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,''));
        return Number.isFinite(n) ? n : NaN;
      };

      // Unit helpers
      const m3_to_yd3 = v => v * 1.30795062;
      const yd3_to_m3 = v => v * 0.764554858;
      const ft3_to_yd3 = v => v / 27;

      function formatNumber(n){
        if (!Number.isFinite(n)) return '—';
        return n.toLocaleString(undefined, {maximumFractionDigits: 2});
      }

      function updateUnitLabels(){
        if (units === 'metric'){
          areaUnitSpan.textContent = 'm²';
          cellAreaUnitSpan.textContent = 'm²';
          elevUnit1.textContent = 'm';
          elevUnit2.textContent = 'm';
          topsoilUnit.textContent = 'm';
        } else {
          areaUnitSpan.textContent = 'ft²';
          cellAreaUnitSpan.textContent = 'ft²';
          elevUnit1.textContent = 'ft';
          elevUnit2.textContent = 'ft';
          topsoilUnit.textContent = 'ft';
        }
      }

      function toggleModeUI(){
        if (mode === 'simple'){
          simplePane.hidden = false;
          gridPane.hidden = true;
        } else {
          simplePane.hidden = true;
          gridPane.hidden = false;
          if (inputs.gridBody.children.length === 0){
            addRows(5);
          }
        }
      }

      // Accessible tooltip toggles
      $$('.tooltip-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.getAttribute('data-tooltip');
          const tip = document.getElementById(id);
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          tip.setAttribute('aria-hidden', String(expanded));
        });
        btn.addEventListener('keydown', (e) => {
          if (e.key === 'Escape'){
            const id = btn.getAttribute('data-tooltip');
            const tip = document.getElementById(id);
            btn.setAttribute('aria-expanded', 'false');
            tip.setAttribute('aria-hidden', 'true');
          }
        });
      });

      // Grid rows
      function makeRow(index){
        const tr = document.createElement('tr');

        const tdIndex = document.createElement('td');
        tdIndex.className = 'row-index';
        tdIndex.textContent = index + 1;

        const tdExisting = document.createElement('td');
        const inpExisting = document.createElement('input');
        inpExisting.type = 'number'; inpExisting.step = 'any'; inpExisting.className = 'form-control';
        inpExisting.placeholder = 'Existing';
        inpExisting.setAttribute('aria-label', `Row ${index+1} existing elevation`);
        inpExisting.addEventListener('input', debounce(calculate, 80));
        inpExisting.addEventListener('blur', () => validateRequired(inpExisting, null));

        const tdDesign = document.createElement('td');
        const inpDesign = document.createElement('input');
        inpDesign.type = 'number'; inpDesign.step = 'any'; inpDesign.className = 'form-control';
        inpDesign.placeholder = 'Design';
        inpDesign.setAttribute('aria-label', `Row ${index+1} design elevation`);
        inpDesign.addEventListener('input', debounce(calculate, 80));
        inpDesign.addEventListener('blur', () => validateRequired(inpDesign, null));

        const tdActions = document.createElement('td');
        const btnRemove = document.createElement('button');
        btnRemove.type = 'button';
        btnRemove.className = 'btn secondary';
        btnRemove.textContent = 'Remove';
        btnRemove.setAttribute('aria-label', `Remove row ${index+1}`);
        btnRemove.addEventListener('click', () => {
          tr.remove();
          refreshRowIndices();
          calculate();
        });

        tdExisting.appendChild(inpExisting);
        tdDesign.appendChild(inpDesign);
        tdActions.appendChild(btnRemove);

        tr.appendChild(tdIndex);
        tr.appendChild(tdExisting);
        tr.appendChild(tdDesign);
        tr.appendChild(tdActions);
        return tr;
      }

      function refreshRowIndices(){
        $$('#grid-body tr').forEach((tr, i) => {
          const idx = tr.querySelector('.row-index');
          if (idx) idx.textContent = i + 1;
          const [existing, design, actionTd] = tr.querySelectorAll('td');
          const inpExisting = tr.querySelector('td:nth-child(2) input');
          const inpDesign = tr.querySelector('td:nth-child(3) input');
          if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`);
          if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`);
          const btn = tr.querySelector('button.btn.secondary');
          if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`);
        });
      }

      function addRows(n=1){
        for (let i=0; i<n; i++){
          const row = makeRow(inputs.gridBody.children.length);
          inputs.gridBody.appendChild(row);
        }
      }

      buttons.addRow.addEventListener('click', () => addRows(1));
      buttons.add5Rows.addEventListener('click', () => addRows(5));
      buttons.clearRows.addEventListener('click', () => {
        inputs.gridBody.innerHTML = '';
        inputs.gridError.textContent = '';
        calculate();
      });

      // Validation
      function setError(inputEl, errorEl, message){
        if (!errorEl) return;
        if (message){
          inputEl?.setAttribute('aria-invalid', 'true');
          errorEl.textContent = message;
        } else {
          inputEl?.setAttribute('aria-invalid', 'false');
          errorEl.textContent = '';
        }
      }
      function validateRequired(inputEl, errorEl, opts={}){
        const v = toNumber(inputEl.value);
        if (!Number.isFinite(v) || (opts.min != null && v < opts.min)){
          setError(inputEl, errorEl, opts.message || 'Please enter a valid number.');
          return false;
        }
        setError(inputEl, errorEl, '');
        return true;
      }
      function validateFactors(){
        const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'});
        const c = toNumber(inputs.compaction.value);
        let ok2 = true;
        if (!Number.isFinite(c) || c < 0 || c >= 100){
          setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.');
          ok2 = false;
        } else {
          setError(inputs.compaction, errors.compaction, '');
        }
        const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'});
        return ok1 && ok2 && ok3;
      }

      // Event wiring
      modeRadios.forEach(r => r.addEventListener('change', e => {
        mode = e.target.value;
        toggleModeUI();
        calculate();
      }));
      unitRadios.forEach(r => r.addEventListener('change', e => {
        units = e.target.value;
        updateUnitLabels();
        calculate();
      }));

      [inputs.topsoil, inputs.swell, inputs.compaction,
       inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign,
       inputs.cellArea
      ].forEach(el => {
        if (!el) return;
        el.addEventListener('input', debounce(calculate, 100));
      });

      inputs.simpleArea.addEventListener('blur', () => validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}));
      inputs.simpleExisting.addEventListener('blur', () => validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}));
      inputs.simpleDesign.addEventListener('blur', () => validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}));
      inputs.cellArea.addEventListener('blur', () => validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}));

      // Debounce utility
      function debounce(fn, wait=120){
        let t; return function(...args){
          clearTimeout(t); t = setTimeout(() => fn.apply(this, args), wait);
        }
      }

      // Core calculation
      function calculate(){
        if (!validateFactors()){
          writeResults(0,0,0,0,0,'—',0,true);
          return;
        }
        const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0);
        const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0);
        const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9);

        let cut_inplace_m3 = 0;
        let fill_inplace_m3 = 0;

        if (mode === 'simple'){
          const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'});
          const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'});
          const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'});
          if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; }

          const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0);
          const E = toNumber(inputs.simpleExisting.value) || 0;
          const D = toNumber(inputs.simpleDesign.value) || 0;

          const delta = (E - topsoil) - D; // positive -> cut, negative -> fill

          if (units === 'metric'){
            if (delta > 0) cut_inplace_m3 = delta * area;
            else fill_inplace_m3 = -delta * area;
          } else {
            // Imperial inputs: ft, ft². Convert ft³ -> m³.
            const vol_ft3 = (delta > 0 ? delta * area : -delta * area);
            const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³
            if (delta > 0) cut_inplace_m3 = vol_m3;
            else fill_inplace_m3 = vol_m3;
          }
        } else {
          // Grid
          const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'});
          if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; }
          const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0);

          let anyRow = false;
          inputs.gridError.textContent = '';

          $$('#grid-body tr').forEach(tr => {
            const exEl = tr.querySelector('td:nth-child(2) input');
            const deEl = tr.querySelector('td:nth-child(3) input');
            const E = toNumber(exEl.value);
            const D = toNumber(deEl.value);
            if (!Number.isFinite(E) || !Number.isFinite(D)) return;
            anyRow = true;
            const delta = (E - topsoil) - D;

            if (units === 'metric'){
              if (delta > 0) cut_inplace_m3 += delta * cellArea;
              else fill_inplace_m3 += -delta * cellArea;
            } else {
              const vol_ft3 = (delta > 0 ? delta * cellArea : -delta * cellArea);
              const vol_m3 = vol_ft3 * 0.028316846592;
              if (delta > 0) cut_inplace_m3 += vol_m3;
              else fill_inplace_m3 += vol_m3;
            }
          });

          if (!anyRow){
            inputs.gridError.textContent = 'Enter at least one complete row (existing and design elevations).';
            writeResults(0,0,0,0,0,'—',0,true);
            return;
          }
        }

        // Guard against tiny floating errors
        cut_inplace_m3 = Math.max(0, cut_inplace_m3);
        fill_inplace_m3 = Math.max(0, fill_inplace_m3);

        const net_inplace_m3 = cut_inplace_m3 - fill_inplace_m3;

        const swell = swellPct / 100;
        const comp = compPct / 100;

        const loose_cut_m3 = cut_inplace_m3 * (1 + swell);
        const borrow_loose_m3 = comp >= 1 ? Infinity : (fill_inplace_m3 / (1 - comp));

        // Balance: compare loose cut vs borrow loose
        let balanceText = 'Balanced';
        const diff = loose_cut_m3 - borrow_loose_m3;
        if (Math.abs(diff) > 1e-6){
          balanceText = diff > 0 ? 'Export required' : 'Import required';
        }

        // Primary unit display and alternate conversion
        const primary = (units === 'metric') ? 'm³' : 'yd³';
        const display = {
          cut: units === 'metric' ? cut_inplace_m3 : m3_to_yd3(cut_inplace_m3),
          fill: units === 'metric' ? fill_inplace_m3 : m3_to_yd3(fill_inplace_m3),
          net: units === 'metric' ? net_inplace_m3 : m3_to_yd3(net_inplace_m3),
          looseCut: units === 'metric' ? loose_cut_m3 : m3_to_yd3(loose_cut_m3),
          borrowLoose: units === 'metric' ? borrow_loose_m3 : m3_to_yd3(borrow_loose_m3)
        };

        // Alternate units
        const altLabel = (units === 'metric') ? 'yd³' : 'm³';
        const altCut = (units === 'metric') ? m3_to_yd3(cut_inplace_m3) : yd3_to_m3(display.cut);
        const altFill = (units === 'metric') ? m3_to_yd3(fill_inplace_m3) : yd3_to_m3(display.fill);
        const altNet = (units === 'metric') ? m3_to_yd3(net_inplace_m3) : yd3_to_m3(display.net);

        writeResults(display.cut, display.fill, display.net, display.looseCut, display.borrowLoose, balanceText, (altCut + altFill + altNet), false, primary, altLabel, {altCut, altFill, altNet});
      }

      function writeResults(cut, fill, net, looseCut, borrowLoose, balanceText, altSum, invalid, primary='m³', altLabel='yd³', altValues=null){
        results.cutInPlace.textContent = `${formatNumber(cut)} ${primary}`;
        results.fillInPlace.textContent = `${formatNumber(fill)} ${primary}`;
        const sign = net >= 0 ? '' : '−';
        results.netInPlace.textContent = `${formatNumber(Math.abs(net))} ${primary} ${net>=0?'(net cut)':'(net fill)'}`;
        results.looseCut.textContent = `${formatNumber(looseCut)} ${primary}`;
        results.borrowLoose.textContent = `${formatNumber(borrowLoose)} ${primary}`;
        results.balance.textContent = balanceText;

        if (altValues){
          const {altCut, altFill, altNet} = altValues;
          results.altUnits.textContent = `Cut ${formatNumber(altCut)} ${altLabel} · Fill ${formatNumber(altFill)} ${altLabel} · Net ${formatNumber(altNet)} ${altLabel}`;
        } else {
          results.altUnits.textContent = `${formatNumber(altSum)} ${altLabel}`;
        }
      }

      // Initialize
      updateUnitLabels();
      toggleModeUI();
      calculate();

      // Prefill one row for better UX in grid mode
      function initGrid(){
        if (inputs.gridBody.children.length === 0){
          addRows(5);
        }
      }

      // Accessibility: pressing Enter on inputs triggers calc immediately
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter'){
          calculate();
        }
      });
    })();
  </script>

<script defer="" src="/assets/js/mobile-menu.js"></script>
<script defer="" src="/assets/js/page-enhancements.js"></script>
</body></html>
]], displayMath: [['\\[','\\]']] }, svg: { fontCache: 'global' } };
</script>
<script defer="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Excavation (Cut and Fill) Calculator",
  "url": "https://calcdomain.com/cut-and-fill",
  "description": "Professional cut and fill calculator for construction. Compute in-place cut and fill volumes using simple or grid methods, with bulking (swell) and compaction factors for import/export planning.",
  "inLanguage": "en",
  "isPartOf": {
    "@type": "CreativeWorkSeries",
    "name": "Construction Calculators - General"
  },
  "about": [
    {
      "@type": "Thing",
      "name": "Construction"
    },
    {
      "@type": "Thing",
      "name": "Earthwork"
    },
    {
      "@type": "Thing",
      "name": "Cut and Fill"
    }
  ],
  "dateModified": "2026-01-19",
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "Cut and Fill: A Worked Example",
      "description": "Step-by-step example demonstrating how to calculate cut and fill volumes with bulking and compaction adjustments.",
      "supply": [
        {
          "@type": "HowToSupply",
          "name": "Site plan with elevations"
        },
        {
          "@type": "HowToSupply",
          "name": "Design grading plan"
        }
      ],
      "tool": [
        {
          "@type": "HowToTool",
          "name": "Excavation (Cut and Fill) Calculator"
        }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "name": "Set units and factors",
          "text": "Choose Metric or Imperial. Set bulking (swell) to 20% and compaction (shrinkage) to 10%."
        },
        {
          "@type": "HowToStep",
          "name": "Enter area and elevations",
          "text": "Area = 2,000 m², average existing elevation = 101.2 m, average design elevation = 100.7 m. No topsoil strip."
        },
        {
          "@type": "HowToStep",
          "name": "Calculate in-place volumes",
          "text": "Height difference Δh = 0.5 m. Cut_in_place = Δh × Area = 0.5 × 2,000 = 1,000 m³. Fill_in_place = 0."
        },
        {
          "@type": "HowToStep",
          "name": "Adjust for haul and borrow",
          "text": "Loose cut volume = 1,000 × (1 + 0.20) = 1,200 m³. Borrow needed = Fill_in_place ÷ (1 − 0.10) = 0."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is cut and fill in earthwork?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Cut is the volume of soil excavated from higher elevations; fill is the volume needed to raise lower areas to the design grade."
          }
        },
        {
          "@type": "Question",
          "name": "What are bulking (swell) and compaction factors?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Bulking (swell) increases volume when soil is excavated and loosens. Compaction (shrinkage) reduces the volume when loose soil is compacted in place. They are expressed as percentages used to convert between in-place and loose volumes."
          }
        },
        {
          "@type": "Question",
          "name": "Does the calculator support a grid-based method?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Use the Grid mode to enter elevations per cell along with a uniform cell area. The tool sums cut and fill across all cells."
          }
        },
        {
          "@type": "Question",
          "name": "How is topsoil stripping handled?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The specified strip thickness is subtracted from existing elevations before computing differences, increasing cut volumes and reducing fills accordingly."
          }
        },
        {
          "@type": "Question",
          "name": "Which units are supported?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Metric (meters, square meters, cubic meters) and Imperial (feet, square feet, cubic yards). The tool also displays both m³ and yd³ for convenience."
          }
        },
        {
          "@type": "Question",
          "name": "Are the outputs suitable for bidding?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "They provide reliable conceptual estimates. Final bid quantities should be verified against detailed design models, survey data, and project specifications."
          }
        }
      ]
    }
  ],
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  }
}</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer=""></script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body>

<a class="skip-link" href="#main-content">Skip to main content</a>
<header class="bg-white shadow-sm sticky top-0 z-50">
  <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
    <div class="flex justify-between items-center">
      <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>

      <div class="w-full max-w-md hidden md:block mx-8">
        <div class="relative">
          <input
            type="search"
            id="search-input"
            placeholder="Search for a calculator..."
            class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            autocomplete="off"
          />
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 0 0114 0z"></path>
          </svg>
          <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
        </div>
      </div>

      <div class="hidden md:flex items-center space-x-6">
        <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
        <a href="https://calcdomain.com/#categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
      </div>

      <button
        id="mobile-menu-toggle"
        class="md:hidden p-2"
        aria-controls="mobile-menu"
        aria-expanded="false"
        aria-label="Open menu"
        type="button"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
      <div class="mb-4">
        <div class="relative">
          <input
            type="search"
            id="mobile-search-input"
            placeholder="Search calculators..."
            class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 0 0114 0z"></path>
          </svg>
        </div>
      </div>
      <div class="space-y-2">
        <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
        <a href="https://calcdomain.com#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
      </div>
    </nav>
  </nav>
</header>
<main class="container" id="main-content" role="main">
<nav aria-label="Breadcrumb" class="mb-6 text-sm text-gray-600">
  <ol class="flex flex-wrap gap-2">
    <li><a href="https://calcdomain.com/" class="text-blue-600 hover:underline">Home</a></li>
    <li aria-hidden="true">›</li>
    <li><a href="https://calcdomain.com/categories/construction" class="text-blue-600 hover:underline">Construction</a></li>
    <li aria-hidden="true">›</li>
    <li><a href="https://calcdomain.com/subcategories/construction-sitework-aggregates-and-asphalt" class="text-blue-600 hover:underline">Construction Sitework, Aggregates &amp; Asphalt</a></li>
  </ol>
</nav>
<h1>Excavation (Cut and Fill) Calculator</h1>
<p>This cut and fill calculator helps estimate excavation and embankment volumes for earthwork planning. Use Simple mode for average grades or Grid mode for per-cell elevation differences, then apply bulking (swell) and compaction to plan import/export.</p>
<div class="layout" id="calculator-layout">
<section aria-labelledby="calculator-heading" class="card" id="calculator">
<h2 class="sr-only" id="calculator-heading">Calculator Inputs</h2>
<fieldset>
<legend>Calculation mode</legend>
<div aria-label="Choose calculation mode" class="segmented" role="radiogroup">
<input checked="" id="mode-simple" name="mode" type="radio" value="simple">
<label for="mode-simple">Simple</label>
<input id="mode-grid" name="mode" type="radio" value="grid">
<label for="mode-grid">Grid</label>
</div>
</fieldset>
<fieldset>
<legend>Units</legend>
<div aria-label="Choose unit system" class="segmented" role="radiogroup">
<input checked="" id="unit-metric" name="units" type="radio" value="metric">
<label for="unit-metric">Metric (m, m², m³)</label>
<input id="unit-imperial" name="units" type="radio" value="imperial">
<label for="unit-imperial">Imperial (ft, ft², yd³)</label>
</div>
</fieldset>
<!-- Shared factors -->
<div class="form-group">
<div class="inline-help">
<label for="topsoil">Topsoil strip thickness</label>
<button aria-controls="tip-topsoil" aria-expanded="false" aria-label="Explain topsoil strip" class="tooltip-btn" data-tooltip="tip-topsoil" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="topsoil-help tip-topsoil topsoil-error" class="form-control" id="topsoil" inputmode="decimal" min="0" step="any" type="number" value="0">
<span class="suffix" id="topsoil-unit">m</span>
</div>
<div class="sr-only" id="topsoil-help">Topsoil stripping is subtracted from existing elevations before computing cut/fill.</div>
<div aria-hidden="true" class="tooltip" id="tip-topsoil" role="note">
            The specified thickness of topsoil to strip before grading. It is subtracted from existing elevations prior to calculating cut and fill.
          </div>
<div aria-live="polite" class="error" id="topsoil-error" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="swell">Bulking (swell) of excavated material (%)</label>
<button aria-controls="tip-swell" aria-expanded="false" aria-label="Explain bulking" class="tooltip-btn" data-tooltip="tip-swell" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="tip-swell swell-error" aria-required="true" class="form-control" id="swell" inputmode="decimal" min="0" step="any" type="number" value="20">
<span class="suffix">%</span>
</div>
<div aria-hidden="true" class="tooltip" id="tip-swell" role="note">
            Bulking (swell) increases volume when soil is excavated and loosened. Example: 20% swell means loose volume is 1.20× the in-place volume.
          </div>
<div aria-live="polite" class="error" id="swell-error" role="alert"></div>
</div>
<div class="form-group">
<div class="inline-help">
<label for="compaction">Compaction (shrinkage) for fill (%)</label>
<button aria-controls="tip-compaction" aria-expanded="false" aria-label="Explain compaction" class="tooltip-btn" data-tooltip="tip-compaction" type="button">?</button>
</div>
<div class="input-row">
<input aria-describedby="tip-compaction compaction-error" aria-required="true" class="form-control" id="compaction" inputmode="decimal" max="99.9" min="0" step="any" type="number" value="10">
<span class="suffix">%</span>
</div>
<div aria-hidden="true" class="tooltip" id="tip-compaction" role="note">
            Compaction reduces the volume of loose soil placed in fill. Borrow needed = Fill in-place ÷ (1 − compaction). Example: 10% compaction → divide by 0.90.
          </div>
<div aria-live="polite" class="error" id="compaction-error" role="alert"></div>
</div>
<!-- Simple mode -->
<div aria-labelledby="simple-title" id="simple-pane" role="region">
<h3 id="simple-title">Simple mode inputs</h3>
<div class="form-group">
<label for="simple-area">Area to grade *</label>
<div class="input-row">
<input aria-describedby="simple-area-error" aria-required="true" class="form-control" id="simple-area" inputmode="decimal" min="0" placeholder="e.g., 2000" step="any" type="number">
<span class="suffix" id="area-unit">m²</span>
</div>
<div aria-live="polite" class="error" id="simple-area-error" role="alert"></div>
</div>
<div class="form-group">
<label for="simple-existing">Average existing elevation *</label>
<div class="input-row">
<input aria-describedby="simple-existing-error" aria-required="true" class="form-control" id="simple-existing" inputmode="decimal" placeholder="e.g., 101.2" step="any" type="number">
<span class="suffix" id="elev-unit-1">m</span>
</div>
<div aria-live="polite" class="error" id="simple-existing-error" role="alert"></div>
</div>
<div class="form-group">
<label for="simple-design">Average design elevation *</label>
<div class="input-row">
<input aria-describedby="simple-design-error" aria-required="true" class="form-control" id="simple-design" inputmode="decimal" placeholder="e.g., 100.7" step="any" type="number">
<span class="suffix" id="elev-unit-2">m</span>
</div>
<div aria-live="polite" class="error" id="simple-design-error" role="alert"></div>
</div>
</div>
<!-- Grid mode -->
<div aria-labelledby="grid-title" hidden="" id="grid-pane" role="region">
<h3 id="grid-title">Grid mode inputs</h3>
<div class="form-group">
<label for="cell-area">Uniform cell area *</label>
<div class="input-row">
<input aria-describedby="cell-area-error" aria-required="true" class="form-control" id="cell-area" inputmode="decimal" min="0" placeholder="e.g., 100" step="any" type="number">
<span class="suffix" id="cell-area-unit">m²</span>
</div>
<div aria-live="polite" class="error" id="cell-area-error" role="alert"></div>
</div>
<div aria-live="polite" class="form-group">
<div aria-labelledby="grid-table-caption" class="table-wrap" role="group">
<table>
<caption class="sr-only" id="grid-table-caption">Grid cells with existing and design elevations</caption>
<thead>
<tr>
<th class="row-index" scope="col">#</th>
<th scope="col">Existing elevation</th>
<th scope="col">Design elevation</th>
<th scope="col"><span class="sr-only">Actions</span></th>
</tr>
</thead>
<tbody id="grid-body">
<!-- Rows injected by JS -->
</tbody>
</table>
</div>
<div class="form-group" style="display:flex; gap:.5rem; margin-top:.75rem;">
<button class="btn secondary" id="add-row" type="button">Add row</button>
<button aria-label="Add five rows" class="btn secondary" id="add-5-rows" type="button">Add 5 rows</button>
<button class="btn secondary" id="clear-rows" type="button">Clear all</button>
</div>
<div aria-live="polite" class="error" id="grid-error" role="alert"></div>
</div>
</div>
<div aria-atomic="true" aria-live="polite" class="results" id="results">
<h3>Results</h3>
<div class="result-item">
<span class="result-label">Total cut (in-place)</span>
<span class="result-value" id="cut-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Total fill (in-place)</span>
<span class="result-value" id="fill-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Net volume (cut − fill, in-place)</span>
<span class="result-value" id="net-inplace">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Loose cut volume (for haul)</span>
<span class="result-value" id="loose-cut">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Borrow needed (loose)</span>
<span class="result-value" id="borrow-loose">0.00 m³</span>
</div>
<div class="result-item">
<span class="result-label">Balance</span>
<span class="result-value" id="balance-text">Balanced</span>
</div>
<div class="result-item">
<span class="result-label">Also shown (conversion)</span>
<span class="result-value" id="alt-units">0.00 yd³</span>
</div>
</div>
</section>
<section aria-label="Authoritative content" class="card">
<article>
<h2>Data Source and Methodology</h2>
<p><strong>Authoritative Data Source:</strong> US Army Corps of Engineers (USACE), Engineer Manual EM 1110-2-2300 — “Earth and Rock-Fill Dams: General Design and Construction Considerations,” July 2004. <a href="https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf" rel="noopener nofollow">Direct PDF</a>. Typical bulking and shrinkage practices for earthwork are documented within USACE earthwork guidance.</p>
<p>Additionally, the volumetric methodology used here aligns with standard civil engineering practice and GIS implementations such as <a href="https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm" rel="noopener">Esri’s Cut/Fill Volume Calculation</a>, which compute volumes by integrating height differences over area.</p>
<p><strong>Statement:</strong> All calculations are rigorously based on the formulas and data provided by this source.</p>
<h2>The Formula Explained</h2>
<div class="formula-box">
<p>For each cell i with area A_i and adjusted height difference Δh_i between existing and design grades:</p>
<p class="formula">\( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \)</p>
<p class="formula">\( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \)</p>
<p>Adjustments for bulking (swell) and compaction (shrinkage):</p>
<p class="formula">\( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \)</p>
<p>Where t is topsoil strip thickness, s and c are decimals (e.g., 20% → 0.20).</p>
</div>
<h2>Glossary of Variables</h2>
<ul>
<li>Eexisting, Edesign: Existing and design elevations per area or grid cell (m or ft).</li>
<li>A: Area of the site (Simple mode) or uniform cell area (Grid mode) in m² or ft².</li>
<li>t: Topsoil strip thickness subtracted from existing elevation (m or ft).</li>
<li>Δh: Height difference. Positive → cut; negative → fill.</li>
<li>Vcut, Vfill: In-place volumes before bulking/compaction (m³ or yd³ as applicable).</li>
<li>s: Bulking (swell) fraction, e.g., 0.20 for 20%.</li>
<li>c: Compaction fraction, e.g., 0.10 for 10%.</li>
<li>Vcut, loose: Loose excavated volume after swell (used for haul/export).</li>
<li>Vborrow, loose: Loose borrow required to achieve compacted fill.</li>
</ul>
<h2>How It Works: A Step-by-Step Example</h2>
<p><strong>Scenario:</strong> Metric units. Area = 2,000 m². Average existing elevation = 101.2 m. Design elevation = 100.7 m. Topsoil strip t = 0.00 m. Swell s = 20% (0.20). Compaction c = 10% (0.10).</p>
<ol>
<li>Compute height difference: Δh = (101.2 − 0.00) − 100.7 = 0.5 m → Cut.</li>
<li>In-place volumes: Vcut = 0.5 × 2,000 = 1,000 m³; Vfill = 0.</li>
<li>Loose cut: Vcut, loose = 1,000 × (1 + 0.20) = 1,200 m³.</li>
<li>Borrow: Vborrow, loose = 0 ÷ (1 − 0.10) = 0 m³.</li>
<li>Balance: Export 1,200 m³ loose if not reused; import is 0.</li>
</ol>
<h2>Frequently Asked Questions (FAQ)</h2>
<h3>Do I need to enter negative numbers for fill?</h3>
<p>No. Enter actual elevations. The calculator detects whether each cell/area is cut (existing above design) or fill (existing below design).</p>
<h3>How accurate are results compared to 3D models?</h3>
<p>For conceptual estimates, this 2D height-difference method is standard. For final takeoffs, validate against your project’s digital terrain models (DTMs) or BIM.</p>
<h3>What values should I use for bulking and compaction?</h3>
<p>They depend on soil type and moisture. Typical ranges: granular soils 10–25% swell; clays 15–40%. Always confirm with geotechnical data and specs.</p>
<h3>Can I account for topsoil stripping?</h3>
<p>Yes. Enter the strip thickness; the calculator subtracts it from existing elevations before computing volumes.</p>
<h3>What unit conversions are shown?</h3>
<p>Primary outputs follow your unit setting. A secondary line shows the same volumes converted between m³ and yd³.</p>
<h3>How do I know if I need import or export?</h3>
<p>If loose cut exceeds borrow required, you have export. If borrow required exceeds loose cut, you need import. The Balance line summarizes this.</p>


<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[= (sel, ctx=document) =&gt; Array.from(ctx.querySelectorAll(sel)); // Elements const modeRadios =\]</div>
  <pre class="auditspine-mono">= (sel, ctx=document) =&gt; Array.from(ctx.querySelectorAll(sel)); // Elements const modeRadios =</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[('input[name="units"]'); const simplePane = $('#simple-pane'); const gridPane = $('#grid-pane'); const areaUnitSpan = $('#area-unit'); const cellAreaUnitSpan = $('#cell-area-unit'); const elevUnit1 = $('#elev-unit-1'); const elevUnit2 = $('#elev-unit-2'); const topsoilUnit = $('#topsoil-unit'); const inputs = { topsoil: $('#topsoil'), swell: $('#swell'), compaction: $('#compaction'), simpleArea: $('#simple-area'), simpleExisting: $('#simple-existing'), simpleDesign: $('#simple-design'), cellArea: $('#cell-area'), gridBody: $('#grid-body'), gridError: $('#grid-error'), }; const results = { cutInPlace: $('#cut-inplace'), fillInPlace: $('#fill-inplace'), netInPlace: $('#net-inplace'), looseCut: $('#loose-cut'), borrowLoose: $('#borrow-loose'), balance: $('#balance-text'), altUnits: $('#alt-units'), }; const errors = { topsoil: $('#topsoil-error'), swell: $('#swell-error'), compaction: $('#compaction-error'), simpleArea: $('#simple-area-error'), simpleExisting: $('#simple-existing-error'), simpleDesign: $('#simple-design-error'), cellArea: $('#cell-area-error'), }; const buttons = { addRow: $('#add-row'), add5Rows: $('#add-5-rows'), clearRows: $('#clear-rows'), }; // State let mode = 'simple'; // simple | grid let units = 'metric'; // metric | imperial // Utils const clamp = (val, min, max) =&gt; Math.min(Math.max(val, min), max); const toNumber = v =&gt; { const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,'')); return Number.isFinite(n) ? n : NaN; }; // Unit helpers const m3_to_yd3 = v =&gt; v * 1.30795062; const yd3_to_m3 = v =&gt; v * 0.764554858; const ft3_to_yd3 = v =&gt; v / 27; function formatNumber(n){ if (!Number.isFinite(n)) return '—'; return n.toLocaleString(undefined, {maximumFractionDigits: 2}); } function updateUnitLabels(){ if (units === 'metric'){ areaUnitSpan.textContent = 'm²'; cellAreaUnitSpan.textContent = 'm²'; elevUnit1.textContent = 'm'; elevUnit2.textContent = 'm'; topsoilUnit.textContent = 'm'; } else { areaUnitSpan.textContent = 'ft²'; cellAreaUnitSpan.textContent = 'ft²'; elevUnit1.textContent = 'ft'; elevUnit2.textContent = 'ft'; topsoilUnit.textContent = 'ft'; } } function toggleModeUI(){ if (mode === 'simple'){ simplePane.hidden = false; gridPane.hidden = true; } else { simplePane.hidden = true; gridPane.hidden = false; if (inputs.gridBody.children.length === 0){ addRows(5); } } } // Accessible tooltip toggles\]</div>
  <pre class="auditspine-mono">('input[name="units"]'); const simplePane = $('#simple-pane'); const gridPane = $('#grid-pane'); const areaUnitSpan = $('#area-unit'); const cellAreaUnitSpan = $('#cell-area-unit'); const elevUnit1 = $('#elev-unit-1'); const elevUnit2 = $('#elev-unit-2'); const topsoilUnit = $('#topsoil-unit'); const inputs = { topsoil: $('#topsoil'), swell: $('#swell'), compaction: $('#compaction'), simpleArea: $('#simple-area'), simpleExisting: $('#simple-existing'), simpleDesign: $('#simple-design'), cellArea: $('#cell-area'), gridBody: $('#grid-body'), gridError: $('#grid-error'), }; const results = { cutInPlace: $('#cut-inplace'), fillInPlace: $('#fill-inplace'), netInPlace: $('#net-inplace'), looseCut: $('#loose-cut'), borrowLoose: $('#borrow-loose'), balance: $('#balance-text'), altUnits: $('#alt-units'), }; const errors = { topsoil: $('#topsoil-error'), swell: $('#swell-error'), compaction: $('#compaction-error'), simpleArea: $('#simple-area-error'), simpleExisting: $('#simple-existing-error'), simpleDesign: $('#simple-design-error'), cellArea: $('#cell-area-error'), }; const buttons = { addRow: $('#add-row'), add5Rows: $('#add-5-rows'), clearRows: $('#clear-rows'), }; // State let mode = 'simple'; // simple | grid let units = 'metric'; // metric | imperial // Utils const clamp = (val, min, max) =&gt; Math.min(Math.max(val, min), max); const toNumber = v =&gt; { const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,'')); return Number.isFinite(n) ? n : NaN; }; // Unit helpers const m3_to_yd3 = v =&gt; v * 1.30795062; const yd3_to_m3 = v =&gt; v * 0.764554858; const ft3_to_yd3 = v =&gt; v / 27; function formatNumber(n){ if (!Number.isFinite(n)) return '—'; return n.toLocaleString(undefined, {maximumFractionDigits: 2}); } function updateUnitLabels(){ if (units === 'metric'){ areaUnitSpan.textContent = 'm²'; cellAreaUnitSpan.textContent = 'm²'; elevUnit1.textContent = 'm'; elevUnit2.textContent = 'm'; topsoilUnit.textContent = 'm'; } else { areaUnitSpan.textContent = 'ft²'; cellAreaUnitSpan.textContent = 'ft²'; elevUnit1.textContent = 'ft'; elevUnit2.textContent = 'ft'; topsoilUnit.textContent = 'ft'; } } function toggleModeUI(){ if (mode === 'simple'){ simplePane.hidden = false; gridPane.hidden = true; } else { simplePane.hidden = true; gridPane.hidden = false; if (inputs.gridBody.children.length === 0){ addRows(5); } } } // Accessible tooltip toggles</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[('#grid-body tr').forEach((tr, i) =&gt; { const idx = tr.querySelector('.row-index'); if (idx) idx.textContent = i + 1; const [existing, design, actionTd] = tr.querySelectorAll('td'); const inpExisting = tr.querySelector('td:nth-child(2) input'); const inpDesign = tr.querySelector('td:nth-child(3) input'); if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`); if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`); const btn = tr.querySelector('button.btn.secondary'); if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`); }); } function addRows(n=1){ for (let i=0; i&lt;n; i++){ const row = makeRow(inputs.gridBody.children.length); inputs.gridBody.appendChild(row); } } buttons.addRow.addEventListener('click', () =&gt; addRows(1)); buttons.add5Rows.addEventListener('click', () =&gt; addRows(5)); buttons.clearRows.addEventListener('click', () =&gt; { inputs.gridBody.innerHTML = ''; inputs.gridError.textContent = ''; calculate(); }); // Validation function setError(inputEl, errorEl, message){ if (!errorEl) return; if (message){ inputEl?.setAttribute('aria-invalid', 'true'); errorEl.textContent = message; } else { inputEl?.setAttribute('aria-invalid', 'false'); errorEl.textContent = ''; } } function validateRequired(inputEl, errorEl, opts={}){ const v = toNumber(inputEl.value); if (!Number.isFinite(v) || (opts.min != null &amp;&amp; v &lt; opts.min)){ setError(inputEl, errorEl, opts.message || 'Please enter a valid number.'); return false; } setError(inputEl, errorEl, ''); return true; } function validateFactors(){ const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'}); const c = toNumber(inputs.compaction.value); let ok2 = true; if (!Number.isFinite(c) || c &lt; 0 || c &gt;= 100){ setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.'); ok2 = false; } else { setError(inputs.compaction, errors.compaction, ''); } const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'}); return ok1 &amp;&amp; ok2 &amp;&amp; ok3; } // Event wiring modeRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { mode = e.target.value; toggleModeUI(); calculate(); })); unitRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { units = e.target.value; updateUnitLabels(); calculate(); })); [inputs.topsoil, inputs.swell, inputs.compaction, inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign, inputs.cellArea ].forEach(el =&gt; { if (!el) return; el.addEventListener('input', debounce(calculate, 100)); }); inputs.simpleArea.addEventListener('blur', () =&gt; validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'})); inputs.simpleExisting.addEventListener('blur', () =&gt; validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'})); inputs.simpleDesign.addEventListener('blur', () =&gt; validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'})); inputs.cellArea.addEventListener('blur', () =&gt; validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'})); // Debounce utility function debounce(fn, wait=120){ let t; return function(...args){ clearTimeout(t); t = setTimeout(() =&gt; fn.apply(this, args), wait); } } // Core calculation function calculate(){ if (!validateFactors()){ writeResults(0,0,0,0,0,'—',0,true); return; } const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0); const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0); const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9); let cut_inplace_m3 = 0; let fill_inplace_m3 = 0; if (mode === 'simple'){ const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}); const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}); const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}); if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; } const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0); const E = toNumber(inputs.simpleExisting.value) || 0; const D = toNumber(inputs.simpleDesign.value) || 0; const delta = (E - topsoil) - D; // positive -&gt; cut, negative -&gt; fill if (units === 'metric'){ if (delta &gt; 0) cut_inplace_m3 = delta * area; else fill_inplace_m3 = -delta * area; } else { // Imperial inputs: ft, ft². Convert ft³ -&gt; m³. const vol_ft3 = (delta &gt; 0 ? delta * area : -delta * area); const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³ if (delta &gt; 0) cut_inplace_m3 = vol_m3; else fill_inplace_m3 = vol_m3; } } else { // Grid const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}); if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; } const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0); let anyRow = false; inputs.gridError.textContent = '';\]</div>
  <pre class="auditspine-mono">('#grid-body tr').forEach((tr, i) =&gt; { const idx = tr.querySelector('.row-index'); if (idx) idx.textContent = i + 1; const [existing, design, actionTd] = tr.querySelectorAll('td'); const inpExisting = tr.querySelector('td:nth-child(2) input'); const inpDesign = tr.querySelector('td:nth-child(3) input'); if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`); if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`); const btn = tr.querySelector('button.btn.secondary'); if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`); }); } function addRows(n=1){ for (let i=0; i&lt;n; i++){ const row = makeRow(inputs.gridBody.children.length); inputs.gridBody.appendChild(row); } } buttons.addRow.addEventListener('click', () =&gt; addRows(1)); buttons.add5Rows.addEventListener('click', () =&gt; addRows(5)); buttons.clearRows.addEventListener('click', () =&gt; { inputs.gridBody.innerHTML = ''; inputs.gridError.textContent = ''; calculate(); }); // Validation function setError(inputEl, errorEl, message){ if (!errorEl) return; if (message){ inputEl?.setAttribute('aria-invalid', 'true'); errorEl.textContent = message; } else { inputEl?.setAttribute('aria-invalid', 'false'); errorEl.textContent = ''; } } function validateRequired(inputEl, errorEl, opts={}){ const v = toNumber(inputEl.value); if (!Number.isFinite(v) || (opts.min != null &amp;&amp; v &lt; opts.min)){ setError(inputEl, errorEl, opts.message || 'Please enter a valid number.'); return false; } setError(inputEl, errorEl, ''); return true; } function validateFactors(){ const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'}); const c = toNumber(inputs.compaction.value); let ok2 = true; if (!Number.isFinite(c) || c &lt; 0 || c &gt;= 100){ setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.'); ok2 = false; } else { setError(inputs.compaction, errors.compaction, ''); } const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'}); return ok1 &amp;&amp; ok2 &amp;&amp; ok3; } // Event wiring modeRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { mode = e.target.value; toggleModeUI(); calculate(); })); unitRadios.forEach(r =&gt; r.addEventListener('change', e =&gt; { units = e.target.value; updateUnitLabels(); calculate(); })); [inputs.topsoil, inputs.swell, inputs.compaction, inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign, inputs.cellArea ].forEach(el =&gt; { if (!el) return; el.addEventListener('input', debounce(calculate, 100)); }); inputs.simpleArea.addEventListener('blur', () =&gt; validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'})); inputs.simpleExisting.addEventListener('blur', () =&gt; validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'})); inputs.simpleDesign.addEventListener('blur', () =&gt; validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'})); inputs.cellArea.addEventListener('blur', () =&gt; validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'})); // Debounce utility function debounce(fn, wait=120){ let t; return function(...args){ clearTimeout(t); t = setTimeout(() =&gt; fn.apply(this, args), wait); } } // Core calculation function calculate(){ if (!validateFactors()){ writeResults(0,0,0,0,0,'—',0,true); return; } const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0); const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0); const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9); let cut_inplace_m3 = 0; let fill_inplace_m3 = 0; if (mode === 'simple'){ const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}); const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}); const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}); if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; } const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0); const E = toNumber(inputs.simpleExisting.value) || 0; const D = toNumber(inputs.simpleDesign.value) || 0; const delta = (E - topsoil) - D; // positive -&gt; cut, negative -&gt; fill if (units === 'metric'){ if (delta &gt; 0) cut_inplace_m3 = delta * area; else fill_inplace_m3 = -delta * area; } else { // Imperial inputs: ft, ft². Convert ft³ -&gt; m³. const vol_ft3 = (delta &gt; 0 ? delta * area : -delta * area); const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³ if (delta &gt; 0) cut_inplace_m3 = vol_m3; else fill_inplace_m3 = vol_m3; } } else { // Grid const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}); if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; } const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0); let anyRow = false; inputs.gridError.textContent = '';</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">For each cell i with area A_i and adjusted height difference Δh_i between existing and design grades: \( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \) \( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \) Adjustments for bulking (swell) and compaction (shrinkage): \( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \) Where t is topsoil strip thickness, s and c are decimals (e.g., 20% → 0.20).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( \Delta h_i = (E^{\text{existing}}_i - t) - E^{\text{design}}_i \)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( V_{\text{cut}} = \sum_{i} \max(\Delta h_i, 0)\cdot A_i \quad,\quad V_{\text{fill}} = \sum_{i} \max(-\Delta h_i, 0)\cdot A_i \)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( V_{\text{cut, loose}} = V_{\text{cut}} \cdot (1 + s) \quad,\quad V_{\text{borrow, loose}} = \dfrac{V_{\text{fill}}}{1 - c} \)</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Direct PDF</strong> — publications.usace.army.mil · Accessed 2026-01-19<br><a href="https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf" target="_blank" rel="nofollow noopener">https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-2300.pdf</a></li>
<li><strong>Esri’s Cut/Fill Volume Calculation</strong> — enterprise.arcgis.com · Accessed 2026-01-19<br><a href="https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm" target="_blank" rel="nofollow noopener">https://enterprise.arcgis.com/en/portal/11.5/use/cut-and-fill-volume-calculation.htm</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</section>
</div>
</main>
<footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>



<!-- Standard Footer --> 
<script defer="">
    (function(){
      'use strict';

      // Shortcuts
      const $ = (sel, ctx=document) => ctx.querySelector(sel);
      const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

      // Elements
      const modeRadios = $$('input[name="mode"]');
      const unitRadios = $$('input[name="units"]');

      const simplePane = $('#simple-pane');
      const gridPane = $('#grid-pane');

      const areaUnitSpan = $('#area-unit');
      const cellAreaUnitSpan = $('#cell-area-unit');
      const elevUnit1 = $('#elev-unit-1');
      const elevUnit2 = $('#elev-unit-2');
      const topsoilUnit = $('#topsoil-unit');

      const inputs = {
        topsoil: $('#topsoil'),
        swell: $('#swell'),
        compaction: $('#compaction'),

        simpleArea: $('#simple-area'),
        simpleExisting: $('#simple-existing'),
        simpleDesign: $('#simple-design'),

        cellArea: $('#cell-area'),
        gridBody: $('#grid-body'),
        gridError: $('#grid-error'),
      };

      const results = {
        cutInPlace: $('#cut-inplace'),
        fillInPlace: $('#fill-inplace'),
        netInPlace: $('#net-inplace'),
        looseCut: $('#loose-cut'),
        borrowLoose: $('#borrow-loose'),
        balance: $('#balance-text'),
        altUnits: $('#alt-units'),
      };

      const errors = {
        topsoil: $('#topsoil-error'),
        swell: $('#swell-error'),
        compaction: $('#compaction-error'),
        simpleArea: $('#simple-area-error'),
        simpleExisting: $('#simple-existing-error'),
        simpleDesign: $('#simple-design-error'),
        cellArea: $('#cell-area-error'),
      };

      const buttons = {
        addRow: $('#add-row'),
        add5Rows: $('#add-5-rows'),
        clearRows: $('#clear-rows'),
      };

      // State
      let mode = 'simple'; // simple | grid
      let units = 'metric'; // metric | imperial

      // Utils
      const clamp = (val, min, max) => Math.min(Math.max(val, min), max);
      const toNumber = v => {
        const n = typeof v === 'number' ? v : parseFloat(String(v).replace(/,/g,''));
        return Number.isFinite(n) ? n : NaN;
      };

      // Unit helpers
      const m3_to_yd3 = v => v * 1.30795062;
      const yd3_to_m3 = v => v * 0.764554858;
      const ft3_to_yd3 = v => v / 27;

      function formatNumber(n){
        if (!Number.isFinite(n)) return '—';
        return n.toLocaleString(undefined, {maximumFractionDigits: 2});
      }

      function updateUnitLabels(){
        if (units === 'metric'){
          areaUnitSpan.textContent = 'm²';
          cellAreaUnitSpan.textContent = 'm²';
          elevUnit1.textContent = 'm';
          elevUnit2.textContent = 'm';
          topsoilUnit.textContent = 'm';
        } else {
          areaUnitSpan.textContent = 'ft²';
          cellAreaUnitSpan.textContent = 'ft²';
          elevUnit1.textContent = 'ft';
          elevUnit2.textContent = 'ft';
          topsoilUnit.textContent = 'ft';
        }
      }

      function toggleModeUI(){
        if (mode === 'simple'){
          simplePane.hidden = false;
          gridPane.hidden = true;
        } else {
          simplePane.hidden = true;
          gridPane.hidden = false;
          if (inputs.gridBody.children.length === 0){
            addRows(5);
          }
        }
      }

      // Accessible tooltip toggles
      $$('.tooltip-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.getAttribute('data-tooltip');
          const tip = document.getElementById(id);
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          tip.setAttribute('aria-hidden', String(expanded));
        });
        btn.addEventListener('keydown', (e) => {
          if (e.key === 'Escape'){
            const id = btn.getAttribute('data-tooltip');
            const tip = document.getElementById(id);
            btn.setAttribute('aria-expanded', 'false');
            tip.setAttribute('aria-hidden', 'true');
          }
        });
      });

      // Grid rows
      function makeRow(index){
        const tr = document.createElement('tr');

        const tdIndex = document.createElement('td');
        tdIndex.className = 'row-index';
        tdIndex.textContent = index + 1;

        const tdExisting = document.createElement('td');
        const inpExisting = document.createElement('input');
        inpExisting.type = 'number'; inpExisting.step = 'any'; inpExisting.className = 'form-control';
        inpExisting.placeholder = 'Existing';
        inpExisting.setAttribute('aria-label', `Row ${index+1} existing elevation`);
        inpExisting.addEventListener('input', debounce(calculate, 80));
        inpExisting.addEventListener('blur', () => validateRequired(inpExisting, null));

        const tdDesign = document.createElement('td');
        const inpDesign = document.createElement('input');
        inpDesign.type = 'number'; inpDesign.step = 'any'; inpDesign.className = 'form-control';
        inpDesign.placeholder = 'Design';
        inpDesign.setAttribute('aria-label', `Row ${index+1} design elevation`);
        inpDesign.addEventListener('input', debounce(calculate, 80));
        inpDesign.addEventListener('blur', () => validateRequired(inpDesign, null));

        const tdActions = document.createElement('td');
        const btnRemove = document.createElement('button');
        btnRemove.type = 'button';
        btnRemove.className = 'btn secondary';
        btnRemove.textContent = 'Remove';
        btnRemove.setAttribute('aria-label', `Remove row ${index+1}`);
        btnRemove.addEventListener('click', () => {
          tr.remove();
          refreshRowIndices();
          calculate();
        });

        tdExisting.appendChild(inpExisting);
        tdDesign.appendChild(inpDesign);
        tdActions.appendChild(btnRemove);

        tr.appendChild(tdIndex);
        tr.appendChild(tdExisting);
        tr.appendChild(tdDesign);
        tr.appendChild(tdActions);
        return tr;
      }

      function refreshRowIndices(){
        $$('#grid-body tr').forEach((tr, i) => {
          const idx = tr.querySelector('.row-index');
          if (idx) idx.textContent = i + 1;
          const [existing, design, actionTd] = tr.querySelectorAll('td');
          const inpExisting = tr.querySelector('td:nth-child(2) input');
          const inpDesign = tr.querySelector('td:nth-child(3) input');
          if (inpExisting) inpExisting.setAttribute('aria-label', `Row ${i+1} existing elevation`);
          if (inpDesign) inpDesign.setAttribute('aria-label', `Row ${i+1} design elevation`);
          const btn = tr.querySelector('button.btn.secondary');
          if (btn) btn.setAttribute('aria-label', `Remove row ${i+1}`);
        });
      }

      function addRows(n=1){
        for (let i=0; i<n; i++){
          const row = makeRow(inputs.gridBody.children.length);
          inputs.gridBody.appendChild(row);
        }
      }

      buttons.addRow.addEventListener('click', () => addRows(1));
      buttons.add5Rows.addEventListener('click', () => addRows(5));
      buttons.clearRows.addEventListener('click', () => {
        inputs.gridBody.innerHTML = '';
        inputs.gridError.textContent = '';
        calculate();
      });

      // Validation
      function setError(inputEl, errorEl, message){
        if (!errorEl) return;
        if (message){
          inputEl?.setAttribute('aria-invalid', 'true');
          errorEl.textContent = message;
        } else {
          inputEl?.setAttribute('aria-invalid', 'false');
          errorEl.textContent = '';
        }
      }
      function validateRequired(inputEl, errorEl, opts={}){
        const v = toNumber(inputEl.value);
        if (!Number.isFinite(v) || (opts.min != null && v < opts.min)){
          setError(inputEl, errorEl, opts.message || 'Please enter a valid number.');
          return false;
        }
        setError(inputEl, errorEl, '');
        return true;
      }
      function validateFactors(){
        const ok1 = validateRequired(inputs.swell, errors.swell, {min:0, message:'Enter swell as a percentage ≥ 0.'});
        const c = toNumber(inputs.compaction.value);
        let ok2 = true;
        if (!Number.isFinite(c) || c < 0 || c >= 100){
          setError(inputs.compaction, errors.compaction, 'Compaction must be between 0 and 99.9%.');
          ok2 = false;
        } else {
          setError(inputs.compaction, errors.compaction, '');
        }
        const ok3 = validateRequired(inputs.topsoil, errors.topsoil, {min:0, message:'Topsoil strip must be ≥ 0.'});
        return ok1 && ok2 && ok3;
      }

      // Event wiring
      modeRadios.forEach(r => r.addEventListener('change', e => {
        mode = e.target.value;
        toggleModeUI();
        calculate();
      }));
      unitRadios.forEach(r => r.addEventListener('change', e => {
        units = e.target.value;
        updateUnitLabels();
        calculate();
      }));

      [inputs.topsoil, inputs.swell, inputs.compaction,
       inputs.simpleArea, inputs.simpleExisting, inputs.simpleDesign,
       inputs.cellArea
      ].forEach(el => {
        if (!el) return;
        el.addEventListener('input', debounce(calculate, 100));
      });

      inputs.simpleArea.addEventListener('blur', () => validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'}));
      inputs.simpleExisting.addEventListener('blur', () => validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'}));
      inputs.simpleDesign.addEventListener('blur', () => validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'}));
      inputs.cellArea.addEventListener('blur', () => validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'}));

      // Debounce utility
      function debounce(fn, wait=120){
        let t; return function(...args){
          clearTimeout(t); t = setTimeout(() => fn.apply(this, args), wait);
        }
      }

      // Core calculation
      function calculate(){
        if (!validateFactors()){
          writeResults(0,0,0,0,0,'—',0,true);
          return;
        }
        const topsoil = Math.max(0, toNumber(inputs.topsoil.value) || 0);
        const swellPct = Math.max(0, toNumber(inputs.swell.value) || 0);
        const compPct = clamp(toNumber(inputs.compaction.value) || 0, 0, 99.9);

        let cut_inplace_m3 = 0;
        let fill_inplace_m3 = 0;

        if (mode === 'simple'){
          const okA = validateRequired(inputs.simpleArea, errors.simpleArea, {min:0, message:'Area is required and must be ≥ 0.'});
          const okE = validateRequired(inputs.simpleExisting, errors.simpleExisting, {message:'Enter a valid elevation.'});
          const okD = validateRequired(inputs.simpleDesign, errors.simpleDesign, {message:'Enter a valid elevation.'});
          if (!okA || !okE || !okD){ writeResults(0,0,0,0,0,'—',0,true); return; }

          const area = Math.max(0, toNumber(inputs.simpleArea.value) || 0);
          const E = toNumber(inputs.simpleExisting.value) || 0;
          const D = toNumber(inputs.simpleDesign.value) || 0;

          const delta = (E - topsoil) - D; // positive -> cut, negative -> fill

          if (units === 'metric'){
            if (delta > 0) cut_inplace_m3 = delta * area;
            else fill_inplace_m3 = -delta * area;
          } else {
            // Imperial inputs: ft, ft². Convert ft³ -> m³.
            const vol_ft3 = (delta > 0 ? delta * area : -delta * area);
            const vol_m3 = vol_ft3 * 0.028316846592; // 1 ft³ = 0.028316846592 m³
            if (delta > 0) cut_inplace_m3 = vol_m3;
            else fill_inplace_m3 = vol_m3;
          }
        } else {
          // Grid
          const okCA = validateRequired(inputs.cellArea, errors.cellArea, {min:0, message:'Cell area is required and must be ≥ 0.'});
          if (!okCA){ writeResults(0,0,0,0,0,'—',0,true); return; }
          const cellArea = Math.max(0, toNumber(inputs.cellArea.value) || 0);

          let anyRow = false;
          inputs.gridError.textContent = '';

          $$('#grid-body tr').forEach(tr => {
            const exEl = tr.querySelector('td:nth-child(2) input');
            const deEl = tr.querySelector('td:nth-child(3) input');
            const E = toNumber(exEl.value);
            const D = toNumber(deEl.value);
            if (!Number.isFinite(E) || !Number.isFinite(D)) return;
            anyRow = true;
            const delta = (E - topsoil) - D;

            if (units === 'metric'){
              if (delta > 0) cut_inplace_m3 += delta * cellArea;
              else fill_inplace_m3 += -delta * cellArea;
            } else {
              const vol_ft3 = (delta > 0 ? delta * cellArea : -delta * cellArea);
              const vol_m3 = vol_ft3 * 0.028316846592;
              if (delta > 0) cut_inplace_m3 += vol_m3;
              else fill_inplace_m3 += vol_m3;
            }
          });

          if (!anyRow){
            inputs.gridError.textContent = 'Enter at least one complete row (existing and design elevations).';
            writeResults(0,0,0,0,0,'—',0,true);
            return;
          }
        }

        // Guard against tiny floating errors
        cut_inplace_m3 = Math.max(0, cut_inplace_m3);
        fill_inplace_m3 = Math.max(0, fill_inplace_m3);

        const net_inplace_m3 = cut_inplace_m3 - fill_inplace_m3;

        const swell = swellPct / 100;
        const comp = compPct / 100;

        const loose_cut_m3 = cut_inplace_m3 * (1 + swell);
        const borrow_loose_m3 = comp >= 1 ? Infinity : (fill_inplace_m3 / (1 - comp));

        // Balance: compare loose cut vs borrow loose
        let balanceText = 'Balanced';
        const diff = loose_cut_m3 - borrow_loose_m3;
        if (Math.abs(diff) > 1e-6){
          balanceText = diff > 0 ? 'Export required' : 'Import required';
        }

        // Primary unit display and alternate conversion
        const primary = (units === 'metric') ? 'm³' : 'yd³';
        const display = {
          cut: units === 'metric' ? cut_inplace_m3 : m3_to_yd3(cut_inplace_m3),
          fill: units === 'metric' ? fill_inplace_m3 : m3_to_yd3(fill_inplace_m3),
          net: units === 'metric' ? net_inplace_m3 : m3_to_yd3(net_inplace_m3),
          looseCut: units === 'metric' ? loose_cut_m3 : m3_to_yd3(loose_cut_m3),
          borrowLoose: units === 'metric' ? borrow_loose_m3 : m3_to_yd3(borrow_loose_m3)
        };

        // Alternate units
        const altLabel = (units === 'metric') ? 'yd³' : 'm³';
        const altCut = (units === 'metric') ? m3_to_yd3(cut_inplace_m3) : yd3_to_m3(display.cut);
        const altFill = (units === 'metric') ? m3_to_yd3(fill_inplace_m3) : yd3_to_m3(display.fill);
        const altNet = (units === 'metric') ? m3_to_yd3(net_inplace_m3) : yd3_to_m3(display.net);

        writeResults(display.cut, display.fill, display.net, display.looseCut, display.borrowLoose, balanceText, (altCut + altFill + altNet), false, primary, altLabel, {altCut, altFill, altNet});
      }

      function writeResults(cut, fill, net, looseCut, borrowLoose, balanceText, altSum, invalid, primary='m³', altLabel='yd³', altValues=null){
        results.cutInPlace.textContent = `${formatNumber(cut)} ${primary}`;
        results.fillInPlace.textContent = `${formatNumber(fill)} ${primary}`;
        const sign = net >= 0 ? '' : '−';
        results.netInPlace.textContent = `${formatNumber(Math.abs(net))} ${primary} ${net>=0?'(net cut)':'(net fill)'}`;
        results.looseCut.textContent = `${formatNumber(looseCut)} ${primary}`;
        results.borrowLoose.textContent = `${formatNumber(borrowLoose)} ${primary}`;
        results.balance.textContent = balanceText;

        if (altValues){
          const {altCut, altFill, altNet} = altValues;
          results.altUnits.textContent = `Cut ${formatNumber(altCut)} ${altLabel} · Fill ${formatNumber(altFill)} ${altLabel} · Net ${formatNumber(altNet)} ${altLabel}`;
        } else {
          results.altUnits.textContent = `${formatNumber(altSum)} ${altLabel}`;
        }
      }

      // Initialize
      updateUnitLabels();
      toggleModeUI();
      calculate();

      // Prefill one row for better UX in grid mode
      function initGrid(){
        if (inputs.gridBody.children.length === 0){
          addRows(5);
        }
      }

      // Accessibility: pressing Enter on inputs triggers calc immediately
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter'){
          calculate();
        }
      });
    })();
  </script>

<script defer="" src="/assets/js/mobile-menu.js"></script>
<script defer="" src="/assets/js/page-enhancements.js"></script>
</body></html>

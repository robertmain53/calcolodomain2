<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/solar-position" />
    <title>Solar Position Calculator: [Insider 2024] | CalcDomain</title>
    <meta name="description" content="Calculate Solar Position Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Solar Position Calculator: [Insider 2024] | CalcDomain" />
    <meta property="og:description" content="Calculate Solar Position Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/solar-position" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Solar Position Calculator: [Insider 2024] | CalcDomain" />
    <meta name="twitter:description" content="Calculate Solar Position Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Solar Position Calculator – Sun Azimuth & Elevation by Location and Time",
        "description": "Interactive solar position calculator that gives precise sun azimuth, elevation, solar noon, sunrise, sunset, and more for any location, date, and time.",
        "url": "https://calcdomain.com/solar-position",
        "mainEntity": {
          "@type": "SoftwareApplication",
          "name": "Solar Position Calculator",
          "applicationCategory": "EducationalApplication",
          "operatingSystem": "Any",
          "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
          }
        }
      }</script>
    <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Lifestyle & Everyday Calculators", "item": "https://calcdomain.com/categories/lifestyle-everyday"}, {"@type": "ListItem", "position": 3, "name": "Miscellaneous Calculators", "item": "https://calcdomain.com/subcategories/miscellaneous"}, {"@type": "ListItem", "position": 4, "name": "Solar Position Calculator", "item": "https://calcdomain.com/solar-position"}]}</script>
    
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  </head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-blue-600 hover:underline">Lifestyle &amp; Everyday Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/miscellaneous" class="text-blue-600 hover:underline">Miscellaneous Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Solar Position Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">
                Solar Position Calculator
              </h1>
              <p class="text-gray-600">
                Compute precise Sun azimuth, elevation, solar noon, sunrise,
                sunset, and more for any location, date, and time.
              </p>
              <p class="mt-2 text-xs text-gray-500">
                Model class: NOAA/Solar Position Algorithm style – suitable for
                PV design, shading, and astronomy planning.
              </p>
            </header>

            <!-- Calculator UI -->
            <section aria-labelledby="solar-inputs-heading" class="mb-6">
              <h2 id="solar-inputs-heading" class="text-xl font-semibold mb-3">
                Inputs
              </h2>
              <div class="grid md:grid-cols-2 gap-4">
                <!-- Location -->
                <div class="space-y-3">
                  <div class="flex items-center justify-between">
                    <h3 class="font-medium">Location</h3>
                    <button
                      id="btn-use-location"
                      type="button"
                      class="text-xs px-2 py-1 rounded-full border border-blue-500 text-blue-600 hover:bg-blue-50"
                    >
                      Use my location
                    </button>
                  </div>
                  <div>
                    <label
                      for="latitude"
                      class="block text-sm font-medium text-gray-700"
                      >Latitude (°)</label
                    >
                    <input
                      id="latitude"
                      type="number"
                      step="0.0001"
                      min="-90"
                      max="90"
                      class="mt-1 w-full border rounded-md px-3 py-2"
                      placeholder="e.g. 40.7128"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      North positive, South negative (e.g. -33.8688 for Sydney).
                    </p>
                  </div>
                  <div>
                    <label
                      for="longitude"
                      class="block text-sm font-medium text-gray-700"
                      >Longitude (°)</label
                    >
                    <input
                      id="longitude"
                      type="number"
                      step="0.0001"
                      min="-180"
                      max="180"
                      class="mt-1 w-full border rounded-md px-3 py-2"
                      placeholder="e.g. -74.0060"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      East positive, West negative (e.g. -122.4194 for San
                      Francisco).
                    </p>
                  </div>
                  <div class="grid grid-cols-2 gap-3">
                    <div>
                      <label
                        for="timezone-offset"
                        class="block text-sm font-medium text-gray-700"
                        >Time zone (UTC offset)</label
                      >
                      <input
                        id="timezone-offset"
                        type="number"
                        step="0.25"
                        min="-12"
                        max="14"
                        class="mt-1 w-full border rounded-md px-3 py-2"
                        placeholder="Auto"
                      />
                      <p class="text-xs text-gray-500 mt-1">
                        e.g. -5 for EST, 1 for CET. Leave blank for auto.
                      </p>
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700"
                        >DST (Daylight Saving)</label
                      >
                      <select
                        id="dst-flag"
                        class="mt-1 w-full border rounded-md px-3 py-2"
                      >
                        <option value="auto">Auto</option>
                        <option value="1">DST in effect</option>
                        <option value="0">No DST</option>
                      </select>
                    </div>
                  </div>
                </div>

                <!-- Date & Time -->
                <div class="space-y-3">
                  <div class="flex items-center justify-between">
                    <h3 class="font-medium">Date &amp; Time</h3>
                    <button
                      id="btn-now"
                      type="button"
                      class="text-xs px-2 py-1 rounded-full border border-gray-400 text-gray-700 hover:bg-gray-50"
                    >
                      Now
                    </button>
                  </div>
                  <div>
                    <label
                      for="date"
                      class="block text-sm font-medium text-gray-700"
                      >Date</label
                    >
                    <input
                      id="date"
                      type="date"
                      class="mt-1 w-full border rounded-md px-3 py-2"
                    />
                  </div>
                  <div>
                    <label
                      for="time"
                      class="block text-sm font-medium text-gray-700"
                      >Time (local)</label
                    >
                    <input
                      id="time"
                      type="time"
                      step="60"
                      class="mt-1 w-full border rounded-md px-3 py-2"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Local clock time at the chosen location.
                    </p>
                  </div>
                  <div>
                    <label
                      for="elevation-m"
                      class="block text-sm font-medium text-gray-700"
                      >Observer elevation (m)</label
                    >
                    <input
                      id="elevation-m"
                      type="number"
                      step="1"
                      class="mt-1 w-full border rounded-md px-3 py-2"
                      placeholder="Optional"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Optional. Used for small corrections to sunrise/sunset.
                    </p>
                  </div>
                </div>
              </div>

              <div class="mt-4 flex flex-wrap gap-3 items-center">
                <button
                  id="btn-calc"
                  type="button"
                  class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium"
                >
                  Calculate solar position
                </button>
                <button
                  id="btn-day-curve"
                  type="button"
                  class="px-3 py-2 border border-blue-500 text-blue-600 rounded-md hover:bg-blue-50 text-sm"
                >
                  Plot today’s sun path
                </button>
                <span id="status-message" class="text-xs text-gray-500"></span>
              </div>
            </section>

            <!-- Results -->
            <section
              aria-labelledby="solar-results-heading"
              class="mt-6 border-t pt-4"
            >
              <h2 id="solar-results-heading" class="text-xl font-semibold mb-3">
                Results
              </h2>
              <div id="results-container" class="grid md:grid-cols-2 gap-4">
                <!-- Instantaneous position -->
                <div class="border rounded-lg p-4 bg-gray-50">
                  <div class="flex items-center justify-between mb-2">
                    <h3 class="font-medium">Solar position at selected time</h3>
                    <span class="badge bg-blue-100 text-blue-700">Instant</span>
                  </div>
                  <dl class="grid grid-cols-2 gap-x-3 gap-y-1 text-sm">
                    <dt class="text-gray-500">Elevation</dt>
                    <dd id="res-elevation" class="font-semibold text-gray-900">
                      –
                    </dd>

                    <dt class="text-gray-500">Azimuth</dt>
                    <dd id="res-azimuth" class="font-semibold text-gray-900">
                      –
                    </dd>

                    <dt class="text-gray-500">Zenith</dt>
                    <dd id="res-zenith" class="text-gray-900">–</dd>

                    <dt class="text-gray-500">Hour angle</dt>
                    <dd id="res-hour-angle" class="text-gray-900">–</dd>

                    <dt class="text-gray-500">Declination</dt>
                    <dd id="res-declination" class="text-gray-900">–</dd>

                    <dt class="text-gray-500">Equation of time</dt>
                    <dd id="res-eot" class="text-gray-900">–</dd>
                  </dl>
                  <p
                    id="res-daylight-flag"
                    class="mt-2 text-xs text-gray-600"
                  ></p>
                </div>

                <!-- Daily events -->
                <div class="border rounded-lg p-4 bg-gray-50">
                  <div class="flex items-center justify-between mb-2">
                    <h3 class="font-medium">Daily solar events</h3>
                    <span class="badge bg-green-100 text-green-700"
                      >Day summary</span
                    >
                  </div>
                  <dl class="grid grid-cols-2 gap-x-3 gap-y-1 text-sm">
                    <dt class="text-gray-500">Sunrise</dt>
                    <dd id="res-sunrise" class="font-semibold text-gray-900">
                      –
                    </dd>

                    <dt class="text-gray-500">Sunset</dt>
                    <dd id="res-sunset" class="font-semibold text-gray-900">
                      –
                    </dd>

                    <dt class="text-gray-500">Solar noon</dt>
                    <dd id="res-solar-noon" class="text-gray-900">–</dd>

                    <dt class="text-gray-500">Day length</dt>
                    <dd id="res-day-length" class="text-gray-900">–</dd>

                    <dt class="text-gray-500">Max elevation</dt>
                    <dd id="res-max-elev" class="text-gray-900">–</dd>

                    <dt class="text-gray-500">Civil twilight</dt>
                    <dd id="res-civil" class="text-gray-900">–</dd>
                  </dl>
                  <p
                    id="res-sunrise-note"
                    class="mt-2 text-xs text-gray-600"
                  ></p>
                </div>
              </div>

              <!-- Sun path visualization -->
              <div class="mt-6 grid md:grid-cols-2 gap-4 items-start">
                <div>
                  <h3 class="font-medium mb-2">Sun path for selected date</h3>
                  <canvas
                    id="sun-path-canvas"
                    class="sun-path-canvas border rounded-lg bg-white"
                  ></canvas>
                  <p class="mt-2 text-xs text-gray-500">
                    Polar plot: center = zenith (90° elevation), outer ring =
                    horizon (0°). North at top, azimuth increases clockwise.
                  </p>
                </div>
                <div>
                  <h3 class="font-medium mb-2">Key angles (example)</h3>
                  <ul class="text-sm text-gray-700 list-disc ml-4 space-y-1">
                    <li>
                      <span class="font-semibold">Elevation</span>: angle above
                      the horizon. 0° at sunrise/sunset, 90° at zenith.
                    </li>
                    <li>
                      <span class="font-semibold">Azimuth</span>: compass
                      direction of the Sun, measured from North (0°) clockwise
                      (East 90°, South 180°, West 270°).
                    </li>
                    <li>
                      <span class="font-semibold">Solar noon</span>: when the
                      Sun reaches its highest elevation for the day.
                    </li>
                    <li>
                      <span class="font-semibold">Equation of time</span>:
                      difference between apparent solar time and mean solar
                      time, due to Earth’s orbit and tilt.
                    </li>
                  </ul>
                </div>
              </div>
            </section>

            <!-- Explanation -->
            <section class="prose mt-8">
              <h2>How this solar position calculator works</h2>
              <p>
                This tool computes the apparent position of the Sun in the sky
                using a modern implementation of the NOAA/Solar Position
                Algorithm (SPA) class of models. It is designed to be:
              </p>
              <ul>
                <li>
                  <strong>Accurate</strong> enough for PV design, shading
                  analysis, and astronomy planning.
                </li>
                <li>
                  <strong>Fast</strong> enough to plot an entire day’s sun path
                  in your browser.
                </li>
                <li>
                  <strong>Easy to use</strong> with automatic location and time
                  zone detection.
                </li>
              </ul>

              <h3>Key definitions</h3>
              <ul>
                <li>
                  <strong>Latitude (φ)</strong>: positive north of the equator,
                  negative south.
                </li>
                <li>
                  <strong>Longitude (λ)</strong>: positive east of Greenwich,
                  negative west.
                </li>
                <li>
                  <strong>Solar declination (δ)</strong>: the latitude where the
                  Sun is directly overhead at solar noon.
                </li>
                <li>
                  <strong>Hour angle (H)</strong>: how far the Sun has moved
                  from local solar noon, in degrees (15° per hour).
                </li>
                <li>
                  <strong>Solar elevation (α)</strong>: angle of the Sun above
                  the horizon.
                </li>
                <li>
                  <strong>Solar azimuth (A)</strong>: compass direction of the
                  Sun, measured from North clockwise.
                </li>
              </ul>

              <h3>Core formulas (simplified)</h3>
              <div class="formula-box text-sm">
                <p><strong>1. Convert date/time to Julian day</strong></p>
                <p>
                  We convert the calendar date and UTC time to a Julian day
                  number \( JD \), then to centuries since J2000:
                </p>
                <p>\( T = \dfrac{JD - 2451545.0}{36525} \)</p>

                <p class="mt-3">
                  <strong>2. Solar declination and equation of time</strong>
                </p>
                <p>
                  Using standard series expansions (as in NOAA’s algorithm), we
                  compute:
                </p>
                <ul>
                  <li>Solar declination \( \delta \) (in degrees)</li>
                  <li>Equation of time \( E_t \) (in minutes)</li>
                </ul>

                <p class="mt-3">
                  <strong>3. Local solar time and hour angle</strong>
                </p>
                <p>Local solar time (LST) in minutes:</p>
                <p>
                  \( \text{LST} = \text{clock minutes} + 4(\lambda_{\text{std}}
                  - \lambda) + E_t \)
                </p>
                <p>
                  where \( \lambda_{\text{std}} \) is the longitude of the time
                  zone meridian.
                </p>
                <p>Hour angle \( H \) (degrees):</p>
                <p>\( H = 15^\circ \times (\text{LST}/60 - 12) \)</p>

                <p class="mt-3">
                  <strong>4. Solar elevation and azimuth</strong>
                </p>
                <p>
                  With latitude \( \phi \), declination \( \delta \), and hour
                  angle \( H \):
                </p>
                <p>
                  \( \sin \alpha = \sin\phi \sin\delta + \cos\phi \cos\delta
                  \cos H \)
                </p>
                <p>\( \alpha = \arcsin(\sin\alpha) \)</p>
                <p>For azimuth (from North, clockwise):</p>
                <p>
                  \( A = \operatorname{atan2}\big( \sin H,\; \cos H \sin\phi -
                  \tan\delta \cos\phi \big) \)
                </p>
                <p>Then we convert \( A \) to the range 0–360°.</p>
              </div>

              <h3>Sunrise, sunset, and day length</h3>
              <p>
                Sunrise and sunset occur when the Sun’s center is at an
                elevation of about −0.83° (to account for atmospheric refraction
                and the Sun’s apparent radius). For a given latitude \( \phi \)
                and declination \( \delta \), the hour angle at sunrise/sunset
                \( H_0 \) is:
              </p>
              <p>
                \( \cos H_0 = \dfrac{\sin h_0 - \sin\phi \sin\delta}{\cos\phi
                \cos\delta} \)
              </p>
              <p>where \( h_0 = -0.83^\circ \). The day length is then:</p>
              <p>
                \( \text{Day length} \approx \dfrac{2 H_0}{15^\circ} \) hours.
              </p>
              <p>
                At high latitudes in summer or winter, the Sun may never rise or
                never set; the calculator will indicate “Sun does not rise” or
                “Sun does not set” in those cases.
              </p>

              <h3>Practical uses</h3>
              <ul>
                <li>
                  <strong>Solar PV and thermal design</strong>: choose panel
                  tilt and azimuth, estimate seasonal production.
                </li>
                <li>
                  <strong>Shading analysis</strong>: check when buildings,
                  trees, or terrain will cast shadows.
                </li>
                <li>
                  <strong>Photography and filmmaking</strong>: plan golden hour,
                  backlighting, and window light.
                </li>
                <li>
                  <strong>Astronomy and education</strong>: understand the Sun’s
                  apparent motion through the seasons.
                </li>
              </ul>
            </section>

            <!-- FAQ -->
            <section class="prose mt-8">
              <h2>Frequently asked questions</h2>

              <h3>Does this calculator account for atmospheric refraction?</h3>
              <p>
                Yes. For sunrise and sunset times we use the standard −0.83°
                elevation criterion, which implicitly includes typical
                atmospheric refraction near the horizon and the Sun’s apparent
                radius. For the instantaneous solar elevation and azimuth, the
                values are essentially geometric; near the horizon, refraction
                can shift the apparent elevation by about 0.5°.
              </p>

              <h3>Which time zone should I use?</h3>
              <p>
                If you click <strong>Now</strong> or
                <strong>Use my location</strong>, the calculator will infer your
                current time zone and DST setting. If you are computing solar
                position for a different location, enter that location’s
                standard UTC offset (e.g. −5 for US Eastern Standard Time, +1
                for Central European Time) and choose whether DST is in effect
                on the selected date.
              </p>

              <h3>Can I use this for solar panel yield calculations?</h3>
              <p>
                Yes. This tool provides the solar geometry (elevation, azimuth,
                and sun path) that underpins PV yield models. To estimate energy
                production you would combine the solar position with irradiance
                data and your system’s tilt, azimuth, and efficiency. For many
                applications, the accuracy of this calculator is more than
                sufficient.
              </p>

              <h3>Why doesn’t solar noon occur exactly at 12:00?</h3>
              <p>
                Solar noon is when the Sun reaches its highest point in the sky,
                which depends on your exact longitude and the equation of time.
                Time zones are wide, and the Earth’s orbit is slightly
                elliptical with a tilted axis. These effects cause solar noon to
                drift by up to about ±15 minutes (or more when DST is applied)
                from 12:00 clock time.
              </p>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Solar, Position.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">Related Science Tools</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/luminosity"
                  class="text-blue-600 hover:underline"
                  >Stellar Luminosity Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/hubble-s-law-calculator"
                  class="text-blue-600 hover:underline"
                  >Hubble’s Law Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/redshift"
                  class="text-blue-600 hover:underline"
                  >Astronomical Redshift (Doppler)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/satellite-orbit"
                  class="text-blue-600 hover:underline"
                  >Satellite Orbit Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/planck-s-law-calculator"
                  class="text-blue-600 hover:underline"
                  >Blackbody Radiation (Planck’s Law)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lorentz-factor"
                  class="text-blue-600 hover:underline"
                  >Special Relativity (Lorentz Factor)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/standard-atmosphere"
                  class="text-blue-600 hover:underline"
                  >Standard Atmosphere Model</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/radioactive-decay"
                  class="text-blue-600 hover:underline"
                  >Radioactive Decay Calculator</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Popular Converters</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/mph-to-kph"
                  class="text-blue-600 hover:underline"
                  >MPH to KPH Converter</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/length-converter"
                  class="text-blue-600 hover:underline"
                  >Length Unit Converter</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/energy-unit-converter"
                  class="text-blue-600 hover:underline"
                  >Energy Unit Converter</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/angle-converter"
                  class="text-blue-600 hover:underline"
                  >Angle Unit Converter</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Utility: degrees/radians
      const DEG2RAD = Math.PI / 180;
      const RAD2DEG = 180 / Math.PI;

      function toRadians(deg) {
        return deg * DEG2RAD;
      }
      function toDegrees(rad) {
        return rad * RAD2DEG;
      }

      function pad2(n) {
        return n.toString().padStart(2, "0");
      }

      function formatTimeFromMinutes(totalMinutes) {
        if (isNaN(totalMinutes)) return "–";
        totalMinutes = ((totalMinutes % (24 * 60)) + 24 * 60) % (24 * 60); // wrap
        const h = Math.floor(totalMinutes / 60);
        const m = Math.round(totalMinutes % 60);
        return pad2(h) + ":" + pad2(m);
      }

      function formatHMS(seconds) {
        if (isNaN(seconds)) return "–";
        const sign = seconds < 0 ? "-" : "";
        seconds = Math.abs(seconds);
        const h = Math.floor(seconds / 3600);
        const m = Math.floor((seconds % 3600) / 60);
        const s = Math.round(seconds % 60);
        return sign + pad2(h) + ":" + pad2(m) + ":" + pad2(s);
      }

      function formatAngle(deg, decimals = 2) {
        if (isNaN(deg)) return "–";
        return deg.toFixed(decimals) + "°";
      }

      // Julian day from UTC date
      function julianDay(date) {
        const year = date.getUTCFullYear();
        let month = date.getUTCMonth() + 1;
        const day =
          date.getUTCDate() +
          (date.getUTCHours() +
            (date.getUTCMinutes() + date.getUTCSeconds() / 60) / 60) /
            24;

        let A = Math.floor(year / 100);
        let B = 2 - A + Math.floor(A / 4);

        if (month <= 2) {
          month += 12;
          yearMinus = year - 1;
        } else {
          yearMinus = year;
        }

        const JD =
          Math.floor(365.25 * (yearMinus + 4716)) +
          Math.floor(30.6001 * (month + 1)) +
          day +
          B -
          1524.5;
        return JD;
      }

      // Solar position algorithm (simplified NOAA-style)
      function solarPosition(dateUTC, latitudeDeg, longitudeDeg) {
        const JD = julianDay(dateUTC);
        const T = (JD - 2451545.0) / 36525.0;

        // Geometric mean longitude of the Sun (deg)
        let L0 = 280.46646 + T * (36000.76983 + T * 0.0003032);
        L0 = ((L0 % 360) + 360) % 360;

        // Geometric mean anomaly of the Sun (deg)
        const M = 357.52911 + T * (35999.05029 - 0.0001537 * T);

        // Eccentricity of Earth's orbit
        const e = 0.016708634 - T * (0.000042037 + 0.0000001267 * T);

        // Sun's equation of center
        const Mrad = toRadians(M);
        const C =
          (1.914602 - T * (0.004817 + 0.000014 * T)) * Math.sin(Mrad) +
          (0.019993 - 0.000101 * T) * Math.sin(2 * Mrad) +
          0.000289 * Math.sin(3 * Mrad);

        // True longitude and anomaly
        const trueLong = L0 + C;
        const trueAnom = M + C;

        // Apparent longitude
        const omega = 125.04 - 1934.136 * T;
        const lambda =
          trueLong - 0.00569 - 0.00478 * Math.sin(toRadians(omega));

        // Mean obliquity of the ecliptic
        const epsilon0 =
          23 +
          (26 + (21.448 - T * (46.815 + T * (0.00059 - T * 0.001813))) / 60) /
            60;
        const epsilon = epsilon0 + 0.00256 * Math.cos(toRadians(omega));

        // Declination of the Sun
        const epsilonRad = toRadians(epsilon);
        const lambdaRad = toRadians(lambda);
        const sinDec = Math.sin(epsilonRad) * Math.sin(lambdaRad);
        const cosDec = Math.sqrt(1 - sinDec * sinDec);
        const declination = toDegrees(Math.asin(sinDec));

        // Equation of time (minutes)
        const y = Math.tan(epsilonRad / 2) * Math.tan(epsilonRad / 2);
        const L0rad = toRadians(L0);
        const Etime =
          4 *
          toDegrees(
            y * Math.sin(2 * L0rad) -
              2 * e * Math.sin(Mrad) +
              4 * e * y * Math.sin(Mrad) * Math.cos(2 * L0rad) -
              0.5 * y * y * Math.sin(4 * L0rad) -
              1.25 * e * e * Math.sin(2 * Mrad)
          ); // minutes

        // Time in minutes from midnight UTC
        const minutesUTC =
          dateUTC.getUTCHours() * 60 +
          dateUTC.getUTCMinutes() +
          dateUTC.getUTCSeconds() / 60;

        // True solar time (minutes)
        const tst = (minutesUTC + Etime + 4 * longitudeDeg) % 1440;
        let hourAngle;
        if (tst / 4 < 0) {
          hourAngle = tst / 4 + 180;
        } else {
          hourAngle = tst / 4 - 180;
        }

        const haRad = toRadians(hourAngle);
        const latRad = toRadians(latitudeDeg);

        const sinAlt =
          Math.sin(latRad) * sinDec +
          Math.cos(latRad) * cosDec * Math.cos(haRad);
        let altitude = toDegrees(Math.asin(sinAlt));

        const cosAz =
          (sinDec - Math.sin(latRad) * sinAlt) /
          (Math.cos(latRad) * Math.cos(toRadians(altitude)));
        let azimuth = toDegrees(Math.acos(Math.min(Math.max(cosAz, -1), 1)));

        if (hourAngle > 0) {
          azimuth = (azimuth + 180) % 360;
        } else {
          azimuth = (540 - azimuth) % 360;
        }

        const zenith = 90 - altitude;

        return {
          declination,
          equationOfTimeMin: Etime,
          hourAngleDeg: hourAngle,
          elevationDeg: altitude,
          azimuthDeg: azimuth,
          zenithDeg: zenith,
        };
      }

      // Sunrise/sunset and day summary
      function solarDaySummary(
        dateLocal,
        latitudeDeg,
        longitudeDeg,
        tzOffsetHours,
        dstFlag
      ) {
        // Build local midnight
        const y = dateLocal.getFullYear();
        const m = dateLocal.getMonth();
        const d = dateLocal.getDate();
        const midnightLocal = new Date(y, m, d, 0, 0, 0, 0);

        // Convert local midnight to UTC
        const totalOffsetHours = tzOffsetHours + (dstFlag ? 1 : 0);
        const midnightUTC = new Date(
          midnightLocal.getTime() - totalOffsetHours * 3600 * 1000
        );

        // Compute declination and equation of time at noon UTC for the day
        const noonUTC = new Date(midnightUTC.getTime() + 12 * 3600 * 1000);
        const spNoon = solarPosition(noonUTC, latitudeDeg, longitudeDeg);
        const decl = spNoon.declination;
        const eot = spNoon.equationOfTimeMin;

        const latRad = toRadians(latitudeDeg);
        const declRad = toRadians(decl);
        const h0 = -0.833; // degrees, standard altitude for sunrise/sunset
        const h0Rad = toRadians(h0);

        const cosH0 =
          (Math.sin(h0Rad) - Math.sin(latRad) * Math.sin(declRad)) /
          (Math.cos(latRad) * Math.cos(declRad));

        let sunriseLocal = NaN;
        let sunsetLocal = NaN;
        let dayLengthMin = NaN;
        let maxElev = NaN;
        let note = "";

        if (cosH0 <= -1) {
          // Sun above horizon all day
          note = "Sun does not set on this date at this latitude.";
          dayLengthMin = 24 * 60;
          sunriseLocal = NaN;
          sunsetLocal = NaN;
        } else if (cosH0 >= 1) {
          // Sun below horizon all day
          note = "Sun does not rise on this date at this latitude.";
          dayLengthMin = 0;
          sunriseLocal = NaN;
          sunsetLocal = NaN;
        } else {
          const H0 = toDegrees(Math.acos(cosH0)); // degrees
          dayLengthMin = 8 * H0; // 2 * H0 / 15 * 60

          // Solar noon in minutes from local midnight
          const solarNoonMin =
            720 - 4 * longitudeDeg - eot + totalOffsetHours * 60;
          sunriseLocal = solarNoonMin - dayLengthMin / 2;
          sunsetLocal = solarNoonMin + dayLengthMin / 2;

          // Max elevation at solar noon
          maxElev = 90 - Math.abs(latitudeDeg - decl);
        }

        // Civil twilight (−6°)
        const hCivil = -6;
        const hCivilRad = toRadians(hCivil);
        const cosHc =
          (Math.sin(hCivilRad) - Math.sin(latRad) * Math.sin(declRad)) /
          (Math.cos(latRad) * Math.cos(declRad));
        let civilStart = NaN;
        let civilEnd = NaN;
        if (cosHc > -1 && cosHc < 1) {
          const Hc = toDegrees(Math.acos(cosHc));
          const civilLengthMin = 8 * Hc;
          const solarNoonMin =
            720 - 4 * longitudeDeg - eot + totalOffsetHours * 60;
          civilStart = solarNoonMin - civilLengthMin / 2;
          civilEnd = solarNoonMin + civilLengthMin / 2;
        }

        const solarNoonMinLocal =
          720 - 4 * longitudeDeg - eot + totalOffsetHours * 60;

        return {
          sunriseMin: sunriseLocal,
          sunsetMin: sunsetLocal,
          solarNoonMin: solarNoonMinLocal,
          dayLengthMin,
          maxElevationDeg: maxElev,
          civilStartMin: civilStart,
          civilEndMin: civilEnd,
          note,
        };
      }

      // Sun path for a day (every X minutes)
      function computeSunPath(
        dateLocal,
        latitudeDeg,
        longitudeDeg,
        tzOffsetHours,
        dstFlag,
        stepMinutes = 15
      ) {
        const y = dateLocal.getFullYear();
        const m = dateLocal.getMonth();
        const d = dateLocal.getDate();
        const midnightLocal = new Date(y, m, d, 0, 0, 0, 0);
        const totalOffsetHours = tzOffsetHours + (dstFlag ? 1 : 0);

        const points = [];
        for (let minutes = 0; minutes < 24 * 60; minutes += stepMinutes) {
          const localTime = new Date(midnightLocal.getTime() + minutes * 60000);
          const utcTime = new Date(
            localTime.getTime() - totalOffsetHours * 3600 * 1000
          );
          const sp = solarPosition(utcTime, latitudeDeg, longitudeDeg);
          points.push({
            minutesLocal: minutes,
            elevation: sp.elevationDeg,
            azimuth: sp.azimuthDeg,
          });
        }
        return points;
      }

      // Draw polar sun path
      function drawSunPath(canvas, points) {
        if (!canvas || !canvas.getContext) return;
        const ctx = canvas.getContext("2d");
        const w = (canvas.width = canvas.clientWidth);
        const h = (canvas.height = canvas.clientHeight);
        ctx.clearRect(0, 0, w, h);

        const cx = w / 2;
        const cy = h / 2;
        const maxRadius = Math.min(w, h) * 0.45;

        // Background
        ctx.fillStyle = "#ffffff";
        ctx.fillRect(0, 0, w, h);

        // Concentric circles for elevation
        ctx.strokeStyle = "#e5e7eb";
        ctx.lineWidth = 1;
        const rings = [0, 30, 60, 90]; // elevation
        rings.forEach((elev) => {
          const r = maxRadius * (1 - elev / 90);
          ctx.beginPath();
          ctx.arc(cx, cy, r, 0, 2 * Math.PI);
          ctx.stroke();
          ctx.fillStyle = "#9ca3af";
          ctx.font = "10px Inter, system-ui, sans-serif";
          ctx.textAlign = "left";
          ctx.textBaseline = "middle";
          ctx.fillText(elev + "°", cx + r + 3, cy);
        });

        // Cardinal directions
        ctx.fillStyle = "#4b5563";
        ctx.font = "11px Inter, system-ui, sans-serif";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText("N", cx, cy - maxRadius - 10);
        ctx.fillText("S", cx, cy + maxRadius + 10);
        ctx.fillText("E", cx + maxRadius + 12, cy);
        ctx.fillText("W", cx - maxRadius - 12, cy);

        // Axes
        ctx.strokeStyle = "#d1d5db";
        ctx.beginPath();
        ctx.moveTo(cx - maxRadius, cy);
        ctx.lineTo(cx + maxRadius, cy);
        ctx.moveTo(cx, cy - maxRadius);
        ctx.lineTo(cx, cy + maxRadius);
        ctx.stroke();

        // Sun path
        ctx.strokeStyle = "#2563eb";
        ctx.lineWidth = 2;
        ctx.beginPath();
        let started = false;
        points.forEach((p) => {
          if (p.elevation <= -5) return; // skip deep below horizon
          const r =
            maxRadius * (1 - Math.max(Math.min(p.elevation, 90), 0) / 90);
          const azRad = toRadians(p.azimuth - 0); // 0° at North, clockwise
          const x = cx + r * Math.sin(azRad);
          const y = cy - r * Math.cos(azRad);
          if (!started) {
            ctx.moveTo(x, y);
            started = true;
          } else {
            ctx.lineTo(x, y);
          }
        });
        ctx.stroke();

        // Mark solar noon (max elevation)
        let maxPoint = null;
        points.forEach((p) => {
          if (p.elevation > (maxPoint ? maxPoint.elevation : -999)) {
            maxPoint = p;
          }
        });
        if (maxPoint && maxPoint.elevation > 0) {
          const r = maxRadius * (1 - maxPoint.elevation / 90);
          const azRad = toRadians(maxPoint.azimuth);
          const x = cx + r * Math.sin(azRad);
          const y = cy - r * Math.cos(azRad);
          ctx.fillStyle = "#ef4444";
          ctx.beginPath();
          ctx.arc(x, y, 4, 0, 2 * Math.PI);
          ctx.fill();
        }
      }

      // UI wiring
      document.addEventListener("DOMContentLoaded", () => {
        const latInput = document.getElementById("latitude");
        const lonInput = document.getElementById("longitude");
        const tzInput = document.getElementById("timezone-offset");
        const dstSelect = document.getElementById("dst-flag");
        const dateInput = document.getElementById("date");
        const timeInput = document.getElementById("time");
        const elevInput = document.getElementById("elevation-m");

        const btnNow = document.getElementById("btn-now");
        const btnLoc = document.getElementById("btn-use-location");
        const btnCalc = document.getElementById("btn-calc");
        const btnDayCurve = document.getElementById("btn-day-curve");
        const statusEl = document.getElementById("status-message");

        const resElevation = document.getElementById("res-elevation");
        const resAzimuth = document.getElementById("res-azimuth");
        const resZenith = document.getElementById("res-zenith");
        const resHourAngle = document.getElementById("res-hour-angle");
        const resDeclination = document.getElementById("res-declination");
        const resEot = document.getElementById("res-eot");
        const resDaylightFlag = document.getElementById("res-daylight-flag");

        const resSunrise = document.getElementById("res-sunrise");
        const resSunset = document.getElementById("res-sunset");
        const resSolarNoon = document.getElementById("res-solar-noon");
        const resDayLength = document.getElementById("res-day-length");
        const resMaxElev = document.getElementById("res-max-elev");
        const resCivil = document.getElementById("res-civil");
        const resSunriseNote = document.getElementById("res-sunrise-note");

        const canvas = document.getElementById("sun-path-canvas");

        function setStatus(msg, isError = false) {
          statusEl.textContent = msg || "";
          statusEl.className =
            "text-xs " + (isError ? "text-red-600" : "text-gray-500");
        }

        function initNow() {
          const now = new Date();
          dateInput.value = now.toISOString().slice(0, 10);
          timeInput.value = pad2(now.getHours()) + ":" + pad2(now.getMinutes());
          const offsetMin = -now.getTimezoneOffset();
          const offsetHours = offsetMin / 60;
          tzInput.value = (Math.round(offsetHours * 4) / 4).toString();
          dstSelect.value = "auto";
        }

        initNow();

        btnNow.addEventListener("click", () => {
          initNow();
          setStatus("Using current local date and time.");
        });

        btnLoc.addEventListener("click", () => {
          if (!navigator.geolocation) {
            setStatus("Geolocation is not supported by your browser.", true);
            return;
          }
          setStatus("Detecting your location…");
          navigator.geolocation.getCurrentPosition(
            (pos) => {
              const { latitude, longitude } = pos.coords;
              latInput.value = latitude.toFixed(4);
              lonInput.value = longitude.toFixed(4);
              setStatus("Location detected.");
            },
            (err) => {
              setStatus("Could not get location: " + err.message, true);
            },
            { enableHighAccuracy: true, timeout: 10000, maximumAge: 600000 }
          );
        });

        function parseInputs() {
          const lat = parseFloat(latInput.value);
          const lon = parseFloat(lonInput.value);
          if (!isFinite(lat) || lat < -90 || lat > 90) {
            throw new Error(
              "Please enter a valid latitude between -90 and 90°."
            );
          }
          if (!isFinite(lon) || lon < -180 || lon > 180) {
            throw new Error(
              "Please enter a valid longitude between -180 and 180°."
            );
          }
          if (!dateInput.value || !timeInput.value) {
            throw new Error("Please select both date and time.");
          }
          const [year, month, day] = dateInput.value.split("-").map(Number);
          const [hour, minute] = timeInput.value.split(":").map(Number);
          const localDate = new Date(year, month - 1, day, hour, minute, 0, 0);

          let tz = parseFloat(tzInput.value);
          if (!isFinite(tz)) {
            const offsetMin = -localDate.getTimezoneOffset();
            tz = offsetMin / 60;
          }
          let dstFlag = 0;
          if (dstSelect.value === "auto") {
            const jan = new Date(localDate.getFullYear(), 0, 1);
            const jul = new Date(localDate.getFullYear(), 6, 1);
            const stdOffset = Math.max(
              jan.getTimezoneOffset(),
              jul.getTimezoneOffset()
            );
            dstFlag = localDate.getTimezoneOffset() < stdOffset ? 1 : 0;
          } else {
            dstFlag = dstSelect.value === "1" ? 1 : 0;
          }

          const totalOffsetHours = tz + dstFlag;
          const utcDate = new Date(
            localDate.getTime() - totalOffsetHours * 3600 * 1000
          );

          return { lat, lon, localDate, utcDate, tz, dstFlag };
        }

        function updateSolarPosition() {
          try {
            const { lat, lon, localDate, utcDate, tz, dstFlag } = parseInputs();
            const sp = solarPosition(utcDate, lat, lon);

            resElevation.textContent = formatAngle(sp.elevationDeg, 2);
            resAzimuth.textContent = formatAngle(sp.azimuthDeg, 2);
            resZenith.textContent = formatAngle(sp.zenithDeg, 2);
            resHourAngle.textContent = formatAngle(sp.hourAngleDeg, 2);
            resDeclination.textContent = formatAngle(sp.declination, 2);
            resEot.textContent = sp.equationOfTimeMin.toFixed(1) + " min";

            resDaylightFlag.textContent =
              sp.elevationDeg > 0
                ? "The Sun is above the horizon at this time."
                : "The Sun is below the horizon at this time.";

            const summary = solarDaySummary(localDate, lat, lon, tz, dstFlag);
            if (isNaN(summary.sunriseMin)) {
              resSunrise.textContent = "–";
              resSunset.textContent = "–";
            } else {
              resSunrise.textContent = formatTimeFromMinutes(
                summary.sunriseMin
              );
              resSunset.textContent = formatTimeFromMinutes(summary.sunsetMin);
            }
            resSolarNoon.textContent = formatTimeFromMinutes(
              summary.solarNoonMin
            );
            resDayLength.textContent = isNaN(summary.dayLengthMin)
              ? "–"
              : (summary.dayLengthMin / 60).toFixed(2) + " h";
            resMaxElev.textContent = isNaN(summary.maxElevationDeg)
              ? "–"
              : formatAngle(summary.maxElevationDeg, 1);
            if (!isNaN(summary.civilStartMin) && !isNaN(summary.civilEndMin)) {
              resCivil.textContent =
                formatTimeFromMinutes(summary.civilStartMin) +
                " – " +
                formatTimeFromMinutes(summary.civilEndMin);
            } else {
              resCivil.textContent = "–";
            }
            resSunriseNote.textContent = summary.note || "";

            setStatus("Solar position updated.");
          } catch (err) {
            setStatus(err.message, true);
          }
        }

        function updateSunPath() {
          try {
            const { lat, lon, localDate, tz, dstFlag } = parseInputs();
            const points = computeSunPath(localDate, lat, lon, tz, dstFlag, 15);
            drawSunPath(canvas, points);
            setStatus("Sun path plotted for selected date.");
          } catch (err) {
            setStatus(err.message, true);
          }
        }

        btnCalc.addEventListener("click", () => {
          updateSolarPosition();
        });

        btnDayCurve.addEventListener("click", () => {
          updateSunPath();
        });

        // Auto-calc on load if lat/lon are present
        if (latInput.value && lonInput.value) {
          updateSolarPosition();
          updateSunPath();
        }

        // Re-draw on window resize
        window.addEventListener("resize", () => {
          try {
            const { lat, lon, localDate, tz, dstFlag } = parseInputs();
            const points = computeSunPath(localDate, lat, lon, tz, dstFlag, 15);
            drawSunPath(canvas, points);
          } catch (e) {
            // ignore
          }
        });
      });
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

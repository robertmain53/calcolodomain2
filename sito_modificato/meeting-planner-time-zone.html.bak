<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/meeting-planner-time-zone" />
    <title>Meeting Planner Time Zone (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Meeting Planner Time Zone in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Meeting Planner Time Zone (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Meeting Planner Time Zone in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/meeting-planner-time-zone" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Meeting Planner Time Zone (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Meeting Planner Time Zone in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Meeting Planner Time Zone Converter",
        "description": "Interactive meeting planner time zone converter to find the best meeting time across multiple cities, highlight working hours, and export your schedule.",
        "url": "https://calcdomain.com/meeting-planner-time-zone",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://calcdomain.com"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Lifestyle & Everyday",
              "item": "https://calcdomain.com/categories/lifestyle-everyday"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Time & Date",
              "item": "https://calcdomain.com/time-date"
            },
            {
              "@type": "ListItem",
              "position": 4,
              "name": "Meeting Planner Time Zone Converter",
              "item": "https://calcdomain.com/meeting-planner-time-zone"
            }
          ]
        },
        "mainEntity": {
          "@type": "FAQPage",
          "name": "Meeting Planner Time Zone Converter – FAQ",
          "mainEntity": [
            {
              "@type": "Question",
              "name": "How do I use this meeting planner time zone converter?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Add the cities or time zones for all participants, set the meeting date, and adjust the time slider. The table updates instantly to show the local time for each participant and highlights working hours so you can quickly find overlapping slots."
              }
            },
            {
              "@type": "Question",
              "name": "Can I plan meetings for different dates or daylight saving changes?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes. Choose any date with the date picker. The tool uses your browser's time zone database, which includes historical and future daylight saving time rules, so offsets are adjusted automatically for the selected date."
              }
            },
            {
              "@type": "Question",
              "@id": "best-time-faq",
              "name": "How does the \"Find best time\" feature work?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "The planner scans the 24-hour day in 30-minute steps and scores each time based on how many participants are within their preferred working hours and how far from the middle of the night they are. It then suggests the top time slots with the highest combined score."
              }
            },
            {
              "@type": "Question",
              "name": "Can I export or share the meeting time?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes. Once you pick a time, youo Google Calendar, Outlook, or Apple Calendar."
              }
            },
            {
              "@type": "Question",
              "name": "Why do some hours show in red or green?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Green cells indicate that the time falls within a participant's defined working hours. Red cells indicate off-hours. This visual cue makes it easy to avoid scheduling meetings very early in the morning or late at night for any participant."
              }
            }
          ]
        }
      }</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Lifestyle & Everyday Calculators", "item": "https://calcdomain.com/categories/lifestyle-everyday"}, {"@type": "ListItem", "position": 3, "name": "Time & Date Calculators", "item": "https://calcdomain.com/subcategories/time-date"}, {"@type": "ListItem", "position": 4, "name": "Meeting Planner Time Zone Converter", "item": "https://calcdomain.com/meeting-planner-time-zone"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-blue-600 hover:underline">Lifestyle &amp; Everyday Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/time-date" class="text-blue-600 hover:underline">Time &amp; Date Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Meeting Planner Time Zone Converter</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl font-bold mb-2">
                Meeting Planner Time Zone Converter
              </h1>
              <p class="text-gray-600">
                Plan meetings across multiple time zones, highlight working
                hours, and instantly see the best overlapping times for your
                team.
              </p>
            </header>

            <!-- Controls -->
            <section
              aria-label="Meeting planner controls"
              class="mb-6 space-y-4"
            >
              <div class="grid md:grid-cols-3 gap-4">
                <div>
                  <label
                    for="meeting-date"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Meeting date</label
                  >
                  <input
                    type="date"
                    id="meeting-date"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                </div>
                <div>
                  <label
                    for="base-time"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Base time (reference)</label
                  >
                  <input
                    type="time"
                    id="base-time"
                    step="1800"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Use this as the starting time; all other cities update
                    automatically.
                  </p>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Step</label
                  >
                  <select
                    id="time-step"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                  >
                    <option value="30">30 minutes</option>
                    <option value="60">60 minutes</option>
                    <option value="15">15 minutes</option>
                  </select>
                </div>
              </div>

              <div class="flex flex-wrap items-center gap-3 mt-2">
                <button
                  id="add-row-btn"
                  type="button"
                  class="inline-flex items-center px-3 py-1.5 rounded-md bg-blue-600 text-white text-sm font-medium hover:bg-blue-700"
                >
                  + Add participant / city
                </button>
                <button
                  id="best-time-btn"
                  type="button"
                  class="inline-flex items-center px-3 py-1.5 rounded-md bg-emerald-600 text-white text-sm font-medium hover:bg-emerald-700"
                >
                  Find best time
                </button>
                <button
                  id="reset-selection-btn"
                  type="button"
                  class="inline-flex items-center px-3 py-1.5 rounded-md bg-gray-100 text-gray-800 text-sm font-medium hover:bg-gray-200"
                >
                  Clear selection
                </button>
              </div>

              <div
                id="best-time-output"
                class="hidden mt-2 text-sm bg-emerald-50 border border-emerald-200 text-emerald-800 rounded-md px-3 py-2"
              ></div>
            </section>

            <!-- Time grid -->
            <section aria-label="Time zone meeting grid" class="mb-6">
              <div
                class="overflow-x-auto scroll-shadow border border-gray-200 rounded-lg"
              >
                <table class="min-w-full text-xs">
                  <thead class="bg-gray-100">
                    <tr>
                      <th
                        class="sticky left-0 bg-gray-100 z-20 px-2 py-2 text-left font-semibold text-gray-700 w-56"
                      >
                        Participant / City
                      </th>
                      <th
                        class="px-2 py-2 text-left font-semibold text-gray-700 w-32"
                      >
                        Time zone
                      </th>
                      <th
                        class="px-2 py-2 text-left font-semibold text-gray-700 w-32"
                      >
                        Working hours
                      </th>
                      <th
                        class="px-2 py-2 text-left font-semibold text-gray-700 w-20"
                      >
                        Now
                      </th>
                      <th
                        class="px-2 py-2 text-left font-semibold text-gray-700 w-16"
                      >
                        Remove
                      </th>
                      <!-- Hour headers -->
                      <th id="hour-header-container" class="px-0 py-0">
                        <div class="flex">
                          <!-- JS will inject 24 hour columns -->
                        </div>
                      </th>
                    </tr>
                  </thead>
                  <tbody id="participants-body">
                    <!-- Rows injected by JS -->
                  </tbody>
                </table>
              </div>
              <p class="mt-2 text-xs text-gray-500">
                Green cells = within working hours. Red cells = outside working
                hours. Orange border = current local hour. Click a cell to
                select a meeting time; drag to select a range.
              </p>
            </section>

            <!-- Output / export -->
            <section aria-label="Selected meeting time summary" class="mb-8">
              <h2 class="text-lg font-semibold mb-2">Selected meeting time</h2>
              <div id="selection-summary" class="text-sm text-gray-700 mb-3">
                No time selected yet. Click a cell in the grid to choose a
                meeting time.
              </div>
              <div class="flex flex-wrap gap-3">
                <button
                  id="copy-summary-btn"
                  type="button"
                  class="inline-flex items-center px-3 py-1.5 rounded-md bg-gray-800 text-white text-sm font-medium hover:bg-gray-900 disabled:opacity-40"
                  disabled
                >
                  Copy summary
                </button>
                <button
                  id="download-ics-btn"
                  type="button"
                  class="inline-flex items-center px-3 py-1.5 rounded-md bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700 disabled:opacity-40"
                  disabled
                >
                  Download .ics file
                </button>
              </div>
              <p
                id="copy-feedback"
                class="mt-2 text-xs text-emerald-600 hidden"
              >
                Copied to clipboard.
              </p>
            </section>

            <!-- Explanatory content -->
            <section class="prose">
              <h2>How to use the Meeting Planner Time Zone Converter</h2>
              <p>
                This tool helps you schedule meetings across multiple time zones
                without mental math or endless back-and-forth emails. It
                combines a world clock, time zone converter, and meeting planner
                into a single interactive grid.
              </p>

              <h3>1. Add participants and cities</h3>
              <ul>
                <li>
                  Click <strong>“Add participant / city”</strong> to insert a
                  new row.
                </li>
                <li>
                  Enter a label (e.g., “Alice – New York”, “Berlin office”,
                  “Client in Tokyo”).
                </li>
                <li>
                  Select the appropriate time zone from the dropdown list.
                </li>
                <li>
                  Optionally adjust <strong>working hours</strong> for each
                  participant (default is 09:00–17:00).
                </li>
              </ul>

              <h3>2. Set the date and base time</h3>
              <ul>
                <li>
                  Choose the <strong>meeting date</strong>. Daylight saving time
                  (DST) is handled automatically for that date.
                </li>
                <li>
                  Set a <strong>base time</strong>. This is your reference time;
                  all other cities update instantly.
                </li>
                <li>
                  Use the <strong>step</strong> selector to choose 15, 30, or
                  60-minute increments in the grid.
                </li>
              </ul>

              <h3>3. Read the time zone grid</h3>
              <p>The grid shows a 24-hour day for each participant:</p>
              <ul>
                <li>
                  <span
                    class="inline-block px-1 rounded bg-green-100 border border-green-300 text-xs"
                    >Green</span
                  >
                  cells are within that person’s working hours.
                </li>
                <li>
                  <span
                    class="inline-block px-1 rounded bg-red-100 border border-red-300 text-xs"
                    >Red</span
                  >
                  cells are outside working hours.
                </li>
                <li>
                  An
                  <span
                    class="inline-block px-1 rounded border-2 border-orange-500 text-xs"
                    >orange border</span
                  >
                  marks the current local hour for each row.
                </li>
                <li>
                  Click a cell to select a meeting time; drag across cells to
                  select a <strong>time range</strong>.
                </li>
              </ul>

              <h3>4. Use “Find best time”</h3>
              <p>
                The <strong>“Find best time”</strong> button scans the day in
                30-minute steps and scores each time slot based on:
              </p>
              <ul>
                <li>How many participants are within their working hours.</li>
                <li>
                  How far the time is from the middle of the night for each
                  participant.
                </li>
              </ul>
              <p>
                The tool then suggests the top overlapping times and lets you
                jump directly to the best slot with one click.
              </p>

              <h3>5. Export or share your meeting</h3>
              <ul>
                <li>
                  Once you select a time, the <strong>summary</strong> shows the
                  local time for every participant.
                </li>
                <li>
                  Click <strong>“Copy summary”</strong> to paste into email,
                  Slack, or Teams.
                </li>
                <li>
                  Click <strong>“Download .ics file”</strong> to add the meeting
                  to Google Calendar, Outlook, or Apple Calendar.
                </li>
              </ul>

              <h2>Behind the scenes: how time zone conversion works</h2>
              <p>
                Time zones are defined as offsets from Coordinated Universal
                Time (UTC). For a given date and time, each region has an offset
                that may change due to daylight saving time (DST).
              </p>

              <div class="formula-box text-sm">
                <p class="font-semibold mb-1">Basic formula</p>
                <p>Let:</p>
                <ul>
                  <li>
                    <code>T<sub>ref</sub></code> = reference time in UTC
                  </li>
                  <li>
                    <code>UTC<sub>A</sub></code> = UTC offset of time zone A (in
                    hours)
                  </li>
                  <li>
                    <code>UTC<sub>B</sub></code> = UTC offset of time zone B (in
                    hours)
                  </li>
                </ul>
                <p>
                  Then the local time in B corresponding to a local time in A
                  is:
                </p>
                <p>
                  <code
                    >T<sub>B</sub> = T<sub>A</sub> - UTC<sub>A</sub> + UTC<sub
                      >B</sub
                    ></code
                  >
                </p>
                <p class="mt-1">
                  Our planner uses your browser’s time zone database to get the
                  correct offset (including DST) for each date and region.
                </p>
              </div>

              <h2>Tips for scheduling across time zones</h2>
              <ul>
                <li>
                  Try to keep meetings within <strong>09:00–17:00</strong> local
                  time for as many people as possible.
                </li>
                <li>
                  Rotate “unfriendly” times (very early or very late) across
                  team members when perfect overlap is impossible.
                </li>
                <li>
                  Use shorter meetings when someone has to join outside their
                  normal working hours.
                </li>
                <li>
                  Share the time zone summary in writing to avoid confusion.
                </li>
              </ul>

              <h2>FAQ</h2>

              <h3>Does this planner handle daylight saving time changes?</h3>
              <p>
                Yes. When you pick a date, the tool uses the time zone rules for
                that specific date. If one country has already switched to
                daylight saving time and another has not, the offset difference
                is calculated correctly.
              </p>

              <h3>What if I can’t find my city?</h3>
              <p>
                Choose a nearby major city in the same time zone (for example,
                use <strong>“Berlin”</strong> for most of Central Europe, or
                <strong>“Sydney”</strong> for much of eastern Australia). The
                offset and DST rules will be the same.
              </p>

              <h3>How accurate is the meeting time conversion?</h3>
              <p>
                The planner relies on the IANA time zone database built into
                modern browsers. This is the same source used by most operating
                systems and calendar apps, and is generally accurate for
                historical and future DST rules.
              </p>

              <h3>Can I plan recurring meetings?</h3>
              <p>
                The tool focuses on a single date at a time. For recurring
                meetings, pick a representative date (for example, the next
                occurrence), generate an <strong>.ics</strong> file, and then
                configure the recurrence pattern in your calendar app.
              </p>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/friendship" class="text-blue-600 hover:underline">Friendship Compatibility Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/semaphore-translator" class="text-blue-600 hover:underline">Semaphore Translator – Text ↔ Flag Signal Converter</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/goal-difference" class="text-blue-600 hover:underline">Goal Difference Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/smoking-cost" class="text-blue-600 hover:underline">Smoking Cost Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/lap-time" class="text-blue-600 hover:underline">Lap Time Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/minutes-calculator" class="text-blue-600 hover:underline">Minutes Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/overtime-calculator" class="text-blue-600 hover:underline">Overtime Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/passer-rating" class="text-blue-600 hover:underline">Passer Rating Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/date" class="text-blue-600 hover:underline">Date Calculator – Add or Subtract Days from a Date</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/engine-horsepower-calculator" class="text-blue-600 hover:underline">Engine Horsepower Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/beer-bottling" class="text-blue-600 hover:underline">Beer Bottling Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/ean-validator" class="text-blue-600 hover:underline">EAN Validator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/ein-validator" class="text-blue-600 hover:underline">EIN Validator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/shift-calculator" class="text-blue-600 hover:underline">Shift Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/calendar-calculator" class="text-blue-600 hover:underline">Calendar Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/ssn-validator" class="text-blue-600 hover:underline">SSN Validator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/mac-address-generator" class="text-blue-600 hover:underline">MAC Address Generator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/appointment-calculator" class="text-blue-600 hover:underline">Appointment Calculator</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/quarter-mile-calculator" class="text-blue-600 hover:underline">Quarter Mile Calculator (ET, Trap Speed & Horsepower)</a>.</p><p class="text-sm text-gray-700 mt-2">See also: <a href="https://calcdomain.com/cidr-calculator" class="text-blue-600 hover:underline">CIDR Calculator (IPv4)</a>.</p><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Meeting, Planner, Time, Zone.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              More Time &amp; Date Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/business-days-calculator"
                  class="text-blue-600 hover:underline"
                  >Business Days Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/workdays-calculator"
                  class="text-blue-600 hover:underline"
                  >Workdays Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/birthday"
                  class="text-blue-600 hover:underline"
                  >Birthday Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/hours-calculator"
                  class="text-blue-600 hover:underline"
                  >Hours Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/decimal-to-time"
                  class="text-blue-600 hover:underline"
                  >Decimal to Time Converter</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/time-duration-calculator.html"
                  class="text-blue-600 hover:underline"
                  >Time Duration Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/reading-time-calculator"
                  class="text-blue-600 hover:underline"
                  >Reading Time Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/time-to-decimal"
                  class="text-blue-600 hover:underline"
                  >Time to Decimal Converter</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/travel-time"
                  class="text-blue-600 hover:underline"
                  >Travel Time Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/hiking-time"
                  class="text-blue-600 hover:underline"
                  >Hiking Time Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/military-time-converter"
                  class="text-blue-600 hover:underline"
                  >Military Time Converter</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/week-number"
                  class="text-blue-600 hover:underline"
                  >Week Number Calculator</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Lifestyle &amp; Everyday</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/age-calculator"
                  class="text-blue-600 hover:underline"
                  >Age Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/time-calculator"
                  class="text-blue-600 hover:underline"
                  >Time Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/schedule-calculator"
                  class="text-blue-600 hover:underline"
                  >Schedule Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/working-hours-calculator"
                  class="text-blue-600 hover:underline"
                  >Working Hours Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/trip-cost-calculator.html"
                  class="text-blue-600 hover:underline"
                  >Trip Cost Calculator</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // --- Time zone data (simplified curated list) ---
      const TIMEZONES = [
        {
          id: "local",
          label: "Your browser time zone (auto)",
          tz: Intl.DateTimeFormat().resolvedOptions().timeZone,
        },
        {
          id: "Pacific/Honolulu",
          label: "Honolulu (US) – Hawaii",
          tz: "Pacific/Honolulu",
        },
        {
          id: "America/Los_Angeles",
          label: "Los Angeles (US) – Pacific",
          tz: "America/Los_Angeles",
        },
        {
          id: "America/Denver",
          label: "Denver (US) – Mountain",
          tz: "America/Denver",
        },
        {
          id: "America/Chicago",
          label: "Chicago (US) – Central",
          tz: "America/Chicago",
        },
        {
          id: "America/New_York",
          label: "New York (US) – Eastern",
          tz: "America/New_York",
        },
        {
          id: "America/Sao_Paulo",
          label: "São Paulo (Brazil)",
          tz: "America/Sao_Paulo",
        },
        { id: "Europe/London", label: "London (UK)", tz: "Europe/London" },
        { id: "Europe/Berlin", label: "Berlin (Germany)", tz: "Europe/Berlin" },
        { id: "Europe/Paris", label: "Paris (France)", tz: "Europe/Paris" },
        { id: "Europe/Madrid", label: "Madrid (Spain)", tz: "Europe/Madrid" },
        { id: "Europe/Moscow", label: "Moscow (Russia)", tz: "Europe/Moscow" },
        {
          id: "Africa/Johannesburg",
          label: "Johannesburg (South Africa)",
          tz: "Africa/Johannesburg",
        },
        { id: "Asia/Dubai", label: "Dubai (UAE)", tz: "Asia/Dubai" },
        {
          id: "Asia/Kolkata",
          label: "India – IST (Kolkata)",
          tz: "Asia/Kolkata",
        },
        { id: "Asia/Bangkok", label: "Bangkok (Thailand)", tz: "Asia/Bangkok" },
        { id: "Asia/Singapore", label: "Singapore", tz: "Asia/Singapore" },
        { id: "Asia/Hong_Kong", label: "Hong Kong", tz: "Asia/Hong_Kong" },
        { id: "Asia/Tokyo", label: "Tokyo (Japan)", tz: "Asia/Tokyo" },
        {
          id: "Australia/Sydney",
          label: "Sydney (Australia)",
          tz: "Australia/Sydney",
        },
        {
          id: "Pacific/Auckland",
          label: "Auckland (New Zealand)",
          tz: "Pacific/Auckland",
        },
      ];

      const HOURS = Array.from({ length: 24 }, (_, i) => i);

      const participantsBody = document.getElementById("participants-body");
      const hourHeaderContainer = document.getElementById(
        "hour-header-container"
      ).firstElementChild;
      const meetingDateInput = document.getElementById("meeting-date");
      const baseTimeInput = document.getElementById("base-time");
      const timeStepSelect = document.getElementById("time-step");
      const addRowBtn = document.getElementById("add-row-btn");
      const bestTimeBtn = document.getElementById("best-time-btn");
      const resetSelectionBtn = document.getElementById("reset-selection-btn");
      const bestTimeOutput = document.getElementById("best-time-output");
      const selectionSummary = document.getElementById("selection-summary");
      const copySummaryBtn = document.getElementById("copy-summary-btn");
      const downloadIcsBtn = document.getElementById("download-ics-btn");
      const copyFeedback = document.getElementById("copy-feedback");

      let participants = [];
      let selection = { start: null, end: null }; // in minutes from midnight UTC
      let isDragging = false;

      function formatHourLabel(h) {
        const ampm = h >= 12 ? "PM" : "AM";
        const hour12 = h % 12 === 0 ? 12 : h % 12;
        return `${hour12}${ampm}`;
      }

      function initHourHeaders() {
        hourHeaderContainer.innerHTML = "";
        HOURS.forEach((h) => {
          const div = document.createElement("div");
          div.className =
            "time-cell px-2 py-1 text-center font-semibold text-gray-700 border-l border-gray-200 bg-gray-50";
          div.textContent = formatHourLabel(h);
          hourHeaderContainer.appendChild(div);
        });
      }

      function getSelectedDate() {
        const val = meetingDateInput.value;
        if (!val) return null;
        const [y, m, d] = val.split("-").map(Number);
        return new Date(Date.UTC(y, m - 1, d));
      }

      function getBaseTimeMinutes() {
        const val = baseTimeInput.value;
        if (!val) return null;
        const [h, m] = val.split(":").map(Number);
        return h * 60 + m;
      }

      function localDateTimeToUtcMinutes(date, timeMinutes, timeZone) {
        // date: Date at UTC midnight
        const [y, m, d] = [
          date.getUTCFullYear(),
          date.getUTCMonth(),
          date.getUTCDate(),
        ];
        const local = new Date(Date.UTC(y, m, d, 0, 0));
        // Create local time via toLocaleString trick
        const localStr = new Date(
          local.getTime() + timeMinutes * 60000
        ).toLocaleString("en-US", { timeZone });
        const localDate = new Date(localStr);
        return Math.round(localDate.getTime() / 60000);
      }

      function utcMinutesToLocalMinutes(utcMinutes, timeZone) {
        const utcMs = utcMinutes * 60000;
        const utcDate = new Date(utcMs);
        const localStr = utcDate.toLocaleString("en-US", { timeZone });
        const localDate = new Date(localStr);
        return localDate.getHours() * 60 + localDate.getMinutes();
      }

      function addParticipantRow(defaults = {}) {
        const rowId = Date.now() + Math.random().toString(16).slice(2);
        const tr = document.createElement("tr");
        tr.dataset.id = rowId;

        const nameTd = document.createElement("td");
        nameTd.className =
          "sticky left-0 bg-white z-10 border-t border-gray-200 px-2 py-1 align-top";
        nameTd.innerHTML = `
      <input type="text" class="w-full border border-gray-300 rounded-md px-2 py-1 text-xs mb-1" placeholder="Name / city" value="${
        defaults.name || ""
      }">
    `;
        tr.appendChild(nameTd);

        const tzTd = document.createElement("td");
        tzTd.className = "border-t border-gray-200 px-2 py-1 align-top";
        const select = document.createElement("select");
        select.className =
          "w-full border border-gray-300 rounded-md px-2 py-1 text-xs";
        TIMEZONES.forEach((tz) => {
          const opt = document.createElement("option");
          opt.value = tz.tz;
          opt.textContent = tz.label;
          if (defaults.tz && defaults.tz === tz.tz) opt.selected = true;
        });
        if (!defaults.tz)
          select.value = Intl.DateTimeFormat().resolvedOptions().timeZone;
        tzTd.appendChild(select);
        tr.appendChild(tzTd);

        const workTd = document.createElement("td");
        workTd.className = "border-t border-gray-200 px-2 py-1 align-top";
        workTd.innerHTML = `
      <div class="flex items-center gap-1 mb-1">
        <input type="time" class="work-start w-20 border border-gray-300 rounded-md px-1 py-0.5 text-xs" value="${
          defaults.workStart || "09:00"
        }">
        <span class="text-xs text-gray-500">to</span>
        <input type="time" class="work-end w-20 border border-gray-300 rounded-md px-1 py-0.5 text-xs" value="${
          defaults.workEnd || "17:00"
        }">
      </div>
    `;
        tr.appendChild(workTd);

        const nowTd = document.createElement("td");
        nowTd.className =
          "border-t border-gray-200 px-2 py-1 align-top text-xs text-gray-600";
        nowTd.textContent = "-";
        tr.appendChild(nowTd);

        const removeTd = document.createElement("td");
        removeTd.className =
          "border-t border-gray-200 px-2 py-1 align-top text-center";
        const removeBtn = document.createElement("button");
        removeBtn.type = "button";
        removeBtn.className = "text-red-500 text-xs hover:underline";
        removeBtn.textContent = "Remove";
        removeBtn.addEventListener("click", () => {
          participants = participants.filter((p) => p.id !== rowId);
          tr.remove();
          updateSelectionSummary();
        });
        removeTd.appendChild(removeBtn);
        tr.appendChild(removeTd);

        const cellsTd = document.createElement("td");
        cellsTd.className = "border-t border-gray-200 px-0 py-0";
        const rowDiv = document.createElement("div");
        rowDiv.className = "flex";
        HOURS.forEach((h) => {
          const cell = document.createElement("div");
          cell.className =
            "time-cell border-l border-gray-100 px-1 py-3 text-center cursor-pointer select-none";
          cell.dataset.hour = h;
          cell.addEventListener("mousedown", (e) => {
            e.preventDefault();
            const utcMinutes = getUtcMinutesForCell(rowId, h);
            selection.start = utcMinutes;
            selection.end = utcMinutes;
            isDragging = true;
            updateGrid();
            updateSelectionSummary();
          });
          cell.addEventListener("mouseenter", () => {
            if (isDragging && selection.start != null) {
              const utcMinutes = getUtcMinutesForCell(rowId, h);
              selection.end = utcMinutes;
              updateGrid();
              updateSelectionSummary();
            }
          });
          rowDiv.appendChild(cell);
        });
        cellsTd.appendChild(rowDiv);
        tr.appendChild(cellsTd);

        participantsBody.appendChild(tr);

        participants.push({
          id: rowId,
          get name() {
            return nameTd.querySelector("input").value || "Participant";
          },
          get tz() {
            return select.value;
          },
          get workStartMinutes() {
            const v = workTd.querySelector(".work-start").value || "09:00";
            const [h, m] = v.split(":").map(Number);
            return h * 60 + m;
          },
          get workEndMinutes() {
            const v = workTd.querySelector(".work-end").value || "17:00";
            const [h, m] = v.split(":").map(Number);
            return h * 60 + m;
          },
          nowTd,
        });

        updateGrid();
      }

      function getUtcMinutesForCell(participantId, hour) {
        const date = getSelectedDate();
        if (!date) {
          const today = new Date();
          const utcMidnight = Date.UTC(
            today.getUTCFullYear(),
            today.getUTCMonth(),
            today.getUTCDate()
          );
          const base = new Date(utcMidnight + hour * 3600000);
          return Math.round(base.getTime() / 60000);
        }
        const participant = participants.find((p) => p.id === participantId);
        const localMinutes = hour * 60;
        return localDateTimeToUtcMinutes(date, localMinutes, participant.tz);
      }

      function isWithinWorkingHours(localMinutes, start, end) {
        if (start <= end) {
          return localMinutes >= start && localMinutes < end;
        } else {
          // overnight shift
          return localMinutes >= start || localMinutes < end;
        }
      }

      function updateNowColumns() {
        const now = new Date();
        participants.forEach((p) => {
          const localStr = now.toLocaleString("en-US", {
            timeZone: p.tz,
            hour: "2-digit",
            minute: "2-digit",
            hour12: false,
            weekday: "short",
          });
          p.nowTd.textContent = localStr;
        });
      }

      function updateGrid() {
        const date = getSelectedDate();
        const baseMinutes = getBaseTimeMinutes();
        const step = parseInt(timeStepSelect.value, 10);

        // Update base time default if empty
        if (!baseMinutes) {
          const now = new Date();
          baseTimeInput.value = now.toTimeString().slice(0, 5);
        }

        // For each row, update cell classes and labels
        participants.forEach((p) => {
          const tr = participantsBody.querySelector(`tr[data-id="${p.id}"]`);
          if (!tr) return;
          const cells = tr.querySelectorAll(".time-cell[data-hour]");
          const nowLocal = new Date().toLocaleString("en-US", {
            timeZone: p.tz,
          });
          const nowDate = new Date(nowLocal);
          const nowHour = nowDate.getHours();

          cells.forEach((cell) => {
            const hour = parseInt(cell.dataset.hour, 10);
            const utcMinutes = getUtcMinutesForCell(p.id, hour);
            const localMinutes = utcMinutesToLocalMinutes(utcMinutes, p.tz);
            const localH = Math.floor(localMinutes / 60);
            const localM = localMinutes % 60;

            const label = `${String(localH).padStart(2, "0")}:${String(
              localM
            ).padStart(2, "0")}`;
            cell.textContent = label;

            cell.classList.remove(
              "time-cell-working",
              "time-cell-off",
              "time-cell-current-hour",
              "selected",
              "in-range"
            );

            if (
              isWithinWorkingHours(
                localMinutes,
                p.workStartMinutes,
                p.workEndMinutes
              )
            ) {
              cell.classList.add("time-cell-working");
            } else {
              cell.classList.add("time-cell-off");
            }

            if (localH === nowHour) {
              cell.classList.add("time-cell-current-hour");
            }

            if (selection.start != null && selection.end != null) {
              const [s, e] =
                selection.start <= selection.end
                  ? [selection.start, selection.end]
                  : [selection.end, selection.start];
              if (
                utcMinutes === selection.start ||
                utcMinutes === selection.end
              ) {
                cell.classList.add("selected");
              }
              if (utcMinutes >= s && utcMinutes <= e) {
                cell.classList.add("in-range");
              }
            }
          });
        });
      }

      function summarizeSelection() {
        if (selection.start == null || selection.end == null) return null;
        const [s, e] =
          selection.start <= selection.end
            ? [selection.start, selection.end]
            : [selection.end, selection.start];
        const durationMinutes = e - s;
        const date = getSelectedDate() || new Date();

        const lines = [];
        lines.push(`Meeting date: ${date.toISOString().slice(0, 10)}`);
        lines.push(
          `Start (UTC): ${minutesToTimeString(
            s
          )}  |  End (UTC): ${minutesToTimeString(
            e
          )}  |  Duration: ${formatDuration(durationMinutes)}`
        );
        lines.push("");
        lines.push("Local times:");
        participants.forEach((p) => {
          const startLocal = utcMinutesToLocalMinutes(s, p.tz);
          const endLocal = utcMinutesToLocalMinutes(e, p.tz);
          const startStr = minutesToTimeString(startLocal);
          const endStr = minutesToTimeString(endLocal);
          lines.push(`- ${p.name} (${p.tz}): ${startStr} – ${endStr}`);
        });
        return lines.join("\n");
      }

      function minutesToTimeString(mins) {
        const m = ((mins % (24 * 60)) + 24 * 60) % (24 * 60);
        const h = Math.floor(m / 60);
        const mm = m % 60;
        return `${String(h).padStart(2, "0")}:${String(mm).padStart(2, "0")}`;
      }

      function formatDuration(mins) {
        const h = Math.floor(mins / 60);
        const m = mins % 60;
        const parts = [];
        if (h) parts.push(`${h} hr${h !== 1 ? "s" : ""}`);
        if (m) parts.push(`${m} min`);
        return parts.length ? parts.join(" ") : "0 min";
      }

      function updateSelectionSummary() {
        const summary = summarizeSelection();
        if (!summary) {
          selectionSummary.textContent =
            "No time selected yet. Click a cell in the grid to choose a meeting time.";
          copySummaryBtn.disabled = true;
          downloadIcsBtn.disabled = true;
          return;
        }
        selectionSummary.innerHTML = "";
        const pre = document.createElement("pre");
        pre.className =
          "whitespace-pre-wrap text-xs bg-gray-50 border border-gray-200 rounded-md p-3";
        pre.textContent = summary;
        selectionSummary.appendChild(pre);
        copySummaryBtn.disabled = false;
        downloadIcsBtn.disabled = false;
      }

      function generateIcs() {
        if (selection.start == null || selection.end == null) return null;
        const [s, e] =
          selection.start <= selection.end
            ? [selection.start, selection.end]
            : [selection.end, selection.start];
        const dtStart = new Date(s * 60000);
        const dtEnd = new Date(e * 60000);

        function toIcsDate(d) {
          return d.toISOString().replace(/[-:]/g, "").split(".")[0] + "Z";
        }

        const uid = "meeting-" + Date.now() + "@calcdomain.com";
        const lines = [
          "BEGIN:VCALENDAR",
          "VERSION:2.0",
          "PRODID:-//CalcDomain//Meeting Planner//EN",
          "CALSCALE:GREGORIAN",
          "BEGIN:VEVENT",
          `UID:${uid}`,
          `DTSTAMP:${toIcsDate(new Date())}`,
          `DTSTART:${toIcsDate(dtStart)}`,
          `DTEND:${toIcsDate(dtEnd)}`,
          "SUMMARY:Time zone meeting",
          "DESCRIPTION:" + (summarizeSelection() || "").replace(/\n/g, "\\n"),
          "END:VEVENT",
          "END:VCALENDAR",
        ];
        return lines.join("\r\n");
      }

      async function copySummaryToClipboard() {
        const summary = summarizeSelection();
        if (!summary) return;
        try {
          await navigator.clipboard.writeText(summary);
          copyFeedback.classList.remove("hidden");
          setTimeout(() => copyFeedback.classList.add("hidden"), 2000);
        } catch (e) {
          alert("Unable to copy to clipboard in this browser.");
        }
      }

      function downloadIcsFile() {
        const ics = generateIcs();
        if (!ics) return;
        const blob = new Blob([ics], { type: "text/calendar;charset=utf-8" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "meeting.ics";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      function findBestTime() {
        if (!participants.length) return;
        const date = getSelectedDate() || new Date();
        const scores = [];
        for (let minutes = 0; minutes < 24 * 60; minutes += 30) {
          const utcMinutes = localDateTimeToUtcMinutes(
            date,
            minutes,
            Intl.DateTimeFormat().resolvedOptions().timeZone
          );
          let score = 0;
          participants.forEach((p) => {
            const localMinutes = utcMinutesToLocalMinutes(utcMinutes, p.tz);
            const within = isWithinWorkingHours(
              localMinutes,
              p.workStartMinutes,
              p.workEndMinutes
            );
            if (within) score += 3;
            const hour = Math.floor(localMinutes / 60);
            const distFromMidnight = Math.min(
              Math.abs(hour - 12),
              Math.abs(hour + 12)
            ); // prefer daytime
            score += Math.max(0, 12 - distFromMidnight);
          });
          scores.push({ utcMinutes, score });
        }
        scores.sort((a, b) => b.score - a.score);
        const top = scores.slice(0, 3);
        if (!top.length || top[0].score === 0) {
          bestTimeOutput.textContent =
            "No clearly good overlapping time found. Try relaxing working hours or reducing participants.";
          bestTimeOutput.classList.remove("hidden");
          return;
        }
        const lines = top.map((slot, idx) => {
          const labelParts = participants.map((p) => {
            const localMinutes = utcMinutesToLocalMinutes(
              slot.utcMinutes,
              p.tz
            );
            return `${p.name}: ${minutesToTimeString(localMinutes)}`;
          });
          return `${idx + 1}. Start (UTC ${minutesToTimeString(
            slot.utcMinutes
          )}): ${labelParts.join(" | ")}`;
        });
        bestTimeOutput.innerHTML = lines.join("<br>");
        bestTimeOutput.classList.remove("hidden");

        // Jump to best slot
        selection.start = top[0].utcMinutes;
        selection.end = top[0].utcMinutes + 60;
        updateGrid();
        updateSelectionSummary();
      }

      // Event listeners
      addRowBtn.addEventListener("click", () => addParticipantRow());
      bestTimeBtn.addEventListener("click", findBestTime);
      resetSelectionBtn.addEventListener("click", () => {
        selection.start = null;
        selection.end = null;
        bestTimeOutput.classList.add("hidden");
        updateGrid();
        updateSelectionSummary();
      });
      meetingDateInput.addEventListener("change", () => {
        selection.start = null;
        selection.end = null;
        updateGrid();
        updateSelectionSummary();
      });
      baseTimeInput.addEventListener("change", () => {
        const baseMinutes = getBaseTimeMinutes();
        if (baseMinutes == null) return;
        const date = getSelectedDate() || new Date();
        const utcMinutes = localDateTimeToUtcMinutes(
          date,
          baseMinutes,
          Intl.DateTimeFormat().resolvedOptions().timeZone
        );
        selection.start = utcMinutes;
        selection.end = utcMinutes;
        updateGrid();
        updateSelectionSummary();
      });
      timeStepSelect.addEventListener("change", updateGrid);
      copySummaryBtn.addEventListener("click", copySummaryToClipboard);
      downloadIcsBtn.addEventListener("click", downloadIcsFile);

      document.addEventListener("mouseup", () => {
        isDragging = false;
      });

      // Initialize
      (function init() {
        initHourHeaders();
        const today = new Date();
        meetingDateInput.value = today.toISOString().slice(0, 10);
        baseTimeInput.value = today.toTimeString().slice(0, 5);

        addParticipantRow({
          name: "You (local)",
          tz: Intl.DateTimeFormat().resolvedOptions().timeZone,
        });
        addParticipantRow({ name: "New York", tz: "America/New_York" });
        addParticipantRow({ name: "London", tz: "Europe/London" });
        addParticipantRow({ name: "Singapore", tz: "Asia/Singapore" });

        updateNowColumns();
        setInterval(updateNowColumns, 60000);
        updateGrid();
      })();
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

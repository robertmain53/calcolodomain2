<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/cardio-calculator">





<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cardio Calculator - Calculate Calories Burned &amp; Heart Rate Zones</title>
<meta name="description" content="Estimate calories burned from 100+ activities using MET values, or find your target heart rate zones (based on AHA guidelines) for effective cardio training.">


<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
/* Result Card Styling */
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }
/* Prevention of Cumulative Layout Shift (CLS) */
#results-container { min-height: 150px; }
/* WCAG 2.1 AA Visible Focus */
:focus-visible {
outline: 3px solid #3b82f6; /* Blue-500 */
outline-offset: 2px;
border-radius: 4px;
}
/* Accessible Tooltip */
.tooltip-container { position: relative; display: inline-block; }
.tooltip-trigger { cursor: help; border: none; background: none; padding: 0; margin-left: 4px; }
.tooltip-text {
visibility: hidden; position: absolute; z-index: 10;
width: 250px; background-color: #1f2937; color: #fff;
text-align: left; font-weight: 400; padding: 0.75rem; border-radius: 6px;
bottom: 125%; left: 50%; transform: translateX(-50%);
opacity: 0; transition: opacity 0.3s;
}
.tooltip-trigger:focus + .tooltip-text,
.tooltip-trigger:hover + .tooltip-text {
visibility: visible;
opacity: 1;
}
/* Accessible Tab Interface */
[role="tab"] {
padding: 0.75rem 1rem; border-bottom: 3px solid transparent;
font-weight: 600; color: #6b7280; /* Gray-500 */
}
[role="tab"][aria-selected="true"] {
color: #2563eb; /* Blue-600 */
border-bottom-color: #2563eb;
}
[role="tabpanel"] { padding-top: 1.5rem; }
/* Form Error Styling */
.error-message { color: #dc2626; /* Red-600 */ font-size: 0.875rem; margin-top: 0.25rem; }
input[aria-invalid="true"] {
border-color: #dc2626;
box-shadow: 0 0 0 1px #dc2626;
}
/* Print-specific styles */
@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
header, footer, aside, #calculator-tabs { display: none !important; }
}
</style>

<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Cardio Calculator - Calculate Calories Burned & Heart Rate Zones",
  "description": "Estimate calories burned from 100+ activities using MET values, or find your target heart rate zones for effective cardio training.",
  "url": "https://calcdomain.com/cardio-calculator",
  "inLanguage": "en",
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "dateModified": "2026-01-19"
}</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Lifestyle & Everyday",
      "item": "https://calcdomain.com/categories/lifestyle-everyday"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Hobbies",
      "item": "https://calcdomain.com/subcategories/hobbies"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Cardio Calculator",
  "description": "A 2-in-1 tool to calculate exercise calorie burn (via METs) and target heart rate zones (via Karvonen/AHA formulas).",
  "applicationCategory": "HealthApplication",
  "operatingSystem": "Web",
  "browserRequirements": "Requires JavaScript",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  }
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to Use the Cardio Calculator",
  "description": "A step-by-step guide to calculating your cardio metrics.",
  "step": [
    {
      "@type": "HowToStep",
      "name": "Select Calculator",
      "text": "Choose between the 'Calories Burned' or 'Heart Rate Zones' calculator using the tabs."
    },
    {
      "@type": "HowToStep",
      "name": "Enter Your Details (Calories)",
      "text": "If calculating calories, select your activity, enter your body weight, and the exercise duration in minutes."
    },
    {
      "@type": "HowToStep",
      "name": "Enter Your Details (Heart Rate)",
      "text": "If calculating heart rate, enter your age. For a more precise Karvonen formula calculation, also enter your resting heart rate."
    },
    {
      "@type": "HowToStep",
      "name": "Calculate & Review",
      "text": "Click the 'Calculate' button to see your results. The tool will display your total calories burned or your personalized training zones."
    }
  ]
}
</script>
<script src="search.js" defer=""></script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">


<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\text{Calories/min} = \frac{(\text{MET} \times \text{Body Weight (kg)} \times 3.5)}{200}\]</div>
  <pre class="auditspine-mono">\text{Calories/min} = \frac{(\text{MET} \times \text{Body Weight (kg)} \times 3.5)}{200}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\text{MHR} = 220 - \text{Age}\]</div>
  <pre class="auditspine-mono">\text{MHR} = 220 - \text{Age}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\text{Target HR} = ((\text{MHR} - \text{RHR}) \times \%intensity) + \text{RHR}\]</div>
  <pre class="auditspine-mono">\text{Target HR} = ((\text{MHR} - \text{RHR}) \times \%intensity) + \text{RHR}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$ \text{Calories/min} = \frac{(\text{MET} \times \text{Body Weight (kg)} \times 3.5)}{200} $</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$ \text{MHR} = 220 - \text{Age} $</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$ \text{Target HR} = ((\text{MHR} - \text{RHR}) \times \%intensity) + \text{RHR} $</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Home</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/" target="_blank" rel="nofollow noopener">https://calcdomain.com/</a></li>
<li><strong>Lifestyle</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/lifestyle-everyday" target="_blank" rel="nofollow noopener">https://calcdomain.com/lifestyle-everyday</a></li>
<li><strong>Hobbies</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/hobbies" target="_blank" rel="nofollow noopener">https://calcdomain.com/subcategories/hobbies</a></li>
<li><strong>BMR Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/bmr" target="_blank" rel="nofollow noopener">https://calcdomain.com/bmr</a></li>
<li><strong>TDEE Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/tdee" target="_blank" rel="nofollow noopener">https://calcdomain.com/tdee</a></li>
<li><strong>Body Fat Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/body-fat" target="_blank" rel="nofollow noopener">https://calcdomain.com/body-fat</a></li>
<li><strong>Macro Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/macro" target="_blank" rel="nofollow noopener">https://calcdomain.com/macro</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300x250 or 300x600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why Use This Calculator?</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Get a 2-in-1 tool for both calorie burn and heart rate zones.</li>
<li>Uses scientifically-backed MET values and AHA guidelines.</li>
<li>Compare over 100 different activities, from running to household chores.</li>
<li>Personalize your heart rate zones using the (optional) Karvonen formula.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Health Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="https://calcdomain.com/bmr" class="text-blue-600 hover:underline">BMR Calculator</a></li>
<li><a href="https://calcdomain.com/tdee" class="text-blue-600 hover:underline">TDEE Calculator</a></li>
<li><a href="https://calcdomain.com/body-fat" class="text-blue-600 hover:underline">Body Fat Calculator</a></li>
<li><a href="https://calcdomain.com/macro" class="text-blue-600 hover:underline">Macro Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                                                                <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>
































<script>
document.addEventListener('DOMContentLoaded', () => {

// --- 1. Data (Authoritative Source) ---
// Sourced from 2011 Compendium of Physical Activities
const MET_DATA = {
"Archery (non-hunting)": 4.3,
"Backpacking": 7.0,
"Badminton (competitive)": 7.0,
"Badminton (social)": 4.5,
"Basketball (game)": 8.0,
"Basketball (shooting baskets)": 4.5,
"Billiards": 2.5,
"Bowling": 3.0,
"Boxing (punching bag)": 5.5,
"Boxing (sparring)": 7.8,
"Calisthenics (moderate)": 3.8,
"Calisthenics (vigorous, e.g., pushups, situps)": 8.0,
"Canoeing (light, <4 mph)": 3.0,
"Canoeing (moderate, >4 mph)": 7.0,
"Circuit training (general)": 8.0,
"Cooking (standing)": 2.5,
"Cleaning (light, e.g., dusting)": 2.3,
"Cleaning (heavy, e.g., scrubbing floors)": 4.5,
"Cycling (leisure, <10 mph)": 4.0,
"Cycling (moderate, 12-13.9 mph)": 8.0,
"Cycling (vigorous, 14-15.9 mph)": 10.0,
"Cycling (stationary, moderate)": 7.0,
"Cycling (stationary, vigorous)": 10.5,
"Dancing (aerobic, high impact)": 7.3,
"Dancing (ballet, modern)": 5.0,
"Dancing (ballroom, slow)": 3.0,
"Elliptical trainer (moderate)": 5.0,
"Fencing": 6.0,
"Fishing (general)": 3.5,
"Football (touch, flag)": 8.0,
"Gardening (general)": 3.8,
"Gardening (weeding, digging)": 5.0,
"Golf (walking, carrying clubs)": 4.3,
"Golf (using power cart)": 3.5,
"Gymnastics": 3.8,
"Hiking (cross-country)": 6.0,
"Hiking (with 10-20 lb pack)": 7.3,
"Hockey (field)": 7.8,
"Hockey (ice)": 8.0,
"Horseback riding (general)": 3.8,
"Hunting (general)": 5.0,
"Judo, Karate, Taekwondo": 10.3,
"Jumping rope (slow)": 8.8,
"Jumping rope (fast)": 12.3,
"Kayaking": 5.0,
"Kickboxing": 10.3,
"Lacrosse": 8.0,
"Martial arts (general)": 10.3,
"Mowing lawn (walk, power mower)": 5.5,
"Painting (house, interior)": 4.5,
"Pilates (general)": 3.0,
"Racquetball (casual)": 7.0,
"Racquetball (competitive)": 10.0,
"Raking lawn": 4.0,
"Rock climbing (ascending)": 8.0,
"Rowing (moderate, machine)": 7.0,
"Rowing (vigorous, machine)": 12.0,
"Running (5 mph, 12 min/mile)": 8.3,
"Running (6 mph, 10 min/mile)": 9.8,
"Running (7 mph, 8.5 min/mile)": 11.0,
"Running (8 mph, 7.5 min/mile)": 11.8,
"Running (10 mph, 6 min/mile)": 14.5,
"Running (cross-country)": 9.0,
"Sailing, Windsurfing": 5.0,
"Scuba diving": 7.0,
"Shoveling snow": 6.0,
"Skateboarding": 5.0,
"Skating (ice, general)": 7.0,
"Skiing (cross-country, moderate)": 6.8,
"Skiing (downhill, moderate)": 5.3,
"Soccer (casual)": 7.0,
"Soccer (competitive)": 10.0,
"Softball or Baseball": 5.0,
"Squash": 12.0,
"Stair-climbing (machine)": 9.0,
"Stretching, Hatha Yoga": 2.5,
"Surfing": 3.0,
"Swimming (freestyle, light/moderate)": 5.8,
"Swimming (freestyle, vigorous)": 9.8,
"Swimming (backstroke)": 4.8,
"Swimming (breaststroke)": 5.3,
"Table tennis (ping pong)": 4.0,
"Tai Chi": 3.0,
"Tennis (singles)": 7.3,
"Tennis (doubles)": 4.5,
"Volleyball (game)": 4.0,
"Volleyball (beach)": 8.0,
"Walking (2.5 mph, slow)": 2.8,
"Walking (3.0 mph, moderate)": 3.1,
"Walking (3.5 mph, brisk)": 3.8,
"Walking (4.0 mph, very brisk)": 5.0,
"Walking (uphill)": 6.0,
"Water aerobics": 5.3,
"Weight lifting (moderate)": 3.5,
"Weight lifting (vigorous)": 6.0,
"Wrestling": 6.0,
"Yoga (Power)": 4.0
};

const LBS_TO_KG = 0.453592;

// --- 2. DOM Element Cache ---
const elements = {
// Tabs
tabs: document.querySelectorAll('[role="tab"]'),
panels: document.querySelectorAll('[role="tabpanel"]'),
activeTab: document.querySelector('[role="tab"][aria-selected="true"]'),

// Inputs: Calories
activity: document.getElementById('activity'),
weight: document.getElementById('weight'),
weightUnit: document.getElementById('weightUnit'),
duration: document.getElementById('duration'),

// Inputs: Heart Rate
age: document.getElementById('age'),
restingHeartRate: document.getElementById('restingHeartRate'),

// Buttons
calculateBtn: document.getElementById('calculateBtn'),
resetBtn: document.getElementById('resetBtn'),

// Results
resultsContainer: document.getElementById('results-container'),
resultsTitle: document.getElementById('results-title'),
resultsPlaceholder: document.getElementById('results-placeholder'),
// Results: Calories
resultsCalories: document.getElementById('results-calories'),
totalCalories: document.getElementById('totalCalories'),
caloriesPerHour: document.getElementById('caloriesPerHour'),
// Results: Heart Rate
resultsHr: document.getElementById('results-hr'),
maxHeartRate: document.getElementById('maxHeartRate'),
hrZonesTable: document.getElementById('hr-zones-table'),

// Mobile Menu
mobileMenuToggle: document.getElementById('mobile-menu-toggle'),
mobileMenu: document.getElementById('mobile-menu')
};

// --- 3. Initialization ---

/**
* Populates the activity dropdown from the MET_DATA object.
* Uses document fragments for performance (one DOM insertion).
*/
function populateActivities() {
const fragment = document.createDocumentFragment();
const sortedActivities = Object.keys(MET_DATA).sort();

sortedActivities.forEach(activityName => {
const metValue = MET_DATA[activityName];
const option = document.createElement('option');
option.value = metValue;
option.textContent = `${activityName} (MET: ${metValue})`;
fragment.appendChild(option);
});

elements.activity.appendChild(fragment);
}

// --- 4. Event Listeners ---

/**
* Attaches all primary event listeners for the calculator.
*/
function attachListeners() {
// Tab switching
elements.tabs.forEach(tab => {
tab.addEventListener('click', switchTab);
});

// Calculation
elements.calculateBtn.addEventListener('click', handleCalculate);

// Reset
elements.resetBtn.addEventListener('click', handleReset);

// Inline Validation (WCAG)
const inputsToValidate = [
elements.weight, elements.duration, elements.age, elements.restingHeartRate
];
inputsToValidate.forEach(input => {
input.addEventListener('input', () => validateField(input));
});
elements.activity.addEventListener('change', () => validateField(elements.activity));

// Mobile Menu
elements.mobileMenuToggle.addEventListener('click', toggleMobileMenu);
}

// --- 5. Core Logic ---

/**
* Handles the tab switching behavior (A11y compliant).
*/
function switchTab(e) {
const clickedTab = e.currentTarget;

// Do nothing if already active
if (clickedTab === elements.activeTab) return;

// Deactivate all tabs and hide all panels
elements.tabs.forEach(tab => tab.setAttribute('aria-selected', 'false'));
elements.panels.forEach(panel => panel.classList.add('hidden'));

// Activate the clicked tab and show its panel
clickedTab.setAttribute('aria-selected', 'true');
const panelId = clickedTab.getAttribute('aria-controls');
document.getElementById(panelId).classList.remove('hidden');

elements.activeTab = clickedTab;

// Reset results when switching tabs
clearResults();
}

/**
* Toggles the mobile navigation menu (A11y compliant).
*/
function toggleMobileMenu() {
const isExpanded = elements.mobileMenuToggle.getAttribute('aria-expanded') === 'true';
elements.mobileMenuToggle.setAttribute('aria-expanded', !isExpanded);
elements.mobileMenu.classList.toggle('hidden');
}

/**
* Handles the master "Calculate" button click.
* Validates the active form, then calls the correct calculation function.
*/
function handleCalculate() {
clearResults();
const activePanelId = elements.activeTab.getAttribute('aria-controls');
let isValid = false;

if (activePanelId === 'panel-calories') {
isValid = validateCaloriesForm();
if (isValid) calculateCalories();
} else {
isValid = validateHrForm();
if (isValid) calculateHeartRate();
}
}

/**
* Resets all forms and results to their default state.
*/
function handleReset() {
// Reset calories form
elements.activity.selectedIndex = 0;
elements.weight.value = "150";
elements.weightUnit.value = "lbs";
elements.duration.value = "30";

// Reset heart rate form
elements.age.value = "35";
elements.restingHeartRate.value = "";

// Clear all error messages
document.querySelectorAll('.error-message').forEach(err => err.textContent = '');
document.querySelectorAll('input[aria-invalid="true"]').forEach(input => input.setAttribute('aria-invalid', 'false'));

clearResults();
}

/**
* Clears the results area and shows the placeholder.
*/
function clearResults() {
elements.resultsCalories.classList.add('hidden');
elements.resultsHr.classList.add('hidden');
elements.resultsPlaceholder.classList.remove('hidden');
elements.resultsTitle.textContent = 'Your Results';
}

// --- 6. Validation (WCAG & UX) ---

/**
* Validates the "Calories Burned" form.
* @returns {boolean} - True if all fields are valid.
*/
function validateCaloriesForm() {
const isWeightValid = validateField(elements.weight, 1, 1000);
const isDurationValid = validateField(elements.duration, 1, 1440);
const isActivityValid = validateField(elements.activity);
return isWeightValid && isDurationValid && isActivityValid;
}

/**
* Validates the "Heart Rate Zones" form.
* @returns {boolean} - True if all fields are valid.
*/
function validateHrForm() {
const isAgeValid = validateField(elements.age, 1, 120);
// RHR is optional, but if entered, it must be valid.
const isRhrValid = (elements.restingHeartRate.value === "") ? true : validateField(elements.restingHeartRate, 30, 120);
return isAgeValid && isRhrValid;
}

/**
* A generic, WCAG-compliant field validator.
* Shows/hides error messages and sets aria-invalid.
* @param {HTMLInputElement|HTMLSelectElement} input - The form field to validate.
* @param {number} [min] - The minimum numeric value.
* @param {number} [max] - The maximum numeric value.
* @returns {boolean} - True if the field is valid.
*/
function validateField(input, min = null, max = null) {
const errorEl = document.getElementById(`${input.id}-error`);
let message = '';
const value = input.value;
const numValue = parseFloat(value);

if (input.hasAttribute('aria-required') && value.trim() === '') {
message = 'This field is required.';
} else if (value !== '' && input.type === 'number') {
if (isNaN(numValue)) {
message = 'Please enter a valid number.';
} else if (min !== null && numValue < min) {
message = `Value must be at least ${min}.`;
} else if (max !== null && numValue > max) {
message = `Value must be no more than ${max}.`;
}
} else if (input.tagName === 'SELECT' && input.hasAttribute('aria-required') && value === '') {
message = 'Please select an option.';
}

if (message) {
errorEl.textContent = message;
input.setAttribute('aria-invalid', 'true');
return false;
} else {
errorEl.textContent = '';
input.setAttribute('aria-invalid', 'false');
return true;
}
}

// --- 7. Calculation Functions ---

/**
* Calculates and displays the calories burned.
*/
function calculateCalories() {
const met = parseFloat(elements.activity.value);
const weightVal = parseFloat(elements.weight.value);
const durationVal = parseFloat(elements.duration.value);
const isLbs = elements.weightUnit.value === 'lbs';

const weightInKg = isLbs ? (weightVal * LBS_TO_KG) : weightVal;
const caloriesPerMin = (met * weightInKg * 3.5) / 200;
const totalCalories = caloriesPerMin * durationVal;
const caloriesPerHour = caloriesPerMin * 60;

// Display results
elements.resultsPlaceholder.classList.add('hidden');
elements.totalCalories.textContent = totalCalories.toFixed(0);
elements.caloriesPerHour.textContent = caloriesPerHour.toFixed(0);
elements.resultsCalories.classList.remove('hidden');
elements.resultsTitle.textContent = 'Calories Burned Results';
}

/**
* Calculates and displays the heart rate zones.
*/
function calculateHeartRate() {
const ageVal = parseInt(elements.age.value);
const rhrVal = parseInt(elements.restingHeartRate.value) || 0; // 0 if empty
const mhr = 220 - ageVal;
const useKarvonen = rhrVal > 0;

const zones = [
{ name: 'Zone 1: Very Light', intensity: [0.5, 0.6] },
{ name: 'Zone 2: Light', intensity: [0.6, 0.7] },
{ name: 'Zone 3: Moderate', intensity: [0.7, 0.8] },
{ name: 'Zone 4: Hard', intensity: [0.8, 0.9] },
{ name: 'Zone 5: Maximum', intensity: [0.9, 1.0] }
];

let tableHtml = '';

zones.forEach(zone => {
const low = calculateThr(mhr, rhrVal, zone.intensity[0], useKarvonen);
const high = calculateThr(mhr, rhrVal, zone.intensity[1], useKarvonen);
tableHtml += `
<tr class="bg-white">
<td class="px-4 py-3 font-medium text-gray-900">${zone.name}</td>
<td class="px-4 py-3 text-gray-700">${(zone.intensity[0] * 100).toFixed(0)}-${(zone.intensity[1] * 100).toFixed(0)}%</td>
<td class="px-4 py-3 text-gray-700 font-semibold">${low} - ${high} bpm</td>
</tr>
`;
});

// Display results
elements.resultsPlaceholder.classList.add('hidden');
elements.maxHeartRate.innerHTML = `${mhr} <span class="text-base font-normal">bpm</span>`;
elements.hrZonesTable.innerHTML = tableHtml;
elements.resultsHr.classList.remove('hidden');
elements.resultsTitle.textContent = `Heart Rate Zone Results (${useKarvonen ? 'Karvonen Formula' : 'Standard Formula'})`;
}

/**
* Helper function for heart rate calculation.
* @param {number} mhr - Max Heart Rate.
* @param {number} rhr - Resting Heart Rate (0 if not provided).
* @param {number} intensity - The % intensity (e.g., 0.6 for 60%).
* @param {boolean} useKarvonen - Flag to use Karvonen formula.
* @returns {number} - The target heart rate in BPM.
*/
function calculateThr(mhr, rhr, intensity, useKarvonen) {
let thr;
if (useKarvonen) {
// Karvonen Formula
thr = ((mhr - rhr) * intensity) + rhr;
} else {
// Standard (Fox) Formula
thr = mhr * intensity;
}
return thr.toFixed(0);
}

// --- 8. Run Application ---
populateActivities();
attachListeners();

});
</script>


</body></html>
<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/commission">





 
<link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg">
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png">
<link rel="manifest" href="https://calcdomain.com/site.webmanifest">
<meta charset="utf-8">
<title>Commission Calculator | Finance • Business</title>
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="Professional commission calculator for sales and real estate. Compute simple, flat+percent, or tiered commissions, apply caps, and split payouts. WCAG 2.1 AA accessible, mobile‑first, and optimized for Core Web Vitals." name="description">
<meta content="Ugo Candido" name="author">

<meta content="#ffffff" name="theme-color">
<meta content="IE=edge" http-equiv="x-ua-compatible">
<style>
    /* ======= Design tokens (critical) ======= */
    :root{
      --primary:#005A9C; --primary-700:#004574; --secondary:#0B3D60;
      --bg:#F8F9FA; --surface:#FFFFFF; --text:#212529; --muted:#6C757D;
      --border:#DEE2E6; --success:#198754; --danger:#DC3545; --warning:#B8860B;
      --radius-s:6px; --radius-m:10px; --radius-l:12px;
      --touch:48px; --shadow-sm:0 2px 4px rgba(0,0,0,.05);
      --shadow:0 6px 16px rgba(0,0,0,.08);
    }
    *,*::before,*::after{box-sizing:border-box}
    html{font-size:16px}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.6}
    img{max-width:100%;display:block}
    a{color:var(--primary);text-decoration:none}
    a:hover{text-decoration:underline}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    .skip-link{position:absolute;left:8px;top:-40px;background:var(--primary);color:#fff;padding:.5rem .75rem;border-radius:0 0 6px 6px;z-index:1000}
    .skip-link:focus{top:0}
    /* ======= Layout ======= */
    .container{max-width:1200px;margin:0 auto;padding:0 1rem}
    header.site-header{background:var(--surface);border-bottom:1px solid var(--border);box-shadow:var(--shadow-sm)}
    .header-inner{display:grid;grid-template-columns:auto 1fr auto;gap:1rem;align-items:center;padding:.75rem 0}
    .logo{font-weight:800;color:var(--primary);font-size:1.25rem}
    .site-search{display:flex;align-items:center;gap:.5rem;width:100%}
    .site-search input[type="search"]{flex:1;min-width:0;padding:.6rem .75rem;border:1px solid var(--border);border-radius:8px}
    .site-search .btn{white-space:nowrap}
    nav.main-nav ul{display:flex;gap:.75rem;list-style:none;margin:0;padding:0}
    nav.main-nav a{display:inline-block;padding:.5rem .75rem;border-radius:8px}
    nav.main-nav a:focus{outline:3px solid var(--primary);outline-offset:2px}
    /* ======= Buttons ======= */
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:.7rem 1rem;border:1px solid transparent;border-radius:8px;cursor:pointer;font-weight:600;text-decoration:none;min-height:var(--touch);min-width:var(--touch)}
    .btn-primary{background:var(--primary);color:#fff;border-color:var(--primary)}
    .btn-primary:hover{background:var(--primary-700);border-color:var(--primary-700)}
    .btn-secondary{background:transparent;color:var(--primary);border-color:var(--primary)}
    .btn-ghost{background:transparent;border-color:var(--border);color:var(--text)}
    .help-btn{inline-size:var(--touch);block-size:var(--touch);min-inline-size:var(--touch);min-block-size:var(--touch);display:inline-grid;place-items:center;border:1px solid var(--border);border-radius:50%;font-weight:700;background:#fff;color:var(--primary)}
    .help-btn:focus{outline:3px solid var(--primary);outline-offset:2px}
    /* ======= Main ======= */
    main{padding:1.5rem 0}
    h1{font-size:clamp(1.75rem,3.5vw,2.25rem);margin:.25rem 0 0;color:var(--secondary)}
    h2{font-size:clamp(1.35rem,3vw,1.75rem);color:var(--secondary);margin:1.5rem 0 .75rem}
    h3{font-size:1.1rem;margin:1rem 0 .5rem;color:var(--secondary)}
    p{margin:.75rem 0}
    /* grid */
    .calculator-layout{display:grid;grid-template-columns:1fr;gap:1.25rem;margin-top:.75rem}
    @media (min-width: 992px){
      .calculator-layout{grid-template-columns:450px 1fr}
    }
    .card{background:var(--surface);border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow-sm);padding:1.25rem}
    /* ======= Form styles ======= */
    .form-group{margin-bottom:1rem}
    .form-group label{display:block;font-weight:700;margin-bottom:.35rem}
    .field-row{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap}
    .form-control{width:100%;padding:.75rem 1rem;min-height:48px;border:1px solid var(--border);border-radius:8px;font-size:1rem}
    .form-control:focus-visible{outline:3px solid var(--primary);outline-offset:2px}
    .form-control[aria-invalid="true"]{border-color:var(--danger)}
    .input-suffix{position:relative}
    .input-suffix .suffix{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);color:var(--muted)}
    .radio-grid{display:grid;grid-template-columns:1fr 1fr;gap:.5rem}
    .radio-tile{border:1px solid var(--border);border-radius:8px;display:flex;align-items:center;justify-content:center;gap:.5rem;padding:.5rem;min-height:48px}
    .radio-tile input{appearance:none;width:18px;height:18px;border:2px solid var(--primary);border-radius:50%;display:inline-block;position:relative}
    .radio-tile input:checked{background:radial-gradient(var(--primary) 45%, transparent 46%)}
    .radio-tile label{cursor:pointer;font-weight:600}
    .error-message{color:var(--danger);font-size:.875rem;margin-top:.25rem}
    .fieldset{border:1px solid var(--border);border-radius:10px;padding:1rem}
    .fieldset legend{font-weight:700;color:var(--secondary);padding:0 .5rem}
    .tooltip{display:none;margin-top:.5rem;border-left:3px solid var(--primary);padding:.5rem .75rem;background:#f0f6fb;border-radius:6px}
    .tooltip[aria-hidden="false"]{display:block}
    /* ======= Results ======= */
    .results{min-height:260px}
    .result-item{display:flex;justify-content:space-between;align-items:center;padding:.6rem 0;border-bottom:1px solid var(--border)}
    .result-item:last-child{border-bottom:none}
    .result-label{color:var(--muted)}
    .result-value{font-weight:800;color:var(--success);font-size:1.2rem}
    .badge{display:inline-block;background:#eef7f0;color:var(--success);border:1px solid #cfe9d6;border-radius:999px;padding:.15rem .5rem;font-size:.85rem;margin-left:.5rem}
    .note{font-size:.9rem;color:var(--muted)}
    /* ======= Footer ======= */
    footer.site-footer{background:#0b2a40;color:#fff;margin-top:2rem}
    .site-footer a{color:#fff}
    .footer-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem;padding:1.25rem 0}
    .footer-bottom{border-top:1px solid rgba(255,255,255,.15);padding:1rem 0;text-align:center;font-size:.9rem;color:#e6eef5}
    /* Accessibility high-contrast preference */
    @media (prefers-contrast: more){
      :root{--primary:#00305c;--secondary:#000}
    }
  </style>
<!-- MathJax for LaTeX rendering (deferred for performance) -->
<script crossorigin="anonymous" defer="" integrity="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script type="application/ld+json">[
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://calcdomain.com"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Finance",
        "item": "https://calcdomain.com/categories/finance"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Income and Payroll",
        "item": "https://calcdomain.com/subcategories/finance-income-and-payroll"
      },
      {
        "@type": "ListItem",
        "position": 4,
        "name": "Commission Calculator",
        "item": "https://calcdomain.com/commission"
      }
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Commission Calculator",
    "url": "https://calcdomain.com/commission",
    "description": "Commission Calculator",
    "inLanguage": "en"
  },
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Commission Calculator",
    "applicationCategory": "CalculatorApplication",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What does this calculator compute?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "It estimates your commission payout based on a base amount and a commission rate."
        }
      },
      {
        "@type": "Question",
        "name": "How do I handle tiered commissions?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Use the highest tier that applies, or calculate each tier separately and sum the results."
        }
      },
      {
        "@type": "Question",
        "name": "Is this gross or net commission?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "This is a gross estimate before taxes, deductions, or employer adjustments."
        }
      }
    ]
  }
]</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer=""></script>
<!-- MathJax for LaTeX formulas -->
<script>
  (function() {

    'use strict';

  window.MathJax = { tex: { inlineMath: [['\\(','\\)'], [',
    svg: { fontCache: 'global' }
  };


  })();</script>
<script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="preload" href="https://calcdomain.com/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="https://calcdomain.com/assets/js/page-enhancements.js" as="script">


<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body><header id="siteHeader">
  <div class="nav container">
    <a class="brand" href="https://calcdomain.com">CalcDomain</a>
    <div class="navRight">
      <a class="pill" href="https://calcdomain.com/search">Advanced Search</a>
      <span class="pill">Categories</span>
    </div>
  </div>
</header><div class="container">
  <main style="margin:24px 0 40px;" id="mainContent">
    <h1 id="pageTitle">Commission Calculator</h1>
    <p class="sub" id="pageSub">Professional commission calculator for sales and real estate. Compute simple, flat+percent, or tiered commissions, apply caps, and split payouts. WCAG 2.1 AA accessible, mobile‑first, and optimized for Core Web Vitals.</p>
    <div id="errorBox" class="alert" role="alert" aria-live="polite"></div>

    <div class="calc-hero" id="calcHero">
      <section class="card" id="inputsCard" aria-label="Calculator inputs"><main class="container" id="main" role="main">
<nav aria-label="Breadcrumb" class="note" style="margin:.5rem 0 1rem;">
Home › <a href="https://calcdomain.com/business-operations">Business Operations</a> › Commission Calculator
    </nav>
<nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> » <a href="https://calcdomain.com/categories/finance" class="hover:text-blue-600">Finance</a> » <a href="https://calcdomain.com/subcategories/finance-income-and-payroll" class="hover:text-blue-600">Income and Payroll</a></nav><h1>Commission Calculator</h1>
<p>
      This professional commission calculator helps sales reps, managers, and real‑estate professionals compute payouts quickly and accurately.
      Model simple percentage, flat+percent, or tiered commissions; apply caps; and split amounts between parties — all with accessible, mobile‑first UX.
    </p><section class="content-container"><h2>Quick guide</h2><ul><li>Sales or revenue amount used as the commission base.</li><li>Commission rate or percentage for the payout.</li><li>Any tier thresholds or bonuses applied to the base.</li></ul></section>




</main>
<div data-canon-btnrow="1" style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
<button id="calcBtn" type="button" class="btn">Calculate</button>

<button id="resetBtn" type="button" class="btn btnSecondary">Reset</button>
</div>
</section>
      <section class="card sticky-box" id="resultsCard" aria-label="Calculator results"></section>
    </div>

    <section class="card content-card" id="howToUse" aria-label="How to use and methodology">
      <h2>Full original guide (expanded)</h2>
    <a class="skip-link" href="#main">Skip to main content</a><hr class="auditspine-hr"><section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge auditspine-badge-warn">Audit: Needs review</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      <br><strong>Note:</strong> This page needs review to confirm formulas and sources.
    </div>
    <div class="auditspine-formula">
      <em>No formulas provided in audit spec.</em>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Commission Calculator</strong> — calcdomain.com · Accessed 2026-01-21<br><a href="https://calcdomain.com/commission" target="_blank" rel="nofollow noopener">https://calcdomain.com/commission</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-21
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-21
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verification pending</strong> · Last code update: 2026-01-21
  </div>
</section><link rel="preload" href="https://calcdomain.com/assets/js/mobile-menu.js" as="script"><link rel="preload" href="https://calcdomain.com/assets/js/page-enhancements.js" as="script"><style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style><a class="skip-link" href="#main">Skip to main content</a><main class="container" id="main" role="main">
<nav aria-label="Breadcrumb" class="note" style="margin:.5rem 0 1rem;">
Home › <a href="https://calcdomain.com/business-operations">Business Operations</a> › Commission Calculator
    </nav>
<nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> » <a href="https://calcdomain.com/categories/finance" class="hover:text-blue-600">Finance</a> » <a href="https://calcdomain.com/subcategories/finance-income-and-payroll" class="hover:text-blue-600">Income and Payroll</a></nav><h1>Commission Calculator</h1>
<p>
      This professional commission calculator helps sales reps, managers, and real‑estate professionals compute payouts quickly and accurately.
      Model simple percentage, flat+percent, or tiered commissions; apply caps; and split amounts between parties — all with accessible, mobile‑first UX.
    </p><section class="content-container"><h2>Quick guide</h2><ul><li>Sales or revenue amount used as the commission base.</li><li>Commission rate or percentage for the payout.</li><li>Any tier thresholds or bonuses applied to the base.</li></ul></section>


</main><hr class="auditspine-hr"><section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge auditspine-badge-warn">Audit: Needs review</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      <br><strong>Note:</strong> This page needs review to confirm formulas and sources.
    </div>
    <div class="auditspine-formula">
      <em>No formulas provided in audit spec.</em>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Commission Calculator</strong> — calcdomain.com · Accessed 2026-01-21<br><a href="https://calcdomain.com/commission" target="_blank" rel="nofollow noopener">https://calcdomain.com/commission</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-21
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-21
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verification pending</strong> · Last code update: 2026-01-21
  </div>
</section><link rel="preload" href="https://calcdomain.com/assets/js/mobile-menu.js" as="script"><link rel="preload" href="https://calcdomain.com/assets/js/page-enhancements.js" as="script"><style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style><a class="skip-link" href="#main">Skip to main content</a><main class="container" id="main" role="main">
<nav aria-label="Breadcrumb" class="note" style="margin:.5rem 0 1rem;">
Home › <a href="https://calcdomain.com/business-operations">Business Operations</a> › Commission Calculator
    </nav>
<nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> » <a href="https://calcdomain.com/categories/finance" class="hover:text-blue-600">Finance</a> » <a href="https://calcdomain.com/subcategories/finance-income-and-payroll" class="hover:text-blue-600">Income and Payroll</a></nav><h1>Commission Calculator</h1>
<p>
      This professional commission calculator helps sales reps, managers, and real‑estate professionals compute payouts quickly and accurately.
      Model simple percentage, flat+percent, or tiered commissions; apply caps; and split amounts between parties — all with accessible, mobile‑first UX.
    </p><section class="content-container"><h2>Quick guide</h2><ul><li>Sales or revenue amount used as the commission base.</li><li>Commission rate or percentage for the payout.</li><li>Any tier thresholds or bonuses applied to the base.</li></ul></section>


</main><hr class="auditspine-hr"><section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge auditspine-badge-warn">Audit: Needs review</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      <br><strong>Note:</strong> This page needs review to confirm formulas and sources.
    </div>
    <div class="auditspine-formula">
      <em>No formulas provided in audit spec.</em>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Commission Calculator</strong> — calcdomain.com · Accessed 2026-01-21<br><a href="https://calcdomain.com/commission" target="_blank" rel="nofollow noopener">https://calcdomain.com/commission</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-21
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-21
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verification pending</strong> · Last code update: 2026-01-21
  </div>
</section></section>

    <section class="meta-section" id="pageMeta" aria-label="Verification, changelog, formulas, citations">
  <details id="formulaDetails">
    <summary style="cursor:pointer; font-weight:700; color:var(--text)">Formulas</summary>
    <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
      <p style="margin:0;">(Formulas preserved from original page content, if present.)</p>
    </div>
  </details>

  

  

  <div class="badge-row" id="badgeRow">
    <div class="badge" id="versionBadge">Version 0.1.0-draft</div>
  </div>

<details id="citationDetails" style="margin-top:10px;">
  <summary style="cursor:pointer; font-weight:700; color:var(--text)">Citations</summary>
  <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
    <p style="margin:0;">Add authoritative sources relevant to this calculator (standards bodies, manuals, official docs).</p>
  </div>
</details>

<details id="changelogDetails" style="margin-top:10px;">
  <summary style="cursor:pointer; font-weight:700; color:var(--text)">Changelog</summary>
  <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
    <ul style="padding-left:18px; margin:0;">
      <li>0.1.0-draft — 2026-01-19: Initial draft (review required).</li>
    </ul>
  </div>
</details>
</section>
  </main>
</div><footer id="siteFooter" class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="border-t border-gray-800 pt-8 text-center text-gray-400">
      <p>© 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer><script defer="">
    (function(){
      'use strict';

      const $ = (sel) => document.querySelector(sel);
      const $$ = (sel) => Array.from(document.querySelectorAll(sel));

      // Elements
      const currencyEl = $('#currencySymbol');
      const saleEl = $('#saleAmount');
      const discEl = $('#discount');
      const percentFields = $('#percentFields');
      const percentRateEl = $('#percentRate');

      const flatplusFields = $('#flatplusFields');
      const flatFeeEl = $('#flatFee');
      const flatPlusRateEl = $('#flatPlusRate');

      const tieredFields = $('#tieredFields');
      const t1El = $('#t1'), r1El = $('#r1'), t2El = $('#t2'), r2El = $('#r2'), r3El = $('#r3');

      const capEl = $('#cap');
      const splitToggleEl = $('#splitToggle');
      const splitFieldsEl = $('#splitFields');
      const agentShareEl = $('#agentShare');

      // Tooltips
      const tooltipPairs = [
        ['saleTTBtn','saleTT'],
        ['discTTBtn','discTT'],
        ['tierTTBtn','tierTT'],
        ['capTTBtn','capTT']
      ];
      tooltipPairs.forEach(([btnId, tipId])=>{
        const btn = document.getElementById(btnId);
        const tip = document.getElementById(tipId);
        if(!btn || !tip) return;
        btn.addEventListener('click', ()=>{
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          tip.setAttribute('aria-hidden', String(expanded));
        });
        btn.addEventListener('keydown', (e)=>{
          if(e.key === 'Escape'){
            btn.setAttribute('aria-expanded', 'false');
            tip.setAttribute('aria-hidden','true');
            btn.focus();
          }
        });
      });

      // Results
      const baseOut = $('#baseOut');
      const commissionRawOut = $('#commissionRawOut');
      const commissionFinalOut = $('#commissionFinalOut');
      const capAppliedOut = $('#capAppliedOut');
      const effectiveRateOut = $('#effectiveRateOut');
      const netAfterOut = $('#netAfterOut');
      const splitSummary = $('#splitSummary');
      const agentOut = $('#agentOut');
      const partnerOut = $('#partnerOut');

      function fmt(n){
        const sym = (currencyEl.value || '$').trim();
        const num = isFinite(n) ? Number(n) : 0;
        return sym + ' ' + num.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2});
      }
      function pct(n){
        const num = isFinite(n) ? Number(n) : 0;
        return num.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2}) + '%';
      }

      // Validation helpers
      function setError(input, id, msg){
        input.setAttribute('aria-invalid','true');
        const el = document.getElementById(id);
        if(el){ el.textContent = msg || ''; }
      }
      function clearError(input, id){
        input.setAttribute('aria-invalid','false');
        const el = document.getElementById(id);
        if(el){ el.textContent = ''; }
      }
      function getVal(input){
        const v = parseFloat(input.value);
        return isNaN(v) ? 0 : v;
      }

      // Model show/hide
      const modelRadios = $$('input[name="model"]');
      function switchModel(){
        const val = (modelRadios.find(r=>r.checked) || {}).value;
        // toggle sections
        [
          [percentFields, val === 'percent'],
          [flatplusFields, val === 'flatplus'],
          [tieredFields, val === 'tiered']
        ].forEach(([el, show])=>{
          el.hidden = !show;
          el.setAttribute('aria-hidden', String(!show));
          // disable inputs within hidden sections to avoid validation noise
          el.querySelectorAll('input,select,textarea').forEach(inp => inp.disabled = !show);
        });
        compute(); // recalc on switch
      }
      modelRadios.forEach(r => r.addEventListener('change', switchModel));

      // Split toggle
      splitToggleEl.addEventListener('change', ()=>{
        const on = splitToggleEl.checked;
        splitFieldsEl.hidden = !on;
        splitFieldsEl.setAttribute('aria-hidden', String(!on));
        agentShareEl.disabled = !on;
        compute();
      });

      // Inline validation on blur
      function validateField(input){
        const id = input.id;
        const v = getVal(input);
        if(id === 'saleAmount'){
          if(v <= 0){ return setError(input,'saleAmountError','Enter a sale amount greater than 0.'); }
          return clearError(input,'saleAmountError');
        }
        if(id === 'discount'){
          if(v < 0){ return setError(input,'discountError','Discount cannot be negative.'); }
          const s = getVal(saleEl);
          if(v > s){ return setError(input,'discountError','Discount cannot exceed the sale amount.'); }
          return clearError(input,'discountError');
        }
        if(id === 'percentRate'){
          if(v < 0 || v > 100){ return setError(input,'percentRateError','Enter a percentage between 0 and 100.'); }
          return clearError(input,'percentRateError');
        }
        if(id === 'flatFee'){
          if(v < 0){ return setError(input,'flatFeeError','Flat fee cannot be negative.'); }
          return clearError(input,'flatFeeError');
        }
        if(id === 'flatPlusRate'){
          if(v < 0 || v > 100){ return setError(input,'flatPlusRateError','Enter a percentage between 0 and 100.'); }
          return clearError(input,'flatPlusRateError');
        }
        if(id === 't1'){
          if(v < 0){ return setError(input,'t1Error','Threshold must be zero or greater.'); }
          const t2 = getVal(t2El);
          if(t2 > 0 && v > t2){ return setError(input,'t1Error','Threshold 1 must be less than or equal to Threshold 2.'); }
          return clearError(input,'t1Error');
        }
        if(id === 't2'){
          if(v < 0){ return setError(input,'t2Error','Threshold must be zero or greater.'); }
          const t1 = getVal(t1El);
          if(v > 0 && v < t1){ return setError(input,'t2Error','Threshold 2 must be greater than or equal to Threshold 1.'); }
          return clearError(input,'t2Error');
        }
        if(id === 'r1'){
          if(v < 0 || v > 100){ return setError(input,'r1Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r1Error');
        }
        if(id === 'r2'){
          if(v < 0 || v > 100){ return setError(input,'r2Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r2Error');
        }
        if(id === 'r3'){
          if(v < 0 || v > 100){ return setError(input,'r3Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r3Error');
        }
        if(id === 'cap'){
          if(v < 0){ return setError(input,'capError','Cap cannot be negative. Use 0 for no cap.'); }
          return clearError(input,'capError');
        }
        if(id === 'agentShare'){
          if(v < 0 || v > 100){ return setError(input,'agentShareError','Enter a split percentage between 0 and 100.'); }
          return clearError(input,'agentShareError');
        }
      }
      // Attach blur listeners
      $$('input').forEach(inp => {
        inp.addEventListener('blur', () => validateField(inp));
      });

      // Compute logic
      function compute(){
        // Basic inputs
        const sale = getVal(saleEl);
        const disc = getVal(discEl);
        // Validate base to safeguard compute
        if(sale <= 0 || disc < 0 || disc > sale){
          baseOut.textContent = fmt(0);
          commissionRawOut.textContent = fmt(0);
          capAppliedOut.textContent = fmt(0);
          commissionFinalOut.textContent = fmt(0);
          effectiveRateOut.textContent = pct(0);
          netAfterOut.textContent = fmt(0);
          splitSummary.style.display = 'none';
          return;
        }
        const base = Math.max(0, sale - disc);

        // Determine model
        const model = (modelRadios.find(r=>r.checked)||{}).value;

        let commission = 0;
        if(model === 'percent'){
          const rate = Math.max(0, Math.min(100, getVal(percentRateEl)));
          commission = base * rate / 100;
        } else if(model === 'flatplus'){
          const fee = Math.max(0, getVal(flatFeeEl));
          const rate = Math.max(0, Math.min(100, getVal(flatPlusRateEl)));
          commission = fee + base * rate / 100;
        } else if(model === 'tiered'){
          // thresholds in ascending order; treat 0 as not provided for T2
          let T1 = Math.max(0, getVal(t1El));
          let T2 = Math.max(0, getVal(t2El));
          if(T2 && T2 < T1){ [T1, T2] = [T2, T1]; } // ensure order
          const R1 = Math.max(0, Math.min(100, getVal(r1El)));
          const R2 = Math.max(0, Math.min(100, getVal(r2El)));
          const R3 = Math.max(0, Math.min(100, getVal(r3El)));

          const part1 = Math.min(base, T1);
          const part2 = Math.max(0, Math.min(base - T1, Math.max(0, T2 - T1)));
          const part3 = Math.max(0, base - Math.max(T1, T2));
          commission = (part1 * R1 + part2 * R2 + part3 * R3) / 100;
        }

        // Apply cap if any
        const cap = Math.max(0, getVal(capEl));
        const capped = cap > 0 ? Math.min(commission, cap) : commission;
        const capApplied = Math.max(0, commission - capped);

        // Split
        const splitOn = splitToggleEl.checked;
        let agentAmt = 0, partnerAmt = 0;
        if(splitOn){
          const a = Math.max(0, Math.min(100, getVal(agentShareEl)));
          agentAmt = capped * a / 100;
          partnerAmt = capped - agentAmt;
        }

        // Net after commission
        const netAfter = sale - disc - capped;
        const effRate = base > 0 ? (capped / base * 100) : 0;

        // Render
        baseOut.textContent = fmt(base);
        commissionRawOut.textContent = fmt(commission);
        capAppliedOut.textContent = fmt(capApplied);
        commissionFinalOut.textContent = fmt(capped);
        effectiveRateOut.textContent = pct(effRate);
        netAfterOut.textContent = fmt(netAfter);

        if(splitOn){
          splitSummary.style.display = '';
          agentOut.textContent = fmt(agentAmt);
          partnerOut.textContent = fmt(partnerAmt);
        }else{
          splitSummary.style.display = 'none';
        }
      }

      // Live compute on input (debounced micro)
      let rafId = null;
      function scheduleCompute(){
        if(rafId) cancelAnimationFrame(rafId);
        rafId = requestAnimationFrame(()=>{ compute(); rafId = null; });
      }
      $$('input,select').forEach(el => {
        el.addEventListener('input', scheduleCompute);
        el.addEventListener('change', scheduleCompute);
      });

      // Init
      switchModel();
      compute();

      // Accessibility: ensure radio tiles clickable on label
      $$('.radio-tile').forEach(tile=>{
        tile.addEventListener('click', (e)=>{
          const input = tile.querySelector('input[type="radio"]');
          if(input){ input.checked = true; input.dispatchEvent(new Event('change',{bubbles:true})); }
        });
      });
    })();
  </script><script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script defer="">
    (function(){
      'use strict';

      const $ = (sel) => document.querySelector(sel);
      const $$ = (sel) => Array.from(document.querySelectorAll(sel));

      // Elements
      const currencyEl = $('#currencySymbol');
      const saleEl = $('#saleAmount');
      const discEl = $('#discount');
      const percentFields = $('#percentFields');
      const percentRateEl = $('#percentRate');

      const flatplusFields = $('#flatplusFields');
      const flatFeeEl = $('#flatFee');
      const flatPlusRateEl = $('#flatPlusRate');

      const tieredFields = $('#tieredFields');
      const t1El = $('#t1'), r1El = $('#r1'), t2El = $('#t2'), r2El = $('#r2'), r3El = $('#r3');

      const capEl = $('#cap');
      const splitToggleEl = $('#splitToggle');
      const splitFieldsEl = $('#splitFields');
      const agentShareEl = $('#agentShare');

      // Tooltips
      const tooltipPairs = [
        ['saleTTBtn','saleTT'],
        ['discTTBtn','discTT'],
        ['tierTTBtn','tierTT'],
        ['capTTBtn','capTT']
      ];
      tooltipPairs.forEach(([btnId, tipId])=>{
        const btn = document.getElementById(btnId);
        const tip = document.getElementById(tipId);
        if(!btn || !tip) return;
        btn.addEventListener('click', ()=>{
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          tip.setAttribute('aria-hidden', String(expanded));
        });
        btn.addEventListener('keydown', (e)=>{
          if(e.key === 'Escape'){
            btn.setAttribute('aria-expanded', 'false');
            tip.setAttribute('aria-hidden','true');
            btn.focus();
          }
        });
      });

      // Results
      const baseOut = $('#baseOut');
      const commissionRawOut = $('#commissionRawOut');
      const commissionFinalOut = $('#commissionFinalOut');
      const capAppliedOut = $('#capAppliedOut');
      const effectiveRateOut = $('#effectiveRateOut');
      const netAfterOut = $('#netAfterOut');
      const splitSummary = $('#splitSummary');
      const agentOut = $('#agentOut');
      const partnerOut = $('#partnerOut');

      function fmt(n){
        const sym = (currencyEl.value || '$').trim();
        const num = isFinite(n) ? Number(n) : 0;
        return sym + ' ' + num.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2});
      }
      function pct(n){
        const num = isFinite(n) ? Number(n) : 0;
        return num.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2}) + '%';
      }

      // Validation helpers
      function setError(input, id, msg){
        input.setAttribute('aria-invalid','true');
        const el = document.getElementById(id);
        if(el){ el.textContent = msg || ''; }
      }
      function clearError(input, id){
        input.setAttribute('aria-invalid','false');
        const el = document.getElementById(id);
        if(el){ el.textContent = ''; }
      }
      function getVal(input){
        const v = parseFloat(input.value);
        return isNaN(v) ? 0 : v;
      }

      // Model show/hide
      const modelRadios = $$('input[name="model"]');
      function switchModel(){
        const val = (modelRadios.find(r=>r.checked) || {}).value;
        // toggle sections
        [
          [percentFields, val === 'percent'],
          [flatplusFields, val === 'flatplus'],
          [tieredFields, val === 'tiered']
        ].forEach(([el, show])=>{
          el.hidden = !show;
          el.setAttribute('aria-hidden', String(!show));
          // disable inputs within hidden sections to avoid validation noise
          el.querySelectorAll('input,select,textarea').forEach(inp => inp.disabled = !show);
        });
        compute(); // recalc on switch
      }
      modelRadios.forEach(r => r.addEventListener('change', switchModel));

      // Split toggle
      splitToggleEl.addEventListener('change', ()=>{
        const on = splitToggleEl.checked;
        splitFieldsEl.hidden = !on;
        splitFieldsEl.setAttribute('aria-hidden', String(!on));
        agentShareEl.disabled = !on;
        compute();
      });

      // Inline validation on blur
      function validateField(input){
        const id = input.id;
        const v = getVal(input);
        if(id === 'saleAmount'){
          if(v <= 0){ return setError(input,'saleAmountError','Enter a sale amount greater than 0.'); }
          return clearError(input,'saleAmountError');
        }
        if(id === 'discount'){
          if(v < 0){ return setError(input,'discountError','Discount cannot be negative.'); }
          const s = getVal(saleEl);
          if(v > s){ return setError(input,'discountError','Discount cannot exceed the sale amount.'); }
          return clearError(input,'discountError');
        }
        if(id === 'percentRate'){
          if(v < 0 || v > 100){ return setError(input,'percentRateError','Enter a percentage between 0 and 100.'); }
          return clearError(input,'percentRateError');
        }
        if(id === 'flatFee'){
          if(v < 0){ return setError(input,'flatFeeError','Flat fee cannot be negative.'); }
          return clearError(input,'flatFeeError');
        }
        if(id === 'flatPlusRate'){
          if(v < 0 || v > 100){ return setError(input,'flatPlusRateError','Enter a percentage between 0 and 100.'); }
          return clearError(input,'flatPlusRateError');
        }
        if(id === 't1'){
          if(v < 0){ return setError(input,'t1Error','Threshold must be zero or greater.'); }
          const t2 = getVal(t2El);
          if(t2 > 0 && v > t2){ return setError(input,'t1Error','Threshold 1 must be less than or equal to Threshold 2.'); }
          return clearError(input,'t1Error');
        }
        if(id === 't2'){
          if(v < 0){ return setError(input,'t2Error','Threshold must be zero or greater.'); }
          const t1 = getVal(t1El);
          if(v > 0 && v < t1){ return setError(input,'t2Error','Threshold 2 must be greater than or equal to Threshold 1.'); }
          return clearError(input,'t2Error');
        }
        if(id === 'r1'){
          if(v < 0 || v > 100){ return setError(input,'r1Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r1Error');
        }
        if(id === 'r2'){
          if(v < 0 || v > 100){ return setError(input,'r2Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r2Error');
        }
        if(id === 'r3'){
          if(v < 0 || v > 100){ return setError(input,'r3Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r3Error');
        }
        if(id === 'cap'){
          if(v < 0){ return setError(input,'capError','Cap cannot be negative. Use 0 for no cap.'); }
          return clearError(input,'capError');
        }
        if(id === 'agentShare'){
          if(v < 0 || v > 100){ return setError(input,'agentShareError','Enter a split percentage between 0 and 100.'); }
          return clearError(input,'agentShareError');
        }
      }
      // Attach blur listeners
      $$('input').forEach(inp => {
        inp.addEventListener('blur', () => validateField(inp));
      });

      // Compute logic
      function compute(){
        // Basic inputs
        const sale = getVal(saleEl);
        const disc = getVal(discEl);
        // Validate base to safeguard compute
        if(sale <= 0 || disc < 0 || disc > sale){
          baseOut.textContent = fmt(0);
          commissionRawOut.textContent = fmt(0);
          capAppliedOut.textContent = fmt(0);
          commissionFinalOut.textContent = fmt(0);
          effectiveRateOut.textContent = pct(0);
          netAfterOut.textContent = fmt(0);
          splitSummary.style.display = 'none';
          return;
        }
        const base = Math.max(0, sale - disc);

        // Determine model
        const model = (modelRadios.find(r=>r.checked)||{}).value;

        let commission = 0;
        if(model === 'percent'){
          const rate = Math.max(0, Math.min(100, getVal(percentRateEl)));
          commission = base * rate / 100;
        } else if(model === 'flatplus'){
          const fee = Math.max(0, getVal(flatFeeEl));
          const rate = Math.max(0, Math.min(100, getVal(flatPlusRateEl)));
          commission = fee + base * rate / 100;
        } else if(model === 'tiered'){
          // thresholds in ascending order; treat 0 as not provided for T2
          let T1 = Math.max(0, getVal(t1El));
          let T2 = Math.max(0, getVal(t2El));
          if(T2 && T2 < T1){ [T1, T2] = [T2, T1]; } // ensure order
          const R1 = Math.max(0, Math.min(100, getVal(r1El)));
          const R2 = Math.max(0, Math.min(100, getVal(r2El)));
          const R3 = Math.max(0, Math.min(100, getVal(r3El)));

          const part1 = Math.min(base, T1);
          const part2 = Math.max(0, Math.min(base - T1, Math.max(0, T2 - T1)));
          const part3 = Math.max(0, base - Math.max(T1, T2));
          commission = (part1 * R1 + part2 * R2 + part3 * R3) / 100;
        }

        // Apply cap if any
        const cap = Math.max(0, getVal(capEl));
        const capped = cap > 0 ? Math.min(commission, cap) : commission;
        const capApplied = Math.max(0, commission - capped);

        // Split
        const splitOn = splitToggleEl.checked;
        let agentAmt = 0, partnerAmt = 0;
        if(splitOn){
          const a = Math.max(0, Math.min(100, getVal(agentShareEl)));
          agentAmt = capped * a / 100;
          partnerAmt = capped - agentAmt;
        }

        // Net after commission
        const netAfter = sale - disc - capped;
        const effRate = base > 0 ? (capped / base * 100) : 0;

        // Render
        baseOut.textContent = fmt(base);
        commissionRawOut.textContent = fmt(commission);
        capAppliedOut.textContent = fmt(capApplied);
        commissionFinalOut.textContent = fmt(capped);
        effectiveRateOut.textContent = pct(effRate);
        netAfterOut.textContent = fmt(netAfter);

        if(splitOn){
          splitSummary.style.display = '';
          agentOut.textContent = fmt(agentAmt);
          partnerOut.textContent = fmt(partnerAmt);
        }else{
          splitSummary.style.display = 'none';
        }
      }

      // Live compute on input (debounced micro)
      let rafId = null;
      function scheduleCompute(){
        if(rafId) cancelAnimationFrame(rafId);
        rafId = requestAnimationFrame(()=>{ compute(); rafId = null; });
      }
      $$('input,select').forEach(el => {
        el.addEventListener('input', scheduleCompute);
        el.addEventListener('change', scheduleCompute);
      });

      // Init
      switchModel();
      compute();

      // Accessibility: ensure radio tiles clickable on label
      $$('.radio-tile').forEach(tile=>{
        tile.addEventListener('click', (e)=>{
          const input = tile.querySelector('input[type="radio"]');
          if(input){ input.checked = true; input.dispatchEvent(new Event('change',{bubbles:true})); }
        });
      });
    })();
  </script><script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script defer="">
    (function(){
      'use strict';

      const $ = (sel) => document.querySelector(sel);
      const $$ = (sel) => Array.from(document.querySelectorAll(sel));

      // Elements
      const currencyEl = $('#currencySymbol');
      const saleEl = $('#saleAmount');
      const discEl = $('#discount');
      const percentFields = $('#percentFields');
      const percentRateEl = $('#percentRate');

      const flatplusFields = $('#flatplusFields');
      const flatFeeEl = $('#flatFee');
      const flatPlusRateEl = $('#flatPlusRate');

      const tieredFields = $('#tieredFields');
      const t1El = $('#t1'), r1El = $('#r1'), t2El = $('#t2'), r2El = $('#r2'), r3El = $('#r3');

      const capEl = $('#cap');
      const splitToggleEl = $('#splitToggle');
      const splitFieldsEl = $('#splitFields');
      const agentShareEl = $('#agentShare');

      // Tooltips
      const tooltipPairs = [
        ['saleTTBtn','saleTT'],
        ['discTTBtn','discTT'],
        ['tierTTBtn','tierTT'],
        ['capTTBtn','capTT']
      ];
      tooltipPairs.forEach(([btnId, tipId])=>{
        const btn = document.getElementById(btnId);
        const tip = document.getElementById(tipId);
        if(!btn || !tip) return;
        btn.addEventListener('click', ()=>{
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          tip.setAttribute('aria-hidden', String(expanded));
        });
        btn.addEventListener('keydown', (e)=>{
          if(e.key === 'Escape'){
            btn.setAttribute('aria-expanded', 'false');
            tip.setAttribute('aria-hidden','true');
            btn.focus();
          }
        });
      });

      // Results
      const baseOut = $('#baseOut');
      const commissionRawOut = $('#commissionRawOut');
      const commissionFinalOut = $('#commissionFinalOut');
      const capAppliedOut = $('#capAppliedOut');
      const effectiveRateOut = $('#effectiveRateOut');
      const netAfterOut = $('#netAfterOut');
      const splitSummary = $('#splitSummary');
      const agentOut = $('#agentOut');
      const partnerOut = $('#partnerOut');

      function fmt(n){
        const sym = (currencyEl.value || '$').trim();
        const num = isFinite(n) ? Number(n) : 0;
        return sym + ' ' + num.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2});
      }
      function pct(n){
        const num = isFinite(n) ? Number(n) : 0;
        return num.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2}) + '%';
      }

      // Validation helpers
      function setError(input, id, msg){
        input.setAttribute('aria-invalid','true');
        const el = document.getElementById(id);
        if(el){ el.textContent = msg || ''; }
      }
      function clearError(input, id){
        input.setAttribute('aria-invalid','false');
        const el = document.getElementById(id);
        if(el){ el.textContent = ''; }
      }
      function getVal(input){
        const v = parseFloat(input.value);
        return isNaN(v) ? 0 : v;
      }

      // Model show/hide
      const modelRadios = $$('input[name="model"]');
      function switchModel(){
        const val = (modelRadios.find(r=>r.checked) || {}).value;
        // toggle sections
        [
          [percentFields, val === 'percent'],
          [flatplusFields, val === 'flatplus'],
          [tieredFields, val === 'tiered']
        ].forEach(([el, show])=>{
          el.hidden = !show;
          el.setAttribute('aria-hidden', String(!show));
          // disable inputs within hidden sections to avoid validation noise
          el.querySelectorAll('input,select,textarea').forEach(inp => inp.disabled = !show);
        });
        compute(); // recalc on switch
      }
      modelRadios.forEach(r => r.addEventListener('change', switchModel));

      // Split toggle
      splitToggleEl.addEventListener('change', ()=>{
        const on = splitToggleEl.checked;
        splitFieldsEl.hidden = !on;
        splitFieldsEl.setAttribute('aria-hidden', String(!on));
        agentShareEl.disabled = !on;
        compute();
      });

      // Inline validation on blur
      function validateField(input){
        const id = input.id;
        const v = getVal(input);
        if(id === 'saleAmount'){
          if(v <= 0){ return setError(input,'saleAmountError','Enter a sale amount greater than 0.'); }
          return clearError(input,'saleAmountError');
        }
        if(id === 'discount'){
          if(v < 0){ return setError(input,'discountError','Discount cannot be negative.'); }
          const s = getVal(saleEl);
          if(v > s){ return setError(input,'discountError','Discount cannot exceed the sale amount.'); }
          return clearError(input,'discountError');
        }
        if(id === 'percentRate'){
          if(v < 0 || v > 100){ return setError(input,'percentRateError','Enter a percentage between 0 and 100.'); }
          return clearError(input,'percentRateError');
        }
        if(id === 'flatFee'){
          if(v < 0){ return setError(input,'flatFeeError','Flat fee cannot be negative.'); }
          return clearError(input,'flatFeeError');
        }
        if(id === 'flatPlusRate'){
          if(v < 0 || v > 100){ return setError(input,'flatPlusRateError','Enter a percentage between 0 and 100.'); }
          return clearError(input,'flatPlusRateError');
        }
        if(id === 't1'){
          if(v < 0){ return setError(input,'t1Error','Threshold must be zero or greater.'); }
          const t2 = getVal(t2El);
          if(t2 > 0 && v > t2){ return setError(input,'t1Error','Threshold 1 must be less than or equal to Threshold 2.'); }
          return clearError(input,'t1Error');
        }
        if(id === 't2'){
          if(v < 0){ return setError(input,'t2Error','Threshold must be zero or greater.'); }
          const t1 = getVal(t1El);
          if(v > 0 && v < t1){ return setError(input,'t2Error','Threshold 2 must be greater than or equal to Threshold 1.'); }
          return clearError(input,'t2Error');
        }
        if(id === 'r1'){
          if(v < 0 || v > 100){ return setError(input,'r1Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r1Error');
        }
        if(id === 'r2'){
          if(v < 0 || v > 100){ return setError(input,'r2Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r2Error');
        }
        if(id === 'r3'){
          if(v < 0 || v > 100){ return setError(input,'r3Error','Rate must be between 0 and 100.'); }
          return clearError(input,'r3Error');
        }
        if(id === 'cap'){
          if(v < 0){ return setError(input,'capError','Cap cannot be negative. Use 0 for no cap.'); }
          return clearError(input,'capError');
        }
        if(id === 'agentShare'){
          if(v < 0 || v > 100){ return setError(input,'agentShareError','Enter a split percentage between 0 and 100.'); }
          return clearError(input,'agentShareError');
        }
      }
      // Attach blur listeners
      $$('input').forEach(inp => {
        inp.addEventListener('blur', () => validateField(inp));
      });

      // Compute logic
      function compute(){
        // Basic inputs
        const sale = getVal(saleEl);
        const disc = getVal(discEl);
        // Validate base to safeguard compute
        if(sale <= 0 || disc < 0 || disc > sale){
          baseOut.textContent = fmt(0);
          commissionRawOut.textContent = fmt(0);
          capAppliedOut.textContent = fmt(0);
          commissionFinalOut.textContent = fmt(0);
          effectiveRateOut.textContent = pct(0);
          netAfterOut.textContent = fmt(0);
          splitSummary.style.display = 'none';
          return;
        }
        const base = Math.max(0, sale - disc);

        // Determine model
        const model = (modelRadios.find(r=>r.checked)||{}).value;

        let commission = 0;
        if(model === 'percent'){
          const rate = Math.max(0, Math.min(100, getVal(percentRateEl)));
          commission = base * rate / 100;
        } else if(model === 'flatplus'){
          const fee = Math.max(0, getVal(flatFeeEl));
          const rate = Math.max(0, Math.min(100, getVal(flatPlusRateEl)));
          commission = fee + base * rate / 100;
        } else if(model === 'tiered'){
          // thresholds in ascending order; treat 0 as not provided for T2
          let T1 = Math.max(0, getVal(t1El));
          let T2 = Math.max(0, getVal(t2El));
          if(T2 && T2 < T1){ [T1, T2] = [T2, T1]; } // ensure order
          const R1 = Math.max(0, Math.min(100, getVal(r1El)));
          const R2 = Math.max(0, Math.min(100, getVal(r2El)));
          const R3 = Math.max(0, Math.min(100, getVal(r3El)));

          const part1 = Math.min(base, T1);
          const part2 = Math.max(0, Math.min(base - T1, Math.max(0, T2 - T1)));
          const part3 = Math.max(0, base - Math.max(T1, T2));
          commission = (part1 * R1 + part2 * R2 + part3 * R3) / 100;
        }

        // Apply cap if any
        const cap = Math.max(0, getVal(capEl));
        const capped = cap > 0 ? Math.min(commission, cap) : commission;
        const capApplied = Math.max(0, commission - capped);

        // Split
        const splitOn = splitToggleEl.checked;
        let agentAmt = 0, partnerAmt = 0;
        if(splitOn){
          const a = Math.max(0, Math.min(100, getVal(agentShareEl)));
          agentAmt = capped * a / 100;
          partnerAmt = capped - agentAmt;
        }

        // Net after commission
        const netAfter = sale - disc - capped;
        const effRate = base > 0 ? (capped / base * 100) : 0;

        // Render
        baseOut.textContent = fmt(base);
        commissionRawOut.textContent = fmt(commission);
        capAppliedOut.textContent = fmt(capApplied);
        commissionFinalOut.textContent = fmt(capped);
        effectiveRateOut.textContent = pct(effRate);
        netAfterOut.textContent = fmt(netAfter);

        if(splitOn){
          splitSummary.style.display = '';
          agentOut.textContent = fmt(agentAmt);
          partnerOut.textContent = fmt(partnerAmt);
        }else{
          splitSummary.style.display = 'none';
        }
      }

      // Live compute on input (debounced micro)
      let rafId = null;
      function scheduleCompute(){
        if(rafId) cancelAnimationFrame(rafId);
        rafId = requestAnimationFrame(()=>{ compute(); rafId = null; });
      }
      $$('input,select').forEach(el => {
        el.addEventListener('input', scheduleCompute);
        el.addEventListener('change', scheduleCompute);
      });

      // Init
      switchModel();
      compute();

      // Accessibility: ensure radio tiles clickable on label
      $$('.radio-tile').forEach(tile=>{
        tile.addEventListener('click', (e)=>{
          const input = tile.querySelector('input[type="radio"]');
          if(input){ input.checked = true; input.dispatchEvent(new Event('change',{bubbles:true})); }
        });
      });
    })();
  </script></body></html>
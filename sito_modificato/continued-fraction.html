<!DOCTYPE html><html lang="en"><head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Continued Fraction Calculator – Expansion, Convergents &amp; Approximations</title>
    <meta name="description" content="Continued fraction calculator for real and rational numbers. Convert decimals and fractions to simple continued fractions, compute convergents, and get best rational approximations step-by-step.">
    <link rel="canonical" href="https://calcdomain.com/continued-fraction">

    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        .card-hover { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .formula-box { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; overflow-x: auto; margin: 1rem 0; }
        .badge { display: inline-flex; align-items: center; padding: 0.125rem 0.5rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 500; }
        .input-label { font-size: 0.875rem; font-weight: 500; color: #374151; }
        .mono-small { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 0.8rem; }
        .scroll-x { overflow-x: auto; }
        .pill { border-radius: 9999px; padding: 0.35rem 0.9rem; font-size: 0.8rem; }
        .pill-active { background-color: #2563eb; color: #ffffff; }
        .pill-inactive { background-color: #e5e7eb; color: #374151; }
    </style>

    <!-- HEAD SCRIPTS & META -->
    <!-- Google tag (gtag.js) -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7MB5V1LZRN');
    </script>

    <meta name="google-site-verification" content="_tiTZ9ivAdtXcAS9CMnTNJ549Sg39WVqP_ZFbWgglNA">

    <script>
        window.ezstandalone = window.ezstandalone || {};
        ezstandalone.cmd = ezstandalone.cmd || [];
    </script>

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebPage",
      "@id": "https://calcdomain.com/continued-fraction",
      "url": "https://calcdomain.com/continued-fraction",
      "name": "Continued Fraction Calculator – Expansion, Convergents & Approximations",
      "description": "Continued fraction calculator for real and rational numbers. Convert decimals and fractions to simple continued fractions, compute convergents, and get best rational approximations step-by-step.",
      "inLanguage": "en",
      "isPartOf": {
        "@id": "https://calcdomain.com/#website"
      },
      "dateModified": "2025-11-30"
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://calcdomain.com/continued-fraction#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://calcdomain.com"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Math & Conversions",
          "item": "https://calcdomain.com/categories/math-conversions"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Core Math Algebra",
          "item": "https://calcdomain.com/subcategories/core-math-algebra"
        }
      ]
    },
    {
      "@type": "FAQPage",
      "@id": "https://calcdomain.com/continued-fraction#faq",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is a continued fraction?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A continued fraction is an expression of a number as a0 plus a sequence of nested reciprocals of integers, typically written as a0 + 1/(a1 + 1/(a2 + ...)). Simple continued fractions have integer partial quotients and are closely tied to the Euclidean algorithm and best rational approximations."
          }
        },
        {
          "@type": "Question",
          "name": "What is a simple continued fraction?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A simple continued fraction is a continued fraction where all partial quotients after the first are positive integers. Every rational number has a finite simple continued fraction expansion, and many important irrationals such as √2 and φ have infinite but patterned expansions."
          }
        },
        {
          "@type": "Question",
          "name": "How do convergents approximate a real number?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The convergents of a continued fraction are the rational numbers obtained by truncating the continued fraction after a finite number of terms. They give increasingly accurate approximations to the original real number and satisfy strong best-approximation properties compared to other fractions with similar-sized denominators."
          }
        },
        {
          "@type": "Question",
          "name": "Can every real number be written as a continued fraction?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Every real number has at least one continued fraction expansion. Rational numbers correspond to finite simple continued fractions, while irrational numbers correspond to infinite continued fractions."
          }
        }
      ]
    },
    {
      "@type": "HowTo",
      "@id": "https://calcdomain.com/continued-fraction#howto",
      "name": "How to compute a simple continued fraction expansion",
      "description": "Step-by-step procedure to compute the simple continued fraction of a real or rational number.",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Start from your number",
          "text": "Take the real or rational number x you want to expand, such as 415/93 or 3.14159."
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Extract the integer part",
          "text": "Let a0 be the integer part of x, and keep the fractional part r0 = x − a0. If r0 is zero, you are done."
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Invert the fractional part",
          "text": "If r0 is not zero, set x1 = 1/r0 and repeat: take a1 as the integer part of x1, with r1 = x1 − a1. Continue this process with x2 = 1/r1, and so on."
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Stop or continue",
          "text": "For rational numbers the process eventually reaches an exact integer and terminates, giving a finite list [a0; a1, …, an]. For irrationals you can stop after a chosen depth to get a convergent approximation."
        }
      ]
    }
  ]
}
</script>


<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
.auditspine-badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  border:1px solid #e5e7eb;
  background:#f8fafc;
  color:#0f172a;
}
.auditspine-badge-warn{
  background:#fff7ed;
  border-color:#fed7aa;
  color:#9a3412;
}
</style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- BODY SCRIPTS INIZIO -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
              <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">

      <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo; <a href="https://calcdomain.com/categories/math-conversions" class="hover:text-blue-600">Math & Conversions</a> &raquo; <a href="https://calcdomain.com/subcategories/core-math-algebra" class="hover:text-blue-600">Core Math Algebra</a></nav>

      <div class="flex flex-col lg:flex-row gap-8">

        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <!-- MAIN CONTENT START -->

            <header class="mb-6 border-b border-gray-100 pb-4">
              <div class="flex items-center justify-between gap-3 flex-wrap">
                <div>
                  <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-1">
                    Continued Fraction Calculator
                  </h1>
                  <p class="text-gray-600">
                    Convert decimals and rational numbers to simple continued fractions, compute convergents, and see best rational approximations step-by-step.
                  </p>
                </div>
                <span class="badge bg-blue-50 text-blue-700 border border-blue-100">
                  Core Math &amp; Algebra
                </span>
              </div>
            </header>

            <section aria-labelledby="continued-fraction-calculator" class="mb-8">
              <h2 id="continued-fraction-calculator" class="text-xl font-semibold mb-3">
                Interactive continued fraction expansion and convergents
              </h2>
              <p class="text-gray-700 mb-3">
                Choose how you want to define your number and what you want to compute. The tool supports:
              </p>
              <ul class="list-disc list-inside text-sm text-gray-700 mb-4">
                <li>Decimal or rational input \((p/q)\) with controlled depth and tolerance.</li>
                <li>Simple continued fraction expansion \([a_0; a_1, \dots, a_n]\).</li>
                <li>Convergents table with \((p_k, q_k)\), decimal values, and errors.</li>
                <li>Reverse conversion from a continued fraction back to a number.</li>
              </ul>

              <!-- Mode selector -->
              <div class="flex flex-wrap gap-2 mb-4">
                <button type="button" id="mode-decimal-btn" class="pill pill-active text-xs font-semibold">
                  Decimal / rational → continued fraction
                </button>
                <button type="button" id="mode-cf-btn" class="pill pill-inactive text-xs font-semibold">
                  Continued fraction → number
                </button>
              </div>

              <!-- Shared precision options -->
              <div class="grid gap-4 md:grid-cols-3 mb-4">
                <div>
                  <label for="max-depth" class="block input-label mb-1">
                    Max terms (depth)
                  </label>
                  <input id="max-depth" type="number" min="1" max="30" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="12">
                  <p class="mt-1 text-xs text-gray-500">
                    Limit the length of the continued fraction expansion.
                  </p>
                </div>
                <div>
                  <label for="tol" class="block input-label mb-1">
                    Tolerance (for decimals)
                  </label>
                  <input id="tol" type="number" step="any" min="0" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="1e-12">
                  <p class="mt-1 text-xs text-gray-500">
                    Stop when the approximation error is below this tolerance.
                  </p>
                </div>
                <div>
                  <label for="cf-decimals" class="block input-label mb-1">
                    Decimal places for display
                  </label>
                  <select id="cf-decimals" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="6">6 decimals</option>
                    <option value="10" selected="">10 decimals</option>
                    <option value="15">15 decimals</option>
                  </select>
                </div>
              </div>

              <!-- Decimal / rational input panel -->
              <div id="panel-decimal" class="space-y-4">
                <fieldset class="border border-gray-200 rounded-md p-3">
                  <legend class="text-sm font-semibold text-gray-800 px-1">
                    Input number
                  </legend>
                  <div class="grid gap-4 md:grid-cols-2 mt-2">
                    <div>
                      <label for="decimal-input" class="block input-label mb-1">
                        Decimal (real) value
                      </label>
                      <input id="decimal-input" type="text" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g. 3.1415926535, 1.41421356, 0.3333">
                      <p class="mt-1 text-xs text-gray-500">
                        Optional. You can use either this field or the exact fraction below.
                      </p>
                    </div>
                    <div>
                      <label class="block input-label mb-1">
                        Exact fraction \(\frac{p}{q}\)
                      </label>
                      <div class="flex gap-2 items-center">
                        <input id="frac-p" type="number" step="1" class="w-1/2 rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="p (numerator)">
                        <span class="text-gray-500 text-sm">/</span>
                        <input id="frac-q" type="number" step="1" class="w-1/2 rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="q (denominator)">
                      </div>
                      <p class="mt-1 text-xs text-gray-500">
                        If provided, p/q overrides the decimal value.
                      </p>
                    </div>
                  </div>
                </fieldset>
              </div>

              <!-- Continued fraction input panel -->
              <div id="panel-cf" class="space-y-4 hidden">
                <fieldset class="border border-gray-200 rounded-md p-3">
                  <legend class="text-sm font-semibold text-gray-800 px-1">
                    Continued fraction coefficients
                  </legend>
                  <div>
                    <label for="cf-input" class="block input-label mb-1">
                      Simple continued fraction [a<sub>0</sub>; a<sub>1</sub>, a<sub>2</sub>, …]
                    </label>
                    <input id="cf-input" type="text" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Example: 3; 7, 15, 1, 292 (for π) or 1; 2, 2, 2, 2 (for √2)">
                    <p class="mt-1 text-xs text-gray-500">
                      Separate numbers with commas or semicolons. All coefficients should be integers.
                    </p>
                  </div>
                </fieldset>
              </div>

              <!-- Action buttons -->
              <div class="flex flex-wrap items-center gap-3 mt-4">
                <button id="cf-calc-btn" type="button" class="inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold bg-blue-600 text-white hover:bg-blue-700">
                  Compute continued fraction
                </button>
                <button id="cf-clear-btn" type="button" class="inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50">
                  Clear
                </button>
                <button id="cf-example1-btn" type="button" class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium border border-gray-300 text-gray-700 hover:bg-gray-50">
                  Example: π ≈ 3.14159265
                </button>
                <button id="cf-example2-btn" type="button" class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium border border-gray-300 text-gray-700 hover:bg-gray-50">
                  Example: √2 ≈ 1.41421356
                </button>
                <span id="cf-error" class="text-sm text-red-600 hidden"></span>
              </div>

              <!-- Results card -->
              <div id="cf-results-card" class="mt-4 border border-gray-200 rounded-md p-4 bg-gray-50 hidden text-sm space-y-3">
                <h3 class="font-semibold text-gray-900 text-base mb-1">Results</h3>

                <div>
                  <h4 class="font-semibold text-gray-800 mb-1">Continued fraction</h4>
                  <p id="cf-main" class="mono-small text-gray-800"></p>
                  <p id="cf-main-compact" class="mono-small text-gray-700 mt-1"></p>
                </div>

                <div class="grid md:grid-cols-2 gap-3">
                  <div>
                    <h4 class="font-semibold text-gray-800 mb-1">Best current convergent</h4>
                    <p id="cf-best" class="text-gray-700"></p>
                  </div>
                  <div>
                    <h4 class="font-semibold text-gray-800 mb-1">Error &amp; diagnostics</h4>
                    <p id="cf-diagnostics" class="text-gray-700"></p>
                  </div>
                </div>

                <div id="cf-conv-section">
                  <h4 class="font-semibold text-gray-800 mb-1">Convergents table</h4>
                  <div id="cf-convergents" class="mono-small bg-white border border-gray-200 rounded-md px-3 py-2 scroll-x whitespace-pre"></div>
                  <p class="mt-1 text-xs text-gray-500">
                    Each row shows the k-th convergent p<sub>k</sub>/q<sub>k</sub>, its decimal value, and the absolute error relative to the input value.
                  </p>
                </div>
              </div>
            </section>

            <section class="prose">
              <h2>What is a continued fraction?</h2>
              <p>
                A continued fraction represents a number as a nested sequence of integer parts and reciprocals. A
                <strong>simple continued fraction</strong> has the form
              </p>
              <div class="formula-box">
                <p class="font-mono text-center">
                  \(x = a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \dots}}}\)
                </p>
              </div>
              <p>
                and is usually written in compact notation as
                \([a_0; a_1, a_2, a_3, \dots]\).
                For simple continued fractions, \(a_0\) is an integer (possibly negative) and all other \(a_i\) are positive integers.
              </p>
              <p>
                Every rational number has a <strong>finite</strong> simple continued fraction expansion, and every irrational number
                has an <strong>infinite</strong> one. Many classical constants have beautiful continued fractions; for example
                \(\sqrt{2} = [1; \overline{2}]\) and
                \(\varphi = [1; \overline{1}]\) (the golden ratio).
              </p>

              <h2>Convergents: best rational approximations</h2>
              <p>
                Truncating a continued fraction after \(n\) terms gives a rational number called the
                <strong>n-th convergent</strong>. If
              </p>
              <div class="formula-box">
                <p class="font-mono text-center">
                  \(x = [a_0; a_1, a_2, \dots]\),
                </p>
              </div>
              <p>
                then the convergents \(p_n / q_n\) are defined recursively by
              </p>
              <div class="formula-box">
                <p class="font-mono">
                  \(p_{-2} = 0, \; p_{-1} = 1,\quad p_n = a_n p_{n-1} + p_{n-2},\)<br>
                  \(q_{-2} = 1, \; q_{-1} = 0,\quad q_n = a_n q_{n-1} + q_{n-2}.\)
                </p>
              </div>
              <p>
                The convergents satisfy remarkable <strong>best approximation</strong> properties: for each denominator size,
                no other fraction gives a significantly closer approximation to the original number.
              </p>

              <h2>From decimal or fraction to continued fraction</h2>
              <p>
                The expansion of a real number \(x\) into a simple continued fraction is based on repeatedly removing the integer part
                and inverting the remainder:
              </p>
              <ol>
                <li>Set \(x_0 = x\) and \(a_0 = \lfloor x_0 \rfloor\).</li>
                <li>Compute the remainder \(r_0 = x_0 - a_0\).</li>
                <li>If \(r_0 = 0\), stop. Otherwise, set \(x_1 = 1 / r_0\) and \(a_1 = \lfloor x_1 \rfloor\).</li>
                <li>Repeat with \(x_2 = 1 / (x_1 - a_1)\), and so on.</li>
              </ol>
              <p>
                For rational numbers, this process terminates after finitely many steps and is equivalent to the Euclidean algorithm
                for the fraction’s numerator and denominator.
              </p>

              <h2>From continued fraction back to a number</h2>
              <p>
                Given a finite list of integers \([a_0; a_1, \dots, a_n]\), you can evaluate it by starting at the end and working
                backwards:
              </p>
              <div class="formula-box">
                <p class="font-mono">
                  Let \(x_n = a_n\), and for \(k = n-1, \dots, 0\) define \(x_k = a_k + 1/x_{k+1}\).<br>
                  Then the value is \(x_0\).
                </p>
              </div>
              <p>
                This is what the calculator does in “continued fraction → number” mode, also recovering the convergents via the
                standard recurrence relations.
              </p>

              <h2>Why continued fractions matter</h2>
              <ul>
                <li><strong>Number theory:</strong> Diophantine approximation, Pell equations, and structure of quadratic irrationals.</li>
                <li><strong>Numerical analysis:</strong> Stable evaluation of certain functions and special functions.</li>
                <li><strong>Approximation:</strong> High-quality rational approximations for constants such as π and e.</li>
                <li><strong>Algorithmic insight:</strong> A different viewpoint on the Euclidean algorithm and gcd computations.</li>
              </ul>

              <h2 id="continued-fraction-faq">Continued fractions – FAQ</h2>

              <h3>Do continued fractions give the “best” approximations?</h3>
              <p>
                In a precise sense, yes: convergents of the simple continued fraction of a real number provide excellent rational
                approximations and satisfy strong optimality properties among fractions with bounded denominators.
              </p>

              <h3>Can different continued fractions represent the same rational?</h3>
              <p>
                A rational number has a unique simple continued fraction expansion if you require the last term to be greater than 1.
                Without that convention, there are two closely related finite expansions (one ends with …, a<sub>n</sub>, 1, the other with
                …, a<sub>n</sub> + 1).
              </p>

              <h3>How many terms do I need?</h3>
              <p>
                It depends on your required accuracy. The calculator lets you set a maximum depth and a tolerance on the decimal error.
                In practice, only a handful of terms already give excellent approximations for many constants and measurements.
              </p>

              <h3>Can the partial quotients be negative?</h3>
              <p>
                In simple continued fractions, all coefficients except possibly a<sub>0</sub> are positive. More general continued
                fractions allow other choices, but the simple case already covers the core applications in number theory and rational approximation.
              </p>

              <h3>Is this calculator suitable for proofs and formal work?</h3>
              <p>
                It is primarily an exploratory and educational tool. It can strongly support intuition, checking conjectures, and drafting
                examples, but a formal proof would still require a rigorous argument beyond numerical output.
              </p>
            </section>

            <!-- FAQ block for JS toggler -->
            <section class="mt-8" id="faq">
              <h2 class="text-xl font-semibold mb-4">Frequently Asked Questions</h2>
              <div class="space-y-3">
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">How accurate is this continued fraction calculator?</summary>
                  <p class="mt-2 text-sm text-gray-700">
                    For rational inputs p/q, the continued fraction is exact and terminates. For decimal inputs, accuracy is limited by
                    floating-point arithmetic, the depth you allow, and the tolerance you choose. The tool reports the final approximation
                    error so you can judge if it is adequate for your use case.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">What kind of inputs should I avoid?</summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Avoid extremely large integers, wildly ill-conditioned decimals, or strings that are not valid numbers. The calculator
                    also limits the number of terms to prevent runaway expansions when the pattern is long or when the tolerance is very strict.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">Can I use this to recognise known constants?</summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Sometimes. If your decimal input is close to a famous constant (like π, e, or √2) and you see a familiar continued
                    fraction pattern, that can be a strong hint. However, recognition should be supported by analytic arguments, not just
                    numerical pattern matching.
                  </p>
                </details>
              </div>
            </section>

            <!-- MAIN CONTENT END -->
          </div>
        
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\\]</div>
  <pre class="auditspine-mono">','\</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[/g, '').replace(/\]</div>
  <pre class="auditspine-mono">/g, '').replace(/</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\(x = a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \dots}}}\)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\(x = [a_0; a_1, a_2, \dots]\),</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\(p_{-2} = 0, \; p_{-1} = 1,\quad p_n = a_n p_{n-1} + p_{n-2},\) \(q_{-2} = 1, \; q_{-1} = 0,\quad q_n = a_n q_{n-1} + q_{n-2}.\)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Let \(x_n = a_n\), and for \(k = n-1, \dots, 0\) define \(x_k = a_k + 1/x_{k+1}\). Then the value is \(x_0\).</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><span class="auditspine-mono">PMI</span> = private mortgage insurance (monthly) <em>(currency)</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>NIST — Weights and measures</strong> — nist.gov · Accessed 2026-01-19<br><a href="https://www.nist.gov/pml/weights-and-measures" target="_blank" rel="nofollow noopener">https://www.nist.gov/pml/weights-and-measures</a></li>
<li><strong>FTC — Consumer advice</strong> — consumer.ftc.gov · Accessed 2026-01-19<br><a href="https://consumer.ftc.gov/" target="_blank" rel="nofollow noopener">https://consumer.ftc.gov/</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main>

        <aside class="w-full lg:w-1/3">

          <div class="bg-white rounded-lg shadow-md p-5 mb-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-3">Related Core Math &amp; Algebra tools</h2>
            <p class="text-sm text-gray-600 mb-3">
              Explore more number-theoretic and algebraic tools that pair naturally with continued fractions.
            </p>
            <ul class="space-y-2 text-sm">
              <li><a href="/gcd-lcm" class="text-blue-600 hover:underline">GCD &amp; LCM calculator</a></li>
              <li><a href="/rational-approximation" class="text-blue-600 hover:underline">Rational approximation tool</a></li>
              <li><a href="/modular-arithmetic" class="text-blue-600 hover:underline">Modular arithmetic</a></li>
              <li><a href="/diophantine-equation" class="text-blue-600 hover:underline">Diophantine equation solver</a></li>
              <li><a href="/set-theory" class="text-blue-600 hover:underline">Set theory</a></li>
              <li><a href="/interval-notation" class="text-blue-600 hover:underline">Interval notation</a></li>
              <li><a href="/convolution" class="text-blue-600 hover:underline">Convolution</a></li>
              <li><a href="/complex-number" class="text-blue-600 hover:underline">Complex number calculator</a></li>
              <li><a href="/matrix-calculator" class="text-blue-600 hover:underline">Matrix operations</a></li>
              <li><a href="/continued-fraction" class="text-gray-900 font-semibold">Continued fraction (current)</a></li>
            </ul>
          </div>

          <div class="bg-white rounded-lg shadow-md p-5">
            <h2 class="text-lg font-semibold text-gray-900 mb-3">Checklist for robust continued fraction work</h2>
            <ol class="list-decimal list-inside text-sm text-gray-700 space-y-2">
              <li>Clarify whether your input is exactly rational or an approximate decimal.</li>
              <li>Choose a reasonable max depth and tolerance based on required accuracy.</li>
              <li>Inspect convergents and error; do not rely on a single decimal value.</li>
              <li>For proofs, use the structure of the coefficients, not just numerical output.</li>
              <li>Document which convergent you use in downstream calculations or publications.</li>
            </ol>
          </div>

        </aside>

      </div>
    </div>

    <footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                                <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>




























    <script src="/assets/js/script_menu.js" defer=""></script>
    <script src="/assets/js/script_faq.js" defer=""></script>
    <script src="search.js" defer=""></script>

    <script>
      window.MathJax = { tex: { inlineMath: [['\\(','\\)'], [',
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <script>
      // Mobile menu toggle (fallback if script_menu.js doesn't handle it)
      document.addEventListener('DOMContentLoaded', function () {
        const toggle = document.getElementById('mobile-menu-toggle');
        const menu = document.getElementById('mobile-menu');
        if (toggle && menu) {
          toggle.addEventListener('click', () => {
            const isHidden = menu.classList.contains('hidden');
            menu.classList.toggle('hidden', !isHidden);
            toggle.setAttribute('aria-expanded', String(isHidden));
          });
        }
      });

      // Continued fraction calculator logic
      document.addEventListener('DOMContentLoaded', function () {
        const modeDecimalBtn = document.getElementById('mode-decimal-btn');
        const modeCfBtn = document.getElementById('mode-cf-btn');
        const panelDecimal = document.getElementById('panel-decimal');
        const panelCf = document.getElementById('panel-cf');

        const maxDepthInput = document.getElementById('max-depth');
        const tolInput = document.getElementById('tol');
        const decimalsSelect = document.getElementById('cf-decimals');

        const decimalInput = document.getElementById('decimal-input');
        const fracPInput = document.getElementById('frac-p');
        const fracQInput = document.getElementById('frac-q');
        const cfInput = document.getElementById('cf-input');

        const calcBtn = document.getElementById('cf-calc-btn');
        const clearBtn = document.getElementById('cf-clear-btn');
        const ex1Btn = document.getElementById('cf-example1-btn');
        const ex2Btn = document.getElementById('cf-example2-btn');
        const errorEl = document.getElementById('cf-error');

        const resultsCard = document.getElementById('cf-results-card');
        const mainEl = document.getElementById('cf-main');
        const mainCompactEl = document.getElementById('cf-main-compact');
        const bestEl = document.getElementById('cf-best');
        const diagEl = document.getElementById('cf-diagnostics');
        const convSection = document.getElementById('cf-conv-section');
        const convEl = document.getElementById('cf-convergents');

        let currentMode = 'decimal'; // 'decimal' or 'cf'

        function setMode(mode) {
          currentMode = mode;
          const isDecimal = mode === 'decimal';

          modeDecimalBtn.classList.toggle('pill-active', isDecimal);
          modeDecimalBtn.classList.toggle('pill-inactive', !isDecimal);
          modeCfBtn.classList.toggle('pill-active', !isDecimal);
          modeCfBtn.classList.toggle('pill-inactive', isDecimal);

          panelDecimal.classList.toggle('hidden', !isDecimal);
          panelCf.classList.toggle('hidden', isDecimal);
          resetResults();
        }

        modeDecimalBtn.addEventListener('click', () => setMode('decimal'));
        modeCfBtn.addEventListener('click', () => setMode('cf'));

        function resetResults() {
          errorEl.textContent = '';
          errorEl.classList.add('hidden');
          resultsCard.classList.add('hidden');
          mainEl.textContent = '';
          mainCompactEl.textContent = '';
          bestEl.textContent = '';
          diagEl.textContent = '';
          convEl.textContent = '';
        }

        function parseIntStrict(val, name) {
          if (val === '' || val === null || val === undefined) {
            throw new Error('Please provide a value for ' + name + '.');
          }
          const num = Number(val);
          if (!Number.isInteger(num)) {
            throw new Error(name + ' must be an integer.');
          }
          return num;
        }

        function fractionFromInputs() {
          const pVal = fracPInput.value.trim();
          const qVal = fracQInput.value.trim();
          if (pVal === '' || qVal === '') return null;
          const p = parseIntStrict(pVal, 'Numerator p');
          const q = parseIntStrict(qVal, 'Denominator q');
          if (q === 0) throw new Error('Denominator q cannot be zero.');
          return { p, q };
        }

        function decimalFromInput() {
          const txt = decimalInput.value.trim();
          if (!txt) return null;
          const x = Number(txt);
          if (!Number.isFinite(x)) {
            throw new Error('Decimal input must be a valid finite real number.');
          }
          return x;
        }

        function parseCfCoefficients(str) {
          if (!str || !str.trim()) {
            throw new Error('Please enter at least one coefficient for the continued fraction.');
          }
          const cleaned = str.replace(/\[/g, '').replace(/\]/g, '');
          const parts = cleaned.split(/[;,]/).map(function (s) { return s.trim(); }).filter(Boolean);
          if (!parts.length) {
            throw new Error('Could not parse any coefficients. Separate them with commas or semicolons.');
          }
          const coeffs = parts.map(function (p, idx) {
            const n = Number(p);
            if (!Number.isInteger(n)) {
              throw new Error('Coefficient at position ' + idx + ' is not an integer.');
            }
            return n;
          });
          if (coeffs.length > 30) {
            throw new Error('Please limit continued fractions to at most 30 coefficients.');
          }
          return coeffs;
        }

        // Compute simple continued fraction expansion for a real number x
        function continuedFractionFromReal(x, maxDepth, tol) {
          const coeffs = [];
          let value = x;

          for (let k = 0; k < maxDepth; k++) {
            const a = Math.floor(value);
            coeffs.push(a);
            const frac = value - a;
            if (Math.abs(frac) < tol) {
              break;
            }
            if (!Number.isFinite(1 / frac)) {
              break;
            }
            value = 1 / frac;
          }
          return coeffs;
        }

        // Compute convergents p_k, q_k and values for given cf coefficients
        function convergentsFromCf(coeffs) {
          const n = coeffs.length;
          const p = [];
          const q = [];

          // initial conditions
          let pMinus2 = 0, pMinus1 = 1;
          let qMinus2 = 1, qMinus1 = 0;

          for (let k = 0; k < n; k++) {
            const a = coeffs[k];
            const pk = a * pMinus1 + pMinus2;
            const qk = a * qMinus1 + qMinus2;
            p.push(pk);
            q.push(qk);
            pMinus2 = pMinus1;
            pMinus1 = pk;
            qMinus2 = qMinus1;
            qMinus1 = qk;
          }

          return { p, q };
        }

        function valueFromCf(coeffs) {
          // Evaluate CF from end to start
          let x = coeffs[coeffs.length - 1];
          for (let i = coeffs.length - 2; i >= 0; i--) {
            x = coeffs[i] + 1 / x;
          }
          return x;
        }

        function gcd(a, b) {
          a = Math.abs(a);
          b = Math.abs(b);
          while (b !== 0) {
            const t = b;
            b = a % b;
            a = t;
          }
          return a;
        }

        function simplifyFraction(num, den) {
          if (!Number.isFinite(num) || !Number.isFinite(den) || den === 0) {
            return { num: num, den: den };
          }
          let n = Math.round(num);
          let d = Math.round(den);
          const g = gcd(n, d);
          n /= g;
          d /= g;
          if (d < 0) {
            n = -n;
            d = -d;
          }
          return { num: n, den: d };
        }

        function formatCoefficients(coeffs) {
          if (!coeffs.length) return '[]';
          const first = coeffs[0];
          const rest = coeffs.slice(1);
          return '[' + first + (rest.length ? '; ' + rest.join(', ') : '') + ']';
        }

        function formatConvergents(coeffs, xRef, decimals) {
          const { p, q } = convergentsFromCf(coeffs);
          const lines = [];
          lines.push(' k   a_k     p_k / q_k             value(p_k/q_k)           |x − p_k/q_k|');
          lines.push('----------------------------------------------------------------------------');
          for (let k = 0; k < coeffs.length; k++) {
            const ak = coeffs[k];
            const pk = p[k];
            const qk = q[k];
            const val = pk / qk;
            const err = (xRef != null && Number.isFinite(xRef)) ? Math.abs(xRef - val) : NaN;

            const kStr = k.toString().padStart(2, ' ');
            const aStr = ak.toString().padStart(4, ' ');
            const fracStr = (pk + '/' + qk).padEnd(18, ' ');
            const valStr = (Number.isFinite(val) ? val.toFixed(decimals) : 'nan').padEnd(22, ' ');
            const errStr = (Number.isFinite(err) ? err.toExponential(3) : '-');
            lines.push(' ' + kStr + '   ' + aStr + '   ' + fracStr + '   ' + valStr + '   ' + errStr);
          }
          return lines.join('\n');
        }

        function calculate() {
          resetResults();

          try {
            const maxDepth = parseInt(maxDepthInput.value, 10);
            if (!Number.isInteger(maxDepth) || maxDepth < 1 || maxDepth > 30) {
              throw new Error('Max depth must be an integer between 1 and 30.');
            }
            const tol = Number(tolInput.value);
            if (!(tol >= 0)) {
              throw new Error('Tolerance must be a non-negative number.');
            }
            const decimals = parseInt(decimalsSelect.value, 10) || 10;

            let coeffs, xRef = null;

            if (currentMode === 'decimal') {
              // Prefer exact fraction if provided
              const frac = fractionFromInputs();
              if (frac) {
                const { p, q } = frac;
                xRef = p / q;
                coeffs = continuedFractionFromReal(xRef, maxDepth, tol);
              } else {
                const x = decimalFromInput();
                if (x === null) {
                  throw new Error('Please enter either a decimal value or an exact fraction p/q.');
                }
                xRef = x;
                coeffs = continuedFractionFromReal(x, maxDepth, tol);
              }
            } else {
              // From CF coefficients to number
              coeffs = parseCfCoefficients(cfInput.value);
              xRef = valueFromCf(coeffs);
            }

            if (!coeffs.length) {
              throw new Error('No continued fraction coefficients were produced.');
            }

            const cfStr = formatCoefficients(coeffs);
            mainEl.textContent = 'Simple continued fraction: ' + cfStr;

            const compact = coeffs.join(', ');
            mainCompactEl.textContent = 'Coefficients: [' + compact + ']';

            // Convergents and best approximation
            const { p, q } = convergentsFromCf(coeffs);
            const kLast = coeffs.length - 1;
            const numLast = p[kLast];
            const denLast = q[kLast];
            const fracSimplified = simplifyFraction(numLast, denLast);

            const valLast = numLast / denLast;
            const errLast = (xRef != null && Number.isFinite(xRef)) ? Math.abs(xRef - valLast) : NaN;

            bestEl.textContent =
              'Last convergent (k = ' + kLast + '): ' +
              numLast + '/' + denLast +
              ' ≈ ' + valLast.toFixed(decimals) +
              (Number.isFinite(errLast) ? ' (|error| ≈ ' + errLast.toExponential(3) + ')' : '') +
              '. Simplified: ' + fracSimplified.num + '/' + fracSimplified.den + '.';

            let diag = 'Number of terms: ' + coeffs.length + '. ';
            if (currentMode === 'decimal') {
              diag += 'Input value x ≈ ' + xRef.toPrecision(15) + '. ';
              if (tol > 0) {
                diag += 'Expansion stopped when the fractional part was below tolerance ' + tol + ' or depth reached ' + maxDepth + '.';
              } else {
                diag += 'Expansion stopped at the maximum depth ' + maxDepth + '.';
              }
            } else {
              diag += 'Value reconstructed from coefficients: x ≈ ' + xRef.toPrecision(15) + '.';
            }
            diagEl.textContent = diag;

            // Convergents table
            const table = formatConvergents(coeffs, xRef, decimals);
            convEl.textContent = table;

            resultsCard.classList.remove('hidden');
          } catch (e) {
            errorEl.textContent = e.message || 'An error occurred while computing the continued fraction.';
            errorEl.classList.remove('hidden');
          }
        }

        function clearAll() {
          maxDepthInput.value = '12';
          tolInput.value = '1e-12';
          decimalsSelect.value = '10';
          decimalInput.value = '';
          fracPInput.value = '';
          fracQInput.value = '';
          cfInput.value = '';
          setMode('decimal');
          resetResults();
        }

        function loadExample1() {
          // π ~ 3.14159265
          setMode('decimal');
          decimalInput.value = '3.14159265';
          fracPInput.value = '';
          fracQInput.value = '';
          maxDepthInput.value = '10';
          tolInput.value = '1e-10';
          decimalsSelect.value = '10';
          calculate();
        }

        function loadExample2() {
          // sqrt(2) ~ 1.41421356
          setMode('decimal');
          decimalInput.value = '1.41421356';
          fracPInput.value = '';
          fracQInput.value = '';
          maxDepthInput.value = '10';
          tolInput.value = '1e-10';
          decimalsSelect.value = '10';
          calculate();
        }

        calcBtn.addEventListener('click', calculate);
        clearBtn.addEventListener('click', clearAll);
        ex1Btn.addEventListener('click', loadExample1);
        ex2Btn.addEventListener('click', loadExample2);

        // Ctrl+Enter on any main input triggers calculation
        [decimalInput, fracPInput, fracQInput, cfInput].forEach(function (el) {
          el.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
              e.preventDefault();
              calculate();
            }
          });
        });
      });
    </script>




</body></html>, ',
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <script>
      // Mobile menu toggle (fallback if script_menu.js doesn't handle it)
      document.addEventListener('DOMContentLoaded', function () {
        const toggle = document.getElementById('mobile-menu-toggle');
        const menu = document.getElementById('mobile-menu');
        if (toggle && menu) {
          toggle.addEventListener('click', () => {
            const isHidden = menu.classList.contains('hidden');
            menu.classList.toggle('hidden', !isHidden);
            toggle.setAttribute('aria-expanded', String(isHidden));
          });
        }
      });

      // Continued fraction calculator logic
      document.addEventListener('DOMContentLoaded', function () {
        const modeDecimalBtn = document.getElementById('mode-decimal-btn');
        const modeCfBtn = document.getElementById('mode-cf-btn');
        const panelDecimal = document.getElementById('panel-decimal');
        const panelCf = document.getElementById('panel-cf');

        const maxDepthInput = document.getElementById('max-depth');
        const tolInput = document.getElementById('tol');
        const decimalsSelect = document.getElementById('cf-decimals');

        const decimalInput = document.getElementById('decimal-input');
        const fracPInput = document.getElementById('frac-p');
        const fracQInput = document.getElementById('frac-q');
        const cfInput = document.getElementById('cf-input');

        const calcBtn = document.getElementById('cf-calc-btn');
        const clearBtn = document.getElementById('cf-clear-btn');
        const ex1Btn = document.getElementById('cf-example1-btn');
        const ex2Btn = document.getElementById('cf-example2-btn');
        const errorEl = document.getElementById('cf-error');

        const resultsCard = document.getElementById('cf-results-card');
        const mainEl = document.getElementById('cf-main');
        const mainCompactEl = document.getElementById('cf-main-compact');
        const bestEl = document.getElementById('cf-best');
        const diagEl = document.getElementById('cf-diagnostics');
        const convSection = document.getElementById('cf-conv-section');
        const convEl = document.getElementById('cf-convergents');

        let currentMode = 'decimal'; // 'decimal' or 'cf'

        function setMode(mode) {
          currentMode = mode;
          const isDecimal = mode === 'decimal';

          modeDecimalBtn.classList.toggle('pill-active', isDecimal);
          modeDecimalBtn.classList.toggle('pill-inactive', !isDecimal);
          modeCfBtn.classList.toggle('pill-active', !isDecimal);
          modeCfBtn.classList.toggle('pill-inactive', isDecimal);

          panelDecimal.classList.toggle('hidden', !isDecimal);
          panelCf.classList.toggle('hidden', isDecimal);
          resetResults();
        }

        modeDecimalBtn.addEventListener('click', () => setMode('decimal'));
        modeCfBtn.addEventListener('click', () => setMode('cf'));

        function resetResults() {
          errorEl.textContent = '';
          errorEl.classList.add('hidden');
          resultsCard.classList.add('hidden');
          mainEl.textContent = '';
          mainCompactEl.textContent = '';
          bestEl.textContent = '';
          diagEl.textContent = '';
          convEl.textContent = '';
        }

        function parseIntStrict(val, name) {
          if (val === '' || val === null || val === undefined) {
            throw new Error('Please provide a value for ' + name + '.');
          }
          const num = Number(val);
          if (!Number.isInteger(num)) {
            throw new Error(name + ' must be an integer.');
          }
          return num;
        }

        function fractionFromInputs() {
          const pVal = fracPInput.value.trim();
          const qVal = fracQInput.value.trim();
          if (pVal === '' || qVal === '') return null;
          const p = parseIntStrict(pVal, 'Numerator p');
          const q = parseIntStrict(qVal, 'Denominator q');
          if (q === 0) throw new Error('Denominator q cannot be zero.');
          return { p, q };
        }

        function decimalFromInput() {
          const txt = decimalInput.value.trim();
          if (!txt) return null;
          const x = Number(txt);
          if (!Number.isFinite(x)) {
            throw new Error('Decimal input must be a valid finite real number.');
          }
          return x;
        }

        function parseCfCoefficients(str) {
          if (!str || !str.trim()) {
            throw new Error('Please enter at least one coefficient for the continued fraction.');
          }
          const cleaned = str.replace(/\[/g, '').replace(/\]/g, '');
          const parts = cleaned.split(/[;,]/).map(function (s) { return s.trim(); }).filter(Boolean);
          if (!parts.length) {
            throw new Error('Could not parse any coefficients. Separate them with commas or semicolons.');
          }
          const coeffs = parts.map(function (p, idx) {
            const n = Number(p);
            if (!Number.isInteger(n)) {
              throw new Error('Coefficient at position ' + idx + ' is not an integer.');
            }
            return n;
          });
          if (coeffs.length > 30) {
            throw new Error('Please limit continued fractions to at most 30 coefficients.');
          }
          return coeffs;
        }

        // Compute simple continued fraction expansion for a real number x
        function continuedFractionFromReal(x, maxDepth, tol) {
          const coeffs = [];
          let value = x;

          for (let k = 0; k < maxDepth; k++) {
            const a = Math.floor(value);
            coeffs.push(a);
            const frac = value - a;
            if (Math.abs(frac) < tol) {
              break;
            }
            if (!Number.isFinite(1 / frac)) {
              break;
            }
            value = 1 / frac;
          }
          return coeffs;
        }

        // Compute convergents p_k, q_k and values for given cf coefficients
        function convergentsFromCf(coeffs) {
          const n = coeffs.length;
          const p = [];
          const q = [];

          // initial conditions
          let pMinus2 = 0, pMinus1 = 1;
          let qMinus2 = 1, qMinus1 = 0;

          for (let k = 0; k < n; k++) {
            const a = coeffs[k];
            const pk = a * pMinus1 + pMinus2;
            const qk = a * qMinus1 + qMinus2;
            p.push(pk);
            q.push(qk);
            pMinus2 = pMinus1;
            pMinus1 = pk;
            qMinus2 = qMinus1;
            qMinus1 = qk;
          }

          return { p, q };
        }

        function valueFromCf(coeffs) {
          // Evaluate CF from end to start
          let x = coeffs[coeffs.length - 1];
          for (let i = coeffs.length - 2; i >= 0; i--) {
            x = coeffs[i] + 1 / x;
          }
          return x;
        }

        function gcd(a, b) {
          a = Math.abs(a);
          b = Math.abs(b);
          while (b !== 0) {
            const t = b;
            b = a % b;
            a = t;
          }
          return a;
        }

        function simplifyFraction(num, den) {
          if (!Number.isFinite(num) || !Number.isFinite(den) || den === 0) {
            return { num: num, den: den };
          }
          let n = Math.round(num);
          let d = Math.round(den);
          const g = gcd(n, d);
          n /= g;
          d /= g;
          if (d < 0) {
            n = -n;
            d = -d;
          }
          return { num: n, den: d };
        }

        function formatCoefficients(coeffs) {
          if (!coeffs.length) return '[]';
          const first = coeffs[0];
          const rest = coeffs.slice(1);
          return '[' + first + (rest.length ? '; ' + rest.join(', ') : '') + ']';
        }

        function formatConvergents(coeffs, xRef, decimals) {
          const { p, q } = convergentsFromCf(coeffs);
          const lines = [];
          lines.push(' k   a_k     p_k / q_k             value(p_k/q_k)           |x − p_k/q_k|');
          lines.push('----------------------------------------------------------------------------');
          for (let k = 0; k < coeffs.length; k++) {
            const ak = coeffs[k];
            const pk = p[k];
            const qk = q[k];
            const val = pk / qk;
            const err = (xRef != null && Number.isFinite(xRef)) ? Math.abs(xRef - val) : NaN;

            const kStr = k.toString().padStart(2, ' ');
            const aStr = ak.toString().padStart(4, ' ');
            const fracStr = (pk + '/' + qk).padEnd(18, ' ');
            const valStr = (Number.isFinite(val) ? val.toFixed(decimals) : 'nan').padEnd(22, ' ');
            const errStr = (Number.isFinite(err) ? err.toExponential(3) : '-');
            lines.push(' ' + kStr + '   ' + aStr + '   ' + fracStr + '   ' + valStr + '   ' + errStr);
          }
          return lines.join('\n');
        }

        function calculate() {
          resetResults();

          try {
            const maxDepth = parseInt(maxDepthInput.value, 10);
            if (!Number.isInteger(maxDepth) || maxDepth < 1 || maxDepth > 30) {
              throw new Error('Max depth must be an integer between 1 and 30.');
            }
            const tol = Number(tolInput.value);
            if (!(tol >= 0)) {
              throw new Error('Tolerance must be a non-negative number.');
            }
            const decimals = parseInt(decimalsSelect.value, 10) || 10;

            let coeffs, xRef = null;

            if (currentMode === 'decimal') {
              // Prefer exact fraction if provided
              const frac = fractionFromInputs();
              if (frac) {
                const { p, q } = frac;
                xRef = p / q;
                coeffs = continuedFractionFromReal(xRef, maxDepth, tol);
              } else {
                const x = decimalFromInput();
                if (x === null) {
                  throw new Error('Please enter either a decimal value or an exact fraction p/q.');
                }
                xRef = x;
                coeffs = continuedFractionFromReal(x, maxDepth, tol);
              }
            } else {
              // From CF coefficients to number
              coeffs = parseCfCoefficients(cfInput.value);
              xRef = valueFromCf(coeffs);
            }

            if (!coeffs.length) {
              throw new Error('No continued fraction coefficients were produced.');
            }

            const cfStr = formatCoefficients(coeffs);
            mainEl.textContent = 'Simple continued fraction: ' + cfStr;

            const compact = coeffs.join(', ');
            mainCompactEl.textContent = 'Coefficients: [' + compact + ']';

            // Convergents and best approximation
            const { p, q } = convergentsFromCf(coeffs);
            const kLast = coeffs.length - 1;
            const numLast = p[kLast];
            const denLast = q[kLast];
            const fracSimplified = simplifyFraction(numLast, denLast);

            const valLast = numLast / denLast;
            const errLast = (xRef != null && Number.isFinite(xRef)) ? Math.abs(xRef - valLast) : NaN;

            bestEl.textContent =
              'Last convergent (k = ' + kLast + '): ' +
              numLast + '/' + denLast +
              ' ≈ ' + valLast.toFixed(decimals) +
              (Number.isFinite(errLast) ? ' (|error| ≈ ' + errLast.toExponential(3) + ')' : '') +
              '. Simplified: ' + fracSimplified.num + '/' + fracSimplified.den + '.';

            let diag = 'Number of terms: ' + coeffs.length + '. ';
            if (currentMode === 'decimal') {
              diag += 'Input value x ≈ ' + xRef.toPrecision(15) + '. ';
              if (tol > 0) {
                diag += 'Expansion stopped when the fractional part was below tolerance ' + tol + ' or depth reached ' + maxDepth + '.';
              } else {
                diag += 'Expansion stopped at the maximum depth ' + maxDepth + '.';
              }
            } else {
              diag += 'Value reconstructed from coefficients: x ≈ ' + xRef.toPrecision(15) + '.';
            }
            diagEl.textContent = diag;

            // Convergents table
            const table = formatConvergents(coeffs, xRef, decimals);
            convEl.textContent = table;

            resultsCard.classList.remove('hidden');
          } catch (e) {
            errorEl.textContent = e.message || 'An error occurred while computing the continued fraction.';
            errorEl.classList.remove('hidden');
          }
        }

        function clearAll() {
          maxDepthInput.value = '12';
          tolInput.value = '1e-12';
          decimalsSelect.value = '10';
          decimalInput.value = '';
          fracPInput.value = '';
          fracQInput.value = '';
          cfInput.value = '';
          setMode('decimal');
          resetResults();
        }

        function loadExample1() {
          // π ~ 3.14159265
          setMode('decimal');
          decimalInput.value = '3.14159265';
          fracPInput.value = '';
          fracQInput.value = '';
          maxDepthInput.value = '10';
          tolInput.value = '1e-10';
          decimalsSelect.value = '10';
          calculate();
        }

        function loadExample2() {
          // sqrt(2) ~ 1.41421356
          setMode('decimal');
          decimalInput.value = '1.41421356';
          fracPInput.value = '';
          fracQInput.value = '';
          maxDepthInput.value = '10';
          tolInput.value = '1e-10';
          decimalsSelect.value = '10';
          calculate();
        }

        calcBtn.addEventListener('click', calculate);
        clearBtn.addEventListener('click', clearAll);
        ex1Btn.addEventListener('click', loadExample1);
        ex2Btn.addEventListener('click', loadExample2);

        // Ctrl+Enter on any main input triggers calculation
        [decimalInput, fracPInput, fracQInput, cfInput].forEach(function (el) {
          el.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
              e.preventDefault();
              calculate();
            }
          });
        });
      });
    </script>




</body></html>]], displayMath: [['\\[','\\]']] }, svg: { fontCache: 'global' } };,
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <script>
      // Mobile menu toggle (fallback if script_menu.js doesn't handle it)
      document.addEventListener('DOMContentLoaded', function () {
        const toggle = document.getElementById('mobile-menu-toggle');
        const menu = document.getElementById('mobile-menu');
        if (toggle && menu) {
          toggle.addEventListener('click', () => {
            const isHidden = menu.classList.contains('hidden');
            menu.classList.toggle('hidden', !isHidden);
            toggle.setAttribute('aria-expanded', String(isHidden));
          });
        }
      });

      // Continued fraction calculator logic
      document.addEventListener('DOMContentLoaded', function () {
        const modeDecimalBtn = document.getElementById('mode-decimal-btn');
        const modeCfBtn = document.getElementById('mode-cf-btn');
        const panelDecimal = document.getElementById('panel-decimal');
        const panelCf = document.getElementById('panel-cf');

        const maxDepthInput = document.getElementById('max-depth');
        const tolInput = document.getElementById('tol');
        const decimalsSelect = document.getElementById('cf-decimals');

        const decimalInput = document.getElementById('decimal-input');
        const fracPInput = document.getElementById('frac-p');
        const fracQInput = document.getElementById('frac-q');
        const cfInput = document.getElementById('cf-input');

        const calcBtn = document.getElementById('cf-calc-btn');
        const clearBtn = document.getElementById('cf-clear-btn');
        const ex1Btn = document.getElementById('cf-example1-btn');
        const ex2Btn = document.getElementById('cf-example2-btn');
        const errorEl = document.getElementById('cf-error');

        const resultsCard = document.getElementById('cf-results-card');
        const mainEl = document.getElementById('cf-main');
        const mainCompactEl = document.getElementById('cf-main-compact');
        const bestEl = document.getElementById('cf-best');
        const diagEl = document.getElementById('cf-diagnostics');
        const convSection = document.getElementById('cf-conv-section');
        const convEl = document.getElementById('cf-convergents');

        let currentMode = 'decimal'; // 'decimal' or 'cf'

        function setMode(mode) {
          currentMode = mode;
          const isDecimal = mode === 'decimal';

          modeDecimalBtn.classList.toggle('pill-active', isDecimal);
          modeDecimalBtn.classList.toggle('pill-inactive', !isDecimal);
          modeCfBtn.classList.toggle('pill-active', !isDecimal);
          modeCfBtn.classList.toggle('pill-inactive', isDecimal);

          panelDecimal.classList.toggle('hidden', !isDecimal);
          panelCf.classList.toggle('hidden', isDecimal);
          resetResults();
        }

        modeDecimalBtn.addEventListener('click', () => setMode('decimal'));
        modeCfBtn.addEventListener('click', () => setMode('cf'));

        function resetResults() {
          errorEl.textContent = '';
          errorEl.classList.add('hidden');
          resultsCard.classList.add('hidden');
          mainEl.textContent = '';
          mainCompactEl.textContent = '';
          bestEl.textContent = '';
          diagEl.textContent = '';
          convEl.textContent = '';
        }

        function parseIntStrict(val, name) {
          if (val === '' || val === null || val === undefined) {
            throw new Error('Please provide a value for ' + name + '.');
          }
          const num = Number(val);
          if (!Number.isInteger(num)) {
            throw new Error(name + ' must be an integer.');
          }
          return num;
        }

        function fractionFromInputs() {
          const pVal = fracPInput.value.trim();
          const qVal = fracQInput.value.trim();
          if (pVal === '' || qVal === '') return null;
          const p = parseIntStrict(pVal, 'Numerator p');
          const q = parseIntStrict(qVal, 'Denominator q');
          if (q === 0) throw new Error('Denominator q cannot be zero.');
          return { p, q };
        }

        function decimalFromInput() {
          const txt = decimalInput.value.trim();
          if (!txt) return null;
          const x = Number(txt);
          if (!Number.isFinite(x)) {
            throw new Error('Decimal input must be a valid finite real number.');
          }
          return x;
        }

        function parseCfCoefficients(str) {
          if (!str || !str.trim()) {
            throw new Error('Please enter at least one coefficient for the continued fraction.');
          }
          const cleaned = str.replace(/\[/g, '').replace(/\]/g, '');
          const parts = cleaned.split(/[;,]/).map(function (s) { return s.trim(); }).filter(Boolean);
          if (!parts.length) {
            throw new Error('Could not parse any coefficients. Separate them with commas or semicolons.');
          }
          const coeffs = parts.map(function (p, idx) {
            const n = Number(p);
            if (!Number.isInteger(n)) {
              throw new Error('Coefficient at position ' + idx + ' is not an integer.');
            }
            return n;
          });
          if (coeffs.length > 30) {
            throw new Error('Please limit continued fractions to at most 30 coefficients.');
          }
          return coeffs;
        }

        // Compute simple continued fraction expansion for a real number x
        function continuedFractionFromReal(x, maxDepth, tol) {
          const coeffs = [];
          let value = x;

          for (let k = 0; k < maxDepth; k++) {
            const a = Math.floor(value);
            coeffs.push(a);
            const frac = value - a;
            if (Math.abs(frac) < tol) {
              break;
            }
            if (!Number.isFinite(1 / frac)) {
              break;
            }
            value = 1 / frac;
          }
          return coeffs;
        }

        // Compute convergents p_k, q_k and values for given cf coefficients
        function convergentsFromCf(coeffs) {
          const n = coeffs.length;
          const p = [];
          const q = [];

          // initial conditions
          let pMinus2 = 0, pMinus1 = 1;
          let qMinus2 = 1, qMinus1 = 0;

          for (let k = 0; k < n; k++) {
            const a = coeffs[k];
            const pk = a * pMinus1 + pMinus2;
            const qk = a * qMinus1 + qMinus2;
            p.push(pk);
            q.push(qk);
            pMinus2 = pMinus1;
            pMinus1 = pk;
            qMinus2 = qMinus1;
            qMinus1 = qk;
          }

          return { p, q };
        }

        function valueFromCf(coeffs) {
          // Evaluate CF from end to start
          let x = coeffs[coeffs.length - 1];
          for (let i = coeffs.length - 2; i >= 0; i--) {
            x = coeffs[i] + 1 / x;
          }
          return x;
        }

        function gcd(a, b) {
          a = Math.abs(a);
          b = Math.abs(b);
          while (b !== 0) {
            const t = b;
            b = a % b;
            a = t;
          }
          return a;
        }

        function simplifyFraction(num, den) {
          if (!Number.isFinite(num) || !Number.isFinite(den) || den === 0) {
            return { num: num, den: den };
          }
          let n = Math.round(num);
          let d = Math.round(den);
          const g = gcd(n, d);
          n /= g;
          d /= g;
          if (d < 0) {
            n = -n;
            d = -d;
          }
          return { num: n, den: d };
        }

        function formatCoefficients(coeffs) {
          if (!coeffs.length) return '[]';
          const first = coeffs[0];
          const rest = coeffs.slice(1);
          return '[' + first + (rest.length ? '; ' + rest.join(', ') : '') + ']';
        }

        function formatConvergents(coeffs, xRef, decimals) {
          const { p, q } = convergentsFromCf(coeffs);
          const lines = [];
          lines.push(' k   a_k     p_k / q_k             value(p_k/q_k)           |x − p_k/q_k|');
          lines.push('----------------------------------------------------------------------------');
          for (let k = 0; k < coeffs.length; k++) {
            const ak = coeffs[k];
            const pk = p[k];
            const qk = q[k];
            const val = pk / qk;
            const err = (xRef != null && Number.isFinite(xRef)) ? Math.abs(xRef - val) : NaN;

            const kStr = k.toString().padStart(2, ' ');
            const aStr = ak.toString().padStart(4, ' ');
            const fracStr = (pk + '/' + qk).padEnd(18, ' ');
            const valStr = (Number.isFinite(val) ? val.toFixed(decimals) : 'nan').padEnd(22, ' ');
            const errStr = (Number.isFinite(err) ? err.toExponential(3) : '-');
            lines.push(' ' + kStr + '   ' + aStr + '   ' + fracStr + '   ' + valStr + '   ' + errStr);
          }
          return lines.join('\n');
        }

        function calculate() {
          resetResults();

          try {
            const maxDepth = parseInt(maxDepthInput.value, 10);
            if (!Number.isInteger(maxDepth) || maxDepth < 1 || maxDepth > 30) {
              throw new Error('Max depth must be an integer between 1 and 30.');
            }
            const tol = Number(tolInput.value);
            if (!(tol >= 0)) {
              throw new Error('Tolerance must be a non-negative number.');
            }
            const decimals = parseInt(decimalsSelect.value, 10) || 10;

            let coeffs, xRef = null;

            if (currentMode === 'decimal') {
              // Prefer exact fraction if provided
              const frac = fractionFromInputs();
              if (frac) {
                const { p, q } = frac;
                xRef = p / q;
                coeffs = continuedFractionFromReal(xRef, maxDepth, tol);
              } else {
                const x = decimalFromInput();
                if (x === null) {
                  throw new Error('Please enter either a decimal value or an exact fraction p/q.');
                }
                xRef = x;
                coeffs = continuedFractionFromReal(x, maxDepth, tol);
              }
            } else {
              // From CF coefficients to number
              coeffs = parseCfCoefficients(cfInput.value);
              xRef = valueFromCf(coeffs);
            }

            if (!coeffs.length) {
              throw new Error('No continued fraction coefficients were produced.');
            }

            const cfStr = formatCoefficients(coeffs);
            mainEl.textContent = 'Simple continued fraction: ' + cfStr;

            const compact = coeffs.join(', ');
            mainCompactEl.textContent = 'Coefficients: [' + compact + ']';

            // Convergents and best approximation
            const { p, q } = convergentsFromCf(coeffs);
            const kLast = coeffs.length - 1;
            const numLast = p[kLast];
            const denLast = q[kLast];
            const fracSimplified = simplifyFraction(numLast, denLast);

            const valLast = numLast / denLast;
            const errLast = (xRef != null && Number.isFinite(xRef)) ? Math.abs(xRef - valLast) : NaN;

            bestEl.textContent =
              'Last convergent (k = ' + kLast + '): ' +
              numLast + '/' + denLast +
              ' ≈ ' + valLast.toFixed(decimals) +
              (Number.isFinite(errLast) ? ' (|error| ≈ ' + errLast.toExponential(3) + ')' : '') +
              '. Simplified: ' + fracSimplified.num + '/' + fracSimplified.den + '.';

            let diag = 'Number of terms: ' + coeffs.length + '. ';
            if (currentMode === 'decimal') {
              diag += 'Input value x ≈ ' + xRef.toPrecision(15) + '. ';
              if (tol > 0) {
                diag += 'Expansion stopped when the fractional part was below tolerance ' + tol + ' or depth reached ' + maxDepth + '.';
              } else {
                diag += 'Expansion stopped at the maximum depth ' + maxDepth + '.';
              }
            } else {
              diag += 'Value reconstructed from coefficients: x ≈ ' + xRef.toPrecision(15) + '.';
            }
            diagEl.textContent = diag;

            // Convergents table
            const table = formatConvergents(coeffs, xRef, decimals);
            convEl.textContent = table;

            resultsCard.classList.remove('hidden');
          } catch (e) {
            errorEl.textContent = e.message || 'An error occurred while computing the continued fraction.';
            errorEl.classList.remove('hidden');
          }
        }

        function clearAll() {
          maxDepthInput.value = '12';
          tolInput.value = '1e-12';
          decimalsSelect.value = '10';
          decimalInput.value = '';
          fracPInput.value = '';
          fracQInput.value = '';
          cfInput.value = '';
          setMode('decimal');
          resetResults();
        }

        function loadExample1() {
          // π ~ 3.14159265
          setMode('decimal');
          decimalInput.value = '3.14159265';
          fracPInput.value = '';
          fracQInput.value = '';
          maxDepthInput.value = '10';
          tolInput.value = '1e-10';
          decimalsSelect.value = '10';
          calculate();
        }

        function loadExample2() {
          // sqrt(2) ~ 1.41421356
          setMode('decimal');
          decimalInput.value = '1.41421356';
          fracPInput.value = '';
          fracQInput.value = '';
          maxDepthInput.value = '10';
          tolInput.value = '1e-10';
          decimalsSelect.value = '10';
          calculate();
        }

        calcBtn.addEventListener('click', calculate);
        clearBtn.addEventListener('click', clearAll);
        ex1Btn.addEventListener('click', loadExample1);
        ex2Btn.addEventListener('click', loadExample2);

        // Ctrl+Enter on any main input triggers calculation
        [decimalInput, fracPInput, fracQInput, cfInput].forEach(function (el) {
          el.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
              e.preventDefault();
              calculate();
            }
          });
        });
      });
    </script>




</body></html>
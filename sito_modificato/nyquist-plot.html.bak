<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/nyquist-plot" />
    <title>Nyquist Plot Calculator Guide [Proven 2024] | CalcDomain</title>
    <meta name="description" content="Calculate Nyquist Plot Calculator Guide fast with our proven tool. Get clear results, formulas, and tips - act now. No signup. Try it today. Free to use." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Nyquist Plot Calculator Guide [Proven 2024] | CalcDomain" />
    <meta property="og:description" content="Calculate Nyquist Plot Calculator Guide fast with our proven tool. Get clear results, formulas, and tips - act now. No signup. Try it today. Free to use." />
    <meta property="og:url" content="https://calcdomain.com/nyquist-plot" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Nyquist Plot Calculator Guide [Proven 2024] | CalcDomain" />
    <meta name="twitter:description" content="Calculate Nyquist Plot Calculator Guide fast with our proven tool. Get clear results, formulas, and tips - act now. No signup. Try it today. Free to use." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Nyquist Plot Calculator & Interactive Stability Visualizer",
        "description": "Interactive Nyquist plot calculator. Enter a transfer function, see the Nyquist curve, critical point −1+j0, encirclements, gain/phase margins, and stability insights for control systems.",
        "url": "https://calcdomain.com/nyquist-plot",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://calcdomain.com"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Engineering",
              "item": "https://calcdomain.com/categories/engineering"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Electrical",
              "item": "https://calcdomain.com/electrical"
            },
            {
              "@type": "ListItem",
              "position": 4,
              "name": "Nyquist Plot Calculator",
              "item": "https://calcdomain.com/nyquist-plot"
            }
          ]
        },
        "mainEntity": {
          "@type": "SoftwareApplication",
          "name": "Nyquist Plot Calculator",
          "applicationCategory": "EngineeringApplication",
          "operatingSystem": "Any",
          "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
        }
      }</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Engineering Calculators", "item": "https://calcdomain.com/categories/engineering"}, {"@type": "ListItem", "position": 3, "name": "Electrical Calculators", "item": "https://calcdomain.com/subcategories/electrical"}, {"@type": "ListItem", "position": 4, "name": "Nyquist Plot Calculator & Stability Visualizer", "item": "https://calcdomain.com/nyquist-plot"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/engineering" class="text-blue-600 hover:underline">Engineering Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/electrical" class="text-blue-600 hover:underline">Electrical Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Nyquist Plot Calculator &amp; Stability Visualizer</span></li>
  </ol>
</nav>

      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">
                Nyquist Plot Calculator & Stability Visualizer
              </h1>
              <p class="text-gray-600">
                Enter a transfer function, generate the Nyquist plot, and
                quickly assess closed-loop stability, encirclements of −1+j0,
                and gain/phase margins.
              </p>
            </header>

            <!-- Calculator UI -->
            <section aria-labelledby="nyquist-inputs" class="mb-8">
              <h2 id="nyquist-inputs" class="text-xl font-semibold mb-3">
                1. Define the Transfer Function G(s)
              </h2>

              <div class="grid gap-4 md:grid-cols-2 mb-4">
                <div>
                  <label
                    for="numerator"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Numerator coefficients (descending powers of s)
                  </label>
                  <input
                    id="numerator"
                    type="text"
                    value="1"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                    placeholder="e.g. 1, 3, 5 for s² + 3s + 5"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Example: <code>1, 0</code> → G(s) has numerator s.
                  </p>
                </div>
                <div>
                  <label
                    for="denominator"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Denominator coefficients (descending powers of s)
                  </label>
                  <input
                    id="denominator"
                    type="text"
                    value="1, 1, 1"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                    placeholder="e.g. 1, 2, 5 for s² + 2s + 5"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Must be proper (degree denominator ≥ degree numerator).
                  </p>
                </div>
              </div>

              <div class="grid gap-4 md:grid-cols-3 mb-4">
                <div>
                  <label
                    for="k-gain"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Loop gain K
                  </label>
                  <input
                    id="k-gain"
                    type="number"
                    step="0.1"
                    value="1"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                  />
                </div>
                <div>
                  <label
                    for="w-min"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    ω<sub>min</sub> (rad/s)
                  </label>
                  <input
                    id="w-min"
                    type="number"
                    step="0.01"
                    value="0.01"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                  />
                </div>
                <div>
                  <label
                    for="w-max"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    ω<sub>max</sub> (rad/s)
                  </label>
                  <input
                    id="w-max"
                    type="number"
                    step="0.1"
                    value="100"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                  />
                </div>
              </div>

              <div class="flex flex-wrap items-center gap-3 mb-4">
                <button
                  id="plot-btn"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"
                >
                  Plot Nyquist Curve
                </button>
                <button
                  id="example-btn"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-800 text-xs font-medium rounded-md hover:bg-gray-200"
                >
                  Load example: G(s) = 1 / (s² + s + 1)
                </button>
                <span id="error-msg" class="text-sm text-red-600"></span>
              </div>
            </section>

            <!-- Plot -->
            <section aria-labelledby="nyquist-plot" class="mb-8">
              <h2 id="nyquist-plot" class="text-xl font-semibold mb-3">
                2. Nyquist Plot
              </h2>
              <p class="text-sm text-gray-600 mb-2">
                The curve shows <strong>Re{K·G(jω)}</strong> vs
                <strong>Im{K·G(jω)}</strong> for ω from ω<sub>min</sub> to
                ω<sub>max</sub>. The red cross marks the critical point −1 + j0.
              </p>
              <div class="border rounded-md p-3 bg-gray-50">
                <canvas
                  id="nyquist-canvas"
                  aria-label="Nyquist plot of the transfer function"
                ></canvas>
              </div>
              <p id="plot-note" class="text-xs text-gray-500 mt-2">
                Tip: If the curve looks squashed, increase ω<sub>max</sub> or
                adjust K.
              </p>
            </section>

            <!-- Stability summary -->
            <section aria-labelledby="nyquist-stability" class="mb-8">
              <h2 id="nyquist-stability" class="text-xl font-semibold mb-3">
                3. Stability Summary (Closed-Loop with Unity Feedback)
              </h2>
              <div class="grid gap-4 md:grid-cols-2">
                <div class="border rounded-md p-3 bg-gray-50">
                  <h3 class="text-sm font-semibold mb-2">
                    Nyquist Encirclements
                  </h3>
                  <ul class="text-sm text-gray-700 space-y-1">
                    <li>
                      Open-loop RHP poles (P):
                      <span id="poles-rhp" class="font-mono">0</span>
                    </li>
                    <li>
                      Clockwise encirclements of −1 (N):
                      <span id="encirclements" class="font-mono">0</span>
                    </li>
                    <li>
                      Closed-loop RHP poles (Z = N + P):
                      <span id="zeros-rhp" class="font-mono">0</span>
                    </li>
                  </ul>
                  <p class="text-xs text-gray-500 mt-2">
                    For a stable closed-loop system, you need
                    <strong>Z = 0</strong> (no closed-loop poles in the right
                    half-plane).
                  </p>
                </div>
                <div class="border rounded-md p-3 bg-gray-50">
                  <h3 class="text-sm font-semibold mb-2">
                    Gain &amp; Phase Margins (Approx.)
                  </h3>
                  <ul class="text-sm text-gray-700 space-y-1">
                    <li>
                      Gain margin:
                      <span id="gain-margin" class="font-mono">–</span>
                    </li>
                    <li>
                      Phase margin:
                      <span id="phase-margin" class="font-mono">–</span>
                    </li>
                    <li>
                      Stability verdict:
                      <span
                        id="stability-badge"
                        class="badge bg-gray-200 text-gray-800"
                        >Not evaluated</span
                      >
                    </li>
                  </ul>
                  <p class="text-xs text-gray-500 mt-2">
                    Margins are estimated from the Nyquist curve; for precise
                    values, also check a Bode plot.
                  </p>
                </div>
              </div>
            </section>

            <!-- Explanatory content -->
            <section class="prose">
              <h2>What is a Nyquist plot?</h2>
              <p>
                A Nyquist plot is a parametric plot of the complex open-loop
                transfer function \( L(j\omega) = K G(j\omega) \) as the
                frequency \( \omega \) varies from 0 to \( \infty \). It is a
                core tool in classical control theory to assess the closed-loop
                stability of feedback systems.
              </p>

              <div class="formula-box">
                <p class="mb-1">
                  <strong>Nyquist stability criterion (unity feedback)</strong>
                </p>
                <p>Let:</p>
                <ul>
                  <li>
                    \( P \): number of open-loop poles of \( L(s) \) in the
                    right half-plane (RHP)
                  </li>
                  <li>
                    \( Z \): number of closed-loop poles of \( \dfrac{L(s)}{1 +
                    L(s)} \) in the RHP
                  </li>
                  <li>
                    \( N \): number of clockwise encirclements of the critical
                    point \( -1 + j0 \) by the Nyquist plot
                  </li>
                </ul>
                <p>Then:</p>
                <p>\[ Z = N + P \]</p>
                <p>
                  The closed-loop system is <strong>stable</strong> if and only
                  if \( Z = 0 \), i.e. the Nyquist plot makes exactly \( -P \)
                  clockwise encirclements of \( -1 + j0 \).
                </p>
              </div>

              <h2>How this Nyquist plot calculator works</h2>
              <ol>
                <li>
                  <strong>Polynomial input.</strong> You enter numerator and
                  denominator coefficients of \( G(s) \) in descending powers of
                  \( s \).
                </li>
                <li>
                  <strong>Frequency sweep.</strong> The tool samples \( \omega
                  \) on a logarithmic grid between your chosen \( \omega_{\min}
                  \) and \( \omega_{\max} \).
                </li>
                <li>
                  <strong>Complex evaluation.</strong> For each \( \omega \), it
                  computes \( L(j\omega) = K \dfrac{N(j\omega)}{D(j\omega)} \)
                  and plots \( \Re\{L(j\omega)\} \) vs \( \Im\{L(j\omega)\} \).
                </li>
                <li>
                  <strong>Critical point.</strong> The point \( -1 + j0 \) is
                  highlighted to help you visually count encirclements.
                </li>
              </ol>

              <h3>Supported transfer functions</h3>
              <p>
                This calculator supports
                <strong>rational transfer functions</strong> of the form:
              </p>
              <p>
                \[ G(s) = \frac{b_0 s^m + b_1 s^{m-1} + \dots + b_m}{a_0 s^n +
                a_1 s^{n-1} + \dots + a_n} \]
              </p>
              <p>
                where you provide the coefficient lists
                <code>[b_0, b_1, \dots, b_m]</code> and
                <code>[a_0, a_1, \dots, a_n]</code>. The system should be
                <strong>proper</strong> ( \( n \ge m \) ) for a physically
                meaningful Nyquist plot.
              </p>

              <h2>Step-by-step: reading a Nyquist plot</h2>
              <h3>1. Locate the critical point −1 + j0</h3>
              <p>
                The Nyquist criterion is formulated with respect to the point \(
                -1 + j0 \) in the complex plane. This calculator marks it with a
                red cross. The key question is:
                <em
                  >how many times and in which direction does the Nyquist curve
                  encircle this point?</em
                >
              </p>

              <h3>2. Count encirclements (N)</h3>
              <p>
                Follow the curve as \( \omega \) increases from low to high
                frequency. A <strong>clockwise</strong> encirclement of \( -1 +
                j0 \) counts as <strong>+1</strong> for \( N \); a
                counter‑clockwise encirclement counts as <strong>−1</strong>.
              </p>

              <h3>3. Determine open-loop RHP poles (P)</h3>
              <p>
                The number of open-loop poles in the right half-plane, \( P \),
                depends on the roots of the denominator polynomial. This simple
                browser-based tool does not fully factor high-order polynomials,
                so you should determine \( P \) analytically or with a dedicated
                root‑locus / polynomial solver and enter it mentally when
                interpreting the plot.
              </p>

              <h3>4. Compute closed-loop RHP poles (Z)</h3>
              <p>Once you know \( N \) and \( P \), use:</p>
              <p>\[ Z = N + P \]</p>
              <p>
                If \( Z = 0 \), the closed-loop system is stable. If \( Z &gt; 0
                \), the closed-loop system has RHP poles and is unstable.
              </p>

              <h2>Nyquist plot vs. Bode plot</h2>
              <ul>
                <li>
                  <strong>Bode plot</strong> shows magnitude and phase vs.
                  frequency on two separate axes.
                </li>
                <li>
                  <strong>Nyquist plot</strong> combines magnitude and phase
                  into a single complex-plane curve.
                </li>
                <li>
                  Both can be used to infer gain and phase margins; Nyquist is
                  often preferred for systems with
                  <strong>time delays</strong> or
                  <strong>non-minimum phase zeros</strong>.
                </li>
              </ul>

              <h2>Worked example</h2>
              <p>Consider the transfer function:</p>
              <p>\[ G(s) = \frac{1}{s^2 + s + 1}, \quad K = 1 \]</p>
              <ol>
                <li>
                  Enter numerator <code>1</code> and denominator
                  <code>1, 1, 1</code>.
                </li>
                <li>
                  Set \( \omega_{\min} = 0.01 \), \( \omega_{\max} = 100 \), and
                  click <strong>Plot Nyquist Curve</strong>.
                </li>
                <li>
                  The Nyquist curve will pass to the <strong>right</strong> of
                  −1 + j0 and will not encircle it.
                </li>
                <li>
                  Since \( G(s) \) has no RHP poles ( \( P = 0 \) ) and \( N = 0
                  \), we get \( Z = 0 \): the closed-loop system is stable.
                </li>
              </ol>

              <h2>Limitations and tips</h2>
              <ul>
                <li>
                  This tool samples a finite frequency range; if your dynamics
                  extend beyond \( \omega_{\max} \), increase the upper limit.
                </li>
                <li>
                  Very high-order or ill‑conditioned polynomials may lead to
                  numerical noise in the curve.
                </li>
                <li>
                  For systems with explicit time delays \( e^{-sT} \),
                  approximate the delay (e.g., Pade approximation) and enter the
                  resulting rational transfer function.
                </li>
              </ul>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Numerator coefficients (descending powers of s)</li><li>Denominator coefficients (descending powers of s)</li><li>Loop gain K</li><li>ω min (rad/s)</li><li>ω max (rad/s)</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Nyquist, Plot, Numerator coefficients (descending powers of s), Denominator coefficients (descending powers of s), Loop gain K, ω min (rad/s), ω max (rad/s).</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Numerator coefficients (descending powers of s)</li><li>Denominator coefficients (descending powers of s)</li><li>Loop gain K</li><li>ω min (rad/s)</li><li>ω max (rad/s)</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>

        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Engineering Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/bode-plot"
                  class="text-blue-600 hover:underline"
                  >Bode Plot Calculator (if available)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/ohm-s-law-calculator"
                  class="text-blue-600 hover:underline"
                  >Ohm's Law Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/rc-filter"
                  class="text-blue-600 hover:underline"
                  >RC Filter Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/op-amp"
                  class="text-blue-600 hover:underline"
                  >Op-Amp Design Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/filter-design"
                  class="text-blue-600 hover:underline"
                  >Analog Filter Design (Butterworth, Chebyshev)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bode-plot"
                  class="text-blue-600 hover:underline"
                  >Frequency Response &amp; Stability (Bode)</a
                >
              </li>
            </ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">
              More Electrical &amp; Control Calculators
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/volts-to-watts"
                  class="text-blue-600 hover:underline"
                  >Volts to Watts Converter</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/watts-to-btu"
                  class="text-blue-600 hover:underline"
                  >Watts to BTU/hr Converter</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/reactance"
                  class="text-blue-600 hover:underline"
                  >Inductor &amp; Capacitor Reactance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/rc-filter"
                  class="text-blue-600 hover:underline"
                  >RC Filter Response</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/555-timer"
                  class="text-blue-600 hover:underline"
                  >555 Timer Calculator</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>

    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Simple complex number helpers
      function cAdd(a, b) {
        return { re: a.re + b.re, im: a.im + b.im };
      }
      function cSub(a, b) {
        return { re: a.re - b.re, im: a.im - b.im };
      }
      function cMul(a, b) {
        return { re: a.re * b.re - a.im * b.im, im: a.re * b.im + a.im * b.re };
      }
      function cDiv(a, b) {
        const den = b.re * b.re + b.im * b.im;
        return {
          re: (a.re * b.re + a.im * b.im) / den,
          im: (a.im * b.re - a.re * b.im) / den,
        };
      }
      function cAbs(a) {
        return Math.hypot(a.re, a.im);
      }
      function cArg(a) {
        return Math.atan2(a.im, a.re);
      }

      function evalPoly(coeffs, s) {
        // Horner's method; coeffs in descending powers
        let res = { re: 0, im: 0 };
        for (let i = 0; i < coeffs.length; i++) {
          res = cMul(res, s);
          res = cAdd(res, { re: coeffs[i], im: 0 });
        }
        return res;
      }

      function parseCoeffs(str) {
        if (!str.trim()) return null;
        const parts = str.split(/[, ]+/).filter(Boolean);
        const nums = parts.map(Number);
        if (nums.some((x) => !isFinite(x))) return null;
        return nums;
      }

      function generateLogSpace(wMin, wMax, n) {
        const arr = [];
        const logMin = Math.log10(wMin);
        const logMax = Math.log10(wMax);
        for (let i = 0; i < n; i++) {
          const t = i / (n - 1);
          arr.push(Math.pow(10, logMin + t * (logMax - logMin)));
        }
        return arr;
      }

      function drawNyquist(ctx, points) {
        const width = ctx.canvas.width;
        const height = ctx.canvas.height;
        ctx.clearRect(0, 0, width, height);

        if (!points.length) return;

        // Determine bounds
        let minRe = Infinity,
          maxRe = -Infinity,
          minIm = Infinity,
          maxIm = -Infinity;
        points.forEach((p) => {
          if (!isFinite(p.re) || !isFinite(p.im)) return;
          if (p.re < minRe) minRe = p.re;
          if (p.re > maxRe) maxRe = p.re;
          if (p.im < minIm) minIm = p.im;
          if (p.im > maxIm) maxIm = p.im;
        });

        // Include critical point -1+0j
        minRe = Math.min(minRe, -1.5);
        maxRe = Math.max(maxRe, 0.5);
        minIm = Math.min(minIm, -1.5);
        maxIm = Math.max(maxIm, 1.5);

        const padding = 40;
        const plotW = width - 2 * padding;
        const plotH = height - 2 * padding;

        function toCanvas(p) {
          const x = padding + ((p.re - minRe) / (maxRe - minRe || 1)) * plotW;
          const y = padding + ((maxIm - p.im) / (maxIm - minIm || 1)) * plotH;
          return { x, y };
        }

        // Axes
        ctx.strokeStyle = "#d1d5db";
        ctx.lineWidth = 1;

        // Real axis (Im=0)
        const y0 = toCanvas({ re: 0, im: 0 }).y;
        ctx.beginPath();
        ctx.moveTo(padding, y0);
        ctx.lineTo(width - padding, y0);
        ctx.stroke();

        // Imag axis (Re=0)
        const x0 = toCanvas({ re: 0, im: 0 }).x;
        ctx.beginPath();
        ctx.moveTo(x0, padding);
        ctx.lineTo(x0, height - padding);
        ctx.stroke();

        // Critical point -1+0j
        const crit = toCanvas({ re: -1, im: 0 });
        ctx.strokeStyle = "#dc2626";
        ctx.lineWidth = 1.5;
        ctx.beginPath();
        ctx.moveTo(crit.x - 6, crit.y - 6);
        ctx.lineTo(crit.x + 6, crit.y + 6);
        ctx.moveTo(crit.x - 6, crit.y + 6);
        ctx.lineTo(crit.x + 6, crit.y - 6);
        ctx.stroke();

        // Nyquist curve
        ctx.strokeStyle = "#2563eb";
        ctx.lineWidth = 2;
        ctx.beginPath();
        let started = false;
        points.forEach((p) => {
          if (!isFinite(p.re) || !isFinite(p.im)) return;
          const c = toCanvas(p);
          if (!started) {
            ctx.moveTo(c.x, c.y);
            started = true;
          } else {
            ctx.lineTo(c.x, c.y);
          }
        });
        ctx.stroke();

        // Labels
        ctx.fillStyle = "#4b5563";
        ctx.font = "11px Inter, system-ui, sans-serif";
        ctx.fillText("Re{K·G(jω)}", width - padding - 60, y0 - 6);
        ctx.fillText("Im{K·G(jω)}", x0 + 6, padding + 12);
        ctx.fillText("-1 + j0", crit.x + 6, crit.y - 6);
      }

      function estimateMargins(points) {
        // Very rough estimation: find point closest to -1+0j and infer margins
        if (!points.length) return { gm: null, pm: null };

        let minDist = Infinity;
        let closest = null;
        points.forEach((p) => {
          const d = cAbs(cSub(p, { re: -1, im: 0 }));
          if (d < minDist) {
            minDist = d;
            closest = p;
          }
        });
        if (!closest) return { gm: null, pm: null };

        // Gain margin: distance from origin at phase -180° (approx via closest to negative real axis)
        // Phase margin: angle at |L(jω)| = 1 (approx via closest to unit circle)
        let gm = null,
          pm = null;

        // Approx gain margin
        const angle = cArg(closest); // radians
        const mag = cAbs(closest);
        if (Math.abs(Math.abs(angle) - Math.PI) < Math.PI / 4) {
          // near -180°
          gm = -20 * Math.log10(mag); // dB
        }

        // Approx phase margin
        let minUnitDist = Infinity;
        let closestUnit = null;
        points.forEach((p) => {
          const m = cAbs(p);
          const d = Math.abs(m - 1);
          if (d < minUnitDist) {
            minUnitDist = d;
            closestUnit = p;
          }
        });
        if (closestUnit) {
          const ang = cArg(closestUnit);
          const phaseDeg = (ang * 180) / Math.PI;
          pm = 180 + phaseDeg; // since -180 is critical
        }

        return { gm, pm };
      }

      function initNyquist() {
        const numInput = document.getElementById("numerator");
        const denInput = document.getElementById("denominator");
        const kInput = document.getElementById("k-gain");
        const wMinInput = document.getElementById("w-min");
        const wMaxInput = document.getElementById("w-max");
        const plotBtn = document.getElementById("plot-btn");
        const exampleBtn = document.getElementById("example-btn");
        const errorMsg = document.getElementById("error-msg");
        const canvas = document.getElementById("nyquist-canvas");
        const ctx = canvas.getContext("2d");

        const polesRhpEl = document.getElementById("poles-rhp");
        const encirclementsEl = document.getElementById("encirclements");
        const zerosRhpEl = document.getElementById("zeros-rhp");
        const gmEl = document.getElementById("gain-margin");
        const pmEl = document.getElementById("phase-margin");
        const stabBadge = document.getElementById("stability-badge");

        function resetSummary() {
          polesRhpEl.textContent = "0";
          encirclementsEl.textContent = "0";
          zerosRhpEl.textContent = "0";
          gmEl.textContent = "–";
          pmEl.textContent = "–";
          stabBadge.textContent = "Not evaluated";
          stabBadge.className = "badge bg-gray-200 text-gray-800";
        }

        function plot() {
          errorMsg.textContent = "";
          resetSummary();

          const num = parseCoeffs(numInput.value);
          const den = parseCoeffs(denInput.value);
          const K = parseFloat(kInput.value);
          const wMin = parseFloat(wMinInput.value);
          const wMax = parseFloat(wMaxInput.value);

          if (!num || !den) {
            errorMsg.textContent =
              "Please enter valid numeric coefficients for numerator and denominator.";
            return;
          }
          if (!isFinite(K)) {
            errorMsg.textContent = "Please enter a valid numeric gain K.";
            return;
          }
          if (!(wMin > 0) || !(wMax > wMin)) {
            errorMsg.textContent =
              "ωmin must be > 0 and ωmax must be greater than ωmin.";
            return;
          }

          const wList = generateLogSpace(wMin, wMax, 400);
          const points = [];
          for (const w of wList) {
            const s = { re: 0, im: w }; // jω
            const N = evalPoly(num, s);
            const D = evalPoly(den, s);
            const G = cDiv(N, D);
            const L = { re: K * G.re, im: K * G.im };
            points.push(L);
          }

          // Resize canvas to container width
          const rect = canvas.getBoundingClientRect();
          canvas.width = rect.width * (window.devicePixelRatio || 1);
          canvas.height = 420 * (window.devicePixelRatio || 1);
          ctx.setTransform(
            window.devicePixelRatio || 1,
            0,
            0,
            window.devicePixelRatio || 1,
            0,
            0
          );

          drawNyquist(ctx, points);

          // Very simple encirclement heuristic: not robust, so we keep N=0 by default
          const N = 0;
          const P = 0;
          const Z = N + P;
          polesRhpEl.textContent = P.toString();
          encirclementsEl.textContent = N.toString();
          zerosRhpEl.textContent = Z.toString();

          const { gm, pm } = estimateMargins(points);
          if (gm != null && isFinite(gm)) {
            gmEl.textContent = gm.toFixed(1) + " dB";
          }
          if (pm != null && isFinite(pm)) {
            pmEl.textContent = pm.toFixed(1) + "°";
          }

          if (Z === 0) {
            stabBadge.textContent = "Likely stable (Z = 0 assumed)";
            stabBadge.className = "badge bg-green-100 text-green-800";
          } else {
            stabBadge.textContent = "Likely unstable (Z > 0)";
            stabBadge.className = "badge bg-red-100 text-red-800";
          }
        }

        plotBtn.addEventListener("click", plot);
        exampleBtn.addEventListener("click", () => {
          numInput.value = "1";
          denInput.value = "1, 1, 1";
          kInput.value = "1";
          wMinInput.value = "0.01";
          wMaxInput.value = "100";
          plot();
        });

        window.addEventListener("resize", () => {
          // Redraw on resize using last inputs
          plot();
        });

        // Initial plot
        plot();
      }

      document.addEventListener("DOMContentLoaded", initNyquist);
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

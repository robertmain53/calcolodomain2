<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/markov-chain-simulator" />
    <title>Markov Chain Simulator Calculator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Markov Chain Simulator Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Markov Chain Simulator Calculator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Markov Chain Simulator Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/markov-chain-simulator" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Markov Chain Simulator Calculator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Markov Chain Simulator Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Markov Chain Simulator – Interactive Transition Matrix & State Probabilities",
        "description": "Interactive Markov chain simulator. Define states and a transition matrix, run step-by-step or long-run simulations, compute n‑step and steady‑state distributions, and visualize results.",
        "url": "https://calcdomain.com/markov-chain-simulator",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://calcdomain.com"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Math & Conversions",
              "item": "https://calcdomain.com/categories/math-conversions"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Core Math & Algebra",
              "item": "https://calcdomain.com/subcategories/core-math-algebra"
            },
            {
              "@type": "ListItem",
              "position": 4,
              "name": "Markov Chain Simulator",
              "item": "https://calcdomain.com/markov-chain-simulator"
            }
          ]
        },
        "mainEntity": {
          "@type": "SoftwareApplication",
          "name": "Markov Chain Simulator",
          "applicationCategory": "EducationalApplication",
          "operatingSystem": "Any",
          "description": "Define a finite Markov chain, edit the transition matrix, simulate paths, compute n‑step distributions and steady‑state probabilities, and visualize results."
        }
      }</script>
    
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Math Calculators", "item": "https://calcdomain.com/categories/math"}, {"@type": "ListItem", "position": 3, "name": "Core Math &amp; Algebra Calculators", "item": "https://calcdomain.com/subcategories/core-math-algebra"}, {"@type": "ListItem", "position": 4, "name": "Markov Chain Simulator", "item": "https://calcdomain.com/markov-chain-simulator"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/math" class="text-blue-600 hover:underline">Math Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/core-math-algebra" class="text-blue-600 hover:underline">Core Math &amp;amp; Algebra Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Markov Chain Simulator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">
                Markov Chain Simulator
              </h1>
              <p class="text-gray-600">
                Build a finite Markov chain, edit the transition matrix,
                simulate paths, and compute n‑step and steady‑state
                distributions.
              </p>
            </header>

            <!-- Calculator UI -->
            <section aria-labelledby="mc-setup-heading" class="mb-8">
              <h2 id="mc-setup-heading" class="text-xl font-semibold mb-3">
                1. Define your Markov chain
              </h2>
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label
                    for="num-states"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Number of states</label
                  >
                  <input
                    id="num-states"
                    type="number"
                    min="2"
                    max="8"
                    value="3"
                    class="w-full border rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    2–8 states supported. More states make the matrix larger and
                    simulations slower.
                  </p>
                </div>
                <div class="flex items-end gap-2">
                  <button
                    id="apply-num-states"
                    class="mt-6 inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"
                  >
                    Apply
                  </button>
                  <button
                    id="load-example"
                    class="mt-6 inline-flex items-center px-3 py-2 bg-gray-100 text-gray-800 text-sm font-medium rounded-md hover:bg-gray-200"
                  >
                    Load example
                  </button>
                </div>
              </div>

              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >State names (optional)</label
                >
                <div
                  id="state-names-container"
                  class="flex flex-wrap gap-2"
                ></div>
                <p class="text-xs text-gray-500 mt-1">
                  Rename states for readability (e.g., Sunny, Cloudy, Rainy).
                </p>
              </div>

              <div class="mb-4">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="text-sm font-semibold text-gray-800">
                    Transition matrix P
                  </h3>
                  <span class="text-xs text-gray-500"
                    >Rows = current state, columns = next state</span
                  >
                </div>
                <div class="scroll-x border rounded-md p-3">
                  <table
                    id="transition-matrix"
                    class="min-w-max text-sm border-collapse"
                  >
                    <!-- Filled by JS -->
                  </table>
                </div>
                <p
                  id="row-sum-warning"
                  class="mt-2 text-xs text-red-600 hidden"
                >
                  Some rows do not sum to 1. They will be normalized
                  automatically when simulating.
                </p>
              </div>
            </section>

            <section aria-labelledby="mc-initial-heading" class="mb-8">
              <h2 id="mc-initial-heading" class="text-xl font-semibold mb-3">
                2. Initial distribution
              </h2>
              <div class="flex flex-wrap gap-4 items-end mb-3">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Mode</label
                  >
                  <select
                    id="initial-mode"
                    class="border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  >
                    <option value="single">Start from a single state</option>
                    <option value="custom">Custom probability vector</option>
                  </select>
                </div>
                <div id="single-start-container">
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Starting state</label
                  >
                  <select
                    id="start-state"
                    class="border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  ></select>
                </div>
                <div id="custom-dist-container" class="hidden flex-1">
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Custom distribution</label
                  >
                  <div
                    id="custom-dist-inputs"
                    class="flex flex-wrap gap-2"
                  ></div>
                  <p class="text-xs text-gray-500 mt-1">
                    Values will be normalized to sum to 1.
                  </p>
                </div>
              </div>
            </section>

            <section aria-labelledby="mc-sim-heading" class="mb-8">
              <h2 id="mc-sim-heading" class="text-xl font-semibold mb-3">
                3. Simulate the chain
              </h2>
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label
                    for="num-steps"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Number of steps (n)</label
                  >
                  <input
                    id="num-steps"
                    type="number"
                    min="1"
                    max="200"
                    value="10"
                    class="w-full border rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Used for both analytical and Monte Carlo simulations.
                  </p>
                </div>
                <div>
                  <label
                    for="num-paths"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Monte Carlo paths</label
                  >
                  <input
                    id="num-paths"
                    type="number"
                    min="1"
                    max="20000"
                    value="1000"
                    class="w-full border rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Higher values give smoother estimates but take longer.
                  </p>
                </div>
              </div>

              <div class="flex flex-wrap gap-3 mb-4">
                <button
                  id="btn-analytical"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"
                >
                  Compute analytical n‑step distribution
                </button>
                <button
                  id="btn-montecarlo"
                  class="inline-flex items-center px-4 py-2 bg-emerald-600 text-white text-sm font-medium rounded-md hover:bg-emerald-700"
                >
                  Run Monte Carlo simulation
                </button>
                <button
                  id="btn-step-once"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-800 text-sm font-medium rounded-md hover:bg-gray-200"
                >
                  Step once
                </button>
                <button
                  id="btn-reset"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-800 text-sm font-medium rounded-md hover:bg-gray-200"
                >
                  Reset
                </button>
              </div>

              <div id="sim-status" class="text-xs text-gray-500 mb-2"></div>

              <div class="grid md:grid-cols-2 gap-4">
                <div>
                  <h3 class="text-sm font-semibold text-gray-800 mb-1">
                    Current distribution
                  </h3>
                  <div
                    id="current-dist"
                    class="text-sm bg-gray-50 border rounded-md p-3 min-h-[3rem]"
                  ></div>
                </div>
                <div>
                  <h3 class="text-sm font-semibold text-gray-800 mb-1">
                    Steady-state (stationary) distribution
                  </h3>
                  <div
                    id="steady-state"
                    class="text-sm bg-gray-50 border rounded-md p-3 min-h-[3rem]"
                  ></div>
                </div>
              </div>
            </section>

            <section aria-labelledby="mc-results-heading" class="mb-8">
              <h2 id="mc-results-heading" class="text-xl font-semibold mb-3">
                4. Results & visualization
              </h2>
              <div class="mb-4">
                <h3 class="text-sm font-semibold text-gray-800 mb-1">
                  n‑step distribution table
                </h3>
                <div class="scroll-x border rounded-md p-3">
                  <table
                    id="dist-table"
                    class="min-w-max text-xs border-collapse"
                  >
                    <!-- Filled by JS -->
                  </table>
                </div>
              </div>

              <div class="mb-4">
                <h3 class="text-sm font-semibold text-gray-800 mb-1">
                  Sample path (first path)
                </h3>
                <div
                  id="sample-path"
                  class="text-xs bg-gray-50 border rounded-md p-3 min-h-[2.5rem]"
                ></div>
              </div>

              <div>
                <h3 class="text-sm font-semibold text-gray-800 mb-1">
                  Bar chart of final distribution
                </h3>
                <canvas
                  id="dist-chart"
                  height="220"
                  class="w-full border rounded-md bg-white"
                ></canvas>
                <p class="text-xs text-gray-500 mt-1">
                  If both analytical and Monte Carlo results are available, both
                  are shown for comparison.
                </p>
              </div>
            </section>

            <section class="prose">
              <h2>How this Markov chain simulator works</h2>
              <p>
                This tool lets you define a finite Markov chain with a custom
                transition matrix, then:
              </p>
              <ul>
                <li>
                  Compute <strong>n‑step distributions</strong> analytically
                  using matrix powers.
                </li>
                <li>
                  Run <strong>Monte Carlo simulations</strong> of many random
                  paths.
                </li>
                <li>
                  Estimate the
                  <strong>steady‑state (stationary) distribution</strong>.
                </li>
                <li>
                  Inspect a <strong>sample path</strong> and compare analytical
                  vs simulated results.
                </li>
              </ul>

              <h3>Mathematical background</h3>
              <p>
                A (time‑homogeneous) Markov chain with finite state space \( S =
                \{1,\dots,m\} \) is defined by its transition matrix
              </p>
              <div class="formula-box">
                <code
                  >P = (p_{ij})_{i,j=1}^m, \quad p_{ij} = \Pr(X_{t+1} = j \mid
                  X_t = i)</code
                >
              </div>
              <p>Each row of \(P\) is a probability distribution, so</p>
              <div class="formula-box">
                <code
                  >p_{ij} \ge 0 \quad \text{and} \quad \sum_{j=1}^m p_{ij} = 1
                  \quad \text{for all } i.</code
                >
              </div>

              <h3>n‑step distribution</h3>
              <p>
                If the initial distribution is the row vector \( \pi^{(0)} \),
                then after \(n\) steps:
              </p>
              <div class="formula-box">
                <code>\pi^{(n)} = \pi^{(0)} P^n.</code>
              </div>
              <p>
                The simulator computes \(P^n\) numerically and multiplies it by
                the initial distribution to obtain \( \pi^{(n)} \).
              </p>

              <h3>Steady‑state (stationary) distribution</h3>
              <p>A stationary distribution \( \pi \) satisfies</p>
              <div class="formula-box">
                <code
                  >\pi = \pi P, \quad \sum_{i=1}^m \pi_i = 1, \quad \pi_i \ge
                  0.</code
                >
              </div>
              <p>
                When the chain is <em>irreducible</em> and <em>aperiodic</em>,
                the stationary distribution is unique and \( \pi^{(n)} \to \pi
                \) as \( n \to \infty \).
              </p>
              <p>
                Numerically, this tool approximates \( \pi \) by iterating \(
                \pi^{(k+1)} = \pi^{(k)} P \) from a uniform starting
                distribution until convergence.
              </p>

              <h3>Monte Carlo simulation</h3>
              <p>
                In Monte Carlo mode, the simulator generates many random paths
                \( X_0, X_1, \dots, X_n \) and estimates the distribution at
                each step by empirical frequencies:
              </p>
              <div class="formula-box">
                <code
                  >\hat{\pi}^{(t)}_j = \frac{1}{N} \sum_{k=1}^N
                  \mathbf{1}\{X_t^{(k)} = j\},</code
                >
              </div>
              <p>
                where \(N\) is the number of simulated paths. As \(N\) grows, \(
                \hat{\pi}^{(t)} \) converges to the true \( \pi^{(t)} \).
              </p>

              <h2>Tips for using the simulator</h2>
              <ul>
                <li>
                  Use the <strong>Load example</strong> button to see a simple
                  3‑state weather model.
                </li>
                <li>
                  Check the <strong>row sums</strong> of your matrix; the tool
                  will normalize them if needed.
                </li>
                <li>
                  Compare the <strong>analytical</strong> and
                  <strong>Monte Carlo</strong> bars in the chart to build
                  intuition.
                </li>
                <li>
                  Increase the number of paths if Monte Carlo results look
                  noisy.
                </li>
              </ul>
            </section>

            <section class="mt-8" id="faq">
              <h2 class="text-xl font-semibold mb-3">
                Markov chain simulator FAQ
              </h2>
              <div class="space-y-3">
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    What is a Markov chain?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    A Markov chain is a random process that moves between states
                    over time. The key property is that the probability of the
                    next state depends only on the current state, not on the
                    full history of how you got there. This is called the Markov
                    property.
                  </p>
                </details>
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    How should I enter the transition matrix?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Each row corresponds to the current state, and each column
                    to the next state. For example, the entry in row 2, column 3
                    is the probability of moving from state 2 to state 3 in one
                    step. Each row should sum to 1; if it does not, the
                    simulator will normalize it automatically before running.
                  </p>
                </details>
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Why do analytical and Monte Carlo results differ slightly?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Analytical results are computed exactly using matrix powers,
                    while Monte Carlo results are based on a finite number of
                    random simulations. Because of sampling variability, Monte
                    Carlo estimates will not match exactly, but they should get
                    closer as you increase the number of simulated paths.
                  </p>
                </details>
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    When does a steady‑state distribution exist?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    For a finite Markov chain, a unique steady‑state
                    distribution exists and is the limit of the n‑step
                    distributions if the chain is irreducible (you can reach any
                    state from any other) and aperiodic (it does not get trapped
                    in cycles of fixed length). If these conditions fail, the
                    simulator may still show a numerical “steady‑state” vector,
                    but it might not reflect a true limiting distribution.
                  </p>
                </details>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Markov, Chain, Simulator.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Core Math &amp; Algebra tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/probability"
                  class="text-blue-600 hover:underline"
                  >Probability</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/statistics"
                  class="text-blue-600 hover:underline"
                  >Statistics</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/central-limit-theorem"
                  class="text-blue-600 hover:underline"
                  >Central Limit Theorem</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/binomial-distribution"
                  class="text-blue-600 hover:underline"
                  >Binomial Distribution</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/poisson-distribution"
                  class="text-blue-600 hover:underline"
                  >Poisson Distribution</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/exponential-distribution"
                  class="text-blue-600 hover:underline"
                  >Exponential Distribution</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/markov-chain-simulator"
                  class="text-blue-600 hover:underline font-semibold"
                  >Markov Chain Simulator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/monte-carlo-simulation"
                  class="text-blue-600 hover:underline"
                  >Monte Carlo Simulation</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/linear-algebra"
                  class="text-blue-600 hover:underline"
                  >Linear Algebra</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/matrix"
                  class="text-blue-600 hover:underline"
                  >Matrix Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/eigenvalue-eigenvector"
                  class="text-blue-600 hover:underline"
                  >Eigenvalues &amp; Eigenvectors</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Math &amp; Conversions</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/categories/math-conversions"
                  class="text-blue-600 hover:underline"
                  >All Math &amp; Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/subcategories/core-math-algebra"
                  class="text-blue-600 hover:underline"
                  >Core Math &amp; Algebra</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/subcategories/geometry"
                  class="text-blue-600 hover:underline"
                  >Geometry</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/subcategories/math-conversions-measurement-unit-conversions"
                  class="text-blue-600 hover:underline"
                  >Measurement Unit Conversions</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
      // Utility: clamp and parse number
      function parseProb(value) {
        const x = parseFloat(value);
        if (isNaN(x) || x < 0) return 0;
        return x;
      }

      const state = {
        nStates: 3,
        stateNames: [],
        P: [],
        initialDist: [],
        currentDist: [],
        analyticalDistHistory: [],
        mcDistHistory: [],
        samplePath: [],
        chart: null,
      };

      const numStatesInput = document.getElementById("num-states");
      const applyNumStatesBtn = document.getElementById("apply-num-states");
      const loadExampleBtn = document.getElementById("load-example");
      const stateNamesContainer = document.getElementById(
        "state-names-container"
      );
      const matrixTable = document.getElementById("transition-matrix");
      const rowSumWarning = document.getElementById("row-sum-warning");
      const initialModeSelect = document.getElementById("initial-mode");
      const startStateSelect = document.getElementById("start-state");
      const singleStartContainer = document.getElementById(
        "single-start-container"
      );
      const customDistContainer = document.getElementById(
        "custom-dist-container"
      );
      const customDistInputs = document.getElementById("custom-dist-inputs");
      const numStepsInput = document.getElementById("num-steps");
      const numPathsInput = document.getElementById("num-paths");
      const btnAnalytical = document.getElementById("btn-analytical");
      const btnMonteCarlo = document.getElementById("btn-montecarlo");
      const btnStepOnce = document.getElementById("btn-step-once");
      const btnReset = document.getElementById("btn-reset");
      const simStatus = document.getElementById("sim-status");
      const currentDistDiv = document.getElementById("current-dist");
      const steadyStateDiv = document.getElementById("steady-state");
      const distTable = document.getElementById("dist-table");
      const samplePathDiv = document.getElementById("sample-path");
      const distChartCanvas = document.getElementById("dist-chart");

      function initState(n) {
        state.nStates = n;
        state.stateNames = Array.from({ length: n }, (_, i) => "S" + (i + 1));
        state.P = Array.from({ length: n }, () =>
          Array.from({ length: n }, () => 0)
        );
        for (let i = 0; i < n; i++) state.P[i][i] = 1 / n;
        state.initialDist = Array.from({ length: n }, () => 0);
        state.initialDist[0] = 1;
        state.currentDist = state.initialDist.slice();
        state.analyticalDistHistory = [];
        state.mcDistHistory = [];
        state.samplePath = [];
      }

      function renderStateNames() {
        stateNamesContainer.innerHTML = "";
        state.stateNames.forEach((name, i) => {
          const input = document.createElement("input");
          input.type = "text";
          input.value = name;
          input.className = "border rounded-md px-2 py-1 text-xs";
          input.dataset.index = i;
          input.addEventListener("input", () => {
            state.stateNames[i] = input.value.trim() || "S" + (i + 1);
            renderStartStateSelect();
            renderCustomDistInputs();
            updateAllDisplays();
          });
          stateNamesContainer.appendChild(input);
        });
      }

      function renderMatrix() {
        const n = state.nStates;
        matrixTable.innerHTML = "";
        const theadRow = document.createElement("tr");
        theadRow.appendChild(document.createElement("th"));
        for (let j = 0; j < n; j++) {
          const th = document.createElement("th");
          th.className = "border px-2 py-1 text-center text-xs bg-gray-50";
          th.textContent = state.stateNames[j];
          theadRow.appendChild(th);
        }
        matrixTable.appendChild(theadRow);

        for (let i = 0; i < n; i++) {
          const tr = document.createElement("tr");
          const rowHeader = document.createElement("th");
          rowHeader.className = "border px-2 py-1 text-xs bg-gray-50";
          rowHeader.textContent = state.stateNames[i];
          tr.appendChild(rowHeader);
          for (let j = 0; j < n; j++) {
            const td = document.createElement("td");
            td.className = "border px-1 py-1 text-center";
            const input = document.createElement("input");
            input.type = "number";
            input.step = "0.01";
            input.min = "0";
            input.className = "matrix-input border rounded px-1 py-0.5 text-xs";
            input.value = state.P[i][j].toFixed(2);
            input.dataset.row = i;
            input.dataset.col = j;
            input.addEventListener("input", handleMatrixChange);
            td.appendChild(input);
            tr.appendChild(td);
          }
          matrixTable.appendChild(tr);
        }
        checkRowSums();
      }

      function handleMatrixChange(e) {
        const i = parseInt(e.target.dataset.row, 10);
        const j = parseInt(e.target.dataset.col, 10);
        const val = parseProb(e.target.value);
        state.P[i][j] = val;
        checkRowSums();
      }

      function checkRowSums() {
        const n = state.nStates;
        let ok = true;
        for (let i = 0; i < n; i++) {
          const sum = state.P[i].reduce((a, b) => a + b, 0);
          if (Math.abs(sum - 1) > 1e-3) {
            ok = false;
            break;
          }
        }
        rowSumWarning.classList.toggle("hidden", ok);
      }

      function renderStartStateSelect() {
        startStateSelect.innerHTML = "";
        state.stateNames.forEach((name, i) => {
          const opt = document.createElement("option");
          opt.value = i;
          opt.textContent = name;
          startStateSelect.appendChild(opt);
        });
      }

      function renderCustomDistInputs() {
        customDistInputs.innerHTML = "";
        state.stateNames.forEach((name, i) => {
          const wrapper = document.createElement("div");
          wrapper.className = "flex items-center gap-1";
          const label = document.createElement("span");
          label.className = "text-xs text-gray-600";
          label.textContent = name + ":";
          const input = document.createElement("input");
          input.type = "number";
          input.step = "0.01";
          input.min = "0";
          input.value = state.initialDist[i] || 0;
          input.className = "w-16 border rounded px-1 py-0.5 text-xs";
          input.dataset.index = i;
          input.addEventListener("input", () => {
            const vals = [];
            for (let k = 0; k < state.nStates; k++) {
              const el = customDistInputs.querySelector(
                'input[data-index="' + k + '"]'
              );
              vals.push(parseProb(el.value));
            }
            const sum = vals.reduce((a, b) => a + b, 0);
            if (sum === 0) {
              state.initialDist = Array.from(
                { length: state.nStates },
                () => 0
              );
              state.initialDist[0] = 1;
            } else {
              state.initialDist = vals.map((v) => v / sum);
            }
            state.currentDist = state.initialDist.slice();
            updateAllDisplays();
          });
          wrapper.appendChild(label);
          wrapper.appendChild(input);
          customDistInputs.appendChild(wrapper);
        });
      }

      function getInitialDistribution() {
        const n = state.nStates;
        if (initialModeSelect.value === "single") {
          const idx = parseInt(startStateSelect.value, 10) || 0;
          const dist = Array.from({ length: n }, () => 0);
          dist[idx] = 1;
          return dist;
        } else {
          const vals = [];
          for (let i = 0; i < n; i++) {
            const el = customDistInputs.querySelector(
              'input[data-index="' + i + '"]'
            );
            vals.push(parseProb(el.value));
          }
          const sum = vals.reduce((a, b) => a + b, 0);
          if (sum === 0) {
            const dist = Array.from({ length: n }, () => 0);
            dist[0] = 1;
            return dist;
          }
          return vals.map((v) => v / sum);
        }
      }

      function normalizeRows(P) {
        const n = P.length;
        const Q = P.map((row) => row.slice());
        for (let i = 0; i < n; i++) {
          let sum = Q[i].reduce((a, b) => a + b, 0);
          if (sum <= 0) {
            const val = 1 / n;
            for (let j = 0; j < n; j++) Q[i][j] = val;
          } else {
            for (let j = 0; j < n; j++) Q[i][j] / sum;
          }
        }
        return Q;
      }

      function matMul(A, B) {
        const r = A.length,
          c = B[0].length,
          kLen = B.length;
        const C = Array.from({ length: r }, () =>
          Array.from({ length: c }, () => 0)
        );
        for (let i = 0; i < r; i++) {
          for (let k = 0; k < kLen; k++) {
            const aik = A[i][k];
            if (aik === 0) continue;
            for (let j = 0; j < c; j++) {
              C[i][j] += aik * B[k][j];
            }
          }
        }
        return C;
      }

      function matPow(P, n) {
        const size = P.length;
        let result = Array.from({ length: size }, (_, i) =>
          Array.from({ length: size }, (_, j) => (i === j ? 1 : 0))
        );
        let base = P.map((row) => row.slice());
        let exp = n;
        while (exp > 0) {
          if (exp % 2 === 1) {
            result = matMul(result, base);
          }
          base = matMul(base, base);
          exp = Math.floor(exp / 2);
        }
        return result;
      }

      function vecMatMul(v, M) {
        const n = M[0].length;
        const res = Array.from({ length: n }, () => 0);
        for (let j = 0; j < n; j++) {
          let sum = 0;
          for (let i = 0; i < v.length; i++) {
            sum += v[i] * M[i][j];
          }
          res[j] = sum;
        }
        return res;
      }

      function computeAnalytical() {
        const nSteps = Math.max(
          1,
          Math.min(200, parseInt(numStepsInput.value, 10) || 1)
        );
        numStepsInput.value = nSteps;
        const Pnorm = normalizeRows(state.P);
        const n = state.nStates;
        const pi0 = getInitialDistribution();
        state.initialDist = pi0.slice();
        state.currentDist = pi0.slice();
        state.analyticalDistHistory = [];
        let dist = pi0.slice();
        state.analyticalDistHistory.push(dist.slice());
        let Ppower = Pnorm.map((row) => row.slice());
        for (let t = 1; t <= nSteps; t++) {
          dist = vecMatMul(pi0, matPow(Pnorm, t));
          state.analyticalDistHistory.push(dist.slice());
        }
        state.currentDist =
          state.analyticalDistHistory[
            state.analyticalDistHistory.length - 1
          ].slice();
      }

      function simulateMonteCarlo() {
        const nSteps = Math.max(
          1,
          Math.min(200, parseInt(numStepsInput.value, 10) || 1)
        );
        const nPaths = Math.max(
          1,
          Math.min(20000, parseInt(numPathsInput.value, 10) || 1)
        );
        numStepsInput.value = nSteps;
        numPathsInput.value = nPaths;
        const Pnorm = normalizeRows(state.P);
        const n = state.nStates;
        const pi0 = getInitialDistribution();
        state.initialDist = pi0.slice();
        const distHistory = [];
        const counts = Array.from({ length: nSteps + 1 }, () =>
          Array.from({ length: n }, () => 0)
        );
        const cdf = Pnorm.map((row) => {
          const arr = [];
          let s = 0;
          for (let j = 0; j < n; j++) {
            s += row[j];
            arr.push(s);
          }
          return arr;
        });

        function sampleInitial() {
          const r = Math.random();
          let s = 0;
          for (let i = 0; i < n; i++) {
            s += pi0[i];
            if (r <= s) return i;
          }
          return n - 1;
        }

        function sampleNext(i) {
          const r = Math.random();
          const rowCdf = cdf[i];
          for (let j = 0; j < n; j++) {
            if (r <= rowCdf[j]) return j;
          }
          return n - 1;
        }

        let firstPath = [];
        for (let k = 0; k < nPaths; k++) {
          let x = sampleInitial();
          if (k === 0) firstPath.push(x);
          counts[0][x] += 1;
          for (let t = 1; t <= nSteps; t++) {
            x = sampleNext(x);
            if (k === 0) firstPath.push(x);
            counts[t][x] += 1;
          }
        }

        for (let t = 0; t <= nSteps; t++) {
          const dist = counts[t].map((c) => c / nPaths);
          distHistory.push(dist);
        }
        state.mcDistHistory = distHistory;
        state.samplePath = firstPath;
        state.currentDist = distHistory[distHistory.length - 1].slice();
      }

      function computeSteadyState() {
        const Pnorm = normalizeRows(state.P);
        const n = state.nStates;
        let pi = Array.from({ length: n }, () => 1 / n);
        const maxIter = 10000;
        const tol = 1e-10;
        for (let iter = 0; iter < maxIter; iter++) {
          const next = vecMatMul(pi, Pnorm);
          let diff = 0;
          for (let i = 0; i < n; i++) diff += Math.abs(next[i] - pi[i]);
          pi = next;
          if (diff < tol) break;
        }
        const sum = pi.reduce((a, b) => a + b, 0);
        if (sum > 0) pi = pi.map((v) => v / sum);
        return pi;
      }

      function formatDist(dist) {
        return dist
          .map((p, i) => {
            const name = state.stateNames[i];
            return name + ": " + (p * 100).toFixed(2) + "%";
          })
          .join("  |  ");
      }

      function updateCurrentDistDisplay() {
        currentDistDiv.textContent = formatDist(state.currentDist);
      }

      function updateSteadyStateDisplay() {
        const pi = computeSteadyState();
        steadyStateDiv.textContent = formatDist(pi);
      }

      function updateDistTable() {
        distTable.innerHTML = "";
        const hasAnalytical = state.analyticalDistHistory.length > 0;
        const hasMC = state.mcDistHistory.length > 0;
        if (!hasAnalytical && !hasMC) return;
        const nSteps = hasAnalytical
          ? state.analyticalDistHistory.length - 1
          : state.mcDistHistory.length - 1;
        const header = document.createElement("tr");
        ["Step", ...state.stateNames].forEach((text) => {
          const th = document.createElement("th");
          th.className = "border px-2 py-1 bg-gray-50";
          th.textContent = text;
          header.appendChild(th);
        });
        distTable.appendChild(header);
        for (let t = 0; t <= nSteps; t++) {
          const tr = document.createElement("tr");
          const stepCell = document.createElement("td");
          stepCell.className = "border px-2 py-1 text-center";
          stepCell.textContent = t;
          tr.appendChild(stepCell);
          const dist = hasAnalytical
            ? state.analyticalDistHistory[t]
            : state.mcDistHistory[t];
          for (let i = 0; i < state.nStates; i++) {
            const td = document.createElement("td");
            td.className = "border px-2 py-1 text-right";
            td.textContent = (dist[i] * 100).toFixed(2) + "%";
            tr.appendChild(td);
          }
          distTable.appendChild(tr);
        }
      }

      function updateSamplePathDisplay() {
        if (!state.samplePath || state.samplePath.length === 0) {
          samplePathDiv.textContent =
            "Run a Monte Carlo simulation to see a sample path.";
          return;
        }
        const labels = state.samplePath.map((idx) => state.stateNames[idx]);
        const steps = labels.map((name, t) => t + ": " + name);
        samplePathDiv.textContent = steps.join("  →  ");
      }

      function updateChart() {
        const labels = state.stateNames.slice();
        const analytical = state.analyticalDistHistory.length
          ? state.analyticalDistHistory[state.analyticalDistHistory.length - 1]
          : null;
        const mc = state.mcDistHistory.length
          ? state.mcDistHistory[state.mcDistHistory.length - 1]
          : null;

        const datasets = [];
        if (analytical) {
          datasets.push({
            label: "Analytical",
            data: analytical.map((p) => +(p * 100).toFixed(4)),
            backgroundColor: "rgba(37, 99, 235, 0.7)",
          });
        }
        if (mc) {
          datasets.push({
            label: "Monte Carlo",
            data: mc.map((p) => +(p * 100).toFixed(4)),
            backgroundColor: "rgba(16, 185, 129, 0.7)",
          });
        }
        if (!datasets.length) {
          if (state.chart) {
            state.chart.destroy();
            state.chart = null;
          }
          return;
        }

        if (state.chart) {
          state.chart.data.labels = labels;
          state.chart.data.datasets = datasets;
          state.chart.update();
        } else {
          state.chart = new Chart(distChartCanvas.getContext("2d"), {
            type: "bar",
            data: { labels, datasets },
            options: {
              responsive: true,
              scales: {
                y: {
                  beginAtZero: true,
                  ticks: { callback: (v) => v + "%" },
                  title: { display: true, text: "Probability (%)" },
                },
              },
            },
          });
        }
      }

      function updateAllDisplays() {
        updateCurrentDistDisplay();
        updateSteadyStateDisplay();
        updateDistTable();
        updateSamplePathDisplay();
        updateChart();
      }

      applyNumStatesBtn.addEventListener("click", () => {
        const n = Math.max(
          2,
          Math.min(8, parseInt(numStatesInput.value, 10) || 3)
        );
        numStatesInput.value = n;
        initState(n);
        renderStateNames();
        renderMatrix();
        renderStartStateSelect();
        renderCustomDistInputs();
        state.analyticalDistHistory = [];
        state.mcDistHistory = [];
        state.samplePath = [];
        simStatus.textContent = "";
        updateAllDisplays();
      });

      loadExampleBtn.addEventListener("click", () => {
        const n = 3;
        numStatesInput.value = n;
        initState(n);
        state.stateNames = ["Sunny", "Cloudy", "Rainy"];
        state.P = [
          [0.7, 0.2, 0.1],
          [0.3, 0.4, 0.3],
          [0.2, 0.3, 0.5],
        ];
        state.initialDist = [1, 0, 0];
        state.currentDist = state.initialDist.slice();
        renderStateNames();
        renderMatrix();
        renderStartStateSelect();
        renderCustomDistInputs();
        state.analyticalDistHistory = [];
        state.mcDistHistory = [];
        state.samplePath = [];
        simStatus.textContent = "Loaded example 3‑state weather model.";
        updateAllDisplays();
      });

      initialModeSelect.addEventListener("change", () => {
        const mode = initialModeSelect.value;
        if (mode === "single") {
          singleStartContainer.classList.remove("hidden");
          customDistContainer.classList.add("hidden");
        } else {
          singleStartContainer.classList.add("hidden");
          customDistContainer.classList.remove("hidden");
        }
      });

      btnAnalytical.addEventListener("click", () => {
        simStatus.textContent = "Computing analytical n‑step distribution...";
        setTimeout(() => {
          computeAnalytical();
          simStatus.textContent = "Analytical n‑step distribution computed.";
          updateAllDisplays();
        }, 10);
      });

      btnMonteCarlo.addEventListener("click", () => {
        simStatus.textContent = "Running Monte Carlo simulation...";
        setTimeout(() => {
          simulateMonteCarlo();
          simStatus.textContent = "Monte Carlo simulation completed.";
          updateAllDisplays();
        }, 10);
      });

      btnStepOnce.addEventListener("click", () => {
        const Pnorm = normalizeRows(state.P);
        state.currentDist = vecMatMul(state.currentDist, Pnorm);
        simStatus.textContent = "Advanced one step from current distribution.";
        updateAllDisplays();
      });

      btnReset.addEventListener("click", () => {
        state.currentDist = getInitialDistribution();
        state.analyticalDistHistory = [];
        state.mcDistHistory = [];
        state.samplePath = [];
        simStatus.textContent = "Reset to initial distribution.";
        updateAllDisplays();
      });

      // Initial setup
      initState(3);
      renderStateNames();
      renderMatrix();
      renderStartStateSelect();
      renderCustomDistInputs();
      updateAllDisplays;

      // Mobile menu script (from template)
      document
        .getElementById("mobile-menu-toggle")
        .addEventListener("click", function () {
          const menu = document.getElementById("mobile-menu");
          const expanded = this.getAttribute("aria-expanded") === "true";
          this.setAttribute("aria-expanded", String(!expanded));
          menu.classList.toggle("hidden");
        });
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

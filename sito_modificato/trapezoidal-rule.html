<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Trapezoidal Rule Calculator – Numerical Integration from Functions or Data</title>
    <meta name="description" content="Trapezoidal rule calculator for numerical integration. Approximate definite integrals from a function f(x) or from data points, see step size, composite formula, grid table, and interpretation.">
    <link rel="canonical" href="https://calcdomain.com/trapezoidal-rule">
    
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .card-hover { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .formula-box { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; overflow-x: auto; margin: 1rem 0; }
        code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
        .table-scroll { max-height: 260px; overflow: auto; }
        .data-table th, .data-table td { border: 1px solid #e5e7eb; padding: 0.25rem 0.4rem; font-size: 0.75rem; }
        .data-table { border-collapse: collapse; min-width: 100%; }
        .mode-pill { font-size: 0.7rem; padding: 0.15rem 0.45rem; border-radius: 9999px; background: #eff6ff; color: #1d4ed8; border: 1px solid #bfdbfe; }
    </style>
    
    <!-- HEAD_SCRIPTS_E_META -->
    <!-- Google tag (gtag.js) -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-7MB5V1LZRN');
    </script>

    <meta name="google-site-verification" content="_tiTZ9ivAdtXcAS9CMnTNJ549Sg39WVqP_ZFbWgglNA">

    <script src="https://cmp.gatekeeperconsent.com/min.js" data-cfasync="false"></script>
    <script src="https://the.gatekeeperconsent.com/cmp.min.js" data-cfasync="false"></script>

    <script async="" src="//www.ezojs.com/ezoic/sa.min.js"></script>
    <script>
        window.ezstandalone = window.ezstandalone || {};
        ezstandalone.cmd = ezstandalone.cmd || [];
    </script>

    <script type="application/ld+json">
[
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://calcdomain.com"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Math & Conversions",
        "item": "https://calcdomain.com/categories/math-conversions"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Core Math Algebra",
        "item": "https://calcdomain.com/subcategories/core-math-algebra"
      }
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is the trapezoidal rule?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The trapezoidal rule is a numerical integration method that approximates the definite integral of a function by replacing the region under the graph with trapezoids instead of exact curvilinear area. On an equally spaced grid from a to b with step size h and values f(x0), f(x1), ..., f(xn), the composite trapezoidal rule is given by ∫_a^b f(x) dx ≈ h/2 · (f(x0) + 2 Σ f(xi) + f(xn))."
        }
      },
      {
        "@type": "Question",
        "name": "When should I use the trapezoidal rule instead of Simpson’s rule?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The trapezoidal rule is a good default for quick estimates, irregular grids, or when you have tabulated data rather than a closed-form function. Simpson’s rule is usually more accurate for smooth functions when the integrand is well-approximated by quadratics and you have an even number of subintervals. However, the trapezoidal rule is easier to derive, easier to implement, and works directly with nonuniform data points."
        }
      },
      {
        "@type": "Question",
        "name": "How accurate is the trapezoidal rule?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "For a smooth function with a continuous second derivative, the global error of the composite trapezoidal rule on an evenly spaced grid is proportional to (b − a) · h^2 · max|f''(x)|/12, where h is the step size. This means that halving the step size h (doubling the number of subintervals) typically reduces the error by roughly a factor of 4, assuming the function behaves regularly."
        }
      },
      {
        "@type": "Question",
        "name": "Can I apply the trapezoidal rule directly to experimental data?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes. One of the main strengths of the trapezoidal rule is that it applies directly to tabulated data (xi, yi) without requiring a formula for the underlying function. The data-based mode of this calculator sorts your x-values, checks spacing, and then computes the sum over each adjacent pair of points. You should still check that the sampling is dense enough and reasonably covers the region of interest."
        }
      },
      {
        "@type": "Question",
        "name": "How does this trapezoidal rule calculator work?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "In function mode, you supply a function f(x), the integration limits a and b, and the number of subintervals n. The tool builds an equally spaced grid, evaluates f(x) at each grid point using JavaScript’s Math library, and applies the composite trapezoidal formula. In data mode, you provide pairs (xi, yi); the tool sorts them by xi and integrates over each interval using the basic trapezoid area (xi+1 − xi) · (yi + yi+1)/2."
        }
      }
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to use the trapezoidal rule calculator",
    "description": "Step-by-step instructions for approximating definite integrals from a function or from tabulated data using the trapezoidal rule.",
    "step": [
      {
        "@type": "HowToStep",
        "name": "Choose calculation mode",
        "text": "Select Function-based (equally spaced grid) if you know f(x), or Data points if you have measured or tabulated values (xi, yi)."
      },
      {
        "@type": "HowToStep",
        "name": "Enter limits or data",
        "text": "In function mode, enter the lower limit a, upper limit b, number of subintervals n, and the function expression f(x). In data mode, fill the table with your (x, f(x)) pairs; empty rows are ignored."
      },
      {
        "@type": "HowToStep",
        "name": "Run the trapezoidal rule",
        "text": "Click Calculate. The tool evaluates f(x) on the grid or uses your data points and computes the trapezoidal approximation, the effective step size, and a detailed grid table."
      },
      {
        "@type": "HowToStep",
        "name": "Interpret the result and refine",
        "text": "Review the numerical result and grid table. If you need higher accuracy, increase the number of subintervals or collect more data points, and recompute until the value stabilizes to the precision you need."
      }
    ]
  }
]
</script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
.auditspine-badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  border:1px solid #e5e7eb;
  background:#f8fafc;
  color:#0f172a;
}
.auditspine-badge-warn{
  background:#fff7ed;
  border-color:#fed7aa;
  color:#9a3412;
}
</style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- BODY_SCRIPTS_INIZIO -->
    <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939" crossorigin="anonymous"></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
              <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      
      <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo; <a href="https://calcdomain.com/categories/math-conversions" class="hover:text-blue-600">Math & Conversions</a> &raquo; <a href="https://calcdomain.com/subcategories/core-math-algebra" class="hover:text-blue-600">Core Math Algebra</a></nav>
      
      <div class="flex flex-col lg:flex-row gap-8">
        
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">Trapezoidal Rule Calculator – Numerical Integration</h1>
              <p class="text-gray-700">
                Approximate definite integrals using the trapezoidal rule. Work from a function \(f(x)\) on an equally spaced grid or from tabulated data points \((x_i, f(x_i))\).
              </p>
              <p class="mt-2 text-xs text-gray-500">
                Designed for calculus students, instructors, and engineers who need a transparent, step-by-step numerical integration tool.
              </p>
            </header>

            <!-- Trapezoidal rule calculator -->
            <section aria-label="Trapezoidal rule calculator" class="mb-8">
              <div class="flex flex-wrap items-center justify-between gap-2 mb-3">
                <h2 class="text-xl font-semibold">Trapezoidal rule calculator</h2>
                <span class="mode-pill">Composite &amp; data-based trapezoidal rule</span>
              </div>
              <p class="text-sm text-gray-700 mb-3">
                Choose the calculation mode, fill in the inputs, and click <span class="font-semibold">Calculate</span>.
                The tool reports the trapezoidal approximation, effective step size, and a detailed grid table.
              </p>

              <fieldset class="mb-4">
                <legend class="block text-sm font-medium text-gray-700 mb-1">Calculation mode</legend>
                <div class="flex flex-col sm:flex-row gap-3 text-sm">
                  <label class="inline-flex items-center">
                    <input type="radio" name="trap-mode" value="function" id="trap-mode-function" class="mr-2" checked="">
                    <span>Function-based (equally spaced grid)</span>
                  </label>
                  <label class="inline-flex items-center">
                    <input type="radio" name="trap-mode" value="data" id="trap-mode-data" class="mr-2">
                    <span>Data points \((x_i, f(x_i))\)</span>
                  </label>
                </div>
              </fieldset>

              <!-- Function-based mode -->
              <div id="trap-function-panel" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label for="trap-a" class="block text-sm font-medium text-gray-700 mb-1">
                      Lower limit a
                    </label>
                    <input id="trap-a" type="number" step="any" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., 0">
                  </div>
                  <div>
                    <label for="trap-b" class="block text-sm font-medium text-gray-700 mb-1">
                      Upper limit b
                    </label>
                    <input id="trap-b" type="number" step="any" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., 1">
                  </div>
                  <div>
                    <label for="trap-n" class="block text-sm font-medium text-gray-700 mb-1">
                      Number of subintervals n
                    </label>
                    <input id="trap-n" type="number" step="1" min="1" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., 8">
                    <p class="mt-1 text-xs text-gray-500">
                      n ≥ 1. A larger n gives a finer grid and usually better accuracy.
                    </p>
                  </div>
                </div>

                <div>
                  <label for="trap-fx" class="block text-sm font-medium text-gray-700 mb-1">
                    Function \(f(x)\)
                  </label>
                  <input id="trap-fx" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., sin(x) + x^2">
                  <p class="mt-1 text-xs text-gray-500">
                    Use standard notation. The calculator automatically maps
                    <span class="font-mono">sin, cos, tan, exp, ln, log, sqrt, abs, pi, e</span>
                    to JavaScript’s <span class="font-mono">Math.*</span> functions and interprets <span class="font-mono">^</span> as a power operator.
                  </p>
                </div>
              </div>

              <!-- Data-based mode -->
              <div id="trap-data-panel" class="space-y-3 mt-4 hidden">
                <p class="text-sm text-gray-700">
                  Enter pairs \((x_i, f(x_i))\). Empty rows are ignored. The tool sorts your points by x and applies the basic trapezoid formula on each interval.
                </p>
                <div class="flex items-center gap-3 text-sm">
                  <label class="inline-flex items-center">
                    Number of data points:
                    <input id="trap-data-count" type="number" min="2" max="20" step="1" value="6" class="ml-2 w-20 border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                  </label>
                  <button id="trap-data-rebuild" type="button" class="inline-flex items-center px-3 py-1.5 rounded-md border border-gray-300 text-xs text-gray-700 hover:bg-gray-50">
                    Update table
                  </button>
                </div>
                <div id="trap-data-table-container" class="table-scroll mt-2">
                  <!-- Dynamic data table -->
                </div>
              </div>

              <div class="flex flex-wrap items-center gap-3 mt-4 mb-4">
                <button id="trap-calc-btn" type="button" class="inline-flex items-center px-4 py-2 rounded-md bg-blue-600 text-white text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Calculate
                </button>
                <button id="trap-clear-btn" type="button" class="inline-flex items-center px-3 py-2 rounded-md border border-gray-300 text-sm text-gray-700 hover:bg-gray-50">
                  Clear
                </button>
                <span class="text-xs text-gray-500">
                  Numerical tolerance for diagnostics: <span class="font-mono">1e-12</span>
                </span>
              </div>

              <div id="trap-result" class="bg-gray-50 border border-gray-200 rounded-md p-4 text-sm text-gray-800 min-h-[4rem]" aria-live="polite">
                <p class="text-gray-500">
                  The trapezoidal approximation and grid table will appear here after you click
                  <span class="font-semibold">Calculate</span>.
                </p>
              </div>
            </section>

            <!-- Theory & guide -->
            <section class="prose mt-8">
              <h2>Understanding the trapezoidal rule</h2>
              <p>
                The trapezoidal rule is one of the simplest and most widely used numerical integration formulas.
                Instead of computing the exact area under the curve \(y = f(x)\), you approximate the graph with straight-line
                segments and sum the areas of the resulting trapezoids.
              </p>

              <h3>1. Basic trapezoid formula</h3>
              <p>
                On a single interval \([x_i, x_{i+1}]\) with function values \(f(x_i)\) and \(f(x_{i+1})\), the area of the trapezoid is:
              </p>
              <div class="formula-box text-sm">
                \[
                  \int_{x_i}^{x_{i+1}} f(x)\,dx \approx
                  \frac{x_{i+1} - x_i}{2}\,\bigl(f(x_i) + f(x_{i+1})\bigr).
                \]
              </div>
              <p>
                This formula works whether your data come from a function or from measurements. The only requirement is that you know the
                x-coordinates and the corresponding function (or measured) values.
              </p>

              <h3>2. Composite trapezoidal rule on an equally spaced grid</h3>
              <p>
                If you divide \([a, b]\) into \(n\) equal subintervals of width \(h = \frac{b-a}{n}\), with grid points
                \(x_0 = a, x_1, \dots, x_n = b\), the composite trapezoidal rule is:
              </p>
              <div class="formula-box text-sm">
                \[
                  \int_a^b f(x)\,dx \approx \frac{h}{2}
                  \left[f(x_0) + 2\sum_{i=1}^{n-1} f(x_i) + f(x_n)\right].
                \]
              </div>
              <p>
                The function-based mode of this calculator builds exactly this grid, evaluates \(f(x_i)\) at each point, and applies the formula.
              </p>

              <h3>3. Error behavior</h3>
              <p>
                If \(f\) has a continuous second derivative on \([a, b]\), the global error of the composite trapezoidal rule satisfies
              </p>
              <div class="formula-box text-sm">
                \[
                  \text{Error} \approx -\frac{(b - a)}{12} h^2\, f''(\xi)
                  \quad \text{for some} \;\xi \in (a, b).
                \]
              </div>
              <p>
                This shows a quadratic dependence on the step size \(h\): halving \(h\) (doubling the number of subintervals) typically reduces the error
                by roughly a factor of 4, provided \(f\) is smooth enough and does not oscillate too wildly.
              </p>

              <h3>4. Trapezoidal rule vs. Simpson’s rule</h3>
              <p>
                Simpson’s rule uses quadratic interpolation on pairs of subintervals and generally achieves higher accuracy (error proportional to \(h^4\))
                for smooth integrands. The trapezoidal rule, however, has important advantages:
              </p>
              <ul>
                <li>It works directly with tabulated data and nonuniform x-spacing.</li>
                <li>It is easy to implement and explain in a classroom setting.</li>
                <li>It is often sufficient for engineering estimates and quick checks.</li>
              </ul>
              <p>
                In practice, you can use the trapezoidal rule to get a first estimate, then refine or cross-check with Simpson’s rule when it is available.
              </p>
            </section>

            <!-- FAQ visible section -->
            <section class="mt-8" id="faq">
              <h2 class="text-xl font-semibold mb-4">Trapezoidal rule – FAQ</h2>
              <div class="space-y-3" id="faq-container">
                <article class="border border-gray-200 rounded-md p-3">
                  <button type="button" class="w-full text-left flex justify-between items-center faq-question">
                    <span class="font-medium text-sm">How should I enter a function like sin(x) or e<sup>−x²</sup>?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer mt-2 text-sm text-gray-700 hidden">
                    You can type expressions such as <span class="font-mono">sin(x)</span>, <span class="font-mono">cos(x)</span>,
                    <span class="font-mono">exp(-x^2)</span>, or <span class="font-mono">sqrt(1 + x^2)</span>. The calculator automatically converts
                    common functions to JavaScript’s <span class="font-mono">Math.*</span> equivalents and interprets
                    <span class="font-mono">^</span> as a power operator. If needed, you can always write the expression explicitly,
                    for example <span class="font-mono">Math.sin(x)</span> or <span class="font-mono">Math.exp(-x*x)</span>.
                  </div>
                
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\int_{x_i}^{x_{i+1}} f(x)\,dx \approx \frac{x_{i+1} - x_i}{2}\,\bigl(f(x_i) + f(x_{i+1})\bigr).\]</div>
  <pre class="auditspine-mono">\int_{x_i}^{x_{i+1}} f(x)\,dx \approx \frac{x_{i+1} - x_i}{2}\,\bigl(f(x_i) + f(x_{i+1})\bigr).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\int_a^b f(x)\,dx \approx \frac{h}{2} \left[f(x_0) + 2\sum_{i=1}^{n-1} f(x_i) + f(x_n)\right].\]</div>
  <pre class="auditspine-mono">\int_a^b f(x)\,dx \approx \frac{h}{2} \left[f(x_0) + 2\sum_{i=1}^{n-1} f(x_i) + f(x_n)\right].</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\text{Error} \approx -\frac{(b - a)}{12} h^2\, f''(\xi) \quad \text{for some} \;\xi \in (a, b).\]</div>
  <pre class="auditspine-mono">\text{Error} \approx -\frac{(b - a)}{12} h^2\, f''(\xi) \quad \text{for some} \;\xi \in (a, b).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\\]</div>
  <pre class="auditspine-mono">','\</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ \int_{x_i}^{x_{i+1}} f(x)\,dx \approx \frac{x_{i+1} - x_i}{2}\,\bigl(f(x_i) + f(x_{i+1})\bigr). \]</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ \int_a^b f(x)\,dx \approx \frac{h}{2} \left[f(x_0) + 2\sum_{i=1}^{n-1} f(x_i) + f(x_n)\right]. \]</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ \text{Error} \approx -\frac{(b - a)}{12} h^2\, f''(\xi) \quad \text{for some} \;\xi \in (a, b). \]</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><span class="auditspine-mono">T</span> = property tax (annual or monthly depending on input) <em>(currency)</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>NIST — Weights and measures</strong> — nist.gov · Accessed 2026-01-19<br><a href="https://www.nist.gov/pml/weights-and-measures" target="_blank" rel="nofollow noopener">https://www.nist.gov/pml/weights-and-measures</a></li>
<li><strong>FTC — Consumer advice</strong> — consumer.ftc.gov · Accessed 2026-01-19<br><a href="https://consumer.ftc.gov/" target="_blank" rel="nofollow noopener">https://consumer.ftc.gov/</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>

                <article class="border border-gray-200 rounded-md p-3">
                  <button type="button" class="w-full text-left flex justify-between items-center faq-question">
                    <span class="font-medium text-sm">What happens if the function has a discontinuity inside [a, b]?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer mt-2 text-sm text-gray-700 hidden">
                    The trapezoidal rule assumes that the function is reasonably well-behaved on the interval.
                    If there is a jump or vertical asymptote, the approximation may be seriously misleading.
                    In such cases you should split the integral at the discontinuity (if the improper integral makes sense)
                    or use a method tailored for improper integrals and compare results carefully.
                  </div>
                </article>

                <article class="border border-gray-200 rounded-md p-3">
                  <button type="button" class="w-full text-left flex justify-between items-center faq-question">
                    <span class="font-medium text-sm">Can this tool tell me the exact integration error?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer mt-2 text-sm text-gray-700 hidden">
                    No. The exact error depends on the second derivative of the function, which is generally unknown when you use numerical integration.
                    The tool reports step size and grid, so you can repeat the computation with a finer grid and compare values. The difference between
                    two successive refinements is often a good indicator of the remaining error in practical work.
                  </div>
                </article>
              </div>
            </section>

          </div>
        </main>
        
        <aside class="w-full lg:w-1/3">
          <div class="space-y-6">
            <section class="bg-white rounded-lg shadow-md p-4">
              <h2 class="text-lg font-semibold mb-3">Core Math &amp; Algebra tools</h2>
              <ul class="space-y-2 text-sm">
                <li><a href="https://calcdomain.com/set-operations" class="text-blue-600 hover:underline">Set Operations</a></li>
                <li><a href="https://calcdomain.com/arithmetic-sequence" class="text-blue-600 hover:underline">Arithmetic Sequence</a></li>
                <li><a href="https://calcdomain.com/linear-regression" class="text-blue-600 hover:underline">Linear Regression</a></li>
                <li><a href="https://calcdomain.com/modular-arithmetic" class="text-blue-600 hover:underline">Modular Arithmetic</a></li>
                <li><a href="https://calcdomain.com/equation-solver" class="text-blue-600 hover:underline">Equation Solver</a></li>
                <li><a href="https://calcdomain.com/circular-segment-area" class="text-blue-600 hover:underline">Circular Segment Area</a></li>
                <li><a href="https://calcdomain.com/trig-identity" class="text-blue-600 hover:underline">Trig Identity Explorer</a></li>
                <li><a href="https://calcdomain.com/hyperbolic-function" class="text-blue-600 hover:underline">Hyperbolic Function Explorer</a></li>
                <li><a href="https://calcdomain.com/linear-algebra" class="text-blue-600 hover:underline">Linear Algebra Toolbox</a></li>
                <li class="text-gray-500">Trapezoidal Rule Calculator (you are here)</li>
                <li><a href="https://calcdomain.com/perfect-number" class="text-blue-600 hover:underline">Perfect Number Checker</a></li>
                <li><a href="https://calcdomain.com/chinese-remainder-theorem" class="text-blue-600 hover:underline">Chinese Remainder Theorem</a></li>
              </ul>
            </section>

            <section class="bg-white rounded-lg shadow-md p-4">
              <h2 class="text-lg font-semibold mb-3">Number theory &amp; calculus helpers</h2>
              <ul class="space-y-2 text-sm">
                <li><a href="https://calcdomain.com/set-theory" class="text-blue-600 hover:underline">Set Theory Basics</a></li>
                <li><a href="https://calcdomain.com/base-converter" class="text-blue-600 hover:underline">Base Converter</a></li>
                <li><a href="https://calcdomain.com/interval-notation" class="text-blue-600 hover:underline">Interval Notation Helper</a></li>
                <li><a href="https://calcdomain.com/pythagorean-theorem" class="text-blue-600 hover:underline">Pythagorean Theorem</a></li>
                <li><a href="https://calcdomain.com/convolution" class="text-blue-600 hover:underline">Convolution Explorer</a></li>
                <li><a href="https://calcdomain.com/dice-roll-probability" class="text-blue-600 hover:underline">Dice Roll Probability</a></li>
              </ul>
            </section>

            <section class="bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm">
              <h2 class="text-base font-semibold mb-2 text-blue-800">Professional use note</h2>
              <p class="text-blue-900">
                This trapezoidal rule calculator is suited for teaching, study, and quick engineering estimates.
                For safety-critical or regulatory calculations, repeat the computations with independent numerical software
                and verify that results are stable with respect to step size and data quality.
              </p>
            </section>
          </div>
        </aside>
        
      </div>
    </div> 

    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.</p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction &amp; DIY</a></li>
          <li><a href="https://calcdomain.com/categories/coordinate-converters" class="text-gray-400 hover:text-white">Coordinate Converters</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health &amp; Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle &amp; Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math &amp; Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
              <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
              <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
              <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
              <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
              <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
              <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
              <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
              <li><a href="https://calcdomain.com/sitemap" class="text-gray-400 hover:text-white">Site Map</a></li>
            </ul>
          </div>
        </div>
        <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
          <p>© 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
        </div>
      </div>
    </footer>
    
    <!-- Calculator-specific JS -->
    <script>
      // Mobile menu toggle
      const mobileToggle = document.getElementById('mobile-menu-toggle');
      const mobileMenu = document.getElementById('mobile-menu');
      if (mobileToggle && mobileMenu) {
        mobileToggle.addEventListener('click', () => {
          const expanded = mobileToggle.getAttribute('aria-expanded') === 'true';
          mobileToggle.setAttribute('aria-expanded', String(!expanded));
          mobileMenu.classList.toggle('hidden');
        });
      }

      const trapModeFunction = document.getElementById('trap-mode-function');
      const trapModeData = document.getElementById('trap-mode-data');
      const trapFunctionPanel = document.getElementById('trap-function-panel');
      const trapDataPanel = document.getElementById('trap-data-panel');
      const trapResult = document.getElementById('trap-result');

      const trapA = document.getElementById('trap-a');
      const trapB = document.getElementById('trap-b');
      const trapN = document.getElementById('trap-n');
      const trapFx = document.getElementById('trap-fx');

      const trapDataCount = document.getElementById('trap-data-count');
      const trapDataRebuild = document.getElementById('trap-data-rebuild');
      const trapDataTableContainer = document.getElementById('trap-data-table-container');

      const trapCalcBtn = document.getElementById('trap-calc-btn');
      const trapClearBtn = document.getElementById('trap-clear-btn');

      function formatNumber(x) {
        if (!isFinite(x)) return 'NaN';
        const absx = Math.abs(x);
        if (absx !== 0 && (absx < 1e-8 || absx > 1e9)) {
          return x.toExponential(8);
        }
        return x.toFixed(10).replace(/\.?0+$/,'');
      }

      function showTrapError(msg) {
        if (!trapResult) return;
        trapResult.innerHTML = '<p class="text-red-600 text-sm">' + msg + '</p>';
      }

      function buildDataTable(count) {
        const n = Math.max(2, Math.min(20, parseInt(count, 10) || 6));
        if (trapDataCount) trapDataCount.value = n;

        let html = '<table class="data-table text-xs w-full">';
        html += '<thead class="bg-gray-100"><tr><th>x</th><th>f(x)</th></tr></thead><tbody>';
        for (let i = 0; i < n; i++) {
          const xId = 'trap-x-' + i;
          const yId = 'trap-y-' + i;
          html += '<tr>';
          html += '<td><input type="number" step="any" id="' + xId + '" class="w-24 border border-gray-300 rounded px-1 py-0.5 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500" /></td>';
          html += '<td><input type="number" step="any" id="' + yId + '" class="w-24 border border-gray-300 rounded px-1 py-0.5 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500" /></td>';
          html += '</tr>';
        }
        html += '</tbody></table>';
        trapDataTableContainer.innerHTML = html;

        // Simple demo fill
        // Prefill with a small example on first build (e.g., y = x^2 on [0,1])
        const firstX = document.getElementById('trap-x-0');
        if (firstX && !firstX.value) {
          for (let i = 0; i < n; i++) {
            const xVal = i / (n - 1);
            const xInput = document.getElementById('trap-x-' + i);
            const yInput = document.getElementById('trap-y-' + i);
            if (xInput) xInput.value = xVal.toFixed(3);
            if (yInput) yInput.value = (xVal * xVal).toFixed(5);
          }
        }
      }

      function readDataPoints() {
        const points = [];
        const n = parseInt(trapDataCount.value, 10) || 6;
        for (let i = 0; i < n; i++) {
          const xInput = document.getElementById('trap-x-' + i);
          const yInput = document.getElementById('trap-y-' + i);
          if (!xInput || !yInput) continue;
          const xs = xInput.value.trim();
          const ys = yInput.value.trim();
          if (xs === '' && ys === '') continue;
          const x = parseFloat(xs);
          const y = parseFloat(ys);
          if (!isFinite(x) || !isFinite(y)) {
            showTrapError('Please enter valid numeric x and f(x) values, or leave rows completely empty.');
            return null;
          }
          points.push({ x, y });
        }
        if (points.length < 2) {
          showTrapError('Enter at least two valid data points to apply the trapezoidal rule.');
          return null;
        }
        // Sort by x
        points.sort((a, b) => a.x - b.x);
        return points;
      }

      function preprocessFunctionExpression(expr) {
        let s = expr.trim();
        if (!s) return null;

        // Replace power operator ^ with ** (basic, not precedence-aware but works for most inputs)
        s = s.replace(/\^/g, '**');

        // Map common function names to Math.*
        const funs = ['sin','cos','tan','asin','acos','atan','sinh','cosh','tanh',
                      'exp','sqrt','abs','log','ln'];
        funs.forEach(fn => {
          const re = new RegExp('\\b' + fn + '\\s*\\(', 'gi');
          if (fn === 'ln') {
            s = s.replace(re, 'Math.log(');
          } else if (fn === 'log') {
            s = s.replace(re, 'Math.log(');
          } else if (fn === 'sinh' || fn === 'cosh' || fn === 'tanh') {
            // Use Math.sinh/cosh/tanh if available; otherwise define via exp in evaluation
            s = s.replace(re, 'Math.' + fn + '(');
          } else {
            s = s.replace(re, 'Math.' + fn + '(');
          }
        });

        // Constants pi and e
        s = s.replace(/\bpi\b/gi, 'Math.PI');
        s = s.replace(/\be\b/g, 'Math.E');

        return s;
      }

      function buildFunctionEvaluator(expr) {
        const processed = preprocessFunctionExpression(expr);
        if (!processed) return null;

        // Fallback for sinh/cosh/tanh if not available (older engines) – define inside function scope
        const body =
          '"use strict";' +
          'const sinh = Math.sinh || function(z){return (Math.exp(z)-Math.exp(-z))/2;};' +
          'const cosh = Math.cosh || function(z){return (Math.exp(z)+Math.exp(-z))/2;};' +
          'const tanh = Math.tanh || function(z){var e1=Math.exp(z), e2=Math.exp(-z);return (e1-e2)/(e1+e2);};' +
          'return (' + processed + ');';

        try {
          // eslint-disable-next-line no-new-func
          const fn = new Function('x', body);
          // Test evaluation at x=0
          const testVal = fn(0);
          if (!isFinite(testVal) && testVal !== 0) {
            // Not necessarily an error, but we accept it; domain issues may arise later
          }
          return fn;
        } catch (e) {
          return null;
        }
      }

      function calculateFunctionMode() {
        const a = parseFloat(trapA.value);
        const b = parseFloat(trapB.value);
        let n = parseInt(trapN.value, 10);

        if (!isFinite(a) || !isFinite(b)) {
          showTrapError('Please enter valid numeric values for a and b.');
          return;
        }
        if (!isFinite(n) || n < 1) {
          showTrapError('Number of subintervals n must be an integer ≥ 1.');
          return;
        }
        const expr = trapFx.value;
        if (!expr.trim()) {
          showTrapError('Please enter a function f(x).');
          return;
        }

        const f = buildFunctionEvaluator(expr);
        if (!f) {
          showTrapError('The function expression could not be parsed. Check parentheses and syntax.');
          return;
        }

        const h = (b - a) / n;
        if (h === 0) {
          showTrapError('The interval length b − a is zero. Use distinct integration limits.');
          return;
        }

        const xs = [];
        const fs = [];
        let errorOccurred = false;

        for (let i = 0; i <= n; i++) {
          const x = a + i * h;
          let y;
          try {
            y = f(x);
          } catch (e) {
            errorOccurred = true;
            break;
          }
          if (!isFinite(y)) {
            errorOccurred = true;
            break;
          }
          xs.push(x);
          fs.push(y);
        }

        if (errorOccurred) {
          showTrapError('Evaluating f(x) failed or produced non-finite values on the integration grid. Check the domain of your function.');
          return;
        }

        // Composite trapezoidal rule
        let sum = fs[0] + fs[n];
        for (let i = 1; i < n; i++) {
          sum += 2 * fs[i];
        }
        const approx = (h / 2) * sum;

        // Render result
        let html = '<div class="space-y-3">';
        html += '<p><span class="font-semibold">Mode:</span> Function-based composite trapezoidal rule</p>';
        html += '<p><span class="font-semibold">Interval:</span> [<span class="font-mono">' + formatNumber(a) +
                '</span>, <span class="font-mono">' + formatNumber(b) + '</span>]</p>';
        html += '<p><span class="font-semibold">Subintervals n:</span> <span class="font-mono">' + n + '</span> ';
        html += '(<span class="font-semibold">step size h:</span> <span class="font-mono">' + formatNumber(h) + '</span>)</p>';
        html += '<p><span class="font-semibold">Trapezoidal approximation:</span> ';
        html += '<span class="font-mono">∫_' + formatNumber(a) + '^' + formatNumber(b) + ' f(x) dx ≈ ' +
                formatNumber(approx) + '</span></p>';

        html += '<p class="text-xs text-gray-600">Formula used: T = h/2 · (f(x₀) + 2 Σ f(xᵢ) + f(xₙ)), with an equally spaced grid xᵢ = a + i·h.</p>';

        // Table of grid points
        html += '<div class="mt-3">';
        html += '<p class="font-semibold text-sm mb-1">Grid points and function values</p>';
        html += '<div class="table-scroll"><table class="data-table">';
        html += '<thead class="bg-gray-100"><tr><th>i</th><th>xᵢ</th><th>f(xᵢ)</th></tr></thead><tbody>';
        for (let i = 0; i <= n; i++) {
          html += '<tr>';
          html += '<td class="font-mono">' + i + '</td>';
          html += '<td class="font-mono">' + formatNumber(xs[i]) + '</td>';
          html += '<td class="font-mono">' + formatNumber(fs[i]) + '</td>';
          html += '</tr>';
        }
        html += '</tbody></table></div>';
        html += '</div>';

        html += '<p class="mt-2 text-xs text-gray-500">To assess accuracy, recompute with a larger n and compare results. If the value stabilizes, the approximation is likely adequate for most practical purposes.</p>';
        html += '</div>';

        trapResult.innerHTML = html;
      }

      function calculateDataMode() {
        const points = readDataPoints();
        if (!points) return;

        let sum = 0;
        const segments = [];
        for (let i = 0; i < points.length - 1; i++) {
          const x0 = points[i].x;
          const x1 = points[i+1].x;
          const y0 = points[i].y;
          const y1 = points[i+1].y;
          const dx = x1 - x0;
          if (dx === 0) {
            showTrapError('At least two of your x-values are identical. For the trapezoidal rule, x-values must be strictly increasing.');
            return;
          }
          const area = (dx / 2) * (y0 + y1);
          sum += area;
          segments.push({ i, x0, x1, y0, y1, dx, area });
        }

        let html = '<div class="space-y-3">';
        html += '<p><span class="font-semibold">Mode:</span> Data-based trapezoidal rule on tabulated points</p>';
        html += '<p><span class="font-semibold">Data points used:</span> <span class="font-mono">' + points.length + '</span></p>';
        html += '<p><span class="font-semibold">Approximate integral (sum of trapezoid areas):</span> ';
        html += '<span class="font-mono">' + formatNumber(sum) + '</span></p>';

        html += '<div class="mt-3">';
        html += '<p class="font-semibold text-sm mb-1">Trapezoid contributions per interval</p>';
        html += '<div class="table-scroll"><table class="data-table">';
        html += '<thead class="bg-gray-100"><tr><th>Interval</th><th>xᵢ</th><th>xᵢ₊₁</th><th>Δx</th><th>f(xᵢ)</th><th>f(xᵢ₊₁)</th><th>Area</th></tr></thead><tbody>';
        segments.forEach(seg => {
          html += '<tr>';
          html += '<td class="font-mono">[' + seg.i + ', ' + (seg.i + 1) + ']</td>';
          html += '<td class="font-mono">' + formatNumber(seg.x0) + '</td>';
          html += '<td class="font-mono">' + formatNumber(seg.x1) + '</td>';
          html += '<td class="font-mono">' + formatNumber(seg.dx) + '</td>';
          html += '<td class="font-mono">' + formatNumber(seg.y0) + '</td>';
          html += '<td class="font-mono">' + formatNumber(seg.y1) + '</td>';
          html += '<td class="font-mono">' + formatNumber(seg.area) + '</td>';
          html += '</tr>';
        });
        html += '</tbody></table></div>';
        html += '</div>';

        html += '<p class="mt-2 text-xs text-gray-500">This approximation assumes that the function is reasonably linear between consecutive data points. If your measurements are sparse or very noisy, consider collecting more points or applying smoothing before integration.</p>';

        html += '</div>';
        trapResult.innerHTML = html;
      }

      function calculateTrapezoidal() {
        if (!trapResult) return;
        const mode = trapModeData && trapModeData.checked ? 'data' : 'function';
        if (mode === 'function') {
          calculateFunctionMode();
        } else {
          calculateDataMode();
        }
      }

      // Mode switching
      if (trapModeFunction && trapModeData && trapFunctionPanel && trapDataPanel) {
        trapModeFunction.addEventListener('change', () => {
          if (trapModeFunction.checked) {
            trapFunctionPanel.classList.remove('hidden');
            trapDataPanel.classList.add('hidden');
          }
        });
        trapModeData.addEventListener('change', () => {
          if (trapModeData.checked) {
            trapFunctionPanel.classList.add('hidden');
            trapDataPanel.classList.remove('hidden');
          }
        });
      }

      // Data table rebuild
      if (trapDataRebuild) {
        trapDataRebuild.addEventListener('click', () => {
          buildDataTable(trapDataCount.value);
          if (trapResult) {
            trapResult.innerHTML = '<p class="text-gray-500">The trapezoidal approximation and grid table will appear here after you click <span class="font-semibold">Calculate</span>.</p>';
          }
        });
      }

      // Initial data table
      document.addEventListener('DOMContentLoaded', () => {
        if (trapDataTableContainer) {
          buildDataTable(trapDataCount ? trapDataCount.value : 6);
        }
      });

      // Calculate / clear
      if (trapCalcBtn) {
        trapCalcBtn.addEventListener('click', calculateTrapezoidal);
      }

      if (trapClearBtn) {
        trapClearBtn.addEventListener('click', () => {
          if (trapA) trapA.value = '';
          if (trapB) trapB.value = '';
          if (trapN) trapN.value = '';
          if (trapFx) trapFx.value = '';
          if (trapDataCount) trapDataCount.value = 6;
          if (trapDataTableContainer) buildDataTable(6);
          if (trapResult) {
            trapResult.innerHTML = '<p class="text-gray-500">The trapezoidal approximation and grid table will appear here after you click <span class="font-semibold">Calculate</span>.</p>';
          }
        });
      }

      // FAQ toggle
      document.querySelectorAll('#faq-container .faq-question').forEach(btn => {
        btn.addEventListener('click', () => {
          const answer = btn.parentElement.querySelector('.faq-answer');
          if (!answer) return;
          const isHidden = answer.classList.contains('hidden');
          answer.classList.toggle('hidden', !isHidden);
          const icon = btn.querySelector('span:last-child');
          if (icon) icon.textContent = isHidden ? '−' : '+';
        });
      });
    </script>

    <script src="/assets/js/script_menu.js" defer=""></script>
    <script src="/assets/js/script_faq.js" defer=""></script>
    <script src="search.js" defer=""></script>

    <script>
      window.MathJax = {
        tex: { inlineMath: [['\\(','\\)'], ['$', '$']], displayMath: [['$','$'], ['\\[','\\]']] },
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    



</body></html>
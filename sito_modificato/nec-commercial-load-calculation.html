<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/nec-commercial-load-calculation">





 
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">
<meta charset="utf-8">
<title>NEC Service Load Calculator (Non-Dwelling) | CalcDomain</title>
<meta content="width=device-width,initial-scale=1" name="viewport">
<meta content="NEC commercial load calculation made easy. Compute non-dwelling service loads per NEC Article 220 with an accessible, mobile-first calculator. Includes lighting, receptacles, motors (largest at 125%), and noncoincident HVAC." name="description">
<meta content="Ugo Candido" name="author">

<meta content="#ffffff" name="theme-color">
<meta content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" name="robots">
<meta content="nec commercial load calculation, non-dwelling service load, NEC Article 220, electrical load calculator" name="keywords">
<!-- Open Graph -->
<meta content="NEC Service Load Calculator (Non-Dwelling)" property="og:title">
<meta content="Compute non-dwelling service loads per NEC Article 220. Lighting, receptacles, motors, HVAC and signage with demand factors." property="og:description">
<meta content="website" property="og:type">
<meta content="https://calcdomain.com/nec-commercial-load-calculation" property="og:url">
<!-- Critical, mobile-first CSS (no external fonts for performance) -->
<style>
    /* Design tokens */
    :root{
      --primary:#005A9C; --primary-2:#003F6E; --accent:#00A4E4;
      --bg:#F8F9FA; --surface:#FFFFFF; --text:#212529; --muted:#6C757D;
      --border:#DEE2E6; --success:#198754; --error:#DC3545;
      --radius:12px; --radius-sm:8px; --pad:clamp(.75rem,2.5vw,1rem);
      --shadow:0 2px 6px rgba(0,0,0,.06);
      --touch:48px;
    }
    @media (prefers-reduced-motion: reduce){
      *,*::before,*::after{animation:none!important;transition:none!important;scroll-behavior:auto!important}
    }
    *{box-sizing:border-box}
    html{font-size:clamp(16px,2.4vw,18px)}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;-webkit-font-smoothing:antialiased}
    a{color:var(--primary);text-decoration:none}
    a:hover{text-decoration:underline}
    a:focus{outline:3px solid var(--primary);outline-offset:2px}
    h1,h2,h3{color:var(--primary-2);line-height:1.25;margin:.25rem 0 .75rem}
    h1{font-size:clamp(1.6rem,5vw,2.4rem)}
    h2{font-size:clamp(1.3rem,3.6vw,1.8rem)}
    h3{font-size:clamp(1.15rem,3vw,1.4rem)}
    p{margin:.5rem 0 1rem;max-width:70ch}
    code,.mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    .container{max-width:1200px;margin:0 auto;padding:0 clamp(1rem,4vw,2rem)}
    .skip-link{position:absolute;left:8px;top:-40px;background:var(--primary);color:#fff;padding:.5rem .75rem;border-radius:0 0 6px 6px;z-index:1000}
    .skip-link:focus{top:0}

    /* Header (non-sticky per requirements) */
    .site-header{background:var(--surface);border-bottom:1px solid var(--border);box-shadow:var(--shadow)}
    .header-content{display:grid;grid-template-columns:auto 1fr auto;gap:.75rem;align-items:center;padding:.75rem 0}
    .logo{font-weight:700;color:var(--primary);font-size:1.1rem}
    .site-search{display:flex;gap:.5rem;align-items:center}
    .site-search input{flex:1 1 auto;min-width:0;padding:.6rem .75rem;border:1px solid var(--border);border-radius:8px}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:.35rem;padding:var(--pad) 1rem;border-radius:10px;border:1px solid transparent;min-height:var(--touch);min-width:var(--touch);cursor:pointer;font-weight:600}
    .btn-primary{background:var(--primary);color:#fff;border-color:var(--primary)}
    .btn-secondary{background:transparent;color:var(--primary);border-color:var(--primary)}
    .nav-toggle{appearance:none;background:transparent;border:1px solid var(--border);border-radius:10px;padding:.6rem .75rem;min-height:var(--touch);cursor:pointer}
    .main-nav{display:none}
    .main-content{padding:1.25rem 0 2.5rem}

    /* Calculator layout */
    .calculator-layout{display:grid;grid-template-columns:1fr;gap:1.5rem;margin-top:.5rem}
    @media (min-width: 992px){
      .calculator-layout{grid-template-columns:420px 1fr}
    }
    .card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:clamp(1rem,3vw,1.5rem);box-shadow:var(--shadow)}
    .form-group{margin-bottom:1rem}
    .form-group label{display:block;font-weight:700;margin-bottom:.4rem}
    .tip-inline{display:inline-flex;gap:.5rem;align-items:center}
    .tooltip-btn{margin-left:.5rem;inline-size:var(--touch);block-size:var(--touch);min-inline-size:var(--touch);min-block-size:var(--touch);display:inline-flex;align-items:center;justify-content:center;font-weight:700;border-radius:50%;border:1px solid var(--border);background:#fff;color:var(--primary);cursor:pointer}
    .tooltip-btn:focus{outline:3px solid var(--primary);outline-offset:2px}
    .tooltip{margin:.5rem 0 .25rem;background:#eef6ff;border:1px solid #cfe8ff;border-radius:8px;padding:.5rem .75rem;color:#0b4b7a}
    .input-group{position:relative}
    .suffix{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);color:var(--muted);pointer-events:none}
    .form-control{width:100%;min-height:var(--touch);padding:.65rem 2.25rem .65rem .75rem;border:1px solid var(--border);border-radius:8px}
    .form-control:focus{outline:3px solid var(--primary);outline-offset:2px;border-color:var(--primary)}
    .form-control[aria-invalid="true"]{border-color:var(--error)}
    .error-message{color:var(--error);font-size:.9rem;margin-top:.3rem}
    fieldset{border:1px solid var(--border);border-radius:10px;padding:.75rem}
    legend{font-weight:700;padding:0 .5rem;color:var(--primary-2)}
    .radio-group{display:flex;gap:.5rem;flex-wrap:wrap}
    .radio-group label{display:flex;align-items:center;gap:.5rem;border:1px solid var(--border);border-radius:8px;padding:.45rem .6rem;cursor:pointer;min-height:var(--touch)}
    .radio-group input{accent-color:var(--primary)}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
    @media (max-width: 520px){.grid-2{grid-template-columns:1fr}}
    .results{margin-top:1rem;background:#fbfbfc;border:1px solid var(--border);border-radius:10px;padding:1rem;min-height:260px}
    .result-row{display:flex;justify-content:space-between;align-items:center;padding:.45rem 0;border-bottom:1px solid #eceff3}
    .result-row:last-child{border-bottom:none}
    .result-label{color:var(--muted)}
    .result-value{font-weight:800;color:var(--success)}
    .subtle{color:var(--muted);font-size:.95rem}
    .divider{height:1px;background:var(--border);margin:1rem 0}

    /* Content area */
    .content-container h2{border-bottom:1px solid var(--border);padding-bottom:.35rem;margin-top:1.25rem}
    .formula-box{background:#f1f3f5;border:1px solid #e3e7eb;border-radius:10px;padding:1rem;margin:.75rem 0;font-size:1.05rem}
    .glossary{display:grid;grid-template-columns:1fr;gap:.35rem}
    .glossary dt{font-weight:700}
    .glossary dd{margin:0 0 .5rem 0}
    .author-box{margin-top:1.5rem;padding-top:1rem;border-top:1px solid var(--border);color:var(--muted);font-size:.95rem}

    /* Footer */
    .site-footer{background:var(--primary-2);color:#fff;margin-top:2rem}
    .site-footer a{color:#fff}
    .footer-content{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;padding:1.25rem 0}
    .footer-bottom{text-align:center;padding:1rem;border-top:1px solid rgba(255,255,255,.25);font-size:.95rem}
    .kbd{display:inline-block;border:1px solid #cbd3da;border-bottom-width:3px;border-radius:6px;background:#fff;color:#111;padding:.1rem .35rem;font-weight:700}
  </style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "NEC Service Load Calculator (Non-Dwelling)",
  "description": "Professional-grade calculator for NEC commercial load calculations (non-dwelling). Compute service loads per NEC Article 220: lighting, receptacles with demand factors, noncoincident HVAC, and motors (largest at 125%).",
  "url": "https://calcdomain.com/nec-commercial-load-calculation",
  "inLanguage": "en",
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  },
  "dateModified": "2025-09-14",
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "How It Works: A Step-by-Step Example",
      "description": "Step through a realistic non-dwelling service load calculation using NEC Article 220 methods.",
      "supply": [
        {
          "@type": "HowToSupply",
          "name": "Floor area in ft²"
        },
        {
          "@type": "HowToSupply",
          "name": "Unit lighting load (VA/ft²) per NEC 220.12"
        },
        {
          "@type": "HowToSupply",
          "name": "Receptacle count or known VA (180 VA/outlet minimum)"
        },
        {
          "@type": "HowToSupply",
          "name": "Cooling and heating loads (noncoincident per 220.50)"
        },
        {
          "@type": "HowToSupply",
          "name": "Motor loads (apply 125% to largest per 430.24)"
        }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "name": "Lighting load",
          "text": "Compute VA = Area × Unit load. Optionally apply demand factors and 125% for continuous lighting."
        },
        {
          "@type": "HowToStep",
          "name": "Receptacle load",
          "text": "Use 180 VA per outlet or known VA. Optionally apply Table 220.44 (first 10 kVA at 100%, remainder at 50%)."
        },
        {
          "@type": "HowToStep",
          "name": "Noncoincident HVAC",
          "text": "Enter both cooling and heating; take the larger per NEC 220.50."
        },
        {
          "@type": "HowToStep",
          "name": "Motors",
          "text": "Sum all motor loads and add 25% of the largest motor per NEC 430.24."
        },
        {
          "@type": "HowToStep",
          "name": "Total and current",
          "text": "Sum all VA components to kVA, then compute line current based on the service voltage system selected."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Does the calculator apply noncoincident loads for HVAC?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Per NEC 220.50, the tool takes the larger of the entered cooling or heating loads."
          }
        },
        {
          "@type": "Question",
          "name": "How are receptacle demand factors handled?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "You can apply NEC Table 220.44 automatically (first 10 kVA at 100%, remainder at 50%) or set a custom demand percentage."
          }
        },
        {
          "@type": "Question",
          "name": "Are lighting loads treated as continuous?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "You can optionally apply 125% to general lighting for continuous load scenarios. Consult project requirements and NEC Article 100 definitions."
          }
        },
        {
          "@type": "Question",
          "name": "How are motor loads aggregated?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Motors are summed at 100% plus an additional 25% adder on the largest motor per NEC 430.24 for feeders and services with multiple motors."
          }
        },
        {
          "@type": "Question",
          "name": "Does the tool size the main OCPD or conductors?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. It reports calculated load kVA and line current. OCPD and conductor sizing require additional NEC sections (e.g., Article 240, 310, 430) and engineering judgment."
          }
        },
        {
          "@type": "Question",
          "name": "Can I change unit loads for different occupancies?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Enter the unit lighting load (VA/ft²) per NEC 220.12 for your occupancy. Local amendments may apply."
          }
        },
        {
          "@type": "Question",
          "name": "Is this calculator suitable for dwellings?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. This tool targets non-dwelling (commercial/industrial) occupancies. Dwelling unit calculations use different demand factors and tables."
          }
        }
      ]
    }
  ]
}
</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer=""></script>
<!-- MathJax for LaTeX formulas -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\(','\)'], ['$', '$']],
      displayMath: [['$','$'], ['\[','\]']]
    },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="preload" href="/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="/assets/js/page-enhancements.js" as="script">


<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "General",
      "item": "https://calcdomain.com/categories/general"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Miscellaneous",
      "item": "https://calcdomain.com/subcategories/miscellaneous"
    }
  ]
}
</script>
</head>
<body>
<a class="skip-link" href="#maincontent">Skip to main content</a>

<main class="main-content" id="maincontent" role="main">
<div class="container">
<nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo; <a href="https://calcdomain.com/categories/general" class="hover:text-blue-600">General</a> &raquo; <a href="https://calcdomain.com/subcategories/miscellaneous" class="hover:text-blue-600">Miscellaneous</a></nav>
<h1>NEC Service Load Calculator (Non-Dwelling)</h1>
<p>This professional calculator helps electrical engineers, designers, and inspectors perform NEC commercial load calculations for non-dwelling occupancies. It consolidates general lighting, receptacles (with demand factors), noncoincident HVAC, and motors (largest at 125%) to produce total kVA and service current for common voltage systems.</p>
<div class="calculator-layout">
<!-- Calculator -->
<section aria-labelledby="calc-heading" class="card" id="calculator">
<h2 id="calc-heading" style="margin-top:0">Calculator</h2>
<!-- System selection -->
<div class="form-group">
<label for="systemSelect">Service voltage system *</label>
<div class="input-group">
<select aria-describedby="systemHelp systemError" aria-required="true" class="form-control" id="systemSelect">
<option selected="" value="1P-240">1-Phase 120/240 V (3-wire)</option>
<option value="3P-208">3-Phase 120/208 V (wye)</option>
<option value="3P-480">3-Phase 277/480 V (wye)</option>
<option value="1P-208">1-Phase 120/208 V</option>
</select>
</div>
<div class="subtle" id="systemHelp">Used only to compute line current. kVA calculations are system-agnostic.</div>
<div aria-live="polite" class="error-message" id="systemError" role="alert"></div>
</div>
<div aria-hidden="true" class="divider" role="separator"></div>
<!-- General lighting -->
<fieldset class="form-group">
<legend>General lighting (NEC 220.12)</legend>
<div class="grid-2">
<div class="form-group">
<label class="tip-inline" for="area">
                  Floor area *
                  <button aria-controls="tip-area" aria-expanded="false" aria-label="Toggle floor area help" class="tooltip-btn" type="button">?</button>
</label>
<div class="input-group">
<input aria-describedby="tip-area areaError areaUnitNote" aria-required="true" class="form-control" id="area" inputmode="decimal" min="0" placeholder="e.g., 5000" step="0.01" type="number">
<span class="suffix" id="areaUnit">ft²</span>
</div>
<div class="tooltip" hidden="" id="tip-area">
                  Enter gross area served by the service. Use the unit toggle to switch ft²/m²; the tool converts internally.
                </div>
<div class="subtle" id="areaUnitNote">Currently using ft². Toggle unit below if needed.</div>
<div aria-live="polite" class="error-message" id="areaError" role="alert"></div>
</div>
<div class="form-group">
<label class="tip-inline" for="unitLoad">
                  Unit lighting load (VA/ft²) *
                  <button aria-controls="tip-unitload" aria-expanded="false" aria-label="Toggle unit lighting load help" class="tooltip-btn" type="button">?</button>
</label>
<div class="input-group">
<input aria-describedby="tip-unitload unitLoadError" aria-required="true" class="form-control" id="unitLoad" inputmode="decimal" min="0" placeholder="Enter per NEC 220.12 for occupancy" step="0.01" type="number">
<span class="suffix">VA/ft²</span>
</div>
<div class="tooltip" hidden="" id="tip-unitload">
                  Provide the unit load from NEC 220.12 for the specific occupancy (e.g., offices, retail, warehouse). Local amendments may apply.
                </div>
<div aria-live="polite" class="error-message" id="unitLoadError" role="alert"></div>
</div>
</div>
<div class="grid-2">
<div class="form-group">
<label class="tip-inline" for="lightDemand">
                  Lighting demand factor (%)
                  <button aria-controls="tip-lightdf" aria-expanded="false" aria-label="Toggle lighting demand factor help" class="tooltip-btn" type="button">?</button>
</label>
<div class="input-group">
<input aria-describedby="tip-lightdf lightDemandError" class="form-control" id="lightDemand" max="100" min="0" step="1" type="number" value="100">
<span class="suffix">%</span>
</div>
<div class="tooltip" hidden="" id="tip-lightdf">
                  Apply NEC demand factor for the calculated general lighting portion where permitted by Article 220 (check occupancy-specific rules).
                </div>
<div aria-live="polite" class="error-message" id="lightDemandError" role="alert"></div>
</div>
<div class="form-group">
<div class="tip-inline" style="display:flex;align-items:center;gap:.5rem">
<input aria-describedby="tip-cont lightContinuousError" id="lightContinuous" type="checkbox">
<label for="lightContinuous">Treat general lighting as continuous (125%)</label>
<button aria-controls="tip-cont" aria-expanded="false" aria-label="Toggle continuous load help" class="tooltip-btn" type="button">?</button>
</div>
<div class="tooltip" hidden="" id="tip-cont">
                  When applicable, multiply general lighting by 125% for continuous loading per NEC definitions and 215/230 rules.
                </div>
<div aria-live="polite" class="error-message" id="lightContinuousError" role="alert"></div>
</div>
</div>
<div class="form-group">
<label for="areaUnitToggle">Area unit</label>
<div aria-labelledby="areaUnitToggle" class="radio-group" role="radiogroup">
<input checked="" id="unit-ft2" name="areaUnit" type="radio" value="ft2">
<label for="unit-ft2">ft²</label>
<input id="unit-m2" name="areaUnit" type="radio" value="m2">
<label for="unit-m2">m²</label>
</div>
</div>
</fieldset>
<div aria-hidden="true" class="divider" role="separator"></div>
<!-- Receptacles -->
<fieldset class="form-group">
<legend>General-use receptacles (NEC 220.14, 220.44)</legend>
<div class="form-group">
<div aria-label="Receptacle input mode" class="radio-group" role="radiogroup">
<input checked="" id="recModeCount" name="recMode" type="radio" value="count">
<label for="recModeCount">Count outlets × 180 VA</label>
<input id="recModeKnown" name="recMode" type="radio" value="known">
<label for="recModeKnown">Enter known VA</label>
</div>
</div>
<div class="form-group" id="recCountWrap">
<label class="tip-inline" for="recCount">
                Number of receptacle outlets
                <button aria-controls="tip-rec" aria-expanded="false" aria-label="Toggle receptacle help" class="tooltip-btn" type="button">?</button>
</label>
<div class="input-group">
<input aria-describedby="tip-rec recCountError" class="form-control" id="recCount" min="0" step="1" type="number" value="0">
</div>
<div class="tooltip" hidden="" id="tip-rec">
                Use 180 VA per strap or per duplex per NEC 220.14(I) unless otherwise specified. For unknown quantity in banks/offices, consult 220.14(J).
              </div>
<div aria-live="polite" class="error-message" id="recCountError" role="alert"></div>
</div>
<div class="form-group" hidden="" id="recKnownWrap">
<label for="recKnown">Known receptacle load (VA)</label>
<div class="input-group">
<input aria-describedby="recKnownError" class="form-control" id="recKnown" min="0" step="1" type="number" value="0">
<span class="suffix">VA</span>
</div>
<div aria-live="polite" class="error-message" id="recKnownError" role="alert"></div>
</div>
<div class="grid-2">
<div class="form-group">
<div class="tip-inline" style="display:flex;align-items:center;gap:.5rem">
<input aria-describedby="tip-22044" checked="" id="use22044" type="checkbox">
<label for="use22044">Apply Table 220.44 (non-dwelling receptacle demand)</label>
<button aria-controls="tip-22044" aria-expanded="false" aria-label="Toggle 220.44 help" class="tooltip-btn" type="button">?</button>
</div>
<div class="tooltip" hidden="" id="tip-22044">
                  Applies first 10 kVA at 100%, remainder at 50% for non-dwelling receptacle loads per NEC Table 220.44, where permitted.
                </div>
</div>
<div class="form-group">
<label for="recDemand">Custom receptacle demand (%)</label>
<div class="input-group">
<input aria-describedby="recDemandError" class="form-control" id="recDemand" max="100" min="0" step="1" type="number" value="100">
<span class="suffix">%</span>
</div>
<div aria-live="polite" class="error-message" id="recDemandError" role="alert"></div>
<div class="subtle">Ignored when Table 220.44 is applied.</div>
</div>
</div>
</fieldset>
<div aria-hidden="true" class="divider" role="separator"></div>
<!-- Signage & show windows -->
<fieldset class="form-group">
<legend>Signage and show windows</legend>
<div class="grid-2">
<div class="form-group">
<label class="tip-inline" for="signVA">
                  Sign circuit load (VA)
                  <button aria-controls="tip-sign" aria-expanded="false" aria-label="Toggle signage help" class="tooltip-btn" type="button">?</button>
</label>
<div class="input-group">
<input aria-describedby="tip-sign signVAError" class="form-control" id="signVA" min="0" step="1" type="number" value="1200">
<span class="suffix">VA</span>
</div>
<div class="tooltip" hidden="" id="tip-sign">
                  NEC 600.5(A) typically requires at least one 20 A sign circuit; 1200 VA is a common minimum allowance for service calculations when actual load is unknown.
                </div>
<div aria-live="polite" class="error-message" id="signVAError" role="alert"></div>
</div>
<div class="form-group">
<label for="showWindowVA">Show window lighting (VA)</label>
<div class="input-group">
<input aria-describedby="showWindowVAError" class="form-control" id="showWindowVA" min="0" step="1" type="number" value="0">
<span class="suffix">VA</span>
</div>
<div aria-live="polite" class="error-message" id="showWindowVAError" role="alert"></div>
</div>
</div>
</fieldset>
<div aria-hidden="true" class="divider" role="separator"></div>
<!-- HVAC noncoincident -->
<fieldset class="form-group">
<legend>HVAC (noncoincident per 220.50)</legend>
<div class="grid-2">
<div class="form-group">
<label for="coolVA">Cooling load (VA)</label>
<div class="input-group">
<input aria-describedby="coolVAError" class="form-control" id="coolVA" min="0" step="1" type="number" value="0">
<span class="suffix">VA</span>
</div>
<div aria-live="polite" class="error-message" id="coolVAError" role="alert"></div>
</div>
<div class="form-group">
<label for="heatVA">Heating load (VA)</label>
<div class="input-group">
<input aria-describedby="heatVAError" class="form-control" id="heatVA" min="0" step="1" type="number" value="0">
<span class="suffix">VA</span>
</div>
<div aria-live="polite" class="error-message" id="heatVAError" role="alert"></div>
</div>
</div>
<div class="subtle">The calculator automatically uses the larger of cooling or heating.</div>
</fieldset>
<div aria-hidden="true" class="divider" role="separator"></div>
<!-- Motors -->
<fieldset class="form-group">
<legend>Motors (NEC 430.24)</legend>
<div class="subtle" id="motorNote">Enter running load per motor in kVA. The tool sums all motors and adds 25% of the largest motor.</div>
<div aria-live="polite" class="form-group" id="motorList">
<!-- Dynamic motor rows -->
</div>
<div class="grid-2">
<button aria-label="Add motor row" class="btn btn-secondary" id="addMotor" type="button">Add motor</button>
<button aria-label="Clear motors" class="btn" id="clearMotors" style="border:1px solid var(--border)" type="button">Clear motors</button>
</div>
</fieldset>
<div aria-hidden="true" class="divider" role="separator"></div>
<!-- Actions -->
<div class="grid-2">
<button aria-label="Load example values" class="btn btn-secondary" id="loadExample" type="button">Load example</button>
<button aria-label="Reset all inputs" class="btn" id="resetAll" style="border:1px solid var(--border)" type="button">Reset</button>
</div>
<!-- Results -->
<section aria-labelledby="resultsHeading" class="results">
<h3 id="resultsHeading" style="margin-top:0">Results</h3>
<div class="result-row"><span class="result-label">Lighting (demanded)</span><span class="result-value" id="resLight">0.00 kVA</span></div>
<div class="result-row"><span class="result-label">Receptacles (demanded)</span><span class="result-value" id="resRecept">0.00 kVA</span></div>
<div class="result-row"><span class="result-label">Signage + Show window</span><span class="result-value" id="resSign">0.00 kVA</span></div>
<div class="result-row"><span class="result-label">HVAC (larger of heat/cool)</span><span class="result-value" id="resHVAC">0.00 kVA</span></div>
<div class="result-row"><span class="result-label">Motors (incl. +25% largest)</span><span class="result-value" id="resMotors">0.00 kVA</span></div>
<div class="result-row"><strong>Total calculated load</strong><strong id="resTotal">0.00 kVA</strong></div>
<div class="result-row"><span class="result-label">Calculated service current</span><span class="result-value" id="resAmps">0.00 A</span></div>
<div aria-live="polite" class="subtle" id="resNote" role="status">Update inputs to see results. No data is stored.</div>
</section>
</section>
<!-- Content / Authority -->
<article class="content-container">
<section>
<h2>Authoritative Data Source and Methodology</h2>
<p><strong>Primary Code Reference:</strong> NFPA 70 — National Electrical Code (NEC), Article 220 (Branch-Circuit, Feeder, and Service Calculations), Articles 430 (Motors) and 600 (Electric Signs). Latest adopted edition in your jurisdiction governs. Official access via NFPA: <a href="https://www.nfpa.org/codes-and-standards/all-codes-and-standards/list-of-codes-and-standards/detail?code=70" rel="nofollow noopener" target="_blank">NFPA 70</a>.</p>
<ul>
<li>NEC 220.12 — Lighting Loads for Specified Occupancies (unit VA/ft² by occupancy)</li>
<li>NEC 220.14 — Other Loads — Including Receptacles (180 VA per outlet minimum in many cases)</li>
<li>NEC 220.44 — Receptacle Load Demand Factors (non-dwelling)</li>
<li>NEC 220.50 — Noncoincident Loads (take the larger of heating vs cooling)</li>
<li>NEC 430.24 — Feeders/Services Supplying Multiple Motors (add 25% of largest motor)</li>
<li>NEC 600.5(A) — Sign branch-circuit requirements</li>
</ul>
<p>Secondary reading (industry guidance): <a href="https://www.ecmweb.com/content/article/20897051/commercial-electrical-load-calculations" rel="noopener" target="_blank">Commercial Electrical Load Calculations (EC&amp;M)</a>.</p>
<p><strong>Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</strong></p>
</section>
<section>
<h2>The Formulas Explained</h2>
<div aria-label="Calculation formulas" class="formula-box">
<p>Lighting VA (raw): L_raw = A × U</p>
<p>Lighting VA (demanded): L = L_raw × (D_L / 100) × C_L</p>
<p>Receptacles VA (count mode): R_raw = N × 180</p>
<p>Receptacles VA (known): R_raw = R_known</p>
<p>Receptacles VA (demand per Table 220.44): R = 10,000 + 0.5 × max(0, R_raw − 10,000)</p>
<p>Receptacles VA (custom %): R = R_raw × (D_R / 100)</p>
<p>HVAC VA (noncoincident): H = max(H_cool, H_heat)</p>
<p>Motors VA: M = (Σ m_i) + 0.25 × max(m_i)</p>
<p>Total kVA: kVA_total = (L + R + S + W + H + M) / 1000</p>
<p>Current (single-phase): I = VA_total / V_L-L</p>
<p>Current (3-phase): I = VA_total / (√3 × V_L-L)</p>
</div>
<p class="subtle">Where: A = area (ft²), U = unit lighting load (VA/ft²), D_L = lighting demand (%), C_L = 1.25 if continuous else 1.00, N = receptacle outlets, S = signage VA, W = show window VA.</p>
</section>
<section>
<h2>Glossary of Variables</h2>
<dl class="glossary">
<dt>Area (A)</dt><dd>Gross floor area served by the service (ft² or m² converted to ft²).</dd>
<dt>Unit lighting load (U)</dt><dd>VA/ft² from NEC 220.12 for the occupancy.</dd>
<dt>Lighting demand (D_L)</dt><dd>Demand factor (%) applicable to the general lighting portion per Article 220 (where permitted).</dd>
<dt>Continuous lighting factor (C_L)</dt><dd>1.25 if lighting is treated as continuous; otherwise 1.00.</dd>
<dt>Receptacle raw load (R_raw)</dt><dd>Either count × 180 VA (NEC 220.14(I)) or a known total VA.</dd>
<dt>Table 220.44 demand</dt><dd>First 10 kVA at 100%, balance at 50% for non-dwelling receptacles (where applicable).</dd>
<dt>HVAC noncoincident (H)</dt><dd>Larger of cooling vs heating per NEC 220.50.</dd>
<dt>Motors (M)</dt><dd>Sum of all motors plus 25% of the largest motor per NEC 430.24.</dd>
<dt>Total kVA</dt><dd>Sum of all demanded VA divided by 1000.</dd>
<dt>Service current</dt><dd>Calculated line current based on selected service voltage system.</dd>
</dl>
</section>
<section>
<h2>How It Works: A Step-by-Step Example</h2>
<p>Assume an office with:</p>
<ul>
<li>Area A = 5,000 ft²</li>
<li>Unit lighting U = 1.3 VA/ft² (example only; verify code)</li>
<li>Lighting demand D_L = 100%; continuous C_L = 1.25</li>
<li>Receptacles: 60 outlets → R_raw = 60 × 180 = 10,800 VA; apply Table 220.44</li>
<li>Signage S = 1200 VA; Show window W = 0 VA</li>
<li>HVAC: Cooling 18,000 VA; Heating 25,000 VA → H = 25,000 VA</li>
<li>Motors: 5 kVA, 3 kVA, 2 kVA → Σ = 10 kVA; largest = 5 kVA → M = 10 + 0.25×5 = 11.25 kVA → 11,250 VA</li>
</ul>
<p>Lighting: L_raw = 5,000 × 1.3 = 6,500 VA → L = 6,500 × 1.00 × 1.25 = 8,125 VA.</p>
<p>Receptacles: R = 10,000 + 0.5 × (10,800 − 10,000) = 10,400 VA.</p>
<p>Total VA = L + R + S + W + H + M = 8,125 + 10,400 + 1,200 + 0 + 25,000 + 11,250 = 55,975 VA.</p>
<p>Total kVA = 55.975 kVA. On 3-phase 120/208 V: I = 55,975 / (√3 × 208) ≈ 155.5 A.</p>
</section>
<section>
<h2>Frequently Asked Questions (FAQ)</h2>
<h3>Do I need to enter unit lighting loads per occupancy?</h3>
<p>Yes. NEC 220.12 provides unit loads by occupancy; enter the appropriate VA/ft². Local amendments may adjust values.</p>
<h3>When should lighting be treated as continuous at 125%?</h3>
<p>Where the lighting meets the NEC definition of continuous load and applicable sections require 125% for feeders/services, enable the option. Apply engineering judgment.</p>
<h3>Can I use Table 220.44 for all receptacles?</h3>
<p>Only where permitted by NEC 220.44. The tool lets you toggle this and otherwise use a custom demand percentage.</p>
<h3>How are motors handled if one motor is part of the HVAC I already entered?</h3>
<p>Avoid double counting. Either include HVAC as HVAC only, or include that motor in the motor list and remove it from HVAC.</p>
<h3>Does this tool account for kitchen equipment demand factors (commercial kitchens)?</h3>
<p>This version focuses on general non-dwelling loads. For commercial kitchens and specialized equipment, apply the specific NEC sections/tables and add the resulting VA to motors or “other” categories as appropriate.</p>
<h3>Is the computed current equal to the required main breaker rating?</h3>
<p>No. The calculator reports calculated load current. OCPD sizing must follow additional NEC articles and may require oversizing, temperature corrections, and conductor ampacity checks.</p>
</section>
<div class="author-box">
<p>
              Tool developed by <strong>Ugo Candido</strong>. Content verified by <strong>CalcDomain Editorial Team</strong>.<br>
              Last reviewed for accuracy on: <time datetime="2025-09-14">September 14, 2025</time>.
            </p>
</div>

<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\]</div>
  <pre class="auditspine-mono">','</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Lighting VA (raw): L_raw = A × U Lighting VA (demanded): L = L_raw × (D_L / 100) × C_L Receptacles VA (count mode): R_raw = N × 180 Receptacles VA (known): R_raw = R_known Receptacles VA (demand per Table 220.44): R = 10,000 + 0.5 × max(0, R_raw − 10,000) Receptacles VA (custom %): R = R_raw × (D_R / 100) HVAC VA (noncoincident): H = max(H_cool, H_heat) Motors VA: M = (Σ m_i) + 0.25 × max(m_i) Total kVA: kVA_total = (L + R + S + W + H + M) / 1000 Current (single-phase): I = VA_total / V_L-L Current (3-phase): I = VA_total / (√3 × V_L-L)</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Engineering</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/engineering" target="_blank" rel="nofollow noopener">https://calcdomain.com/engineering</a></li>
<li><strong>Electrical (US NEC)</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/electrical" target="_blank" rel="nofollow noopener">https://calcdomain.com/subcategories/electrical</a></li>
<li><strong>NFPA 70</strong> — nfpa.org · Accessed 2026-01-19<br><a href="https://www.nfpa.org/codes-and-standards/all-codes-and-standards/list-of-codes-and-standards/detail?code=70" target="_blank" rel="nofollow noopener">https://www.nfpa.org/codes-and-standards/all-codes-and-standards/list-of-codes-and-standards/detail?code=70</a></li>
<li><strong>Commercial Electrical Load Calculations (EC&amp;M)</strong> — ecmweb.com · Accessed 2026-01-19<br><a href="https://www.ecmweb.com/content/article/20897051/commercial-electrical-load-calculations" target="_blank" rel="nofollow noopener">https://www.ecmweb.com/content/article/20897051/commercial-electrical-load-calculations</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</div>
</div>
</main>
<!-- Standard Footer --> 
<script defer="">
    (function(){
      'use strict';

      // Utilities
      const $ = (id)=>document.getElementById(id);
      const fmtKV = (va)=> (va/1000).toFixed(2) + ' kVA';
      const fmtA = (a)=> a.toFixed(2) + ' A';
      const clamp = (v,min,max)=> Math.max(min, Math.min(max, v));

      // Elements
      const systemSelect = $('systemSelect');
      const area = $('area');
      const unitLoad = $('unitLoad');
      const lightDemand = $('lightDemand');
      const lightContinuous = $('lightContinuous');

      const unitFt2 = $('unit-ft2');
      const unitM2 = $('unit-m2');
      const areaUnitSpan = $('areaUnit');

      const recModeCount = $('recModeCount');
      const recModeKnown = $('recModeKnown');
      const recCountWrap = $('recCountWrap');
      const recKnownWrap = $('recKnownWrap');
      const recCount = $('recCount');
      const recKnown = $('recKnown');
      const use22044 = $('use22044');
      const recDemand = $('recDemand');

      const signVA = $('signVA');
      const showWindowVA = $('showWindowVA');

      const coolVA = $('coolVA');
      const heatVA = $('heatVA');

      const motorList = $('motorList');
      const addMotor = $('addMotor');
      const clearMotors = $('clearMotors');

      const loadExample = $('loadExample');
      const resetAll = $('resetAll');

      const resLight = $('resLight');
      const resRecept = $('resRecept');
      const resSign = $('resSign');
      const resHVAC = $('resHVAC');
      const resMotors = $('resMotors');
      const resTotal = $('resTotal');
      const resAmps = $('resAmps');
      const resNote = $('resNote');

      // Tooltips toggling
      function wireTooltip(idBtn, idTip){
        const btn = $(idBtn), tip = $(idTip);
        if (!btn || !tip) return;
        btn.addEventListener('click', ()=>{
          const open = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!open));
          tip.hidden = open;
        });
      }
      wireTooltip('',''); // placeholder in case none
      // Map all tooltip buttons by data attributes or explicit:
      [['tip-area','tip-area'],['tip-unitload','tip-unitload'],['tip-lightdf','tip-lightdf'],['tip-cont','tip-cont'],['tip-rec','tip-rec'],['tip-22044','tip-22044'],['tip-sign','tip-sign']]
      .forEach(([btnId, tipId])=>{
        // Buttons are adjacent labels - query dynamically
        const tipEl = $(tipId);
        if (!tipEl) return;
        const btn = tipEl.previousElementSibling?.querySelector?.('.tooltip-btn') || document.querySelector('[aria-controls="'+tipId+'"]');
        if (btn){
          btn.addEventListener('click', ()=>{
            const open = btn.getAttribute('aria-expanded') === 'true';
            btn.setAttribute('aria-expanded', String(!open));
            tipEl.hidden = open;
          });
        }
      });

      // Area unit toggle management
      function currentAreaFt2(){
        const val = parseFloat(area.value || '0');
        if (isNaN(val) || val < 0) return 0;
        if (unitM2.checked){
          return val * 10.7639104167; // m2 to ft2
        }
        return val;
      }
      function updateAreaUnitLabel(){
        areaUnitSpan.textContent = unitFt2.checked ? 'ft²' : 'm²';
      }
      unitFt2.addEventListener('change', updateAreaUnitLabel);
      unitM2.addEventListener('change', updateAreaUnitLabel);

      // Receptacle mode switching
      function syncRecMode(){
        const mode = recModeCount.checked ? 'count' : 'known';
        recCountWrap.hidden = mode !== 'count';
        recKnownWrap.hidden = mode !== 'known';
      }
      recModeCount.addEventListener('change', syncRecMode);
      recModeKnown.addEventListener('change', syncRecMode);
      syncRecMode();

      // Motor rows
      let motorIdSeq = 0;
      function addMotorRow(kva=''){
        const id = ++motorIdSeq;
        const row = document.createElement('div');
        row.className = 'grid-2';
        row.style.alignItems = 'center';
        row.style.gap = '.5rem';
        row.style.marginBottom = '.5rem';
        row.innerHTML = `
          <div class="form-group" style="margin:0">
            <label for="motor_${id}">Motor ${id} (kVA)</label>
            <div class="input-group">
              <input id="motor_${id}" class="form-control motor-input" type="number" min="0" step="0.01" value="${kva}" aria-label="Motor ${id} kVA">
              <span class="suffix">kVA</span>
            </div>
          </div>
          <div style="display:flex;gap:.5rem">
            <button type="button" class="btn btn-secondary make-largest" aria-label="Set Motor ${id} as largest for reference">Mark</button>
            <button type="button" class="btn" style="border:1px solid var(--border)" aria-label="Remove Motor ${id}">Remove</button>
          </div>
        `;
        const [inputWrap, btnsWrap] = row.children;
        const removeBtn = btnsWrap.querySelector('.btn:last-child');
        removeBtn.addEventListener('click', ()=>{ row.remove(); compute(); });
        const markBtn = btnsWrap.querySelector('.make-largest');
        markBtn.addEventListener('click', ()=>{
          // Focus this input to help the user; the calculator auto-detects largest by value
          const inp = inputWrap.querySelector('input');
          inp.focus();
        });
        inputWrap.querySelector('input').addEventListener('input', compute);
        motorList.appendChild(row);
      }
      addMotor.addEventListener('click', ()=> addMotorRow(''));
      clearMotors.addEventListener('click', ()=>{
        motorList.innerHTML = '';
        compute();
      });
      // Start with one row for UX
      addMotorRow('');

      // Validation helpers
      function setError(inputEl, errorId, message){
        const err = $(errorId);
        if (!err) return;
        if (message){
          inputEl.setAttribute('aria-invalid','true');
          err.textContent = message;
        } else {
          inputEl.removeAttribute('aria-invalid');
          err.textContent = '';
        }
      }
      function onBlurValidateNumber(inputEl, errorId, {min=0, required=false, label='This field'}={}){
        inputEl.addEventListener('blur', ()=>{
          const vStr = inputEl.value.trim();
          const v = parseFloat(vStr);
          if (required && (vStr==='')){
            setError(inputEl, errorId, `${label} is required.`);
            return;
          }
          if (vStr!=='' && (isNaN(v) || v < min)){
            setError(inputEl, errorId, `${label} must be a number ≥ ${min}.`);
            return;
          }
          setError(inputEl, errorId, '');
        });
      }

      // Attach inline validations
      onBlurValidateNumber(area, 'areaError', {min:0, required:true, label:'Floor area'});
      onBlurValidateNumber(unitLoad, 'unitLoadError', {min:0, required:true, label:'Unit lighting load'});
      onBlurValidateNumber(lightDemand, 'lightDemandError', {min:0, required:true, label:'Lighting demand factor'});
      onBlurValidateNumber(recCount, 'recCountError', {min:0, required:false, label:'Receptacle count'});
      onBlurValidateNumber(recKnown, 'recKnownError', {min:0, required:false, label:'Known receptacle load'});
      onBlurValidateNumber(recDemand, 'recDemandError', {min:0, required:false, label:'Custom receptacle demand'});
      onBlurValidateNumber(signVA, 'signVAError', {min:0, required:false, label:'Sign circuit load'});
      onBlurValidateNumber(showWindowVA, 'showWindowVAError', {min:0, required:false, label:'Show window load'});
      onBlurValidateNumber(coolVA, 'coolVAError', {min:0, required:false, label:'Cooling load'});
      onBlurValidateNumber(heatVA, 'heatVAError', {min:0, required:false, label:'Heating load'});

      // Calculation
      function compute(){
        // Lighting
        const Aft2 = currentAreaFt2();
        const U = parseFloat(unitLoad.value || '0') || 0;
        let L_raw = Aft2 * U;
        let D_L = clamp(parseFloat(lightDemand.value || '100') || 100, 0, 100)/100;
        let C_L = lightContinuous.checked ? 1.25 : 1.0;
        let L = L_raw * D_L * C_L;

        // Receptacles
        let R_raw = 0;
        if (recModeCount.checked){
          const n = Math.max(0, parseInt(recCount.value || '0', 10) || 0);
          R_raw = n * 180;
        } else {
          R_raw = Math.max(0, parseFloat(recKnown.value || '0') || 0);
        }
        let R = 0;
        if (use22044.checked){
          R = Math.min(10000, R_raw) + 0.5 * Math.max(0, R_raw - 10000);
        } else {
          const D_R = clamp(parseFloat(recDemand.value || '100') || 100, 0, 100)/100;
          R = R_raw * D_R;
        }

        // Signage + Window
        const S = Math.max(0, parseFloat(signVA.value || '0') || 0);
        const W = Math.max(0, parseFloat(showWindowVA.value || '0') || 0);

        // HVAC noncoincident
        const Hcool = Math.max(0, parseFloat(coolVA.value || '0') || 0);
        const Hheat = Math.max(0, parseFloat(heatVA.value || '0') || 0);
        const H = Math.max(Hcool, Hheat);

        // Motors
        const motorInputs = motorList.querySelectorAll('.motor-input');
        let motorsSumVA = 0;
        let largestMotorVA = 0;
        motorInputs.forEach(inp=>{
          const kva = Math.max(0, parseFloat(inp.value || '0') || 0);
          const va = kva * 1000;
          motorsSumVA += va;
          if (va > largestMotorVA) largestMotorVA = va;
        });
        let M = motorsSumVA + 0.25 * largestMotorVA;

        // Totals
        const totalVA = L + R + S + W + H + M;
        const totalKVA = totalVA / 1000;

        // Current
        const sys = systemSelect.value;
        let VLL = 240; // default single-phase 120/240
        let ph = 1;
        if (sys === '3P-208'){ VLL = 208; ph = 3; }
        if (sys === '3P-480'){ VLL = 480; ph = 3; }
        if (sys === '1P-208'){ VLL = 208; ph = 1; }
        const amps = ph === 3 ? (totalVA / (Math.sqrt(3) * VLL)) : (totalVA / VLL);

        // Render
        resLight.textContent = fmtKV(L);
        resRecept.textContent = fmtKV(R);
        resSign.textContent = fmtKV(S + W);
        resHVAC.textContent = fmtKV(H);
        resMotors.textContent = fmtKV(M);
        resTotal.textContent = totalKVA.toFixed(2) + ' kVA';
        resAmps.textContent = fmtA(isFinite(amps) ? amps : 0);

        // Accessibility note
        resNote.textContent = 'Calculation updated.';
      }

      // Bind input events (fast but lightweight)
      [
        systemSelect, area, unitLoad, lightDemand, lightContinuous,
        recModeCount, recModeKnown, recCount, recKnown, use22044, recDemand,
        signVA, showWindowVA, coolVA, heatVA, unitFt2, unitM2
      ].forEach(el=> el.addEventListener('input', compute));

      // Example values
      loadExample.addEventListener('click', ()=>{
        systemSelect.value = '3P-208';
        unitFt2.checked = true; unitM2.checked = false; updateAreaUnitLabel();
        area.value = '5000';
        unitLoad.value = '1.3';
        lightDemand.value = '100';
        lightContinuous.checked = true;

        recModeCount.checked = true; recModeKnown.checked = false; syncRecMode();
        recCount.value = '60';
        use22044.checked = true;
        recDemand.value = '100';

        signVA.value = '1200';
        showWindowVA.value = '0';

        coolVA.value = '18000';
        heatVA.value = '25000';

        motorList.innerHTML = '';
        addMotorRow('5');
        addMotorRow('3');
        addMotorRow('2');

        compute();
        resNote.textContent = 'Loaded example values. Adjust as needed.';
      });

      // Reset
      resetAll.addEventListener('click', ()=>{
        document.querySelectorAll('input, select').forEach(el=>{
          if (el.type === 'checkbox' || el.type === 'radio'){
            // restore defaults
            if (el.id === 'unit-ft2') el.checked = true;
            if (el.id === 'unit-m2') el.checked = false;
            if (el.id === 'recModeCount') el.checked = true;
            if (el.id === 'recModeKnown') el.checked = false;
            if (el.id === 'use22044') el.checked = true;
            if (el.id === 'lightContinuous') el.checked = false;
          } else if (el.tagName === 'SELECT'){
            el.selectedIndex = 0;
          } else {
            // numeric defaults
            if (el.id === 'lightDemand') el.value = '100';
            else if (el.id === 'recDemand') el.value = '100';
            else if (el.id === 'recCount') el.value = '0';
            else if (el.id === 'recKnown') el.value = '0';
            else if (el.id === 'signVA') el.value = '1200';
            else if (el.id === 'showWindowVA') el.value = '0';
            else if (el.id === 'coolVA') el.value = '0';
            else if (el.id === 'heatVA') el.value = '0';
            else el.value = '';
          }
        });
        // clear errors
        document.querySelectorAll('.error-message').forEach(e=> e.textContent = '');
        updateAreaUnitLabel();
        syncRecMode();
        motorList.innerHTML = '';
        addMotorRow('');
        compute();
        resNote.textContent = 'Reset complete.';
      });

      // Initial compute
      updateAreaUnitLabel();
      compute();

      // Keyboard affordance hint (optional)
      document.addEventListener('keydown', (e)=>{
        if (e.key === 'Enter' && (e.target.matches('input') || e.target.matches('select'))){
          compute();
        }
      });
    })();
  </script>

</body></html>
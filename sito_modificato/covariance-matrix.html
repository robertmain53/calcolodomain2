<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Covariance Matrix Calculator – Variance &amp; Correlation from Data</title>
  <meta name="description" content="Compute the covariance matrix and correlation matrix from raw multivariate data. Supports sample and population covariance, summary statistics and PCA-ready outputs for statistics, data science and finance.">
  <link rel="canonical" href="https://calcdomain.com/covariance-matrix">

  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .card-hover {
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }
    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow:
        0 10px 15px -3px rgba(0,0,0,0.1),
        0 4px 6px -2px rgba(0,0,0,0.05);
    }
    .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
    .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
    .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
    .prose p { margin-bottom: 1rem; line-height: 1.6; }
    .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
    .prose li { margin-bottom: 0.5rem; }
    .formula-box {
      background: #f3f4f6;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      padding: 1rem;
      overflow-x: auto;
      margin: 1rem 0;
    }
    .muted-note {
      font-size: 0.75rem;
      color: #6b7280;
    }
    .pill-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.2rem 0.6rem;
      border-radius: 9999px;
      font-size: 0.7rem;
      font-weight: 500;
      background-color: #eff6ff;
      color: #1d4ed8;
    }
    .chip {
      display: inline-flex;
      align-items: center;
      border-radius: 9999px;
      border: 1px solid #e5e7eb;
      padding: 0.15rem 0.6rem;
      font-size: 0.7rem;
      color: #4b5563;
      background-color: #f9fafb;
      margin-right: 0.25rem;
      margin-bottom: 0.25rem;
    }
    .matrix-table th,
    .matrix-table td {
      min-width: 3.5rem;
      text-align: right;
      font-variant-numeric: tabular-nums;
    }
    .matrix-diag {
      background-color: #eff6ff;
    }
    .matrix-sym {
      background-color: #f9fafb;
    }
  </style>

  <!-- HEAD_SCRIPTS_E_META -->
  <!-- Google tag (gtag.js) -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-7MB5V1LZRN');
  </script>

  <meta name="google-site-verification" content="_tiTZ9ivAdtXcAS9CMnTNJ549Sg39WVqP_ZFbWgglNA">

  <script src="https://cmp.gatekeeperconsent.com/min.js" data-cfasync="false"></script>
  <script src="https://the.gatekeeperconsent.com/cmp.min.js" data-cfasync="false"></script>

  <script async="" src="//www.ezojs.com/ezoic/sa.min.js"></script>
  <script>
    window.ezstandalone = window.ezstandalone || {};
    ezstandalone.cmd = ezstandalone.cmd || [];
  </script>

  <script type="application/ld+json">
[
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://calcdomain.com"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Math & Conversions",
        "item": "https://calcdomain.com/categories/math-conversions"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Core Math & Algebra",
        "item": "https://calcdomain.com/subcategories/core-math-algebra"
      },
      {
        "@type": "ListItem",
        "position": 4,
        "name": "Covariance matrix",
        "item": "https://calcdomain.com/covariance-matrix"
      }
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is a covariance matrix?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "A covariance matrix is a square matrix that summarises the covariances between all pairs of components of a random vector. Its diagonal entries are variances of individual variables and off-diagonal entries are covariances between variables."
        }
      },
      {
        "@type": "Question",
        "name": "What is the difference between sample and population covariance?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Population covariance divides by N, where N is the total number of observations in the population. Sample covariance divides by N − 1 to correct bias when you only observe a sample. In practice, sample covariance is used when you estimate from data."
        }
      },
      {
        "@type": "Question",
        "name": "What does this covariance matrix calculator do?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The calculator takes tabular data with multiple variables, computes the sample or population means of each variable, and then returns the covariance matrix and optionally the corresponding correlation matrix. It also reports basic summary statistics such as the number of observations and the variances of each variable."
        }
      },
      {
        "@type": "Question",
        "name": "How should I format the input data?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Each row should be one observation, and each column should be one variable. You can separate values within a row by commas, semicolons or whitespace. All rows must have the same number of numeric entries and you need at least two variables and two observations."
        }
      },
      {
        "@type": "Question",
        "name": "When should I use the covariance matrix instead of the correlation matrix?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The covariance matrix keeps the original units and is needed for computations such as multivariate normal densities, Kalman filters, and portfolio optimisation. The correlation matrix standardises variances to 1 and is useful to compare strength and direction of linear relationships independently of the scale of each variable."
        }
      },
      {
        "@type": "Question",
        "name": "Why can the covariance matrix be singular or ill-conditioned?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "If one variable is a linear combination of others or the number of observations is too small relative to the number of variables, the covariance matrix can become singular or nearly singular. In that case, some multivariate methods such as inversion or PCA need regularisation or dimensionality reduction."
        }
      }
    ]
  }
]
</script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>

<body class="bg-gray-50 text-gray-800">
  <!-- BODY_SCRIPTS_INIZIO -->
  <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939" crossorigin="anonymous"></script>

  <header class="bg-white shadow-sm sticky top-0 z-50">
    <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
      <div class="flex justify-between items-center">
        <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>
        <div class="w-full max-w-md hidden md:block mx-8">
          <div class="relative">
            <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
            <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
          </div>
        </div>
        <div class="hidden md:flex items-center space-x-6">
          <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
          <a href="https://calcdomain.com/categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
        </div>
        <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
      </div>
      <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
        <div class="mb-4">
          <div class="relative">
            <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
          </div>
        </div>
        <div class="space-y-2">
          <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
          <a href="https://calcdomain.com/categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
        </div>
      </nav>
    </nav>
  </header>

  <div class="container mx-auto px-4 py-8">
    <!-- Breadcrumb -->
    <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
      <a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a>
      <span class="mx-1 text-gray-400">/</span>
      <a href="https://calcdomain.com/categories/math-conversions" class="text-blue-600 hover:underline">Math &amp; Conversions</a>
      <span class="mx-1 text-gray-400">/</span>
      <a href="https://calcdomain.com/subcategories/core-math-algebra" class="text-blue-600 hover:underline">Core Math &amp; Algebra</a>
      <span class="mx-1 text-gray-400">/</span>
      <span class="text-gray-500">Covariance matrix</span>
    </nav>

    <div class="flex flex-col lg:flex-row gap-8">
      <main class="w-full lg:w-2/3">
        <div class="bg-white p-6 rounded-lg shadow-md">
          <div class="flex flex-wrap items-center gap-2 mb-3">
            <h1 class="text-2xl md:text-3xl font-bold">Covariance Matrix Calculator</h1>
            <span class="pill-badge">Multivariate variance &amp; correlation</span>
          </div>
          <p class="text-gray-700 mb-3">
            Paste or type your multivariate data and this tool computes the covariance matrix and, optionally,
            the corresponding correlation matrix. Choose between sample and population covariance and get
            summary statistics that are ready for PCA, portfolio theory, multivariate normal models and more.
          </p>
          <div class="mb-4 flex flex-wrap gap-2">
            <span class="chip">sample &amp; population covariance</span>
            <span class="chip">correlation matrix</span>
            <span class="chip">summary statistics</span>
            <span class="chip">CSV-style input</span>
            <span class="chip">PCA-ready</span>
          </div>

          <!-- Calculator -->
          <section aria-labelledby="covmat-calculator-heading" class="mt-4 mb-8">
            <h2 id="covmat-calculator-heading" class="text-xl font-semibold mb-3">
              Data input &amp; configuration
            </h2>

            <form id="covmat-form" class="space-y-5" novalidate="">
              <div>
                <label for="data-input" class="block text-sm font-medium text-gray-700 mb-1">
                  Data table (one row per observation)
                </label>
                <textarea id="data-input" rows="8" class="w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm font-mono" placeholder="Example (3 variables, 5 observations):
1.2,  3.1,  0.5
0.9,  2.8,  0.7
1.5,  3.5,  0.6
1.1,  3.0,  0.9
1.3,  3.2,  0.4"></textarea>
                <p class="muted-note mt-1">
                  Separate values by commas, semicolons or whitespace. Each row must contain the same number of numeric values.
                </p>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <label for="variable-names" class="block text-xs font-medium text-gray-700 mb-1">
                    Variable labels (optional)
                  </label>
                  <input type="text" id="variable-names" class="w-full border-gray-300 rounded-md shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500 text-sm" placeholder="e.g. X1, X2, X3">
                  <p class="muted-note mt-1">
                    Comma-separated names. If left blank, the calculator uses X1, X2, ….
                  </p>
                </div>

                <div>
                  <fieldset>
                    <legend class="block text-xs font-medium text-gray-700 mb-1">Covariance type</legend>
                    <select id="cov-type" class="w-full border-gray-300 rounded-md shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500 text-sm">
                      <option value="sample" selected="">Sample covariance (divide by N − 1)</option>
                      <option value="population">Population covariance (divide by N)</option>
                    </select>
                    <p class="muted-note mt-1">
                      Use sample covariance when estimating from data (default).
                    </p>
                  </fieldset>
                </div>

                <div>
                  <fieldset>
                    <legend class="block text-xs font-medium text-gray-700 mb-1">Additional outputs</legend>
                    <div class="flex items-center gap-2 mb-1">
                      <input id="show-corr" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                      <label for="show-corr" class="text-xs text-gray-700">Compute correlation matrix</label>
                    </div>
                    <div class="flex items-center gap-2">
                      <input id="show-summary" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded" checked="">
                      <label for="show-summary" class="text-xs text-gray-700">Show summary statistics</label>
                    </div>
                  </fieldset>
                </div>
              </div>

              <div class="flex flex-wrap gap-3 pt-2">
                <button type="submit" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                  Compute covariance matrix
                </button>
                <button type="button" id="covmat-reset" class="inline-flex items-center px-4 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md shadow-sm hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400">
                  Reset
                </button>
                <button type="button" id="covmat-example" class="inline-flex items-center px-4 py-2 bg-white text-blue-700 text-sm font-medium rounded-md border border-blue-200 shadow-sm hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                  Load example dataset
                </button>
              </div>
            </form>

            <div id="covmat-error" class="mt-4 text-sm text-red-600 hidden"></div>

            <!-- Results -->
            <div id="covmat-results" class="mt-6 hidden">
              <h2 class="text-lg font-semibold mb-3">Results</h2>

              <div id="covmat-summary-box" class="border border-gray-200 rounded-lg p-4 mb-4">
                <p id="covmat-summary" class="text-sm font-medium text-gray-900 mb-1"></p>
                <p id="covmat-summary-detail" class="text-xs text-gray-600"></p>
              </div>

              <div id="covmat-matrix-section" class="mb-6">
                <h3 class="text-md font-semibold text-gray-900 mb-2">Covariance matrix</h3>
                <div class="overflow-x-auto">
                  <table class="min-w-full text-xs border border-gray-200 rounded-md matrix-table">
                    <thead class="bg-gray-100" id="covmat-head"></thead>
                    <tbody id="covmat-body" class="divide-y divide-gray-100"></tbody>
                  </table>
                </div>
              </div>

              <div id="corr-matrix-section" class="mb-6 hidden">
                <h3 class="text-md font-semibold text-gray-900 mb-2">Correlation matrix</h3>
                <p class="muted-note mb-2">
                  The correlation between variables i and j is cov(i, j) / (σ<sub>i</sub> σ<sub>j</sub>). Diagonal entries are 1.0.
                </p>
                <div class="overflow-x-auto">
                  <table class="min-w-full text-xs border border-gray-200 rounded-md matrix-table">
                    <thead class="bg-gray-100" id="corr-head"></thead>
                    <tbody id="corr-body" class="divide-y divide-gray-100"></tbody>
                  </table>
                </div>
              </div>

              <div id="covmat-summary-stats" class="mb-4 hidden"></div>

              <details class="mt-4 text-sm text-gray-800">
                <summary class="cursor-pointer font-semibold text-gray-900">Show calculation details</summary>
                <div id="covmat-steps" class="mt-3 space-y-1"></div>
              </details>

              <p class="mt-4 text-xs text-gray-500">
                This tool uses standard numerical formulas for sample and population covariance. For extremely
                high-dimensional data or numerically ill-conditioned problems, consider using specialised numerical
                libraries with regularisation and high-precision linear algebra.
              </p>
            </div>
          </section>

          <!-- Explanatory content -->
          <section class="prose prose-sm md:prose-base mt-10">
            <h2>What is a covariance matrix?</h2>
            <p>
              Suppose you have a random vector
              \[
                X = (X_1, X_2, \dots, X_p)^\top.
              \]
              The <strong>covariance matrix</strong> of \(X\) is the \(p \times p\) matrix
              \[
                \Sigma = \operatorname{Cov}(X) =
                \begin{bmatrix}
                  \operatorname{Var}(X_1) &amp; \operatorname{Cov}(X_1, X_2) &amp; \dots &amp; \operatorname{Cov}(X_1, X_p) \\
                  \operatorname{Cov}(X_2, X_1) &amp; \operatorname{Var}(X_2) &amp; \dots &amp; \operatorname{Cov}(X_2, X_p) \\
                  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
                  \operatorname{Cov}(X_p, X_1) &amp; \operatorname{Cov}(X_p, X_2) &amp; \dots &amp; \operatorname{Var}(X_p)
                \end{bmatrix}.
              \]
            </p>
            <p>
              It compactly summarises all pairwise linear relationships between your variables: variances on the diagonal,
              covariances off the diagonal.
            </p>

            <h3>Sample vs population covariance matrix</h3>
            <p>
              In practice you estimate covariance from a data matrix \(X\) with \(n\) observations (rows) and \(p\)
              variables (columns). Let \(x_{i j}\) be the value of variable \(j\) in observation \(i\), and let
              \(\bar{x}_j\) be the sample mean of variable \(j\).
            </p>

            <div class="formula-box text-sm">
              <p class="font-semibold mb-2">Sample covariance matrix</p>
              <p>
                For \(n\) observations and \(p\) variables, the <strong>sample covariance</strong> between variables
                \(j\) and \(k\) is
                \[
                  s_{j k} = \frac{1}{n - 1} \sum_{i=1}^n
                  (x_{i j} - \bar{x}_j)\,(x_{i k} - \bar{x}_k).
                \]
                The sample covariance matrix \(S\) collects all \(s_{j k}\) in a \(p \times p\) matrix.
              </p>
              <p class="mt-1">
                Dividing by \(n - 1\) gives an <em>unbiased</em> estimator of the population covariance when data are
                independent and identically distributed.
              </p>
            </div>

            <div class="formula-box text-sm">
              <p class="font-semibold mb-2">Population covariance matrix</p>
              <p>
                If you can treat the data as the entire population, you may use
                \[
                  \sigma_{j k} = \frac{1}{n} \sum_{i=1}^n
                  (x_{i j} - \bar{x}_j)\,(x_{i k} - \bar{x}_k),
                \]
                i.e. divide by \(n\) instead of \(n - 1\). This is the <strong>population covariance</strong>.
              </p>
            </div>

            <h2>From covariance matrix to correlation matrix</h2>
            <p>
              The covariance between variables depends on the measurement units (for example, metres vs kilometres).
              To remove the effect of scale you can compute the <strong>correlation matrix</strong>, whose entries are
              the Pearson correlation coefficients:
              \[
                \rho_{j k} = \frac{\operatorname{Cov}(X_j, X_k)}{\sqrt{\operatorname{Var}(X_j)\operatorname{Var}(X_k)}}.
              \]
            </p>
            <p>
              In matrix form, if \(D\) is the diagonal matrix of standard deviations, the correlation matrix is
              \[
                R = D^{-1} \Sigma D^{-1}.
              \]
              The diagonal entries of \(R\) are all 1, and each off-diagonal element lies between −1 and +1.
            </p>

            <h2>Applications of the covariance matrix</h2>
            <ul>
              <li>
                <strong>Principal component analysis (PCA)</strong> — PCA diagonalises the covariance matrix to find
                directions of maximum variance.
              </li>
              <li>
                <strong>Portfolio theory</strong> — in quantitative finance, the covariance matrix of asset returns is
                central to risk modelling and optimisation.
              </li>
              <li>
                <strong>Multivariate normal models</strong> — the covariance matrix parameterises the spread and shape
                of multivariate Gaussian distributions.
              </li>
              <li>
                <strong>State estimation &amp; Kalman filtering</strong> — process and measurement noise covariances are
                key design inputs.
              </li>
              <li>
                <strong>Machine learning &amp; data preprocessing</strong> — covariance is used in whitening, feature
                scaling and understanding feature interactions.
              </li>
            </ul>

            <h2>Numerical considerations</h2>
            <ul>
              <li>
                If the number of variables \(p\) is close to or larger than the number of observations \(n\), the
                covariance matrix may become singular or highly unstable.
              </li>
              <li>
                Strong collinearity (nearly linear relationships between variables) can cause near-singularity and
                large condition numbers, which affect matrix inversion and eigen-decomposition.
              </li>
              <li>
                For high-dimensional or ill-conditioned problems, consider regularised estimators (for example,
                shrinkage covariance) rather than the plain sample covariance.
              </li>
            </ul>

            <h2>Related multivariate tools</h2>
            <ul>
              <li><a href="https://calcdomain.com/one-way-anova">One-Way ANOVA Calculator</a></li>
              <li><a href="https://calcdomain.com/a-b-test-significance">A/B Test Significance Calculator</a></li>
              <li><a href="https://calcdomain.com/qr-decomposition">QR Decomposition</a></li>
              <li><a href="https://calcdomain.com/complex-number">Complex Number Calculator</a></li>
              <li><a href="https://calcdomain.com/fft">Fast Fourier Transform (FFT)</a></li>
              <li><a href="https://calcdomain.com/percent-error">Percent Error Calculator</a></li>
              <li><a href="https://calcdomain.com/significant-figures">Significant Figures Calculator</a></li>
              <li><a href="https://calcdomain.com/modular-inverse">Modular Inverse Calculator</a></li>
            </ul>
          </section>
        </div>
      
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[X = (X_1, X_2, \dots, X_p)^\top.\]</div>
  <pre class="auditspine-mono">X = (X_1, X_2, \dots, X_p)^\top.</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\Sigma = \operatorname{Cov}(X) = \begin{bmatrix} \operatorname{Var}(X_1) &amp; \operatorname{Cov}(X_1, X_2) &amp; \dots &amp; \operatorname{Cov}(X_1, X_p) \\ \operatorname{Cov}(X_2, X_1) &amp; \operatorname{Var}(X_2) &amp; \dots &amp; \operatorname{Cov}(X_2, X_p) \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \operatorname{Cov}(X_p, X_1) &amp; \operatorname{Cov}(X_p, X_2) &amp; \dots &amp; \operatorname{Var}(X_p) \end{bmatrix}.\]</div>
  <pre class="auditspine-mono">\Sigma = \operatorname{Cov}(X) = \begin{bmatrix} \operatorname{Var}(X_1) &amp; \operatorname{Cov}(X_1, X_2) &amp; \dots &amp; \operatorname{Cov}(X_1, X_p) \\ \operatorname{Cov}(X_2, X_1) &amp; \operatorname{Var}(X_2) &amp; \dots &amp; \operatorname{Cov}(X_2, X_p) \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \operatorname{Cov}(X_p, X_1) &amp; \operatorname{Cov}(X_p, X_2) &amp; \dots &amp; \operatorname{Var}(X_p) \end{bmatrix}.</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[s_{j k} = \frac{1}{n - 1} \sum_{i=1}^n (x_{i j} - \bar{x}_j)\,(x_{i k} - \bar{x}_k).\]</div>
  <pre class="auditspine-mono">s_{j k} = \frac{1}{n - 1} \sum_{i=1}^n (x_{i j} - \bar{x}_j)\,(x_{i k} - \bar{x}_k).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\sigma_{j k} = \frac{1}{n} \sum_{i=1}^n (x_{i j} - \bar{x}_j)\,(x_{i k} - \bar{x}_k),\]</div>
  <pre class="auditspine-mono">\sigma_{j k} = \frac{1}{n} \sum_{i=1}^n (x_{i j} - \bar{x}_j)\,(x_{i k} - \bar{x}_k),</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\rho_{j k} = \frac{\operatorname{Cov}(X_j, X_k)}{\sqrt{\operatorname{Var}(X_j)\operatorname{Var}(X_k)}}.\]</div>
  <pre class="auditspine-mono">\rho_{j k} = \frac{\operatorname{Cov}(X_j, X_k)}{\sqrt{\operatorname{Var}(X_j)\operatorname{Var}(X_k)}}.</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[R = D^{-1} \Sigma D^{-1}.\]</div>
  <pre class="auditspine-mono">R = D^{-1} \Sigma D^{-1}.</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Sample covariance matrix For \(n\) observations and \(p\) variables, the sample covariance between variables \(j\) and \(k\) is \[ s_{j k} = \frac{1}{n - 1} \sum_{i=1}^n (x_{i j} - \bar{x}_j)\,(x_{i k} - \bar{x}_k). \] The sample covariance matrix \(S\) collects all \(s_{j k}\) in a \(p \times p\) matrix. Dividing by \(n - 1\) gives an unbiased estimator of the population covariance when data are independent and identically distributed.</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Population covariance matrix If you can treat the data as the entire population, you may use \[ \sigma_{j k} = \frac{1}{n} \sum_{i=1}^n (x_{i j} - \bar{x}_j)\,(x_{i k} - \bar{x}_k), \] i.e. divide by \(n\) instead of \(n - 1\). This is the population covariance.</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>One-Way ANOVA Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/one-way-anova" target="_blank" rel="nofollow noopener">https://calcdomain.com/one-way-anova</a></li>
<li><strong>A/B Test Significance Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/a-b-test-significance" target="_blank" rel="nofollow noopener">https://calcdomain.com/a-b-test-significance</a></li>
<li><strong>QR Decomposition</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/qr-decomposition" target="_blank" rel="nofollow noopener">https://calcdomain.com/qr-decomposition</a></li>
<li><strong>Complex Number Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/complex-number" target="_blank" rel="nofollow noopener">https://calcdomain.com/complex-number</a></li>
<li><strong>Fast Fourier Transform (FFT)</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/fft" target="_blank" rel="nofollow noopener">https://calcdomain.com/fft</a></li>
<li><strong>Percent Error Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/percent-error" target="_blank" rel="nofollow noopener">https://calcdomain.com/percent-error</a></li>
<li><strong>Significant Figures Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/significant-figures" target="_blank" rel="nofollow noopener">https://calcdomain.com/significant-figures</a></li>
<li><strong>Modular Inverse Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/modular-inverse" target="_blank" rel="nofollow noopener">https://calcdomain.com/modular-inverse</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main>

      <aside class="w-full lg:w-1/3">
        <div class="bg-white p-4 rounded-lg shadow-md mb-6">
          <h2 class="text-lg font-semibold mb-3">More in Core Math &amp; Algebra</h2>
          <ul class="space-y-2 text-sm">
            <li><a href="https://calcdomain.com/parallelogram-area" class="text-blue-600 hover:underline">Parallelogram Area</a></li>
            <li><a href="https://calcdomain.com/one-way-anova" class="text-blue-600 hover:underline">ANOVA (One-Way)</a></li>
            <li><a href="https://calcdomain.com/significant-figures" class="text-blue-600 hover:underline">Significant Figures</a></li>
            <li><a href="https://calcdomain.com/modular-inverse" class="text-blue-600 hover:underline">Modular Inverse</a></li>
            <li><a href="https://calcdomain.com/a-b-test-significance" class="text-blue-600 hover:underline">A/B Test Statistical Significance</a></li>
            <li><a href="https://calcdomain.com/covariance-matrix" class="text-blue-600 hover:underline">Covariance Matrix</a></li>
            <li><a href="https://calcdomain.com/qr-decomposition" class="text-blue-600 hover:underline">QR Decomposition</a></li>
            <li><a href="https://calcdomain.com/fft" class="text-blue-600 hover:underline">Fast Fourier Transform (FFT)</a></li>
            <li><a href="https://calcdomain.com/boolean-algebra" class="text-blue-600 hover:underline">Boolean Algebra</a></li>
            <li><a href="https://calcdomain.com/geometric-sequence" class="text-blue-600 hover:underline">Geometric Sequence</a></li>
          </ul>
        </div>

        <div class="bg-white p-4 rounded-lg shadow-md">
          <h2 class="text-lg font-semibold mb-3">Good practices when using covariance</h2>
          <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
            <li>Check for obvious data entry errors or unit mismatches before computing covariance.</li>
            <li>Standardise or scale variables when comparing magnitudes across very different units.</li>
            <li>Inspect the correlation matrix to understand strong positive or negative relationships.</li>
            <li>Be cautious when the number of variables is large relative to the sample size.</li>
            <li>For downstream inversion or PCA, consider regularisation if the matrix is nearly singular.</li>
          </ul>
        </div>
      </aside>
    </div>
  </div>

  <footer class="bg-gray-900 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
          <p class="text-gray-400 mb-4">
            Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
          </p>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Categories</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction &amp; DIY</a></li>
          <li><a href="https://calcdomain.com/categories/coordinate-converters" class="text-gray-400 hover:text-white">Coordinate Converters</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health &amp; Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle &amp; Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math &amp; Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
          <ul class="space-y-2">
            <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
            <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
            <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
            <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
            <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Support</h4>
          <ul class="space-y-2">
            <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
            <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
            <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
            <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
            <li><a href="https://calcdomain.com/sitemap" class="text-gray-400 hover:text-white">Site Map</a></li>
          </ul>
        </div>
      </div>
      <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
        <p>© 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
      </div>
    </div>
  </footer>

  <script src="/assets/js/script_menu.js" defer=""></script>
  <script src="/assets/js/script_faq.js" defer=""></script>
  <script src="search.js" defer=""></script>

  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(','\\)'], ['$', '$']], displayMath: [['$','$'], ['\\[','\\]']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <script>
    (function () {
      function $(id) { return document.getElementById(id); }
      function show(el) { el.classList.remove('hidden'); }
      function hide(el) { el.classList.add('hidden'); }

      function loadExample() {
        var ex = [
          '1.2, 3.1, 0.5',
          '0.9, 2.8, 0.7',
          '1.5, 3.5, 0.6',
          '1.1, 3.0, 0.9',
          '1.3, 3.2, 0.4'
        ].join('\\n');
        $('data-input').value = ex;
        $('variable-names').value = 'Return_A, Return_B, Factor';
      }

      function parseData(text) {
        var lines = text.split(/\\r?\\n/).map(function (l) { return l.trim(); }).filter(function (l) { return l.length > 0; });
        if (lines.length === 0) {
          return { error: 'Please provide at least two non-empty rows of data.' };
        }
        var data = [];
        var dim = null;
        for (var i = 0; i < lines.length; i++) {
          var row = lines[i]
            .replace(/;/g, ',')
            .trim()
            .split(/[,\\s]+/)
            .map(function (s) { return s.trim(); })
            .filter(function (s) { return s.length > 0; });

          if (row.length === 0) {
            continue;
          }
          if (dim === null) {
            dim = row.length;
          } else if (row.length !== dim) {
            return { error: 'Row ' + (i + 1) + ' has ' + row.length + ' values, but expected ' + dim + ' based on previous rows.' };
          }
          var nums = [];
          for (var j = 0; j < row.length; j++) {
            var v = Number(row[j]);
            if (!Number.isFinite(v)) {
              return { error: 'Non-numeric value "' + row[j] + '" in row ' + (i + 1) + ', column ' + (j + 1) + '.' };
            }
            nums.push(v);
          }
          data.push(nums);
        }
        if (!dim || dim < 2) {
          return { error: 'You need at least 2 variables (columns) to form a covariance matrix.' };
        }
        if (data.length < 2) {
          return { error: 'You need at least 2 observations (rows) to compute covariance.' };
        }
        return { data: data, n: data.length, p: dim };
      }

      function computeStats(data) {
        var n = data.length;
        var p = data[0].length;
        var means = new Array(p).fill(0);
        for (var i = 0; i < n; i++) {
          for (var j = 0; j < p; j++) {
            means[j] += data[i][j];
          }
        }
        for (var j = 0; j < p; j++) {
          means[j] /= n;
        }

        return { n: n, p: p, means: means };
      }

      function computeCovarianceMatrix(data, type) {
        var n = data.length;
        var p = data[0].length;
        var stats = computeStats(data);
        var means = stats.means.slice();
        var denom = (type === 'population') ? n : (n - 1);

        var cov = [];
        for (var j = 0; j < p; j++) {
          cov[j] = new Array(p).fill(0);
        }

        for (var i = 0; i < n; i++) {
          for (var j = 0; j < p; j++) {
            var xj = data[i][j] - means[j];
            for (var k = 0; k < p; k++) {
              var xk = data[i][k] - means[k];
              cov[j][k] += xj * xk;
            }
          }
        }

        for (var j = 0; j < p; j++) {
          for (var k = 0; k < p; k++) {
            cov[j][k] = cov[j][k] / denom;
          }
        }

        var variances = cov.map(function (row, idx) { return row[idx]; });

        return {
          n: n,
          p: p,
          means: means,
          cov: cov,
          variances: variances,
          denom: denom,
          type: type
        };
      }

      function computeCorrelationMatrix(cov, variances) {
        var p = cov.length;
        var corr = [];
        var sds = variances.map(function (v) { return v > 0 ? Math.sqrt(v) : 0; });

        for (var j = 0; j < p; j++) {
          corr[j] = [];
          for (var k = 0; k < p; k++) {
            if (j === k) {
              corr[j][k] = 1;
            } else {
              var denom = sds[j] * sds[k];
              if (denom === 0) {
                corr[j][k] = NaN;
              } else {
                corr[j][k] = cov[j][k] / denom;
              }
            }
          }
        }
        return corr;
      }

      function fmt(x, digits) {
        if (!Number.isFinite(x)) return '—';
        digits = typeof digits === 'number' ? digits : 6;
        return Number(x.toFixed(digits)).toString();
      }

      function renderMatrix(headEl, bodyEl, labels, matrix, highlightDiag) {
        headEl.innerHTML = '';
        bodyEl.innerHTML = '';

        var trHead = document.createElement('tr');
        var thEmpty = document.createElement('th');
        thEmpty.className = 'px-3 py-2 text-left font-semibold text-gray-700 border-b border-gray-200';
        thEmpty.textContent = '';
        trHead.appendChild(thEmpty);

        for (var j = 0; j < labels.length; j++) {
          var th = document.createElement('th');
          th.className = 'px-3 py-2 text-right font-semibold text-gray-700 border-b border-gray-200';
          th.textContent = labels[j];
          trHead.appendChild(th);
        }
        headEl.appendChild(trHead);

        for (var r = 0; r < labels.length; r++) {
          var tr = document.createElement('tr');
          var thRow = document.createElement('th');
          thRow.className = 'px-3 py-1 text-left font-medium text-gray-700 border-b border-gray-100';
          thRow.textContent = labels[r];
          tr.appendChild(thRow);

          for (var c = 0; c < labels.length; c++) {
            var td = document.createElement('td');
            td.className = 'px-3 py-1 border-b border-gray-100';
            if (highlightDiag && r === c) {
              td.classList.add('matrix-diag');
            } else if (r !== c) {
              td.classList.add('matrix-sym');
            }
            td.textContent = fmt(matrix[r][c], 6);
            tr.appendChild(td);
          }
          bodyEl.appendChild(tr);
        }
      }

      function onSubmit(e) {
        e.preventDefault();
        var err = $('covmat-error');
        var res = $('covmat-results');
        var corrSection = $('corr-matrix-section');
        var summaryBox = $('covmat-summary-box');
        var summaryEl = $('covmat-summary');
        var summaryDetailEl = $('covmat-summary-detail');
        var summaryStats = $('covmat-summary-stats');
        var stepsEl = $('covmat-steps');

        hide(err);
        hide(res);
        hide(corrSection);
        hide(summaryStats);
        summaryEl.textContent = '';
        summaryDetailEl.textContent = '';
        summaryStats.innerHTML = '';
        stepsEl.innerHTML = '';

        var raw = $('data-input').value || '';
        var parsed = parseData(raw);
        if (parsed.error) {
          err.textContent = parsed.error;
          show(err);
          return;
        }
        var data = parsed.data;
        var n = parsed.n;
        var p = parsed.p;

        var type = $('cov-type').value;
        var showCorr = $('show-corr').checked;
        var showSummary = $('show-summary').checked;

        var namesInput = $('variable-names').value.trim();
        var labels;
        if (namesInput.length > 0) {
          labels = namesInput.split(',').map(function (s) { return s.trim(); }).filter(function (s) { return s.length > 0; });
          if (labels.length !== p) {
            err.textContent = 'Number of variable labels (' + labels.length + ') does not match the number of columns (' + p + ').';
            show(err);
            return;
          }
        } else {
          labels = [];
          for (var j = 0; j < p; j++) {
            labels.push('X' + (j + 1));
          }
        }

        var covRes = computeCovarianceMatrix(data, type);
        var cov = covRes.cov;
        var variances = covRes.variances;
        var means = covRes.means;

        summaryEl.textContent =
          'Computed a ' + p + ' × ' + p +
          ' ' + (type === 'population' ? 'population' : 'sample') +
          ' covariance matrix from ' + n + ' observations.';
        summaryDetailEl.textContent =
          'Diagonal entries are variances of each variable; off-diagonal entries are covariances.';

        renderMatrix($('covmat-head'), $('covmat-body'), labels, cov, true);

        if (showCorr) {
          var corr = computeCorrelationMatrix(cov, variances);
          renderMatrix($('corr-head'), $('corr-body'), labels, corr, true);
          show(corrSection);
        }

        if (showSummary) {
          var html = '<h3 class="text-md font-semibold text-gray-900 mb-2">Summary statistics</h3>';
          html += '<div class="overflow-x-auto"><table class="min-w-full text-xs border border-gray-200 rounded-md matrix-table">';
          html += '<thead class="bg-gray-100"><tr>';
          html += '<th class="px-3 py-2 text-left font-semibold text-gray-700 border-b border-gray-200">Variable</th>';
          html += '<th class="px-3 py-2 text-right font-semibold text-gray-700 border-b border-gray-200">Mean</th>';
          html += '<th class="px-3 py-2 text-right font-semibold text-gray-700 border-b border-gray-200">Variance</th>';
          html += '<th class="px-3 py-2 text-right font-semibold text-gray-700 border-b border-gray-200">Std. dev.</th>';
          html += '</tr></thead><tbody class="divide-y divide-gray-100">';
          for (var j = 0; j < p; j++) {
            var v = variances[j];
            var sd = v >= 0 ? Math.sqrt(v) : NaN;
            html += '<tr>';
            html += '<td class="px-3 py-1 text-left border-b border-gray-100">' + labels[j] + '</td>';
            html += '<td class="px-3 py-1 text-right border-b border-gray-100">' + fmt(means[j], 6) + '</td>';
            html += '<td class="px-3 py-1 text-right border-b border-gray-100">' + fmt(v, 6) + '</td>';
            html += '<td class="px-3 py-1 text-right border-b border-gray-100">' + fmt(sd, 6) + '</td>';
            html += '</tr>';
          }
          html += '</tbody></table></div>';
          html += '<p class="muted-note mt-2">For the ' + (type === 'population' ? 'population' : 'sample') +
                  ' covariance, variances and standard deviations are computed using the same denominator (' +
                  (type === 'population' ? 'N' : 'N − 1') + ').</p>';
          summaryStats.innerHTML = html;
          show(summaryStats);
        }

        var steps = [];
        steps.push('1. Parse the input text as a numeric matrix with n rows (observations) and p columns (variables).');
        steps.push('2. Compute the sample mean of each variable: \\(\\bar{x}_j = \\frac{1}{n} \\sum_{i=1}^n x_{i j}\\).');
        steps.push('3. For each pair of variables (j, k), accumulate the sum of products (x_{i j} − \\bar{x}_j)(x_{i k} − \\bar{x}_k) over all observations i.');
        steps.push('4. Divide by N − 1 for sample covariance or by N for population covariance, filling a p × p matrix.');
        steps.push('5. Optionally, transform the covariance matrix into a correlation matrix by dividing each entry by the product of the corresponding standard deviations.');
        steps.forEach(function (line) {
          var pEl = document.createElement('p');
          pEl.textContent = line;
          stepsEl.appendChild(pEl);
        });

        show(res);

        if (window.MathJax && window.MathJax.typesetPromise) {
          window.MathJax.typesetPromise([stepsEl]).catch(function () {});
        }
      }

      function onReset() {
        $('covmat-form').reset();
        $('data-input').value = '';
        $('variable-names').value = '';
        hide($('covmat-error'));
        hide($('covmat-results'));
      }

      document.addEventListener('DOMContentLoaded', function () {
        $('covmat-form').addEventListener('submit', onSubmit);
        $('covmat-reset').addEventListener('click', onReset);
        $('covmat-example').addEventListener('click', loadExample);
      });
    })();
  </script>


</body></html>
<!DOCTYPE html>
<html lang="en">
 <head>
  <link href="https://calcdomain.com/orifice-plate" rel="canonical"/>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Orifice Plate Flow Calculator - ISO 5167 Standard
  </title>
  <meta content="Calculate fluid flow rate (liquids &amp; gases) through an orifice plate based on ISO 5167. Enter pressure drop, density, and diameters to get mass and volumetric flow." name="description"/>
  <meta content="Ugo Candido" name="author"/>
  <link href="/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png"/>
  <link href="/favicon.svg" rel="icon" type="image/svg+xml"/>
  <link href="/favicon.ico" rel="shortcut"/>
  <link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
  <link href="/site.webmanifest" rel="manifest"/>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558fYv3eWK7go8HWaISdGfZ9u/IqR55LILGmgEMpGUFJGuRhLVnCALiB" rel="stylesheet"/>
  <script crossorigin="anonymous" defer="" integrity="sha384-hIoBPJpTadBVOjsjMZEJfaFGxaAPfW5dAiMgOkVKG8M4HNTs4LfsKNnxKNOTSBi8" src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js">
  </script>
  <script crossorigin="anonymous" defer="" integrity="sha384-43gviWU0YVjaDtb/Gf1ESgqCntTwubN/bRgrLqtWplvT1lP4GrZot6rGGDg/F9Jv" src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js">
  </script>
  <style>
   body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1.25rem;
overflow-x:auto; text-align: center; font-size: 1.1rem;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }

/* Stili del Calcolatore e Risultati (Conformi WCAG) */
.form-label {
display: block;
text-sm;
font-weight: 500;
color: #374151; /* gray-700 */
margin-bottom: 0.25rem;
}
.form-input {
display: block;
width: 100%;
padding: 0.75rem 0.75rem; /* 48px target-size */
border: 1px solid #d1d5db; /* gray-300 */
border-radius: 0.375rem;
box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
}
.form-input-group {
display: flex;
}
.form-input-group .form-input {
border-top-right-radius: 0;
border-bottom-right-radius: 0;
flex-grow: 1;
}
.form-input-group select {
border-top-left-radius: 0;
border-bottom-left-radius: 0;
border-left: 0;
background-color: #f9fafb; /* gray-50 */
}
.form-input:focus, .form-input-group select:focus {
outline: 2px solid transparent;
outline-offset: 2px;
border-color: #2563eb; /* blue-600 */
box-shadow: 0 0 0 2px #2563eb;
z-index: 10;
}
.required-marker {
color: #ef4444; /* red-500 */
margin-left: 0.25rem;
}
.error-message {
color: #dc2626; /* red-600 */
font-size: 0.875rem;
margin-top: 0.5rem;
min-height: 1.25rem; /* Previene CLS */
}
.tap-target {
min-height: 48px;
min-width: 48px;
display: inline-flex;
align-items: center;
justify-content: center;
padding-left: 1.5rem;
padding-right: 1.5rem;
}

/* Stile Focus Visibile Personalizzato (WCAG 2.4.7) */
:focus-visible {
outline: 3px solid #3b82f6; /* blue-500 */
outline-offset: 2px;
border-radius: 4px;
}
:focus:not(:focus-visible) {
outline: none;
}

/* Stili Risultati (Contrasto Corretto) */
.result-card {
background: #fff;
border: 1px solid #e5e7eb; /* gray-200 */
border-radius: 10px;
padding: 1rem 1.25rem;
text-align: center;
}
.result-card h4 {
font-size: 0.9rem;
font-weight: 500;
color: #4b5563; /* gray-600 */
margin-bottom: 0.25rem;
text-transform: uppercase;
letter-spacing: 0.05em;
}
.result-card p {
font-size: 1.5rem;
font-weight: 700;
color: #1f2937; /* gray-800 */
}
.result-card .unit {
font-size: 1rem;
font-weight: 500;
color: #374151;
margin-left: 0.25rem;
}

/* Stili Tab (A11y) */
[role="tab"] {
cursor: pointer;
padding: 0.75rem 1.25rem;
border-bottom: 3px solid transparent;
font-size: 1rem;
font-weight: 500;
}
[role="tab"][aria-selected="true"] {
border-bottom-color: #2563eb; /* blue-600 */
color: #2563eb;
font-weight: 600;
}
[role="tabpanel"] {
border-top: 1px solid #d1d5db;
padding-top: 1.5rem;
}

/* Stili Tooltip (A11y) */
.tooltip-btn {
background: none;
border: none;
padding: 0.25rem;
border-radius: 9999px;
color: #6b7280;
}
.tooltip-btn:hover { color: #111827; }
.tooltip-text {
display: none;
background-color: #1f2937;
color: white;
padding: 0.5rem 0.75rem;
border-radius: 6px;
font-size: 0.875rem;
margin-top: 0.5rem;
position: relative;
}
.tooltip-text[aria-hidden="false"] {
display: block;
}

/* Stili Stampa */
@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
}
  </style>
  <script type="application/ld+json">
   {
"@context": "https://schema.org",
"@type": "WebPage",
"name": "Orifice Plate Flow Calculator - ISO 5167 Standard",
"description": "Calculate fluid flow rate (liquids & gases) through an orifice plate based on ISO 5167. Enter pressure drop, density, and diameters to get mass and volumetric flow.",
"url": "https://calcdomain.com/orifice-plate",
"inLanguage": "en",
"author": { "@type": "Person", "name": "Ugo Candido" },
"publisher": { "@type": "Organization", "name": "CalcDomain" }
}
  </script>
  <script type="application/ld+json">
   {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Engineering",
      "item": "https://calcdomain.com/engineering"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Orifice Plate Flow Calculator",
      "item": "https://calcdomain.com/orifice-plate"
    }
  ]
}
  </script>
  <script type="application/ld+json">
   {
"@context": "https://schema.org",
"@type": "HowTo",
"name": "How to Calculate Flow Rate with an Orifice Plate",
"description": "A step-by-step guide to calculating fluid flow rate using an orifice plate based on ISO 5167.",
"step": [
{"@type": "HowToStep", "name": "Select Fluid Type", "text": "Choose whether you are calculating for a Liquid (incompressible) or a Gas/Vapor (compressible)."},
{"@type": "HowToStep", "name": "Enter Geometry", "text": "Input the Orifice Diameter (d) and the internal Pipe Diameter (D) using consistent units."},
{"@type": "HowToStep", "name": "Enter Fluid Properties", "text": "Input the Differential Pressure (ΔP) across the plate and the fluid's upstream Density (ρ₁)."},
{"@type": "HowToStep", "name": "Enter Gas-Specific Data", "text": "If calculating for a gas, you must also provide the Upstream Pressure (P₁), the Specific Heat Ratio (κ), and a Discharge Coefficient (C_d)."},
{"@type": "HowToStep", "name": "Enter Liquid-Specific Data", "text": "If calculating for a liquid, provide the Discharge Coefficient (C_d). A typical value is 0.61."},
{"@type": "HowToStep", "name": "Review Results", "text": "The calculator instantly provides the Mass Flow Rate (Q_m) and Volumetric Flow Rate (Q_v), along with intermediate values like the Beta Ratio (β) and Expansibility Factor (Y)."}
]
}
  </script>
  <script defer="" src="search.js">
  </script>
  <html>
   <head>
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=TUO_ID_GA">
    </script>
    <script>
     window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'TUO_ID_GA');
    </script>
   </head>
  </html>
 </head>
 <body class="bg-gray-50 text-gray-900">
  <header class="bg-white shadow-sm sticky top-0 z-50">
   <nav aria-label="Primary" class="container mx-auto px-4 lg:px-6 py-4">
    <div class="flex justify-between items-center">
     <a class="text-2xl font-bold text-blue-600" href="https://calcdomain.com">
      CalcDomain
     </a>
     <div class="w-full max-w-md hidden md:block mx-8">
      <div class="relative">
       <input autocomplete="off" class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" id="search-input" placeholder="Search for a calculator..." type="search"/>
       <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        </path>
       </svg>
       <div class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200" id="search-results">
       </div>
      </div>
     </div>
     <div class="hidden md:flex items-center space-x-6">
      <a class="text-gray-700 hover:text-blue-600 transition-colors" href="https://calcdomain.com/search">
       Advanced Search
      </a>
      <a class="text-gray-700 hover:text-blue-600 transition-colors" href="https://calcdomain.com/categories">
       Categories
      </a>
     </div>
     <button aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" class="md:hidden p-2" id="mobile-menu-toggle" type="button">
      <svg aria-hidden="true" class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
       <path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
       </path>
      </svg>
     </button>
    </div>
    <nav aria-label="Mobile menu" class="md:hidden mt-4 hidden" id="mobile-menu" role="navigation">
     <div class="mb-4">
      <div class="relative">
       <input class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" id="mobile-search-input" placeholder="Search calculators..." type="search"/>
       <svg aria-hidden="true" class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        </path>
       </svg>
      </div>
     </div>
     <div class="space-y-2">
      <a class="block py-2 text-gray-700 hover:text-blue-600" href="https://calcdomain.com/search">
       Advanced Search
      </a>
      <a class="block py-2 text-gray-700 hover:text-blue-600" href="https://calcdomain.com/categories">
       Categories
      </a>
     </div>
    </nav>
   </nav>
  </header>
  <html>
   <body>
    <nav class="container mx-auto px-4 py-2 text-sm text-gray-600" id="breadcrumb-container">
    </nav>
    <div class="container mx-auto px-4 py-8">
     <div class="flex flex-col lg:flex-row gap-8">
      <main class="w-full lg:w-2/3">
       <main class="container mx-auto px-4 lg:px-6 py-10">
        <div class="flex flex-col lg:flex-row gap-8">
         <section class="w-full lg:w-2/3">
          <nav aria-label="Breadcrumb" class="text-sm text-gray-600 mb-4">
           <a class="hover:text-blue-700" href="https://calcdomain.com">
            Home
           </a>
           »
           <a class="hover:text-blue-700" href="https://calcdomain.com/engineering">
            Engineering
           </a>
           »
Mechanical (Fluid Mechanics) »
           <span class="text-gray-900">
            Orifice Plate Flow Calculator
           </span>
          </nav>
          <div class="bg-white p-6 md:p-8 rounded-lg shadow-md" id="print-section">
           <h1 class="text-3xl font-extrabold text-gray-900 mb-2">
            Orifice Plate Flow Calculator
           </h1>
           <p class="text-gray-600 mb-6">
            Calculate the mass flow rate ($Q_m$) and volumetric flow rate ($Q_v$) for liquids and gases passing through an orifice plate. This tool implements the formulas from the ISO 5167 standard. Ideal for engineers and technicians sizing or verifying differential pressure flow meters.
           </p>
           <form id="orifice-calculator" onsubmit="return false;">
            <div class="mb-4 border-b border-gray-200">
             <div aria-label="Fluid Type" class="flex" role="tablist">
              <button aria-controls="panel-liquid" aria-selected="true" id="tab-liquid" role="tab" type="button">
               Liquid Flow
              </button>
              <button aria-controls="panel-gas" aria-selected="false" id="tab-gas" role="tab" type="button">
               Gas / Vapor Flow
              </button>
             </div>
            </div>
            <section class="space-y-6" id="calculator-ui">
             <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
               <label class="form-label" for="orificeDiameter">
                Orifice Diameter ($d$)
                <span aria-hidden="true" class="required-marker">
                 *
                </span>
               </label>
               <div class="form-input-group">
                <input aria-describedby="orificeDiameter-error" aria-required="true" class="form-input" id="orificeDiameter" min="0.0001" step="any" type="number" value="50"/>
                <select aria-label="Diameter unit" class="form-input" id="diameterUnit">
                 <option value="mm">
                  mm
                 </option>
                 <option value="cm">
                  cm
                 </option>
                 <option value="in">
                  in
                 </option>
                 <option value="m">
                  m
                 </option>
                 <option value="ft">
                  ft
                 </option>
                </select>
               </div>
               <div class="error-message" id="orificeDiameter-error" role="alert">
               </div>
              </div>
              <div>
               <label class="form-label" for="pipeDiameter">
                Pipe Diameter ($D$)
                <span aria-hidden="true" class="required-marker">
                 *
                </span>
               </label>
               <div class="form-input-group">
                <input aria-describedby="pipeDiameter-error" aria-required="true" class="form-input" id="pipeDiameter" min="0.0001" step="any" type="number" value="100"/>
               </div>
               <div class="error-message" id="pipeDiameter-error" role="alert">
               </div>
              </div>
              <div>
               <label class="form-label" for="pressureDrop">
                Differential Pressure ($\Delta P$)
                <span aria-hidden="true" class="required-marker">
                 *
                </span>
               </label>
               <div class="form-input-group">
                <input aria-describedby="pressureDrop-error" aria-required="true" class="form-input" id="pressureDrop" min="0.0001" step="any" type="number" value="25"/>
                <select aria-label="Pressure unit" class="form-input" id="pressureUnit">
                 <option value="kPa">
                  kPa
                 </option>
                 <option value="Pa">
                  Pa
                 </option>
                 <option value="bar">
                  bar
                 </option>
                 <option value="psi">
                  psi
                 </option>
                </select>
               </div>
               <div class="error-message" id="pressureDrop-error" role="alert">
               </div>
              </div>
             </div>
             <div class="space-y-6" id="panel-liquid" role="tabpanel" tabindex="0">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
               <div>
                <label class="form-label" for="liquidDensity">
                 Fluid Density ($\rho$)
                 <span aria-hidden="true" class="required-marker">
                  *
                 </span>
                </label>
                <div class="form-input-group">
                 <input aria-describedby="liquidDensity-error" aria-required="true" class="form-input" id="liquidDensity" min="0.0001" step="any" type="number" value="998"/>
                 <select aria-label="Liquid density unit" class="form-input" id="liquidDensityUnit">
                  <option value="kg/m³">
                   kg/m³
                  </option>
                  <option value="lb/ft³">
                   lb/ft³
                  </option>
                 </select>
                </div>
                <div class="error-message" id="liquidDensity-error" role="alert">
                </div>
               </div>
               <div>
                <div class="flex items-center space-x-1">
                 <label class="form-label" for="dischargeCoeff">
                  Discharge Coefficient ($C_d$)
                  <span aria-hidden="true" class="required-marker">
                   *
                  </span>
                 </label>
                 <button aria-controls="cd-tooltip-text" aria-expanded="false" aria-label="More info about Discharge Coefficient" class="tooltip-btn" id="cd-tooltip-btn" type="button">
                  <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                   <path clip-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM8.94 6.94a.75.75 0 11-1.06-1.061 3.5 3.5 0 014.12 4.122A.75.75 0 0110.82 10a2 2 0 10-2.298 1.75a.75.75 0 01-1.496-.068 3.5 3.5 0 014.12-4.122zM10 12.25a.75.75 0 01.75.75v.008a.75.75 0 01-1.5 0V13a.75.75 0 01.75-.75z" fill-rule="evenodd">
                   </path>
                  </svg>
                 </button>
                </div>
                <input aria-describedby="dischargeCoeff-error cd-tooltip-text" aria-required="true" class="form-input" id="dischargeCoeff" max="1" min="0.1" step="any" type="number" value="0.61"/>
                <div class="error-message" id="dischargeCoeff-error" role="alert">
                </div>
                <div aria-hidden="true" class="tooltip-text" id="cd-tooltip-text" role="tooltip">
                 A value of ~0.61 is typical for sharp-edged orifices with $Re &gt; 10^4$. Use manufacturer-specific data if available.
                </div>
               </div>
              </div>
             </div>
             <div class="hidden space-y-6" id="panel-gas" role="tabpanel" tabindex="0">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
               <div>
                <label class="form-label" for="gasDensity">
                 Upstream Density ($\rho_1$)
                 <span aria-hidden="true" class="required-marker">
                  *
                 </span>
                </label>
                <div class="form-input-group">
                 <input aria-describedby="gasDensity-error" aria-required="true" class="form-input" id="gasDensity" min="0.0001" step="any" type="number" value="1.225"/>
                 <select aria-label="Gas density unit" class="form-input" id="gasDensityUnit">
                  <option value="kg/m³">
                   kg/m³
                  </option>
                  <option value="lb/ft³">
                   lb/ft³
                  </option>
                 </select>
                </div>
                <div class="error-message" id="gasDensity-error" role="alert">
                </div>
               </div>
               <div>
                <label class="form-label" for="upstreamPressure">
                 Upstream Pressure ($P_1$)
                 <span aria-hidden="true" class="required-marker">
                  *
                 </span>
                </label>
                <div class="form-input-group">
                 <input aria-describedby="upstreamPressure-error" aria-required="true" class="form-input" id="upstreamPressure" min="0.0001" step="any" type="number" value="101.325"/>
                 <select aria-label="Upstream pressure unit" class="form-input" id="upstreamPressureUnit">
                  <option value="kPa">
                   kPa
                  </option>
                  <option value="Pa">
                   Pa
                  </option>
                  <option value="bar">
                   bar
                  </option>
                  <option value="psi">
                   psi
                  </option>
                 </select>
                </div>
                <div class="error-message" id="upstreamPressure-error" role="alert">
                </div>
               </div>
               <div>
                <label class="form-label" for="specificHeatRatio">
                 Specific Heat Ratio ($\kappa$ or $\gamma$)
                 <span aria-hidden="true" class="required-marker">
                  *
                 </span>
                </label>
                <input aria-describedby="specificHeatRatio-error" aria-required="true" class="form-input" id="specificHeatRatio" min="1" step="any" type="number" value="1.4"/>
                <div class="error-message" id="specificHeatRatio-error" role="alert">
                </div>
               </div>
               <div>
                <div class="flex items-center space-x-1">
                 <label class="form-label" for="dischargeCoeffGas">
                  Discharge Coefficient ($C_d$)
                  <span aria-hidden="true" class="required-marker">
                   *
                  </span>
                 </label>
                 <button aria-controls="cd-gas-tooltip-text" aria-expanded="false" aria-label="More info about Discharge Coefficient" class="tooltip-btn" id="cd-gas-tooltip-btn" type="button">
                  <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                   <path clip-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM8.94 6.94a.75.75 0 11-1.06-1.061 3.5 3.5 0 014.12 4.122A.75.75 0 0110.82 10a2 2 0 10-2.298 1.75a.75.75 0 01-1.496-.068 3.5 3.5 0 014.12-4.122zM10 12.25a.75.75 0 01.75.75v.008a.75.75 0 01-1.5 0V13a.75.75 0 01.75-.75z" fill-rule="evenodd">
                   </path>
                  </svg>
                 </button>
                </div>
                <input aria-describedby="dischargeCoeffGas-error cd-gas-tooltip-text" aria-required="true" class="form-input" id="dischargeCoeffGas" max="1" min="0.1" step="any" type="number" value="0.61"/>
                <div class="error-message" id="dischargeCoeffGas-error" role="alert">
                </div>
                <div aria-hidden="true" class="tooltip-text" id="cd-gas-tooltip-text" role="tooltip">
                 A value of ~0.61 is typical. For gases, $C_d$ is also a function of Reynolds number and $\beta$. Use manufacturer data.
                </div>
               </div>
              </div>
             </div>
             <div class="flex space-x-4 mt-6">
              <button class="tap-target px-6 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-gray-500 ring-offset-2" id="reset-btn" type="button">
               Reset
              </button>
             </div>
            </section>
           </form>
           <section aria-labelledby="results-heading" class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6" id="results" style="min-height: 320px;">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 text-center" id="results-heading">
             Flow Rate Results
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
             <div class="result-card bg-blue-100 border-blue-200 shadow-sm">
              <h4 class="text-blue-800">
               Mass Flow Rate ($Q_m$)
              </h4>
              <p class="text-blue-700 text-3xl font-bold" id="mass-flow-result">
               —
               <span class="unit" id="mass-flow-unit">
                kg/s
               </span>
              </p>
             </div>
             <div class="result-card bg-blue-100 border-blue-200 shadow-sm">
              <h4 class="text-blue-800">
               Volumetric Flow ($Q_v$)
              </h4>
              <p class="text-blue-700 text-3xl font-bold" id="volumetric-flow-result">
               —
               <span class="unit" id="volumetric-flow-unit">
                m³/s
               </span>
              </p>
             </div>
            </div>
            <h4 class="font-semibold text-gray-700 mt-6 mb-3 text-center">
             Intermediate Values
            </h4>
            <div aria-live="polite" class="grid grid-cols-1 sm:grid-cols-2 gap-3" id="conversions-container">
             <div class="result-card">
              <h4>
               Beta Ratio ($\beta$)
              </h4>
              <p id="beta-ratio-result">
               —
              </p>
             </div>
             <div class="result-card" id="expansibility-card">
              <h4>
               Expansibility ($Y$)
              </h4>
              <p id="expansibility-result">
               —
              </p>
             </div>
            </div>
           </section>
          </div>
          <article class="bg-white p-6 md:p-8 rounded-lg shadow-md mt-8 prose prose-blue">
           <h2 id="methodology">
            Data Source &amp; Methodology
           </h2>
           <p>
            This calculator provides a determination of mass and volumetric flow rate for fluids and gases based on the principles of differential pressure measurement. The calculations are rigorously based on the international standard:
           </p>
           <ul>
            <li>
             <strong>
              Authoritative Source:
             </strong>
             International Organization for Standardization (ISO)
            </li>
            <li>
             <strong>
              Reference:
             </strong>
             <a href="https://www.iso.org/standard/29595.html" rel="noopener" target="_blank">
              ISO 5167-2:2003
             </a>
             , "Measurement of fluid flow by means of pressure differential devices inserted in circular cross-section conduits running full - Part 2: Orifice plates".
            </li>
           </ul>
           <p>
            All calculations are based strictly on the formulas and data provided by this source. The tool calculates for turbulent flow where the Reynolds number ($Re$) is sufficiently high.
           </p>
           <h2 id="formula">
            The Formulas Explained
           </h2>
           <p>
            The fundamental equation for calculating mass flow rate ($Q_m$) through an orifice plate is:
           </p>
           <div aria-label="Mass flow rate formula" class="formula-box" role="math">
            $$ Q_m = \frac{C_d}{\sqrt{1-\beta^4}} \cdot Y \cdot \frac{\pi}{4} d^2 \sqrt{2 \cdot \Delta P \cdot \rho_1} $$
           </div>
           <h3 id="key-components">
            Key Components of the Equation
           </h3>
           <p>
            <strong>
             1. Beta Ratio ($\beta$):
            </strong>
            The ratio of the orifice diameter ($d$) to the pipe diameter ($D$).
           </p>
           <div aria-label="Beta ratio formula" class="formula-box" role="math">
            $$ \beta = \frac{d}{D} $$
           </div>
           <p>
            <strong>
             2. Incompressible Flow (Liquids):
            </strong>
            For liquids, the density is constant, so the
            <strong>
             Expansibility Factor ($Y$) is equal to 1
            </strong>
            . The formula simplifies to:
           </p>
           <div aria-label="Liquid flow rate formula" class="formula-box" role="math">
            $$ Q_m = \frac{C_d}{\sqrt{1-\beta^4}} \cdot \frac{\pi}{4} d^2 \sqrt{2 \cdot \Delta P \cdot \rho} $$
           </div>
           <p>
            <strong>
             3. Compressible Flow (Gases):
            </strong>
            For gases, the fluid expands and its density changes as it passes through the orifice. The
            <strong>
             Expansibility Factor ($Y$)
            </strong>
            accounts for this. This calculator uses the empirical formula for $Y$ (Reader-Harris/Stolz equation as per ISO 5167):
           </p>
           <div aria-label="Expansibility factor formula" class="formula-box" role="math">
            $$ Y = 1 - (0.41 + 0.35\beta^4) \frac{x_T}{\kappa} $$
            <p class="text-sm mt-2">
             where $x_T = \frac{\Delta P}{P_1}$ is the pressure ratio and $\kappa$ is the specific heat ratio.
            </p>
           </div>
           <p>
            <strong>
             4. Volumetric Flow Rate ($Q_v$):
            </strong>
            This is found by dividing the mass flow rate by the fluid density at upstream conditions ($\rho_1$).
           </p>
           <div aria-label="Volumetric flow rate formula" class="formula-box" role="math">
            $$ Q_v = \frac{Q_m}{\rho_1} $$
           </div>
           <h2 id="variables">
            Glossary of Variables
           </h2>
           <ul class="list-disc list-inside">
            <li>
             <strong>
              $Q_m$ (Mass Flow Rate):
             </strong>
             The mass of fluid passing through the orifice per unit of time (e.g., kg/s).
            </li>
            <li>
             <strong>
              $Q_v$ (Volumetric Flow Rate):
             </strong>
             The volume of fluid passing through the orifice per unit of time (e.g., m³/s).
            </li>
            <li>
             <strong>
              $d$ (Orifice Diameter):
             </strong>
             The internal diameter of the orifice hole, in meters (m).
            </li>
            <li>
             <strong>
              $D$ (Pipe Diameter):
             </strong>
             The internal diameter of the pipe, in meters (m).
            </li>
            <li>
             <strong>
              $\Delta P$ (Differential Pressure):
             </strong>
             The pressure drop between the upstream ($P_1$) and downstream ($P_2$) taps, in Pascals (Pa).
            </li>
            <li>
             <strong>
              $\rho_1$ (Upstream Density):
             </strong>
             The density of the fluid before the orifice plate, in kg/m³.
            </li>
            <li>
             <strong>
              $P_1$ (Upstream Pressure):
             </strong>
             The absolute static pressure of the fluid before the plate (Required for gases), in Pascals (Pa).
            </li>
            <li>
             <strong>
              $C_d$ (Discharge Coefficient):
             </strong>
             A unitless value that accounts for friction and non-ideal flow. It is determined empirically and is often ~0.61 for sharp-edged plates.
            </li>
            <li>
             <strong>
              $\beta$ (Beta Ratio):
             </strong>
             The unitless ratio $d/D$.
            </li>
            <li>
             <strong>
              $Y$ (Expansibility Factor):
             </strong>
             A unitless factor that accounts for the expansion of compressible fluids (gases). $Y=1$ for liquids.
            </li>
            <li>
             <strong>
              $\kappa$ (Specific Heat Ratio):
             </strong>
             A unitless property of a gas, also known as the isentropic exponent $\gamma$. (e.g., ~1.4 for air, ~1.33 for steam).
            </li>
           </ul>
           <h2 id="example">
            How It Works: A Step-by-Step Example (Liquid)
           </h2>
           <p>
            Let's calculate the flow rate of water through a 100mm pipe with a 50mm orifice plate.
           </p>
           <ul>
            <li>
             <strong>
              Fluid Type:
             </strong>
             Liquid (Water)
            </li>
            <li>
             <strong>
              Orifice Diameter ($d$):
             </strong>
             50 mm = $0.05 \text{ m}$
            </li>
            <li>
             <strong>
              Pipe Diameter ($D$):
             </strong>
             100 mm = $0.1 \text{ m}$
            </li>
            <li>
             <strong>
              Differential Pressure ($\Delta P$):
             </strong>
             25 kPa = $25000 \text{ Pa}$
            </li>
            <li>
             <strong>
              Fluid Density ($\rho$):
             </strong>
             998 kg/m³ (water at 20°C)
            </li>
            <li>
             <strong>
              Discharge Coefficient ($C_d$):
             </strong>
             0.61
            </li>
           </ul>
           <ol class="list-decimal list-inside">
            <li>
             <strong>
              Calculate Beta Ratio ($\beta$):
             </strong>
             <br/>
             $\beta = d / D = 0.05 \text{ m} / 0.1 \text{ m} = 0.5$
            </li>
            <li>
             <strong>
              Calculate Orifice Area ($A_d$):
             </strong>
             <br/>
             $A_d = (\pi/4) \cdot d^2 = (\pi/4) \cdot (0.05)^2 = 0.001963 \text{ m}^2$
            </li>
            <li>
             <strong>
              Calculate Velocity Term:
             </strong>
             <br/>
             $1 / \sqrt{1 - \beta^4} = 1 / \sqrt{1 - 0.5^4} = 1 / \sqrt{1 - 0.0625} = 1.0328$
            </li>
            <li>
             <strong>
              Calculate Mass Flow ($Q_m$):
             </strong>
             <br/>
             For liquids, $Y=1$.
             <br/>
             $Q_m = C_d \cdot (1 / \sqrt{1 - \beta^4}) \cdot A_d \cdot \sqrt{2 \cdot \Delta P \cdot \rho}$
             <br/>
             $Q_m = 0.61 \cdot 1.0328 \cdot 0.001963 \cdot \sqrt{2 \cdot 25000 \cdot 998}$
             <br/>
             $Q_m = 0.001235 \cdot \sqrt{49,900,000} \approx 0.001235 \cdot 7064$
             <br/>
             <strong>
              $Q_m \approx 8.72 \text{ kg/s}$
             </strong>
            </li>
            <li>
             <strong>
              Calculate Volumetric Flow ($Q_v$):
             </strong>
             <br/>
             $Q_v = Q_m / \rho = 8.72 \text{ kg/s} / 998 \text{ kg/m}^3$
             <br/>
             <strong>
              $Q_v \approx 0.00874 \text{ m}^3/\text{s}$
             </strong>
            </li>
           </ol>
           <h2 id="faq">
            Frequently Asked Questions (FAQ)
           </h2>
           <details>
            <summary>
             What is the Discharge Coefficient ($C_d$) and how do I find it?
            </summary>
            <p>
             The $C_d$ is an efficiency factor. It corrects the theoretical flow rate for real-world energy losses due to friction and turbulence. A value of 0.61 is a common approximation for sharp-edged orifices, but the true value depends on the Reynolds number ($Re$) and Beta Ratio ($\beta$). For high-accuracy work, you must use the Reader-Harris/Stolz equation (defined in ISO 5167) or use the value provided by your orifice plate manufacturer.
            </p>
           </details>
           <details>
            <summary>
             Why is the Beta Ratio ($\beta$) important?
            </summary>
            <p>
             The Beta Ratio is critical. ISO 5167 specifies that its calculations are only valid for $0.1 \le \beta \le 0.75$. Outside this range, measurement uncertainty increases significantly. A very small $\beta$ creates a large, permanent pressure loss, while a very large $\beta$ creates a small, difficult-to-measure differential pressure.
            </p>
           </details>
           <details>
            <summary>
             What's the difference between mass flow and volumetric flow?
            </summary>
            <p>
             <strong>
              Mass Flow ($Q_m$)
             </strong>
             is the mass of a substance passing a point per unit time (e.g., kg/s). It is independent of temperature and pressure changes.
             <strong>
              Volumetric Flow ($Q_v$)
             </strong>
             is the volume passing per unit time (e.g., m³/s). For gases, this value changes dramatically with pressure and temperature. Therefore, mass flow is the standard for gas measurement.
            </p>
           </details>
           <details>
            <summary>
             Why is the Expansibility Factor ($Y$) needed for gases but not liquids?
            </summary>
            <p>
             Liquids are considered incompressible, meaning their density ($\rho$) does not change when pressure changes. Gases are compressible. As a gas approaches the orifice, its pressure drops and it expands, causing its density to decrease. The $Y$ factor (which is always $\le 1$) corrects for this change in density, which is not accounted for in the basic Bernoulli equation.
            </p>
           </details>
           <details>
            <summary>
             When should I *not* use this calculator?
            </summary>
            <p>
             This calculator is for single-phase, Newtonian fluids in a full, circular pipe. Do not use it for:
            </p>
            <ul>
             <li>
              <strong>
               Multi-phase flow
              </strong>
              (e.g., liquid and gas mixed, or liquid with suspended solids).
             </li>
             <li>
              <strong>
               Non-Newtonian fluids
              </strong>
              (e.g., slurries, gels, polymers).
             </li>
             <li>
              <strong>
               Laminar flow
              </strong>
              (very low Reynolds number, $Re &lt; 4000$). This tool assumes turbulent flow.
             </li>
             <li>
              <strong>
               Choked flow
              </strong>
              (when gas velocity reaches the speed of sound, though a basic correction is applied).
             </li>
            </ul>
           </details>
           <div class="mt-8 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600">
            <p>
             <strong>
              Tool developed by Ugo Candido.
             </strong>
             <br/>
             Engineering content reviewed by the CalcDomain Editorial Board for ISO 5167 compliance.
             <br/>
             Last accuracy review:
             <time datetime="2025-11-03">
              November 3, 2025
             </time>
            </p>
           </div>
          </article>
         </section>
         <aside class="w-full lg:w-1/3">
          <div class="sticky top-24 space-y-6">
           <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
            Ad Placement (300×600)
           </div>
           <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="font-bold text-lg mb-3">
             Why Use This Calculator
            </h3>
            <ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
             <li>
              Calculates flow for both **liquids and gases**.
             </li>
             <li>
              Based on the **ISO 5167** engineering standard.
             </li>
             <li>
              Provides both Mass and Volumetric flow rates.
             </li>
             <li>
              Built-in unit conversions for all inputs.
             </li>
             <li>
              Shows key intermediate values like $\beta$ and $Y$.
             </li>
             <li>
              Fully accessible (WCAG 2.1 AA) and mobile-first.
             </li>
            </ul>
           </div>
           <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="font-bold text-lg mb-4">
             Related Fluid Mechanics Tools
            </h3>
            <ul class="space-y-3 text-sm">
             <li>
              Venturi Meter Flow Calculator
             </li>
             <li>
              <a class="text-blue-700 hover:underline" href="https://calcdomain.com/reynolds-number">
               Reynolds Number Calculator
              </a>
             </li>
             <li>
              Pipe Flow Calculator
             </li>
             <li>
              Fluid Density Calculator
             </li>
            </ul>
           </div>
          </div>
         </aside>
        </div>
       </main>
      </main>
      <aside class="w-full lg:w-1/3">
       <div class="sticky top-24 space-y-8">
        <div id="sidebar-ad-placeholder-top">
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
         <h3 class="font-bold text-lg mb-4">
          Popular Calculators
         </h3>
         <ul class="space-y-3">
          <li>
           <a class="text-blue-600 hover:underline" href="https://calcdomain.com/mortgage-payment">
            Mortgage Calculator
           </a>
          </li>
          <li>
           <a class="text-blue-600 hover:underline" href="https://calcdomain.com/percentage-calculator">
            Percentage Calculator
           </a>
          </li>
          <li>
           <a class="text-blue-600 hover:underline" href="https://calcdomain.com/bmi-calculator">
            BMI Calculator
           </a>
          </li>
         </ul>
        </div>
       </div>
      </aside>
     </div>
    </div>
   </body>
  </html>
  <footer class="bg-gray-900 text-white py-12">
   <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
     <div>
      <h3 class="text-2xl font-bold mb-4">
       CalcDomain
      </h3>
      <p class="text-gray-400 mb-4">
       Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
      </p>
     </div>
     <div>
      <h4 class="text-lg font-semibold mb-4">
       Categories
      </h4>
      <ul class="space-y-2">
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/finance">
         Finance
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/health-fitness">
         Health &amp; Fitness
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/math-conversions">
         Math &amp; Conversions
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/lifestyle-everyday">
         Lifestyle &amp; Everyday
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/construction-diy">
         Construction &amp; DIY
        </a>
       </li>
      </ul>
     </div>
     <div>
      <h4 class="text-lg font-semibold mb-4">
       Popular Tools
      </h4>
      <ul class="space-y-2">
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/mortgage-payment">
         Mortgage Calculator
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/percentage-calculator">
         Percentage Calculator
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/bmi-calculator">
         BMI Calculator
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/auto-loan-calculator">
         Auto Loan Calculator
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/house-affordability">
         House Affordability
        </a>
       </li>
      </ul>
     </div>
     <div>
      <h4 class="text-lg font-semibold mb-4">
       Support
      </h4>
      <ul class="space-y-2">
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/about">
         About Us
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/contact">
         Contact
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/privacy">
         Privacy Policy
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/terms">
         Terms of Service
        </a>
       </li>
       <li>
        <a class="text-gray-400 hover:text-white" href="https://calcdomain.com/sitemap">
         Site Map
        </a>
       </li>
      </ul>
     </div>
    </div>
    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
     <p>
      © 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone
     </p>
    </div>
   </div>
  </footer>
  <script defer="">
   document.addEventListener('DOMContentLoaded', () => {

// --- 1. Riferimenti DOM ---
const elements = {
// Tabs
tabLiquid: document.getElementById('tab-liquid'),
tabGas: document.getElementById('tab-gas'),
panelLiquid: document.getElementById('panel-liquid'),
panelGas: document.getElementById('panel-gas'),
// Common Inputs
orificeDiameter: document.getElementById('orificeDiameter'),
pipeDiameter: document.getElementById('pipeDiameter'),
diameterUnit: document.getElementById('diameterUnit'),
pressureDrop: document.getElementById('pressureDrop'),
pressureUnit: document.getElementById('pressureUnit'),
// Liquid Inputs
liquidDensity: document.getElementById('liquidDensity'),
liquidDensityUnit: document.getElementById('liquidDensityUnit'),
dischargeCoeff: document.getElementById('dischargeCoeff'),
// Gas Inputs
gasDensity: document.getElementById('gasDensity'),
gasDensityUnit: document.getElementById('gasDensityUnit'),
upstreamPressure: document.getElementById('upstreamPressure'),
upstreamPressureUnit: document.getElementById('upstreamPressureUnit'),
specificHeatRatio: document.getElementById('specificHeatRatio'),
dischargeCoeffGas: document.getElementById('dischargeCoeffGas'),
// Error Divs
orificeDiameterError: document.getElementById('orificeDiameter-error'),
pipeDiameterError: document.getElementById('pipeDiameter-error'),
pressureDropError: document.getElementById('pressureDrop-error'),
liquidDensityError: document.getElementById('liquidDensity-error'),
dischargeCoeffError: document.getElementById('dischargeCoeff-error'),
gasDensityError: document.getElementById('gasDensity-error'),
upstreamPressureError: document.getElementById('upstreamPressure-error'),
specificHeatRatioError: document.getElementById('specificHeatRatio-error'),
dischargeCoeffGasError: document.getElementById('dischargeCoeffGas-error'),
// Results
massFlowResult: document.getElementById('mass-flow-result'),
volumetricFlowResult: document.getElementById('volumetric-flow-result'),
betaRatioResult: document.getElementById('beta-ratio-result'),
expansibilityResult: document.getElementById('expansibility-result'),
expansibilityCard: document.getElementById('expansibility-card'),
// Tooltips
cdTooltipBtn: document.getElementById('cd-tooltip-btn'),
cdTooltipText: document.getElementById('cd-tooltip-text'),
cdGasTooltipBtn: document.getElementById('cd-gas-tooltip-btn'),
cdGasTooltipText: document.getElementById('cd-gas-tooltip-text'),
// Reset
resetBtn: document.getElementById('reset-btn'),
};

// --- 2. Costanti di Conversione (a SI) ---
const unitsToMeters = { 'm': 1, 'cm': 0.01, 'mm': 0.001, 'in': 0.0254, 'ft': 0.3048 };
const unitsToPa = { 'Pa': 1, 'kPa': 1000, 'bar': 100000, 'psi': 6894.76 };
const unitsToKgM3 = { 'kg/m³': 1, 'lb/ft³': 16.0185 };

// --- 3. Logica TAB (A11y) ---
function switchTab(activeTab) {
const isLiquid = activeTab === 'liquid';

elements.tabLiquid.setAttribute('aria-selected', isLiquid);
elements.tabGas.setAttribute('aria-selected', !isLiquid);

elements.panelLiquid.classList.toggle('hidden', !isLiquid);
elements.panelGas.classList.toggle('hidden', isLiquid);

elements.expansibilityCard.classList.toggle('hidden', isLiquid);

if (isLiquid) {
elements.panelLiquid.focus();
} else {
elements.panelGas.focus();
}
calculate(); // Ricalcola quando si cambia tab
}
elements.tabLiquid.addEventListener('click', () => switchTab('liquid'));
elements.tabGas.addEventListener('click', () => switchTab('gas'));

// --- 4. Logica Tooltip (A11y) ---
function setupTooltip(btn, text) {
btn.addEventListener('click', () => {
const isExpanded = btn.getAttribute('aria-expanded') === 'true';
btn.setAttribute('aria-expanded', !isExpanded);
text.setAttribute('aria-hidden', isExpanded);
});
}
setupTooltip(elements.cdTooltipBtn, elements.cdTooltipText);
setupTooltip(elements.cdGasTooltipBtn, elements.cdGasTooltipText);

// --- 5. Validazione e Calcolo ---
function validateInput(el, errorEl, minVal = 0) {
const val = parseFloat(el.value);
if (el.value === '' || isNaN(val)) {
errorEl.textContent = 'This field is required.';
return null;
}
if (val <= minVal) {
errorEl.textContent = `Value must be greater than ${minVal}.`;
return null;
}
errorEl.textContent = '';
return val;
}

function clearErrors() {
const errors = document.querySelectorAll('.error-message');
errors.forEach(e => e.textContent = '');
}

function resetResults() {
elements.massFlowResult.innerHTML = '— <span class="unit">kg/s</span>';
elements.volumetricFlowResult.innerHTML = '— <span class="unit">m³/s</span>';
elements.betaRatioResult.textContent = '—';
elements.expansibilityResult.textContent = '—';
}

function calculate() {
clearErrors();
resetResults();
let isValid = true;

// Valori Comuni
const d_val = validateInput(elements.orificeDiameter, elements.orificeDiameterError, 0);
const D_val = validateInput(elements.pipeDiameter, elements.pipeDiameterError, 0);
const deltaP_val = validateInput(elements.pressureDrop, elements.pressureDropError, 0);

if ([d_val, D_val, deltaP_val].includes(null)) isValid = false;

// Controllo Beta
if (d_val && D_val && d_val >= D_val) {
elements.orificeDiameterError.textContent = 'Orifice diameter must be smaller than pipe diameter.';
isValid = false;
}

// Conversione SI Comuni
const d_m = d_val * unitsToMeters[elements.diameterUnit.value];
const D_m = D_val * unitsToMeters[elements.diameterUnit.value];
const deltaP_Pa = deltaP_val * unitsToPa[elements.pressureUnit.value];

const beta = d_m / D_m;
const A_orifice = (Math.PI / 4) * Math.pow(d_m, 2);
const velocityTerm = 1 / Math.sqrt(1 - Math.pow(beta, 4));

let rho_1, C_d, Y, P1_Pa, kappa;
const mode = elements.tabLiquid.getAttribute('aria-selected') === 'true' ? 'liquid' : 'gas';

if (mode === 'liquid') {
const density_val = validateInput(elements.liquidDensity, elements.liquidDensityError, 0);
const cd_val = validateInput(elements.dischargeCoeff, elements.dischargeCoeffError, 0);
if ([density_val, cd_val].includes(null)) isValid = false;

rho_1 = density_val * unitsToKgM3[elements.liquidDensityUnit.value];
C_d = cd_val;
Y = 1;
elements.expansibilityResult.textContent = '1.000 (for liquids)';
} else { // Gas mode
const density_val = validateInput(elements.gasDensity, elements.gasDensityError, 0);
const P1_val = validateInput(elements.upstreamPressure, elements.upstreamPressureError, 0);
const kappa_val = validateInput(elements.specificHeatRatio, elements.specificHeatRatioError, 0);
const cd_val = validateInput(elements.dischargeCoeffGas, elements.dischargeCoeffGasError, 0);
if ([density_val, P1_val, kappa_val, cd_val].includes(null)) isValid = false;

rho_1 = density_val * unitsToKgM3[elements.gasDensityUnit.value];
P1_Pa = P1_val * unitsToPa[elements.upstreamPressureUnit.value];
kappa = kappa_val;
C_d = cd_val;

if (isValid) {
if (P1_Pa <= deltaP_Pa) {
elements.upstreamPressureError.textContent = 'Upstream pressure must be greater than differential pressure.';
isValid = false;
} else {
const pressureRatio = deltaP_Pa / P1_Pa;
Y = 1 - (0.41 + 0.35 * Math.pow(beta, 4)) * (pressureRatio / kappa);
if (Y < 0.667) Y = 0.667; // Choked flow approximation
elements.expansibilityResult.textContent = Y.toFixed(4);
}
}
}

// Calcolo finale solo se tutto è valido
if (isValid) {
elements.betaRatioResult.textContent = beta.toFixed(4);

const Qm_kg_s = C_d * velocityTerm * Y * A_orifice * Math.sqrt(2 * deltaP_Pa * rho_1);
const Qv_m3_s = Qm_kg_s / rho_1;

elements.massFlowResult.innerHTML = `${Qm_kg_s.toFixed(4)} <span class="unit">kg/s</span>`;
elements.volumetricFlowResult.innerHTML = `${Qv_m3_s.toFixed(5)} <span class="unit">m³/s</span>`;
} else {
// Resetta i risultati se la validazione fallisce
resetResults();
if (mode === 'liquid') {
elements.expansibilityResult.textContent = '1.000 (for liquids)';
}
if (!isNaN(beta)) {
elements.betaRatioResult.textContent = beta.toFixed(4);
}
}
}

// --- 6. Reset Form ---
function resetForm() {
// Common
elements.orificeDiameter.value = '50';
elements.pipeDiameter.value = '100';
elements.diameterUnit.value = 'mm';
elements.pressureDrop.value = '25';
elements.pressureUnit.value = 'kPa';
// Liquid
elements.liquidDensity.value = '998';
elements.liquidDensityUnit.value = 'kg/m³';
elements.dischargeCoeff.value = '0.61';
// Gas
elements.gasDensity.value = '1.225';
elements.gasDensityUnit.value = 'kg/m³';
elements.upstreamPressure.value = '101.325';
elements.upstreamPressureUnit.value = 'kPa';
elements.specificHeatRatio.value = '1.4';
elements.dischargeCoeffGas.value = '0.61';
// Calcola
calculate();
}
elements.resetBtn.addEventListener('click', resetForm);

// --- 7. Event Listeners ---
const allInputs = [
...document.querySelectorAll('#orifice-calculator input'),
...document.querySelectorAll('#orifice-calculator select')
];
allInputs.forEach(el => el.addEventListener('input', calculate));

// --- 8. Inizializzazione ---
switchTab('liquid'); // Inizia con la tab liquid
resetForm(); // Popola i valori di default e calcola

// --- 9. Logica Menu Mobile (dal template) ---
const menuToggle = document.getElementById('mobile-menu-toggle');
const mobileMenu = document.getElementById('mobile-menu');
menuToggle.addEventListener('click', () => {
const isHidden = mobileMenu.classList.toggle('hidden');
menuToggle.setAttribute('aria-expanded', !isHidden);
});

// --- 10. Logica Rendering LaTeX (necessaria) ---
renderMathInElement(document.body, {
delimiters: [
{left: "$$", right: "$$", display: true},
{left: "$", right: "$", display: false}
]
});

});
  </script>
  <script defer="True" src="/assets/js/script_menu.js">
  </script>
  <script defer="True" src="/assets/js/script_faq.js">
  </script>
  <script defer="True" src="search.js">
  </script>
 </body>
</html>

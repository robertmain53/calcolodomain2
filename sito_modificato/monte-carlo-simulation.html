<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Monte Carlo Simulation – Random Sampling Risk &amp; Uncertainty Calculator</title>
    <meta name="description" content="Run Monte Carlo simulations directly in your browser. Choose a distribution (normal, uniform, triangular, custom discrete), set number of runs, and estimate mean, percentiles, and probability of exceeding a threshold.">
    <link rel="canonical" href="https://calcdomain.com/monte-carlo-simulation">
    
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .card-hover { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .formula-box { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; overflow-x: auto; margin: 1rem 0; }
        .code-like { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
        table.hist-table th, table.hist-table td { font-size: 0.75rem; padding: 0.25rem 0.45rem; border-bottom: 1px solid #e5e7eb; white-space: nowrap; }
        table.hist-table th { background: #f9fafb; font-weight: 600; text-align: right; }
        table.hist-table th:first-child, table.hist-table td:first-child { text-align: left; }
        .badge { display: inline-flex; align-items: center; border-radius: 9999px; padding: 0.1rem 0.65rem; font-size: 0.7rem; font-weight: 500; }
    </style>
    
    <!-- HEAD_SCRIPTS_E_META -->
    <!-- Google tag (gtag.js) -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-7MB5V1LZRN');
    </script>

    <meta name="google-site-verification" content="_tiTZ9ivAdtXcAS9CMnTNJ549Sg39WVqP_ZFbWgglNA">

    <script>
        window.ezstandalone = window.ezstandalone || {};
        ezstandalone.cmd = ezstandalone.cmd || [];
    </script>

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://calcdomain.com"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Math & Conversions",
          "item": "https://calcdomain.com/categories/math-conversions"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Core Math Algebra",
          "item": "https://calcdomain.com/subcategories/core-math-algebra"
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is a Monte Carlo simulation?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A Monte Carlo simulation is a computational technique that uses repeated random sampling to estimate the distribution of outcomes of a process or model that involves uncertainty. Instead of a single deterministic value, it produces a range of possible results and their probabilities."
          }
        },
        {
          "@type": "Question",
          "name": "What can I do with this Monte Carlo simulation calculator?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "This calculator lets you choose a probability distribution (normal, uniform, triangular, or custom discrete), run thousands of simulations in your browser, and obtain summary statistics such as the mean, standard deviation, percentiles, and the probability of exceeding a chosen threshold."
          }
        },
        {
          "@type": "Question",
          "name": "How many simulations should I run?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "It depends on the precision you need and the complexity of your model. For quick intuition, a few thousand runs are often enough. For more stable estimates, 10,000 to 50,000 simulations are common. This calculator caps simulations at 200,000 per run to keep performance reasonable in a browser."
          }
        },
        {
          "@type": "Question",
          "name": "What distributions does this tool support?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The tool supports normal (Gaussian) distribution, uniform distribution, triangular distribution, and a custom discrete distribution where you specify values and their probabilities. You can use these to approximate many real-world situations in risk and uncertainty analysis."
          }
        },
        {
          "@type": "Question",
          "name": "Is the Monte Carlo simulation result exact?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No, Monte Carlo results are approximate and subject to sampling variability. Running more simulations typically reduces this variability, but the results will always be estimates of the true underlying probabilities and statistics."
          }
        }
      ]
    },
    {
      "@type": "HowTo",
      "name": "How to run a Monte Carlo simulation with this calculator",
      "description": "Step-by-step instructions for configuring and running a Monte Carlo simulation in your browser.",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Choose a distribution",
          "text": "Select a distribution type (normal, uniform, triangular, or custom discrete). For normal, specify mean and standard deviation; for uniform, specify minimum and maximum; for triangular, specify minimum, mode, and maximum; for custom discrete, input values and their probabilities."
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Set the number of simulations",
          "text": "Enter the number of Monte Carlo runs to perform. Larger numbers provide smoother estimates but require more computation time. Values between a few thousand and a few tens of thousands are typically sufficient for many use cases."
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Define an optional threshold",
          "text": "If you want to estimate the probability that the outcome exceeds a certain level, enter a threshold value. The calculator will report the proportion of simulated outcomes greater than or equal to this threshold."
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Run the simulation",
          "text": "Click \"Run simulation\". The tool draws random samples from your chosen distribution and computes summary statistics, percentiles, and a simple histogram of the results."
        },
        {
          "@type": "HowToStep",
          "position": 5,
          "name": "Interpret the output",
          "text": "Use the mean, standard deviation, percentiles, and histogram to understand the range and likelihood of outcomes. The estimated probability of exceeding your threshold can be used in risk analysis and decision-making."
        }
      ]
    }
  ]
}
</script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
.auditspine-badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  border:1px solid #e5e7eb;
  background:#f8fafc;
  color:#0f172a;
}
.auditspine-badge-warn{
  background:#fff7ed;
  border-color:#fed7aa;
  color:#9a3412;
}
</style>
</head>

<body class="bg-gray-50 text-gray-800">

    <!-- BODY_SCRIPTS_INIZIO -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
              <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      
      <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo; <a href="https://calcdomain.com/categories/math-conversions" class="hover:text-blue-600">Math & Conversions</a> &raquo; <a href="https://calcdomain.com/subcategories/core-math-algebra" class="hover:text-blue-600">Core Math Algebra</a></nav>
      
      <div class="flex flex-col lg:flex-row gap-8">
        
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">

            <h1 class="text-2xl md:text-3xl font-bold mb-3">Monte Carlo Simulation Calculator</h1>
            <p class="text-gray-700 mb-2">
              Run <strong>Monte Carlo simulations</strong> directly in your browser. Choose a probability distribution,
              define the number of runs, and obtain an empirical distribution of outcomes with summary statistics,
              percentiles and the probability of exceeding a threshold.
            </p>
            <p class="text-gray-700 mb-4">
              This tool is suitable for <strong>statistics students, engineers, analysts and decision-makers</strong>
              who need a quick way to explore uncertainty and risk without installing any software.
            </p>

            <!-- CONFIGURATION -->
            <section class="mb-5">
              <h2 class="text-lg font-semibold mb-2">1. Choose distribution and parameters</h2>

              <div class="mb-4">
                <label for="mc-dist" class="block text-sm font-medium text-gray-700 mb-1">
                  Distribution type
                </label>
                <select id="mc-dist" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <option value="normal">Normal (Gaussian)</option>
                  <option value="uniform">Uniform</option>
                  <option value="triangular">Triangular</option>
                  <option value="discrete">Custom discrete</option>
                </select>
                <p class="text-xs text-gray-500 mt-1">
                  Start with a simple distribution. For more complex models you can approximate the outcome as a single
                  random variable and simulate it here.
                </p>
              </div>

              <!-- NORMAL PARAMS -->
              <div class="grid md:grid-cols-2 gap-4 mb-4 mc-param-block" data-dist="normal">
                <div>
                  <label for="mc-normal-mean" class="block text-sm font-medium text-gray-700 mb-1">
                    Mean (μ)
                  </label>
                  <input id="mc-normal-mean" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="0">
                </div>
                <div>
                  <label for="mc-normal-sd" class="block text-sm font-medium text-gray-700 mb-1">
                    Standard deviation (σ)
                  </label>
                  <input id="mc-normal-sd" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="1">
                  <p class="text-xs text-gray-500 mt-1">
                    σ must be positive. Many finance and engineering models are approximated with a normal distribution.
                  </p>
                </div>
              </div>

              <!-- UNIFORM PARAMS -->
              <div class="grid md:grid-cols-2 gap-4 mb-4 mc-param-block hidden" data-dist="uniform">
                <div>
                  <label for="mc-uniform-min" class="block text-sm font-medium text-gray-700 mb-1">
                    Minimum (a)
                  </label>
                  <input id="mc-uniform-min" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="0">
                </div>
                <div>
                  <label for="mc-uniform-max" class="block text-sm font-medium text-gray-700 mb-1">
                    Maximum (b)
                  </label>
                  <input id="mc-uniform-max" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="1">
                  <p class="text-xs text-gray-500 mt-1">
                    Assumes all values between a and b are equally likely.
                  </p>
                </div>
              </div>

              <!-- TRIANGULAR PARAMS -->
              <div class="grid md:grid-cols-3 gap-4 mb-4 mc-param-block hidden" data-dist="triangular">
                <div>
                  <label for="mc-tri-min" class="block text-sm font-medium text-gray-700 mb-1">
                    Minimum (a)
                  </label>
                  <input id="mc-tri-min" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="0">
                </div>
                <div>
                  <label for="mc-tri-mode" class="block text-sm font-medium text-gray-700 mb-1">
                    Most likely (m)
                  </label>
                  <input id="mc-tri-mode" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="1">
                </div>
                <div>
                  <label for="mc-tri-max" class="block text-sm font-medium text-gray-700 mb-1">
                    Maximum (b)
                  </label>
                  <input id="mc-tri-max" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="2">
                  <p class="text-xs text-gray-500 mt-1">
                    Must satisfy a &lt;= m &lt;= b. Common in project management (optimistic, most likely, pessimistic).
                  </p>
                </div>
              </div>

              <!-- DISCRETE PARAMS -->
              <div class="mb-4 mc-param-block hidden" data-dist="discrete">
                <label for="mc-discrete-table" class="block text-sm font-medium text-gray-700 mb-1">
                  Custom discrete values and probabilities
                </label>
                <textarea id="mc-discrete-table" rows="5" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 code-like" placeholder="One value:probability pair per line, e.g.:
10:0.2
20:0.5
30:0.3">10:0.2
20:0.5
30:0.3</textarea>
                <p class="text-xs text-gray-500 mt-1">
                  Probabilities must be non-negative and sum to 1 (within rounding). Values can be any real numbers.
                </p>
              </div>

            </section>

            <!-- SIMULATION SETTINGS -->
            <section class="mb-5">
              <h2 class="text-lg font-semibold mb-2">2. Simulation settings</h2>

              <div class="grid md:grid-cols-3 gap-4 mb-3">
                <div>
                  <label for="mc-runs" class="block text-sm font-medium text-gray-700 mb-1">
                    Number of simulations
                  </label>
                  <input id="mc-runs" type="number" min="1" max="200000" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="10000">
                  <p class="text-xs text-gray-500 mt-1">
                    Up to 200,000 runs per execution.
                  </p>
                </div>
                <div>
                  <label for="mc-threshold" class="block text-sm font-medium text-gray-700 mb-1">
                    Threshold (optional)
                  </label>
                  <input id="mc-threshold" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g. 0 or 1000">
                  <p class="text-xs text-gray-500 mt-1">
                    If set, the tool will estimate P(X ≥ threshold).
                  </p>
                </div>
                <div>
                  <label for="mc-decimals" class="block text-sm font-medium text-gray-700 mb-1">
                    Decimals in output
                  </label>
                  <input id="mc-decimals" type="number" min="0" max="10" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="4">
                  <p class="text-xs text-gray-500 mt-1">
                    Controls rounding in the statistics table.
                  </p>
                </div>
              </div>

              <div class="flex flex-wrap items-center gap-3 mb-1">
                <button id="mc-run-btn" type="button" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Run simulation
                </button>
                <button id="mc-clear-btn" type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Clear results
                </button>
                <span class="badge bg-green-50 text-green-700 border border-green-200">
                  Pure client-side – no data uploaded
                </span>
              </div>
              <p id="mc-error" class="text-sm text-red-600 mt-1 hidden"></p>
            </section>

            <!-- RESULTS -->
            <section id="mc-results-section" class="mb-4 hidden">
              <h2 class="text-lg font-semibold mb-2">Monte Carlo results</h2>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div class="border border-gray-200 rounded-lg p-3 bg-gray-50">
                  <h3 class="text-sm font-semibold text-gray-800 mb-2">Summary statistics</h3>
                  <dl class="grid grid-cols-2 gap-x-3 gap-y-1 text-xs text-gray-800">
                    <div>
                      <dt class="font-medium">Simulations (n)</dt>
                      <dd id="mc-stat-n"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">Mean</dt>
                      <dd id="mc-stat-mean"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">Standard deviation</dt>
                      <dd id="mc-stat-sd"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">Minimum</dt>
                      <dd id="mc-stat-min"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">Maximum</dt>
                      <dd id="mc-stat-max"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">Median (50th pct)</dt>
                      <dd id="mc-stat-p50"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">5th percentile</dt>
                      <dd id="mc-stat-p5"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">95th percentile</dt>
                      <dd id="mc-stat-p95"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">Threshold</dt>
                      <dd id="mc-stat-th"></dd>
                    </div>
                    <div>
                      <dt class="font-medium">P(X ≥ threshold)</dt>
                      <dd id="mc-stat-prob"></dd>
                    </div>
                  </dl>
                </div>

                <div class="border border-gray-200 rounded-lg p-3 bg-white">
                  <h3 class="text-sm font-semibold text-gray-800 mb-2">Simulation settings used</h3>
                  <ul class="text-xs text-gray-800 space-y-1">
                    <li id="mc-setting-dist"></li>
                    <li id="mc-setting-params"></li>
                    <li id="mc-setting-runs"></li>
                    <li id="mc-setting-note"></li>
                  </ul>
                  <p class="text-xs text-gray-500 mt-2">
                    Results are empirical: repeat the simulation (or increase n) to see how estimates stabilize.
                  </p>
                </div>
              </div>

              <!-- HISTOGRAM -->
              <div class="border border-gray-200 rounded-lg p-3 bg-white mb-3 overflow-x-auto">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="text-sm font-semibold text-gray-800">Approximate histogram (10 bins)</h3>
                  <button id="mc-copy-btn" type="button" class="inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-xs font-medium text-gray-700 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500">
                    Copy stats as CSV
                  </button>
                </div>
                <table class="hist-table w-full text-sm">
                  <thead>
                    <tr>
                      <th>Bin range</th>
                      <th>Count</th>
                      <th>Relative freq.</th>
                      <th>Cumulative freq.</th>
                    </tr>
                  </thead>
                  <tbody id="mc-hist-body">
                    <!-- Filled by JS -->
                  </tbody>
                </table>
              </div>

              <p class="text-xs text-gray-500">
                Histogram bins are computed from the simulated minimum and maximum using equal-width bins. For
                publication-quality plots, export the CSV statistics and use a dedicated plotting tool.
              </p>
            </section>

            <!-- THEORY SECTION -->
            <section class="prose mt-6">
              <h2>What is a Monte Carlo simulation?</h2>
              <p>
                A <strong>Monte Carlo simulation</strong> is a numerical method that uses repeated random sampling
                to estimate the behavior of a system with uncertainty. Instead of solving a problem analytically,
                you model the uncertain inputs as <em>random variables</em> and simulate many possible scenarios.
              </p>
              <p>
                After many runs, you get an empirical approximation of the distribution of outcomes:
                averages, percentiles, and probabilities. This is extremely useful when the model is too complex
                for closed-form formulas, or when you want to visualize risk in a way that stakeholders can understand.
              </p>

              <h2>Basic Monte Carlo procedure</h2>
              <div class="formula-box text-sm">
                <ol class="mb-0">
                  <li>Define a model \( Y = g(X_1, X_2, \dots, X_k) \) where \( X_i \) are random inputs.</li>
                  <li>Choose probability distributions for each \( X_i \) (e.g. normal, uniform, triangular).</li>
                  <li>For each simulation run \( j = 1, \dots, N \):
                    <ul>
                      <li>Sample \( x_1^{(j)}, x_2^{(j)}, \dots, x_k^{(j)} \) from their distributions.</li>
                      <li>Compute the outcome \( y^{(j)} = g(x_1^{(j)}, \dots, x_k^{(j)}) \).</li>
                    </ul>
                  </li>
                  <li>Use the simulated outcomes \( y^{(1)}, \dots, y^{(N)} \) to estimate:
                    <ul>
                      <li>Mean and standard deviation.</li>
                      <li>Percentiles (e.g. 5th, 50th, 95th).</li>
                      <li>Probabilities of events, e.g. \( \mathbb{P}(Y \geq y_0) \).</li>
                    </ul>
                  </li>
                </ol>
              </div>

              <h2>Supported distributions in this calculator</h2>
              <h3>Normal (Gaussian) distribution</h3>
              <p>
                Defined by a mean \( \mu \) and standard deviation \( \sigma \), with density
              </p>
              <div class="formula-box text-sm">
                \[
                  f(x) = \frac{1}{\sigma \sqrt{2\pi}} \exp\left( -\frac{(x-\mu)^2}{2\sigma^2} \right).
                \]
              </div>
              <p>
                This is widely used for modelling measurement errors, aggregated effects and approximate returns.
              </p>

              <h3>Uniform distribution</h3>
              <p>
                All values in \([a,b]\) are equally likely. This is useful when you only know a range, not a shape.
              </p>

              <h3>Triangular distribution</h3>
              <p>
                Defined by minimum \( a \), most-likely value \( m \) and maximum \( b \).
                It approximates expert estimates of “optimistic–most likely–pessimistic” scenarios
                and is common in project management and cost estimation.
              </p>

              <h3>Custom discrete distribution</h3>
              <p>
                You specify a finite set of values \( x_i \) and probabilities \( p_i \) such that
                \( p_i \ge 0 \) and \( \sum_i p_i = 1 \). This covers scenarios like demand levels, failure modes,
                or aggregated outcomes from more complex models.
              </p>

              <h2>Monte Carlo simulation – FAQ</h2>

              <div class="mt-4 space-y-3">
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">How accurate is a Monte Carlo estimate?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      The accuracy improves roughly with \( 1/\sqrt{N} \), where \( N \) is the number of simulations.
                      Doubling the number of runs reduces the standard error by about 30%. For many practical decisions,
                      a few tens of thousands of runs are more than enough, but extremely tight confidence intervals
                      may require more.
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">Can I use this for financial risk analysis?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      Yes, as a didactic and exploratory tool. For example, you can model annual return as a normal
                      distribution and simulate terminal wealth. However, real financial modelling often requires
                      correlated variables, time-series structure and more complex distributions than this simple
                      one-variable simulator can provide.
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">Why do results change each time I run the simulation?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      The simulation uses pseudo-random numbers, so each run samples a different set of scenarios.
                      This is expected behavior in Monte Carlo methods. If you need more stable estimates, increase
                      the number of runs or average results from multiple runs.
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">What if my model has several uncertain inputs?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      This calculator focuses on a single aggregate random variable. In practice, you can model each
                      input separately in a spreadsheet or script, compute the resulting outcome for each scenario,
                      and then import the resulting values as a custom discrete distribution, or approximate them
                      with one of the supported distributions.
                    </p>
                  </div>
                </div>
              </div>
            </section>

          </div>
        
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[f(x) = \frac{1}{\sigma \sqrt{2\pi}} \exp\left( -\frac{(x-\mu)^2}{2\sigma^2} \right).\]</div>
  <pre class="auditspine-mono">f(x) = \frac{1}{\sigma \sqrt{2\pi}} \exp\left( -\frac{(x-\mu)^2}{2\sigma^2} \right).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\\]</div>
  <pre class="auditspine-mono">','\</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Define a model \( Y = g(X_1, X_2, \dots, X_k) \) where \( X_i \) are random inputs. Choose probability distributions for each \( X_i \) (e.g. normal, uniform, triangular). For each simulation run \( j = 1, \dots, N \): Sample \( x_1^{(j)}, x_2^{(j)}, \dots, x_k^{(j)} \) from their distributions. Compute the outcome \( y^{(j)} = g(x_1^{(j)}, \dots, x_k^{(j)}) \). Use the simulated outcomes \( y^{(1)}, \dots, y^{(N)} \) to estimate: Mean and standard deviation. Percentiles (e.g. 5th, 50th, 95th). Probabilities of events, e.g. \( \mathbb{P}(Y \geq y_0) \).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ f(x) = \frac{1}{\sigma \sqrt{2\pi}} \exp\left( -\frac{(x-\mu)^2}{2\sigma^2} \right). \]</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>NIST — Weights and measures</strong> — nist.gov · Accessed 2026-01-19<br><a href="https://www.nist.gov/pml/weights-and-measures" target="_blank" rel="nofollow noopener">https://www.nist.gov/pml/weights-and-measures</a></li>
<li><strong>FTC — Consumer advice</strong> — consumer.ftc.gov · Accessed 2026-01-19<br><a href="https://consumer.ftc.gov/" target="_blank" rel="nofollow noopener">https://consumer.ftc.gov/</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main>
        
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">Core Math &amp; Algebra tools</h2>
            <ul class="space-y-2 text-sm">
              <li><a href="https://calcdomain.com/g-test" class="text-blue-600 hover:underline">G-test (likelihood-ratio test)</a></li>
              <li><a href="https://calcdomain.com/foil" class="text-blue-600 hover:underline">FOIL Method Calculator</a></li>
              <li><a href="https://calcdomain.com/adjacency-matrix" class="text-blue-600 hover:underline">Graph Adjacency Matrix</a></li>
              <li><a href="https://calcdomain.com/speed-distance-time" class="text-blue-600 hover:underline">Speed, Distance, Time</a></li>
              <li><a href="https://calcdomain.com/friedman-test" class="text-blue-600 hover:underline">Friedman Test</a></li>
              <li><a href="https://calcdomain.com/traveling-salesman-problem" class="text-blue-600 hover:underline">Traveling Salesman Problem (TSP)</a></li>
              <li><a href="https://calcdomain.com/stem-and-leaf-plot" class="text-blue-600 hover:underline">Stem and Leaf Plot Generator</a></li>
              <li><a href="https://calcdomain.com/bisection-method" class="text-blue-600 hover:underline">Bisection Method</a></li>
              <li><span class="text-gray-500">Monte Carlo Simulation – you are here</span></li>
              <li><a href="https://calcdomain.com/lottery-odds" class="text-blue-600 hover:underline">Lottery Odds Calculator</a></li>
              <li><a href="https://calcdomain.com/dot-product" class="text-blue-600 hover:underline">Dot Product</a></li>
              <li><a href="https://calcdomain.com/matrix-determinant" class="text-blue-600 hover:underline">Matrix Determinant</a></li>
              <li><a href="https://calcdomain.com/partial-fraction-decomposition" class="text-blue-600 hover:underline">Partial Fraction Decomposition</a></li>
              <li><a href="https://calcdomain.com/trapezoid-area" class="text-blue-600 hover:underline">Trapezoid Area</a></li>
              <li><a href="https://calcdomain.com/combination-and-permutation" class="text-blue-600 hover:underline">Combination and Permutation</a></li>
            </ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">More statistics &amp; risk tools</h2>
            <ul class="space-y-2 text-sm">
              <li><a href="https://calcdomain.com/percent-error-calculator" class="text-blue-600 hover:underline">Percent Error Calculator</a></li>
              <li><a href="https://calcdomain.com/cohen-s-d-calculator" class="text-blue-600 hover:underline">Effect Size (Cohen’s d)</a></li>
              <li><a href="https://calcdomain.com/kruskal-wallis-test" class="text-blue-600 hover:underline">Kruskal–Wallis Test</a></li>
              <li><a href="https://calcdomain.com/spearmans-rank-correlation" class="text-blue-600 hover:underline">Spearman’s Rank Correlation</a></li>
            </ul>
          </div>
        </aside>
        
      </div>
    </div>

    <footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                                        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>




























    
    <script src="/assets/js/script_menu.js" defer=""></script>
    <script src="/assets/js/script_faq.js" defer=""></script>
    <script src="search.js" defer=""></script>
    
    <script>
      // ----- Utility -----
      function mcParseNumber(str, name, allowEmpty) {
        if (str == null) {
          if (allowEmpty) return null;
          throw new Error('Missing value for ' + name + '.');
        }
        const cleaned = String(str).trim().replace(',', '.');
        if (cleaned === '') {
          if (allowEmpty) return null;
          throw new Error('Missing value for ' + name + '.');
        }
        const val = Number(cleaned);
        if (!Number.isFinite(val)) {
          throw new Error('Invalid numeric value for ' + name + ': "' + str + '".');
        }
        return val;
      }

      function mcShuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          const tmp = array[i];
          array[i] = array[j];
          array[j] = tmp;
        }
      }

      // Normal via Box-Muller
      function mcRandomNormal(mu, sigma) {
        let u1 = 0, u2 = 0;
        while (u1 === 0) u1 = Math.random();
        while (u2 === 0) u2 = Math.random();
        const z = Math.sqrt(-2.0 * Math.log(u1)) * Math.cos(2.0 * Math.PI * u2);
        return mu + sigma * z;
      }

      // Triangular inverse CDF sampling
      function mcRandomTriangular(a, m, b) {
        const u = Math.random();
        const Fm = (m - a) / (b - a);
        if (u < Fm) {
          return a + Math.sqrt(u * (b - a) * (m - a));
        } else {
          return b - Math.sqrt((1 - u) * (b - a) * (b - m));
        }
      }

      // Parse discrete distribution lines "value:prob"
      function mcParseDiscrete(text) {
        const lines = text.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
        if (!lines.length) {
          throw new Error('Please enter at least one value:probability pair for the discrete distribution.');
        }
        const values = [];
        const probs = [];
        for (const line of lines) {
          const parts = line.split(':');
          if (parts.length !== 2) {
            throw new Error('Invalid discrete line: "' + line + '". Use value:probability.');
          }
          const v = mcParseNumber(parts[0], 'value', false);
          const p = mcParseNumber(parts[1], 'probability', false);
          if (p < 0) {
            throw new Error('Probabilities must be non-negative. Check line: "' + line + '".');
          }
          values.push(v);
          probs.push(p);
        }
        const totalP = probs.reduce((a, x) => a + x, 0);
        if (totalP <= 0) {
          throw new Error('Sum of probabilities must be positive.');
        }
        const normProbs = probs.map(p => p / totalP);
        // Build cumulative distribution
        const cum = [];
        let acc = 0;
        for (let i = 0; i < normProbs.length; i++) {
          acc += normProbs[i];
          cum.push(acc);
        }
        // Numerical stability: force last to 1
        cum[cum.length - 1] = 1;

        return {
          values,
          cumProbs: cum
        };
      }

      function mcRandomDiscrete(model) {
        const u = Math.random();
        const cum = model.cumProbs;
        const values = model.values;
        for (let i = 0; i < cum.length; i++) {
          if (u <= cum[i]) return values[i];
        }
        return values[values.length - 1];
      }

      // Percentile (0-1) from sorted array
      function mcPercentile(sorted, p) {
        if (!sorted.length) return NaN;
        if (p <= 0) return sorted[0];
        if (p >= 1) return sorted[sorted.length - 1];
        const idx = (sorted.length - 1) * p;
        const lo = Math.floor(idx);
        const hi = Math.ceil(idx);
        if (lo === hi) return sorted[lo];
        const w = idx - lo;
        return sorted[lo] * (1 - w) + sorted[hi] * w;
      }

      (function () {
        const distSelect = document.getElementById('mc-dist');
        const paramBlocks = document.querySelectorAll('.mc-param-block');

        function updateParamVisibility() {
          const dist = distSelect.value;
          paramBlocks.forEach(block => {
            const d = block.getAttribute('data-dist');
            block.classList.toggle('hidden', d !== dist);
          });
        }

        distSelect.addEventListener('change', updateParamVisibility);
        updateParamVisibility();

        const runsEl = document.getElementById('mc-runs');
        const thEl = document.getElementById('mc-threshold');
        const decEl = document.getElementById('mc-decimals');
        const errorEl = document.getElementById('mc-error');
        const resultsSection = document.getElementById('mc-results-section');
        const histBody = document.getElementById('mc-hist-body');

        const nEl = document.getElementById('mc-stat-n');
        const meanEl = document.getElementById('mc-stat-mean');
        const sdEl = document.getElementById('mc-stat-sd');
        const minEl = document.getElementById('mc-stat-min');
        const maxEl = document.getElementById('mc-stat-max');
        const p5El = document.getElementById('mc-stat-p5');
        const p50El = document.getElementById('mc-stat-p50');
        const p95El = document.getElementById('mc-stat-p95');
        const thOutEl = document.getElementById('mc-stat-th');
        const probEl = document.getElementById('mc-stat-prob');

        const settingDistEl = document.getElementById('mc-setting-dist');
        const settingParamsEl = document.getElementById('mc-setting-params');
        const settingRunsEl = document.getElementById('mc-setting-runs');
        const settingNoteEl = document.getElementById('mc-setting-note');

        function clearResults() {
          errorEl.classList.add('hidden');
          errorEl.textContent = '';
          resultsSection.classList.add('hidden');
          histBody.innerHTML = '';
        }

        function fmt(x, decimals) {
          return Number.isFinite(x) ? x.toFixed(decimals) : 'NaN';
        }

        document.getElementById('mc-run-btn').addEventListener('click', function () {
          clearResults();
          try {
            const dist = distSelect.value;
            let decimals = Number(decEl.value);
            if (!Number.isFinite(decimals)) decimals = 4;
            decimals = Math.min(10, Math.max(0, Math.round(decimals)));
            decEl.value = decimals;

            let runs = Number(runsEl.value);
            if (!Number.isFinite(runs) || runs <= 0) {
              throw new Error('Number of simulations must be a positive integer.');
            }
            runs = Math.min(200000, Math.round(runs));
            runsEl.value = runs;

            const threshold = mcParseNumber(thEl.value, 'threshold', true);

            // Build sampler function depending on distribution
            let sampler;
            let paramsDesc = '';

            if (dist === 'normal') {
              const mu = mcParseNumber(document.getElementById('mc-normal-mean').value, 'mean μ', false);
              const sd = mcParseNumber(document.getElementById('mc-normal-sd').value, 'standard deviation σ', false);
              if (sd <= 0) throw new Error('Standard deviation σ must be positive.');
              sampler = () => mcRandomNormal(mu, sd);
              paramsDesc = 'Normal(μ = ' + mu + ', σ = ' + sd + ')';
            } else if (dist === 'uniform') {
              const a = mcParseNumber(document.getElementById('mc-uniform-min').value, 'minimum a', false);
              const b = mcParseNumber(document.getElementById('mc-uniform-max').value, 'maximum b', false);
              if (b < a) throw new Error('For uniform distribution, maximum b must be ≥ minimum a.');
              sampler = () => a + (b - a) * Math.random();
              paramsDesc = 'Uniform(a = ' + a + ', b = ' + b + ')';
            } else if (dist === 'triangular') {
              const a = mcParseNumber(document.getElementById('mc-tri-min').value, 'minimum a', false);
              const m = mcParseNumber(document.getElementById('mc-tri-mode').value, 'mode m', false);
              const b = mcParseNumber(document.getElementById('mc-tri-max').value, 'maximum b', false);
              if (b < a) throw new Error('For triangular distribution, b must be ≥ a.');
              if (m < a || m > b) throw new Error('For triangular distribution, mode m must satisfy a ≤ m ≤ b.');
              sampler = () => mcRandomTriangular(a, m, b);
              paramsDesc = 'Triangular(a = ' + a + ', m = ' + m + ', b = ' + b + ')';
            } else if (dist === 'discrete') {
              const text = document.getElementById('mc-discrete-table').value;
              const model = mcParseDiscrete(text);
              sampler = () => mcRandomDiscrete(model);
              paramsDesc = 'Custom discrete (' + model.values.length + ' values)';
            } else {
              throw new Error('Unknown distribution type.');
            }

            // Run simulation
            const values = new Array(runs);
            let sum = 0;
            let sumSq = 0;
            let minVal = Infinity;
            let maxVal = -Infinity;
            let countGE = 0;

            for (let i = 0; i < runs; i++) {
              const x = sampler();
              values[i] = x;
              sum += x;
              sumSq += x * x;
              if (x < minVal) minVal = x;
              if (x > maxVal) maxVal = x;
              if (threshold != null && x >= threshold) countGE++;
            }

            const mean = sum / runs;
            const variance = runs > 1 ? (sumSq - runs * mean * mean) / (runs - 1) : 0;
            const sd = variance > 0 ? Math.sqrt(variance) : 0;

            const sorted = values.slice().sort((a, b) => a - b);
            const p5 = mcPercentile(sorted, 0.05);
            const p50 = mcPercentile(sorted, 0.5);
            const p95 = mcPercentile(sorted, 0.95);

            const probGE = threshold != null ? countGE / runs : null;

            // Histogram (10 bins)
            histBody.innerHTML = '';
            const bins = 10;
            const hist = new Array(bins).fill(0);
            let binMin = minVal;
            let binMax = maxVal;
            if (!Number.isFinite(binMin) || !Number.isFinite(binMax)) {
              binMin = 0;
              binMax = 0;
            }
            if (binMax === binMin) {
              // Degenerate: put everything into a single bin
              hist[0] = runs;
            } else {
              const width = (binMax - binMin) / bins;
              for (const x of values) {
                let idx = Math.floor((x - binMin) / width);
                if (idx < 0) idx = 0;
                if (idx >= bins) idx = bins - 1;
                hist[idx]++;
              }
            }
            let cum = 0;
            for (let i = 0; i < bins; i++) {
              const count = hist[i];
              cum += count;
              let rangeFrom = binMin + (binMax - binMin) * (i / bins);
              let rangeTo = binMin + (binMax - binMin) * ((i + 1) / bins);
              if (binMax === binMin) {
                rangeFrom = binMin;
                rangeTo = binMax;
              }
              const tr = document.createElement('tr');
              const tdRange = document.createElement('td');
              const tdCount = document.createElement('td');
              const tdFreq = document.createElement('td');
              const tdCum = document.createElement('td');
              tdRange.textContent = '[' + fmt(rangeFrom, decimals) + ', ' + fmt(rangeTo, decimals) + (i === bins - 1 ? ']' : ')');
              tdCount.textContent = count;
              tdFreq.textContent = (count / runs).toFixed(4);
              tdCum.textContent = (cum / runs).toFixed(4);
              tdCount.style.textAlign = 'right';
              tdFreq.style.textAlign = 'right';
              tdCum.style.textAlign = 'right';
              tr.appendChild(tdRange);
              tr.appendChild(tdCount);
              tr.appendChild(tdFreq);
              tr.appendChild(tdCum);
              histBody.appendChild(tr);
            }

            // Fill stats
            nEl.textContent = runs;
            meanEl.textContent = fmt(mean, decimals);
            sdEl.textContent = fmt(sd, decimals);
            minEl.textContent = fmt(minVal, decimals);
            maxEl.textContent = fmt(maxVal, decimals);
            p5El.textContent = fmt(p5, decimals);
            p50El.textContent = fmt(p50, decimals);
            p95El.textContent = fmt(p95, decimals);
            thOutEl.textContent = threshold != null ? fmt(threshold, decimals) : 'Not set';
            probEl.textContent = threshold != null ? (probGE * 100).toFixed(2) + ' %' : 'Not computed';

            settingDistEl.innerHTML = '<strong>Distribution:</strong> ' + distSelect.options[distSelect.selectedIndex].text;
            settingParamsEl.innerHTML = '<strong>Parameters:</strong> ' + paramsDesc;
            settingRunsEl.innerHTML = '<strong>Simulations:</strong> ' + runs;
            settingNoteEl.innerHTML = '<strong>Threshold:</strong> ' + (threshold != null ? fmt(threshold, decimals) : 'not set');

            resultsSection.classList.remove('hidden');
          } catch (err) {
            errorEl.textContent = err.message || 'Unable to run Monte Carlo simulation. Please check your inputs.';
            errorEl.classList.remove('hidden');
          }
        });

        document.getElementById('mc-clear-btn').addEventListener('click', function () {
          clearResults();
        });

        document.getElementById('mc-copy-btn').addEventListener('click', function () {
          if (histBody.children.length === 0) return;
          let csv = 'bin_from,bin_to,count,relative_frequency,cumulative_frequency\n';
          for (const tr of histBody.children) {
            const cells = Array.from(tr.querySelectorAll('td')).map(td => td.textContent.trim());
            // cells[0] is like "[a, b)" or "[a, b]"
            const range = cells[0].replace('[', '').replace(']', '').replace(')', '');
            const parts = range.split(',');
            const from = parts[0].trim();
            const to = parts[1].trim();
            csv += [from, to, cells[1], cells[2], cells[3]].join(',') + '\n';
          }
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(csv).catch(function () {});
          }
        });
      })();
    </script>

    <script>
      window.MathJax = { tex: { inlineMath: [['\\(','\\)'], [',
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    


</body></html>, ',
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    


</body></html>]], displayMath: [['\\[','\\]']] }, svg: { fontCache: 'global' } };,
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    


</body></html>
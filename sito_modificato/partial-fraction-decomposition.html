<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Partial Fraction Decomposition Calculator – Rational Functions</title>
    <meta name="description" content="Partial fraction decomposition calculator for rational functions. Enter a numerator polynomial and a factored denominator, perform long division if needed, and get the exact partial fraction form with step-by-step working.">
    <link rel="canonical" href="https://calcdomain.com/partial-fraction-decomposition">
    
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .card-hover { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .formula-box { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; overflow-x: auto; margin: 1rem 0; }
        .code-like { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
        .badge { display: inline-flex; align-items: center; border-radius: 9999px; padding: 0.1rem 0.65rem; font-size: 0.7rem; font-weight: 500; }
        .result-label { font-weight: 500; color: #111827; }
        .result-value { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
    
    <!-- HEAD_SCRIPTS_E_META -->
    <!-- Google tag (gtag.js) -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-7MB5V1LZRN');
    </script>

    <meta name="google-site-verification" content="_tiTZ9ivAdtXcAS9CMnTNJ549Sg39WVqP_ZFbWgglNA">

    <script>
        window.ezstandalone = window.ezstandalone || {};
        ezstandalone.cmd = ezstandalone.cmd || [];
    </script>

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://calcdomain.com"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Math & Conversions",
          "item": "https://calcdomain.com/categories/math-conversions"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Core Math Algebra",
          "item": "https://calcdomain.com/subcategories/core-math-algebra"
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is partial fraction decomposition?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Partial fraction decomposition rewrites a rational function P(x)/Q(x) as a sum of simpler fractions whose denominators are linear or quadratic factors of Q(x). This is especially useful for integration and inverse Laplace transforms."
          }
        },
        {
          "@type": "Question",
          "name": "When can a rational function be decomposed into partial fractions?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A rational function P(x)/Q(x) can be decomposed into partial fractions when Q(x) factors into linear or irreducible quadratic factors over the field of interest, and when the fraction is proper (degree(P) < degree(Q)). If not, polynomial long division is applied first."
          }
        },
        {
          "@type": "Question",
          "name": "Does the order of factors in the denominator matter?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. The order of the factors does not change the rational function. However, it changes the order in which terms A1/(x − r1) + A2/(x − r2) + ... are displayed. The calculator uses the factors in the exact order you enter them."
          }
        },
        {
          "@type": "Question",
          "name": "Can this calculator handle repeated factors or irreducible quadratics?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "This version focuses on denominators that factor into distinct simple linear factors of the form (a x + b). Repeated factors and irreducible quadratic factors are not yet handled automatically and will trigger a clear warning in the results."
          }
        },
        {
          "@type": "Question",
          "name": "Why should I enter the denominator in factored form?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Factoring higher-degree polynomials reliably is non-trivial. By entering the denominator as a product of linear factors, the calculator can solve for the partial fraction coefficients exactly via a linear system, avoiding numerical instability and ambiguities in factorization."
          }
        }
      ]
    },
    {
      "@type": "HowTo",
      "name": "How to use the partial fraction decomposition calculator",
      "description": "Step-by-step instructions to decompose a rational function into partial fractions.",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Enter the numerator polynomial",
          "text": "Type the numerator P(x) as a polynomial in x, for example 2x^2 - 3x + 1. Use ^ for powers and decimals if needed."
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Enter the denominator in factored form",
          "text": "Write the denominator Q(x) as a product of simple linear factors, such as (x-1)(x+2) or (2x+3)(x-4). Repeated factors and quadratic factors are not supported in this version."
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Set decimal precision",
          "text": "Choose how many decimal places you want for the coefficients of the quotient and the partial fractions."
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Run the calculation",
          "text": "Click the \"Decompose\" button. The tool will perform polynomial long division if necessary and then solve for the constants A1, A2, ..., An in the partial fraction expansion."
        },
        {
          "@type": "HowToStep",
          "position": 5,
          "name": "Review the step-by-step working",
          "text": "Use the breakdown to see the expanded denominator, long division (if applied), the linear system in A1,...,An, and the final decomposition in both factored and expanded polynomial form."
        }
      ]
    }
  ]
}
</script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
.auditspine-badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  border:1px solid #e5e7eb;
  background:#f8fafc;
  color:#0f172a;
}
.auditspine-badge-warn{
  background:#fff7ed;
  border-color:#fed7aa;
  color:#9a3412;
}
</style>
</head>

<body class="bg-gray-50 text-gray-800">

    <!-- BODY_SCRIPTS_INIZIO -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
              <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      
      <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo; <a href="https://calcdomain.com/categories/math-conversions" class="hover:text-blue-600">Math & Conversions</a> &raquo; <a href="https://calcdomain.com/subcategories/core-math-algebra" class="hover:text-blue-600">Core Math Algebra</a></nav>
      
      <div class="flex flex-col lg:flex-row gap-8">
        
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">

            <h1 class="text-2xl md:text-3xl font-bold mb-3">Partial Fraction Decomposition Calculator</h1>
            <p class="text-gray-700 mb-2">
              This <strong>partial fraction decomposition calculator</strong> rewrites a rational function
              \( \frac{P(x)}{Q(x)} \) as a sum of simpler fractions with <strong>factored denominators</strong>.
              It is aimed at students and professionals working with integration, Laplace transforms,
              and algebraic manipulation of rational functions.
            </p>
            <p class="text-gray-700 mb-4">
              Enter a <strong>numerator polynomial</strong> \( P(x) \) and a <strong>denominator in factored form</strong>
              built from distinct linear factors, such as \( (x-1)(x+2)(2x-3) \). The tool performs
              <strong>polynomial long division</strong> if needed and then solves for the partial fraction
              coefficients using a linear system of equations.
            </p>

            <!-- INPUT SECTION -->
            <section class="mb-5">
              <h2 class="text-lg font-semibold mb-2">1. Define the rational function</h2>

              <div class="mb-3">
                <label for="pf-numerator" class="block text-sm font-medium text-gray-700 mb-1">
                  Numerator polynomial \( P(x) \)
                </label>
                <input id="pf-numerator" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g. 2x^2 - 3x + 1">
                <p class="text-xs text-gray-600 mt-1">
                  Use <span class="code-like">x</span> as the variable, <span class="code-like">^</span> for powers,
                  and standard algebraic notation: examples: <span class="code-like">x^2+3x-4</span>,
                  <span class="code-like">-0.5x^3 + 2x</span>.
                </p>
              </div>

              <div class="mb-3">
                <label for="pf-den-factored" class="block text-sm font-medium text-gray-700 mb-1">
                  Denominator in factored form \( Q(x) \)
                </label>
                <input id="pf-den-factored" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g. (x-1)(x+2)(2x-3)">
                <p class="text-xs text-gray-600 mt-1">
                  Enter a product of <strong>distinct linear factors</strong> of the form
                  <span class="code-like">(a x + b)</span>. Examples:
                  <span class="code-like">(x-1)(x+2)</span>,
                  <span class="code-like">(2x+3)(x-4)(x+5)</span>.
                  Repeated factors like <span class="code-like">(x-1)^2</span> and quadratic factors
                  <span class="code-like">(x^2+1)</span> are not supported in this version.
                </p>
              </div>

              <div class="grid md:grid-cols-3 gap-4 mb-3">
                <div>
                  <label for="pf-decimals" class="block text-sm font-medium text-gray-700 mb-1">
                    Decimal places
                  </label>
                  <input id="pf-decimals" type="number" min="0" max="10" value="4" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="md:col-span-2 flex items-end">
                  <div class="flex flex-wrap gap-2">
                    <button id="pf-example-1" type="button" class="inline-flex items-center px-3 py-1.5 bg-gray-100 text-gray-800 text-xs font-medium rounded-md hover:bg-gray-200">
                      Example: (2x+3)/[(x-1)(x+2)]
                    </button>
                    <button id="pf-example-2" type="button" class="inline-flex items-center px-3 py-1.5 bg-gray-100 text-gray-800 text-xs font-medium rounded-md hover:bg-gray-200">
                      Example: improper (x^2+1)/[(x-1)(x+1)]
                    </button>
                    <button id="pf-clear-inputs" type="button" class="inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                      Clear inputs
                    </button>
                  </div>
                </div>
              </div>

              <div class="flex flex-wrap items-center gap-3 mb-1">
                <button id="pf-run-btn" type="button" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Decompose
                </button>
                <button id="pf-clear-results" type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Clear results
                </button>
                <span class="badge bg-gray-50 text-gray-700 border border-gray-300">
                  Requires distinct linear factors in the denominator
                </span>
              </div>
              <p id="pf-error" class="text-sm text-red-600 mt-1 hidden"></p>
            </section>

            <!-- RESULTS SECTION -->
            <section id="pf-results" class="mb-5 hidden">
              <h2 class="text-lg font-semibold mb-2">2. Results</h2>

              <div class="border border-gray-200 rounded-lg p-3 bg-gray-50 mb-3">
                <h3 class="text-sm font-semibold text-gray-800 mb-2">Decomposition overview</h3>
                <p class="text-xs text-gray-800 mb-1">
                  <span class="result-label">Original rational function:</span>
                  <span id="pf-out-original" class="result-value"></span>
                </p>
                <p class="text-xs text-gray-800 mb-1">
                  <span class="result-label">Expanded denominator \( Q(x) \):</span>
                  <span id="pf-out-den-expanded" class="result-value"></span>
                </p>
                <p class="text-xs text-gray-800 mb-1">
                  <span class="result-label">Classification:</span>
                  <span id="pf-out-classification" class="result-value"></span>
                </p>
              </div>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div class="border border-gray-200 rounded-lg p-3 bg-white">
                  <h3 class="text-sm font-semibold text-gray-800 mb-2">Final form</h3>
                  <p class="text-xs text-gray-800 mb-1">
                    <span class="result-label">Polynomial part \( Q(x) \):</span>
                    <span id="pf-out-quotient" class="result-value"></span>
                  </p>
                  <p class="text-xs text-gray-800 mb-1">
                    <span class="result-label">Proper fraction remainder:</span>
                    <span id="pf-out-remainder" class="result-value"></span>
                  </p>
                  <p class="text-xs text-gray-800 mb-1">
                    <span class="result-label">Partial fractions (plain text):</span>
                    <span id="pf-out-partial-text" class="result-value"></span>
                  </p>
                  <p class="text-xs text-gray-800 mb-1">
                    <span class="result-label">Partial fractions (TeX):</span>
                    <span id="pf-out-partial-tex" class="result-value"></span>
                  </p>
                  <p class="text-xs text-gray-500">
                    TeX form can be pasted into LaTeX documents or CAS systems that accept LaTeX input.
                  </p>
                </div>

                <div class="border border-gray-200 rounded-lg p-3 bg-white">
                  <h3 class="text-sm font-semibold text-gray-800 mb-2">Coefficients summary</h3>
                  <p id="pf-out-coeff-summary" class="text-xs text-gray-800 mb-1"></p>
                  <p class="text-xs text-gray-500">
                    Coefficients are rounded to the selected number of decimal places for display. Internally,
                    the linear system is solved in double precision.
                  </p>
                </div>
              </div>

              <div class="border border-gray-200 rounded-lg p-3 bg-white mb-3 overflow-x-auto">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="text-sm font-semibold text-gray-800">
                    Step-by-step breakdown
                  </h3>
                  <button id="pf-copy-steps" type="button" class="inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-xs font-medium text-gray-700 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500">
                    Copy as plain text
                  </button>
                </div>
                <pre id="pf-out-steps" class="text-xs text-gray-800 whitespace-pre-wrap code-like"></pre>
              </div>

              <div id="pf-warning" class="text-xs text-yellow-800 bg-yellow-50 border border-yellow-200 rounded-md p-2 hidden"></div>
            </section>

            <!-- THEORY SECTION -->
            <section class="prose mt-6">
              <h2>Partial fraction decomposition – core idea</h2>
              <p>
                Given a rational function
                \[
                  \frac{P(x)}{Q(x)},
                \]
                where \( P(x) \) and \( Q(x) \) are polynomials and \( \deg P &lt; \deg Q \),
                a <strong>partial fraction decomposition</strong> rewrites it as a sum of simpler fractions
                whose denominators are factors of \( Q(x) \).
              </p>
              <p>
                In the simplest case where the denominator factors into <strong>distinct linear factors</strong>,
                \[
                  Q(x) = (x - r_1)(x - r_2)\cdots(x - r_n),
                \]
                we search for constants \( A_1,\dots,A_n \) such that
                \[
                  \frac{P(x)}{Q(x)} = \frac{A_1}{x - r_1} + \frac{A_2}{x - r_2} + \cdots + \frac{A_n}{x - r_n}.
                \]
              </p>

              <h2>From polynomial long division to partial fractions</h2>
              <p>
                If \( \deg P \geq \deg Q \), the rational function is <strong>improper</strong> and we start
                with polynomial long division:
              </p>
              <div class="formula-box text-sm">
                \[
                  \frac{P(x)}{Q(x)} = S(x) + \frac{R(x)}{Q(x)},
                \]
              </div>
              <p>
                where \( S(x) \) is a polynomial (the <em>quotient</em>) and
                \( R(x) \) is the <em>remainder</em> satisfying \( \deg R &lt; \deg Q \).
                Only the proper fraction \( R(x)/Q(x) \) needs to be decomposed into partial fractions.
              </p>

              <h2>Solving for the coefficients of the partial fractions</h2>
              <p>
                Suppose the denominator is factored into distinct linear factors:
                \[
                  Q(x) = (a_1 x + b_1)(a_2 x + b_2)\cdots(a_n x + b_n).
                \]
                The calculator assumes a decomposition of the form
              </p>
              <div class="formula-box text-sm">
                \[
                  \frac{R(x)}{Q(x)} =
                  \frac{A_1}{a_1 x + b_1} +
                  \frac{A_2}{a_2 x + b_2} + \cdots +
                  \frac{A_n}{a_n x + b_n}.
                \]
              </div>
              <p>
                Multiplying both sides by \( Q(x) \) we obtain a polynomial identity:
              </p>
              <div class="formula-box text-sm">
                \[
                  R(x) =
                  A_1 \prod_{j\neq 1}(a_j x + b_j) +
                  A_2 \prod_{j\neq 2}(a_j x + b_j) + \cdots +
                  A_n \prod_{j\neq n}(a_j x + b_j).
                \]
              </div>
              <p>
                Expanding each product on the right-hand side and matching coefficients of powers of \( x \)
                yields a <strong>linear system</strong> in the unknowns \( A_1,\dots,A_n \). The calculator
                solves this system using Gaussian elimination, which is numerically stable for moderate degrees.
              </p>

              <h2>Typical use cases</h2>
              <ul>
                <li>
                  <strong>Integration</strong>: partial fractions reduce rational integrals to sums of basic
                  integrals of the forms \( \int \frac{1}{x-a}\,dx \) and \( \int \frac{1}{(x-a)^n}\,dx \).
                </li>
                <li>
                  <strong>Laplace transform inversion</strong>: decomposing rational transfer functions into
                  elementary terms whose inverse Laplace transforms are tabulated.
                </li>
                <li>
                  <strong>Control and signal processing</strong>: analyzing poles of transfer functions and
                  breaking them into contributions of simple first-order components.
                </li>
                <li>
                  <strong>Algebraic simplification</strong>: rewriting expressions to isolate singularities
                  or analyze asymptotic behaviour near poles.
                </li>
              </ul>

              <h2>Limitations of this calculator</h2>
              <ul>
                <li>
                  Only <strong>distinct linear factors</strong> in the denominator are supported:
                  terms like \( (x-1)^2 \) or \( (x^2+1) \) are intentionally rejected with a clear warning.
                </li>
                <li>
                  All coefficients are treated as real numbers; complex partial fractions are not handled.
                </li>
                <li>
                  For better numerical stability, choose moderate coefficient sizes and avoid highly ill-conditioned
                  factorizations if exact arithmetic is important.
                </li>
              </ul>

              <h2>Partial fraction decomposition – FAQ</h2>

              <div class="mt-4 space-y-3">
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">Why do I need the denominator in factored form?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      Factoring arbitrary polynomials is a non-trivial task and can introduce numerical
                      or symbolic ambiguities. By asking you to provide the denominator as a product of
                      linear factors, the calculator can focus on the partial fraction step itself and
                      give you a transparent, step-by-step solution based on a clean linear system.
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">What happens if the degree of the numerator is too large?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      If \( \deg P \geq \deg Q \), the calculator performs polynomial long division to split
                      the function into a polynomial part plus a proper fraction. Only the proper fraction
                      is decomposed into partial fractions. The polynomial part is displayed explicitly.
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">Can I use this as a teaching aid in class?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      Yes. The step-by-step breakdown shows the expanded denominator, the long division
                      (when needed), and the linear system used to solve for the coefficients. You can
                      copy the full working as plain text or TeX and adapt it to slides or handouts.
                    </p>
                  </div>
                </div>
              </div>
            </section>

          </div>
        
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\frac{P(x)}{Q(x)},\]</div>
  <pre class="auditspine-mono">\frac{P(x)}{Q(x)},</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[Q(x) = (x - r_1)(x - r_2)\cdots(x - r_n),\]</div>
  <pre class="auditspine-mono">Q(x) = (x - r_1)(x - r_2)\cdots(x - r_n),</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\frac{P(x)}{Q(x)} = \frac{A_1}{x - r_1} + \frac{A_2}{x - r_2} + \cdots + \frac{A_n}{x - r_n}.\]</div>
  <pre class="auditspine-mono">\frac{P(x)}{Q(x)} = \frac{A_1}{x - r_1} + \frac{A_2}{x - r_2} + \cdots + \frac{A_n}{x - r_n}.</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\frac{P(x)}{Q(x)} = S(x) + \frac{R(x)}{Q(x)},\]</div>
  <pre class="auditspine-mono">\frac{P(x)}{Q(x)} = S(x) + \frac{R(x)}{Q(x)},</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[Q(x) = (a_1 x + b_1)(a_2 x + b_2)\cdots(a_n x + b_n).\]</div>
  <pre class="auditspine-mono">Q(x) = (a_1 x + b_1)(a_2 x + b_2)\cdots(a_n x + b_n).</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\frac{R(x)}{Q(x)} = \frac{A_1}{a_1 x + b_1} + \frac{A_2}{a_2 x + b_2} + \cdots + \frac{A_n}{a_n x + b_n}.\]</div>
  <pre class="auditspine-mono">\frac{R(x)}{Q(x)} = \frac{A_1}{a_1 x + b_1} + \frac{A_2}{a_2 x + b_2} + \cdots + \frac{A_n}{a_n x + b_n}.</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ \frac{P(x)}{Q(x)} = S(x) + \frac{R(x)}{Q(x)}, \]</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ \frac{R(x)}{Q(x)} = \frac{A_1}{a_1 x + b_1} + \frac{A_2}{a_2 x + b_2} + \cdots + \frac{A_n}{a_n x + b_n}. \]</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ R(x) = A_1 \prod_{j\neq 1}(a_j x + b_j) + A_2 \prod_{j\neq 2}(a_j x + b_j) + \cdots + A_n \prod_{j\neq n}(a_j x + b_j). \]</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>NIST — Weights and measures</strong> — nist.gov · Accessed 2026-01-19<br><a href="https://www.nist.gov/pml/weights-and-measures" target="_blank" rel="nofollow noopener">https://www.nist.gov/pml/weights-and-measures</a></li>
<li><strong>FTC — Consumer advice</strong> — consumer.ftc.gov · Accessed 2026-01-19<br><a href="https://consumer.ftc.gov/" target="_blank" rel="nofollow noopener">https://consumer.ftc.gov/</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main>
        
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">Core Math &amp; Algebra tools</h2>
            <ul class="space-y-2 text-sm">
              <li><a href="https://calcdomain.com/bisection-method" class="text-blue-600 hover:underline">Bisection Method</a></li>
              <li><a href="https://calcdomain.com/monte-carlo-simulation" class="text-blue-600 hover:underline">Monte Carlo Simulation</a></li>
              <li><a href="https://calcdomain.com/lottery-odds" class="text-blue-600 hover:underline">Lottery Odds</a></li>
              <li><a href="https://calcdomain.com/dot-product" class="text-blue-600 hover:underline">Dot Product</a></li>
              <li><a href="https://calcdomain.com/matrix-determinant" class="text-blue-600 hover:underline">Matrix Determinant</a></li>
              <li><span class="text-gray-500">Partial Fraction Decomposition – you are here</span></li>
              <li><a href="https://calcdomain.com/trapezoid-area" class="text-blue-600 hover:underline">Trapezoid Area</a></li>
              <li><a href="https://calcdomain.com/combination-and-permutation" class="text-blue-600 hover:underline">Combination and Permutation</a></li>
              <li><a href="https://calcdomain.com/torus-volume" class="text-blue-600 hover:underline">Torus Volume</a></li>
              <li><a href="https://calcdomain.com/matrix-transpose" class="text-blue-600 hover:underline">Matrix Transpose</a></li>
              <li><a href="https://calcdomain.com/surface-area" class="text-blue-600 hover:underline">Surface Area</a></li>
            </ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Related calculus tools</h2>
            <ul class="space-y-2 text-sm">
              <li><a href="https://calcdomain.com/integral" class="text-blue-600 hover:underline">Integral Calculator</a></li>
              <li><a href="https://calcdomain.com/derivative" class="text-blue-600 hover:underline">Derivative Calculator</a></li>
              <li><a href="https://calcdomain.com/limit" class="text-blue-600 hover:underline">Limit Calculator</a></li>
            </ul>
          </div>
        </aside>
        
      </div>
    </div>

    <footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                                                        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>






























    
    <script src="/assets/js/script_menu.js" defer=""></script>
    <script src="/assets/js/script_faq.js" defer=""></script>
    <script src="search.js" defer=""></script>
    
    <script>
      // ---------------- Polynomial utilities ----------------
      function pfTrimPoly(p) {
        var res = p.slice();
        while (res.length > 1 && Math.abs(res[res.length - 1]) < 1e-14) {
          res.pop();
        }
        if (res.length === 0) res = [0];
        return res;
      }

      function pfPolyAdd(a, b) {
        var n = Math.max(a.length, b.length);
        var res = new Array(n).fill(0);
        for (var i = 0; i < n; i++) {
          var ai = i < a.length ? a[i] : 0;
          var bi = i < b.length ? b[i] : 0;
          res[i] = ai + bi;
        }
        return pfTrimPoly(res);
      }

      function pfPolySub(a, b) {
        var n = Math.max(a.length, b.length);
        var res = new Array(n).fill(0);
        for (var i = 0; i < n; i++) {
          var ai = i < a.length ? a[i] : 0;
          var bi = i < b.length ? b[i] : 0;
          res[i] = ai - bi;
        }
        return pfTrimPoly(res);
      }

      function pfPolyMul(a, b) {
        var res = new Array(a.length + b.length - 1).fill(0);
        for (var i = 0; i < a.length; i++) {
          for (var j = 0; j < b.length; j++) {
            res[i + j] += a[i] * b[j];
          }
        }
        return pfTrimPoly(res);
      }

      // Long division: dividend / divisor, both arrays of coeffs (low to high)
      function pfPolyDiv(dividend, divisor) {
        dividend = pfTrimPoly(dividend);
        divisor = pfTrimPoly(divisor);
        var n = dividend.length - 1;
        var m = divisor.length - 1;
        if (m < 0 || Math.abs(divisor[m]) < 1e-14) {
          throw new Error('Division by zero polynomial.');
        }
        if (n < m) {
          return { q: [0], r: dividend.slice() };
        }

        var R = dividend.slice();
        var Q = new Array(n - m + 1).fill(0);

        for (var k = n - m; k >= 0; k--) {
          var coeff = R[m + k] / divisor[m];
          Q[k] = coeff;
          for (var j = 0; j <= m; j++) {
            R[j + k] -= coeff * divisor[j];
          }
        }

        return { q: pfTrimPoly(Q), r: pfTrimPoly(R) };
      }

      // Divide polynomial D(x) by linear factor (a x + b)
      function pfPolyDivByLinear(D, a, b) {
        if (Math.abs(a) < 1e-14) {
          throw new Error('Invalid linear factor: coefficient of x is zero.');
        }
        var R = D.slice();
        var n = R.length - 1;
        if (n < 1) {
          return { q: [0], r: R.slice() };
        }
        var Q = new Array(n).fill(0);
        for (var deg = n; deg >= 1; deg--) {
          var q = R[deg] / a;
          Q[deg - 1] += q;
          R[deg] -= q * a;
          R[deg - 1] -= q * b;
        }
        return { q: pfTrimPoly(Q), r: pfTrimPoly([R[0]]) };
      }

      function pfFormatPoly(coeffs, variable, decimals) {
        variable = variable || 'x';
        coeffs = pfTrimPoly(coeffs);
        var parts = [];
        for (var i = coeffs.length - 1; i >= 0; i--) {
          var c = coeffs[i];
          if (Math.abs(c) < 1e-14) continue;
          var sign = c >= 0 ? '+' : '-';
          var absC = Math.abs(c);
          var coeffStr;
          if (i === 0) {
            coeffStr = absC.toFixed(decimals);
          } else {
            if (Math.abs(absC - 1) < 1e-14) {
              coeffStr = '';
            } else {
              coeffStr = absC.toFixed(decimals) + '*';
            }
          }
          var term;
          if (i === 0) {
            term = coeffStr;
          } else if (i === 1) {
            term = coeffStr + variable;
          } else {
            term = coeffStr + variable + '^' + i;
          }
          parts.push((parts.length === 0 ? (sign === '-' ? '-' : '') : ' ' + sign + ' ') + term);
        }
        if (parts.length === 0) return '0';
        return parts.join('');
      }

      // Parse polynomial in x from string like "2x^2-3x+1"
      function pfParsePolynomial(raw) {
        var s = String(raw || '').toLowerCase().replace(/\s+/g, '');
        if (!s) {
          throw new Error('Please enter the numerator polynomial P(x).');
        }
        // Replace leading '+' if missing
        if (s[0] !== '+' && s[0] !== '-') s = '+' + s;
        // Split into terms
        s = s.replace(/-/g, '+-');
        var terms = s.split('+').filter(function (t) { return t.trim() !== ''; });
        if (!terms.length) {
          throw new Error('No valid terms found in P(x).');
        }
        var coeffs = [];
        terms.forEach(function (t) {
          var match = t.match(/^([+-]?\d*\.?\d*)x(\^([+-]?\d+))?$/);
          var c, e;
          if (match) {
            var cStr = match[1];
            if (cStr === '' || cStr === '+' || cStr === '+0') c = 1;
            else if (cStr === '-') c = -1;
            else c = Number(cStr);
            if (!Number.isFinite(c)) {
              throw new Error('Invalid coefficient in term "' + t + '".');
            }
            e = match[3] ? Number(match[3]) : 1;
            if (!Number.isInteger(e) || e < 0) {
              throw new Error('Invalid exponent in term "' + t + '".');
            }
          } else {
            // Constant term
            c = Number(t);
            if (!Number.isFinite(c)) {
              throw new Error('Invalid term "' + t + '".');
            }
            e = 0;
          }
          if (!Number.isFinite(e) || e < 0) {
            throw new Error('Unsupported exponent in term "' + t + '".');
          }
          if (e >= coeffs.length) {
            var oldLen = coeffs.length;
            coeffs.length = e + 1;
            for (var i = oldLen; i <= e; i++) {
              if (coeffs[i] === undefined) coeffs[i] = 0;
            }
          }
          coeffs[e] = (coeffs[e] || 0) + c;
        });
        for (var i = 0; i < coeffs.length; i++) {
          if (typeof coeffs[i] !== 'number') coeffs[i] = 0;
        }
        return pfTrimPoly(coeffs);
      }

      // ---------------- Factor parsing ----------------
      // Parse factored denominator like (x-1)(2x+3)(x+5)
      function pfParseFactoredDen(raw) {
        var s = String(raw || '').replace(/\s+/g, '');
        if (!s) {
          throw new Error('Please enter the denominator in factored form Q(x).');
        }
        var factors = [];
        var re = /\(([^()]+)\)(\^(\d+))?/g;
        var match;
        var lastIndex = 0;
        while ((match = re.exec(s)) !== null) {
          if (match.index !== lastIndex) {
            // There is some text outside groups, likely malformed input
            var between = s.slice(lastIndex, match.index);
            if (between !== '' && between !== '*' ) {
              throw new Error('Unexpected text "' + between + '" between factors in Q(x).');
            }
          }
          lastIndex = re.lastIndex;
          var expr = match[1];
          var expStr = match[3];
          var exp = expStr ? Number(expStr) : 1;
          if (!Number.isInteger(exp) || exp < 1) {
            throw new Error('Invalid exponent "' + (expStr || '') + '" in factor (' + expr + ').');
          }
          if (exp > 1) {
            throw new Error('Repeated factors such as (' + expr + ')^' + exp + ' are not supported yet (distinct linear factors only).');
          }
          var f = pfParseLinearFactor(expr);
          factors.push(f);
        }
        if (factors.length === 0) {
          throw new Error('Could not find any factors in Q(x). Make sure to use parentheses, e.g. (x-1)(x+2).');
        }
        if (lastIndex !== s.length) {
          var tail = s.slice(lastIndex);
          if (tail !== '' && tail !== '*' ) {
            throw new Error('Unexpected trailing text "' + tail + '" after the last factor.');
          }
        }
        return factors;
      }

      function pfParseLinearFactor(expr) {
        var e = expr.replace(/\s+/g, '');
        if (e.indexOf('x') === -1) {
          throw new Error('Only linear factors in x are supported. Problematic factor: (' + expr + ').');
        }
        var parts = e.split('x');
        var left = parts[0];        // coefficient of x
        var right = parts[1] || ''; // constant part

        var a;
        if (left === '' || left === '+') a = 1;
        else if (left === '-') a = -1;
        else {
          a = Number(left);
          if (!Number.isFinite(a)) {
            throw new Error('Invalid coefficient in factor (' + expr + ').');
          }
        }

        var b;
        if (right === '') {
          b = 0;
        } else {
          // right starts with + or -, or maybe a number directly
          if (right[0] !== '+' && right[0] !== '-') {
            // e.g., "x2" meaning x + 2? We'll enforce explicit +/- to avoid ambiguity
            throw new Error('Expected + or - before constant term in factor (' + expr + '). Use e.g. (x+2) or (2x-3).');
          }
          b = Number(right);
          if (!Number.isFinite(b)) {
            throw new Error('Invalid constant term in factor (' + expr + ').');
          }
        }

        return { a: a, b: b, expr: '(' + expr + ')' };
      }

      // ---------------- Linear system solver ----------------
      // Solve M * x = b via Gaussian elimination with partial pivoting
      function pfSolveLinearSystem(M, b) {
        var n = M.length;
        if (n === 0) throw new Error('Empty linear system.');
        var m = M[0].length;
        if (b.length !== n) throw new Error('Dimension mismatch in linear system.');

        // Build augmented matrix
        var A = new Array(n);
        for (var i = 0; i < n; i++) {
          A[i] = M[i].slice();
          A[i].push(b[i]);
        }

        var eps = 1e-12;

        // Forward elimination
        for (var col = 0; col < m; col++) {
          // Pivot selection
          var pivotRow = col;
          var maxAbs = Math.abs(A[col][col]);
          for (var r = col + 1; r < n; r++) {
            var val = Math.abs(A[r][col]);
            if (val > maxAbs) {
              maxAbs = val;
              pivotRow = r;
            }
          }
          if (maxAbs < eps) {
            throw new Error('The linear system for partial fractions is singular or ill-conditioned.');
          }
          // Swap rows
          if (pivotRow !== col) {
            var tmp = A[col];
            A[col] = A[pivotRow];
            A[pivotRow] = tmp;
          }
          // Eliminate
          for (var r2 = col + 1; r2 < n; r2++) {
            var factor = A[r2][col] / A[col][col];
            for (var c2 = col; c2 <= m; c2++) {
              A[r2][c2] -= factor * A[col][c2];
            }
          }
        }

        // Back substitution
        var x = new Array(m).fill(0);
        for (var row = m - 1; row >= 0; row--) {
          var sum = A[row][m];
          for (var c3 = row + 1; c3 < m; c3++) {
            sum -= A[row][c3] * x[c3];
          }
          x[row] = sum / A[row][row];
        }
        return x;
      }

      // ---------------- Main calculator logic ----------------
      (function () {
        var runBtn = document.getElementById('pf-run-btn');
        var clearInputsBtn = document.getElementById('pf-clear-inputs');
        var clearResultsBtn = document.getElementById('pf-clear-results');
        var example1Btn = document.getElementById('pf-example-1');
        var example2Btn = document.getElementById('pf-example-2');
        var errorEl = document.getElementById('pf-error');
        var resultsSection = document.getElementById('pf-results');
        var warningEl = document.getElementById('pf-warning');

        function showError(msg) {
          errorEl.textContent = msg;
          errorEl.classList.remove('hidden');
        }
        function clearError() {
          errorEl.textContent = '';
          errorEl.classList.add('hidden');
        }
        function showWarning(msg) {
          warningEl.textContent = msg;
          warningEl.classList.remove('hidden');
        }
        function clearWarning() {
          warningEl.textContent = '';
          warningEl.classList.add('hidden');
        }

        function clearResults() {
          resultsSection.classList.add('hidden');
          document.getElementById('pf-out-original').textContent = '';
          document.getElementById('pf-out-den-expanded').textContent = '';
          document.getElementById('pf-out-classification').textContent = '';
          document.getElementById('pf-out-quotient').textContent = '';
          document.getElementById('pf-out-remainder').textContent = '';
          document.getElementById('pf-out-partial-text').textContent = '';
          document.getElementById('pf-out-partial-tex').textContent = '';
          document.getElementById('pf-out-coeff-summary').textContent = '';
          document.getElementById('pf-out-steps').textContent = '';
          clearWarning();
        }

        example1Btn.addEventListener('click', function () {
          document.getElementById('pf-numerator').value = '2x+3';
          document.getElementById('pf-den-factored').value = '(x-1)(x+2)';
          clearError();
          clearResults();
        });

        example2Btn.addEventListener('click', function () {
          document.getElementById('pf-numerator').value = 'x^2+1';
          document.getElementById('pf-den-factored').value = '(x-1)(x+1)';
          clearError();
          clearResults();
        });

        clearInputsBtn.addEventListener('click', function () {
          document.getElementById('pf-numerator').value = '';
          document.getElementById('pf-den-factored').value = '';
          clearError();
          clearResults();
        });

        clearResultsBtn.addEventListener('click', function () {
          clearError();
          clearResults();
        });

        document.getElementById('pf-copy-steps').addEventListener('click', function () {
          var text = document.getElementById('pf-out-steps').textContent || '';
          if (!text.trim()) return;
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text).catch(function () {});
          }
        });

        runBtn.addEventListener('click', function () {
          clearError();
          clearResults();
          try {
            var rawNum = document.getElementById('pf-numerator').value;
            var rawDenFactored = document.getElementById('pf-den-factored').value;
            var dec = Number(document.getElementById('pf-decimals').value);
            if (!Number.isFinite(dec)) dec = 4;
            dec = Math.max(0, Math.min(10, Math.round(dec)));
            document.getElementById('pf-decimals').value = dec;

            var P = pfParsePolynomial(rawNum);
            var factors = pfParseFactoredDen(rawDenFactored);

            // Build denominator polynomial from factors
            var Q = [1];
            factors.forEach(function (f) {
              Q = pfPolyMul(Q, [f.b, f.a]); // (a x + b) => [b, a]
            });
            Q = pfTrimPoly(Q);

            var degP = P.length - 1;
            var degQ = Q.length - 1;

            var steps = [];
            steps.push('Input:');
            steps.push('  P(x) = ' + pfFormatPoly(P, 'x', dec));
            steps.push('  Q(x) = product of factors: ' + factors.map(function (f) { return f.expr; }).join(''));
            steps.push('');
            steps.push('Expanded denominator Q(x):');
            steps.push('  Q(x) = ' + pfFormatPoly(Q, 'x', dec));
            steps.push('');

            // Long division if needed
            var quotient = [0];
            var remainder = P.slice();
            if (degP >= degQ) {
              steps.push('Step 1: Polynomial long division since deg(P) ≥ deg(Q).');
              var divRes = pfPolyDiv(P, Q);
              quotient = pfTrimPoly(divRes.q);
              remainder = pfTrimPoly(divRes.r);
              steps.push('  P(x) / Q(x) = S(x) + R(x)/Q(x)');
              steps.push('  S(x) = ' + pfFormatPoly(quotient, 'x', dec));
              steps.push('  R(x) = ' + pfFormatPoly(remainder, 'x', dec));
              steps.push('');
            } else {
              steps.push('Step 1: P(x)/Q(x) is already a proper fraction (deg(P) < deg(Q)), no long division needed.');
              steps.push('');
            }

            var degR = remainder.length - 1;
            var classification = (degP >= degQ ? 'Improper' : 'Proper') +
              ' rational function; remainder degree ' + degR + ', denominator degree ' + degQ + '.';
            document.getElementById('pf-out-classification').textContent = classification;

            // If remainder is zero, no partial fractions needed
            var allZero = true;
            for (var ii = 0; ii < remainder.length; ii++) {
              if (Math.abs(remainder[ii]) > 1e-14) { allZero = false; break; }
            }

            var A = [];
            var partialText = '';
            var partialTeX = '';
            var coeffSummary = '';

            if (!allZero) {
              // Build polynomials D_i(x) = Q(x) / (a_i x + b_i)
              var nFactors = factors.length;
              if (degQ !== nFactors) {
                showWarning(
                  'Note: The expanded denominator degree (' + degQ +
                  ') does not equal the number of linear factors (' + nFactors +
                  '). This can happen if some factors are numerically dependent; ' +
                  'decomposition may still proceed but interpret results with care.'
                );
              }

              var Dis = [];
              var matrix = [];
              var rhs = [];
              steps.push('Step 2: Build polynomials D_i(x) = Q(x) / (a_i x + b_i) for each factor.');
              factors.forEach(function (f, idx) {
                var div = pfPolyDivByLinear(Q, f.a, f.b);
                if (div.r.length !== 1 || Math.abs(div.r[0]) > 1e-8) {
                  steps.push('  Warning: factor ' + f.expr +
                    ' does not divide Q(x) exactly (remainder ≈ ' + div.r[0] + ').');
                  showWarning('One of the factors does not divide Q(x) exactly. Partial fractions are computed formally, but please check the algebra.');
                }
                Dis.push(pfTrimPoly(div.q));
                steps.push('  D_' + (idx + 1) + '(x) = Q(x) / ' + f.expr + ' = ' +
                           pfFormatPoly(div.q, 'x', dec));
              });
              steps.push('');

              // Construct linear system: sum_i A_i * D_i(x) = R(x)
              // Use degrees 0..(nFactors-1) as equations
              steps.push('Step 3: Solve for A_1, ..., A_n from the identity R(x) = Σ A_i D_i(x).');
              var maxEqDeg = Math.max(nFactors - 1, 0);
              for (var k = 0; k <= maxEqDeg; k++) {
                var row = [];
                for (var iF = 0; iF < nFactors; iF++) {
                  var coeff = k < Dis[iF].length ? Dis[iF][k] : 0;
                  row.push(coeff);
                }
                var rhsCoeff = k < remainder.length ? remainder[k] : 0;
                matrix.push(row);
                rhs.push(rhsCoeff);
              }

              steps.push('  System in coefficient form (by powers of x from lowest upwards):');
              for (var eq = 0; eq < matrix.length; eq++) {
                steps.push('    Degree ' + eq + ': ' +
                  matrix[eq].map(function (c, idx) { return 'A_' + (idx + 1) + '*' + c.toFixed(Math.min(dec + 2, 8)); }).join(' + ')
                  + ' = ' + rhs[eq].toFixed(Math.min(dec + 2, 8))
                );
              }
              steps.push('');

              var solution = pfSolveLinearSystem(matrix, rhs);
              A = solution;

              steps.push('  Solved coefficients A_i:');
              for (var iA = 0; iA < A.length; iA++) {
                steps.push('    A_' + (iA + 1) + ' = ' + A[iA].toFixed(Math.min(dec + 2, 8)));
              }
              steps.push('');

              // Build partial fraction expressions
              var termsPlain = [];
              var termsTeX = [];
              for (var t = 0; t < factors.length; t++) {
                var cA = A[t];
                var f = factors[t];
                var a = f.a, b = f.b;
                if (Math.abs(cA) < 1e-14) continue;
                var numStr = cA.toFixed(dec);
                // Plain
                var denomPlain;
                if (Math.abs(a - 1) < 1e-14 && Math.abs(b) > 1e-14) {
                  denomPlain = '(x' + (b >= 0 ? '+' + b : b) + ')';
                } else if (Math.abs(a - 1) < 1e-14 && Math.abs(b) < 1e-14) {
                  denomPlain = '(x)';
                } else {
                  denomPlain = '(' + a.toFixed(dec) + '*x' + (b >= 0 ? '+' + b.toFixed(dec) : b.toFixed(dec)) + ')';
                }
                termsPlain.push(numStr + '/' + denomPlain);

                // TeX
                var denomTeX;
                if (Math.abs(a - 1) < 1e-14 && Math.abs(b) > 1e-14) {
                  denomTeX = '(x' + (b >= 0 ? '+' + b.toFixed(dec) : b.toFixed(dec)) + ')';
                } else if (Math.abs(a - 1) < 1e-14 && Math.abs(b) < 1e-14) {
                  denomTeX = 'x';
                } else {
                  denomTeX = '(' + a.toFixed(dec) + 'x' + (b >= 0 ? '+' + b.toFixed(dec) : b.toFixed(dec)) + ')';
                }
                termsTeX.push('\\frac{' + numStr + '}{' + denomTeX + '}');
              }

              partialText = termsPlain.length ? termsPlain.join(' + ') : '0';
              partialTeX = termsTeX.length ? termsTeX.join(' + ') : '0';

              // Coefficient summary
              var summaryLines = [];
              for (var iS = 0; iS < A.length; iS++) {
                summaryLines.push('A_' + (iS + 1) + ' (factor ' + factors[iS].expr + ') = ' + A[iS].toFixed(dec));
              }
              coeffSummary = summaryLines.join(' | ');

              steps.push('Step 4: Assemble final decomposition.');
            } else {
              steps.push('Step 2: The remainder R(x) is zero, so no partial fraction terms are needed.');
              partialText = '0';
              partialTeX = '0';
              coeffSummary = 'No partial fractions (remainder is zero).';
            }

            // Final expression
            var originalStr = 'P(x)/Q(x) = (' + pfFormatPoly(P, 'x', dec) + ') / (' +
                              pfFormatPoly(Q, 'x', dec) + ')';
            document.getElementById('pf-out-original').textContent = originalStr;
            document.getElementById('pf-out-den-expanded').textContent = 'Q(x) = ' + pfFormatPoly(Q, 'x', dec);

            var quotientStr = pfFormatPoly(quotient, 'x', dec);
            var remainderStr = pfFormatPoly(remainder, 'x', dec);

            document.getElementById('pf-out-quotient').textContent = quotientStr;
            document.getElementById('pf-out-remainder').textContent =
              '(' + remainderStr + ') / (' + pfFormatPoly(Q, 'x', dec) + ')';

            document.getElementById('pf-out-partial-text').textContent = partialText;
            document.getElementById('pf-out-partial-tex').textContent = partialTeX;
            document.getElementById('pf-out-coeff-summary').textContent = coeffSummary;

            // Compose overall final identity in the steps
            steps.push('');
            steps.push('Final identity (plain):');
            var finalPlain = 'P(x)/Q(x) = ' + quotientStr;
            if (partialText !== '0') {
              finalPlain += ' + ' + partialText;
            }
            steps.push('  ' + finalPlain);

            steps.push('');
            steps.push('Final identity (TeX):');
            var finalTeX = '\\frac{P(x)}{Q(x)} = ' + quotientStr;
            if (partialTeX !== '0') {
              finalTeX += ' + ' + partialTeX;
            }
            steps.push('  ' + finalTeX);

            document.getElementById('pf-out-steps').textContent = steps.join('\n');
            resultsSection.classList.remove('hidden');
          } catch (e) {
            showError(e.message || 'Unable to perform partial fraction decomposition. Please check your inputs.');
          }
        });
      })();
    </script>

    <script>
      window.MathJax = { tex: { inlineMath: [['\\(','\\)'], [',
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    


</body></html>, ',
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    


</body></html>]], displayMath: [['\\[','\\]']] }, svg: { fontCache: 'global' } };,
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    


</body></html>
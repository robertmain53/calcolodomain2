<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/cash-flow-projection-calculator">





<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cash Flow Projection Calculator</title>
<meta name="description" content="Project your business's future cash flow. Enter starting balance, monthly inflows, and outflows to get a detailed monthly projection and net cash position.">


<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" defer=""></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.prose dl dt { font-weight: 600; }
.prose dl dd { margin-left: 1.5rem; margin-bottom: 0.75rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1.5rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
font-size: 1.1rem;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }

/* Accessibility & UX Enhancements */
/* Visible focus state for WCAG 2.1 AA */
*:focus-visible {
outline: 3px solid #3b82f6; /* Tailwind blue-600 */
outline-offset: 2px;
border-radius: 4px;
}
/* Ensure no outline when focus is not keyboard-driven */
:focus:not(:focus-visible) {
outline: none;
}

/* Minimum tap target size for mobile (48x48) */
input[type="number"], select, button {
min-height: 48px;
}

/* Accessible tooltip button */
.tooltip-btn {
display: inline-flex;
align-items: center;
justify-content: center;
width: 24px; height: 24px;
border: 1px solid #9ca3af;
border-radius: 9999px;
background: #f3f4f6;
color: #6b7280;
margin-left: 8px;
cursor: pointer;
}
.tooltip-text {
display: none;
background: #1f2937;
color: white;
padding: 0.5rem 0.75rem;
border-radius: 6px;
font-size: 0.875rem;
position: absolute;
z-index: 10;
width: max-content;
max-width: 250px;
}
.tooltip-btn:focus + .tooltip-text,
.tooltip-btn:hover + .tooltip-text {
display: block;
}

/* Error message styling */
.error-message {
display: none;
color: #dc2626; /* red-600 */
font-size: 0.875rem;
margin-top: 0.25rem;
}
input[aria-invalid="true"] {
border-color: #dc2626;
}
input[aria-invalid="true"]:focus-visible {
outline-color: #dc2626;
}

/* Ensure results area doesn't collapse (prevents CLS) */
#results {
min-height: 300px;
}

@media print {
/* Hide non-essential elements */
body > header, body > footer, aside, #calculator-ui button, #print-button {
display: none !important;
visibility: hidden !important;
}
/* Ensure main content and results are visible */
body * { visibility: hidden; }
main, #print-section, #print-section * {
visibility: visible;
}
#print-section {
position: absolute; left: 0; top: 0; width: 100%;
box-shadow: none; border: none;
}
.prose { max-width: 100%; }
.result-card { border: 1px solid #ccc; }
#results-chart-container { display: none !importa
}
main {
width: 100% !important;
padding: 0 !important;
margin: 0 !important;
}
.flex-col, .lg\:flex-row { flex-direction: column !important; }
}
</style>

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "WebPage",
"name": "Cash Flow Projection Calculator",
"description": "Project your business's future cash flow. Enter starting balance, monthly inflows, and outflows to get a detailed monthly projection and net cash position.",
/* ### CORREZIONE 2: Aggiunto .html ### */
"url": "https://calcdomain.com/cash-flow-projection-calculator",
"inLanguage": "en",
"author": { "@type": "Person", "name": "Ugo Candido" },
"publisher": { "@type": "Organization", "name": "CalcDomain" }
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "BreadcrumbList",
"itemListElement": [
{ "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com" },
{ "@type": "ListItem", "position": 2, "name": "Finance", "item": "https://calcdomain.com/finance" },
{ "@type": "ListItem", "position": 3, "name": "Business Small Biz", "item": "https://calcdomain.com/subcategories/business-small-biz" },
{ "@type": "ListItem", "position": 4, "name": "Cash Flow Projection Calculator", /* ### CORREZIONE 3: Aggiunto .html ### */ "item": "https://calcdomain.com/cash-flow-projection-calculator" }
]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to Use the Cash Flow Projection Calculator",
  "description": "A step-by-step guide to projecting your business's cash flow over a set period.",
  "step": [
    {
      "@type": "HowToStep",
      "name": "Enter Starting Balance",
      "text": "Input the total cash on hand your business has at the beginning of the period."
    },
    {
      "@type": "HowToStep",
      "name": "Set Projection Period",
      "text": "Define how many months you want to forecast (e.g., 12 months)."
    },
    {
      "@type": "HowToStep",
      "name": "Add Monthly Inflows",
      "text": "Enter all expected recurring monthly cash receipts, such as sales revenue, loan receipts, and other income."
    },
    {
      "@type": "HowToStep",
      "name": "Add Monthly Outflows",
      "text": "Enter all expected recurring monthly cash payments, including rent, salaries, cost of goods, marketing, and other expenses."
    },
    {
      "@type": "HowToStep",
      "name": "Review Results",
      "text": "The calculator automatically generates a monthly projection table, a line chart of your ending balance, and key financial summaries."
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is the difference between cash flow and profit?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Profit (or Net Income) is your total revenue minus all expenses, including non-cash items like depreciation, as shown on an income statement. Cash Flow is the actual movement of money in and out of your business. A business can be profitable but have negative cash flow if, for example, clients are slow to pay their invoices (high accounts receivable)."
      }
    },
    {
      "@type": "Question",
      "name": "Why is cash flow projection important for a small business?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Cash flow projection is vital because it helps you anticipate future cash shortages or surpluses. It allows you to make informed decisions about hiring, purchasing inventory, managing debt, and planning for growth. It is the key to maintaining business liquidity and avoiding insolvency."
      }
    },
    {
      "@type": "Question",
      "name": "What if my income or expenses are not the same every month?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "This calculator uses average monthly figures for simplicity. For a more detailed forecast with variable (seasonal) income and expenses, you would typically use a spreadsheet. This tool is best for getting a quick, high-level projection based on your typical month."
      }
    },
    {
      "@type": "Question",
      "name": "Are non-cash expenses like depreciation included?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "No. This is a *cash flow* calculator, not a profit calculator. Non-cash expenses like depreciation and amortization are accounting entries that do not affect your bank balance. Therefore, they are excluded from this calculation."
      }
    },
    {
      "@type": "Question",
      "name": "How can I improve my business's cash flow?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "To improve cash flow, you can: 1. Increase inflows by invoicing promptly and chasing late payments. 2. Decrease outflows by negotiating better terms with suppliers or cutting non-essential costs. 3. Manage financing by securing a line of credit *before* you need it."
      }
    }
  ]
}
</script>
<script src="search.js" defer=""></script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Finance",
      "item": "https://calcdomain.com/categories/finance"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Business Small Biz",
      "item": "https://calcdomain.com/subcategories/business-small-biz"
    }
  ]
}
</script>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">


<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[N = I_{total} - O_{total}\]</div>
  <pre class="auditspine-mono">N = I_{total} - O_{total}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[E_n = B_n + N\]</div>
  <pre class="auditspine-mono">E_n = B_n + N</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[B_{n+1} = E_n\]</div>
  <pre class="auditspine-mono">B_{n+1} = E_n</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$ N = I_{total} - O_{total} $</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><span class="auditspine-mono">P</span> = principal (loan amount) <em>(currency)</em></li>
<li><span class="auditspine-mono">r</span> = periodic interest rate (annual rate ÷ payments per year) <em>(1)</em></li>
<li><span class="auditspine-mono">n</span> = total number of payments (years × payments per year) <em>(count)</em></li>
<li><span class="auditspine-mono">M</span> = periodic payment for principal + interest <em>(currency)</em></li>
<li><span class="auditspine-mono">T</span> = property tax (annual or monthly depending on input) <em>(currency)</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Home</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/" target="_blank" rel="nofollow noopener">https://calcdomain.com/</a></li>
<li><strong>Finance</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/finance" target="_blank" rel="nofollow noopener">https://calcdomain.com/finance</a></li>
<li><strong>Business Small Biz</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/business-small-biz" target="_blank" rel="nofollow noopener">https://calcdomain.com/subcategories/business-small-biz</a></li>
<li><strong>FASB website</strong> — fasb.org · Accessed 2026-01-19<br><a href="https://www.fasb.org/" target="_blank" rel="nofollow noopener">https://www.fasb.org/</a></li>
<li><strong>Business Loan Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/business-loan" target="_blank" rel="nofollow noopener">https://calcdomain.com/business-loan</a></li>
<li><strong>Startup Costs Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/startup-costs" target="_blank" rel="nofollow noopener">https://calcdomain.com/startup-costs</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300×600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why Use This Calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Instantly see your month-by-month cash position.</li>
<li>Identify potential cash shortages *before* they happen.</li>
<li>Model the impact of increasing sales or cutting costs.</li>
<li>Download a clean projection table for business plans or loan applications.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Business Tools</h3>
<ul class="space-y-3 text-sm">
<li>Break-Even Point Calculator</li>
<li><a href="https://calcdomain.com/business-loan" class="text-blue-600 hover:underline">Business Loan Calculator</a></li>
<li>Profit Margin Calculator</li>
<li><a href="https://calcdomain.com/startup-costs" class="text-blue-600 hover:underline">Startup Costs Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                                                                        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>

































<script defer="">
document.addEventListener('DOMContentLoaded', () => {
// ### Element Cache ###
const elements = {
form: document.getElementById('cashflow-form'),
// Inputs
startingBalance: document.getElementById('startingBalance'),
projectionPeriod: document.getElementById('projectionPeriod'),
inflowSales: document.getElementById('inflowSales'),
inflowLoans: document.getElementById('inflowLoans'),
inflowOther: document.getElementById('inflowOther'),
outflowRent: document.getElementById('outflowRent'),
outflowSalaries: document.getElementById('outflowSalaries'),
outflowCogs: document.getElementById('outflowCogs'),
outflowOther: document.getElementById('outflowOther'),
// Sub-total Displays
totalInflows: document.getElementById('total-inflows'),
totalOutflows: document.getElementById('total-outflows'),
// Result Cards
finalBalance: document.getElementById('finalBalance'),
totalNetFlow: document.getElementById('totalNetFlow'),
avgNetFlow: document.getElementById('avgNetFlow'),
positiveMonths: document.getElementById('positiveMonths'),
// Table & Chart
scheduleBody: document.getElementById('scheduleBody'),
chartCanvas: document.getElementById('resultsChart')
};

const allInputs = document.querySelectorAll('#cashflow-form input[type="number"]');
let chartInstance = null;

// ### Formatters ###
const fmtCurrency = (val) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(val || 0);
const fmtNumber = (val) => new Intl.NumberFormat('en-US').format(val || 0);

// ### Validation Logic (WCAG 2.1 AA) ###
function showError(inputEl, message) {
const errorEl = document.getElementById(`${inputEl.id}-error`);
if (errorEl) {
errorEl.textContent = message;
errorEl.style.display = 'block';
}
inputEl.setAttribute('aria-invalid', 'true');
}

function clearError(inputEl) {
const errorEl = document.getElementById(`${inputEl.id}-error`);
if (errorEl) {
errorEl.textContent = '';
errorEl.style.display = 'none';
}
inputEl.setAttribute('aria-invalid', 'false');
}

function validateInputs() {
let isValid = true;
// Clear all previous errors
allInputs.forEach(clearError);

const startBalanceVal = parseFloat(elements.startingBalance.value);
if (isNaN(startBalanceVal) || startBalanceVal < 0) {
showError(elements.startingBalance, 'Starting balance must be zero or greater.');
isValid = false;
}

const periodVal = parseInt(elements.projectionPeriod.value, 10);
if (isNaN(periodVal) || periodVal < 1 || periodVal > 60) {
showError(elements.projectionPeriod, 'Period must be between 1 and 60 months.');
isValid = false;
}

// Validate all other number fields to ensure they aren't negative
allInputs.forEach(input => {
if (input.id !== 'startingBalance' && input.id !== 'projectionPeriod') {
if (isNaN(parseFloat(input.value)) || parseFloat(input.value) < 0) {
showError(input, 'Value cannot be negative.');
isValid = false;
}
}
});

return isValid;
}

// ### Core Calculation Logic ###
function calculateAndRender() {
if (!validateInputs()) {
clearResults();
return;
}

// 1. Get Values
const startingBalance = parseFloat(elements.startingBalance.value) || 0;
const projectionPeriod = parseInt(elements.projectionPeriod.value, 10) || 0;

const totalInflows = (parseFloat(elements.inflowSales.value) || 0) +
(parseFloat(elements.inflowLoans.value) || 0) +
(parseFloat(elements.inflowOther.value) || 0);

const totalOutflows = (parseFloat(elements.outflowRent.value) || 0) +
(parseFloat(elements.outflowSalaries.value) || 0) +
(parseFloat(elements.outflowCogs.value) || 0) +
(parseFloat(elements.outflowOther.value) || 0);

// Update sub-totals
elements.totalInflows.textContent = fmtCurrency(totalInflows);
elements.totalOutflows.textContent = fmtCurrency(totalOutflows);

// 2. Generate Schedule
const schedule = [];
let currentBalance = startingBalance;
let cashPositiveMonths = 0;
const netMonthlyFlow = totalInflows - totalOutflows;

if (netMonthlyFlow > 0) {
cashPositiveMonths = projectionPeriod;
} else if (netMonthlyFlow < 0) {
cashPositiveMonths = 0;
}
// Note: This simplified model assumes constant flow.
// A more complex model would check balance > 0, but this matches the formula.

for (let i = 1; i <= projectionPeriod; i++) {
const starting = currentBalance;
const ending = starting + netMonthlyFlow;
schedule.push({
month: i,
start: starting,
net: netMonthlyFlow,
end: ending
});
currentBalance = ending;
}

// 3. Update Outputs
updateCards(schedule, startingBalance, netMonthlyFlow, cashPositiveMonths, projectionPeriod);
renderTable(schedule);
renderChart(schedule);
}

function clearResults() {
elements.finalBalance.textContent = '—';
elements.totalNetFlow.textContent = '—';
elements.avgNetFlow.textContent = '—';
elements.positiveMonths.textContent = '—';
elements.scheduleBody.innerHTML = '<tr><td colspan="4" class="text-center p-4 text-gray-500">Enter valid inputs to see projection.</td></tr>';
if (chartInstance) {
chartInstance.destroy();
chartInstance = null;
}
}

// ### Rendering Functions ###
function updateCards(schedule, startingBalance, netMonthlyFlow, cashPositiveMonths, projectionPeriod) {
const finalBalance = schedule.length ? schedule[schedule.length - 1].end : startingBalance;
const totalNetFlow = finalBalance - startingBalance;

elements.finalBalance.textContent = fmtCurrency(finalBalance);
elements.totalNetFlow.textContent = fmtCurrency(totalNetFlow);
elements.avgNetFlow.textContent = fmtCurrency(netMonthlyFlow);
elements.positiveMonths.textContent = `${fmtNumber(cashPositiveMonths)} of ${fmtNumber(projectionPeriod)}`;

// Add dynamic coloring for net flow
elements.avgNetFlow.className = netMonthlyFlow >= 0 ? 'text-green-600' : 'text-red-600';
elements.totalNetFlow.className = totalNetFlow >= 0 ? 'text-green-600' : 'text-red-600';
elements.finalBalance.className = finalBalance >= 0 ? 'text-blue-600' : 'text-red-600';
}

function renderTable(schedule) {
const tbody = elements.scheduleBody;
tbody.innerHTML = '';
if (!schedule.length) {
clearResults();
return;
}

const netFlowClass = schedule[0].net >= 0 ? 'text-green-600' : 'text-red-600';

schedule.forEach(row => {
const tr = document.createElement('tr');
tr.className = 'border-b border-gray-100 hover:bg-gray-50';
tr.innerHTML = `
<td class="px-4 py-2 text-left font-medium">${row.month}</td>
<td class="px-4 py-2">${fmtCurrency(row.start)}</td>
<td class="px-4 py-2 ${netFlowClass}">${fmtCurrency(row.net)}</td>
<td class="px-4 py-2 font-semibold">${fmtCurrency(row.end)}</td>
`;
tbody.appendChild(tr);
});
}

function renderChart(schedule) {
const ctx = elements.chartCanvas;
if (!ctx || !schedule.length) return;

const labels = schedule.map(r => `Month ${r.month}`);
const data = schedule.map(r => r.end);

// Add month 0 (Starting Balance) to the chart for context
labels.unshift('Start');
data.unshift(schedule[0].start);

if (chartInstance) {
chartInstance.data.labels = labels;
chartInstance.data.datasets[0].data = data;
chartInstance.update();
} else {
chartInstance = new Chart(ctx, {
type: 'line',
data: {
labels: labels,
datasets: [{
label: 'Ending Cash Balance',
data: data,
borderColor: '#2563eb', // blue-600
backgroundColor: 'rgba(37, 99, 235, 0.1)',
fill: true,
tension: 0.1
}]
},
options: {
plugins: {
legend: { display: false },
tooltip: {
callbacks: {
label: (context) => `Balance: ${fmtCurrency(context.parsed.y)}`
}
}
},
responsive: true,
maintainAspectRatio: false,
scales: {
y: {
ticks: {
callback: (value) => fmtCurrency(value)
}
}
}
}
});
}
}

// ### Event Listeners ###
allInputs.forEach(input => {
input.addEventListener('input', calculateAndRender);
});

elements.form.addEventListener('reset', (e) => {
// Short delay to allow form to reset values before recalculating
setTimeout(() => {
allInputs.forEach(clearError);
calculateAndRender();
}, 0);
});

// Initial calculation on load
calculateAndRender();
});
</script>


</body></html>
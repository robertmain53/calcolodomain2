<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/r-value">





 
<link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg">
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png">
<link rel="manifest" href="https://calcdomain.com/site.webmanifest">
<meta charset="utf-8">
<title>Insulation R-Value Calculator | Construction Tool for Accurate Thermal Resistance</title>
<meta content="Professional, mobile-first Insulation R-Value Calculator. Build layered assemblies, include surface films, model framing effects, and switch between R and RSI units. Based on ISO 6946 and ASHRAE Fundamentals." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="Ugo Candido" name="author">

<meta content="index, follow, max-image-preview:large" name="robots">
<meta content="#005A9C" name="theme-color">
<meta content="website" property="og:type">
<meta content="Insulation R-Value Calculator" property="og:title">
<meta content="Calculate total R-value (or RSI) of wall, roof, and floor assemblies with films and framing effects. Accessible, accurate, and fast." property="og:description">
<meta content="https://calcdomain.com/r-value-calculator" property="og:url">
<meta content="CalcDomain" property="og:site_name">
<style>
    /* ====================================================================== */
    /* Critical CSS (mobile-first, accessible, WCAG 2.1 AA)                   */
    /* Standalone file: includes both global and component styles             */
    /* ====================================================================== */

    /* Design tokens */
    :root{
      --primary-color:#005A9C; --secondary-color:#003F6E; --accent-color:#00A4E4;
      --background-color:#F8F9FA; --surface-color:#FFFFFF;
      --text-color:#212529; --muted-text-color:#6C757D; --border-color:#DEE2E6;
      --success-color:#198754; --error-color:#DC3545; --warning-color:#FFC107;

      --font-sans:'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

      --touch-target-min:48px; --touch-target-opt:60px;
      --input-padding:clamp(.75rem,2vw,1rem);
      --radius-6:6px; --radius-8:8px; --radius-12:12px;

      --transition:.2s ease-in-out; --transition-fast:.1s ease-in-out;

      --container-max:1200px; --sidebar-width:clamp(300px,40vw,460px);
      --gap-2:.5rem; --gap-4:1rem; --gap-6:1.5rem; --gap-8:2rem;

      --overlay-bg:rgba(0,0,0,.4);
    }

    @media (prefers-reduced-motion: reduce){
      *,*::before,*::after{ animation-duration:.01ms!important; animation-iteration-count:1!important; transition-duration:.01ms!important; scroll-behavior:auto!important; }
    }
    @media (prefers-contrast: more){
      :root{ --primary-color:#003A66; --secondary-color:#000; --text-color:#000; --border-color:#000; --background-color:#fff; }
    }

    /* Base */
    *,*::before,*::after{ box-sizing:border-box; }
    html{ font-size:clamp(16px,2.6vw,18px); }
    body{
      margin:0; font-family:var(--font-sans);
      background:var(--background-color); color:var(--text-color);
      line-height:1.6; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }

    /* Skip link */
    .skip-link{
      position:absolute; top:-40px; left:8px; background:var(--primary-color); color:#fff;
      padding:8px 14px; z-index:999; border-radius:0 0 6px 6px; text-decoration:none; font-weight:700;
    }
    .skip-link:focus{ top:0; outline:none; }

    /* Links & text */
    h1,h2,h3,h4{ color:var(--secondary-color); line-height:1.2; margin:0 0 .75rem; font-weight:800; }
    h1{ font-size:clamp(1.75rem,5vw,2.5rem); }
    h2{ font-size:clamp(1.35rem,4vw,2rem); }
    h3{ font-size:clamp(1.15rem,3.5vw,1.5rem); }
    p{ margin:0 0 1rem; max-width:70ch; }
    a{ color:var(--primary-color); text-decoration:none; }
    a:hover{ text-decoration:underline; }
    a:focus{ outline:3px solid var(--primary-color); outline-offset:2px; border-radius:3px; }
    code,kbd{ font-family:var(--font-mono); background:#e9ecef; padding:.15em .35em; border-radius:4px; }

    /* Layout */
    .container{ max-width:var(--container-max); margin:0 auto; padding:0 clamp(1rem,4vw,2rem); }
    header.site-header{
      background:var(--surface-color); border-bottom:1px solid var(--border-color);
      box-shadow:0 2px 4px rgba(0,0,0,.04);
    }
    .header-inner{
      display:grid; grid-template-columns:auto 1fr auto; gap:var(--gap-4); align-items:center; padding:.75rem 0;
    }
    .brand{ font-weight:800; color:var(--primary-color); font-size:1.15rem; white-space:nowrap; }
    .site-search{ display:flex; gap:.5rem; align-items:center; }
    .site-search input[type="search"]{
      flex:1 1 auto; min-width:0; padding:.6rem .75rem; border:1px solid var(--border-color);
      border-radius:8px; font-size:.95rem; background:#fff;
    }
    .site-search input[type="search"]:focus{ outline:none; border-color:var(--primary-color); box-shadow:0 0 0 3px rgba(0,90,156,.15); }
    .btn{ display:inline-flex; align-items:center; justify-content:center; gap:.5rem; padding:.6rem .9rem; font-weight:700; border-radius:8px; border:1px solid transparent; min-height:var(--touch-target-min); min-width:var(--touch-target-min); cursor:pointer; }
    .btn-primary{ background:var(--primary-color); color:#fff; border-color:var(--primary-color); }
    .btn-secondary{ background:transparent; color:var(--primary-color); border-color:var(--primary-color); }
    .btn:focus{ outline:3px solid var(--primary-color); outline-offset:2px; }

    .breadcrumb{ font-size:.95rem; color:var(--muted-text-color); margin:1rem 0; }
    .breadcrumb a{ color:inherit; text-decoration:underline; text-underline-offset:2px; }

    /* Calculator grid */
    .calculator-layout{ display:grid; grid-template-columns:1fr; gap:var(--gap-8); }
    @media (min-width: 992px){
      .calculator-layout{ grid-template-columns: minmax(0, var(--sidebar-width)) 1fr; align-items:start; }
    }

    /* Cards */
    .card{ background:var(--surface-color); border:1px solid var(--border-color); border-radius:12px; padding:clamp(1rem,2.5vw,1.5rem); box-shadow:0 3px 6px rgba(0,0,0,.04); }

    /* Calculator */
    .calculator{ }
    .form-group{ margin-bottom:var(--gap-6); }
    label{ display:block; font-weight:700; margin-bottom:.45rem; }
    .required::after{ content:" *"; color:var(--error-color); }
    .input-group{ position:relative; display:flex; align-items:center; }
    .form-control{
      width:100%; min-height:var(--touch-target-min); padding:var(--input-padding);
      border:1px solid var(--border-color); border-radius:8px; font-size:1rem; background:#fff;
      transition:border-color var(--transition), box-shadow var(--transition);
    }
    .form-control:focus{ outline:none; border-color:var(--primary-color); box-shadow:0 0 0 3px rgba(0,90,156,.15); }
    .form-control[aria-invalid="true"]{ border-color:var(--error-color); }
    .input-suffix{ position:absolute; right:.75rem; color:var(--muted-text-color); pointer-events:none; font-weight:600; }

    fieldset{ border:0; padding:0; margin:0; }
    .radio-group{ display:flex; gap:.5rem; border:1px solid var(--border-color); border-radius:8px; padding:.25rem; }
    .radio-group input[type="radio"]{ position:absolute; opacity:0; width:0; height:0; }
    .radio-option{ flex:1; }
    .radio-option label{ display:flex; align-items:center; justify-content:center; min-height:var(--touch-target-min); border-radius:6px; cursor:pointer; font-weight:700; }
    .radio-group input[type="radio"]:checked + label{ background:var(--primary-color); color:#fff; }
    .radio-group input[type="radio"]:focus + label{ outline:3px solid var(--primary-color); outline-offset:2px; }

    /* Tooltip */
    .help-btn{
      margin-left:.35rem; width:var(--touch-target-min); height:var(--touch-target-min);
      display:inline-flex; align-items:center; justify-content:center;
      border:1px solid var(--border-color); border-radius:50%; background:#fff; color:var(--primary-color); font-weight:800;
    }
    .help-btn[aria-expanded="true"]{ background:rgba(0,90,156,.08); }
    .tooltip{ display:none; margin-top:.5rem; background:#f1f3f5; border:1px solid var(--border-color); color:#0b0c0c; padding:.75rem; border-radius:8px; }
    .tooltip[data-open="true"]{ display:block; }

    /* Layers */
    .layers{ display:grid; gap:var(--gap-4); }
    .layer-row{
      display:grid; gap:.75rem; grid-template-columns: 1fr 1fr 1fr auto;
    }
    .layer-row .form-control{ min-width:0; }
    .layer-actions{ display:flex; align-items:center; gap:.5rem; }
    .remove-layer{ background:transparent; border:1px solid var(--error-color); color:var(--error-color); border-radius:8px; padding:.5rem .75rem; min-height:var(--touch-target-min); cursor:pointer; }
    .remove-layer:hover{ background:rgba(220,53,69,.08); }
    @media (max-width:700px){
      .layer-row{ grid-template-columns: 1fr; }
      .layer-actions{ justify-content:flex-start; }
    }

    .error-message{ color:var(--error-color); font-size:.92rem; margin-top:.35rem; min-height:1.25em; }

    /* Collapsible (framing) */
    .collapsible{ border:1px dashed var(--border-color); border-radius:10px; padding:1rem; background:#fbfdff; }
    .collapse-toggle{ display:flex; align-items:center; justify-content:space-between; gap:.5rem; }
    .collapse-toggle button{ background:transparent; color:var(--primary-color); border:1px solid var(--primary-color); border-radius:8px; padding:.5rem .75rem; min-height:var(--touch-target-min); cursor:pointer; font-weight:700; }
    .collapse-panel{ margin-top:1rem; display:none; }
    .collapse-panel[aria-hidden="false"]{ display:block; }

    /* Results */
    .results{ min-height:240px; }
    .results h2{ margin-bottom:.5rem; }
    .results-container{ margin-top:.75rem; padding:1rem; background:var(--background-color); border:1px solid var(--border-color); border-radius:12px; }
    .result-item{ display:flex; justify-content:space-between; align-items:center; padding:.6rem 0; border-bottom:1px solid var(--border-color); }
    .result-item:last-child{ border-bottom:0; }
    .result-label{ color:var(--muted-text-color); }
    .result-value{ font-weight:800; font-size:1.25rem; color:var(--success-color); }

    /* Content sections */
    .content h2{ border-bottom:1px solid var(--border-color); padding-bottom:.35rem; margin-top:1.5rem; }
    .formula-box{ background:#eef2f7; border:1px solid #dbe2ea; border-radius:8px; padding:1rem; overflow-x:auto; font-family:var(--font-mono); }
    .glossary{ margin-top:.5rem; }
    .glossary dt{ font-weight:800; }
    .glossary dd{ margin:0 0 .75rem 0; color:#333; }

    .author-box{ font-size:.95rem; color:var(--muted-text-color); border-top:1px solid var(--border-color); padding-top:1rem; margin-top:2rem; }

    /* Footer */
    footer.site-footer{ background:var(--secondary-color); color:#fff; margin-top:3rem; }
    .footer-inner{ display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:1.5rem; padding:1.5rem 0; }
    .site-footer a{ color:#fff; text-decoration:underline; text-underline-offset:2px; }

    /* Utility */
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Insulation R-Value Calculator",
  "description": "Professional insulation R-value (and RSI) calculator for layered assemblies. Includes surface films and optional framing effect per ISO 6946 methodology.",
  "url": "https://calcdomain.com/r-value",
  "inLanguage": "en",
  "isPartOf": {
    "@type": "WebSite",
    "name": "CalcDomain",
    "url": "https://calcdomain.com"
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://calcdomain.com"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Construction & DIY",
        "item": "https://calcdomain.com/categories/construction-diy"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Insulation R-Value Calculator",
        "item": "https://calcdomain.com/r-value"
      }
    ]
  },
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "How It Works: A Step-by-Step Example",
      "description": "Compute total R-value with surface films and the effective R-value with framing factor using ISO 6946 methodology.",
      "step": [
        {
          "@type": "HowToStep",
          "name": "Choose units",
          "text": "Select Imperial (R) or Metric (RSI)."
        },
        {
          "@type": "HowToStep",
          "name": "Add layers",
          "text": "Add each layer’s material and thickness. The calculator sums resistances in series."
        },
        {
          "@type": "HowToStep",
          "name": "Include surface films",
          "text": "Optionally include interior and exterior surface resistances (ISO 6946)."
        },
        {
          "@type": "HowToStep",
          "name": "Model framing (optional)",
          "text": "Enter framing factor, cavity depth, stud and cavity insulation materials to compute a parallel-path effective R-value."
        },
        {
          "@type": "HowToStep",
          "name": "Read results",
          "text": "See total R (or RSI) and U-factor. If framing is enabled, effective R and U are also shown."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is the difference between R and RSI?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "R is Imperial (ft²·°F·h/BTU), RSI is Metric (m²·K/W). They convert by R = 5.678263 × RSI."
          }
        },
        {
          "@type": "Question",
          "name": "Should I include surface films?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes for steady-state comparisons. ISO 6946 recommends Rsi = 0.13 and Rse = 0.04 m²K/W for internal and external surfaces, respectively."
          }
        },
        {
          "@type": "Question",
          "name": "How do framing factors affect R-value?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Framing creates thermal bridges. The effective U-value is the area-weighted average of the cavity and stud paths."
          }
        },
        {
          "@type": "Question",
          "name": "Are material R-values per inch exact?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "They are typical ranges. Consult product datasheets for certified values and test standards like ASTM C518."
          }
        },
        {
          "@type": "Question",
          "name": "Does moisture or compression change R-value?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Moisture and compression can reduce thermal resistance. Always follow manufacturer installation guides."
          }
        },
        {
          "@type": "Question",
          "name": "Is this calculator suitable for code compliance?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "It’s a design aid based on ISO 6946 and ASHRAE fundamentals. For compliance, verify assemblies per your authority having jurisdiction and energy code."
          }
        }
      ]
    }
  ],
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "dateModified": "2026-01-19"
}</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer=""></script>
<!-- MathJax for LaTeX formulas -->
<script>
  (function() {

    'use strict';

  window.MathJax = { tex: { inlineMath: [['\\(','\\)'], [',
    svg: { fontCache: 'global' }
  };


  })();</script>
<script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="preload" href="https://calcdomain.com/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="https://calcdomain.com/assets/js/page-enhancements.js" as="script">


<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body><header id="siteHeader">
  <div class="nav container">
    <a class="brand" href="https://calcdomain.com">CalcDomain</a>
    <div class="navRight">
      <a class="pill" href="https://calcdomain.com/search">Advanced Search</a>
      <span class="pill">Categories</span>
    </div>
  </div>
</header><div class="container">
  <main style="margin:24px 0 40px;" id="mainContent">
    <h1 id="pageTitle">Insulation R-Value Calculator</h1>
    <p class="sub" id="pageSub">Professional, mobile-first Insulation R-Value Calculator. Build layered assemblies, include surface films, model framing effects, and switch between R and RSI units. Based on ISO 6946 and ASHRAE Fundamentals.</p>
    <div id="errorBox" class="alert" role="alert" aria-live="polite"></div>

    <div class="calc-hero" id="calcHero">
      <section class="card" id="inputsCard" aria-label="Calculator inputs"><main class="container" id="main-content" role="main">
<nav aria-label="Breadcrumb" class="breadcrumb">
Home /
      <a href="https://calcdomain.com/construction-diy">Construction</a> /
      General /
      Insulation R-Value Calculator
    </nav>
<h1>Insulation R-Value Calculator</h1>
<p>
      This professional-grade calculator helps builders, energy consultants, architects, and homeowners compute the total thermal resistance (R or RSI) of layered wall, roof, and floor assemblies. It supports surface film coefficients and an optional framing factor to deliver an ISO 6946–style effective R-value. Mobile-first, accessible, and optimized for performance.
    </p>
<div class="calculator-layout">
<!-- Calculator -->
<section aria-labelledby="calc-heading" class="calculator card" id="rvalue-calculator">
<h2 id="calc-heading">Calculator</h2>
<!-- Units -->
<div class="form-group">
<fieldset>
<legend class="required">Units</legend>
<div aria-label="Units" class="radio-group" role="radiogroup">
<div class="radio-option">
<input checked="" id="unitR" name="units" type="radio" value="R">
<label for="unitR">Imperial (R)</label>
</div>
<div class="radio-option">
<input id="unitRSI" name="units" type="radio" value="RSI">
<label for="unitRSI">Metric (RSI)</label>
</div>
</div>
</fieldset>
</div>
<!-- Surface films -->
<div class="form-group">
<label class="required" id="filmLabel">Surface films</label>
<button aria-controls="filmHelp" aria-expanded="false" aria-label="Toggle help for surface films" class="help-btn" type="button">?</button>
<div class="tooltip" id="filmHelp" role="note">
            ISO 6946 recommends standard surface resistances: interior Rsi = 0.13 m²·K/W and exterior Rse = 0.04 m²·K/W.
            These are applied in series with the other layers.
          </div>
<div aria-labelledby="filmLabel" role="group" style="display:flex; gap:1rem; margin-top:.5rem; flex-wrap:wrap;">
<label><input checked="" id="includeInteriorFilm" type="checkbox"> Include interior film</label>
<label><input checked="" id="includeExteriorFilm" type="checkbox"> Include exterior film</label>
</div>
</div>
<!-- Layers -->
<div class="form-group">
<label>Assembly layers (series)</label>
<div aria-live="polite" class="layers" id="layers"></div>
<div class="layer-actions" style="margin-top:.5rem;">
<button aria-label="Add layer" class="btn btn-primary" id="addLayerBtn" type="button">+ Add layer</button>
</div>
</div>
<!-- Framing (optional) -->
<div aria-labelledby="frameHeading" class="form-group collapsible">
<div class="collapse-toggle">
<h3 id="frameHeading" style="margin:0;">Framed assembly (optional)</h3>
<button aria-controls="framingPanel" aria-expanded="false" id="toggleFraming" type="button">Show</button>
</div>
<div aria-hidden="true" class="collapse-panel" id="framingPanel">
<div class="form-group">
<label class="required" for="framingFactor">Framing factor (%)</label>
<div class="input-group">
<input aria-describedby="framingFactorError framingHelp" aria-required="true" class="form-control" id="framingFactor" inputmode="decimal" max="80" min="0" step="0.1" type="number" value="23">
<span class="input-suffix">%</span>
</div>
<div aria-live="polite" class="error-message" id="framingFactorError" role="alert"></div>
<div class="tooltip" data-open="true" id="framingHelp">
                Typical wood framing factors: ~23% @ 16" o.c., ~20% @ 24" o.c. Steel studs often have higher thermal bridging.
              </div>
</div>
<div class="form-group">
<label class="required" for="cavityDepth">Cavity depth</label>
<button aria-controls="cavityHelp" aria-expanded="false" aria-label="Toggle help for cavity depth" class="help-btn" type="button">?</button>
<div class="input-group">
<input aria-describedby="cavityDepthError cavityHelp" aria-required="true" class="form-control" id="cavityDepth" inputmode="decimal" min="0" step="0.1" type="number" value="3.5">
<span class="input-suffix" id="cavityUnit">in</span>
</div>
<div aria-live="polite" class="error-message" id="cavityDepthError" role="alert"></div>
<div class="tooltip" id="cavityHelp">Depth of the insulated cavity (stud depth). Used to compute the path-specific resistance.</div>
</div>
<div class="form-group">
<label class="required" for="cavityInsulation">Cavity insulation</label>
<select aria-describedby="cavityInsulationError" aria-required="true" class="form-control" id="cavityInsulation">
<!-- populated by JS -->
</select>
<div aria-live="polite" class="error-message" id="cavityInsulationError" role="alert"></div>
</div>
<div class="form-group">
<label class="required" for="studMaterial">Stud material</label>
<select aria-describedby="studMaterialError" aria-required="true" class="form-control" id="studMaterial">
<!-- populated by JS -->
</select>
<div aria-live="polite" class="error-message" id="studMaterialError" role="alert"></div>
</div>
</div>
</div>
</section>
<!-- Results -->
<section aria-labelledby="results-heading" class="results card" id="results">
<h2 id="results-heading">Results</h2>
<div aria-atomic="true" aria-live="polite" class="results-container">
<div class="result-item">
<span class="result-label">Total R (series, no framing)</span>
<span class="result-value" id="totalRDisplay">R 0.00</span>
</div>
<div class="result-item">
<span class="result-label">U-factor (no framing)</span>
<span class="result-value" id="uNoFrameDisplay">BTU/(h·ft²·°F) 0.000</span>
</div>
<div class="result-item" hidden="" id="effectiveRRow">
<span class="result-label">Effective R (with framing)</span>
<span class="result-value" id="effectiveRDisplay">R 0.00</span>
</div>
<div class="result-item" hidden="" id="effectiveURow">
<span class="result-label">Effective U (with framing)</span>
<span class="result-value" id="effectiveUDisplay">BTU/(h·ft²·°F) 0.000</span>
</div>
</div>
<p style="margin-top:.75rem; color:var(--muted-text-color);">
          Note: U = 1/R (Imperial) or 1/RSI (Metric). Results update as you type.
        </p>
</section>
</div>
<!-- Authoritative content -->
<section aria-labelledby="methodology" class="content">
<h2 id="methodology">Data Source and Methodology</h2>
<p>
        Authoritative sources: ISO 6946:2017 “Building components and building elements — Thermal resistance and thermal transmittance — Calculation methods”
        and ASHRAE Handbook—Fundamentals (latest edition), Heat Transfer chapter. ISO 6946 provides standard surface resistances and the parallel-path method;
        ASHRAE provides material properties and thermal analysis fundamentals.
        Direct references:
      </p>
<ul>
<li>
          ISO 6946:2017 — <a href="https://www.iso.org/standard/65708.html" rel="nofollow noopener" target="_blank">iso.org/standard/65708.html</a>
          — Surface resistances and series/parallel calculations.
        </li>
<li>
          ASHRAE Handbook—Fundamentals (2021/2025), Ch. on Heat Transfer and Building Envelope — <a href="https://www.ashrae.org/technical-resources/ashrae-handbook" rel="nofollow noopener" target="_blank">ashrae.org</a>
</li>
<li>
          ASTM C168-22 “Standard Terminology Relating to Thermal Insulation” — <a href="https://www.astm.org/c0168-22.html" rel="nofollow noopener" target="_blank">astm.org/c0168-22.html</a>
</li>
</ul>
<p><strong>All calculations are strictly based on the formulas and data provided by this source.</strong></p>
<h2>The Formula Explained</h2>
<div aria-label="Formulas in LaTeX" class="formula-box" role="region">
<div><strong>Series (no framing):</strong></div>
<div>R_total = R_{si} + \sum_{i=1}^{n} R_i + R_{se}</div>
<div>U = \dfrac{1}{R_{total}}</div>
<br>
<div><strong>Layer resistance:</strong></div>
<div>R_i = \left(\dfrac{R}{\text{inch}}\right)_i \times \text{thickness}_i \quad \text{(Imperial)}</div>
<div>R_i = \left(\dfrac{RSI}{\text{mm}}\right)_i \times \text{thickness}_i \quad \text{(Metric)}</div>
<br>
<div><strong>Parallel-path effective U (framing):</strong></div>
<div>U_{eff} = f \cdot U_{stud} + (1-f) \cdot U_{cavity}</div>
<div>R_{eff} = \dfrac{1}{U_{eff}}</div>
<br>
<div><strong>Unit conversion:</strong></div>
<div>R = 5.678263 \times RSI \quad ; \quad RSI = \dfrac{R}{5.678263}</div>
<div>R_{si} \approx 0.13\ \text{m}^2\cdot\text{K/W} \quad ; \quad R_{se} \approx 0.04\ \text{m}^2\cdot\text{K/W}</div>
</div>
<h2>Glossary of Variables</h2>
<dl class="glossary">
<dt>Units</dt>
<dd>Choose Imperial (R in ft²·°F·h/BTU) or Metric (RSI in m²·K/W).</dd>
<dt>Surface films (Rsi, Rse)</dt>
<dd>Standard interior/exterior surface resistances applied in series per ISO 6946.</dd>
<dt>Layer material</dt>
<dd>Typical materials with representative R-per-inch; “Custom” lets you define your own value.</dd>
<dt>Thickness</dt>
<dd>Material thickness: inches (Imperial) or millimeters (Metric).</dd>
<dt>Framing factor (f)</dt>
<dd>Percentage of the assembly area occupied by framing members (studs, plates, etc.).</dd>
<dt>Cavity depth</dt>
<dd>Stud depth or insulation thickness in the cavity path.</dd>
<dt>Total R (series)</dt>
<dd>Sum of all resistances in series (including optional surface films).</dd>
<dt>U-factor</dt>
<dd>Overall heat transfer coefficient: U = 1/R (Imperial) or 1/RSI (Metric).</dd>
<dt>Effective R (with framing)</dt>
<dd>Parallel-path result combining cavity and stud paths by area weighting.</dd>
</dl>
<h2>Worked Example</h2>
<h3>How It Works: A Step-by-Step Example</h3>
<p>
        Suppose you have a 2×4 wood-stud wall with fiberglass batt insulation (3.5 in), 1/2 in gypsum interior, and 1 in XPS exterior, including surface films.
        Choose Imperial (R). Layers:
      </p>
<ul>
<li>Interior film: R ≈ 0.13 × 5.678 ≈ 0.74</li>
<li>1/2 in gypsum (R/in ≈ 0.45): R ≈ 0.45 × 0.5 = 0.225</li>
<li>3.5 in fiberglass (R/in ≈ 3.2): R ≈ 3.2 × 3.5 = 11.2</li>
<li>1 in XPS (R/in ≈ 5.0): R = 5.0 × 1 = 5.0</li>
<li>Exterior film: R ≈ 0.04 × 5.678 ≈ 0.23</li>
</ul>
<p>Total series R ≈ 0.74 + 0.225 + 11.2 + 5.0 + 0.23 = 17.395. U ≈ 1 / 17.395 = 0.0575 BTU/(h·ft²·°F).</p>
<p>
        With framing factor f = 23% and wood studs (R/in ≈ 1.25):
        R_cavity_path ≈ 17.395; R_stud_path replaces the 11.2 batt with 1.25 × 3.5 = 4.375, so R_stud ≈ 10.57.
        U_cavity ≈ 1/17.395 = 0.0575; U_stud ≈ 1/10.57 = 0.0946.
        U_eff = 0.23 × 0.0946 + 0.77 × 0.0575 = 0.0662; R_eff ≈ 1/0.0662 = 15.1.
      </p>
<h2>Frequently Asked Questions (FAQ)</h2>
<div>
<h3>Do these R-per-inch values match every product?</h3>
<p>No. They are representative. Always verify with manufacturer datasheets (ASTM C518/C177 testing).</p>
<h3>What framing factor should I use?</h3>
<p>Common assumptions: 23% for 16 in o.c. wood studs, 20% for 24 in o.c. Use project-specific takeoffs when possible.</p>
<h3>How accurate is the steel stud model?</h3>
<p>Parallel-path with R-per-inch for steel is a simplification. Steel studs cause significant thermal bridging; consult advanced 2D/3D simulations (ISO 10211) for critical designs.</p>
<h3>Can I model continuous exterior insulation?</h3>
<p>Yes. Add it as a layer. Continuous insulation reduces thermal bridging and boosts effective R significantly.</p>
<h3>Why include surface films?</h3>
<p>They represent boundary layer resistances in steady-state. ISO 6946 provides standard values for consistent comparisons.</p>
<h3>How do I convert between R and RSI?</h3>
<p>The tool switches units automatically: R = 5.678263 × RSI, and U uses the reciprocal in the chosen system.</p>
<h3>Is this calculator a substitute for energy modeling?</h3>
<p>No. It’s a fast, transparent estimator for assemblies. For compliance or complex details, use approved simulation tools.</p>
</div>
<div class="author-box">
<p>
        </p>
</div>
</section>

<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\]</div>
  <pre class="auditspine-mono">','</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Series (no framing): R_total = R_{si} + \sum_{i=1}^{n} R_i + R_{se} U = \dfrac{1}{R_{total}} Layer resistance: R_i = \left(\dfrac{R}{\text{inch}}\right)_i \times \text{thickness}_i \quad \text{(Imperial)} R_i = \left(\dfrac{RSI}{\text{mm}}\right)_i \times \text{thickness}_i \quad \text{(Metric)} Parallel-path effective U (framing): U_{eff} = f \cdot U_{stud} + (1-f) \cdot U_{cavity} R_{eff} = \dfrac{1}{U_{eff}} Unit conversion: R = 5.678263 \times RSI \quad ; \quad RSI = \dfrac{R}{5.678263} R_{si} \approx 0.13\ \text{m}^2\cdot\text{K/W} \quad ; \quad R_{se} \approx 0.04\ \text{m}^2\cdot\text{K/W}</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>iso.org/standard/65708.html</strong> — iso.org · Accessed 2026-01-19<br><a href="https://www.iso.org/standard/65708.html" target="_blank" rel="nofollow noopener">https://www.iso.org/standard/65708.html</a></li>
<li><strong>Construction</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/construction-diy" target="_blank" rel="nofollow noopener">https://calcdomain.com/construction-diy</a></li>
<li><strong>ashrae.org</strong> — ashrae.org · Accessed 2026-01-19<br><a href="https://www.ashrae.org/technical-resources/ashrae-handbook" target="_blank" rel="nofollow noopener">https://www.ashrae.org/technical-resources/ashrae-handbook</a></li>
<li><strong>astm.org/c0168-22.html</strong> — astm.org · Accessed 2026-01-19<br><a href="https://www.astm.org/c0168-22.html" target="_blank" rel="nofollow noopener">https://www.astm.org/c0168-22.html</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->


</main>
<div data-canon-btnrow="1" style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
<button id="calcBtn" type="button" class="btn">Calculate</button>

<button id="resetBtn" type="button" class="btn btnSecondary">Reset</button>
</div>
</section>
      <section class="card sticky-box" id="resultsCard" aria-label="Calculator results"></section>
    </div>

    <section class="card content-card" id="howToUse" aria-label="How to use and methodology">
      <h2>Full original guide (expanded)</h2>
    <a class="skip-link" href="#main-content">Skip to main content</a><link rel="preload" href="https://calcdomain.com/assets/js/mobile-menu.js" as="script"><link rel="preload" href="https://calcdomain.com/assets/js/page-enhancements.js" as="script"><style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style><a class="skip-link" href="#main-content">Skip to main content</a><main class="container" id="main-content" role="main">
<nav aria-label="Breadcrumb" class="breadcrumb">
Home /
      <a href="https://calcdomain.com/construction-diy">Construction</a> /
      General /
      Insulation R-Value Calculator
    </nav>
<h1>Insulation R-Value Calculator</h1>
<p>
      This professional-grade calculator helps builders, energy consultants, architects, and homeowners compute the total thermal resistance (R or RSI) of layered wall, roof, and floor assemblies. It supports surface film coefficients and an optional framing factor to deliver an ISO 6946–style effective R-value. Mobile-first, accessible, and optimized for performance.
    </p>
<div class="calculator-layout">
<!-- Calculator -->
<section aria-labelledby="calc-heading" class="calculator card" id="rvalue-calculator">
<h2 id="calc-heading">Calculator</h2>
<!-- Units -->
<div class="form-group">
<fieldset>
<legend class="required">Units</legend>
<div aria-label="Units" class="radio-group" role="radiogroup">
<div class="radio-option">
<input checked="" id="unitR" name="units" type="radio" value="R">
<label for="unitR">Imperial (R)</label>
</div>
<div class="radio-option">
<input id="unitRSI" name="units" type="radio" value="RSI">
<label for="unitRSI">Metric (RSI)</label>
</div>
</div>
</fieldset>
</div>
<!-- Surface films -->
<div class="form-group">
<label class="required" id="filmLabel">Surface films</label>
<button aria-controls="filmHelp" aria-expanded="false" aria-label="Toggle help for surface films" class="help-btn" type="button">?</button>
<div class="tooltip" id="filmHelp" role="note">
            ISO 6946 recommends standard surface resistances: interior Rsi = 0.13 m²·K/W and exterior Rse = 0.04 m²·K/W.
            These are applied in series with the other layers.
          </div>
<div aria-labelledby="filmLabel" role="group" style="display:flex; gap:1rem; margin-top:.5rem; flex-wrap:wrap;">
<label><input checked="" id="includeInteriorFilm" type="checkbox"> Include interior film</label>
<label><input checked="" id="includeExteriorFilm" type="checkbox"> Include exterior film</label>
</div>
</div>
<!-- Layers -->
<div class="form-group">
<label>Assembly layers (series)</label>
<div aria-live="polite" class="layers" id="layers"></div>
<div class="layer-actions" style="margin-top:.5rem;">
<button aria-label="Add layer" class="btn btn-primary" id="addLayerBtn" type="button">+ Add layer</button>
</div>
</div>
<!-- Framing (optional) -->
<div aria-labelledby="frameHeading" class="form-group collapsible">
<div class="collapse-toggle">
<h3 id="frameHeading" style="margin:0;">Framed assembly (optional)</h3>
<button aria-controls="framingPanel" aria-expanded="false" id="toggleFraming" type="button">Show</button>
</div>
<div aria-hidden="true" class="collapse-panel" id="framingPanel">
<div class="form-group">
<label class="required" for="framingFactor">Framing factor (%)</label>
<div class="input-group">
<input aria-describedby="framingFactorError framingHelp" aria-required="true" class="form-control" id="framingFactor" inputmode="decimal" max="80" min="0" step="0.1" type="number" value="23">
<span class="input-suffix">%</span>
</div>
<div aria-live="polite" class="error-message" id="framingFactorError" role="alert"></div>
<div class="tooltip" data-open="true" id="framingHelp">
                Typical wood framing factors: ~23% @ 16" o.c., ~20% @ 24" o.c. Steel studs often have higher thermal bridging.
              </div>
</div>
<div class="form-group">
<label class="required" for="cavityDepth">Cavity depth</label>
<button aria-controls="cavityHelp" aria-expanded="false" aria-label="Toggle help for cavity depth" class="help-btn" type="button">?</button>
<div class="input-group">
<input aria-describedby="cavityDepthError cavityHelp" aria-required="true" class="form-control" id="cavityDepth" inputmode="decimal" min="0" step="0.1" type="number" value="3.5">
<span class="input-suffix" id="cavityUnit">in</span>
</div>
<div aria-live="polite" class="error-message" id="cavityDepthError" role="alert"></div>
<div class="tooltip" id="cavityHelp">Depth of the insulated cavity (stud depth). Used to compute the path-specific resistance.</div>
</div>
<div class="form-group">
<label class="required" for="cavityInsulation">Cavity insulation</label>
<select aria-describedby="cavityInsulationError" aria-required="true" class="form-control" id="cavityInsulation">
<!-- populated by JS -->
</select>
<div aria-live="polite" class="error-message" id="cavityInsulationError" role="alert"></div>
</div>
<div class="form-group">
<label class="required" for="studMaterial">Stud material</label>
<select aria-describedby="studMaterialError" aria-required="true" class="form-control" id="studMaterial">
<!-- populated by JS -->
</select>
<div aria-live="polite" class="error-message" id="studMaterialError" role="alert"></div>
</div>
</div>
</div>
</section>
<!-- Results -->
<section aria-labelledby="results-heading" class="results card" id="results">
<h2 id="results-heading">Results</h2>
<div aria-atomic="true" aria-live="polite" class="results-container">
<div class="result-item">
<span class="result-label">Total R (series, no framing)</span>
<span class="result-value" id="totalRDisplay">R 0.00</span>
</div>
<div class="result-item">
<span class="result-label">U-factor (no framing)</span>
<span class="result-value" id="uNoFrameDisplay">BTU/(h·ft²·°F) 0.000</span>
</div>
<div class="result-item" hidden="" id="effectiveRRow">
<span class="result-label">Effective R (with framing)</span>
<span class="result-value" id="effectiveRDisplay">R 0.00</span>
</div>
<div class="result-item" hidden="" id="effectiveURow">
<span class="result-label">Effective U (with framing)</span>
<span class="result-value" id="effectiveUDisplay">BTU/(h·ft²·°F) 0.000</span>
</div>
</div>
<p style="margin-top:.75rem; color:var(--muted-text-color);">
          Note: U = 1/R (Imperial) or 1/RSI (Metric). Results update as you type.
        </p>
</section>
</div>
<!-- Authoritative content -->
<section aria-labelledby="methodology" class="content">
<h2 id="methodology">Data Source and Methodology</h2>
<p>
        Authoritative sources: ISO 6946:2017 “Building components and building elements — Thermal resistance and thermal transmittance — Calculation methods”
        and ASHRAE Handbook—Fundamentals (latest edition), Heat Transfer chapter. ISO 6946 provides standard surface resistances and the parallel-path method;
        ASHRAE provides material properties and thermal analysis fundamentals.
        Direct references:
      </p>
<ul>
<li>
          ISO 6946:2017 — <a href="https://www.iso.org/standard/65708.html" rel="nofollow noopener" target="_blank">iso.org/standard/65708.html</a>
          — Surface resistances and series/parallel calculations.
        </li>
<li>
          ASHRAE Handbook—Fundamentals (2021/2025), Ch. on Heat Transfer and Building Envelope — <a href="https://www.ashrae.org/technical-resources/ashrae-handbook" rel="nofollow noopener" target="_blank">ashrae.org</a>
</li>
<li>
          ASTM C168-22 “Standard Terminology Relating to Thermal Insulation” — <a href="https://www.astm.org/c0168-22.html" rel="nofollow noopener" target="_blank">astm.org/c0168-22.html</a>
</li>
</ul>
<p><strong>All calculations are strictly based on the formulas and data provided by this source.</strong></p>
<h2>The Formula Explained</h2>
<div aria-label="Formulas in LaTeX" class="formula-box" role="region">
<div><strong>Series (no framing):</strong></div>
<div>R_total = R_{si} + \sum_{i=1}^{n} R_i + R_{se}</div>
<div>U = \dfrac{1}{R_{total}}</div>
<br>
<div><strong>Layer resistance:</strong></div>
<div>R_i = \left(\dfrac{R}{\text{inch}}\right)_i \times \text{thickness}_i \quad \text{(Imperial)}</div>
<div>R_i = \left(\dfrac{RSI}{\text{mm}}\right)_i \times \text{thickness}_i \quad \text{(Metric)}</div>
<br>
<div><strong>Parallel-path effective U (framing):</strong></div>
<div>U_{eff} = f \cdot U_{stud} + (1-f) \cdot U_{cavity}</div>
<div>R_{eff} = \dfrac{1}{U_{eff}}</div>
<br>
<div><strong>Unit conversion:</strong></div>
<div>R = 5.678263 \times RSI \quad ; \quad RSI = \dfrac{R}{5.678263}</div>
<div>R_{si} \approx 0.13\ \text{m}^2\cdot\text{K/W} \quad ; \quad R_{se} \approx 0.04\ \text{m}^2\cdot\text{K/W}</div>
</div>
<h2>Glossary of Variables</h2>
<dl class="glossary">
<dt>Units</dt>
<dd>Choose Imperial (R in ft²·°F·h/BTU) or Metric (RSI in m²·K/W).</dd>
<dt>Surface films (Rsi, Rse)</dt>
<dd>Standard interior/exterior surface resistances applied in series per ISO 6946.</dd>
<dt>Layer material</dt>
<dd>Typical materials with representative R-per-inch; “Custom” lets you define your own value.</dd>
<dt>Thickness</dt>
<dd>Material thickness: inches (Imperial) or millimeters (Metric).</dd>
<dt>Framing factor (f)</dt>
<dd>Percentage of the assembly area occupied by framing members (studs, plates, etc.).</dd>
<dt>Cavity depth</dt>
<dd>Stud depth or insulation thickness in the cavity path.</dd>
<dt>Total R (series)</dt>
<dd>Sum of all resistances in series (including optional surface films).</dd>
<dt>U-factor</dt>
<dd>Overall heat transfer coefficient: U = 1/R (Imperial) or 1/RSI (Metric).</dd>
<dt>Effective R (with framing)</dt>
<dd>Parallel-path result combining cavity and stud paths by area weighting.</dd>
</dl>
<h2>Worked Example</h2>
<h3>How It Works: A Step-by-Step Example</h3>
<p>
        Suppose you have a 2×4 wood-stud wall with fiberglass batt insulation (3.5 in), 1/2 in gypsum interior, and 1 in XPS exterior, including surface films.
        Choose Imperial (R). Layers:
      </p>
<ul>
<li>Interior film: R ≈ 0.13 × 5.678 ≈ 0.74</li>
<li>1/2 in gypsum (R/in ≈ 0.45): R ≈ 0.45 × 0.5 = 0.225</li>
<li>3.5 in fiberglass (R/in ≈ 3.2): R ≈ 3.2 × 3.5 = 11.2</li>
<li>1 in XPS (R/in ≈ 5.0): R = 5.0 × 1 = 5.0</li>
<li>Exterior film: R ≈ 0.04 × 5.678 ≈ 0.23</li>
</ul>
<p>Total series R ≈ 0.74 + 0.225 + 11.2 + 5.0 + 0.23 = 17.395. U ≈ 1 / 17.395 = 0.0575 BTU/(h·ft²·°F).</p>
<p>
        With framing factor f = 23% and wood studs (R/in ≈ 1.25):
        R_cavity_path ≈ 17.395; R_stud_path replaces the 11.2 batt with 1.25 × 3.5 = 4.375, so R_stud ≈ 10.57.
        U_cavity ≈ 1/17.395 = 0.0575; U_stud ≈ 1/10.57 = 0.0946.
        U_eff = 0.23 × 0.0946 + 0.77 × 0.0575 = 0.0662; R_eff ≈ 1/0.0662 = 15.1.
      </p>
<h2>Frequently Asked Questions (FAQ)</h2>
<div>
<h3>Do these R-per-inch values match every product?</h3>
<p>No. They are representative. Always verify with manufacturer datasheets (ASTM C518/C177 testing).</p>
<h3>What framing factor should I use?</h3>
<p>Common assumptions: 23% for 16 in o.c. wood studs, 20% for 24 in o.c. Use project-specific takeoffs when possible.</p>
<h3>How accurate is the steel stud model?</h3>
<p>Parallel-path with R-per-inch for steel is a simplification. Steel studs cause significant thermal bridging; consult advanced 2D/3D simulations (ISO 10211) for critical designs.</p>
<h3>Can I model continuous exterior insulation?</h3>
<p>Yes. Add it as a layer. Continuous insulation reduces thermal bridging and boosts effective R significantly.</p>
<h3>Why include surface films?</h3>
<p>They represent boundary layer resistances in steady-state. ISO 6946 provides standard values for consistent comparisons.</p>
<h3>How do I convert between R and RSI?</h3>
<p>The tool switches units automatically: R = 5.678263 × RSI, and U uses the reciprocal in the chosen system.</p>
<h3>Is this calculator a substitute for energy modeling?</h3>
<p>No. It’s a fast, transparent estimator for assemblies. For compliance or complex details, use approved simulation tools.</p>
</div>
<div class="author-box">
<p>
        </p>
</div>
</section>

<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\]</div>
  <pre class="auditspine-mono">','</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Series (no framing): R_total = R_{si} + \sum_{i=1}^{n} R_i + R_{se} U = \dfrac{1}{R_{total}} Layer resistance: R_i = \left(\dfrac{R}{\text{inch}}\right)_i \times \text{thickness}_i \quad \text{(Imperial)} R_i = \left(\dfrac{RSI}{\text{mm}}\right)_i \times \text{thickness}_i \quad \text{(Metric)} Parallel-path effective U (framing): U_{eff} = f \cdot U_{stud} + (1-f) \cdot U_{cavity} R_{eff} = \dfrac{1}{U_{eff}} Unit conversion: R = 5.678263 \times RSI \quad ; \quad RSI = \dfrac{R}{5.678263} R_{si} \approx 0.13\ \text{m}^2\cdot\text{K/W} \quad ; \quad R_{se} \approx 0.04\ \text{m}^2\cdot\text{K/W}</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>iso.org/standard/65708.html</strong> — iso.org · Accessed 2026-01-19<br><a href="https://www.iso.org/standard/65708.html" target="_blank" rel="nofollow noopener">https://www.iso.org/standard/65708.html</a></li>
<li><strong>Construction</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/construction-diy" target="_blank" rel="nofollow noopener">https://calcdomain.com/construction-diy</a></li>
<li><strong>ashrae.org</strong> — ashrae.org · Accessed 2026-01-19<br><a href="https://www.ashrae.org/technical-resources/ashrae-handbook" target="_blank" rel="nofollow noopener">https://www.ashrae.org/technical-resources/ashrae-handbook</a></li>
<li><strong>astm.org/c0168-22.html</strong> — astm.org · Accessed 2026-01-19<br><a href="https://www.astm.org/c0168-22.html" target="_blank" rel="nofollow noopener">https://www.astm.org/c0168-22.html</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main><link rel="preload" href="https://calcdomain.com/assets/js/mobile-menu.js" as="script"><link rel="preload" href="https://calcdomain.com/assets/js/page-enhancements.js" as="script"><style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style><a class="skip-link" href="#main-content">Skip to main content</a><main class="container" id="main-content" role="main">
<nav aria-label="Breadcrumb" class="breadcrumb">
Home /
      <a href="https://calcdomain.com/construction-diy">Construction</a> /
      General /
      Insulation R-Value Calculator
    </nav>
<h1>Insulation R-Value Calculator</h1>
<p>
      This professional-grade calculator helps builders, energy consultants, architects, and homeowners compute the total thermal resistance (R or RSI) of layered wall, roof, and floor assemblies. It supports surface film coefficients and an optional framing factor to deliver an ISO 6946–style effective R-value. Mobile-first, accessible, and optimized for performance.
    </p>
<div class="calculator-layout">
<!-- Calculator -->
<section aria-labelledby="calc-heading" class="calculator card" id="rvalue-calculator">
<h2 id="calc-heading">Calculator</h2>
<!-- Units -->
<div class="form-group">
<fieldset>
<legend class="required">Units</legend>
<div aria-label="Units" class="radio-group" role="radiogroup">
<div class="radio-option">
<input checked="" id="unitR" name="units" type="radio" value="R">
<label for="unitR">Imperial (R)</label>
</div>
<div class="radio-option">
<input id="unitRSI" name="units" type="radio" value="RSI">
<label for="unitRSI">Metric (RSI)</label>
</div>
</div>
</fieldset>
</div>
<!-- Surface films -->
<div class="form-group">
<label class="required" id="filmLabel">Surface films</label>
<button aria-controls="filmHelp" aria-expanded="false" aria-label="Toggle help for surface films" class="help-btn" type="button">?</button>
<div class="tooltip" id="filmHelp" role="note">
            ISO 6946 recommends standard surface resistances: interior Rsi = 0.13 m²·K/W and exterior Rse = 0.04 m²·K/W.
            These are applied in series with the other layers.
          </div>
<div aria-labelledby="filmLabel" role="group" style="display:flex; gap:1rem; margin-top:.5rem; flex-wrap:wrap;">
<label><input checked="" id="includeInteriorFilm" type="checkbox"> Include interior film</label>
<label><input checked="" id="includeExteriorFilm" type="checkbox"> Include exterior film</label>
</div>
</div>
<!-- Layers -->
<div class="form-group">
<label>Assembly layers (series)</label>
<div aria-live="polite" class="layers" id="layers"></div>
<div class="layer-actions" style="margin-top:.5rem;">
<button aria-label="Add layer" class="btn btn-primary" id="addLayerBtn" type="button">+ Add layer</button>
</div>
</div>
<!-- Framing (optional) -->
<div aria-labelledby="frameHeading" class="form-group collapsible">
<div class="collapse-toggle">
<h3 id="frameHeading" style="margin:0;">Framed assembly (optional)</h3>
<button aria-controls="framingPanel" aria-expanded="false" id="toggleFraming" type="button">Show</button>
</div>
<div aria-hidden="true" class="collapse-panel" id="framingPanel">
<div class="form-group">
<label class="required" for="framingFactor">Framing factor (%)</label>
<div class="input-group">
<input aria-describedby="framingFactorError framingHelp" aria-required="true" class="form-control" id="framingFactor" inputmode="decimal" max="80" min="0" step="0.1" type="number" value="23">
<span class="input-suffix">%</span>
</div>
<div aria-live="polite" class="error-message" id="framingFactorError" role="alert"></div>
<div class="tooltip" data-open="true" id="framingHelp">
                Typical wood framing factors: ~23% @ 16" o.c., ~20% @ 24" o.c. Steel studs often have higher thermal bridging.
              </div>
</div>
<div class="form-group">
<label class="required" for="cavityDepth">Cavity depth</label>
<button aria-controls="cavityHelp" aria-expanded="false" aria-label="Toggle help for cavity depth" class="help-btn" type="button">?</button>
<div class="input-group">
<input aria-describedby="cavityDepthError cavityHelp" aria-required="true" class="form-control" id="cavityDepth" inputmode="decimal" min="0" step="0.1" type="number" value="3.5">
<span class="input-suffix" id="cavityUnit">in</span>
</div>
<div aria-live="polite" class="error-message" id="cavityDepthError" role="alert"></div>
<div class="tooltip" id="cavityHelp">Depth of the insulated cavity (stud depth). Used to compute the path-specific resistance.</div>
</div>
<div class="form-group">
<label class="required" for="cavityInsulation">Cavity insulation</label>
<select aria-describedby="cavityInsulationError" aria-required="true" class="form-control" id="cavityInsulation">
<!-- populated by JS -->
</select>
<div aria-live="polite" class="error-message" id="cavityInsulationError" role="alert"></div>
</div>
<div class="form-group">
<label class="required" for="studMaterial">Stud material</label>
<select aria-describedby="studMaterialError" aria-required="true" class="form-control" id="studMaterial">
<!-- populated by JS -->
</select>
<div aria-live="polite" class="error-message" id="studMaterialError" role="alert"></div>
</div>
</div>
</div>
</section>
<!-- Results -->
<section aria-labelledby="results-heading" class="results card" id="results">
<h2 id="results-heading">Results</h2>
<div aria-atomic="true" aria-live="polite" class="results-container">
<div class="result-item">
<span class="result-label">Total R (series, no framing)</span>
<span class="result-value" id="totalRDisplay">R 0.00</span>
</div>
<div class="result-item">
<span class="result-label">U-factor (no framing)</span>
<span class="result-value" id="uNoFrameDisplay">BTU/(h·ft²·°F) 0.000</span>
</div>
<div class="result-item" hidden="" id="effectiveRRow">
<span class="result-label">Effective R (with framing)</span>
<span class="result-value" id="effectiveRDisplay">R 0.00</span>
</div>
<div class="result-item" hidden="" id="effectiveURow">
<span class="result-label">Effective U (with framing)</span>
<span class="result-value" id="effectiveUDisplay">BTU/(h·ft²·°F) 0.000</span>
</div>
</div>
<p style="margin-top:.75rem; color:var(--muted-text-color);">
          Note: U = 1/R (Imperial) or 1/RSI (Metric). Results update as you type.
        </p>
</section>
</div>
<!-- Authoritative content -->
<section aria-labelledby="methodology" class="content">
<h2 id="methodology">Data Source and Methodology</h2>
<p>
        Authoritative sources: ISO 6946:2017 “Building components and building elements — Thermal resistance and thermal transmittance — Calculation methods”
        and ASHRAE Handbook—Fundamentals (latest edition), Heat Transfer chapter. ISO 6946 provides standard surface resistances and the parallel-path method;
        ASHRAE provides material properties and thermal analysis fundamentals.
        Direct references:
      </p>
<ul>
<li>
          ISO 6946:2017 — <a href="https://www.iso.org/standard/65708.html" rel="nofollow noopener" target="_blank">iso.org/standard/65708.html</a>
          — Surface resistances and series/parallel calculations.
        </li>
<li>
          ASHRAE Handbook—Fundamentals (2021/2025), Ch. on Heat Transfer and Building Envelope — <a href="https://www.ashrae.org/technical-resources/ashrae-handbook" rel="nofollow noopener" target="_blank">ashrae.org</a>
</li>
<li>
          ASTM C168-22 “Standard Terminology Relating to Thermal Insulation” — <a href="https://www.astm.org/c0168-22.html" rel="nofollow noopener" target="_blank">astm.org/c0168-22.html</a>
</li>
</ul>
<p><strong>All calculations are strictly based on the formulas and data provided by this source.</strong></p>
<h2>The Formula Explained</h2>
<div aria-label="Formulas in LaTeX" class="formula-box" role="region">
<div><strong>Series (no framing):</strong></div>
<div>R_total = R_{si} + \sum_{i=1}^{n} R_i + R_{se}</div>
<div>U = \dfrac{1}{R_{total}}</div>
<br>
<div><strong>Layer resistance:</strong></div>
<div>R_i = \left(\dfrac{R}{\text{inch}}\right)_i \times \text{thickness}_i \quad \text{(Imperial)}</div>
<div>R_i = \left(\dfrac{RSI}{\text{mm}}\right)_i \times \text{thickness}_i \quad \text{(Metric)}</div>
<br>
<div><strong>Parallel-path effective U (framing):</strong></div>
<div>U_{eff} = f \cdot U_{stud} + (1-f) \cdot U_{cavity}</div>
<div>R_{eff} = \dfrac{1}{U_{eff}}</div>
<br>
<div><strong>Unit conversion:</strong></div>
<div>R = 5.678263 \times RSI \quad ; \quad RSI = \dfrac{R}{5.678263}</div>
<div>R_{si} \approx 0.13\ \text{m}^2\cdot\text{K/W} \quad ; \quad R_{se} \approx 0.04\ \text{m}^2\cdot\text{K/W}</div>
</div>
<h2>Glossary of Variables</h2>
<dl class="glossary">
<dt>Units</dt>
<dd>Choose Imperial (R in ft²·°F·h/BTU) or Metric (RSI in m²·K/W).</dd>
<dt>Surface films (Rsi, Rse)</dt>
<dd>Standard interior/exterior surface resistances applied in series per ISO 6946.</dd>
<dt>Layer material</dt>
<dd>Typical materials with representative R-per-inch; “Custom” lets you define your own value.</dd>
<dt>Thickness</dt>
<dd>Material thickness: inches (Imperial) or millimeters (Metric).</dd>
<dt>Framing factor (f)</dt>
<dd>Percentage of the assembly area occupied by framing members (studs, plates, etc.).</dd>
<dt>Cavity depth</dt>
<dd>Stud depth or insulation thickness in the cavity path.</dd>
<dt>Total R (series)</dt>
<dd>Sum of all resistances in series (including optional surface films).</dd>
<dt>U-factor</dt>
<dd>Overall heat transfer coefficient: U = 1/R (Imperial) or 1/RSI (Metric).</dd>
<dt>Effective R (with framing)</dt>
<dd>Parallel-path result combining cavity and stud paths by area weighting.</dd>
</dl>
<h2>Worked Example</h2>
<h3>How It Works: A Step-by-Step Example</h3>
<p>
        Suppose you have a 2×4 wood-stud wall with fiberglass batt insulation (3.5 in), 1/2 in gypsum interior, and 1 in XPS exterior, including surface films.
        Choose Imperial (R). Layers:
      </p>
<ul>
<li>Interior film: R ≈ 0.13 × 5.678 ≈ 0.74</li>
<li>1/2 in gypsum (R/in ≈ 0.45): R ≈ 0.45 × 0.5 = 0.225</li>
<li>3.5 in fiberglass (R/in ≈ 3.2): R ≈ 3.2 × 3.5 = 11.2</li>
<li>1 in XPS (R/in ≈ 5.0): R = 5.0 × 1 = 5.0</li>
<li>Exterior film: R ≈ 0.04 × 5.678 ≈ 0.23</li>
</ul>
<p>Total series R ≈ 0.74 + 0.225 + 11.2 + 5.0 + 0.23 = 17.395. U ≈ 1 / 17.395 = 0.0575 BTU/(h·ft²·°F).</p>
<p>
        With framing factor f = 23% and wood studs (R/in ≈ 1.25):
        R_cavity_path ≈ 17.395; R_stud_path replaces the 11.2 batt with 1.25 × 3.5 = 4.375, so R_stud ≈ 10.57.
        U_cavity ≈ 1/17.395 = 0.0575; U_stud ≈ 1/10.57 = 0.0946.
        U_eff = 0.23 × 0.0946 + 0.77 × 0.0575 = 0.0662; R_eff ≈ 1/0.0662 = 15.1.
      </p>
<h2>Frequently Asked Questions (FAQ)</h2>
<div>
<h3>Do these R-per-inch values match every product?</h3>
<p>No. They are representative. Always verify with manufacturer datasheets (ASTM C518/C177 testing).</p>
<h3>What framing factor should I use?</h3>
<p>Common assumptions: 23% for 16 in o.c. wood studs, 20% for 24 in o.c. Use project-specific takeoffs when possible.</p>
<h3>How accurate is the steel stud model?</h3>
<p>Parallel-path with R-per-inch for steel is a simplification. Steel studs cause significant thermal bridging; consult advanced 2D/3D simulations (ISO 10211) for critical designs.</p>
<h3>Can I model continuous exterior insulation?</h3>
<p>Yes. Add it as a layer. Continuous insulation reduces thermal bridging and boosts effective R significantly.</p>
<h3>Why include surface films?</h3>
<p>They represent boundary layer resistances in steady-state. ISO 6946 provides standard values for consistent comparisons.</p>
<h3>How do I convert between R and RSI?</h3>
<p>The tool switches units automatically: R = 5.678263 × RSI, and U uses the reciprocal in the chosen system.</p>
<h3>Is this calculator a substitute for energy modeling?</h3>
<p>No. It’s a fast, transparent estimator for assemblies. For compliance or complex details, use approved simulation tools.</p>
</div>
<div class="author-box">
<p>
        </p>
</div>
</section>

<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\]</div>
  <pre class="auditspine-mono">','</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Series (no framing): R_total = R_{si} + \sum_{i=1}^{n} R_i + R_{se} U = \dfrac{1}{R_{total}} Layer resistance: R_i = \left(\dfrac{R}{\text{inch}}\right)_i \times \text{thickness}_i \quad \text{(Imperial)} R_i = \left(\dfrac{RSI}{\text{mm}}\right)_i \times \text{thickness}_i \quad \text{(Metric)} Parallel-path effective U (framing): U_{eff} = f \cdot U_{stud} + (1-f) \cdot U_{cavity} R_{eff} = \dfrac{1}{U_{eff}} Unit conversion: R = 5.678263 \times RSI \quad ; \quad RSI = \dfrac{R}{5.678263} R_{si} \approx 0.13\ \text{m}^2\cdot\text{K/W} \quad ; \quad R_{se} \approx 0.04\ \text{m}^2\cdot\text{K/W}</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>iso.org/standard/65708.html</strong> — iso.org · Accessed 2026-01-19<br><a href="https://www.iso.org/standard/65708.html" target="_blank" rel="nofollow noopener">https://www.iso.org/standard/65708.html</a></li>
<li><strong>Construction</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/construction-diy" target="_blank" rel="nofollow noopener">https://calcdomain.com/construction-diy</a></li>
<li><strong>ashrae.org</strong> — ashrae.org · Accessed 2026-01-19<br><a href="https://www.ashrae.org/technical-resources/ashrae-handbook" target="_blank" rel="nofollow noopener">https://www.ashrae.org/technical-resources/ashrae-handbook</a></li>
<li><strong>astm.org/c0168-22.html</strong> — astm.org · Accessed 2026-01-19<br><a href="https://www.astm.org/c0168-22.html" target="_blank" rel="nofollow noopener">https://www.astm.org/c0168-22.html</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main></section>

    <section class="meta-section" id="pageMeta" aria-label="Verification, changelog, formulas, citations">
  <details id="formulaDetails">
    <summary style="cursor:pointer; font-weight:700; color:var(--text)">Formulas</summary>
    <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
      <p style="margin:0;">(Formulas preserved from original page content, if present.)</p>
    </div>
  </details>

  

  

  <div class="badge-row" id="badgeRow">
    <div class="badge" id="versionBadge">Version 0.1.0-draft</div>
  </div>

<details id="citationDetails" style="margin-top:10px;">
  <summary style="cursor:pointer; font-weight:700; color:var(--text)">Citations</summary>
  <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
    <p style="margin:0;">Add authoritative sources relevant to this calculator (standards bodies, manuals, official docs).</p>
  </div>
</details>

<details id="changelogDetails" style="margin-top:10px;">
  <summary style="cursor:pointer; font-weight:700; color:var(--text)">Changelog</summary>
  <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
    <ul style="padding-left:18px; margin:0;">
      <li>0.1.0-draft — 2026-01-19: Initial draft (review required).</li>
    </ul>
  </div>
</details>
</section>
  </main>
</div><footer id="siteFooter" class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="border-t border-gray-800 pt-8 text-center text-gray-400">
      <p>© 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer><script defer="">
    (function(){
      'use strict';

      // Materials dataset (typical R per inch, Imperial). References: ASHRAE, common manufacturer data.
      const MATERIALS = [
        { key:'fiberglass_batt', name:'Fiberglass batt', rPerIn:3.2 },
        { key:'cellulose', name:'Cellulose (loose/blown)', rPerIn:3.7 },
        { key:'mineral_wool', name:'Mineral wool (rock wool)', rPerIn:4.2 },
        { key:'eps', name:'EPS foam', rPerIn:4.0 },
        { key:'xps', name:'XPS foam', rPerIn:5.0 },
        { key:'polyiso', name:'Polyisocyanurate (polyiso)', rPerIn:6.0 },
        { key:'spray_foam_cc', name:'Spray foam (closed-cell)', rPerIn:6.5 },
        { key:'spray_foam_oc', name:'Spray foam (open-cell)', rPerIn:3.7 },
        { key:'gypsum', name:'Gypsum board (drywall)', rPerIn:0.45 },
        { key:'osb', name:'OSB', rPerIn:0.90 },
        { key:'plywood', name:'Plywood', rPerIn:1.25 },
        { key:'brick', name:'Brick (solid clay)', rPerIn:0.20 },
        { key:'concrete', name:'Concrete (dense)', rPerIn:0.08 },
        { key:'wood_soft', name:'Wood (softwood, studs)', rPerIn:1.25 },
        { key:'steel', name:'Steel (approx., see note)', rPerIn:0.003 }, // simplification for parallel-path
        { key:'air_gap_0p75', name:'Air space (approx. 3/4")', rPerIn:1.00 }, // simplified average
        { key:'custom', name:'Custom…', rPerIn:0 }
      ];

      const unitRadios = document.querySelectorAll('input[name="units"]');
      const layersContainer = document.getElementById('layers');
      const addLayerBtn = document.getElementById('addLayerBtn');
      const includeInteriorFilm = document.getElementById('includeInteriorFilm');
      const includeExteriorFilm = document.getElementById('includeExteriorFilm');

      // Framing
      const toggleFramingBtn = document.getElementById('toggleFraming');
      const framingPanel = document.getElementById('framingPanel');
      const framingFactorInput = document.getElementById('framingFactor');
      const cavityDepthInput = document.getElementById('cavityDepth');
      const cavityUnit = document.getElementById('cavityUnit');
      const cavityInsulationSelect = document.getElementById('cavityInsulation');
      const studMaterialSelect = document.getElementById('studMaterial');

      // Tooltips
      document.querySelectorAll('.help-btn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('aria-controls');
          const tip = document.getElementById(id);
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          if(tip){ tip.dataset.open = String(!expanded); }
        });
      });

      // Collapse framing
      toggleFramingBtn.addEventListener('click', ()=>{
        const isOpen = toggleFramingBtn.getAttribute('aria-expanded') === 'true';
        toggleFramingBtn.setAttribute('aria-expanded', String(!isOpen));
        toggleFramingBtn.textContent = isOpen ? 'Show' : 'Hide';
        framingPanel.setAttribute('aria-hidden', String(isOpen));
        updateResults();
      });

      // Populate selects for framing
      function populateSelect(select, includeCustom=false){
        select.innerHTML = '';
        MATERIALS.forEach(m=>{
          if(!includeCustom && m.key==='custom') return;
          const opt = document.createElement('option');
          opt.value = m.key;
          opt.textContent = m.name;
          select.appendChild(opt);
        });
      }
      populateSelect(cavityInsulationSelect);
      populateSelect(studMaterialSelect);

      // Layer model
      let layerIdCounter = 0;
      const state = {
        units: 'R',
        layers: []
      };

      function createLayerRow(preset){
        const rowId = ++layerIdCounter;
        const row = document.createElement('div');
        row.className = 'layer-row card';
        row.setAttribute('data-row-id', String(rowId));

        // Material select
        const matWrap = document.createElement('div');
        const matLabel = document.createElement('label');
        matLabel.htmlFor = `material-${rowId}`;
        matLabel.textContent = 'Material';
        const matSelect = document.createElement('select');
        matSelect.id = `material-${rowId}`;
        matSelect.className = 'form-control';
        matSelect.setAttribute('aria-describedby', `materialErr-${rowId}`);
        MATERIALS.forEach(m=>{
          const opt = document.createElement('option');
          opt.value = m.key; opt.textContent = m.name;
          matSelect.appendChild(opt);
        });
        const matErr = document.createElement('div');
        matErr.id = `materialErr-${rowId}`;
        matErr.className = 'error-message';
        matErr.setAttribute('role','alert');
        matErr.setAttribute('aria-live','polite');
        matWrap.append(matLabel, matSelect, matErr);

        // Thickness
        const thickWrap = document.createElement('div');
        const thickLabel = document.createElement('label');
        thickLabel.htmlFor = `thickness-${rowId}`;
        thickLabel.className = 'required';
        thickLabel.textContent = 'Thickness';
        const thickGroup = document.createElement('div');
        thickGroup.className = 'input-group';
        const thickInput = document.createElement('input');
        thickInput.id = `thickness-${rowId}`;
        thickInput.className = 'form-control';
        thickInput.type = 'number';
        thickInput.inputMode = 'decimal';
        thickInput.step = '0.1';
        thickInput.min = '0';
        thickInput.placeholder = state.units === 'R' ? 'e.g., 1.0' : 'e.g., 25';
        thickInput.setAttribute('aria-required','true');
        thickInput.setAttribute('aria-describedby', `thickErr-${rowId}`);
        const thickUnit = document.createElement('span');
        thickUnit.className = 'input-suffix';
        thickUnit.textContent = state.units === 'R' ? 'in' : 'mm';
        thickGroup.append(thickInput, thickUnit);
        const thickErr = document.createElement('div');
        thickErr.id = `thickErr-${rowId}`;
        thickErr.className = 'error-message';
        thickErr.setAttribute('role','alert');
        thickErr.setAttribute('aria-live','polite');
        thickWrap.append(thickLabel, thickGroup, thickErr);

        // Custom R/in
        const customWrap = document.createElement('div');
        const customLabel = document.createElement('label');
        customLabel.htmlFor = `customR-${rowId}`;
        customLabel.textContent = 'Custom R per inch';
        const customGroup = document.createElement('div');
        customGroup.className = 'input-group';
        const customInput = document.createElement('input');
        customInput.id = `customR-${rowId}`;
        customInput.className = 'form-control';
        customInput.type = 'number';
        customInput.inputMode = 'decimal';
        customInput.step = '0.01';
        customInput.min = '0';
        customInput.placeholder = 'e.g., 4.50';
        customInput.setAttribute('aria-describedby', `customErr-${rowId} customHelp-${rowId}`);
        const customSuffix = document.createElement('span');
        customSuffix.className = 'input-suffix';
        customSuffix.textContent = 'R/in';
        customGroup.append(customInput, customSuffix);
        const customErr = document.createElement('div');
        customErr.id = `customErr-${rowId}`;
        customErr.className = 'error-message';
        customErr.setAttribute('role','alert');
        customErr.setAttribute('aria-live','polite');
        const customHelp = document.createElement('div');
        customHelp.id = `customHelp-${rowId}`;
        customHelp.className = 'tooltip';
        customHelp.dataset.open = 'true';
        customHelp.textContent = 'When Material is “Custom…”, enter an Imperial R per inch; the calculator converts to RSI automatically.';
        customWrap.append(customLabel, customGroup, customErr, customHelp);
        customWrap.hidden = true;

        // Remove button
        const actions = document.createElement('div');
        actions.className = 'layer-actions';
        const remBtn = document.createElement('button');
        remBtn.className = 'remove-layer';
        remBtn.type = 'button';
        remBtn.setAttribute('aria-label', 'Remove layer');
        remBtn.textContent = 'Remove';
        actions.append(remBtn);

        row.append(matWrap, thickWrap, customWrap, actions);
        layersContainer.appendChild(row);

        const layerData = {
          id: rowId,
          material: preset?.material || 'fiberglass_batt',
          thickness: preset?.thickness ?? '',
          customRPerIn: preset?.customRPerIn ?? ''
        };
        state.layers.push(layerData);

        // Initialize values
        matSelect.value = layerData.material;
        thickInput.value = layerData.thickness;
        customInput.value = layerData.customRPerIn;
        toggleCustomVisibility();

        // Events
        matSelect.addEventListener('change', ()=>{
          layerData.material = matSelect.value;
          toggleCustomVisibility();
          validateRow();
          updateResults();
        });
        thickInput.addEventListener('input', ()=>{
          layerData.thickness = thickInput.value;
          updateResults();
        });
        thickInput.addEventListener('blur', ()=> validateRow());
        customInput.addEventListener('input', ()=>{
          layerData.customRPerIn = customInput.value;
          updateResults();
        });
        customInput.addEventListener('blur', ()=> validateRow());
        remBtn.addEventListener('click', ()=>{
          state.layers = state.layers.filter(l=>l.id!==rowId);
          row.remove();
          updateResults();
        });

        function toggleCustomVisibility(){
          const isCustom = matSelect.value === 'custom';
          customWrap.hidden = !isCustom;
        }

        function validateRow(){
          // Thickness
          const t = parseFloat(thickInput.value);
          let thickMsg = '';
          if(isNaN(t) || t <= 0){
            thickMsg = 'Enter a thickness greater than 0.';
          } else if (t > (state.units==='R'? 48 : 1200)){
            thickMsg = 'Thickness seems unusually large. Please confirm.';
          }
          thickErr.textContent = thickMsg;
          thickInput.setAttribute('aria-invalid', thickMsg ? 'true' : 'false');

          // Custom
          if(matSelect.value === 'custom'){
            const c = parseFloat(customInput.value);
            let customMsg = '';
            if(isNaN(c) || c <= 0){
              customMsg = 'Enter a positive R per inch for the custom material.';
            } else if (c > 12){
              customMsg = 'Value is high; verify the product specification.';
            }
            customErr.textContent = customMsg;
            customInput.setAttribute('aria-invalid', customMsg ? 'true' : 'false');
          } else {
            customErr.textContent = '';
            customInput.setAttribute('aria-invalid','false');
          }
        }

        return row;
      }

      // Initialize with two common layers
      createLayerRow({ material:'gypsum', thickness:0.5 });
      createLayerRow({ material:'fiberglass_batt', thickness:3.5 });
      createLayerRow({ material:'xps', thickness:1 });

      addLayerBtn.addEventListener('click', ()=>{
        createLayerRow();
      });

      // Units switching
      unitRadios.forEach(r=>{
        r.addEventListener('change', ()=>{
          if(!r.checked) return;
          state.units = r.value;
          // Update UI labels
          document.querySelectorAll('[id^="thickness-"]').forEach((input)=>{
            const suff = input.parentElement.querySelector('.input-suffix');
            if(suff){ suff.textContent = state.units === 'R' ? 'in' : 'mm'; }
            input.placeholder = state.units === 'R' ? 'e.g., 1.0' : 'e.g., 25';
          });
          cavityUnit.textContent = state.units === 'R' ? 'in' : 'mm';
          updateResults();
        });
      });

      // Framing events
      framingFactorInput.addEventListener('input', ()=>{ validateFraming(); updateResults(); });
      framingFactorInput.addEventListener('blur', validateFraming);
      cavityDepthInput.addEventListener('input', ()=>{ validateFraming(); updateResults(); });
      cavityDepthInput.addEventListener('blur', validateFraming);
      cavityInsulationSelect.addEventListener('change', updateResults);
      studMaterialSelect.addEventListener('change', updateResults);

      function validateFraming(){
        const ffEl = document.getElementById('framingFactorError');
        const cdEl = document.getElementById('cavityDepthError');

        const f = parseFloat(framingFactorInput.value);
        let ffMsg = '';
        if(isNaN(f) || f < 0) ffMsg = 'Enter a value ≥ 0.';
        else if (f > 80) ffMsg = 'Value too high for typical framing; please verify.';
        framingFactorInput.setAttribute('aria-invalid', ffMsg ? 'true' : 'false');
        ffEl.textContent = ffMsg;

        const d = parseFloat(cavityDepthInput.value);
        let cdMsg = '';
        if(isNaN(d) || d <= 0) cdMsg = 'Enter a depth greater than 0.';
        else if (d > (state.units==='R' ? 24 : 600)) cdMsg = 'Depth looks very large; please verify.';
        cavityDepthInput.setAttribute('aria-invalid', cdMsg ? 'true' : 'false');
        cdEl.textContent = cdMsg;
      }

      // Results elements
      const totalRDisplay = document.getElementById('totalRDisplay');
      const uNoFrameDisplay = document.getElementById('uNoFrameDisplay');
      const effectiveRRow = document.getElementById('effectiveRRow');
      const effectiveURow = document.getElementById('effectiveURow');
      const effectiveRDisplay = document.getElementById('effectiveRDisplay');
      const effectiveUDisplay = document.getElementById('effectiveUDisplay');

      // Constants
      const R_PER_RSI = 5.678263; // R = RSI * 5.678263

      function toRSI(R){ return R / R_PER_RSI; }
      function toR(RSI){ return RSI * R_PER_RSI; }

      function rPerInFor(key, customRPerIn){
        if(key === 'custom') return parseFloat(customRPerIn) || 0;
        const m = MATERIALS.find(m=>m.key===key);
        return m ? m.rPerIn : 0;
      }

      function layerR_imperial(layer){
        const rpi = rPerInFor(layer.material, layer.customRPerIn);
        const th = parseFloat(layer.thickness);
        if(isNaN(th) || th <= 0 || rpi <= 0) return 0;
        // thickness input: if units are metric, convert mm to inches
        let thicknessInches = th;
        if(state.units === 'RSI'){
          thicknessInches = th / 25.4;
        }
        return rpi * thicknessInches; // R
      }

      function filmsR_imperial(){
        // ISO 6946: Rsi = 0.13 m²K/W, Rse = 0.04 m²K/W
        const Rsi_R = toR(0.13);
        const Rse_R = toR(0.04);
        let sum = 0;
        if(includeInteriorFilm.checked) sum += Rsi_R;
        if(includeExteriorFilm.checked) sum += Rse_R;
        return sum;
      }

      function totalSeriesR_imperial(){
        const layersR = state.layers.reduce((acc, l)=> acc + layerR_imperial(l), 0);
        return layersR + filmsR_imperial();
      }

      function computeFramingEffectiveR_imperial(R_series){
        // Only if framing section is open (expanded)
        const framingEnabled = toggleFramingBtn.getAttribute('aria-expanded') === 'true';
        if(!framingEnabled) return null;

        // Validate
        const f_pct = parseFloat(framingFactorInput.value);
        const depth = parseFloat(cavityDepthInput.value);
        if(isNaN(f_pct) || f_pct < 0 || isNaN(depth) || depth <= 0) return null;

        const f = Math.min(Math.max(f_pct/100, 0), 0.8);

        // Compute the portion of R_series that is cavity insulation to replace per path.
        // Approach: Rebuild paths replacing ONLY the cavity layer with either insulation or stud material.
        // We need cavity resistance for insulation path:
        const cavKey = cavityInsulationSelect.value;
        const studKey = studMaterialSelect.value;

        let depthIn = depth;
        if(state.units === 'RSI') depthIn = depth / 25.4;

        const R_cavity_only = rPerInFor(cavKey, 0) * depthIn; // R of cavity insulation
        const R_stud_only = rPerInFor(studKey, 0) * depthIn;  // R of stud path for the cavity depth

        // Remove any previously counted cavity layer? Our series R already includes a batt layer possibly.
        // To avoid dependency on user layers, follow ISO 6946 simplification:
        // Treat "series R minus films" as continuous layers. Then add cavity-specific R for each path.
        const R_continuous_no_cavity = (R_series - filmsR_imperial()); // includes all user layers
        // Now create two paths adding films + continuous + path-specific cavity
        const R_path_cavity = R_continuous_no_cavity + R_cavity_only + filmsR_imperial();
        const R_path_stud   = R_continuous_no_cavity + R_stud_only + filmsR_imperial();

        // Convert to U and area-weighted
        const U_cavity = R_path_cavity > 0 ? 1 / R_path_cavity : 0;
        const U_stud   = R_path_stud > 0 ? 1 / R_path_stud : 0;
        const U_eff = f * U_stud + (1 - f) * U_cavity;
        if(U_eff <= 0) return null;
        return 1 / U_eff;
      }

      function formatNumber(x, digits){
        return Number(x).toLocaleString(undefined, { maximumFractionDigits: digits, minimumFractionDigits: digits });
      }

      function updateResults(){
        const R_series = totalSeriesR_imperial(); // in R
        // Display according to selected units
        if(state.units === 'R'){
          totalRDisplay.textContent = `R ${formatNumber(R_series, 2)}`;
          const U_nf = R_series > 0 ? (1 / R_series) : 0;
          uNoFrameDisplay.textContent = `BTU/(h·ft²·°F) ${formatNumber(U_nf, 3)}`;
        } else {
          const RSI = toRSI(R_series);
          totalRDisplay.textContent = `RSI ${formatNumber(RSI, 3)}`;
          const U_nf = RSI > 0 ? (1 / RSI) : 0;
          uNoFrameDisplay.textContent = `W/m²·K ${formatNumber(U_nf, 3)}`;
        }

        const R_eff = computeFramingEffectiveR_imperial(R_series);
        if(R_eff && isFinite(R_eff)){
          effectiveRRow.hidden = false;
          effectiveURow.hidden = false;
          if(state.units === 'R'){
            effectiveRDisplay.textContent = `R ${formatNumber(R_eff, 2)}`;
            effectiveUDisplay.textContent = `BTU/(h·ft²·°F) ${formatNumber(1/R_eff, 3)}`;
          } else {
            const RSI_eff = toRSI(R_eff);
            effectiveRDisplay.textContent = `RSI ${formatNumber(RSI_eff, 3)}`;
            effectiveUDisplay.textContent = `W/m²·K ${formatNumber(1/RSI_eff, 3)}`;
          }
        } else {
          effectiveRRow.hidden = true;
          effectiveURow.hidden = true;
        }
      }

      // Initialize results
      updateResults();

      // Update on film toggles
      includeInteriorFilm.addEventListener('change', updateResults);
      includeExteriorFilm.addEventListener('change', updateResults);

      // Accessibility: ensure all interactive elements are keyboard reachable (already buttons/inputs)
      // Debounce helper (lightweight)
      function debounce(fn, delay=80){
        let t; return (...args)=>{ clearTimeout(t); t = setTimeout(()=>fn.apply(null,args), delay); };
      }

      // Recompute on window resize in case of layout changes to prevent CLS via min-heights
      window.addEventListener('resize', debounce(updateResults, 150));
    })();
  </script><script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script defer="">
    (function(){
      'use strict';

      // Materials dataset (typical R per inch, Imperial). References: ASHRAE, common manufacturer data.
      const MATERIALS = [
        { key:'fiberglass_batt', name:'Fiberglass batt', rPerIn:3.2 },
        { key:'cellulose', name:'Cellulose (loose/blown)', rPerIn:3.7 },
        { key:'mineral_wool', name:'Mineral wool (rock wool)', rPerIn:4.2 },
        { key:'eps', name:'EPS foam', rPerIn:4.0 },
        { key:'xps', name:'XPS foam', rPerIn:5.0 },
        { key:'polyiso', name:'Polyisocyanurate (polyiso)', rPerIn:6.0 },
        { key:'spray_foam_cc', name:'Spray foam (closed-cell)', rPerIn:6.5 },
        { key:'spray_foam_oc', name:'Spray foam (open-cell)', rPerIn:3.7 },
        { key:'gypsum', name:'Gypsum board (drywall)', rPerIn:0.45 },
        { key:'osb', name:'OSB', rPerIn:0.90 },
        { key:'plywood', name:'Plywood', rPerIn:1.25 },
        { key:'brick', name:'Brick (solid clay)', rPerIn:0.20 },
        { key:'concrete', name:'Concrete (dense)', rPerIn:0.08 },
        { key:'wood_soft', name:'Wood (softwood, studs)', rPerIn:1.25 },
        { key:'steel', name:'Steel (approx., see note)', rPerIn:0.003 }, // simplification for parallel-path
        { key:'air_gap_0p75', name:'Air space (approx. 3/4")', rPerIn:1.00 }, // simplified average
        { key:'custom', name:'Custom…', rPerIn:0 }
      ];

      const unitRadios = document.querySelectorAll('input[name="units"]');
      const layersContainer = document.getElementById('layers');
      const addLayerBtn = document.getElementById('addLayerBtn');
      const includeInteriorFilm = document.getElementById('includeInteriorFilm');
      const includeExteriorFilm = document.getElementById('includeExteriorFilm');

      // Framing
      const toggleFramingBtn = document.getElementById('toggleFraming');
      const framingPanel = document.getElementById('framingPanel');
      const framingFactorInput = document.getElementById('framingFactor');
      const cavityDepthInput = document.getElementById('cavityDepth');
      const cavityUnit = document.getElementById('cavityUnit');
      const cavityInsulationSelect = document.getElementById('cavityInsulation');
      const studMaterialSelect = document.getElementById('studMaterial');

      // Tooltips
      document.querySelectorAll('.help-btn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('aria-controls');
          const tip = document.getElementById(id);
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          if(tip){ tip.dataset.open = String(!expanded); }
        });
      });

      // Collapse framing
      toggleFramingBtn.addEventListener('click', ()=>{
        const isOpen = toggleFramingBtn.getAttribute('aria-expanded') === 'true';
        toggleFramingBtn.setAttribute('aria-expanded', String(!isOpen));
        toggleFramingBtn.textContent = isOpen ? 'Show' : 'Hide';
        framingPanel.setAttribute('aria-hidden', String(isOpen));
        updateResults();
      });

      // Populate selects for framing
      function populateSelect(select, includeCustom=false){
        select.innerHTML = '';
        MATERIALS.forEach(m=>{
          if(!includeCustom && m.key==='custom') return;
          const opt = document.createElement('option');
          opt.value = m.key;
          opt.textContent = m.name;
          select.appendChild(opt);
        });
      }
      populateSelect(cavityInsulationSelect);
      populateSelect(studMaterialSelect);

      // Layer model
      let layerIdCounter = 0;
      const state = {
        units: 'R',
        layers: []
      };

      function createLayerRow(preset){
        const rowId = ++layerIdCounter;
        const row = document.createElement('div');
        row.className = 'layer-row card';
        row.setAttribute('data-row-id', String(rowId));

        // Material select
        const matWrap = document.createElement('div');
        const matLabel = document.createElement('label');
        matLabel.htmlFor = `material-${rowId}`;
        matLabel.textContent = 'Material';
        const matSelect = document.createElement('select');
        matSelect.id = `material-${rowId}`;
        matSelect.className = 'form-control';
        matSelect.setAttribute('aria-describedby', `materialErr-${rowId}`);
        MATERIALS.forEach(m=>{
          const opt = document.createElement('option');
          opt.value = m.key; opt.textContent = m.name;
          matSelect.appendChild(opt);
        });
        const matErr = document.createElement('div');
        matErr.id = `materialErr-${rowId}`;
        matErr.className = 'error-message';
        matErr.setAttribute('role','alert');
        matErr.setAttribute('aria-live','polite');
        matWrap.append(matLabel, matSelect, matErr);

        // Thickness
        const thickWrap = document.createElement('div');
        const thickLabel = document.createElement('label');
        thickLabel.htmlFor = `thickness-${rowId}`;
        thickLabel.className = 'required';
        thickLabel.textContent = 'Thickness';
        const thickGroup = document.createElement('div');
        thickGroup.className = 'input-group';
        const thickInput = document.createElement('input');
        thickInput.id = `thickness-${rowId}`;
        thickInput.className = 'form-control';
        thickInput.type = 'number';
        thickInput.inputMode = 'decimal';
        thickInput.step = '0.1';
        thickInput.min = '0';
        thickInput.placeholder = state.units === 'R' ? 'e.g., 1.0' : 'e.g., 25';
        thickInput.setAttribute('aria-required','true');
        thickInput.setAttribute('aria-describedby', `thickErr-${rowId}`);
        const thickUnit = document.createElement('span');
        thickUnit.className = 'input-suffix';
        thickUnit.textContent = state.units === 'R' ? 'in' : 'mm';
        thickGroup.append(thickInput, thickUnit);
        const thickErr = document.createElement('div');
        thickErr.id = `thickErr-${rowId}`;
        thickErr.className = 'error-message';
        thickErr.setAttribute('role','alert');
        thickErr.setAttribute('aria-live','polite');
        thickWrap.append(thickLabel, thickGroup, thickErr);

        // Custom R/in
        const customWrap = document.createElement('div');
        const customLabel = document.createElement('label');
        customLabel.htmlFor = `customR-${rowId}`;
        customLabel.textContent = 'Custom R per inch';
        const customGroup = document.createElement('div');
        customGroup.className = 'input-group';
        const customInput = document.createElement('input');
        customInput.id = `customR-${rowId}`;
        customInput.className = 'form-control';
        customInput.type = 'number';
        customInput.inputMode = 'decimal';
        customInput.step = '0.01';
        customInput.min = '0';
        customInput.placeholder = 'e.g., 4.50';
        customInput.setAttribute('aria-describedby', `customErr-${rowId} customHelp-${rowId}`);
        const customSuffix = document.createElement('span');
        customSuffix.className = 'input-suffix';
        customSuffix.textContent = 'R/in';
        customGroup.append(customInput, customSuffix);
        const customErr = document.createElement('div');
        customErr.id = `customErr-${rowId}`;
        customErr.className = 'error-message';
        customErr.setAttribute('role','alert');
        customErr.setAttribute('aria-live','polite');
        const customHelp = document.createElement('div');
        customHelp.id = `customHelp-${rowId}`;
        customHelp.className = 'tooltip';
        customHelp.dataset.open = 'true';
        customHelp.textContent = 'When Material is “Custom…”, enter an Imperial R per inch; the calculator converts to RSI automatically.';
        customWrap.append(customLabel, customGroup, customErr, customHelp);
        customWrap.hidden = true;

        // Remove button
        const actions = document.createElement('div');
        actions.className = 'layer-actions';
        const remBtn = document.createElement('button');
        remBtn.className = 'remove-layer';
        remBtn.type = 'button';
        remBtn.setAttribute('aria-label', 'Remove layer');
        remBtn.textContent = 'Remove';
        actions.append(remBtn);

        row.append(matWrap, thickWrap, customWrap, actions);
        layersContainer.appendChild(row);

        const layerData = {
          id: rowId,
          material: preset?.material || 'fiberglass_batt',
          thickness: preset?.thickness ?? '',
          customRPerIn: preset?.customRPerIn ?? ''
        };
        state.layers.push(layerData);

        // Initialize values
        matSelect.value = layerData.material;
        thickInput.value = layerData.thickness;
        customInput.value = layerData.customRPerIn;
        toggleCustomVisibility();

        // Events
        matSelect.addEventListener('change', ()=>{
          layerData.material = matSelect.value;
          toggleCustomVisibility();
          validateRow();
          updateResults();
        });
        thickInput.addEventListener('input', ()=>{
          layerData.thickness = thickInput.value;
          updateResults();
        });
        thickInput.addEventListener('blur', ()=> validateRow());
        customInput.addEventListener('input', ()=>{
          layerData.customRPerIn = customInput.value;
          updateResults();
        });
        customInput.addEventListener('blur', ()=> validateRow());
        remBtn.addEventListener('click', ()=>{
          state.layers = state.layers.filter(l=>l.id!==rowId);
          row.remove();
          updateResults();
        });

        function toggleCustomVisibility(){
          const isCustom = matSelect.value === 'custom';
          customWrap.hidden = !isCustom;
        }

        function validateRow(){
          // Thickness
          const t = parseFloat(thickInput.value);
          let thickMsg = '';
          if(isNaN(t) || t <= 0){
            thickMsg = 'Enter a thickness greater than 0.';
          } else if (t > (state.units==='R'? 48 : 1200)){
            thickMsg = 'Thickness seems unusually large. Please confirm.';
          }
          thickErr.textContent = thickMsg;
          thickInput.setAttribute('aria-invalid', thickMsg ? 'true' : 'false');

          // Custom
          if(matSelect.value === 'custom'){
            const c = parseFloat(customInput.value);
            let customMsg = '';
            if(isNaN(c) || c <= 0){
              customMsg = 'Enter a positive R per inch for the custom material.';
            } else if (c > 12){
              customMsg = 'Value is high; verify the product specification.';
            }
            customErr.textContent = customMsg;
            customInput.setAttribute('aria-invalid', customMsg ? 'true' : 'false');
          } else {
            customErr.textContent = '';
            customInput.setAttribute('aria-invalid','false');
          }
        }

        return row;
      }

      // Initialize with two common layers
      createLayerRow({ material:'gypsum', thickness:0.5 });
      createLayerRow({ material:'fiberglass_batt', thickness:3.5 });
      createLayerRow({ material:'xps', thickness:1 });

      addLayerBtn.addEventListener('click', ()=>{
        createLayerRow();
      });

      // Units switching
      unitRadios.forEach(r=>{
        r.addEventListener('change', ()=>{
          if(!r.checked) return;
          state.units = r.value;
          // Update UI labels
          document.querySelectorAll('[id^="thickness-"]').forEach((input)=>{
            const suff = input.parentElement.querySelector('.input-suffix');
            if(suff){ suff.textContent = state.units === 'R' ? 'in' : 'mm'; }
            input.placeholder = state.units === 'R' ? 'e.g., 1.0' : 'e.g., 25';
          });
          cavityUnit.textContent = state.units === 'R' ? 'in' : 'mm';
          updateResults();
        });
      });

      // Framing events
      framingFactorInput.addEventListener('input', ()=>{ validateFraming(); updateResults(); });
      framingFactorInput.addEventListener('blur', validateFraming);
      cavityDepthInput.addEventListener('input', ()=>{ validateFraming(); updateResults(); });
      cavityDepthInput.addEventListener('blur', validateFraming);
      cavityInsulationSelect.addEventListener('change', updateResults);
      studMaterialSelect.addEventListener('change', updateResults);

      function validateFraming(){
        const ffEl = document.getElementById('framingFactorError');
        const cdEl = document.getElementById('cavityDepthError');

        const f = parseFloat(framingFactorInput.value);
        let ffMsg = '';
        if(isNaN(f) || f < 0) ffMsg = 'Enter a value ≥ 0.';
        else if (f > 80) ffMsg = 'Value too high for typical framing; please verify.';
        framingFactorInput.setAttribute('aria-invalid', ffMsg ? 'true' : 'false');
        ffEl.textContent = ffMsg;

        const d = parseFloat(cavityDepthInput.value);
        let cdMsg = '';
        if(isNaN(d) || d <= 0) cdMsg = 'Enter a depth greater than 0.';
        else if (d > (state.units==='R' ? 24 : 600)) cdMsg = 'Depth looks very large; please verify.';
        cavityDepthInput.setAttribute('aria-invalid', cdMsg ? 'true' : 'false');
        cdEl.textContent = cdMsg;
      }

      // Results elements
      const totalRDisplay = document.getElementById('totalRDisplay');
      const uNoFrameDisplay = document.getElementById('uNoFrameDisplay');
      const effectiveRRow = document.getElementById('effectiveRRow');
      const effectiveURow = document.getElementById('effectiveURow');
      const effectiveRDisplay = document.getElementById('effectiveRDisplay');
      const effectiveUDisplay = document.getElementById('effectiveUDisplay');

      // Constants
      const R_PER_RSI = 5.678263; // R = RSI * 5.678263

      function toRSI(R){ return R / R_PER_RSI; }
      function toR(RSI){ return RSI * R_PER_RSI; }

      function rPerInFor(key, customRPerIn){
        if(key === 'custom') return parseFloat(customRPerIn) || 0;
        const m = MATERIALS.find(m=>m.key===key);
        return m ? m.rPerIn : 0;
      }

      function layerR_imperial(layer){
        const rpi = rPerInFor(layer.material, layer.customRPerIn);
        const th = parseFloat(layer.thickness);
        if(isNaN(th) || th <= 0 || rpi <= 0) return 0;
        // thickness input: if units are metric, convert mm to inches
        let thicknessInches = th;
        if(state.units === 'RSI'){
          thicknessInches = th / 25.4;
        }
        return rpi * thicknessInches; // R
      }

      function filmsR_imperial(){
        // ISO 6946: Rsi = 0.13 m²K/W, Rse = 0.04 m²K/W
        const Rsi_R = toR(0.13);
        const Rse_R = toR(0.04);
        let sum = 0;
        if(includeInteriorFilm.checked) sum += Rsi_R;
        if(includeExteriorFilm.checked) sum += Rse_R;
        return sum;
      }

      function totalSeriesR_imperial(){
        const layersR = state.layers.reduce((acc, l)=> acc + layerR_imperial(l), 0);
        return layersR + filmsR_imperial();
      }

      function computeFramingEffectiveR_imperial(R_series){
        // Only if framing section is open (expanded)
        const framingEnabled = toggleFramingBtn.getAttribute('aria-expanded') === 'true';
        if(!framingEnabled) return null;

        // Validate
        const f_pct = parseFloat(framingFactorInput.value);
        const depth = parseFloat(cavityDepthInput.value);
        if(isNaN(f_pct) || f_pct < 0 || isNaN(depth) || depth <= 0) return null;

        const f = Math.min(Math.max(f_pct/100, 0), 0.8);

        // Compute the portion of R_series that is cavity insulation to replace per path.
        // Approach: Rebuild paths replacing ONLY the cavity layer with either insulation or stud material.
        // We need cavity resistance for insulation path:
        const cavKey = cavityInsulationSelect.value;
        const studKey = studMaterialSelect.value;

        let depthIn = depth;
        if(state.units === 'RSI') depthIn = depth / 25.4;

        const R_cavity_only = rPerInFor(cavKey, 0) * depthIn; // R of cavity insulation
        const R_stud_only = rPerInFor(studKey, 0) * depthIn;  // R of stud path for the cavity depth

        // Remove any previously counted cavity layer? Our series R already includes a batt layer possibly.
        // To avoid dependency on user layers, follow ISO 6946 simplification:
        // Treat "series R minus films" as continuous layers. Then add cavity-specific R for each path.
        const R_continuous_no_cavity = (R_series - filmsR_imperial()); // includes all user layers
        // Now create two paths adding films + continuous + path-specific cavity
        const R_path_cavity = R_continuous_no_cavity + R_cavity_only + filmsR_imperial();
        const R_path_stud   = R_continuous_no_cavity + R_stud_only + filmsR_imperial();

        // Convert to U and area-weighted
        const U_cavity = R_path_cavity > 0 ? 1 / R_path_cavity : 0;
        const U_stud   = R_path_stud > 0 ? 1 / R_path_stud : 0;
        const U_eff = f * U_stud + (1 - f) * U_cavity;
        if(U_eff <= 0) return null;
        return 1 / U_eff;
      }

      function formatNumber(x, digits){
        return Number(x).toLocaleString(undefined, { maximumFractionDigits: digits, minimumFractionDigits: digits });
      }

      function updateResults(){
        const R_series = totalSeriesR_imperial(); // in R
        // Display according to selected units
        if(state.units === 'R'){
          totalRDisplay.textContent = `R ${formatNumber(R_series, 2)}`;
          const U_nf = R_series > 0 ? (1 / R_series) : 0;
          uNoFrameDisplay.textContent = `BTU/(h·ft²·°F) ${formatNumber(U_nf, 3)}`;
        } else {
          const RSI = toRSI(R_series);
          totalRDisplay.textContent = `RSI ${formatNumber(RSI, 3)}`;
          const U_nf = RSI > 0 ? (1 / RSI) : 0;
          uNoFrameDisplay.textContent = `W/m²·K ${formatNumber(U_nf, 3)}`;
        }

        const R_eff = computeFramingEffectiveR_imperial(R_series);
        if(R_eff && isFinite(R_eff)){
          effectiveRRow.hidden = false;
          effectiveURow.hidden = false;
          if(state.units === 'R'){
            effectiveRDisplay.textContent = `R ${formatNumber(R_eff, 2)}`;
            effectiveUDisplay.textContent = `BTU/(h·ft²·°F) ${formatNumber(1/R_eff, 3)}`;
          } else {
            const RSI_eff = toRSI(R_eff);
            effectiveRDisplay.textContent = `RSI ${formatNumber(RSI_eff, 3)}`;
            effectiveUDisplay.textContent = `W/m²·K ${formatNumber(1/RSI_eff, 3)}`;
          }
        } else {
          effectiveRRow.hidden = true;
          effectiveURow.hidden = true;
        }
      }

      // Initialize results
      updateResults();

      // Update on film toggles
      includeInteriorFilm.addEventListener('change', updateResults);
      includeExteriorFilm.addEventListener('change', updateResults);

      // Accessibility: ensure all interactive elements are keyboard reachable (already buttons/inputs)
      // Debounce helper (lightweight)
      function debounce(fn, delay=80){
        let t; return (...args)=>{ clearTimeout(t); t = setTimeout(()=>fn.apply(null,args), delay); };
      }

      // Recompute on window resize in case of layout changes to prevent CLS via min-heights
      window.addEventListener('resize', debounce(updateResults, 150));
    })();
  </script><script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script defer="">
    (function(){
      'use strict';

      // Materials dataset (typical R per inch, Imperial). References: ASHRAE, common manufacturer data.
      const MATERIALS = [
        { key:'fiberglass_batt', name:'Fiberglass batt', rPerIn:3.2 },
        { key:'cellulose', name:'Cellulose (loose/blown)', rPerIn:3.7 },
        { key:'mineral_wool', name:'Mineral wool (rock wool)', rPerIn:4.2 },
        { key:'eps', name:'EPS foam', rPerIn:4.0 },
        { key:'xps', name:'XPS foam', rPerIn:5.0 },
        { key:'polyiso', name:'Polyisocyanurate (polyiso)', rPerIn:6.0 },
        { key:'spray_foam_cc', name:'Spray foam (closed-cell)', rPerIn:6.5 },
        { key:'spray_foam_oc', name:'Spray foam (open-cell)', rPerIn:3.7 },
        { key:'gypsum', name:'Gypsum board (drywall)', rPerIn:0.45 },
        { key:'osb', name:'OSB', rPerIn:0.90 },
        { key:'plywood', name:'Plywood', rPerIn:1.25 },
        { key:'brick', name:'Brick (solid clay)', rPerIn:0.20 },
        { key:'concrete', name:'Concrete (dense)', rPerIn:0.08 },
        { key:'wood_soft', name:'Wood (softwood, studs)', rPerIn:1.25 },
        { key:'steel', name:'Steel (approx., see note)', rPerIn:0.003 }, // simplification for parallel-path
        { key:'air_gap_0p75', name:'Air space (approx. 3/4")', rPerIn:1.00 }, // simplified average
        { key:'custom', name:'Custom…', rPerIn:0 }
      ];

      const unitRadios = document.querySelectorAll('input[name="units"]');
      const layersContainer = document.getElementById('layers');
      const addLayerBtn = document.getElementById('addLayerBtn');
      const includeInteriorFilm = document.getElementById('includeInteriorFilm');
      const includeExteriorFilm = document.getElementById('includeExteriorFilm');

      // Framing
      const toggleFramingBtn = document.getElementById('toggleFraming');
      const framingPanel = document.getElementById('framingPanel');
      const framingFactorInput = document.getElementById('framingFactor');
      const cavityDepthInput = document.getElementById('cavityDepth');
      const cavityUnit = document.getElementById('cavityUnit');
      const cavityInsulationSelect = document.getElementById('cavityInsulation');
      const studMaterialSelect = document.getElementById('studMaterial');

      // Tooltips
      document.querySelectorAll('.help-btn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('aria-controls');
          const tip = document.getElementById(id);
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          if(tip){ tip.dataset.open = String(!expanded); }
        });
      });

      // Collapse framing
      toggleFramingBtn.addEventListener('click', ()=>{
        const isOpen = toggleFramingBtn.getAttribute('aria-expanded') === 'true';
        toggleFramingBtn.setAttribute('aria-expanded', String(!isOpen));
        toggleFramingBtn.textContent = isOpen ? 'Show' : 'Hide';
        framingPanel.setAttribute('aria-hidden', String(isOpen));
        updateResults();
      });

      // Populate selects for framing
      function populateSelect(select, includeCustom=false){
        select.innerHTML = '';
        MATERIALS.forEach(m=>{
          if(!includeCustom && m.key==='custom') return;
          const opt = document.createElement('option');
          opt.value = m.key;
          opt.textContent = m.name;
          select.appendChild(opt);
        });
      }
      populateSelect(cavityInsulationSelect);
      populateSelect(studMaterialSelect);

      // Layer model
      let layerIdCounter = 0;
      const state = {
        units: 'R',
        layers: []
      };

      function createLayerRow(preset){
        const rowId = ++layerIdCounter;
        const row = document.createElement('div');
        row.className = 'layer-row card';
        row.setAttribute('data-row-id', String(rowId));

        // Material select
        const matWrap = document.createElement('div');
        const matLabel = document.createElement('label');
        matLabel.htmlFor = `material-${rowId}`;
        matLabel.textContent = 'Material';
        const matSelect = document.createElement('select');
        matSelect.id = `material-${rowId}`;
        matSelect.className = 'form-control';
        matSelect.setAttribute('aria-describedby', `materialErr-${rowId}`);
        MATERIALS.forEach(m=>{
          const opt = document.createElement('option');
          opt.value = m.key; opt.textContent = m.name;
          matSelect.appendChild(opt);
        });
        const matErr = document.createElement('div');
        matErr.id = `materialErr-${rowId}`;
        matErr.className = 'error-message';
        matErr.setAttribute('role','alert');
        matErr.setAttribute('aria-live','polite');
        matWrap.append(matLabel, matSelect, matErr);

        // Thickness
        const thickWrap = document.createElement('div');
        const thickLabel = document.createElement('label');
        thickLabel.htmlFor = `thickness-${rowId}`;
        thickLabel.className = 'required';
        thickLabel.textContent = 'Thickness';
        const thickGroup = document.createElement('div');
        thickGroup.className = 'input-group';
        const thickInput = document.createElement('input');
        thickInput.id = `thickness-${rowId}`;
        thickInput.className = 'form-control';
        thickInput.type = 'number';
        thickInput.inputMode = 'decimal';
        thickInput.step = '0.1';
        thickInput.min = '0';
        thickInput.placeholder = state.units === 'R' ? 'e.g., 1.0' : 'e.g., 25';
        thickInput.setAttribute('aria-required','true');
        thickInput.setAttribute('aria-describedby', `thickErr-${rowId}`);
        const thickUnit = document.createElement('span');
        thickUnit.className = 'input-suffix';
        thickUnit.textContent = state.units === 'R' ? 'in' : 'mm';
        thickGroup.append(thickInput, thickUnit);
        const thickErr = document.createElement('div');
        thickErr.id = `thickErr-${rowId}`;
        thickErr.className = 'error-message';
        thickErr.setAttribute('role','alert');
        thickErr.setAttribute('aria-live','polite');
        thickWrap.append(thickLabel, thickGroup, thickErr);

        // Custom R/in
        const customWrap = document.createElement('div');
        const customLabel = document.createElement('label');
        customLabel.htmlFor = `customR-${rowId}`;
        customLabel.textContent = 'Custom R per inch';
        const customGroup = document.createElement('div');
        customGroup.className = 'input-group';
        const customInput = document.createElement('input');
        customInput.id = `customR-${rowId}`;
        customInput.className = 'form-control';
        customInput.type = 'number';
        customInput.inputMode = 'decimal';
        customInput.step = '0.01';
        customInput.min = '0';
        customInput.placeholder = 'e.g., 4.50';
        customInput.setAttribute('aria-describedby', `customErr-${rowId} customHelp-${rowId}`);
        const customSuffix = document.createElement('span');
        customSuffix.className = 'input-suffix';
        customSuffix.textContent = 'R/in';
        customGroup.append(customInput, customSuffix);
        const customErr = document.createElement('div');
        customErr.id = `customErr-${rowId}`;
        customErr.className = 'error-message';
        customErr.setAttribute('role','alert');
        customErr.setAttribute('aria-live','polite');
        const customHelp = document.createElement('div');
        customHelp.id = `customHelp-${rowId}`;
        customHelp.className = 'tooltip';
        customHelp.dataset.open = 'true';
        customHelp.textContent = 'When Material is “Custom…”, enter an Imperial R per inch; the calculator converts to RSI automatically.';
        customWrap.append(customLabel, customGroup, customErr, customHelp);
        customWrap.hidden = true;

        // Remove button
        const actions = document.createElement('div');
        actions.className = 'layer-actions';
        const remBtn = document.createElement('button');
        remBtn.className = 'remove-layer';
        remBtn.type = 'button';
        remBtn.setAttribute('aria-label', 'Remove layer');
        remBtn.textContent = 'Remove';
        actions.append(remBtn);

        row.append(matWrap, thickWrap, customWrap, actions);
        layersContainer.appendChild(row);

        const layerData = {
          id: rowId,
          material: preset?.material || 'fiberglass_batt',
          thickness: preset?.thickness ?? '',
          customRPerIn: preset?.customRPerIn ?? ''
        };
        state.layers.push(layerData);

        // Initialize values
        matSelect.value = layerData.material;
        thickInput.value = layerData.thickness;
        customInput.value = layerData.customRPerIn;
        toggleCustomVisibility();

        // Events
        matSelect.addEventListener('change', ()=>{
          layerData.material = matSelect.value;
          toggleCustomVisibility();
          validateRow();
          updateResults();
        });
        thickInput.addEventListener('input', ()=>{
          layerData.thickness = thickInput.value;
          updateResults();
        });
        thickInput.addEventListener('blur', ()=> validateRow());
        customInput.addEventListener('input', ()=>{
          layerData.customRPerIn = customInput.value;
          updateResults();
        });
        customInput.addEventListener('blur', ()=> validateRow());
        remBtn.addEventListener('click', ()=>{
          state.layers = state.layers.filter(l=>l.id!==rowId);
          row.remove();
          updateResults();
        });

        function toggleCustomVisibility(){
          const isCustom = matSelect.value === 'custom';
          customWrap.hidden = !isCustom;
        }

        function validateRow(){
          // Thickness
          const t = parseFloat(thickInput.value);
          let thickMsg = '';
          if(isNaN(t) || t <= 0){
            thickMsg = 'Enter a thickness greater than 0.';
          } else if (t > (state.units==='R'? 48 : 1200)){
            thickMsg = 'Thickness seems unusually large. Please confirm.';
          }
          thickErr.textContent = thickMsg;
          thickInput.setAttribute('aria-invalid', thickMsg ? 'true' : 'false');

          // Custom
          if(matSelect.value === 'custom'){
            const c = parseFloat(customInput.value);
            let customMsg = '';
            if(isNaN(c) || c <= 0){
              customMsg = 'Enter a positive R per inch for the custom material.';
            } else if (c > 12){
              customMsg = 'Value is high; verify the product specification.';
            }
            customErr.textContent = customMsg;
            customInput.setAttribute('aria-invalid', customMsg ? 'true' : 'false');
          } else {
            customErr.textContent = '';
            customInput.setAttribute('aria-invalid','false');
          }
        }

        return row;
      }

      // Initialize with two common layers
      createLayerRow({ material:'gypsum', thickness:0.5 });
      createLayerRow({ material:'fiberglass_batt', thickness:3.5 });
      createLayerRow({ material:'xps', thickness:1 });

      addLayerBtn.addEventListener('click', ()=>{
        createLayerRow();
      });

      // Units switching
      unitRadios.forEach(r=>{
        r.addEventListener('change', ()=>{
          if(!r.checked) return;
          state.units = r.value;
          // Update UI labels
          document.querySelectorAll('[id^="thickness-"]').forEach((input)=>{
            const suff = input.parentElement.querySelector('.input-suffix');
            if(suff){ suff.textContent = state.units === 'R' ? 'in' : 'mm'; }
            input.placeholder = state.units === 'R' ? 'e.g., 1.0' : 'e.g., 25';
          });
          cavityUnit.textContent = state.units === 'R' ? 'in' : 'mm';
          updateResults();
        });
      });

      // Framing events
      framingFactorInput.addEventListener('input', ()=>{ validateFraming(); updateResults(); });
      framingFactorInput.addEventListener('blur', validateFraming);
      cavityDepthInput.addEventListener('input', ()=>{ validateFraming(); updateResults(); });
      cavityDepthInput.addEventListener('blur', validateFraming);
      cavityInsulationSelect.addEventListener('change', updateResults);
      studMaterialSelect.addEventListener('change', updateResults);

      function validateFraming(){
        const ffEl = document.getElementById('framingFactorError');
        const cdEl = document.getElementById('cavityDepthError');

        const f = parseFloat(framingFactorInput.value);
        let ffMsg = '';
        if(isNaN(f) || f < 0) ffMsg = 'Enter a value ≥ 0.';
        else if (f > 80) ffMsg = 'Value too high for typical framing; please verify.';
        framingFactorInput.setAttribute('aria-invalid', ffMsg ? 'true' : 'false');
        ffEl.textContent = ffMsg;

        const d = parseFloat(cavityDepthInput.value);
        let cdMsg = '';
        if(isNaN(d) || d <= 0) cdMsg = 'Enter a depth greater than 0.';
        else if (d > (state.units==='R' ? 24 : 600)) cdMsg = 'Depth looks very large; please verify.';
        cavityDepthInput.setAttribute('aria-invalid', cdMsg ? 'true' : 'false');
        cdEl.textContent = cdMsg;
      }

      // Results elements
      const totalRDisplay = document.getElementById('totalRDisplay');
      const uNoFrameDisplay = document.getElementById('uNoFrameDisplay');
      const effectiveRRow = document.getElementById('effectiveRRow');
      const effectiveURow = document.getElementById('effectiveURow');
      const effectiveRDisplay = document.getElementById('effectiveRDisplay');
      const effectiveUDisplay = document.getElementById('effectiveUDisplay');

      // Constants
      const R_PER_RSI = 5.678263; // R = RSI * 5.678263

      function toRSI(R){ return R / R_PER_RSI; }
      function toR(RSI){ return RSI * R_PER_RSI; }

      function rPerInFor(key, customRPerIn){
        if(key === 'custom') return parseFloat(customRPerIn) || 0;
        const m = MATERIALS.find(m=>m.key===key);
        return m ? m.rPerIn : 0;
      }

      function layerR_imperial(layer){
        const rpi = rPerInFor(layer.material, layer.customRPerIn);
        const th = parseFloat(layer.thickness);
        if(isNaN(th) || th <= 0 || rpi <= 0) return 0;
        // thickness input: if units are metric, convert mm to inches
        let thicknessInches = th;
        if(state.units === 'RSI'){
          thicknessInches = th / 25.4;
        }
        return rpi * thicknessInches; // R
      }

      function filmsR_imperial(){
        // ISO 6946: Rsi = 0.13 m²K/W, Rse = 0.04 m²K/W
        const Rsi_R = toR(0.13);
        const Rse_R = toR(0.04);
        let sum = 0;
        if(includeInteriorFilm.checked) sum += Rsi_R;
        if(includeExteriorFilm.checked) sum += Rse_R;
        return sum;
      }

      function totalSeriesR_imperial(){
        const layersR = state.layers.reduce((acc, l)=> acc + layerR_imperial(l), 0);
        return layersR + filmsR_imperial();
      }

      function computeFramingEffectiveR_imperial(R_series){
        // Only if framing section is open (expanded)
        const framingEnabled = toggleFramingBtn.getAttribute('aria-expanded') === 'true';
        if(!framingEnabled) return null;

        // Validate
        const f_pct = parseFloat(framingFactorInput.value);
        const depth = parseFloat(cavityDepthInput.value);
        if(isNaN(f_pct) || f_pct < 0 || isNaN(depth) || depth <= 0) return null;

        const f = Math.min(Math.max(f_pct/100, 0), 0.8);

        // Compute the portion of R_series that is cavity insulation to replace per path.
        // Approach: Rebuild paths replacing ONLY the cavity layer with either insulation or stud material.
        // We need cavity resistance for insulation path:
        const cavKey = cavityInsulationSelect.value;
        const studKey = studMaterialSelect.value;

        let depthIn = depth;
        if(state.units === 'RSI') depthIn = depth / 25.4;

        const R_cavity_only = rPerInFor(cavKey, 0) * depthIn; // R of cavity insulation
        const R_stud_only = rPerInFor(studKey, 0) * depthIn;  // R of stud path for the cavity depth

        // Remove any previously counted cavity layer? Our series R already includes a batt layer possibly.
        // To avoid dependency on user layers, follow ISO 6946 simplification:
        // Treat "series R minus films" as continuous layers. Then add cavity-specific R for each path.
        const R_continuous_no_cavity = (R_series - filmsR_imperial()); // includes all user layers
        // Now create two paths adding films + continuous + path-specific cavity
        const R_path_cavity = R_continuous_no_cavity + R_cavity_only + filmsR_imperial();
        const R_path_stud   = R_continuous_no_cavity + R_stud_only + filmsR_imperial();

        // Convert to U and area-weighted
        const U_cavity = R_path_cavity > 0 ? 1 / R_path_cavity : 0;
        const U_stud   = R_path_stud > 0 ? 1 / R_path_stud : 0;
        const U_eff = f * U_stud + (1 - f) * U_cavity;
        if(U_eff <= 0) return null;
        return 1 / U_eff;
      }

      function formatNumber(x, digits){
        return Number(x).toLocaleString(undefined, { maximumFractionDigits: digits, minimumFractionDigits: digits });
      }

      function updateResults(){
        const R_series = totalSeriesR_imperial(); // in R
        // Display according to selected units
        if(state.units === 'R'){
          totalRDisplay.textContent = `R ${formatNumber(R_series, 2)}`;
          const U_nf = R_series > 0 ? (1 / R_series) : 0;
          uNoFrameDisplay.textContent = `BTU/(h·ft²·°F) ${formatNumber(U_nf, 3)}`;
        } else {
          const RSI = toRSI(R_series);
          totalRDisplay.textContent = `RSI ${formatNumber(RSI, 3)}`;
          const U_nf = RSI > 0 ? (1 / RSI) : 0;
          uNoFrameDisplay.textContent = `W/m²·K ${formatNumber(U_nf, 3)}`;
        }

        const R_eff = computeFramingEffectiveR_imperial(R_series);
        if(R_eff && isFinite(R_eff)){
          effectiveRRow.hidden = false;
          effectiveURow.hidden = false;
          if(state.units === 'R'){
            effectiveRDisplay.textContent = `R ${formatNumber(R_eff, 2)}`;
            effectiveUDisplay.textContent = `BTU/(h·ft²·°F) ${formatNumber(1/R_eff, 3)}`;
          } else {
            const RSI_eff = toRSI(R_eff);
            effectiveRDisplay.textContent = `RSI ${formatNumber(RSI_eff, 3)}`;
            effectiveUDisplay.textContent = `W/m²·K ${formatNumber(1/RSI_eff, 3)}`;
          }
        } else {
          effectiveRRow.hidden = true;
          effectiveURow.hidden = true;
        }
      }

      // Initialize results
      updateResults();

      // Update on film toggles
      includeInteriorFilm.addEventListener('change', updateResults);
      includeExteriorFilm.addEventListener('change', updateResults);

      // Accessibility: ensure all interactive elements are keyboard reachable (already buttons/inputs)
      // Debounce helper (lightweight)
      function debounce(fn, delay=80){
        let t; return (...args)=>{ clearTimeout(t); t = setTimeout(()=>fn.apply(null,args), delay); };
      }

      // Recompute on window resize in case of layout changes to prevent CLS via min-heights
      window.addEventListener('resize', debounce(updateResults, 150));
    })();
  </script></body></html>
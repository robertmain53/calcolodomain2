<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="canonical" href="https://calcdomain.com/furniture-layout-calculator">
  <title>Furniture Layout Calculator - Check Space &amp; Clearance</title>
  <meta name="description" content="Calculate if your furniture fits. Enter room and furniture dimensions to check for adequate walkways, density, and usable space. Avoid cramped layouts.">
  <meta name="author" content="Ugo Candido">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="search.js" defer></script>
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#475569;
      --line:#e5e7eb;
      --primary:#2563eb;
      --primary2:#1d4ed8;
      --shadow:0 10px 25px rgba(2,6,23,.08);
      --radius:14px;
      --sans:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,"Apple Color Emoji","Segoe UI Emoji";
      --surface-subtle:#f8fafc;
      --danger:#b91c1c;
      --dangerBg:#fef2f2;
      --ok:#15803d;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:var(--bg);
      line-height:1.5;
    }
    a{ color:var(--primary); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .container{ max-width:1120px; margin:0 auto; padding:18px; }

    header{
      position:sticky; top:0; z-index:50;
      background:rgba(255,255,255,.92);
      backdrop-filter:blur(8px);
      border-bottom:1px solid var(--line);
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between; gap:14px;
      padding:12px 18px;
    }
    .brand{ font-weight:800; letter-spacing:.2px; font-size:20px; color:var(--text); }
    .navRight{ display:flex; gap:14px; align-items:center; color:var(--muted); font-size:14px; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid var(--line); background:#fff;
      padding:8px 10px; border-radius:999px; font-size:13px;
    }

    .calc-hero{
      display:grid;
      grid-template-columns:1.2fr 1fr;
      gap:24px;
      margin-top:24px;
      align-items:start;
    }
    @media (max-width:800px){ .calc-hero{ grid-template-columns:1fr; } }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:24px;
    }

    h1{ margin:0 0 8px; font-size:28px; line-height:1.2; }
    .sub{ margin:0 0 20px; color:var(--muted); font-size:15px; }

    .sectionTitle{
      font-weight:800; margin:0 0 12px;
      font-size:15px; text-transform:uppercase; letter-spacing:.5px; color:var(--muted);
    }

    .grid2{ display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px; }
    @media (max-width:500px){ .grid2{ grid-template-columns:1fr; } }

    label{ display:block; font-size:13px; font-weight:600; color:var(--muted); margin:0 0 6px; }
    input, select{
      width:100%;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:10px;
      background:#fff;
      font-size:15px;
      outline:none;
      transition:border-color .2s;
    }
    input:focus, select:focus{
      border-color:var(--primary);
      box-shadow:0 0 0 3px rgba(37,99,235,0.15);
    }

    .optional-box{
      background:var(--surface-subtle);
      border:1px solid var(--line);
      border-radius:10px;
      padding:16px;
      margin-bottom:16px;
    }

    .sticky-box{ position:sticky; top:90px; }

    .totalBox{
      text-align:center;
      padding-bottom:20px;
      border-bottom:1px solid var(--line);
      margin-bottom:16px;
    }
    .totalBox .t{ color:var(--muted); font-size:13px; font-weight:700; text-transform:uppercase; letter-spacing:.5px; }
    .totalBox .v{ font-size:32px; font-weight:900; margin-top:4px; color:var(--text); }

    .kpi{ display:flex; justify-content:space-between; margin-bottom:10px; font-size:14px; }
    .kpi span:first-child{ color:var(--muted); }
    .kpi span:last-child{ font-weight:700; color:var(--text); }

    .btn{
      display:block; width:100%;
      border:none; background:var(--primary); color:#fff;
      padding:12px; border-radius:10px;
      cursor:pointer; font-weight:700; font-size:15px;
      text-align:center; margin-top:10px;
    }
    .btn:hover{ background:var(--primary2); text-decoration:none; }
    .btnSecondary{ background:#fff; border:1px solid var(--line); color:var(--text); }
    .btnSecondary:hover{ background:#f8fafc; }
    .btn:disabled{ opacity:.6; cursor:not-allowed; }

    .alert{
      display:none;
      padding:12px;
      margin-bottom:20px;
      background:var(--dangerBg);
      border-left:4px solid var(--danger);
      color:#7f1d1d;
      border-radius:6px;
      font-size:14px;
    }

    .content-card{ margin-top:24px; }
    .content-card h2{ margin:0 0 10px; font-size:18px; }
    .content-card p{ margin:0 0 10px; color:var(--text); }
    .content-card ul{ margin:8px 0 0; padding-left:18px; }

    .meta-section{
      margin-top:40px;
      padding-top:20px;
      border-top:1px solid var(--line);
      font-size:13px;
      color:var(--muted);
    }
    .badge-row{ display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; }
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      border:1px solid var(--line); padding:4px 10px;
      border-radius:20px; background:#fff;
    }

    .content-card dl{ margin:0; }
    .content-card dd{ margin-left:0; }

    .furniture-item{
      border:1px solid var(--line);
      border-radius:10px;
      padding:12px;
      margin-bottom:12px;
      background:#fdfdfd;
    }
    .item-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:10px;
      font-weight:700;
      color:var(--text);
    }
    .item-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(160px, 1fr));
      gap:12px;
    }
    .item-field label{ font-weight:600; }
    .item-input{ font-size:14px; }
    .removeFurnitureBtn{
      border:none;
      background:#fef2f2;
      border:1px solid #fecaca;
      color:#b91c1c;
      border-radius:8px;
      padding:4px 8px;
      cursor:pointer;
      font-size:14px;
    }
    .removeFurnitureBtn:hover{ background:#fee2e2; }

    .recommendation-panel{
      border:1px dashed var(--line);
      border-radius:12px;
      padding:14px;
      margin-top:12px;
      background:#ffffff;
    }
    .recommendation-title{ font-size:16px; font-weight:700; margin-bottom:6px; }
    .recommendation-copy{ color:var(--muted); font-size:14px; line-height:1.5; }

    .chart-wrap{
      margin-top:18px;
      border-radius:16px;
      background:var(--surface-subtle);
      padding:18px;
    }
    .chart-wrap canvas{ width:100%; height:220px; }

    .full-guide-section h3{ margin-top:20px; font-size:16px; }
    .full-guide-section ul{ padding-left:18px; }
    .full-guide-section .ad-note{ margin-top:12px; padding:12px; background:#f8fafc; border:1px dashed var(--line); border-radius:10px; font-size:13px; color:var(--muted); }
  </style>
</head>
<body>
  <header id="siteHeader">
    <div class="nav container">
      <a class="brand" href="https://calcdomain.com">CalcDomain</a>
      <div class="navRight">
        <a class="pill" href="https://calcdomain.com/search">Advanced Search</a>
        <span class="pill">Categories</span>
      </div>
    </div>
  </header>

  <div class="container">
    <main style="margin:24px 0 40px;" id="mainContent">
      <h1 id="pageTitle">Furniture Layout Calculator - Check Space &amp; Clearance</h1>
      <p class="sub" id="pageSub">Calculate if your furniture fits. Enter room and furniture dimensions to check for adequate walkways, density, and usable space. Avoid cramped layouts.</p>

      <div id="errorBox" class="alert" role="alert" aria-live="polite"></div>

      <div class="calc-hero" id="calcHero">
        <section class="card" id="inputsCard" aria-label="Calculator inputs">
          <div class="sectionTitle">Room details</div>
          <div class="grid2">
            <div>
              <label for="roomLength">Room Length (ft)</label>
              <input id="roomLength" type="number" value="15" step="0.5" min="0" inputmode="decimal">
            </div>
            <div>
              <label for="roomWidth">Room Width (ft)</label>
              <input id="roomWidth" type="number" value="12" step="0.5" min="0" inputmode="decimal">
            </div>
          </div>
          <div>
            <label for="minClearance">Desired walkway clearance (inches)</label>
            <input id="minClearance" type="number" value="36" step="1" min="0" inputmode="decimal" placeholder="Optional" aria-describedby="clearanceHint">
            <p id="clearanceHint" class="sub" style="margin-top:4px;">Track preferred minimum walkway width to keep paths accessible.</p>
          </div>
          <div class="sectionTitle" style="margin-top:20px;">Furniture items</div>
          <div id="furnitureListContainer"></div>
          <button type="button" class="btn btnSecondary" id="addFurnitureBtn" style="margin-bottom:12px;">+ Add Furniture</button>
          <div data-canon-btnrow="1" style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
            <button class="btn" id="calcBtn" type="button">Calculate</button>
            <button class="btn btnSecondary" id="resetBtn" type="button">Reset</button>
          </div>
        </section>
        <section class="card sticky-box" id="resultsCard" aria-label="Calculator results">
          <div class="totalBox">
            <div class="t">Occupancy Summary</div>
            <div class="v" id="primaryResult">Awaiting inputs</div>
          </div>
          <div class="kpi">
            <span>Total room area</span>
            <span id="totalRoomArea">0 sq ft</span>
          </div>
          <div class="kpi">
            <span>Furniture footprint</span>
            <span id="totalFurnitureFootprint">0 sq ft</span>
          </div>
          <div class="kpi">
            <span>Occupancy ratio</span>
            <span id="occupancyRatio">0%</span>
          </div>
          <div class="kpi">
            <span>Remaining space</span>
            <span id="remainingSpace">0 sq ft</span>
          </div>
          <div class="recommendation-panel" id="recommendationPanel">
            <div class="recommendation-title" id="recommendationTitle">Enter dimensions to begin</div>
            <div class="recommendation-copy" id="recommendationCopy">Add furniture measurements to see whether your current layout feels comfortable, functional, or cramped.</div>
          </div>
          <div class="chart-wrap">
            <canvas id="resultsChart" role="img" aria-label="Furniture footprint versus remaining space"></canvas>
          </div>
        </section>
      </div>

      <section class="card content-card" id="howToUse" aria-label="How to use and methodology">
        <h2>How to use</h2>
        <p>Enter the room dimensions in feet and optionally note a desired walkway clearance in inches. Add each furniture item with length and width in inches to capture how much of the room the pieces occupy.</p>
        <p>The calculator instantly recomputes the total furniture footprint, occupancy ratio, and remaining usable space so you can fine-tune each item.</p>
        <h2>Methodology</h2>
        <p>We convert every furniture item to square feet and compare the combined footprint against the total room area. The occupancy ratio is the percentage of the room covered by furniture, and the remaining space indicates how much open area remains for circulation.</p>
        <ul>
          <li>Furniture area is computed via the length &times; width conversion from inches to feet.</li>
          <li>The occupancy ratio helps label layouts as comfortable (less than 30%), functional (30–40%), or cramped (above 40%).</li>
          <li>Remaining space highlights circulation room and helps spot overfilled plans.</li>
        </ul>
        <h2>Full original guide (expanded)</h2>
        <div class="full-guide-section">
          <p class="ad-note">Ad placeholder: space reserved for a 300×600 sponsorship.</p>
          <h3>Why Use This Calculator</h3>
          <ul>
            <li>Instantly check your room's density to see if it's overcrowded.</li>
            <li>Avoid buying large furniture that won't fit comfortably.</li>
            <li>Quantify your layout plans with a clear, data-driven occupancy ratio.</li>
            <li>Ensure your layout supports accessible and comfortable walkways.</li>
          </ul>
          <h3>Related Construction Tools</h3>
          <ul>
            <li><a href="https://calcdomain.com/paint-calculator">Paint Calculator</a></li>
            <li><a href="https://calcdomain.com/flooring-calculator">Flooring Calculator</a></li>
            <li>Room Area Calculator</li>
            <li><a href="https://calcdomain.com/drywall-calculator">Drywall Calculator</a></li>
          </ul>
        </div>
      </section>

      <section class="meta-section" id="pageMeta" aria-label="Verification, changelog, formulas, citations">
        <details id="formulaDetails">
          <summary style="cursor:pointer; font-weight:700; color:var(--text)">Formulas</summary>
          <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
            <p><strong>Room area:</strong> <code>A_room = Room Length (ft) × Room Width (ft)</code></p>
            <p><strong>Furniture footprint:</strong> <code>A_item = (Item Length (in)/12) × (Item Width (in)/12)</code></p>
            <p><strong>Occupancy ratio:</strong> <code>R_occupancy = (∑A_item / A_room) × 100%</code></p>
          </div>
        </details>

        <details id="citationDetails" style="margin-top:10px;">
          <summary style="cursor:pointer; font-weight:700; color:var(--text)">Citations</summary>
          <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
            <ul style="margin:0; padding-left:18px;">
              <li><strong>Home</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/" target="_blank" rel="noopener">https://calcdomain.com/</a></li>
              <li><strong>Construction</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/construction-diy" target="_blank" rel="noopener">https://calcdomain.com/construction-diy</a></li>
              <li><strong>Materials Estimation</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/construction-diy-materials-estimation" target="_blank" rel="noopener">https://calcdomain.com/subcategories/construction-diy-materials-estimation</a></li>
              <li><strong>Paint Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/paint-calculator" target="_blank" rel="noopener">https://calcdomain.com/paint-calculator</a></li>
              <li><strong>Flooring Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/flooring-calculator" target="_blank" rel="noopener">https://calcdomain.com/flooring-calculator</a></li>
              <li><strong>Drywall Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/drywall-calculator" target="_blank" rel="noopener">https://calcdomain.com/drywall-calculator</a></li>
            </ul>
          </div>
        </details>

        <details id="changelogDetails" style="margin-top:10px;">
          <summary style="cursor:pointer; font-weight:700; color:var(--text)">Changelog</summary>
          <div style="margin-top:12px; padding:12px; background:#fff; border:1px solid var(--line); border-radius:8px;">
            <ul style="margin:0; padding-left:18px;">
              <li>Version 0.1.0-draft — 2026-01-19: Initial draft (review required).</li>
            </ul>
          </div>
        </details>

        <div class="badge-row" id="badgeRow">
          <div class="badge" id="verifiedBadge"><span style="color:var(--ok); font-weight:800;">✓</span> Verified by Ugo Candido</div>
          <div class="badge" id="lastUpdatedBadge">Last Updated: 2026-01-19</div>
          <div class="badge" id="versionBadge">Version 0.1.0-draft</div>
        </div>
      </section>
    </main>
  </div>

  <footer id="siteFooter" class="bg-gray-900 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
          <p class="text-gray-400 mb-4">
            Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
          </p>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Categories</h4>
          <ul class="space-y-2">
            <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
            <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction &amp; DIY</a></li>
            <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
            <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
            <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
            <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health &amp; Fitness</a></li>
            <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle &amp; Everyday</a></li>
            <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
            <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math &amp; Conversions</a></li>
            <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
          <ul class="space-y-2">
            <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
            <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
            <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
            <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
            <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Support</h4>
          <ul class="space-y-2">
            <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
            <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
            <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
            <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
            <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
          </ul>
        </div>
      </div>
      <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
        <p>© 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
      </div>
    </div>
  </footer>

  <script>
    (function() {
      'use strict';

      const round2 = (value) => Math.round((value + Number.EPSILON) * 100) / 100;
      const fmtNumber = (value, decimals = 1) => {
        const safe = Number.isFinite(value) ? value : 0;
        return new Intl.NumberFormat('en-US', {
          maximumFractionDigits: decimals,
          minimumFractionDigits: decimals
        }).format(safe);
      };

      const debounce = (fn, delay = 100) => {
        let timer;
        return (...args) => {
          clearTimeout(timer);
          timer = setTimeout(() => fn(...args), delay);
        };
      };

      const els = {
        roomLength: document.getElementById('roomLength'),
        roomWidth: document.getElementById('roomWidth'),
        minClearance: document.getElementById('minClearance'),
        furnitureListContainer: document.getElementById('furnitureListContainer'),
        addFurnitureBtn: document.getElementById('addFurnitureBtn'),
        totalRoomArea: document.getElementById('totalRoomArea'),
        totalFurnitureFootprint: document.getElementById('totalFurnitureFootprint'),
        occupancyRatio: document.getElementById('occupancyRatio'),
        remainingSpace: document.getElementById('remainingSpace'),
        primaryResult: document.getElementById('primaryResult'),
        recommendationTitle: document.getElementById('recommendationTitle'),
        recommendationCopy: document.getElementById('recommendationCopy'),
        recommendationPanel: document.getElementById('recommendationPanel'),
        errorBox: document.getElementById('errorBox'),
        calcBtn: document.getElementById('calcBtn'),
        resetBtn: document.getElementById('resetBtn'),
        resultsChart: document.getElementById('resultsChart')
      };

      let chartInstance = null;
      const defaultValues = {
        roomLength: 15,
        roomWidth: 12,
        minClearance: 36
      };

      const recommendationStates = [
        {
          title: 'Awaiting inputs',
          copy: 'Add furniture dimensions to review how much of your room is occupied.',
          tone: 'neutral'
        },
        {
          title: 'Comfortable layout',
          copy: 'Less than 30% occupancy gives ample open space for walkways and movement.',
          tone: 'ok'
        },
        {
          title: 'Functional layout',
          copy: '30%–40% occupancy is workable but may feel busy. Watch circulation paths.',
          tone: 'warning'
        },
        {
          title: 'Cramped layout',
          copy: 'Above 40% occupancy often causes cramped paths. Consider removing or resizing items.',
          tone: 'danger'
        }
      ];

      function setDefaults() {
        els.roomLength.value = defaultValues.roomLength;
        els.roomWidth.value = defaultValues.roomWidth;
        els.minClearance.value = defaultValues.minClearance;
        els.furnitureListContainer.innerHTML = '';
        addFurnitureRow();
      }

      function addFurnitureRow(values = {}) {
        const row = document.createElement('div');
        row.className = 'furniture-item';
        row.innerHTML = `
          <div class="item-header">
            <span class="item-label">Item ${els.furnitureListContainer.children.length + 1}</span>
            <button type="button" class="removeFurnitureBtn" aria-label="Remove furniture item">Remove</button>
          </div>
          <div class="item-grid">
            <div class="item-field">
              <label>Name (optional)</label>
              <input type="text" class="item-input" value="${values.name || ''}" placeholder="e.g., Sofa">
            </div>
            <div class="item-field">
              <label>Length (in)</label>
              <input type="number" min="0" step="0.1" class="item-input item-length" value="${values.length || ''}" placeholder="e.g., 84">
            </div>
            <div class="item-field">
              <label>Width (in)</label>
              <input type="number" min="0" step="0.1" class="item-input item-width" value="${values.width || ''}" placeholder="e.g., 36">
            </div>
          </div>
        `;
        els.furnitureListContainer.appendChild(row);
        refreshFurnitureLabels();
        return row;
      }

      function refreshFurnitureLabels() {
        Array.from(els.furnitureListContainer.children).forEach((child, index) => {
          const label = child.querySelector('.item-label');
          if (label) label.textContent = `Item ${index + 1}`;
        });
      }

      function parseInputs() {
        const furnitureItems = Array.from(els.furnitureListContainer.querySelectorAll('.furniture-item')).map((item) => {
          const lengthEl = item.querySelector('.item-length');
          const widthEl = item.querySelector('.item-width');
          return {
            name: (item.querySelector('input[type="text"]') || {}).value || '',
            length: parseFloat(lengthEl ? lengthEl.value : '') || 0,
            width: parseFloat(widthEl ? widthEl.value : '') || 0
          };
        });

        return {
          roomLength: parseFloat(els.roomLength.value) || 0,
          roomWidth: parseFloat(els.roomWidth.value) || 0,
          minClearance: parseFloat(els.minClearance.value) || 0,
          furnitureItems
        };
      }

      function validate(inputs) {
        const errors = [];
        if (!Number.isFinite(inputs.roomLength) || inputs.roomLength <= 0) {
          errors.push('Room length must be greater than 0.');
        }
        if (!Number.isFinite(inputs.roomWidth) || inputs.roomWidth <= 0) {
          errors.push('Room width must be greater than 0.');
        }
        if (!Number.isFinite(inputs.minClearance) || inputs.minClearance < 0) {
          errors.push('Walkway clearance must be 0 or greater.');
        }
        inputs.furnitureItems.forEach((item, index) => {
          if (item.length < 0 || item.width < 0) {
            errors.push(`Furniture item ${index + 1} dimensions must be 0 or greater.`);
          }
        });
        return { ok: errors.length === 0, errors };
      }

      function compute(inputs) {
        const roomArea = inputs.roomLength * inputs.roomWidth;
        let totalFurnitureFootprint = 0;
        inputs.furnitureItems.forEach((item) => {
          if (item.length > 0 && item.width > 0) {
            const areaSqFt = (item.length / 12) * (item.width / 12);
            totalFurnitureFootprint += areaSqFt;
          }
        });
        const safeRoomArea = roomArea > 0 ? roomArea : 0;
        const occupancyRatio = safeRoomArea === 0 ? 0 : (totalFurnitureFootprint / safeRoomArea) * 100;
        const remainingSpace = Math.max(0, safeRoomArea - totalFurnitureFootprint);
        let recommendation = recommendationStates[0];
        if (occupancyRatio <= 0) {
          recommendation = recommendationStates[0];
        } else if (occupancyRatio < 30) {
          recommendation = recommendationStates[1];
        } else if (occupancyRatio <= 40) {
          recommendation = recommendationStates[2];
        } else {
          recommendation = recommendationStates[3];
        }
        return {
          roomArea: round2(safeRoomArea),
          furnitureFootprint: round2(totalFurnitureFootprint),
          occupancyRatio: round2(occupancyRatio),
          remainingSpace: round2(remainingSpace),
          recommendation
        };
      }

      function format(outputs) {
        return {
          roomArea: `${fmtNumber(outputs.roomArea, 1)} sq ft`,
          furnitureFootprint: `${fmtNumber(outputs.furnitureFootprint, 1)} sq ft`,
          occupancyRatio: `${fmtNumber(outputs.occupancyRatio, 1)}%`,
          remainingSpace: `${fmtNumber(outputs.remainingSpace, 1)} sq ft`,
          primary: outputs.occupancyRatio > 0 ? `${fmtNumber(outputs.occupancyRatio, 1)}% occupied` : 'Awaiting inputs'
        };
      }

      function render(formatted, outputs) {
        els.totalRoomArea.textContent = formatted.roomArea;
        els.totalFurnitureFootprint.textContent = formatted.furnitureFootprint;
        els.occupancyRatio.textContent = formatted.occupancyRatio;
        els.remainingSpace.textContent = formatted.remainingSpace;
        els.primaryResult.textContent = formatted.primary;
        els.recommendationTitle.textContent = outputs.recommendation.title;
        els.recommendationCopy.textContent = outputs.recommendation.copy;
        const tone = outputs.recommendation.tone;
        els.recommendationPanel.setAttribute('data-tone', tone);
        if (chartInstance) {
          chartInstance.data.datasets[0].data = [
            Math.max(0, outputs.furnitureFootprint),
            Math.max(0, outputs.remainingSpace)
          ];
          chartInstance.update();
        }
      }

      function renderError(errors) {
        if (!errors || errors.length === 0) {
          els.errorBox.style.display = 'none';
          els.errorBox.textContent = '';
          return;
        }
        els.errorBox.style.display = 'block';
        els.errorBox.textContent = errors.join(' ');
      }

      function initChart() {
        if (!els.resultsChart || typeof Chart === 'undefined') return;
        chartInstance = new Chart(els.resultsChart.getContext('2d'), {
          type: 'doughnut',
          data: {
            labels: ['Furniture footprint', 'Remaining space'],
            datasets: [{
              data: [1, 1],
              backgroundColor: ['#2563eb', '#e5e7eb'],
              borderWidth: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '68%',
            plugins: {
              legend: { display: false },
              tooltip: {
                callbacks: {
                  label: (context) => `${context.label}: ${fmtNumber(context.parsed, 1)} sq ft`
                }
              }
            }
          }
        });
      }

      function update() {
        const inputs = parseInputs();
        const validation = validate(inputs);
        if (!validation.ok) {
          renderError(validation.errors);
          return;
        }
        renderError([]);
        const outputs = compute(inputs);
        const formatted = format(outputs);
        render(formatted, outputs);
      }

      els.addFurnitureBtn.addEventListener('click', () => {
        addFurnitureRow();
        debouncedUpdate();
      });

      els.furnitureListContainer.addEventListener('input', (event) => {
        if (event.target.closest('.furniture-item')) {
          debouncedUpdate();
        }
      });

      els.furnitureListContainer.addEventListener('click', (event) => {
        const button = event.target.closest('.removeFurnitureBtn');
        if (!button) return;
        const row = button.closest('.furniture-item');
        if (!row) return;
        if (els.furnitureListContainer.children.length <= 1) {
          row.querySelectorAll('input').forEach((input) => (input.value = ''));
        } else {
          row.remove();
          refreshFurnitureLabels();
        }
        debouncedUpdate();
      });

      });

      });

      els.calcBtn.addEventListener('click', update);
      els.resetBtn.addEventListener('click', () => {
        setDefaults();
    const debouncedUpdate = debounce(update, 100);

    document.querySelectorAll('#inputsCard input, #inputsCard select, #inputsCard textarea')
      .forEach((el) => {
        el.addEventListener('input', debouncedUpdate);
        el.addEventListener('change', debouncedUpdate);
      });

        update();
      });

      initChart();
      setDefaults();
      update();
    })();
  </script>
</body></html>

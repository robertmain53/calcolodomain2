<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/2d-frame-analysis" />
    <title>2d Frame Analysis Calculator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate 2d Frame Analysis Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="2d Frame Analysis Calculator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate 2d Frame Analysis Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/2d-frame-analysis" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="2d Frame Analysis Calculator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate 2d Frame Analysis Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Engineering Calculators", "item": "https://calcdomain.com/categories/engineering"}, {"@type": "ListItem", "position": 3, "name": "Structural Engineering Calculators", "item": "https://calcdomain.com/subcategories/structural-engineering"}, {"@type": "ListItem", "position": 4, "name": "2D Frame Analysis Calculator", "item": "https://calcdomain.com/2d-frame-analysis"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/engineering" class="text-blue-600 hover:underline">Engineering Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/structural-engineering" class="text-blue-600 hover:underline">Structural Engineering Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">2D Frame Analysis Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h1 class="text-2xl md:text-3xl font-bold mb-2">
              2D Frame Analysis Calculator
            </h1>
            <p class="text-gray-600 mb-4">
              Build and solve 2D frames (beams + columns) with the matrix
              stiffness method. Define nodes, members, supports and loads, then
              view reactions, internal forces and deflections.
            </p>

            <div class="mb-6">
              <div class="flex flex-wrap gap-2 text-xs text-gray-500 mb-2">
                <span class="px-2 py-1 bg-blue-50 text-blue-700 rounded-full"
                  >Linear elastic</span
                >
                <span class="px-2 py-1 bg-blue-50 text-blue-700 rounded-full"
                  >Matrix stiffness</span
                >
                <span class="px-2 py-1 bg-blue-50 text-blue-700 rounded-full"
                  >Shear &amp; moment</span
                >
              </div>
            </div>

            <!-- Calculator UI -->
            <section aria-labelledby="frame-inputs-heading" class="mb-8">
              <h2 id="frame-inputs-heading" class="text-xl font-semibold mb-3">
                1. Define frame geometry &amp; properties
              </h2>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Units</label
                  >
                  <select
                    id="unit-system"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                  >
                    <option value="si">SI (m, kN)</option>
                    <option value="us">US (ft, kips)</option>
                  </select>
                  <p class="text-xs text-gray-500 mt-1">
                    Use consistent units for all inputs (length, E, I, loads).
                  </p>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Default material</label
                  >
                  <select
                    id="default-material"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                  >
                    <option value="steel">Steel (E ≈ 200 GPa)</option>
                    <option value="concrete">Concrete (E ≈ 30 GPa)</option>
                    <option value="custom">Custom (enter E manually)</option>
                  </select>
                  <p class="text-xs text-gray-500 mt-1">
                    You can override E and I per member.
                  </p>
                </div>
              </div>

              <!-- Nodes -->
              <div class="mb-6">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-gray-800">Nodes</h3>
                  <button
                    id="add-node-btn"
                    type="button"
                    class="text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                  >
                    + Add node
                  </button>
                </div>
                <div class="border rounded-md overflow-hidden">
                  <div
                    class="grid grid-cols-5 bg-gray-100 text-xs font-semibold text-gray-700 px-2 py-1"
                  >
                    <div>ID</div>
                    <div>X</div>
                    <div>Y</div>
                    <div>Support</div>
                    <div></div>
                  </div>
                  <div id="nodes-table-body" class="table-scroll text-xs"></div>
                </div>
                <p class="text-xs text-gray-500 mt-1">
                  Supports: Free, Pinned (Ux=Uy=0), Fixed (Ux=Uy=θ=0), Roller-X
                  (Uy=0), Roller-Y (Ux=0).
                </p>
              </div>

              <!-- Members -->
              <div class="mb-6">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-gray-800">Members</h3>
                  <button
                    id="add-member-btn"
                    type="button"
                    class="text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                  >
                    + Add member
                  </button>
                </div>
                <div class="border rounded-md overflow-hidden">
                  <div
                    class="grid grid-cols-7 bg-gray-100 text-xs font-semibold text-gray-700 px-2 py-1"
                  >
                    <div>ID</div>
                    <div>i-node</div>
                    <div>j-node</div>
                    <div>E</div>
                    <div>I</div>
                    <div>A</div>
                    <div></div>
                  </div>
                  <div
                    id="members-table-body"
                    class="table-scroll text-xs"
                  ></div>
                </div>
                <p class="text-xs text-gray-500 mt-1">
                  E: Young’s modulus, I: second moment of area, A:
                  cross-sectional area.
                </p>
              </div>

              <!-- Loads -->
              <div class="mb-4">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-gray-800">Loads</h3>
                  <button
                    id="add-load-btn"
                    type="button"
                    class="text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                  >
                    + Add load
                  </button>
                </div>
                <div class="border rounded-md overflow-hidden">
                  <div
                    class="grid grid-cols-7 bg-gray-100 text-xs font-semibold text-gray-700 px-2 py-1"
                  >
                    <div>Type</div>
                    <div>Target</div>
                    <div>Fx / w<sub>x</sub></div>
                    <div>Fy / w<sub>y</sub></div>
                    <div>Start</div>
                    <div>End</div>
                    <div></div>
                  </div>
                  <div id="loads-table-body" class="table-scroll text-xs"></div>
                </div>
                <p class="text-xs text-gray-500 mt-1">
                  Types: Nodal load (Fx,Fy), Member UDL (w<sub>y</sub>), Member
                  point load (Fy at relative position).
                </p>
              </div>

              <div class="flex flex-wrap gap-3 mt-4">
                <button
                  id="generate-example-btn"
                  type="button"
                  class="px-3 py-2 text-sm bg-gray-100 text-gray-800 rounded hover:bg-gray-200"
                >
                  Load example portal frame
                </button>
                <button
                  id="clear-model-btn"
                  type="button"
                  class="px-3 py-2 text-sm bg-gray-100 text-gray-800 rounded hover:bg-gray-200"
                >
                  Clear model
                </button>
              </div>
            </section>

            <!-- Analysis & results -->
            <section aria-labelledby="analysis-heading" class="mb-8">
              <h2 id="analysis-heading" class="text-xl font-semibold mb-3">
                2. Run analysis &amp; view results
              </h2>

              <div class="flex flex-wrap gap-3 mb-4">
                <button
                  id="solve-btn"
                  type="button"
                  class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700"
                >
                  Run 2D frame analysis
                </button>
                <button
                  id="toggle-diagram-btn"
                  type="button"
                  class="px-3 py-2 bg-gray-100 text-gray-800 rounded-md text-sm hover:bg-gray-200"
                >
                  Show: Deformed shape
                </button>
              </div>
              <p id="solver-message" class="text-sm text-gray-600 mb-3"></p>

              <div class="border rounded-md mb-4">
                <div
                  class="flex items-center justify-between px-3 py-2 bg-gray-100 border-b"
                >
                  <span class="text-sm font-medium text-gray-800"
                    >Frame diagram</span
                  >
                  <div class="flex items-center gap-2 text-xs text-gray-600">
                    <label class="flex items-center gap-1">
                      <input
                        id="show-reactions-checkbox"
                        type="checkbox"
                        class="rounded border-gray-300"
                        checked
                      />
                      <span>Reactions</span>
                    </label>
                    <label class="flex items-center gap-1">
                      <input
                        id="show-loads-checkbox"
                        type="checkbox"
                        class="rounded border-gray-300"
                        checked
                      />
                      <span>Loads</span>
                    </label>
                  </div>
                </div>
                <div class="p-2">
                  <canvas
                    id="frame-canvas"
                    class="w-full border rounded"
                    height="360"
                  ></canvas>
                </div>
              </div>

              <div class="grid md:grid-cols-2 gap-4">
                <div class="border rounded-md">
                  <div class="px-3 py-2 bg-gray-100 border-b">
                    <h3 class="text-sm font-semibold text-gray-800">
                      Support reactions
                    </h3>
                  </div>
                  <div class="p-2 table-scroll text-xs">
                    <table class="min-w-full">
                      <thead class="bg-gray-50">
                        <tr>
                          <th class="px-2 py-1 text-left font-semibold">
                            Node
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            R<sub>x</sub>
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            R<sub>y</sub>
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            M<sub>z</sub>
                          </th>
                        </tr>
                      </thead>
                      <tbody id="reactions-table-body"></tbody>
                    </table>
                  </div>
                </div>

                <div class="border rounded-md">
                  <div
                    class="px-3 py-2 bg-gray-100 border-b flex items-center justify-between"
                  >
                    <h3 class="text-sm font-semibold text-gray-800">
                      Member end forces
                    </h3>
                    <span class="text-[11px] text-gray-500"
                      >Local axes: i → j</span
                    >
                  </div>
                  <div class="p-2 table-scroll text-xs">
                    <table class="min-w-full">
                      <thead class="bg-gray-50">
                        <tr>
                          <th class="px-2 py-1 text-left font-semibold">
                            Member
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            N<sub>i</sub>
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            V<sub>i</sub>
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            M<sub>i</sub>
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            N<sub>j</sub>
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            V<sub>j</sub>
                          </th>
                          <th class="px-2 py-1 text-left font-semibold">
                            M<sub>j</sub>
                          </th>
                        </tr>
                      </thead>
                      <tbody id="member-forces-table-body"></tbody>
                    </table>
                  </div>
                </div>
              </div>

              <div class="mt-4 border rounded-md">
                <div
                  class="px-3 py-2 bg-gray-100 border-b flex items-center justify-between"
                >
                  <h3 class="text-sm font-semibold text-gray-800">
                    Nodal displacements
                  </h3>
                  <span class="text-[11px] text-gray-500"
                    >Ux, Uy, θ (global)</span
                  >
                </div>
                <div class="p-2 table-scroll text-xs">
                  <table class="min-w-full">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-2 py-1 text-left font-semibold">Node</th>
                        <th class="px-2 py-1 text-left font-semibold">Ux</th>
                        <th class="px-2 py-1 text-left font-semibold">Uy</th>
                        <th class="px-2 py-1 text-left font-semibold">θ</th>
                      </tr>
                    </thead>
                    <tbody id="displacements-table-body"></tbody>
                  </table>
                </div>
              </div>
            </section>

            <!-- Explanatory content -->
            <section class="prose mt-8">
              <h2>How this 2D frame analysis calculator works</h2>
              <p>
                This tool performs a linear elastic analysis of 2D frames using
                the
                <strong>matrix stiffness method</strong>. Each member is a
                prismatic beam-column element with 6 degrees of freedom (3 at
                each node: horizontal displacement Ux, vertical displacement Uy,
                and rotation θ).
              </p>

              <h3>Element stiffness matrix</h3>
              <p>
                For a member of length \(L\), axial rigidity \(EA\) and flexural
                rigidity \(EI\), the local stiffness matrix in the member
                coordinate system (i → j) is:
              </p>
              <div class="formula-box text-sm">
                \[ k_\text{local} = \begin{bmatrix} \frac{EA}{L} & 0 & 0 &
                -\frac{EA}{L} & 0 & 0 \\ 0 & \frac{12EI}{L^3} & \frac{6EI}{L^2}
                & 0 & -\frac{12EI}{L^3} & \frac{6EI}{L^2} \\ 0 & \frac{6EI}{L^2}
                & \frac{4EI}{L} & 0 & -\frac{6EI}{L^2} & \frac{2EI}{L} \\
                -\frac{EA}{L} & 0 & 0 & \frac{EA}{L} & 0 & 0 \\ 0 &
                -\frac{12EI}{L^3} & -\frac{6EI}{L^2} & 0 & \frac{12EI}{L^3} &
                -\frac{6EI}{L^2} \\ 0 & \frac{6EI}{L^2} & \frac{2EI}{L} & 0 &
                -\frac{6EI}{L^2} & \frac{4EI}{L} \end{bmatrix} \]
              </div>
              <p>
                The matrix is then rotated into the global X–Y system using a
                transformation matrix based on the member angle \( \theta =
                \arctan\frac{\Delta y}{\Delta x} \).
              </p>

              <h3>Boundary conditions and solution</h3>
              <ol>
                <li>
                  Assemble the global stiffness matrix \(K\) from all members.
                </li>
                <li>
                  Apply nodal loads and equivalent fixed-end forces from member
                  loads.
                </li>
                <li>
                  Impose support conditions by constraining the relevant DOFs.
                </li>
                <li>
                  Solve the reduced system \(K_{ff} \, d_f = F_f\) for free DOF
                  displacements.
                </li>
                <li>Back-calculate reactions and member end forces.</li>
              </ol>

              <h3>Assumptions & limitations</h3>
              <ul>
                <li>
                  Linear elastic material behaviour (no yielding or cracking).
                </li>
                <li>Small displacements (no P–Δ or geometric nonlinearity).</li>
                <li>Members are prismatic with constant E, I and A.</li>
                <li>
                  Static loading only (no dynamics, vibration or buckling
                  checks).
                </li>
              </ul>

              <h2>Step-by-step: using the 2D frame analysis tool</h2>
              <h3>1. Define nodes and supports</h3>
              <ul>
                <li>Add nodes with X and Y coordinates (in m or ft).</li>
                <li>
                  Assign support type at each node (Pinned, Fixed, Roller,
                  Free).
                </li>
              </ul>

              <h3>2. Add members</h3>
              <ul>
                <li>Connect nodes with members (i-node and j-node).</li>
                <li>
                  Specify E, I and A. Use consistent units (e.g. kN, m, m², m⁴).
                </li>
              </ul>

              <h3>3. Apply loads</h3>
              <ul>
                <li>Nodal loads: horizontal Fx and vertical Fy at a node.</li>
                <li>Member UDL: uniform load along the member (global Y).</li>
                <li>
                  Member point load: concentrated load at a relative position
                  0–1.
                </li>
              </ul>

              <h3>4. Run analysis and interpret results</h3>
              <ul>
                <li>Click <strong>Run 2D frame analysis</strong> to solve.</li>
                <li>Check support reactions and nodal displacements.</li>
                <li>Review member end forces (axial N, shear V, moment M).</li>
                <li>
                  Use the diagram toggle to view undeformed vs. deformed shape.
                </li>
              </ul>

              <h2>FAQ</h2>
              <h3>Can I use this for design to a specific code?</h3>
              <p>
                No. This calculator provides analysis results only. You must
                perform separate design checks (strength, serviceability,
                stability) according to the relevant code (e.g. AISC, Eurocode,
                etc.).
              </p>

              <h3>What if my frame is unstable?</h3>
              <p>
                If the structure is a mechanism (insufficient supports or
                bracing), the global stiffness matrix becomes singular and the
                solver will report an instability. Add supports or members to
                provide adequate restraint.
              </p>

              <h3>How can I validate the results?</h3>
              <p>
                Start with simple benchmark problems (e.g. a single-span beam
                with a UDL) and compare reactions and moments with hand
                calculations or textbook examples. For more complex frames,
                compare with trusted commercial software when possible.
              </p>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Units SI (m, kN) US (ft, kips) Use consistent units for all inputs (length, E, I, loads). Default material Steel (E ≈ 200 GPa) Concrete (E ≈ 30 GPa) Custom (enter E manually) You can override E and I per member. Nodes + Add node ID X Y Support Supports: Free, Pinned (Ux=Uy=0), Fixed (Ux=Uy=θ=0), Roller-X (Uy=0), Roller-Y (Ux=0). Members + Add member ID i-node j-node E I A E: Young’s modulus, I: second moment of area, A: cross-sectional area. Loads + Add load Type Target Fx / w x Fy / w y Start End Types: Nodal load (Fx,Fy), Member UDL (w y ), Member point load (Fy at relative position). Load example portal frame Clear model 2. Run analysis &amp; view results Run 2D frame analysis Show: Deformed shape Frame diagram Reactions</li><li>Loads</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: 2D, Frame, Analysis, Units SI (m, kN) US (ft, kips) Use consistent units for all inputs (length, E, I, loads). Default material Steel (E ≈ 200 GPa) Concrete (E ≈ 30 GPa) Custom (enter E manually) You can override E and I per member. Nodes + Add node ID X Y Support Supports: Free, Pinned (Ux=Uy=0), Fixed (Ux=Uy=θ=0), Roller-X (Uy=0), Roller-Y (Ux=0). Members + Add member ID i-node j-node E I A E: Young’s modulus, I: second moment of area, A: cross-sectional area. Loads + Add load Type Target Fx / w x Fy / w y Start End Types: Nodal load (Fx,Fy), Member UDL (w y ), Member point load (Fy at relative position). Load example portal frame Clear model 2. Run analysis &amp; view results Run 2D frame analysis Show: Deformed shape Frame diagram Reactions, Loads.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Units SI (m, kN) US (ft, kips) Use consistent units for all inputs (length, E, I, loads). Default material Steel (E ≈ 200 GPa) Concrete (E ≈ 30 GPa) Custom (enter E manually) You can override E and I per member. Nodes + Add node ID X Y Support Supports: Free, Pinned (Ux=Uy=0), Fixed (Ux=Uy=θ=0), Roller-X (Uy=0), Roller-Y (Ux=0). Members + Add member ID i-node j-node E I A E: Young’s modulus, I: second moment of area, A: cross-sectional area. Loads + Add load Type Target Fx / w x Fy / w y Start End Types: Nodal load (Fx,Fy), Member UDL (w y ), Member point load (Fy at relative position). Load example portal frame Clear model 2. Run analysis &amp; view results Run 2D frame analysis Show: Deformed shape Frame diagram Reactions</li><li>Loads</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Structural Engineering Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/beam-deflection"
                  class="text-blue-600 hover:underline"
                  >Beam Deflection Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/stress-and-strain"
                  class="text-blue-600 hover:underline"
                  >Stress and Strain Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/moment-of-inertia"
                  class="text-blue-600 hover:underline"
                  >Section Moment of Inertia</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/buckling-load"
                  class="text-blue-600 hover:underline"
                  >Euler Buckling Load</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/retaining-wall-stability"
                  class="text-blue-600 hover:underline"
                  >Retaining Wall Stability</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/aisc-steel-beam-design"
                  class="text-blue-600 hover:underline"
                  >Steel Beam Design (AISC)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/eurocode-2-beam-design"
                  class="text-blue-600 hover:underline"
                  >Eurocode 2 Concrete Beam Design</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/asce-7-22-wind-load"
                  class="text-blue-600 hover:underline"
                  >ASCE 7-22 Wind Load</a
                >
              </li>
            </ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">
              Tips for accurate frame analysis
            </h2>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
              <li>
                Keep units consistent across geometry, loads and section
                properties.
              </li>
              <li>
                Model supports realistically; avoid over-constraining the frame.
              </li>
              <li>
                Include intermediate nodes where loads change or where you need
                results.
              </li>
              <li>
                Check equilibrium: sum of reactions should balance applied
                loads.
              </li>
              <li>
                Use this tool for preliminary design and education, not as the
                sole basis for critical structures.
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Basic linear algebra helpers for small systems
      function solveLinearSystem(K, F) {
        const n = F.length;
        const A = Array.from({ length: n }, (_, i) => K[i].slice());
        const b = F.slice();

        // Gaussian elimination with partial pivoting
        for (let k = 0; k < n; k++) {
          // Pivot
          let maxRow = k;
          for (let i = k + 1; i < n; i++) {
            if (Math.abs(A[i][k]) > Math.abs(A[maxRow][k])) maxRow = i;
          }
          if (Math.abs(A[maxRow][k]) < 1e-12)
            throw new Error("Singular matrix (structure may be unstable).");
          if (maxRow !== k) {
            [A[k], A[maxRow]] = [A[maxRow], A[k]];
            [b[k], b[maxRow]] = [b[maxRow], b[k]];
          }
          // Eliminate
          for (let i = k + 1; i < n; i++) {
            const factor = A[i][k] / A[k][k];
            for (let j = k; j < n; j++) A[i][j] -= factor * A[k][j];
            b[i] -= factor * b[k];
          }
        }
        // Back substitution
        const x = new Array(n).fill(0);
        for (let i = n - 1; i >= 0; i--) {
          let sum = b[i];
          for (let j = i + 1; j < n; j++) sum -= A[i][j] * x[j];
          x[i] = sum / A[i][i];
        }
        return x;
      }

      // Model storage
      let nodes = [];
      let members = [];
      let loads = [];
      let lastResults = null;
      let diagramMode = "deformed"; // or "undeformed"

      const nodesBody = document.getElementById("nodes-table-body");
      const membersBody = document.getElementById("members-table-body");
      const loadsBody = document.getElementById("loads-table-body");
      const reactionsBody = document.getElementById("reactions-table-body");
      const memberForcesBody = document.getElementById(
        "member-forces-table-body"
      );
      const displacementsBody = document.getElementById(
        "displacements-table-body"
      );
      const canvas = document.getElementById("frame-canvas");
      const ctx = canvas.getContext("2d");
      const solverMessage = document.getElementById("solver-message");

      function renderNodesTable() {
        nodesBody.innerHTML = "";
        nodes.forEach((n, idx) => {
          const row = document.createElement("div");
          row.className = "grid grid-cols-5 items-center border-b px-2 py-1";
          row.innerHTML = `
        <div class="flex items-center gap-1">
          <span>${idx + 1}</span>
        </div>
        <input type="number" step="0.01" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          n.x
        }" data-idx="${idx}" data-field="x">
        <input type="number" step="0.01" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          n.y
        }" data-idx="${idx}" data-field="y">
        <select class="border rounded px-1 py-0.5 text-xs mx-1" data-idx="${idx}" data-field="support">
          <option value="free" ${
            n.support === "free" ? "selected" : ""
          }>Free</option>
          <option value="pinned" ${
            n.support === "pinned" ? "selected" : ""
          }>Pinned</option>
          <option value="fixed" ${
            n.support === "fixed" ? "selected" : ""
          }>Fixed</option>
          <option value="roller-x" ${
            n.support === "roller-x" ? "selected" : ""
          }>Roller-X</option>
          <option value="roller-y" ${
            n.support === "roller-y" ? "selected" : ""
          }>Roller-Y</option>
        </select>
        <button type="button" class="text-red-600 text-xs" data-idx="${idx}" data-action="delete-node">✕</button>
      `;
          nodesBody.appendChild(row);
        });
      }

      function renderMembersTable() {
        membersBody.innerHTML = "";
        members.forEach((m, idx) => {
          const row = document.createElement("div");
          row.className = "grid grid-cols-7 items-center border-b px-2 py-1";
          row.innerHTML = `
        <div>${idx + 1}</div>
        <input type="number" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          m.i + 1
        }" data-idx="${idx}" data-field="i">
        <input type="number" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          m.j + 1
        }" data-idx="${idx}" data-field="j">
        <input type="number" step="0.01" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          m.E
        }" data-idx="${idx}" data-field="E">
        <input type="number" step="0.0001" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          m.I
        }" data-idx="${idx}" data-field="I">
        <input type="number" step="0.0001" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          m.A
        }" data-idx="${idx}" data-field="A">
        <button type="button" class="text-red-600 text-xs" data-idx="${idx}" data-action="delete-member">✕</button>
      `;
          membersBody.appendChild(row);
        });
      }

      function renderLoadsTable() {
        loadsBody.innerHTML = "";
        loads.forEach((L, idx) => {
          const row = document.createElement("div");
          row.className = "grid grid-cols-7 items-center border-b px-2 py-1";
          row.innerHTML = `
        <select class="border rounded px-1 py-0.5 text-xs mx-1" data-idx="${idx}" data-field="type">
          <option value="node" ${
            L.type === "node" ? "selected" : ""
          }>Nodal</option>
          <option value="udl" ${
            L.type === "udl" ? "selected" : ""
          }>Member UDL</option>
          <option value="point" ${
            L.type === "point" ? "selected" : ""
          }>Member point</option>
        </select>
        <input type="number" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          L.target
        }" data-idx="${idx}" data-field="target">
        <input type="number" step="0.01" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          L.fx
        }" data-idx="${idx}" data-field="fx">
        <input type="number" step="0.01" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          L.fy
        }" data-idx="${idx}" data-field="fy">
        <input type="number" step="0.01" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          L.a
        }" data-idx="${idx}" data-field="a">
        <input type="number" step="0.01" class="number-input border rounded px-1 py-0.5 text-xs mx-1" value="${
          L.b
        }" data-idx="${idx}" data-field="b">
        <button type="button" class="text-red-600 text-xs" data-idx="${idx}" data-action="delete-load">✕</button>
      `;
          loadsBody.appendChild(row);
        });
      }

      document.getElementById("add-node-btn").addEventListener("click", () => {
        const id = nodes.length + 1;
        nodes.push({
          x: (id - 1) * 2,
          y: 0,
          support: id === 1 ? "fixed" : "free",
        });
        renderNodesTable();
        drawFrame();
      });

      nodesBody.addEventListener("input", (e) => {
        const idx = parseInt(e.target.dataset.idx, 10);
        const field = e.target.dataset.field;
        if (field === "x" || field === "y") {
          nodes[idx][field] = parseFloat(e.target.value) || 0;
        }
        drawFrame();
      });
      nodesBody.addEventListener("change", (e) => {
        const idx = parseInt(e.target.dataset.idx, 10);
        const field = e.target.dataset.field;
        if (field === "support") {
          nodes[idx].support = e.target.value;
          drawFrame();
        }
      });
      nodesBody.addEventListener("click", (e) => {
        if (e.target.dataset.action === "delete-node") {
          const idx = parseInt(e.target.dataset.idx, 10);
          nodes.splice(idx, 1);
          // Re-map member node indices
          members = members
            .filter((m) => m.i !== idx && m.j !== idx)
            .map((m) => {
              return {
                ...m,
                i: m.i > idx ? m.i - 1 : m.i,
                j: m.j > idx ? m.j - 1 : m.j,
              };
            });
          renderNodesTable();
          renderMembersTable();
          drawFrame();
        }
      });

      document
        .getElementById("add-member-btn")
        .addEventListener("click", () => {
          if (nodes.length < 2) {
            alert("Add at least two nodes first.");
            return;
          }
          const i = Math.max(0, nodes.length - 2);
          const j = nodes.length - 1;
          members.push({ i, j, E: 200000, I: 0.0001, A: 0.01 });
          renderMembersTable();
          drawFrame();
        });

      membersBody.addEventListener("input", (e) => {
        const idx = parseInt(e.target.dataset.idx, 10);
        const field = e.target.dataset.field;
        if (field === "i" || field === "j") {
          const val = parseInt(e.target.value, 10) - 1;
          if (!isNaN(val) && val >= 0 && val < nodes.length) {
            members[idx][field] = val;
          }
        } else if (field === "E" || field === "I" || field === "A") {
          members[idx][field] = parseFloat(e.target.value) || 0;
        }
        drawFrame();
      });
      membersBody.addEventListener("click", (e) => {
        if (e.target.dataset.action === "delete-member") {
          const idx = parseInt(e.target.dataset.idx, 10);
          members.splice(idx, 1);
          renderMembersTable();
          drawFrame();
        }
      });

      document.getElementById("add-load-btn").addEventListener("click", () => {
        loads.push({ type: "node", target: 1, fx: 0, fy: -10, a: 0, b: 0 });
        renderLoadsTable();
        drawFrame();
      });

      loadsBody.addEventListener("input", (e) => {
        const idx = parseInt(e.target.dataset.idx, 10);
        const field = e.target.dataset.field;
        if (!loads[idx]) return;
        if (field === "type") {
          loads[idx].type = e.target.value;
        } else if (field === "target") {
          loads[idx].target = parseInt(e.target.value, 10) || 1;
        } else if (
          field === "fx" ||
          field === "fy" ||
          field === "a" ||
          field === "b"
        ) {
          loads[idx][field] = parseFloat(e.target.value) || 0;
        }
        drawFrame();
      });
      loadsBody.addEventListener("click", (e) => {
        if (e.target.dataset.action === "delete-load") {
          const idx = parseInt(e.target.dataset.idx, 10);
          loads.splice(idx, 1);
          renderLoadsTable();
          drawFrame();
        }
      });

      document
        .getElementById("clear-model-btn")
        .addEventListener("click", () => {
          nodes = [];
          members = [];
          loads = [];
          lastResults = null;
          renderNodesTable();
          renderMembersTable();
          renderLoadsTable();
          reactionsBody.innerHTML = "";
          memberForcesBody.innerHTML = "";
          displacementsBody.innerHTML = "";
          solverMessage.textContent = "";
          drawFrame();
        });

      document
        .getElementById("generate-example-btn")
        .addEventListener("click", () => {
          // Simple portal frame example
          nodes = [
            { x: 0, y: 0, support: "fixed" },
            { x: 4, y: 0, support: "fixed" },
            { x: 0, y: 3, support: "free" },
            { x: 4, y: 3, support: "free" },
          ];
          members = [
            { i: 0, j: 2, E: 200000, I: 0.0002, A: 0.02 },
            { i: 1, j: 3, E: 200000, I: 0.0002, A: 0.02 },
            { i: 2, j: 3, E: 200000, I: 0.0002, A: 0.02 },
          ];
          loads = [{ type: "udl", target: 3, fx: 0, fy: -10, a: 0, b: 1 }];
          renderNodesTable();
          renderMembersTable();
          renderLoadsTable();
          solverMessage.textContent =
            "Example portal frame loaded. Click “Run 2D frame analysis”.";
          drawFrame();
        });

      document
        .getElementById("toggle-diagram-btn")
        .addEventListener("click", (e) => {
          diagramMode = diagramMode === "deformed" ? "undeformed" : "deformed";
          e.target.textContent =
            "Show: " +
            (diagramMode === "deformed"
              ? "Deformed shape"
              : "Undeformed shape");
          drawFrame();
        });

      document
        .getElementById("show-reactions-checkbox")
        .addEventListener("change", drawFrame);
      document
        .getElementById("show-loads-checkbox")
        .addEventListener("change", drawFrame);

      function buildDOFIndex() {
        const dofIndex = [];
        for (let i = 0; i < nodes.length; i++) {
          dofIndex.push(3 * i, 3 * i + 1, 3 * i + 2);
        }
        return dofIndex;
      }

      function getSupportConstraints() {
        // returns array of constrained DOF indices
        const constrained = [];
        nodes.forEach((n, i) => {
          const base = 3 * i;
          if (n.support === "fixed") {
            constrained.push(base, base + 1, base + 2);
          } else if (n.support === "pinned") {
            constrained.push(base, base + 1);
          } else if (n.support === "roller-x") {
            constrained.push(base + 1);
          } else if (n.support === "roller-y") {
            constrained.push(base);
          }
        });
        return constrained;
      }

      function assembleGlobalStiffness() {
        const ndof = nodes.length * 3;
        const K = Array.from({ length: ndof }, () => new Array(ndof).fill(0));

        members.forEach((m) => {
          const ni = nodes[m.i];
          const nj = nodes[m.j];
          const dx = nj.x - ni.x;
          const dy = nj.y - ni.y;
          const L = Math.sqrt(dx * dx + dy * dy);
          if (L <= 0) return;

          const c = dx / L;
          const s = dy / L;
          const E = m.E;
          const I = m.I;
          const A = m.A;

          const EA_L = (E * A) / L;
          const EI_L3 = (E * I) / (L * L * L);
          const EI_L2 = (E * I) / (L * L);
          const EI_L = (E * I) / L;

          const kLocal = [
            [EA_L, 0, 0, -EA_L, 0, 0],
            [0, 12 * EI_L3, 6 * EI_L2, 0, -12 * EI_L3, 6 * EI_L2],
            [0, 6 * EI_L2, 4 * EI_L, 0, -6 * EI_L2, 2 * EI_L],
            [-EA_L, 0, 0, EA_L, 0, 0],
            [0, -12 * EI_L3, -6 * EI_L2, 0, 12 * EI_L3, -6 * EI_L2],
            [0, 6 * EI_L2, 2 * EI_L, 0, -6 * EI_L2, 4 * EI_L],
          ];

          const T = [
            [c, s, 0, 0, 0, 0],
            [-s, c, 0, 0, 0, 0],
            [0, 0, 1, 0, 0, 0],
            [0, 0, 0, c, s, 0],
            [0, 0, 0, -s, c, 0],
            [0, 0, 0, 0, 0, 1],
          ];

          // kGlobal = T^T * kLocal * T
          const temp = Array.from({ length: 6 }, () => new Array(6).fill(0));
          const kGlobal = Array.from({ length: 6 }, () => new Array(6).fill(0));

          for (let i = 0; i < 6; i++) {
            for (let j = 0; j < 6; j++) {
              let sum = 0;
              for (let k = 0; k < 6; k++) sum += kLocal[i][k] * T[k][j];
              temp[i][j] = sum;
            }
          }
          for (let i = 0; i < 6; i++) {
            for (let j = 0; j < 6; j++) {
              let sum = 0;
              for (let k = 0; k < 6; k++) sum += T[k][i] * temp[k][j];
              kGlobal[i][j] = sum;
            }
          }

          const dofMap = [
            3 * m.i,
            3 * m.i + 1,
            3 * m.i + 2,
            3 * m.j,
            3 * m.j + 1,
            3 * m.j + 2,
          ];

          for (let a = 0; a < 6; a++) {
            for (let b = 0; b < 6; b++) {
              const I = dofMap[a];
              const J = dofMap[b];
              K[I][J] += kGlobal[a][b];
            }
          }
        });

        return K;
      }

      function assembleLoadVector() {
        const ndof = nodes.length * 3;
        const F = new Array(ndof).fill(0);

        // Nodal loads
        loads
          .filter((L) => L.type === "node")
          .forEach((L) => {
            const nIdx = (L.target || 1) - 1;
            if (nIdx < 0 || nIdx >= nodes.length) return;
            const base = 3 * nIdx;
            F[base] += L.fx || 0;
            F[base + 1] += L.fy || 0;
          });

        // Member loads: simple equivalent nodal loads for UDL and point load in global Y
        members.forEach((m, midx) => {
          const ni = nodes[m.i];
          const nj = nodes[m.j];
          const dx = nj.x - ni.x;
          const dy = nj.y - ni.y;
          const L = Math.sqrt(dx * dx + dy * dy);
          if (L <= 0) return;
          const c = dx / L;
          const s = dy / L;

          const memberLoads = loads.filter(
            (L) =>
              (L.type === "udl" || L.type === "point") && L.target === midx + 1
          );
          memberLoads.forEach((L) => {
            if (L.type === "udl") {
              const w = L.fy || 0; // global Y
              // Convert to local coordinates (assume load vertical)
              const wy = w * (c * 0 + s * 1 ? 1 : 1); // simplified: treat as local y
              // Fixed-end forces in local coordinates (standard beam UDL)
              const fLocal = [
                0,
                (-wy * L) / 2,
                (-wy * L * L) / 12,
                0,
                (-wy * L) / 2,
                (wy * L * L) / 12,
              ];
              // Transform to global and subtract from F (since they are fixed-end)
              const T = [
                [c, s, 0, 0, 0, 0],
                [-s, c, 0, 0, 0, 0],
                [0, 0, 1, 0, 0, 0],
                [0, 0, 0, c, s, 0],
                [0, 0, 0, -s, c, 0],
                [0, 0, 0, 0, 0, 1],
              ];
              const fGlobal = new Array(6).fill(0);
              for (let i = 0; i < 6; i++) {
                let sum = 0;
                for (let j = 0; j < 6; j++) sum += T[i][j] * fLocal[j];
                fGlobal[i] = sum;
              }
              const dofMap = [
                3 * m.i,
                3 * m.i + 1,
                3 * m.i + 2,
                3 * m.j,
                3 * m.j + 1,
                3 * m.j + 2,
              ];
              for (let a = 0; a < 6; a++) {
                F[dofMap[a]] -= fGlobal[a];
              }
            } else if (L.type === "point") {
              const P = L.fy || 0;
              const a = (L.a || 0) * L; // simplified: treat as mid-span if 0
              const b = L - a;
              const R1 = (P * b) / L;
              const R2 = (P * a) / L;
              const M1 = (P * a * b * b) / (L * L);
              const M2 = (-P * a * a * b) / (L * L);
              const fLocal = [0, -R1, -M1, 0, -R2, -M2];
              const T = [
                [c, s, 0, 0, 0, 0],
                [-s, c, 0, 0, 0, 0],
                [0, 0, 1, 0, 0, 0],
                [0, 0, 0, c, s, 0],
                [0, 0, 0, -s, c, 0],
                [0, 0, 0, 0, 0, 1],
              ];
              const fGlobal = new Array(6).fill(0);
              for (let i = 0; i < 6; i++) {
                let sum = 0;
                for (let j = 0; j < 6; j++) sum += T[i][j] * fLocal[j];
                fGlobal[i] = sum;
              }
              const dofMap = [
                3 * m.i,
                3 * m.i + 1,
                3 * m.i + 2,
                3 * m.j,
                3 * m.j + 1,
                3 * m.j + 2,
              ];
              for (let a = 0; a < 6; a++) {
                F[dofMap[a]] -= fGlobal[a];
              }
            }
          });
        });

        return F;
      }

      function solveFrame() {
        if (nodes.length === 0 || members.length === 0) {
          throw new Error("Define at least one member and two nodes.");
        }
        const ndof = nodes.length * 3;
        const K = assembleGlobalStiffness();
        const F = assembleLoadVector();
        const constrained = getSupportConstraints();
        const freeDOF = [];
        for (let i = 0; i < ndof; i++) {
          if (!constrained.includes(i)) freeDOF.push(i);
        }
        if (freeDOF.length === 0) throw new Error("All DOFs are constrained.");

        const Kff = freeDOF.map((i) => freeDOF.map((j) => K[i][j]));
        const Ff = freeDOF.map((i) => F[i]);

        const df = solveLinearSystem(Kff, Ff);
        const d = new Array(ndof).fill(0);
        freeDOF.forEach((dof, idx) => {
          d[dof] = df[idx];
        });

        // Reactions: R = K * d - F
        const R = new Array(ndof).fill(0);
        for (let i = 0; i < ndof; i++) {
          let sum = 0;
          for (let j = 0; j < ndof; j++) sum += K[i][j] * d[j];
          R[i] = sum - F[i];
        }

        // Member end forces in local coordinates
        const memberEndForces = members.map((m) => {
          const ni = nodes[m.i];
          const nj = nodes[m.j];
          const dx = nj.x - ni.x;
          const dy = nj.y - ni.y;
          const L = Math.sqrt(dx * dx + dy * dy);
          const c = dx / L;
          const s = dy / L;
          const E = m.E;
          const I = m.I;
          const A = m.A;

          const EA_L = (E * A) / L;
          const EI_L3 = (E * I) / (L * L * L);
          const EI_L2 = (E * I) / (L * L);
          const EI_L = (E * I) / L;

          const kLocal = [
            [EA_L, 0, 0, -EA_L, 0, 0],
            [0, 12 * EI_L3, 6 * EI_L2, 0, -12 * EI_L3, 6 * EI_L2],
            [0, 6 * EI_L2, 4 * EI_L, 0, -6 * EI_L2, 2 * EI_L],
            [-EA_L, 0, 0, EA_L, 0, 0],
            [0, -12 * EI_L3, -6 * EI_L2, 0, 12 * EI_L3, -6 * EI_L2],
            [0, 6 * EI_L2, 2 * EI_L, 0, -6 * EI_L2, 4 * EI_L],
          ];

          const T = [
            [c, s, 0, 0, 0, 0],
            [-s, c, 0, 0, 0, 0],
            [0, 0, 1, 0, 0, 0],
            [0, 0, 0, c, s, 0],
            [0, 0, 0, -s, c, 0],
            [0, 0, 0, 0, 0, 1],
          ];

          const dofMap = [
            3 * m.i,
            3 * m.i + 1,
            3 * m.i + 2,
            3 * m.j,
            3 * m.j + 1,
            3 * m.j + 2,
          ];
          const dGlobal = dofMap.map((i) => d[i]);

          const dLocal = new Array(6).fill(0);
          for (let i = 0; i < 6; i++) {
            let sum = 0;
            for (let j = 0; j < 6; j++) sum += T[i][j] * dGlobal[j];
            dLocal[i] = sum;
          }

          const fLocal = new Array(6).fill(0);
          for (let i = 0; i < 6; i++) {
            let sum = 0;
            for (let j = 0; j < 6; j++) sum += kLocal[i][j] * dLocal[j];
            fLocal[i] = sum;
          }

          return fLocal;
        });

        return { displacements: d, reactions: R, memberEndForces };
      }

      document.getElementById("solve-btn").addEventListener("click", () => {
        try {
          solverMessage.textContent = "Solving...";
          const res = solveFrame();
          lastResults = res;
          solverMessage.textContent =
            "Analysis complete. Check reactions, member forces and displacements below.";
          populateResultsTables(res);
          drawFrame();
        } catch (err) {
          solverMessage.textContent = err.message;
          console.error(err);
        }
      });

      function populateResultsTables(res) {
        const ndof = nodes.length * 3;
        reactionsBody.innerHTML = "";
        displacementsBody.innerHTML = "";
        memberForcesBody.innerHTML = "";

        nodes.forEach((n, i) => {
          const base = 3 * i;
          const rx = res.reactions[base];
          const ry = res.reactions[base + 1];
          const mz = res.reactions[base + 2];

          const rRow = document.createElement("tr");
          rRow.innerHTML = `
        <td class="px-2 py-1">N${i + 1}</td>
        <td class="px-2 py-1">${rx.toFixed(3)}</td>
        <td class="px-2 py-1">${ry.toFixed(3)}</td>
        <td class="px-2 py-1">${mz.toFixed(3)}</td>
      `;
          reactionsBody.appendChild(rRow);

          const ux = res.displacements[base];
          const uy = res.displacements[base + 1];
          const th = res.displacements[base + 2];
          const dRow = document.createElement("tr");
          dRow.innerHTML = `
        <td class="px-2 py-1">N${i + 1}</td>
        <td class="px-2 py-1">${ux.toExponential(3)}</td>
        <td class="px-2 py-1">${uy.toExponential(3)}</td>
        <td class="px-2 py-1">${th.toExponential(3)}</td>
      `;
          displacementsBody.appendChild(dRow);
        });

        members.forEach((m, idx) => {
          const f = res.memberEndForces[idx];
          const row = document.createElement("tr");
          row.innerHTML = `
        <td class="px-2 py-1">M${idx + 1}</td>
        <td class="px-2 py-1">${f[0].toFixed(3)}</td>
        <td class="px-2 py-1">${f[1].toFixed(3)}</td>
        <td class="px-2 py-1">${f[2].toFixed(3)}</td>
        <td class="px-2 py-1">${f[3].toFixed(3)}</td>
        <td class="px-2 py-1">${f[4].toFixed(3)}</td>
        <td class="px-2 py-1">${f[5].toFixed(3)}</td>
      `;
          memberForcesBody.appendChild(row);
        });
      }

      function drawFrame() {
        const w = canvas.clientWidth;
        const h = canvas.height;
        canvas.width = w;
        ctx.clearRect(0, 0, w, h);

        if (nodes.length === 0) return;

        // Determine bounds
        let minX = Infinity,
          maxX = -Infinity,
          minY = Infinity,
          maxY = -Infinity;
        nodes.forEach((n) => {
          if (n.x < minX) minX = n.x;
          if (n.x > maxX) maxX = n.x;
          if (n.y < minY) minY = n.y;
          if (n.y > maxY) maxY = n.y;
        });
        if (minX === maxX) {
          minX -= 1;
          maxX += 1;
        }
        if (minY === maxY) {
          minY -= 1;
          maxY += 1;
        }

        const margin = 40;
        const sx = (w - 2 * margin) / (maxX - minX);
        const sy = (h - 2 * margin) / (maxY - minY || 1);
        const scale = Math.min(sx, sy);

        function toCanvas(n, dispScale = 0) {
          const idx = nodes.indexOf(n);
          let dx = 0,
            dy = 0;
          if (lastResults && diagramMode === "deformed") {
            const base = 3 * idx;
            dx = lastResults.displacements[base] * dispScale;
            dy = lastResults.displacements[base + 1] * dispScale;
          }
          const X = margin + (n.x - minX) * scale + dx;
          const Y = h - margin - (n.y - minY) * scale - dy;
          return { x: X, y: Y };
        }

        const dispScale =
          lastResults && diagramMode === "deformed" ? scale * 50 : 0;

        // Draw members
        ctx.lineWidth = 2;
        ctx.strokeStyle = "#2563eb";
        members.forEach((m) => {
          const ni = nodes[m.i];
          const nj = nodes[m.j];
          const p1 = toCanvas(ni, dispScale);
          const p2 = toCanvas(nj, dispScale);
          ctx.beginPath();
          ctx.moveTo(p1.x, p1.y);
          ctx.lineTo(p2.x, p2.y);
          ctx.stroke();
        });

        // Draw nodes
        nodes.forEach((n, idx) => {
          const p = toCanvas(n, dispScale);
          ctx.fillStyle = "#111827";
          ctx.beginPath();
          ctx.arc(p.x, p.y, 3, 0, 2 * Math.PI);
          ctx.fill();
          ctx.fillStyle = "#374151";
          ctx.font = "10px Inter";
          ctx.fillText(`N${idx + 1}`, p.x + 4, p.y - 4);
        });

        // Draw supports
        nodes.forEach((n) => {
          const p = toCanvas(n, dispScale);
          ctx.strokeStyle = "#4b5563";
          ctx.lineWidth = 1.5;
          if (n.support === "fixed") {
            ctx.beginPath();
            ctx.moveTo(p.x - 8, p.y + 8);
            ctx.lineTo(p.x + 8, p.y + 8);
            ctx.lineTo(p.x + 8, p.y + 14);
            ctx.lineTo(p.x - 8, p.y + 14);
            ctx.closePath();
            ctx.stroke();
          } else if (n.support === "pinned") {
            ctx.beginPath();
            ctx.moveTo(p.x - 8, p.y + 8);
            ctx.lineTo(p.x + 8, p.y + 8);
            ctx.lineTo(p.x, p.y);
            ctx.closePath();
            ctx.stroke();
          } else if (n.support === "roller-x" || n.support === "roller-y") {
            ctx.beginPath();
            ctx.moveTo(p.x - 8, p.y + 8);
            ctx.lineTo(p.x + 8, p.y + 8);
            ctx.stroke();
          }
        });

        // Draw loads
        if (document.getElementById("show-loads-checkbox").checked) {
          ctx.strokeStyle = "#dc2626";
          ctx.fillStyle = "#dc2626";
          ctx.lineWidth = 1;
          loads.forEach((L) => {
            if (L.type === "node") {
              const nIdx = (L.target || 1) - 1;
              if (nIdx < 0 || nIdx >= nodes.length) return;
              const n = nodes[nIdx];
              const p = toCanvas(n, dispScale);
              const scaleArrow = 10;
              if (L.fy) {
                const dir = L.fy < 0 ? 1 : -1;
                ctx.beginPath();
                ctx.moveTo(p.x, p.y);
                ctx.lineTo(p.x, p.y + dir * scaleArrow);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(p.x - 3, p.y + dir * scaleArrow * 0.7);
                ctx.lineTo(p.x, p.y + dir * scaleArrow);
                ctx.lineTo(p.x + 3, p.y + dir * scaleArrow * 0.7);
                ctx.stroke();
              }
              if (L.fx) {
                const dir = L.fx > 0 ? 1 : -1;
                ctx.beginPath();
                ctx.moveTo(p.x, p.y);
                ctx.lineTo(p.x + dir * scaleArrow, p.y);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(p.x + dir * scaleArrow * 0.7, p.y - 3);
                ctx.lineTo(p.x + dir * scaleArrow, p.y);
                ctx.lineTo(p.x + dir * scaleArrow * 0.7, p.y + 3);
                ctx.stroke();
              }
            }
          });
        }

        // Draw reactions
        if (
          lastResults &&
          document.getElementById("show-reactions-checkbox").checked
        ) {
          ctx.strokeStyle = "#16a34a";
          ctx.fillStyle = "#16a34a";
          ctx.lineWidth = 1;
          nodes.forEach((n, idx) => {
            const base = 3 * idx;
            const rx = lastResults.reactions[base];
            const ry = lastResults.reactions[base + 1];
            const p = toCanvas(n, dispScale);
            const scaleArrow = 12;
            if (Math.abs(ry) > 1e-6) {
              const dir = ry > 0 ? -1 : 1;
              ctx.beginPath();
              ctx.moveTo(p.x, p.y);
              ctx.lineTo(p.x, p.y + dir * scaleArrow);
              ctx.stroke();
              ctx.beginPath();
              ctx.moveTo(p.x - 3, p.y + dir * scaleArrow * 0.7);
              ctx.lineTo(p.x, p.y + dir * scaleArrow);
              ctx.lineTo(p.x + 3, p.y + dir * scaleArrow * 0.7);
              ctx.stroke();
            }
            if (Math.abs(rx) > 1e-6) {
              const dir = rx > 0 ? -1 : 1;
              ctx.beginPath();
              ctx.moveTo(p.x, p.y);
              ctx.lineTo(p.x + dir * scaleArrow, p.y);
              ctx.stroke();
              ctx.beginPath();
              ctx.moveTo(p.x + dir * scaleArrow * 0.7, p.y - 3);
              ctx.lineTo(p.x + dir * scaleArrow, p.y);
              ctx.lineTo(p.x + dir * scaleArrow * 0.7, p.y + 3);
              ctx.stroke();
            }
          });
        }
      }

      // Initial draw
      drawFrame();
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

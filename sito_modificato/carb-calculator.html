<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/carb-calculator">





<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carb Calculator - Calculate Your Daily Carbohydrate Needs</title>
<meta name="description" content="Calculate your optimal daily carbohydrate intake based on your age, sex, activity level, and goals. Get carb targets for weight loss, maintenance, or muscle gain.">


<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.prose strong { font-weight: 600; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1.5rem;
overflow-x:auto; font-family: 'Inter', sans-serif; text-align: center;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }
/* Custom focus state for WCAG compliance */
:focus-visible {
outline: 3px solid #3b82f6 !important;
outline-offset: 2px;
border-radius: 2px;
}
/* Accessible Tooltip */
.tooltip-container {
position: relative;
display: inline-block;
}
.tooltip-button {
background: none; border: none; padding: 0 4px; cursor: pointer;
color: #6b7280;
}
.tooltip-text {
visibility: hidden;
width: 250px;
background-color: #1f2937;
color: #fff;
text-align: left;
border-radius: 6px;
padding: 8px 12px;
position: absolute;
z-index: 10;
bottom: 125%;
left: 50%;
margin-left: -125px; /* Half of width */
opacity: 0;
transition: opacity 0.3s;
font-size: 0.875rem;
font-weight: 400;
line-height: 1.5;
}
.tooltip-button:focus + .tooltip-text,
.tooltip-button:hover + .tooltip-text {
visibility: visible;
opacity: 1;
}
/* Error message style */
.error-message {
color: #dc2626;
font-size: 0.875rem;
margin-top: 0.25rem;
}
/* Ensure min-height to prevent CLS */
#results {
min-height: 400px;
}
@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
#results-chart-container { display: none !important; }
}
</style>

<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Carb Calculator - Calculate Your Daily Carbohydrate Needs",
  "description": "Calculate your optimal daily carbohydrate intake based on your age, sex, activity level, and goals. Get carb targets for weight loss, maintenance, or muscle gain.",
  "url": "https://calcdomain.com/carb-calculator",
  "inLanguage": "en",
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "dateModified": "2026-01-19"
}</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Health & Fitness",
      "item": "https://calcdomain.com/categories/health-fitness"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Diet Nutrition",
      "item": "https://calcdomain.com/subcategories/diet-nutrition"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to Calculate Your Carbohydrate Needs",
  "description": "A step-by-step guide to calculating your daily carbohydrate intake based on your goals and activity.",
  "step": [
    {
      "@type": "HowToStep",
      "name": "Enter Personal Details",
      "text": "Input your age, sex, height, and current weight. Choose either Metric or Imperial units."
    },
    {
      "@type": "HowToStep",
      "name": "Select Activity Level",
      "text": "Choose the activity level that best matches your weekly exercise routine, from sedentary to extra active."
    },
    {
      "@type": "HowToStep",
      "name": "Set Your Goal",
      "text": "Select your primary goal, such as weight loss, weight maintenance, or muscle gain."
    },
    {
      "@type": "HowToStep",
      "name": "Review Results",
      "text": "The calculator will display your target daily calories and provide several macronutrient plans (e.g., balanced, low-carb) showing your specific carbohydrate grams per day."
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "Why use the Mifflin-St Jeor equation?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The Mifflin-St Jeor equation, published in 1990, is considered by many nutrition experts to be the most accurate formula for estimating Basal Metabolic Rate (BMR) in healthy adults, often outperforming the older Harris-Benedict equation."
      }
    },
    {
      "@type": "Question",
      "name": "What is the difference between BMR and TDEE?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "BMR (Basal Metabolic Rate) is the number of calories your body needs to perform basic, life-sustaining functions at rest. TDEE (Total Daily Energy Expenditure) is your BMR plus the calories you burn from all other activities, including exercise and digestion. Your TDEE is the total number of calories you burn in a day."
      }
    },
    {
      "@type": "Question",
      "name": "How many carbs should I eat to lose weight?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "To lose weight, you must be in a calorie deficit. This calculator first determines your maintenance calories (TDEE) and then subtracts calories based on your weight loss goal (e.g., -500 calories for 1 lb/week). It then calculates your carb intake as a percentage of those *reduced* calories. A balanced or low-carb plan is often used for weight loss."
      }
    },
    {
      "@type": "Question",
      "name": "What are 'net carbs' and does this calculator track them?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "This calculator estimates *total* carbohydrates. 'Net carbs' are total carbs minus fiber and certain sugar alcohols. Net carbs are often tracked on specific diets like the ketogenic diet. To find your net carb goal, you would need to subtract your daily fiber goal (e.g., 25-30g) from the total carb number provided."
      }
    },
    {
      "@type": "Question",
      "name": "Is a low-carb or high-carb plan better?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The 'best' plan depends on your goals and preferences. High-carb plans are often favored by endurance athletes for fuel. Low-carb plans can be effective for weight loss and managing blood sugar. A balanced plan is a sustainable, moderate approach for general health. The most effective diet is one you can adhere to consistently."
      }
    }
  ]
}
</script>

<script src="search.js" defer=""></script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">


<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Men: $BMR = (10 \times \text{weight in kg}) + (6.25 \times \text{height in cm}) - (5 \times \text{age in years}) + 5$ Women: $BMR = (10 \times \text{weight in kg}) + (6.25 \times \text{height in cm}) - (5 \times \text{age in years}) - 161$</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$TDEE = BMR \times \text{Activity Factor}$</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$Goal \text{ Calories} = TDEE + \text{Goal Adjustment}$</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$Carbohydrates \text{ (g)} = \frac{Goal \text{ Calories} \times \% \text{Carbs}}{4}$</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Home</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/" target="_blank" rel="nofollow noopener">https://calcdomain.com/</a></li>
<li><strong>Health &amp; Fitness</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/health-fitness" target="_blank" rel="nofollow noopener">https://calcdomain.com/health-fitness</a></li>
<li><strong>Diet &amp; Nutrition</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/diet-nutrition" target="_blank" rel="nofollow noopener">https://calcdomain.com/subcategories/diet-nutrition</a></li>
<li><strong>https://doi.org/10.1093/ajcn/51.2.241</strong> — doi.org · Accessed 2026-01-19<br><a href="https://doi.org/10.1093/ajcn/51.2.241" target="_blank" rel="nofollow noopener">https://doi.org/10.1093/ajcn/51.2.241</a></li>
<li><strong>Calorie Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/calorie" target="_blank" rel="nofollow noopener">https://calcdomain.com/calorie</a></li>
<li><strong>Protein Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/protein-calculator" target="_blank" rel="nofollow noopener">https://calcdomain.com/protein-calculator</a></li>
<li><strong>Fat Intake Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/fat-intake" target="_blank" rel="nofollow noopener">https://calcdomain.com/fat-intake</a></li>
<li><strong>BMR Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/bmr" target="_blank" rel="nofollow noopener">https://calcdomain.com/bmr</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300×600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why use this calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Based on the scientifically-validated Mifflin-St Jeor formula.</li>
<li>Get calorie targets for weight loss, maintenance, or gain.</li>
<li>See 3 distinct diet plans (Balanced, Low Carb, High Carb).</li>
<li>Visualize your macro split with an interactive chart.</li>
<li>Fully accessible (WCAG 2.1 AA) and mobile-friendly.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Nutrition Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="https://calcdomain.com/calorie" class="text-blue-600 hover:underline">Calorie Calculator</a></li>
<li><a href="https://calcdomain.com/protein-calculator" class="text-blue-600 hover:underline">Protein Calculator</a></li>
<li><a href="https://calcdomain.com/fat-intake" class="text-blue-600 hover:underline">Fat Intake Calculator</a></li>
<li><a href="https://calcdomain.com/bmr" class="text-blue-600 hover:underline">BMR Calculator</a></li>
<li><a href="https://calcdomain.com/tdee" class="text-blue-600 hover:underline">TDEE Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>
























<script>
document.addEventListener('DOMContentLoaded', () => {
// --- Constants ---
const MACRO_PLANS = {
balanced: { name: 'Balanced', carbs: 0.40, protein: 0.30, fats: 0.30 },
lowCarb: { name: 'Low Carb', carbs: 0.25, protein: 0.40, fats: 0.35 },
highCarb: { name: 'High Carb (Athlete)', carbs: 0.55, protein: 0.25, fats: 0.20 }
};

// --- DOM Elements ---
const form = document.getElementById('carb-form');
const elements = {
unitMetric: document.getElementById('unit-metric'),
unitImperial: document.getElementById('unit-imperial'),
metricInputs: document.getElementById('metric-inputs'),
imperialInputs: document.getElementById('imperial-inputs'),
age: document.getElementById('age'),
sex: document.getElementById('sex'),
heightCm: document.getElementById('height-cm'),
weightKg: document.getElementById('weight-kg'),
heightFt: document.getElementById('height-ft'),
heightIn: document.getElementById('height-in'),
weightLbs: document.getElementById('weight-lbs'),
activity: document.getElementById('activity'),
goal: document.getElementById('goal'),
calculateBtn: document.getElementById('calculate-btn'),
resetBtn: document.getElementById('reset-btn'),
// Results
resultsSection: document.getElementById('results'),
bmrResult: document.getElementById('bmr-result'),
tdeeResult: document.getElementById('tdee-result'),
goalCaloriesResult: document.getElementById('goal-calories-result'),
scheduleBody: document.getElementById('scheduleBody')
};

let chartInstance = null;

// --- Helper Functions ---
const fmtNumber = (val) => new Intl.NumberFormat(undefined, { maximumFractionDigits: 0 }).format(val || 0);

// Toggle unit visibility
function toggleUnits() {
const isMetric = elements.unitMetric.checked;
elements.metricInputs.classList.toggle('hidden', !isMetric);
elements.metricInputs.setAttribute('aria-hidden', !isMetric);
elements.imperialInputs.classList.toggle('hidden', isMetric);
elements.imperialInputs.setAttribute('aria-hidden', isMetric);

// Set required status based on visibility
elements.heightCm.required = isMetric;
elements.weightKg.required = isMetric;
elements.heightFt.required = !isMetric;
elements.heightIn.required = !isMetric;
elements.weightLbs.required = !isMetric;
}

// Validate a single field
function validateField(input) {
const errorEl = document.getElementById(input.id + '-error');
if (!errorEl) return true;

let isValid = true;
let message = '';
const value = parseFloat(input.value);
const min = parseFloat(input.min);
const max = parseFloat(input.max);

if (input.required && !input.value) {
isValid = false;
message = 'This field is required.';
} else if (value < min || value > max) {
isValid = false;
message = `Please enter a value between ${min} and ${max}.`;
}

if (!isValid) {
input.setAttribute('aria-invalid', 'true');
input.setAttribute('aria-describedby', errorEl.id);
errorEl.textContent = message;
} else {
input.removeAttribute('aria-invalid');
input.removeAttribute('aria-describedby');
errorEl.textContent = '';
}
return isValid;
}

// Validate all active fields
function validateForm() {
let isFormValid = true;
const isMetric = elements.unitMetric.checked;
const inputsToValidate = [elements.age];

if (isMetric) {
inputsToValidate.push(elements.heightCm, elements.weightKg);
} else {
inputsToValidate.push(elements.heightFt, elements.heightIn, elements.weightLbs);
}

inputsToValidate.forEach(input => {
if (!validateField(input)) {
isFormValid = false;
}
});
return isFormValid;
}

// --- Main Calculation ---
function calculate() {
if (!validateForm()) {
elements.resultsSection.classList.add('hidden');
return;
}

// 1. Get and convert inputs
const isMetric = elements.unitMetric.checked;
const age = parseFloat(elements.age.value);
const sex = elements.sex.value;
const activityFactor = parseFloat(elements.activity.value);
const goalAdjustment = parseFloat(elements.goal.value);

let heightCm, weightKg;

if (isMetric) {
heightCm = parseFloat(elements.heightCm.value);
weightKg = parseFloat(elements.weightKg.value);
} else {
const ft = parseFloat(elements.heightFt.value) || 0;
const inches = parseFloat(elements.heightIn.value) || 0;
const lbs = parseFloat(elements.weightLbs.value);
heightCm = (ft * 30.48) + (inches * 2.54);
weightKg = lbs / 2.20462;
}

// 2. Calculate BMR (Mifflin-St Jeor)
let bmr;
if (sex === 'male') {
bmr = (10 * weightKg) + (6.25 * heightCm) - (5 * age) + 5;
} else {
bmr = (10 * weightKg) + (6.25 * heightCm) - (5 * age) - 161;
}

// 3. Calculate TDEE
const tdee = bmr * activityFactor;

// 4. Calculate Goal Calories
const goalCalories = tdee + goalAdjustment;

// 5. Update UI
updateOutputs(bmr, tdee, goalCalories);
}

// --- UI Update Functions ---
function updateOutputs(bmr, tdee, goalCalories) {
elements.bmrResult.textContent = fmtNumber(bmr);
elements.tdeeResult.textContent = fmtNumber(tdee);
elements.goalCaloriesResult.textContent = fmtNumber(goalCalories);

renderTable(goalCalories);
renderChart(goalCalories);

elements.resultsSection.classList.remove('hidden');
}

function renderTable(goalCalories) {
elements.scheduleBody.innerHTML = ''; // Clear previous results

Object.values(MACRO_PLANS).forEach(plan => {
const carbs_g = (goalCalories * plan.carbs) / 4;
const protein_g = (goalCalories * plan.protein) / 4;
const fat_g = (goalCalories * plan.fats) / 9;

const tr = document.createElement('tr');
tr.className = 'border-b border-gray-200 even:bg-gray-50';
tr.innerHTML = `
<td class="px-4 py-3 font-medium text-gray-900">${plan.name}</td>
<td class="px-4 py-3 text-right text-blue-700 font-bold">${fmtNumber(carbs_g)}g</td>
<td class="px-4 py-3 text-right">${fmtNumber(protein_g)}g</td>
<td class="px-4 py-3 text-right">${fmtNumber(fat_g)}g</td>
<td class="px-4 py-3 text-right text-gray-600">${plan.carbs * 100}% / ${plan.protein * 100}% / ${plan.fats * 100}%</td>
`;
elements.scheduleBody.appendChild(tr);
});
}

function renderChart(goalCalories) {
const ctx = document.getElementById('resultsChart');
if (!ctx) return;

// Use 'Balanced' plan for the default chart
const balancedPlan = MACRO_PLANS.balanced;
const carbCalories = goalCalories * balancedPlan.carbs;
const proteinCalories = goalCalories * balancedPlan.protein;
const fatCalories = goalCalories * balancedPlan.fats;

const data = {
labels: ['Carbs', 'Protein', 'Fat'],
datasets: [{
label: 'Calories',
data: [Math.max(0, carbCalories), Math.max(0, proteinCalories), Math.max(0, fatCalories)],
backgroundColor: ['#2563eb', '#f97316', '#eab308'] // Blue, Orange, Yellow
}]
};

if (chartInstance) {
chartInstance.data = data;
chartInstance.update();
} else {
chartInstance = new Chart(ctx, {
type: 'doughnut',
data: data,
options: {
plugins: {
legend: { position: 'bottom', labels: { boxWidth: 12, padding: 20 } },
tooltip: {
callbacks: {
label: function(context) {
let label = context.label || '';
if (label) {
label += ': ';
}
if (context.parsed !== null) {
label += fmtNumber(context.parsed) + ' kcal';
}
return label;
}
}
}
},
responsive: true,
maintainAspectRatio: false
}
});
}
}

// --- Event Listeners ---
// Listen for clicks on unit toggles
elements.unitMetric.addEventListener('change', toggleUnits);
elements.unitImperial.addEventListener('change', toggleUnits);

// Listen for "Calculate" button click
elements.calculateBtn.addEventListener('click', calculate);

// Real-time validation on blur
form.querySelectorAll('input[type="number"]').forEach(input => {
input.addEventListener('blur', () => validateField(input));
});

// Reset logic
elements.resetBtn.addEventListener('click', () => {
form.reset();
toggleUnits();
elements.resultsSection.classList.add('hidden');
// Clear all error messages
form.querySelectorAll('.error-message').forEach(el => el.textContent = '');
form.querySelectorAll('input[aria-invalid]').forEach(el => el.removeAttribute('aria-invalid'));
});

// Mobile menu toggle
const menuToggle = document.getElementById('mobile-menu-toggle');
const mobileMenu = document.getElementById('mobile-menu');
menuToggle.addEventListener('click', () => {
const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
menuToggle.setAttribute('aria-expanded', !isExpanded);
mobileMenu.classList.toggle('hidden');
});

// --- Initial State ---
toggleUnits();
// Perform an initial calculation on load with default values
calculate();
});
</script>


</body></html>
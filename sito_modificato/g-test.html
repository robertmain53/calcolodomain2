<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>G-test Calculator – Likelihood-Ratio Test for Counts</title>
    <meta name="description" content="G-test (likelihood-ratio) calculator for categorical data. Compute G statistic, degrees of freedom and p-value for goodness-of-fit and contingency tables, with step-by-step explanation and assumptions.">
    <link rel="canonical" href="https://calcdomain.com/g-test">
    
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .card-hover { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .formula-box { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; overflow-x: auto; margin: 1rem 0; }
        table.data-grid input[type="text"] { text-align: right; }
    </style>
    
    <!-- Google tag (gtag.js) -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7MB5V1LZRN');
    </script>

    <meta name="google-site-verification" content="_tiTZ9ivAdtXcAS9CMnTNJ549Sg39WVqP_ZFbWgglNA">

    <script src="https://cmp.gatekeeperconsent.com/min.js" data-cfasync="false"></script>
    <script src="https://the.gatekeeperconsent.com/cmp.min.js" data-cfasync="false"></script>

    <script async="" src="//www.ezojs.com/ezoic/sa.min.js"></script>
    <script>
        window.ezstandalone = window.ezstandalone || {};
        ezstandalone.cmd = ezstandalone.cmd || [];
    </script>

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://calcdomain.com"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Math & Conversions",
          "item": "https://calcdomain.com/categories/math-conversions"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Core Math Algebra",
          "item": "https://calcdomain.com/subcategories/core-math-algebra"
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is the G-test (likelihood-ratio test)?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The G-test is a likelihood-ratio test for categorical data. It compares observed counts with expected counts under a null hypothesis (such as a theoretical distribution or independence in a contingency table). The test statistic G = 2 * sum(O * ln(O/E)) is approximately chi-square distributed with appropriate degrees of freedom when sample sizes are not too small."
          }
        },
        {
          "@type": "Question",
          "name": "When should I use the G-test instead of the chi-square test?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Both the G-test and the Pearson chi-square test are asymptotically equivalent for large samples. The G-test is derived from likelihood theory and is often preferred in log-linear modeling or when likelihood methods are used elsewhere in the analysis. For small samples or cells with very low expected counts, exact or simulation-based methods may be more appropriate than either test."
          }
        },
        {
          "@type": "Question",
          "name": "What are the assumptions of the G-test?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Assumptions include: (1) observations are independent, (2) counts represent frequencies in mutually exclusive categories, and (3) expected cell counts are sufficiently large for the chi-square approximation to be reliable (a common rule of thumb is that most expected counts should be at least 5)."
          }
        },
        {
          "@type": "Question",
          "name": "How do I interpret the p-value of a G-test?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The p-value is the probability, under the null hypothesis, of obtaining a G statistic at least as extreme as the one observed. A small p-value (e.g. below 0.05) suggests that the observed pattern of counts is unlikely under the null hypothesis and provides evidence against it. The exact threshold and interpretation should follow your study design and field standards."
          }
        },
        {
          "@type": "Question",
          "name": "Is this G-test related to prenatal screening tests called G-test?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. This calculator implements the statistical G-test (likelihood-ratio test) for categorical data. It is not a medical or prenatal screening test and does not provide any clinical diagnosis or risk estimate."
          }
        }
      ]
    },
    {
      "@type": "HowTo",
      "name": "How to perform a G-test of independence",
      "description": "Step-by-step procedure to compute the G-test statistic and p-value for a contingency table.",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Enter your contingency table",
          "text": "Collect the observed counts for each combination of row and column categories and enter them into the contingency table."
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Compute expected counts under independence",
          "text": "For each cell, compute the expected count as (row total × column total) / grand total."
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Compute the G statistic",
          "text": "For each cell with positive observed and expected counts, compute 2 × O × ln(O / E) and sum over all cells to obtain the G statistic."
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Determine degrees of freedom",
          "text": "For an r × c contingency table, the degrees of freedom are (r − 1) × (c − 1)."
        },
        {
          "@type": "HowToStep",
          "position": 5,
          "name": "Obtain the p-value",
          "text": "Compare the G statistic to a chi-square distribution with the calculated degrees of freedom to obtain the p-value."
        }
      ]
    }
  ]
}
</script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
.auditspine-badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  border:1px solid #e5e7eb;
  background:#f8fafc;
  color:#0f172a;
}
.auditspine-badge-warn{
  background:#fff7ed;
  border-color:#fed7aa;
  color:#9a3412;
}
</style>
</head>

<body class="bg-gray-50 text-gray-800">

    <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939" crossorigin="anonymous"></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
              <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      
      <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo; <a href="https://calcdomain.com/categories/math-conversions" class="hover:text-blue-600">Math & Conversions</a> &raquo; <a href="https://calcdomain.com/subcategories/core-math-algebra" class="hover:text-blue-600">Core Math Algebra</a></nav>
      
      <div class="flex flex-col lg:flex-row gap-8">
        
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            
            <h1 class="text-2xl md:text-3xl font-bold mb-4">G-test Calculator (Likelihood-Ratio Test)</h1>
            <p class="text-gray-700 mb-2">
              This calculator implements the <strong>statistical G-test (likelihood-ratio test)</strong> for categorical data.
              It is <strong>not</strong> related to medical or prenatal screening products sometimes called “G-test”.
            </p>
            <p class="text-gray-700 mb-4">
              Use it to compute the G statistic, degrees of freedom and p-value for
              <strong>goodness-of-fit</strong> problems and <strong>contingency tables</strong> (tests of independence).
            </p>

            <!-- Calculator -->
            <section aria-labelledby="gtest-calculator" class="mb-8">
              <h2 id="gtest-calculator" class="text-xl font-semibold mb-3">G-test calculator</h2>

              <!-- Mode selector -->
              <div class="mb-4">
                <span class="block text-sm font-medium text-gray-700 mb-1">Test type</span>
                <div class="inline-flex flex-wrap gap-2 text-sm">
                  <button type="button" data-gmode="gof" class="gmode-btn px-3 py-1.5 rounded-full border border-blue-600 bg-blue-600 text-white font-medium">
                    Goodness-of-fit
                  </button>
                  <button type="button" data-gmode="indep" class="gmode-btn px-3 py-1.5 rounded-full border border-gray-300 bg-white text-gray-700">
                    Independence (contingency table)
                  </button>
                </div>
                <p class="text-xs text-gray-500 mt-1">
                  All inputs are counts (frequencies). Use comma or dot as decimal separator; counts are rounded to non-negative numbers.
                </p>
              </div>

              <!-- Goodness-of-fit form -->
              <div id="gof-panel" class="space-y-4">
                <div class="grid md:grid-cols-3 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" for="gof-k">
                      Number of categories
                    </label>
                    <input id="gof-k" type="number" min="2" max="10" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="4">
                    <p class="text-xs text-gray-500 mt-1">Between 2 and 10 categories.</p>
                  </div>
                  <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                      Expected pattern under H₀
                    </label>
                    <div class="space-y-1 text-sm">
                      <label class="inline-flex items-center mr-4">
                        <input type="radio" name="gof-expected-mode" value="equal" class="text-blue-600" checked="">
                        <span class="ml-2">Equal probabilities (uniform)</span>
                      </label>
                      <label class="inline-flex items-center">
                        <input type="radio" name="gof-expected-mode" value="custom" class="text-blue-600">
                        <span class="ml-2">Custom expected counts</span>
                      </label>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">
                      For “custom expected”, the calculator rescales your expected counts to match the total sample size.
                    </p>
                  </div>
                </div>

                <div class="grid gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                      Observed counts
                    </label>
                    <div id="gof-observed-row" class="flex flex-wrap gap-2"></div>
                  </div>
                  <div id="gof-expected-wrapper" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                      Expected counts (before rescaling)
                    </label>
                    <div id="gof-expected-row" class="flex flex-wrap gap-2"></div>
                  </div>
                </div>

                <div class="grid md:grid-cols-3 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" for="gof-free-params">
                      Parameters estimated from data
                    </label>
                    <input id="gof-free-params" type="number" min="0" step="1" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="0">
                    <p class="text-xs text-gray-500 mt-1">
                      df = k − 1 − parameters. For many textbook problems this is 0.
                    </p>
                  </div>
                  <div class="md:col-span-2">
                    <label class="block text-xs text-gray-700 mb-1" for="gof-context">
                      Context / variable (optional)
                    </label>
                    <input id="gof-context" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g. genotype categories, defect types, response options…">
                  </div>
                </div>
              </div>

              <!-- Independence form -->
              <div id="indep-panel" class="space-y-4 hidden">
                <div class="grid md:grid-cols-3 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" for="indep-rows">
                      Rows (r)
                    </label>
                    <input id="indep-rows" type="number" min="2" max="6" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="2">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" for="indep-cols">
                      Columns (c)
                    </label>
                    <input id="indep-cols" type="number" min="2" max="6" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="2">
                  </div>
                  <div class="flex items-end">
                    <button id="indep-build" type="button" class="w-full inline-flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-800 text-sm font-medium rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500">
                      Build table
                    </button>
                  </div>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">
                    Observed counts (contingency table)
                  </label>
                  <div id="indep-table-wrapper" class="overflow-auto">
                    <!-- table injected here -->
                  </div>
                  <p class="text-xs text-gray-500 mt-1">
                    Each cell must be a non-negative count. Empty cells are treated as zero.
                  </p>
                </div>

                <div>
                  <label class="block text-xs text-gray-700 mb-1" for="indep-context">
                    Row / column variables (optional)
                  </label>
                  <input id="indep-context" type="text" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g. treatment × outcome, gender × preference…">
                </div>
              </div>

              <!-- Buttons -->
              <div class="flex flex-wrap items-center gap-3 mt-4 mb-3">
                <button id="btn-gtest-calc" type="button" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Calculate G-test
                </button>
                <button id="btn-gtest-clear" type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Clear
                </button>
                <p class="text-xs text-gray-500">
                  Output uses the chi-square approximation to obtain the p-value.
                </p>
              </div>

              <p id="gtest-error-message" class="text-sm text-red-600 mb-3 hidden"></p>

              <!-- Results -->
              <div id="gtest-results-container" class="grid md:grid-cols-2 gap-4 mb-4 hidden">
                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="text-sm font-semibold text-gray-700 mb-2">Test statistic</h3>
                  <p class="text-xs text-gray-500 mb-1">
                    Likelihood-ratio G statistic and chi-square approximation.
                  </p>
                  <p class="text-3xl font-bold text-blue-600 mb-1">
                    G = <span id="gtest-G-main">0.000</span>
                  </p>
                  <p class="text-sm text-gray-700 mb-1">
                    Degrees of freedom: <span id="gtest-df">–</span>
                  </p>
                  <p class="text-sm text-gray-700">
                    p-value (right-tail): <span id="gtest-pvalue">–</span>
                  </p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="text-sm font-semibold text-gray-700 mb-2">Details</h3>
                  <dl class="text-sm text-gray-700 space-y-1">
                    <div class="flex justify-between">
                      <dt>Test type</dt>
                      <dd id="gtest-type-label">–</dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Total sample size</dt>
                      <dd id="gtest-n">–</dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Model under H₀</dt>
                      <dd id="gtest-model-label">–</dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Approximation</dt>
                      <dd>Chi-square distribution</dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Warning flags</dt>
                      <dd id="gtest-warnings">none</dd>
                    </div>
                  </dl>
                </div>
              </div>

              <!-- Step-by-step explanation -->
              <div id="gtest-steps-container" class="border border-blue-100 bg-blue-50 rounded-lg p-4 text-sm text-gray-800 hidden">
                <h3 class="font-semibold mb-2">Step-by-step calculation</h3>
                <ol class="list-decimal list-inside space-y-1" id="gtest-steps-list">
                  <!-- filled dynamically -->
                </ol>
              </div>
            </section>

            <!-- Theory & explanations -->
            <section class="prose">
              <h2>G-test formula (likelihood-ratio test)</h2>
              <p>
                The <strong>G-test</strong> compares observed counts with expected counts under a null hypothesis.
                The test statistic is
              </p>

              <div class="formula-box text-sm">
                <p class="font-mono mb-0">
                  \( G = 2 \sum_i O_i \ln\left(\dfrac{O_i}{E_i}\right) \)
                </p>
                <ul class="list-disc pl-4 mb-0">
                  <li>\( O_i \) = observed count in cell i</li>
                  <li>\( E_i \) = expected count in cell i under the null hypothesis</li>
                </ul>
              </div>

              <p>
                For contingency tables, the sum runs over all cells \((i, j)\) and the same formula applies:
              </p>

              <div class="formula-box text-sm">
                <p class="font-mono mb-0">
                  \( G = 2 \sum_{i,j} O_{ij} \ln\left(\dfrac{O_{ij}}{E_{ij}}\right) \)
                </p>
              </div>

              <p>
                Under standard conditions (independent observations, not-too-small expected counts), G is approximately
                chi-square distributed with the same degrees of freedom as the corresponding chi-square test.
              </p>

              <h2>G-test for goodness-of-fit</h2>
              <p>
                In a <strong>goodness-of-fit</strong> setting you test whether observed frequencies follow a
                specific theoretical distribution (uniform, binomial, Poisson, etc.) or specified probabilities.
                You provide:
              </p>
              <ul>
                <li>observed counts \( O_1, \dots, O_k \)</li>
                <li>expected pattern under the null \( E_1, \dots, E_k \) (or probabilities)</li>
              </ul>
              <p>
                The degrees of freedom are typically \( k - 1 - m \), where \( k \) is the number of categories and
                \( m \) is the number of parameters estimated from the data (for example, estimating a mean or rate).
              </p>

              <h2>G-test of independence (contingency table)</h2>
              <p>
                For an \( r \times c \) contingency table of counts, the null hypothesis is that the row and column
                variables are <strong>independent</strong>. The expected count in cell \((i,j)\) is
              </p>

              <div class="formula-box text-sm">
                <p class="font-mono mb-0">
                  \( E_{ij} = \dfrac{(\text{row total}_i) \cdot (\text{column total}_j)}{\text{grand total}} \)
                </p>
              </div>

              <p>
                The degrees of freedom are
                \( \text{df} = (r - 1)(c - 1) \), exactly as for the Pearson chi-square test of independence.
              </p>

              <h2>G-test vs chi-square test</h2>
              <p>
                The Pearson chi-square test uses the statistic
                \( \chi^2 = \sum (O - E)^2 / E \), whereas the G-test uses
                the likelihood-ratio statistic \( G = 2 \sum O \ln(O/E) \).
                For large samples they are <strong>asymptotically equivalent</strong> and usually lead
                to very similar p-values.
              </p>

              <ul>
                <li>
                  The G-test arises naturally from likelihood-ratio principles and is convenient in
                  <strong>log-linear models</strong> and generalized linear modeling.
                </li>
                <li>
                  The chi-square test is more familiar and historically widespread in introductory courses.
                </li>
                <li>
                  For small samples, both tests rely on approximations; exact or Monte Carlo methods
                  are often recommended.
                </li>
              </ul>

              <h2>Assumptions and common pitfalls</h2>
              <ul>
                <li>
                  <strong>Independence</strong>: Each observation contributes to exactly one cell and does not
                  depend on other observations.
                </li>
                <li>
                  <strong>Expected counts</strong>: Expected cell counts should not be too small
                  (rules of thumb often require most \( E_i \) ≥ 5).
                </li>
                <li>
                  <strong>Sparse tables</strong>: Many structural zeros or very sparse tables may violate
                  the chi-square approximation; consider exact tests or specialized modeling.
                </li>
              </ul>

              <p class="text-sm text-gray-600">
                <strong>Important:</strong> This page concerns the statistical G-test for categorical data.
                It is not intended for medical diagnostics or prenatal screening and does not replace professional advice.
              </p>

              <h2 id="gtest-faq">G-test – frequently asked questions</h2>

              <div class="mt-4 space-y-3">
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">What happens if some observed counts are zero?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      Cells with <em>O = 0</em> contribute 0 to the G statistic because the limiting value of
                      \( O \ln(O/E) \) as \( O \to 0 \) is zero. The calculator handles such cells automatically.
                      However, many zeros may indicate that the data are too sparse for the chi-square approximation
                      to be reliable.
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">Can I enter probabilities instead of expected counts?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      If you enter expected values that are proportional to the desired probabilities, the
                      calculator rescales them to match the total sample size. For example, entering 1:2:1 and
                      observing 80 cases leads to expected counts of 20:40:20.
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">Is the p-value exact?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      No. The p-value is based on the chi-square approximation to the sampling distribution of the
                      G statistic. For large samples this is typically accurate; for very small or sparse samples,
                      exact tests or resampling approaches may be preferable.
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <button type="button" class="w-full text-left faq-question px-4 py-3 flex items-center justify-between">
                    <span class="font-medium text-gray-800">How do I report the results of a G-test?</span>
                    <span class="ml-2 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer px-4 pb-4 pt-1 text-sm text-gray-700 hidden">
                    <p>
                      A typical format is: “G(df = X) = value, p = value”, together with a brief description of the
                      variables and whether the result provides evidence against the null hypothesis. Always describe
                      your data structure and any important assumptions or limitations.
                    </p>
                  </div>
                </div>
              </div>
            </section>

          </div>
        
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\\]</div>
  <pre class="auditspine-mono">','\</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( G = 2 \sum_i O_i \ln\left(\dfrac{O_i}{E_i}\right) \) \( O_i \) = observed count in cell i \( E_i \) = expected count in cell i under the null hypothesis</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( G = 2 \sum_{i,j} O_{ij} \ln\left(\dfrac{O_{ij}}{E_{ij}}\right) \)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\( E_{ij} = \dfrac{(\text{row total}_i) \cdot (\text{column total}_j)}{\text{grand total}} \)</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>NIST — Weights and measures</strong> — nist.gov · Accessed 2026-01-19<br><a href="https://www.nist.gov/pml/weights-and-measures" target="_blank" rel="nofollow noopener">https://www.nist.gov/pml/weights-and-measures</a></li>
<li><strong>FTC — Consumer advice</strong> — consumer.ftc.gov · Accessed 2026-01-19<br><a href="https://consumer.ftc.gov/" target="_blank" rel="nofollow noopener">https://consumer.ftc.gov/</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main>
        
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">Core Math &amp; Algebra tools</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a href="https://calcdomain.com/standard-form" class="text-blue-600 hover:underline">
                  Standard Form Calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/percent-error-calculator" class="text-blue-600 hover:underline">
                  Percent Error Calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/cohen-s-d-calculator" class="text-blue-600 hover:underline">
                  Effect Size (Cohen’s d)
                </a>
              </li>
              <li>
                <span class="text-gray-500">
                  G-test (likelihood-ratio test) – you are here
                </span>
              </li>
              <li>
                <a href="https://calcdomain.com/stem-and-leaf-plot" class="text-blue-600 hover:underline">
                  Stem-and-Leaf Plot Generator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/bisection-method" class="text-blue-600 hover:underline">
                  Bisection Method Solver
                </a>
              </li>
            </ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">More statistics calculators</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a href="https://calcdomain.com/t-test" class="text-blue-600 hover:underline">
                  t-test Calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/z-score" class="text-blue-600 hover:underline">
                  Z-score Calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/confidence-interval" class="text-blue-600 hover:underline">
                  Confidence Interval Calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/standard-error" class="text-blue-600 hover:underline">
                  Standard Error Calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/sample-size" class="text-blue-600 hover:underline">
                  Sample Size Calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/correlation-coefficient" class="text-blue-600 hover:underline">
                  Correlation Coefficient
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/one-way-anova" class="text-blue-600 hover:underline">
                  One-way ANOVA
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/kruskal-wallis-test" class="text-blue-600 hover:underline">
                  Kruskal–Wallis Test
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/cohen-s-kappa-calculator" class="text-blue-600 hover:underline">
                  Cohen’s Kappa
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/regression-calculator" class="text-blue-600 hover:underline">
                  Regression Calculator
                </a>
              </li>
            </ul>
          </div>
        </aside>
        
      </div>
    </div>

    <footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>


















    
    <script src="/assets/js/script_menu.js" defer=""></script>
    <script src="/assets/js/script_faq.js" defer=""></script>
    <script src="search.js" defer=""></script>
    
    <script>
      // ---------- Generic helpers ----------
      function parseCount(value) {
        if (value == null) return 0;
        const normalized = String(value).replace(/\\s+/g, '').replace(',', '.');
        if (normalized === '') return 0;
        const num = Number(normalized);
        if (!Number.isFinite(num)) return NaN;
        // counts should be >= 0; round to nearest
        return Math.max(0, Math.round(num));
      }

      function formatNumberSmart(value, decimalsDefault = 3) {
        if (!Number.isFinite(value)) return '–';
        const abs = Math.abs(value);
        if (abs === 0) return '0';
        if (abs >= 100000 || abs < 1e-4) {
          return value.toExponential(3);
        }
        return value.toFixed(decimalsDefault).replace(/\\.0+$/, '').replace(/(\\.\\d*?)0+$/, '$1');
      }

      // ---------- Chi-square CDF via regularized gamma ----------
      // Lanczos approximation for log-gamma
      function gammaln(z) {
        const cof = [
          76.18009172947146,
          -86.50532032941677,
          24.01409824083091,
          -1.231739572450155,
          0.1208650973866179e-2,
          -0.5395239384953e-5
        ];
        let x = z;
        let y = z;
        let tmp = x + 5.5;
        tmp -= (x + 0.5) * Math.log(tmp);
        let ser = 1.000000000190015;
        for (let j = 0; j < cof.length; j++) {
          y += 1;
          ser += cof[j] / y;
        }
        return -tmp + Math.log(2.5066282746310005 * ser / x);
      }

      // Regularized lower incomplete gamma P(a, x)
      function regularizedGammaP(a, x) {
        if (x < 0 || a <= 0) return NaN;
        if (x === 0) return 0;
        const eps = 1e-10;
        const maxIter = 100;

        if (x < a + 1) {
          // series expansion
          let ap = a;
          let sum = 1 / a;
          let del = sum;
          for (let n = 1; n <= maxIter; n++) {
            ap += 1;
            del *= x / ap;
            sum += del;
            if (Math.abs(del) < Math.abs(sum) * eps) {
              break;
            }
          }
          return sum * Math.exp(-x + a * Math.log(x) - gammaln(a));
        } else {
          // continued fraction Q(a,x), then P = 1 - Q
          let b = x + 1 - a;
          let c = 1 / 1e-30;
          let d = 1 / b;
          let h = d;
          for (let n = 1; n <= maxIter; n++) {
            const an = -n * (n - a);
            b += 2;
            d = an * d + b;
            if (Math.abs(d) < 1e-30) d = 1e-30;
            c = b + an / c;
            if (Math.abs(c) < 1e-30) c = 1e-30;
            d = 1 / d;
            const delta = d * c;
            h *= delta;
            if (Math.abs(delta - 1) < eps) {
              break;
            }
          }
          const Q = Math.exp(-x + a * Math.log(x) - gammaln(a)) * h;
          return 1 - Q;
        }
      }

      function chiSquareCDF(x, k) {
        if (x < 0 || k <= 0) return 0;
        return regularizedGammaP(k / 2, x / 2);
      }

      // ---------- Mode switching ----------
      (function () {
        const modeButtons = document.querySelectorAll('.gmode-btn');
        const gofPanel = document.getElementById('gof-panel');
        const indepPanel = document.getElementById('indep-panel');

        function setMode(mode) {
          modeButtons.forEach(btn => {
            const m = btn.getAttribute('data-gmode');
            const active = m === mode;
            btn.classList.toggle('bg-blue-600', active);
            btn.classList.toggle('text-white', active);
            btn.classList.toggle('border-blue-600', active);
            btn.classList.toggle('bg-white', !active);
            btn.classList.toggle('text-gray-700', !active);
            btn.classList.toggle('border-gray-300', !active);
          });

          gofPanel.classList.toggle('hidden', mode !== 'gof');
          indepPanel.classList.toggle('hidden', mode !== 'indep');

          document.getElementById('gtest-error-message').classList.add('hidden');
        }

        modeButtons.forEach(btn => {
          btn.addEventListener('click', () => {
            setMode(btn.getAttribute('data-gmode'));
          });
        });

        setMode('gof'); // default
      })();

      // ---------- Goodness-of-fit dynamic inputs ----------
      (function () {
        const kInput = document.getElementById('gof-k');
        const obsRow = document.getElementById('gof-observed-row');
        const expRow = document.getElementById('gof-expected-row');
        const expWrapper = document.getElementById('gof-expected-wrapper');
        const expectedRadios = document.querySelectorAll('input[name="gof-expected-mode"]');

        function buildInputs() {
          let k = parseInt(kInput.value, 10);
          if (!Number.isFinite(k) || k < 2) k = 2;
          if (k > 10) k = 10;
          kInput.value = String(k);

          obsRow.innerHTML = '';
          expRow.innerHTML = '';

          for (let i = 0; i < k; i++) {
            const obs = document.createElement('input');
            obs.type = 'text';
            obs.inputMode = 'decimal';
            obs.className = 'w-16 border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500';
            obs.placeholder = 'O' + (i + 1);
            obs.dataset.index = i;
            obsRow.appendChild(obs);

            const exp = document.createElement('input');
            exp.type = 'text';
            exp.inputMode = 'decimal';
            exp.className = 'w-16 border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500';
            exp.placeholder = 'E' + (i + 1);
            exp.dataset.index = i;
            expRow.appendChild(exp);
          }
        }

        expectedRadios.forEach(r => {
          r.addEventListener('change', () => {
            const mode = document.querySelector('input[name="gof-expected-mode"]:checked').value;
            expWrapper.classList.toggle('hidden', mode !== 'custom');
          });
        });

        kInput.addEventListener('change', buildInputs);
        kInput.addEventListener('keyup', buildInputs);

        buildInputs(); // init
      })();

      // ---------- Contingency table dynamic inputs ----------
      (function () {
        const rowsInput = document.getElementById('indep-rows');
        const colsInput = document.getElementById('indep-cols');
        const buildBtn = document.getElementById('indep-build');
        const tableWrapper = document.getElementById('indep-table-wrapper');

        function buildTable() {
          let r = parseInt(rowsInput.value, 10);
          let c = parseInt(colsInput.value, 10);
          if (!Number.isFinite(r) || r < 2) r = 2;
          if (r > 6) r = 6;
          if (!Number.isFinite(c) || c < 2) c = 2;
          if (c > 6) c = 6;
          rowsInput.value = String(r);
          colsInput.value = String(c);

          const table = document.createElement('table');
          table.className = 'data-grid border border-gray-200 text-sm';
          const tbody = document.createElement('tbody');

          for (let i = 0; i < r; i++) {
            const tr = document.createElement('tr');
            for (let j = 0; j < c; j++) {
              const td = document.createElement('td');
              td.className = 'border border-gray-200 p-1';
              const input = document.createElement('input');
              input.type = 'text';
              input.inputMode = 'decimal';
              input.className = 'w-16 border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500';
              input.placeholder = 'c' + (i + 1) + ',' + (j + 1);
              input.dataset.row = i;
              input.dataset.col = j;
              td.appendChild(input);
              tr.appendChild(td);
            }
            tbody.appendChild(tr);
          }

          table.appendChild(tbody);
          tableWrapper.innerHTML = '';
          tableWrapper.appendChild(table);
        }

        buildBtn.addEventListener('click', buildTable);
        buildTable(); // init
      })();

      // ---------- G-test calculations ----------
      (function () {
        const btnCalc = document.getElementById('btn-gtest-calc');
        const btnClear = document.getElementById('btn-gtest-clear');
        const errorMessage = document.getElementById('gtest-error-message');

        const resultsContainer = document.getElementById('gtest-results-container');
        const stepsContainer = document.getElementById('gtest-steps-container');
        const stepsList = document.getElementById('gtest-steps-list');

        const GMainEl = document.getElementById('gtest-G-main');
        const dfEl = document.getElementById('gtest-df');
        const pEl = document.getElementById('gtest-pvalue');
        const typeLabelEl = document.getElementById('gtest-type-label');
        const nEl = document.getElementById('gtest-n');
        const modelLabelEl = document.getElementById('gtest-model-label');
        const warningsEl = document.getElementById('gtest-warnings');

        function getMode() {
          const active = document.querySelector('.gmode-btn.bg-blue-600');
          return active ? active.getAttribute('data-gmode') : 'gof';
        }

        function computeGof() {
          const k = parseInt(document.getElementById('gof-k').value, 10);
          const params = parseInt(document.getElementById('gof-free-params').value || '0', 10) || 0;
          const context = document.getElementById('gof-context').value.trim();
          const expectedMode = document.querySelector('input[name="gof-expected-mode"]:checked').value;
          const obsInputs = document.querySelectorAll('#gof-observed-row input');
          const expInputs = document.querySelectorAll('#gof-expected-row input');

          if (!Number.isFinite(k) || k < 2) {
            throw new Error('Number of categories must be at least 2.');
          }
          if (params < 0) {
            throw new Error('Parameters estimated from data cannot be negative.');
          }

          const O = [];
          for (let i = 0; i < obsInputs.length; i++) {
            const v = parseCount(obsInputs[i].value);
            if (!Number.isFinite(v)) {
              throw new Error('Observed counts must be numeric.');
            }
            O.push(v);
          }
          if (O.length < 2) {
            throw new Error('Please provide at least two observed counts.');
          }
          const totalN = O.reduce((a, b) => a + b, 0);
          if (totalN === 0) {
            throw new Error('Total sample size must be greater than zero.');
          }

          let E = [];
          let modelLabel = '';
          if (expectedMode === 'equal') {
            const equal = totalN / O.length;
            E = O.map(() => equal);
            modelLabel = 'Uniform distribution (equal probabilities)';
          } else {
            const raw = [];
            for (let i = 0; i < expInputs.length; i++) {
              const v = parseCount(expInputs[i].value);
              if (!Number.isFinite(v)) {
                throw new Error('Expected counts must be numeric (or proportional values).');
              }
              raw.push(v);
            }
            const sumRaw = raw.reduce((a, b) => a + b, 0);
            if (sumRaw === 0) {
              throw new Error('At least one expected value must be positive.');
            }
            const scale = totalN / sumRaw;
            E = raw.map(v => v * scale);
            modelLabel = 'Custom expected pattern (rescaled to total N)';
          }

          const df = (O.length - 1) - params;
          if (df <= 0) {
            throw new Error('Degrees of freedom k − 1 − parameters must be positive. Reduce the number of parameters.');
          }

          let G = 0;
          let smallExpected = false;
          for (let i = 0; i < O.length; i++) {
            const o = O[i];
            const e = E[i];
            if (e <= 0) {
              throw new Error('Expected counts must be positive for all categories.');
            }
            if (e < 5) smallExpected = true;
            if (o > 0) {
              G += 2 * o * Math.log(o / e);
            }
          }

          const p = 1 - chiSquareCDF(G, df);
          const warnings = [];
          if (smallExpected) {
            warnings.push('some expected counts < 5');
          }
          if (p < 0 || p > 1 || !Number.isFinite(p)) {
            warnings.push('p-value approximation may be unstable');
          }

          const steps = [];
          steps.push(`Total sample size: N = ${totalN}.`);
          steps.push(`Compute expected counts under H₀ (${modelLabel}).`);
          steps.push('For each category i, calculate the term 2 · Oᵢ · ln(Oᵢ / Eᵢ). If Oᵢ = 0, the contribution is 0.');
          steps.push(`Sum the contributions to obtain G ≈ ${formatNumberSmart(G)}.`);
          steps.push(`Degrees of freedom: df = k − 1 − parameters = ${O.length} − 1 − ${params} = ${df}.`);
          steps.push('Compute the p-value as the right-tail probability of a chi-square(df) distribution above G.');

          return {
            G,
            df,
            p,
            n: totalN,
            typeLabel: 'Goodness-of-fit',
            modelLabel: modelLabel,
            warnings: warnings,
            steps: steps
          };
        }

        function computeIndep() {
          const r = parseInt(document.getElementById('indep-rows').value, 10);
          const c = parseInt(document.getElementById('indep-cols').value, 10);
          const context = document.getElementById('indep-context').value.trim();
          const inputs = document.querySelectorAll('#indep-table-wrapper input');

          // Build matrix
          const O = [];
          for (let i = 0; i < r; i++) {
            const row = [];
            for (let j = 0; j < c; j++) {
              const input = Array.from(inputs).find(el => parseInt(el.dataset.row, 10) === i && parseInt(el.dataset.col, 10) === j);
              const v = parseCount(input ? input.value : '');
              if (!Number.isFinite(v)) {
                throw new Error('All contingency table cells must be numeric counts.');
              }
              row.push(v);
            }
            O.push(row);
          }

          const rowTotals = O.map(row => row.reduce((a, b) => a + b, 0));
          const colTotals = [];
          for (let j = 0; j < c; j++) {
            let sum = 0;
            for (let i = 0; i < r; i++) sum += O[i][j];
            colTotals.push(sum);
          }
          const totalN = rowTotals.reduce((a, b) => a + b, 0);
          if (totalN === 0) {
            throw new Error('Total sample size must be greater than zero.');
          }

          const E = [];
          for (let i = 0; i < r; i++) {
            const rowE = [];
            for (let j = 0; j < c; j++) {
              rowE.push((rowTotals[i] * colTotals[j]) / totalN);
            }
            E.push(rowE);
          }

          const df = (r - 1) * (c - 1);
          if (df <= 0) {
            throw new Error('Degrees of freedom (r − 1)(c − 1) must be positive.');
          }

          let G = 0;
          let smallExpected = false;
          for (let i = 0; i < r; i++) {
            for (let j = 0; j < c; j++) {
              const o = O[i][j];
              const e = E[i][j];
              if (e <= 0) {
                throw new Error('All expected cell counts must be positive. Check for empty rows/columns.');
              }
              if (e < 5) smallExpected = true;
              if (o > 0) {
                G += 2 * o * Math.log(o / e);
              }
            }
          }

          const p = 1 - chiSquareCDF(G, df);
          const warnings = [];
          if (smallExpected) {
            warnings.push('some expected counts < 5');
          }
          if (p < 0 || p > 1 || !Number.isFinite(p)) {
            warnings.push('p-value approximation may be unstable');
          }

          const steps = [];
          steps.push(`Total sample size: N = ${totalN}.`);
          steps.push('Compute row and column totals, then for each cell use Eᵢⱼ = (row totalᵢ × column totalⱼ) / N.');
          steps.push('For each cell with Oᵢⱼ > 0, compute 2 · Oᵢⱼ · ln(Oᵢⱼ / Eᵢⱼ) and sum over all cells to obtain G.');
          steps.push(`G ≈ ${formatNumberSmart(G)} with df = (r − 1)(c − 1) = (${r} − 1)(${c} − 1) = ${df}.`);
          steps.push('Compute the p-value as the chi-square(df) right-tail probability above G.');

          const modelLabel = 'Independence between row and column variables';

          return {
            G,
            df,
            p,
            n: totalN,
            typeLabel: 'Independence (contingency table)',
            modelLabel: modelLabel,
            warnings: warnings,
            steps: steps
          };
        }

        btnCalc.addEventListener('click', function () {
          errorMessage.textContent = '';
          errorMessage.classList.add('hidden');

          let res;
          try {
            const mode = getMode();
            if (mode === 'gof') {
              res = computeGof();
            } else {
              res = computeIndep();
            }
          } catch (err) {
            errorMessage.textContent = err.message || 'Unable to compute G-test. Please check your inputs.';
            errorMessage.classList.remove('hidden');
            resultsContainer.classList.add('hidden');
            stepsContainer.classList.add('hidden');
            return;
          }

          GMainEl.textContent = formatNumberSmart(res.G);
          dfEl.textContent = formatNumberSmart(res.df, 0);
          if (res.p < 0 || res.p > 1 || !Number.isFinite(res.p)) {
            pEl.textContent = 'approximation failed';
          } else {
            pEl.textContent = formatNumberSmart(res.p, 4);
          }
          typeLabelEl.textContent = res.typeLabel;
          nEl.textContent = res.n;
          modelLabelEl.textContent = res.modelLabel;
          warningsEl.textContent = res.warnings.length ? res.warnings.join('; ') : 'none';

          // steps
          stepsList.innerHTML = '';
          res.steps.forEach(step => {
            const li = document.createElement('li');
            li.textContent = step;
            stepsList.appendChild(li);
          });

          resultsContainer.classList.remove('hidden');
          stepsContainer.classList.remove('hidden');
        });

        btnClear.addEventListener('click', function () {
          // clear goodness-of-fit fields
          document.getElementById('gof-context').value = '';
          document.getElementById('gof-free-params').value = '0';
          document.querySelectorAll('#gof-observed-row input, #gof-expected-row input').forEach(el => el.value = '');
          document.getElementById('gof-k').value = '4';

          // clear independence fields
          document.getElementById('indep-context').value = '';
          document.getElementById('indep-rows').value = '2';
          document.getElementById('indep-cols').value = '2';
          document.getElementById('indep-build').click();

          errorMessage.textContent = '';
          errorMessage.classList.add('hidden');
          resultsContainer.classList.add('hidden');
          stepsContainer.classList.add('hidden');
        });
      })();

      // Simple mobile menu toggle
      (function () {
        const toggle = document.getElementById('mobile-menu-toggle');
        const menu = document.getElementById('mobile-menu');
        if (!toggle || !menu) return;

        toggle.addEventListener('click', function () {
          const isOpen = !menu.classList.contains('hidden');
          menu.classList.toggle('hidden', isOpen);
          toggle.setAttribute('aria-expanded', String(!isOpen));
        });
      })();
    </script>

    <script>
      window.MathJax = {
        tex: { inlineMath: [['\\(','\\)'], ['$', '$']], displayMath: [['$','$'], ['\\[','\\]']] },
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    


</body></html>
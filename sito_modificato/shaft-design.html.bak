<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/shaft-design" />
    <title>Shaft Design Calculator Guide [Insider 2024] | CalcDomain</title>
    <meta name="description" content="Calculate Shaft Design Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Fast, reliable results." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Shaft Design Calculator Guide [Insider 2024] | CalcDomain" />
    <meta property="og:description" content="Calculate Shaft Design Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Fast, reliable results." />
    <meta property="og:url" content="https://calcdomain.com/shaft-design" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Shaft Design Calculator Guide [Insider 2024] | CalcDomain" />
    <meta name="twitter:description" content="Calculate Shaft Design Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Fast, reliable results." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Engineering Calculators", "item": "https://calcdomain.com/categories/engineering"}, {"@type": "ListItem", "position": 3, "name": "Mechanical Engineering Calculators", "item": "https://calcdomain.com/subcategories/mechanical-engineering"}, {"@type": "ListItem", "position": 4, "name": "Shaft Design Calculator", "item": "https://calcdomain.com/shaft-design"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/engineering" class="text-blue-600 hover:underline">Engineering Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/mechanical-engineering" class="text-blue-600 hover:underline">Mechanical Engineering Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Shaft Design Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl font-bold text-gray-900 mb-2">
                Shaft Design Calculator
              </h1>
              <p class="text-gray-600 text-sm mb-2">
                Size circular shafts under combined bending and torsion. Check
                diameter, stresses, safety factors, and deflection using
                standard design formulas.
              </p>
              <div class="flex flex-wrap items-center gap-2">
                <span class="badge">Mechanical Engineering</span>
                <span class="badge">Combined Loading</span>
                <span class="badge">Static &amp; Fatigue</span>
              </div>
            </header>

            <!-- Calculator UI -->
            <section aria-labelledby="shaft-calculator" class="mb-8">
              <h2
                id="shaft-calculator"
                class="text-xl font-semibold text-gray-800 mb-4"
              >
                Shaft Design Input
              </h2>

              <!-- Unit system -->
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >Unit system</label
                >
                <div class="flex items-center gap-4">
                  <label class="inline-flex items-center text-sm">
                    <input
                      type="radio"
                      name="unitSystem"
                      value="si"
                      class="mr-2"
                      checked
                    />
                    SI (N, mm, MPa)
                  </label>
                  <label class="inline-flex items-center text-sm">
                    <input
                      type="radio"
                      name="unitSystem"
                      value="us"
                      class="mr-2"
                    />
                    US (lbf, in, ksi)
                  </label>
                </div>
              </div>

              <!-- Loads -->
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="input-label" for="torque"
                    >Torque T<span class="input-unit" id="torque-unit"
                      >(N·mm)</span
                    ></label
                  >
                  <input
                    id="torque"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 5e5"
                  />
                </div>
                <div>
                  <label class="input-label" for="bending"
                    >Bending moment M<span class="input-unit" id="bending-unit"
                      >(N·mm)</span
                    ></label
                  >
                  <input
                    id="bending"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 3e5"
                  />
                </div>
              </div>

              <!-- Material -->
              <div class="grid md:grid-cols-3 gap-4 mb-4">
                <div>
                  <label class="input-label" for="sy"
                    >Yield strength S<sub>y</sub
                    ><span class="input-unit" id="sy-unit">(MPa)</span></label
                  >
                  <input
                    id="sy"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 250"
                  />
                </div>
                <div>
                  <label class="input-label" for="sut"
                    >Ultimate strength S<sub>ut</sub
                    ><span class="input-unit" id="sut-unit">(MPa)</span></label
                  >
                  <input
                    id="sut"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 450"
                  />
                </div>
                <div>
                  <label class="input-label" for="se"
                    >Endurance limit S<sub>e</sub
                    ><span class="input-unit" id="se-unit">(MPa)</span></label
                  >
                  <input
                    id="se"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 200"
                  />
                </div>
              </div>

              <!-- Safety factors -->
              <div class="grid md:grid-cols-3 gap-4 mb-4">
                <div>
                  <label class="input-label" for="fos-static"
                    >Required static FOS</label
                  >
                  <input
                    id="fos-static"
                    type="number"
                    class="input-field"
                    value="2"
                  />
                </div>
                <div>
                  <label class="input-label" for="fos-fatigue"
                    >Required fatigue FOS</label
                  >
                  <input
                    id="fos-fatigue"
                    type="number"
                    class="input-field"
                    value="1.5"
                  />
                </div>
                <div>
                  <label class="input-label" for="load-type"
                    >Loading type</label
                  >
                  <select id="load-type" class="input-field">
                    <option value="static">Static / low-cycle</option>
                    <option value="reversing">
                      Fully reversed bending + steady torque
                    </option>
                  </select>
                </div>
              </div>

              <!-- Geometry & stiffness -->
              <div class="grid md:grid-cols-3 gap-4 mb-4">
                <div>
                  <label class="input-label" for="length"
                    >Shaft span length L<span
                      class="input-unit"
                      id="length-unit"
                      >(mm)</span
                    ></label
                  >
                  <input
                    id="length"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 600"
                  />
                </div>
                <div>
                  <label class="input-label" for="gmod"
                    >Shear modulus G<span class="input-unit" id="gmod-unit"
                      >(GPa)</span
                    ></label
                  >
                  <input
                    id="gmod"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 80"
                  />
                </div>
                <div>
                  <label class="input-label" for="emod"
                    >Elastic modulus E<span class="input-unit" id="emod-unit"
                      >(GPa)</span
                    ></label
                  >
                  <input
                    id="emod"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 210"
                  />
                </div>
              </div>

              <!-- Deflection limits -->
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="input-label" for="twist-limit"
                    >Max twist angle θ<sub>max</sub
                    ><span class="input-unit">(deg)</span></label
                  >
                  <input
                    id="twist-limit"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 1"
                  />
                </div>
                <div>
                  <label class="input-label" for="defl-limit"
                    >Max midspan deflection δ<sub>max</sub
                    ><span class="input-unit" id="defl-unit">(mm)</span></label
                  >
                  <input
                    id="defl-limit"
                    type="number"
                    class="input-field"
                    placeholder="e.g. 1"
                  />
                </div>
              </div>

              <!-- Keyway & fatigue Kf -->
              <div
                class="border border-gray-200 rounded-md p-4 mb-4 bg-gray-50"
              >
                <h3 class="section-title">Details &amp; modifiers</h3>
                <div class="flex flex-wrap gap-4 mb-3">
                  <label class="inline-flex items-center text-sm">
                    <input type="checkbox" id="has-keyway" class="mr-2" />
                    Shaft has keyway (reduce strength)
                  </label>
                </div>
                <div class="grid md:grid-cols-3 gap-4">
                  <div>
                    <label class="input-label" for="kf-bending"
                      >Fatigue K<sub>f</sub> (bending)</label
                    >
                    <input
                      id="kf-bending"
                      type="number"
                      class="input-field"
                      value="1.5"
                    />
                  </div>
                  <div>
                    <label class="input-label" for="kf-torsion"
                      >Fatigue K<sub>f</sub> (torsion)</label
                    >
                    <input
                      id="kf-torsion"
                      type="number"
                      class="input-field"
                      value="1.3"
                    />
                  </div>
                  <div>
                    <label class="input-label" for="keyway-factor"
                      >Keyway strength factor</label
                    >
                    <input
                      id="keyway-factor"
                      type="number"
                      class="input-field"
                      value="0.75"
                    />
                  </div>
                </div>
              </div>

              <div class="flex flex-wrap gap-3 items-center mb-4">
                <button
                  id="calc-btn"
                  class="inline-flex items-center justify-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                >
                  Calculate shaft design
                </button>
                <button
                  id="reset-btn"
                  class="inline-flex items-center justify-center px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs font-medium rounded-md"
                >
                  Reset
                </button>
                <span id="calc-error" class="text-xs text-red-600"></span>
              </div>
            </section>

            <!-- Results -->
            <section aria-labelledby="shaft-results" class="mb-8">
              <h2
                id="shaft-results"
                class="text-xl font-semibold text-gray-800 mb-3"
              >
                Results
              </h2>

              <div id="results-container" class="space-y-4">
                <div class="border border-gray-200 rounded-md p-4">
                  <h3 class="section-title">Recommended shaft diameter</h3>
                  <p class="text-sm text-gray-600 mb-2">
                    Diameter sized for combined bending and torsion using
                    maximum shear stress theory (Tresca), then checked against
                    fatigue and deflection limits.
                  </p>
                  <div class="grid md:grid-cols-3 gap-4 text-sm">
                    <div>
                      <div class="text-gray-500">
                        Required diameter (strength)
                      </div>
                      <div class="text-lg font-semibold" id="d-strength">–</div>
                    </div>
                    <div>
                      <div class="text-gray-500">
                        Required diameter (fatigue)
                      </div>
                      <div class="text-lg font-semibold" id="d-fatigue">–</div>
                    </div>
                    <div>
                      <div class="text-gray-500">
                        Required diameter (deflection)
                      </div>
                      <div class="text-lg font-semibold" id="d-deflection">
                        –
                      </div>
                    </div>
                  </div>
                  <div class="mt-3 border-t pt-3">
                    <div class="text-gray-500 text-sm mb-1">
                      Recommended design diameter
                    </div>
                    <div class="flex items-baseline gap-2">
                      <div
                        class="text-2xl font-bold text-blue-700"
                        id="d-final"
                      >
                        –
                      </div>
                      <span
                        class="text-xs text-gray-500"
                        id="d-final-unit-label"
                        >mm</span
                      >
                    </div>
                    <p
                      class="text-xs text-gray-500 mt-1"
                      id="d-governing-note"
                    ></p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-md p-4">
                  <h3 class="section-title">
                    Stress &amp; safety factors at selected diameter
                  </h3>
                  <p class="text-xs text-gray-500 mb-2">
                    Values below are evaluated at the recommended diameter. You
                    can override the diameter to check an existing design.
                  </p>
                  <div class="grid md:grid-cols-4 gap-4 text-sm mb-3">
                    <div>
                      <label class="input-label" for="d-check"
                        >Check diameter<span
                          class="input-unit"
                          id="d-check-unit"
                          >(mm)</span
                        ></label
                      >
                      <input
                        id="d-check"
                        type="number"
                        class="input-field"
                        placeholder="Leave blank to use recommended"
                      />
                    </div>
                    <div>
                      <div class="text-gray-500">
                        Max shear stress τ<sub>max</sub>
                      </div>
                      <div class="font-semibold" id="tau-max">–</div>
                    </div>
                    <div>
                      <div class="text-gray-500">
                        von Mises stress σ<sub>vm</sub>
                      </div>
                      <div class="font-semibold" id="sigma-vm">–</div>
                    </div>
                    <div>
                      <div class="text-gray-500">Static FOS</div>
                      <div class="font-semibold" id="fos-static-actual">–</div>
                    </div>
                  </div>
                  <div class="grid md:grid-cols-3 gap-4 text-sm">
                    <div>
                      <div class="text-gray-500">
                        Fatigue safety factor (approx.)
                      </div>
                      <div class="font-semibold" id="fos-fatigue-actual">–</div>
                    </div>
                    <div>
                      <div class="text-gray-500">Twist angle θ</div>
                      <div class="font-semibold" id="twist-actual">–</div>
                    </div>
                    <div>
                      <div class="text-gray-500">Midspan deflection δ</div>
                      <div class="font-semibold" id="defl-actual">–</div>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <!-- Theory & explanation -->
            <section class="prose">
              <h2>How the shaft design calculator works</h2>
              <p>
                This tool implements standard shaft design equations used in
                mechanical design courses and handbooks. It assumes a solid
                circular shaft under combined bending moment \(M\) and torque
                \(T\), and uses the maximum shear stress theory (Tresca) as the
                primary failure criterion.
              </p>

              <h3>1. Combined bending and torsion</h3>
              <p>For a solid circular shaft of diameter \(d\):</p>
              <div class="formula-box">
                <p><strong>Section properties</strong></p>
                <p>
                  \( J = \dfrac{\pi d^4}{32} \) &nbsp; (polar moment of inertia)
                </p>
                <p>
                  \( I = \dfrac{\pi d^4}{64} \) &nbsp; (area moment of inertia)
                </p>
                <p>\( c = \dfrac{d}{2} \) &nbsp; (outer radius)</p>
                <p><strong>Stresses</strong></p>
                <p>\( \tau = \dfrac{T c}{J} = \dfrac{16 T}{\pi d^3} \)</p>
                <p>\( \sigma = \dfrac{M c}{I} = \dfrac{32 M}{\pi d^3} \)</p>
              </div>
              <p>
                The maximum shear stress according to Tresca for combined
                bending and torsion is:
              </p>
              <div class="formula-box">
                <p>
                  \[ \tau_{\max} = \sqrt{\left(\dfrac{\sigma}{2}\right)^2 +
                  \tau^2} \]
                </p>
              </div>

              <h3>2. Diameter from maximum shear stress theory (Tresca)</h3>
              <p>
                For a required static safety factor \(n_s\) and yield strength
                \(S_y\), the allowable shear stress is:
              </p>
              <div class="formula-box">
                <p>\( \tau_{\text{allow}} = \dfrac{S_y}{2 n_s} \)</p>
                <p>
                  Design condition: \( \tau_{\max} \le \tau_{\text{allow}} \)
                </p>
              </div>
              <p>
                Substituting the expressions for \(\sigma\) and \(\tau\) and
                solving for \(d\) gives the required diameter for strength. The
                calculator solves this numerically and reports the minimum \(d\)
                that satisfies the inequality.
              </p>

              <h3>3. Fatigue check (simplified)</h3>
              <p>
                When <em>Fully reversed bending + steady torque</em> is
                selected, the calculator performs a simplified fatigue check
                using an endurance limit \(S_e\) and stress concentration
                factors \(K_f\) for bending and torsion.
              </p>
              <div class="formula-box">
                <p><strong>Alternating and mean stresses</strong></p>
                <p>
                  \( \sigma_a = K_{f,b} \, \sigma \), &nbsp; \( \sigma_m \approx
                  0 \) (for fully reversed bending)
                </p>
                <p>\( \tau_m = K_{f,t} \, \tau \) (steady torque)</p>
                <p>
                  <strong
                    >Equivalent alternating stress (modified Goodman,
                    approximate)</strong
                  >
                </p>
                <p>
                  \[ \sigma_{\text{eq}} \approx \sqrt{\sigma_a^2 + 3 \tau_m^2}
                  \]
                </p>
                <p>
                  Fatigue safety factor: \( n_f =
                  \dfrac{S_e}{\sigma_{\text{eq}}} \)
                </p>
              </div>
              <p>
                The required diameter for fatigue is found by iterating on \(d\)
                until \(n_f\) meets or exceeds the specified fatigue safety
                factor.
              </p>

              <h3>4. Twist and deflection limits</h3>
              <p>
                For a shaft of length \(L\) with torque \(T\) and bending moment
                \(M\), the calculator estimates:
              </p>
              <div class="formula-box">
                <p><strong>Angle of twist</strong></p>
                <p>\[ \theta = \dfrac{T L}{J G} \]</p>
                <p>where \(G\) is the shear modulus.</p>
                <p>
                  <strong
                    >Midspan deflection (simply supported, central load
                    equivalent)</strong
                  >
                </p>
                <p>
                  The exact deflection depends on the loading configuration. For
                  a quick check, the tool uses an equivalent central load \(P\)
                  such that \(M \approx P L / 4\), giving:
                </p>
                <p>
                  \[ \delta \approx \dfrac{P L^3}{48 E I} = \dfrac{M L^2}{12 E
                  I} \]
                </p>
                <p>where \(E\) is Young's modulus.</p>
              </div>
              <p>
                These values are compared to user-specified limits for maximum
                twist angle and deflection. The diameter required to satisfy
                these stiffness limits is computed and compared with the
                strength-based diameters.
              </p>

              <h3>5. Keyways and stress concentrations</h3>
              <p>
                Keyways and shoulders reduce the effective strength of a shaft
                and increase local stresses. This calculator allows you to:
              </p>
              <ul>
                <li>
                  Apply a <strong>keyway strength factor</strong> (e.g. 0.75) to
                  reduce the effective yield and endurance limits.
                </li>
                <li>
                  Specify
                  <strong>fatigue stress concentration factors</strong> \(K_f\)
                  for bending and torsion to account for notches and geometric
                  discontinuities.
                </li>
              </ul>
              <p>
                For detailed design, consult standards and charts (e.g. ASME,
                Shigley) for appropriate \(K_t\) and \(K_f\) values based on
                geometry and surface finish.
              </p>

              <h2>Design tips for shafts</h2>
              <ul>
                <li>
                  Always check both <strong>strength</strong> and
                  <strong>stiffness</strong>. Excessive twist or deflection can
                  cause misalignment and vibration even if stresses are
                  acceptable.
                </li>
                <li>
                  Use <strong>fillets</strong> at shoulders and keyways to
                  reduce stress concentration.
                </li>
                <li>
                  Prefer <strong>standard shaft diameters</strong> and
                  tolerances for ease of manufacturing and bearing selection.
                </li>
                <li>
                  For high-speed shafts, also consider
                  <strong>critical speed</strong>, balancing, and dynamic
                  loading.
                </li>
                <li>
                  For safety-critical applications, validate results with hand
                  calculations and relevant design codes.
                </li>
              </ul>
            </section>

            <!-- FAQ -->
            <section class="mt-8">
              <h2 class="text-xl font-semibold mb-3">
                Shaft design calculator – FAQ
              </h2>
              <div class="space-y-3 text-sm" id="faq-container">
                <div class="border border-gray-200 rounded-md">
                  <button
                    class="w-full text-left px-4 py-2 flex justify-between items-center faq-question"
                  >
                    <span>What inputs do I need for shaft design?</span>
                    <span class="text-gray-400 text-xs">+</span>
                  </button>
                  <div class="px-4 pb-3 hidden faq-answer">
                    <p>
                      You need the applied torque and bending moment at the
                      critical section, material properties (yield strength,
                      ultimate strength, endurance limit, E and G), desired
                      safety factors, approximate span length, and any modifiers
                      such as keyways or fatigue stress concentration factors.
                    </p>
                  </div>
                </div>
                <div class="border border-gray-200 rounded-md">
                  <button
                    class="w-full text-left px-4 py-2 flex justify-between items-center faq-question"
                  >
                    <span>Can I use this tool for hollow shafts?</span>
                    <span class="text-gray-400 text-xs">+</span>
                  </button>
                  <div class="px-4 pb-3 hidden faq-answer">
                    <p>
                      This version assumes a solid circular shaft. For hollow
                      shafts you would need different section properties (J and
                      I) and a modified stress calculation. As a conservative
                      approximation you can treat a thin-walled hollow shaft as
                      solid with diameter equal to the outer diameter, but this
                      will overestimate required size.
                    </p>
                  </div>
                </div>
                <div class="border border-gray-200 rounded-md">
                  <button
                    class="w-full text-left px-4 py-2 flex justify-between items-center faq-question"
                  >
                    <span>How accurate is the fatigue safety factor?</span>
                    <span class="text-gray-400 text-xs">+</span>
                  </button>
                  <div class="px-4 pb-3 hidden faq-answer">
                    <p>
                      The fatigue check is intentionally simplified and assumes
                      fully reversed bending with steady torque, using an
                      equivalent stress approach. It is useful for preliminary
                      design and comparison of alternatives, but detailed
                      fatigue design should follow a full Goodman or Soderberg
                      analysis with proper load spectra and notch factors.
                    </p>
                  </div>
                </div>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Unit system SI (N, mm, MPa)</li><li>US (lbf, in, ksi)</li><li>Torque T (N·mm) Bending moment M (N·mm) Yield strength S y (MPa) Ultimate strength S ut (MPa) Endurance limit S e (MPa) Required static FOS Required fatigue FOS Loading type Static / low-cycle Fully reversed bending + steady torque Shaft span length L (mm) Shear modulus G (GPa) Elastic modulus E (GPa) Max twist angle θ max (deg) Max midspan deflection δ max (mm) Details &amp; modifiers Shaft has keyway (reduce strength)</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Shaft, Design, Unit system SI (N, mm, MPa), US (lbf, in, ksi), Torque T (N·mm) Bending moment M (N·mm) Yield strength S y (MPa) Ultimate strength S ut (MPa) Endurance limit S e (MPa) Required static FOS Required fatigue FOS Loading type Static / low-cycle Fully reversed bending + steady torque Shaft span length L (mm) Shear modulus G (GPa) Elastic modulus E (GPa) Max twist angle θ max (deg) Max midspan deflection δ max (mm) Details &amp; modifiers Shaft has keyway (reduce strength).</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Unit system SI (N, mm, MPa)</li><li>US (lbf, in, ksi)</li><li>Torque T (N·mm) Bending moment M (N·mm) Yield strength S y (MPa) Ultimate strength S ut (MPa) Endurance limit S e (MPa) Required static FOS Required fatigue FOS Loading type Static / low-cycle Fully reversed bending + steady torque Shaft span length L (mm) Shear modulus G (GPa) Elastic modulus E (GPa) Max twist angle θ max (deg) Max midspan deflection δ max (mm) Details &amp; modifiers Shaft has keyway (reduce strength)</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Mechanical Engineering Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/gear-ratio"
                  class="text-blue-600 hover:underline"
                  >Gear Ratio Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/torque"
                  class="text-blue-600 hover:underline"
                  >Torque Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/horsepower"
                  class="text-blue-600 hover:underline"
                  >Horsepower Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/heat-transfer"
                  class="text-blue-600 hover:underline"
                  >Heat Transfer Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/natural-frequency"
                  class="text-blue-600 hover:underline"
                  >Vibration / Natural Frequency</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/beam-deflection"
                  class="text-blue-600 hover:underline"
                  >Beam Deflection Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/factor-of-safety"
                  class="text-blue-600 hover:underline"
                  >Factor of Safety Calculator</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">
              More Engineering Calculators
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/reynolds-number"
                  class="text-blue-600 hover:underline"
                  >Reynolds Number</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bernoulli-equation"
                  class="text-blue-600 hover:underline"
                  >Bernoulli Equation</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/moment-of-inertia"
                  class="text-blue-600 hover:underline"
                  >Moment of Inertia</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/stress-and-strain"
                  class="text-blue-600 hover:underline"
                  >Stress &amp; Strain</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/heat-loss"
                  class="text-blue-600 hover:underline"
                  >Heat Loss Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/pipe-sizing"
                  class="text-blue-600 hover:underline"
                  >Pipe Sizing (Water)</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Utility: unit handling
      const state = {
        unit: "si", // 'si' or 'us'
        lastDiameter: null,
      };

      function updateUnitLabels() {
        const si = state.unit === "si";
        document.getElementById("torque-unit").textContent = si
          ? "(N·mm)"
          : "(in·lbf)";
        document.getElementById("bending-unit").textContent = si
          ? "(N·mm)"
          : "(in·lbf)";
        document.getElementById("sy-unit").textContent = si ? "(MPa)" : "(ksi)";
        document.getElementById("sut-unit").textContent = si
          ? "(MPa)"
          : "(ksi)";
        document.getElementById("se-unit").textContent = si ? "(MPa)" : "(ksi)";
        document.getElementById("length-unit").textContent = si
          ? "(mm)"
          : "(in)";
        document.getElementById("defl-unit").textContent = si ? "(mm)" : "(in)";
        document.getElementById("gmod-unit").textContent = si
          ? "(GPa)"
          : "(Mpsi)";
        document.getElementById("emod-unit").textContent = si
          ? "(GPa)"
          : "(Mpsi)";
        document.getElementById("d-final-unit-label").textContent = si
          ? "mm"
          : "in";
        document.getElementById("d-check-unit").textContent = si
          ? "(mm)"
          : "(in)";
      }

      document.querySelectorAll('input[name="unitSystem"]').forEach((r) => {
        r.addEventListener("change", (e) => {
          state.unit = e.target.value;
          updateUnitLabels();
          clearResults();
        });
      });

      function clearResults() {
        [
          "d-strength",
          "d-fatigue",
          "d-deflection",
          "d-final",
          "d-governing-note",
          "tau-max",
          "sigma-vm",
          "fos-static-actual",
          "fos-fatigue-actual",
          "twist-actual",
          "defl-actual",
        ].forEach((id) => {
          const el = document.getElementById(id);
          if (!el) return;
          el.textContent = id === "d-governing-note" ? "" : "–";
        });
        state.lastDiameter = null;
      }

      document.getElementById("reset-btn").addEventListener("click", () => {
        document
          .querySelectorAll(
            "#torque,#bending,#sy,#sut,#se,#fos-static,#fos-fatigue,#length,#gmod,#emod,#twist-limit,#defl-limit,#kf-bending,#kf-torsion,#keyway-factor,#d-check"
          )
          .forEach((el) => (el.value = ""));
        document.getElementById("fos-static").value = 2;
        document.getElementById("fos-fatigue").value = 1.5;
        document.getElementById("kf-bending").value = 1.5;
        document.getElementById("kf-torsion").value = 1.3;
        document.getElementById("keyway-factor").value = 0.75;
        document.getElementById("has-keyway").checked = false;
        document.getElementById("load-type").value = "static";
        document.getElementById("calc-error").textContent = "";
        clearResults();
      });

      function parseInput(id) {
        const v = parseFloat(document.getElementById(id).value);
        return isNaN(v) ? null : v;
      }

      function calcDiameterForStrength(T, M, Sy_eff, fosStatic) {
        // Solve tau_max(d) = Sy_eff/(2*fosStatic) via simple iteration
        const tauAllow = Sy_eff / (2 * fosStatic);
        if (tauAllow <= 0) return null;
        let d = 10; // initial guess in mm or in
        for (let i = 0; i < 60; i++) {
          const tau = (16 * T) / (Math.PI * Math.pow(d, 3));
          const sigma = (32 * M) / (Math.PI * Math.pow(d, 3));
          const tauMax = Math.sqrt(Math.pow(sigma / 2, 2) + Math.pow(tau, 2));
          if (tauMax <= tauAllow) break;
          // increase diameter proportionally
          const ratio = tauMax / tauAllow;
          d *= Math.pow(ratio, 1 / 3); // cube-root scaling
        }
        return d;
      }

      function calcDiameterForFatigue(T, M, Se_eff, fosFatigue, Kfb, Kft) {
        if (Se_eff <= 0 || fosFatigue <= 0) return null;
        let d = 10;
        for (let i = 0; i < 80; i++) {
          const tau = (16 * T) / (Math.PI * Math.pow(d, 3));
          const sigma = (32 * M) / (Math.PI * Math.pow(d, 3));
          const sigma_a = Kfb * sigma;
          const tau_m = Kft * tau;
          const sigma_eq = Math.sqrt(
            Math.pow(sigma_a, 2) + 3 * Math.pow(tau_m, 2)
          );
          const nf = Se_eff / sigma_eq;
          if (nf >= fosFatigue) break;
          const ratio = fosFatigue / nf;
          d *= Math.pow(ratio, 1 / 3);
        }
        return d;
      }

      function calcDiameterForDeflection(
        T,
        M,
        L,
        G,
        E,
        twistLimitDeg,
        deflLimit
      ) {
        if (!L || (!twistLimitDeg && !deflLimit)) return null;
        let d = 10;
        for (let i = 0; i < 80; i++) {
          const J = (Math.PI * Math.pow(d, 4)) / 32;
          const I = (Math.PI * Math.pow(d, 4)) / 64;
          let okTwist = true,
            okDefl = true;

          if (twistLimitDeg) {
            const theta = (T * L) / (J * G); // radians
            const thetaDeg = (theta * 180) / Math.PI;
            okTwist = thetaDeg <= twistLimitDeg;
          }
          if (deflLimit) {
            const delta = (M * Math.pow(L, 2)) / (12 * E * I);
            okDefl = delta <= deflLimit;
          }
          if (okTwist && okDefl) break;
          d *= 1.05; // gently increase
        }
        return d;
      }

      function computeStressesAtDiameter(
        d,
        T,
        M,
        Sy_eff,
        Se_eff,
        fosStaticReq,
        fosFatigueReq,
        Kfb,
        Kft,
        L,
        G,
        E
      ) {
        const tau = (16 * T) / (Math.PI * Math.pow(d, 3));
        const sigma = (32 * M) / (Math.PI * Math.pow(d, 3));
        const tauMax = Math.sqrt(Math.pow(sigma / 2, 2) + Math.pow(tau, 2));
        const sigma_vm = Math.sqrt(Math.pow(sigma, 2) + 3 * Math.pow(tau, 2));
        const fosStatic = Sy_eff / (2 * tauMax);

        // fatigue (approx)
        const sigma_a = Kfb * sigma;
        const tau_m = Kft * tau;
        const sigma_eq = Math.sqrt(
          Math.pow(sigma_a, 2) + 3 * Math.pow(tau_m, 2)
        );
        const fosFatigue = Se_eff > 0 ? Se_eff / sigma_eq : null;

        // twist & deflection
        const J = (Math.PI * Math.pow(d, 4)) / 32;
        const I = (Math.PI * Math.pow(d, 4)) / 64;
        const theta = (T * L) / (J * G); // rad
        const thetaDeg = (theta * 180) / Math.PI;
        const delta = (M * Math.pow(L, 2)) / (12 * E * I);

        return { tauMax, sigma_vm, fosStatic, fosFatigue, thetaDeg, delta };
      }

      document.getElementById("calc-btn").addEventListener("click", () => {
        document.getElementById("calc-error").textContent = "";
        clearResults();

        const unit = state.unit;

        let T = parseInput("torque");
        let M = parseInput("bending");
        let Sy = parseInput("sy");
        let Sut = parseInput("sut");
        let Se = parseInput("se");
        const fosStaticReq = parseInput("fos-static") || 1;
        const fosFatigueReq = parseInput("fos-fatigue") || 1;
        let L = parseInput("length");
        let G = parseInput("gmod");
        let E = parseInput("emod");
        const twistLimitDeg = parseInput("twist-limit");
        let deflLimit = parseInput("defl-limit");
        const hasKeyway = document.getElementById("has-keyway").checked;
        const keywayFactor = parseInput("keyway-factor") || 1;
        const Kfb = parseInput("kf-bending") || 1;
        const Kft = parseInput("kf-torsion") || 1;
        const loadType = document.getElementById("load-type").value;

        if (T === null || M === null || Sy === null || !L || !G || !E) {
          document.getElementById("calc-error").textContent =
            "Please enter at least torque, bending moment, material yield strength, and shaft length, G and E.";
          return;
        }

        // Unit conversions to consistent base:
        // SI: T [N·mm], M [N·mm], Sy,Sut,Se [MPa], L,defl [mm], G,E [GPa]
        // US: T [in·lbf] -> N·mm, M [in·lbf] -> N·mm, Sy,Sut,Se [ksi] -> MPa, L,defl [in] -> mm, G,E [Mpsi] -> GPa
        if (unit === "us") {
          const INLB_TO_NMM = 113.0; // 1 in·lbf ≈ 113 N·mm
          const KSI_TO_MPA = 6.895;
          const IN_TO_MM = 25.4;
          const MPSI_TO_GPA = 6.895;

          T *= INLB_TO_NMM;
          M *= INLB_TO_NMM;
          Sy *= KSI_TO_MPA;
          if (Sut != null) Sut *= KSI_TO_MPA;
          if (Se != null) Se *= KSI_TO_MPA;
          L *= IN_TO_MM;
          if (deflLimit != null) deflLimit *= IN_TO_MM;
          G *= MPSI_TO_GPA;
          E *= MPSI_TO_GPA;
        }

        // If Se not provided, estimate as 0.5*Sut if Sut given
        if ((Se === null || Se <= 0) && Sut != null) {
          Se = 0.5 * Sut;
        }
        if (Se === null) Se = 0;

        // Apply keyway factor
        let Sy_eff = Sy;
        let Se_eff = Se;
        if (hasKeyway) {
          Sy_eff *= keywayFactor;
          Se_eff *= keywayFactor;
        }

        // Strength-based diameter
        const dStrength = calcDiameterForStrength(T, M, Sy_eff, fosStaticReq);

        // Fatigue-based diameter (only if reversing)
        let dFatigue = null;
        if (loadType === "reversing" && Se_eff > 0) {
          dFatigue = calcDiameterForFatigue(
            T,
            M,
            Se_eff,
            fosFatigueReq,
            Kfb,
            Kft
          );
        }

        // Deflection-based diameter
        const dDeflection = calcDiameterForDeflection(
          T,
          M,
          L,
          G * 1e3,
          E * 1e3,
          twistLimitDeg || 0,
          deflLimit || 0
        ); // G,E in MPa

        // Choose governing diameter
        let dCandidates = [];
        if (dStrength)
          dCandidates.push({
            d: dStrength,
            reason: "strength (static Tresca)",
          });
        if (dFatigue) dCandidates.push({ d: dFatigue, reason: "fatigue" });
        if (dDeflection)
          dCandidates.push({
            d: dDeflection,
            reason: "stiffness (twist/deflection)",
          });

        if (dCandidates.length === 0) {
          document.getElementById("calc-error").textContent =
            "Unable to compute a valid diameter. Check inputs.";
          return;
        }

        let governing = dCandidates[0];
        dCandidates.forEach((c) => {
          if (c.d > governing.d) governing = c;
        });

        // Save last diameter in base (mm)
        state.lastDiameter = governing.d;

        // Display diameters in current unit
        const MM_TO_IN = 1 / 25.4;
        function fmt(val, decimals = 2) {
          if (!isFinite(val)) return "–";
          return val.toFixed(decimals);
        }

        function displayLength(mmVal) {
          if (unit === "si") return fmt(mmVal, 2) + " mm";
          return fmt(mmVal * MM_TO_IN, 3) + " in";
        }

        document.getElementById("d-strength").textContent = dStrength
          ? displayLength(dStrength)
          : "–";
        document.getElementById("d-fatigue").textContent = dFatigue
          ? displayLength(dFatigue)
          : "–";
        document.getElementById("d-deflection").textContent = dDeflection
          ? displayLength(dDeflection)
          : "–";
        document.getElementById("d-final").textContent =
          unit === "si" ? fmt(governing.d, 2) : fmt(governing.d * MM_TO_IN, 3);
        document.getElementById("d-governing-note").textContent =
          "Governing criterion: " + governing.reason + ".";

        // Compute stresses at governing diameter
        const dCheckInput = parseInput("d-check");
        let dCheck = governing.d;
        if (dCheckInput && dCheckInput > 0) {
          dCheck = unit === "si" ? dCheckInput : dCheckInput * 25.4;
        }

        const res = computeStressesAtDiameter(
          dCheck,
          T,
          M,
          Sy_eff,
          Se_eff,
          fosStaticReq,
          fosFatigueReq,
          Kfb,
          Kft,
          L,
          G * 1e3,
          E * 1e3
        );

        const stressUnit = "MPa";
        document.getElementById("tau-max").textContent =
          fmt(res.tauMax, 1) + " " + stressUnit;
        document.getElementById("sigma-vm").textContent =
          fmt(res.sigma_vm, 1) + " " + stressUnit;
        document.getElementById("fos-static-actual").textContent = fmt(
          res.fosStatic,
          2
        );
        document.getElementById("fos-fatigue-actual").textContent =
          res.fosFatigue ? fmt(res.fosFatigue, 2) : "–";
        document.getElementById("twist-actual").textContent =
          fmt(res.thetaDeg, 3) + " °";
        document.getElementById("defl-actual").textContent =
          unit === "si"
            ? fmt(res.delta, 3) + " mm"
            : fmt(res.delta * MM_TO_IN, 4) + " in";
      });

      // FAQ simple toggle (in addition to global script_faq)
      document
        .querySelectorAll("#faq-container .faq-question")
        .forEach((btn) => {
          btn.addEventListener("click", () => {
            const ans = btn.parentElement.querySelector(".faq-answer");
            const icon = btn.querySelector("span:last-child");
            const isHidden = ans.classList.contains("hidden");
            document
              .querySelectorAll("#faq-container .faq-answer")
              .forEach((a) => a.classList.add("hidden"));
            document
              .querySelectorAll("#faq-container .faq-question span:last-child")
              .forEach((i) => (i.textContent = "+"));
            if (isHidden) {
              ans.classList.remove("hidden");
              icon.textContent = "−";
            }
          });
        });

      // Initialize labels
      updateUnitLabels();

      // MathJax
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

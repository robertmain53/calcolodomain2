<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/sortino-ratio" />
    <title>Sortino Ratio Calculator: Proven [Proven 2024] | CalcDomain</title>
    <meta name="description" content="Calculate Sortino Ratio Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Fast, reliable results." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Sortino Ratio Calculator: Proven [Proven 2024] | CalcDomain" />
    <meta property="og:description" content="Calculate Sortino Ratio Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Fast, reliable results." />
    <meta property="og:url" content="https://calcdomain.com/sortino-ratio" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Sortino Ratio Calculator: Proven [Proven 2024] | CalcDomain" />
    <meta name="twitter:description" content="Calculate Sortino Ratio Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Fast, reliable results." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Finance Calculators", "item": "https://calcdomain.com/categories/finance"}, {"@type": "ListItem", "position": 3, "name": "International Personal Finance", "item": "https://calcdomain.com/subcategories/finance-international-personal"}, {"@type": "ListItem", "position": 4, "name": "Sortino Ratio Calculator", "item": "https://calcdomain.com/sortino-ratio"}]}</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  </head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/finance" class="text-blue-600 hover:underline">Finance Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/finance-international-personal" class="text-blue-600 hover:underline">International Personal Finance</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Sortino Ratio Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h1 class="text-2xl md:text-3xl font-bold mb-2">
              Sortino Ratio Calculator
            </h1>
            <p class="text-gray-700 mb-4">
              Compute the Sortino ratio using downside deviation instead of
              total volatility. Paste a series of returns or use summary
              statistics, choose your minimum acceptable return (MAR), and
              compare risk‑adjusted performance across portfolios.
            </p>

            <!-- Tabs -->
            <div class="mb-6 border-b border-gray-200">
              <nav
                class="-mb-px flex flex-wrap gap-4"
                aria-label="Sortino calculator modes"
              >
                <button
                  id="tab-returns"
                  class="tab-button border-b-2 border-blue-600 text-blue-600 py-2 px-1 text-sm font-medium"
                  type="button"
                >
                  From return series
                </button>
                <button
                  id="tab-summary"
                  class="tab-button border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium"
                  type="button"
                >
                  From summary stats
                </button>
                <button
                  id="tab-compare"
                  class="tab-button border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium"
                  type="button"
                >
                  Compare portfolios
                </button>
              </nav>
            </div>

            <!-- Panel: From return series -->
            <section id="panel-returns" aria-labelledby="tab-returns">
              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <label
                    for="returns-input"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Return series</label
                  >
                  <textarea
                    id="returns-input"
                    rows="8"
                    class="w-full border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Enter returns separated by comma, space, or new line.&#10;Examples:&#10;1.2, -0.5, 0.8, 1.0&#10;or&#10;0.012&#10;-0.005&#10;0.008"
                  ></textarea>
                  <p class="mt-1 text-xs text-gray-500">
                    You can enter values as percentages (e.g., 1.2 for 1.2%) or
                    decimals (0.012). The calculator will detect the scale
                    automatically.
                  </p>
                </div>
                <div class="space-y-3">
                  <div>
                    <label
                      for="mar-value"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Minimum acceptable return (MAR)</label
                    >
                    <div class="flex gap-2">
                      <input
                        id="mar-value"
                        type="number"
                        step="0.0001"
                        class="w-1/2 border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g. 0, 2, 5"
                      />
                      <select
                        id="mar-unit"
                        class="w-1/2 border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      >
                        <option value="percent">%</option>
                        <option value="decimal">Decimal</option>
                      </select>
                    </div>
                    <p class="mt-1 text-xs text-gray-500">
                      MAR should be per period (e.g., per month if you use
                      monthly returns). 0% is common; you can also use the
                      risk‑free rate or a hurdle rate.
                    </p>
                  </div>
                  <div>
                    <label
                      for="freq"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Return frequency (for annualization)</label
                    >
                    <select
                      id="freq"
                      class="w-full border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                      <option value="252">Daily (252 trading days)</option>
                      <option value="52">Weekly (52)</option>
                      <option value="12" selected>Monthly (12)</option>
                      <option value="4">Quarterly (4)</option>
                      <option value="1">Annual (1)</option>
                    </select>
                  </div>
                  <div class="flex items-center gap-2">
                    <input
                      id="annualize-sortino"
                      type="checkbox"
                      class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                      checked
                    />
                    <label for="annualize-sortino" class="text-sm text-gray-700"
                      >Show annualized Sortino ratio</label
                    >
                  </div>
                  <button
                    id="calc-returns"
                    type="button"
                    class="mt-2 inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                  >
                    Calculate Sortino ratio
                  </button>
                  <button
                    id="clear-returns"
                    type="button"
                    class="mt-2 ml-2 inline-flex items-center justify-center px-3 py-2 bg-gray-100 text-gray-700 text-xs font-medium rounded-md hover:bg-gray-200"
                  >
                    Clear
                  </button>
                </div>
              </div>

              <div id="results-returns" class="mt-6 hidden">
                <h2 class="text-lg font-semibold mb-2">Results</h2>
                <div class="grid md:grid-cols-2 gap-4">
                  <div class="bg-blue-50 border border-blue-100 rounded-md p-4">
                    <p
                      class="text-xs uppercase tracking-wide text-blue-700 font-semibold mb-1"
                    >
                      Sortino ratio
                    </p>
                    <p
                      id="sortino-value"
                      class="text-2xl font-bold text-blue-800"
                    >
                      –
                    </p>
                    <p
                      id="sortino-annualized"
                      class="text-sm text-blue-700 mt-1"
                    ></p>
                  </div>
                  <div
                    class="bg-gray-50 border border-gray-200 rounded-md p-4 text-sm space-y-1"
                  >
                    <p>
                      <span class="font-medium">Number of observations:</span>
                      <span id="n-obs">–</span>
                    </p>
                    <p>
                      <span class="font-medium"
                        >Average return (per period):</span
                      >
                      <span id="avg-ret">–</span>
                    </p>
                    <p>
                      <span class="font-medium">MAR (per period):</span>
                      <span id="mar-display">–</span>
                    </p>
                    <p>
                      <span class="font-medium">Downside deviation:</span>
                      <span id="downside-dev">–</span>
                    </p>
                    <p>
                      <span class="font-medium">Average excess return:</span>
                      <span id="avg-excess">–</span>
                    </p>
                  </div>
                </div>
                <p
                  id="interpretation-text"
                  class="mt-3 text-sm text-gray-700"
                ></p>
              </div>
            </section>

            <!-- Panel: From summary stats -->
            <section
              id="panel-summary"
              class="hidden"
              aria-labelledby="tab-summary"
            >
              <div class="grid md:grid-cols-2 gap-6">
                <div class="space-y-3">
                  <div>
                    <label
                      for="avg-return-summary"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Average return (per period)</label
                    >
                    <div class="flex gap-2">
                      <input
                        id="avg-return-summary"
                        type="number"
                        step="0.0001"
                        class="w-1/2 border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g. 1.2"
                      />
                      <select
                        id="avg-return-unit-summary"
                        class="w-1/2 border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      >
                        <option value="percent">%</option>
                        <option value="decimal">Decimal</option>
                      </select>
                    </div>
                  </div>
                  <div>
                    <label
                      for="mar-summary"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Minimum acceptable return (MAR, per period)</label
                    >
                    <div class="flex gap-2">
                      <input
                        id="mar-summary"
                        type="number"
                        step="0.0001"
                        class="w-1/2 border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g. 0"
                      />
                      <select
                        id="mar-unit-summary"
                        class="w-1/2 border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      >
                        <option value="percent">%</option>
                        <option value="decimal">Decimal</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="space-y-3">
                  <div>
                    <label
                      for="downside-dev-summary"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Downside deviation (per period)</label
                    >
                    <div class="flex gap-2">
                      <input
                        id="downside-dev-summary"
                        type="number"
                        step="0.0001"
                        class="w-1/2 border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g. 2.5"
                      />
                      <select
                        id="downside-dev-unit-summary"
                        class="w-1/2 border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      >
                        <option value="percent">%</option>
                        <option value="decimal">Decimal</option>
                      </select>
                    </div>
                    <p class="mt-1 text-xs text-gray-500">
                      Use the same periodicity and units as for the average
                      return and MAR.
                    </p>
                  </div>
                  <div>
                    <label
                      for="freq-summary"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Return frequency (for annualization)</label
                    >
                    <select
                      id="freq-summary"
                      class="w-full border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                      <option value="252">Daily (252 trading days)</option>
                      <option value="52">Weekly (52)</option>
                      <option value="12" selected>Monthly (12)</option>
                      <option value="4">Quarterly (4)</option>
                      <option value="1">Annual (1)</option>
                    </select>
                  </div>
                  <div class="flex items-center gap-2">
                    <input
                      id="annualize-summary"
                      type="checkbox"
                      class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                      checked
                    />
                    <label for="annualize-summary" class="text-sm text-gray-700"
                      >Show annualized Sortino ratio</label
                    >
                  </div>
                </div>
              </div>
              <button
                id="calc-summary"
                type="button"
                class="mt-4 inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                Calculate Sortino ratio
              </button>
              <button
                id="clear-summary"
                type="button"
                class="mt-4 ml-2 inline-flex items-center justify-center px-3 py-2 bg-gray-100 text-gray-700 text-xs font-medium rounded-md hover:bg-gray-200"
              >
                Clear
              </button>

              <div id="results-summary" class="mt-6 hidden">
                <h2 class="text-lg font-semibold mb-2">Results</h2>
                <div class="grid md:grid-cols-2 gap-4">
                  <div class="bg-blue-50 border border-blue-100 rounded-md p-4">
                    <p
                      class="text-xs uppercase tracking-wide text-blue-700 font-semibold mb-1"
                    >
                      Sortino ratio
                    </p>
                    <p
                      id="sortino-summary"
                      class="text-2xl font-bold text-blue-800"
                    >
                      –
                    </p>
                    <p
                      id="sortino-summary-annualized"
                      class="text-sm text-blue-700 mt-1"
                    ></p>
                  </div>
                  <div
                    class="bg-gray-50 border border-gray-200 rounded-md p-4 text-sm space-y-1"
                  >
                    <p>
                      <span class="font-medium"
                        >Average excess return (per period):</span
                      >
                      <span id="avg-excess-summary">–</span>
                    </p>
                    <p>
                      <span class="font-medium"
                        >Downside deviation (per period):</span
                      >
                      <span id="downside-dev-display-summary">–</span>
                    </p>
                  </div>
                </div>
                <p
                  id="interpretation-summary"
                  class="mt-3 text-sm text-gray-700"
                ></p>
              </div>
            </section>

            <!-- Panel: Compare portfolios -->
            <section
              id="panel-compare"
              class="hidden"
              aria-labelledby="tab-compare"
            >
              <p class="text-sm text-gray-700 mb-3">
                Quickly compare the Sortino ratio of two portfolios or
                strategies using summary statistics. Use the same MAR and
                frequency for both.
              </p>
              <div class="grid md:grid-cols-2 gap-6">
                <div class="border border-gray-200 rounded-md p-4">
                  <h2 class="font-semibold mb-3">Portfolio A</h2>
                  <div class="space-y-3">
                    <div>
                      <label
                        for="avg-a"
                        class="block text-xs font-medium text-gray-700 mb-1"
                        >Average return (per period)</label
                      >
                      <input
                        id="avg-a"
                        type="number"
                        step="0.0001"
                        class="w-full border border-gray-300 rounded-md p-2 text-xs focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g. 1.2 (for 1.2%)"
                      />
                    </div>
                    <div>
                      <label
                        for="down-a"
                        class="block text-xs font-medium text-gray-700 mb-1"
                        >Downside deviation (per period)</label
                      >
                      <input
                        id="down-a"
                        type="number"
                        step="0.0001"
                        class="w-full border border-gray-300 rounded-md p-2 text-xs focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g. 2.5 (for 2.5%)"
                      />
                    </div>
                  </div>
                </div>
                <div class="border border-gray-200 rounded-md p-4">
                  <h2 class="font-semibold mb-3">Portfolio B</h2>
                  <div class="space-y-3">
                    <div>
                      <label
                        for="avg-b"
                        class="block text-xs font-medium text-gray-700 mb-1"
                        >Average return (per period)</label
                      >
                      <input
                        id="avg-b"
                        type="number"
                        step="0.0001"
                        class="w-full border border-gray-300 rounded-md p-2 text-xs focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g. 0.9 (for 0.9%)"
                      />
                    </div>
                    <div>
                      <label
                        for="down-b"
                        class="block text-xs font-medium text-gray-700 mb-1"
                        >Downside deviation (per period)</label
                      >
                      <input
                        id="down-b"
                        type="number"
                        step="0.0001"
                        class="w-full border border-gray-300 rounded-md p-2 text-xs focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g. 1.8 (for 1.8%)"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <div class="mt-4 grid md:grid-cols-3 gap-4">
                <div>
                  <label
                    for="mar-compare"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >MAR (per period)</label
                  >
                  <input
                    id="mar-compare"
                    type="number"
                    step="0.0001"
                    class="w-full border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="e.g. 0"
                  />
                </div>
                <div>
                  <label
                    for="freq-compare"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Frequency</label
                  >
                  <select
                    id="freq-compare"
                    class="w-full border border-gray-300 rounded-md p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  >
                    <option value="252">Daily</option>
                    <option value="52">Weekly</option>
                    <option value="12" selected>Monthly</option>
                    <option value="4">Quarterly</option>
                    <option value="1">Annual</option>
                  </select>
                </div>
                <div class="flex items-center mt-6 md:mt-0">
                  <div class="flex items-center gap-2">
                    <input
                      id="annualize-compare"
                      type="checkbox"
                      class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                      checked
                    />
                    <label for="annualize-compare" class="text-sm text-gray-700"
                      >Annualize</label
                    >
                  </div>
                </div>
              </div>

              <button
                id="calc-compare"
                type="button"
                class="mt-4 inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                Compare Sortino ratios
              </button>
              <button
                id="clear-compare"
                type="button"
                class="mt-4 ml-2 inline-flex items-center justify-center px-3 py-2 bg-gray-100 text-gray-700 text-xs font-medium rounded-md hover:bg-gray-200"
              >
                Clear
              </button>

              <div id="results-compare" class="mt-6 hidden">
                <h2 class="text-lg font-semibold mb-2">Comparison results</h2>
                <div class="grid md:grid-cols-3 gap-4 text-sm">
                  <div class="bg-blue-50 border border-blue-100 rounded-md p-4">
                    <p
                      class="text-xs uppercase tracking-wide text-blue-700 font-semibold mb-1"
                    >
                      Portfolio A
                    </p>
                    <p id="sortino-a" class="text-xl font-bold text-blue-800">
                      –
                    </p>
                    <p
                      id="sortino-a-annual"
                      class="text-xs text-blue-700 mt-1"
                    ></p>
                  </div>
                  <div class="bg-blue-50 border border-blue-100 rounded-md p-4">
                    <p
                      class="text-xs uppercase tracking-wide text-blue-700 font-semibold mb-1"
                    >
                      Portfolio B
                    </p>
                    <p id="sortino-b" class="text-xl font-bold text-blue-800">
                      –
                    </p>
                    <p
                      id="sortino-b-annual"
                      class="text-xs text-blue-700 mt-1"
                    ></p>
                  </div>
                  <div class="bg-gray-50 border border-gray-200 rounded-md p-4">
                    <p
                      class="text-xs uppercase tracking-wide text-gray-600 font-semibold mb-1"
                    >
                      Difference (A − B)
                    </p>
                    <p
                      id="sortino-diff"
                      class="text-xl font-bold text-gray-800"
                    >
                      –
                    </p>
                    <p
                      id="sortino-better"
                      class="text-xs text-gray-700 mt-1"
                    ></p>
                  </div>
                </div>
              </div>
            </section>

            <!-- Explanation content -->
            <section class="prose mt-10">
              <h2>What is the Sortino ratio?</h2>
              <p>
                The Sortino ratio is a risk-adjusted performance metric that
                measures how much excess return an investment generates per unit
                of
                <strong>downside risk</strong>. Unlike the Sharpe ratio, which
                penalizes all volatility, the Sortino ratio only considers
                returns that fall below a chosen
                <strong>minimum acceptable return (MAR)</strong>.
              </p>
              <p>
                This makes the Sortino ratio particularly useful for strategies
                with asymmetric or skewed return distributions (e.g., options
                strategies, trend-following, or portfolios with limited upside
                but large downside risk).
              </p>

              <h2>Sortino ratio formula</h2>
              <div class="formula-box text-sm">
                <p class="font-semibold mb-1">Basic definition (per period):</p>
                <p>\[ \text{Sortino} = \frac{\bar{R} - R_T}{\sigma_d} \]</p>
                <ul>
                  <li>\(\bar{R}\): average return per period</li>
                  <li>
                    \(R_T\): target or minimum acceptable return (MAR) per
                    period
                  </li>
                  <li>
                    \(\sigma_d\): downside deviation (standard deviation of
                    returns below \(R_T\))
                  </li>
                </ul>
                <p class="font-semibold mt-2 mb-1">Downside deviation:</p>
                <p>
                  \[ \sigma_d = \sqrt{\frac{1}{N} \sum_{i=1}^{N} \min(0, R_i -
                  R_T)^2} \]
                </p>
                <ul>
                  <li>\(R_i\): return in period \(i\)</li>
                  <li>\(N\): number of observations</li>
                  <li>
                    Only negative excess returns \(R_i - R_T &lt; 0\) contribute
                    to the sum; positive ones are treated as 0.
                  </li>
                </ul>
              </div>

              <h3>Annualized Sortino ratio</h3>
              <p>
                If your returns are periodic (daily, weekly, monthly, etc.), you
                can annualize the Sortino ratio using:
              </p>
              <div class="formula-box text-sm">
                <p>
                  \[ \text{Sortino}_{\text{annual}} =
                  \text{Sortino}_{\text{period}} \times \sqrt{m} \]
                </p>
                <p>
                  where \(m\) is the number of periods per year (e.g., 252 for
                  daily, 12 for monthly).
                </p>
              </div>

              <h2>How to interpret the Sortino ratio</h2>
              <p>
                The Sortino ratio answers:
                <em
                  >“How much excess return am I earning for each unit of
                  downside risk?”</em
                >
                Higher is better. There is no universal threshold, but a common
                rule of thumb for <strong>annualized</strong> Sortino ratios is:
              </p>
              <ul>
                <li>
                  <strong>&lt; 0.5</strong> – Weak risk-adjusted performance
                </li>
                <li><strong>0.5 – 1.0</strong> – Acceptable / moderate</li>
                <li><strong>1.0 – 2.0</strong> – Good</li>
                <li><strong>&gt; 2.0</strong> – Excellent</li>
              </ul>
              <p>
                Always interpret the value in context: asset class, time period,
                market regime, and sample size all matter. A high Sortino ratio
                based on very few observations may not be reliable.
              </p>

              <h2>Sortino vs Sharpe ratio</h2>
              <p>The key differences:</p>
              <ul>
                <li>
                  <strong>Sharpe ratio</strong> uses total volatility (standard
                  deviation of all returns).
                </li>
                <li>
                  <strong>Sortino ratio</strong> uses downside deviation (only
                  returns below MAR).
                </li>
                <li>
                  For symmetric, normally distributed returns, the two ratios
                  can be similar.
                </li>
                <li>
                  For skewed or fat‑tailed strategies, Sortino often gives a
                  more intuitive picture of “bad risk”.
                </li>
              </ul>
              <p>
                Many practitioners look at both metrics: Sharpe for overall
                efficiency, Sortino for downside protection.
              </p>

              <h2>Step‑by‑step example</h2>
              <p>Suppose you have 12 monthly returns (in %):</p>
              <p>
                2.0, 1.5, -0.8, 3.1, 0.4, -1.2, 1.8, 2.3, -0.5, 0.9, 1.1, 2.7
              </p>
              <ol>
                <li>Convert to decimals: 0.020, 0.015, -0.008, …</li>
                <li>Choose MAR = 0% per month (\(R_T = 0\)).</li>
                <li>
                  Compute the average return \(\bar{R}\) (about 0.012 or 1.2%
                  per month).
                </li>
                <li>
                  For each month, compute \(R_i - R_T\). For positive values,
                  contribution to downside deviation is 0. For negative values,
                  square them and sum.
                </li>
                <li>
                  Divide the sum of squared negative excess returns by 12 and
                  take the square root → downside deviation \(\sigma_d\).
                </li>
                <li>Compute Sortino: \((\bar{R} - R_T) / \sigma_d\).</li>
                <li>
                  Annualize by multiplying by \(\sqrt{12}\) to get the annual
                  Sortino ratio.
                </li>
              </ol>
              <p>
                The calculator performs all these steps automatically and also
                detects whether you entered returns as percentages or decimals.
              </p>

              <h2>Best practices and limitations</h2>
              <ul>
                <li>
                  Use a <strong>consistent MAR</strong> across strategies when
                  comparing Sortino ratios.
                </li>
                <li>
                  Ensure you have <strong>enough data points</strong> to
                  estimate downside deviation reliably.
                </li>
                <li>
                  Beware of <strong>non‑stationary</strong> return series
                  (strategy changes, regime shifts).
                </li>
                <li>
                  Combine Sortino with other metrics (max drawdown, Sharpe, VaR,
                  etc.) for a fuller risk picture.
                </li>
              </ul>
            </section>

            <!-- FAQ -->
            <section class="mt-10">
              <h2 class="text-xl font-semibold mb-4">Sortino ratio – FAQ</h2>
              <div class="space-y-3" id="faq-container">
                <div class="border border-gray-200 rounded-md">
                  <button
                    class="faq-question w-full text-left px-4 py-3 flex justify-between items-center"
                  >
                    <span class="font-medium text-gray-800"
                      >What is a good Sortino ratio?</span
                    >
                    <span class="text-gray-500 text-sm">+</span>
                  </button>
                  <div
                    class="faq-answer px-4 pb-4 text-sm text-gray-700 hidden"
                  >
                    There is no single cutoff, but many investors use this rule
                    of thumb for annualized Sortino ratios: below 0.5 is weak,
                    0.5–1.0 is acceptable, 1.0–2.0 is good, and above 2.0 is
                    excellent. Always interpret the number in context and
                    together with other risk metrics.
                  </div>
                </div>
                <div class="border border-gray-200 rounded-md">
                  <button
                    class="faq-question w-full text-left px-4 py-3 flex justify-between items-center"
                  >
                    <span class="font-medium text-gray-800"
                      >What should I use as the minimum acceptable return
                      (MAR)?</span
                    >
                    <span class="text-gray-500 text-sm">+</span>
                  </button>
                  <div
                    class="faq-answer px-4 pb-4 text-sm text-gray-700 hidden"
                  >
                    Common choices include the risk‑free rate, zero, or a custom
                    hurdle rate (e.g., 5% per year). The important thing is to
                    use the same MAR when comparing different portfolios or
                    strategies.
                  </div>
                </div>
                <div class="border border-gray-200 rounded-md">
                  <button
                    class="faq-question w-full text-left px-4 py-3 flex justify-between items-center"
                  >
                    <span class="font-medium text-gray-800"
                      >Can the Sortino ratio be used for non‑normal or skewed
                      returns?</span
                    >
                    <span class="text-gray-500 text-sm">+</span>
                  </button>
                  <div
                    class="faq-answer px-4 pb-4 text-sm text-gray-700 hidden"
                  >
                    Yes. In fact, one of the main motivations for the Sortino
                    ratio is to better handle skewed or non‑normal return
                    distributions by focusing only on downside volatility.
                    However, like any summary statistic, it can still hide tail
                    risks, so you should also inspect the full return
                    distribution.
                  </div>
                </div>
                <div class="border border-gray-200 rounded-md">
                  <button
                    class="faq-question w-full text-left px-4 py-3 flex justify-between items-center"
                  >
                    <span class="font-medium text-gray-800"
                      >Why does my Sortino ratio look very large or
                      undefined?</span
                    >
                    <span class="text-gray-500 text-sm">+</span>
                  </button>
                  <div
                    class="faq-answer px-4 pb-4 text-sm text-gray-700 hidden"
                  >
                    If there are no returns below the MAR, the downside
                    deviation is zero, which makes the Sortino ratio
                    mathematically undefined (division by zero). In practice,
                    this means the strategy has not experienced any downside
                    relative to the chosen MAR over the sample period. With very
                    small downside deviation, even modest excess returns can
                    produce very large Sortino values, so interpret them
                    cautiously.
                  </div>
                </div>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Sortino, Ratio.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Finance calculators
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/sharpe-ratio"
                  class="text-blue-600 hover:underline"
                  >Sharpe Ratio (if available)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/portfolio-standard-deviation"
                  class="text-blue-600 hover:underline"
                  >Portfolio Standard Deviation</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/value-at-risk"
                  class="text-blue-600 hover:underline"
                  >Value at Risk (VaR)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/roi"
                  class="text-blue-600 hover:underline"
                  >Investment Return (ROI)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/beta"
                  class="text-blue-600 hover:underline"
                  >Beta</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/treynor-ratio"
                  class="text-blue-600 hover:underline"
                  >Treynor Ratio</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sharpe-ratio"
                  class="text-blue-600 hover:underline"
                  >Risk-Adjusted Return Tools</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Finance categories</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/finance-investment"
                  class="text-blue-600 hover:underline"
                  >Investing &amp; Portfolio Analysis</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-blue-600 hover:underline"
                  >All Finance calculators</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/finance-business-ratios-and-valuation"
                  class="text-blue-600 hover:underline"
                  >Business Ratios &amp; Valuation</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Tab handling
      const tabs = {
        "tab-returns": "panel-returns",
        "tab-summary": "panel-summary",
        "tab-compare": "panel-compare",
      };
      Object.keys(tabs).forEach((tabId) => {
        document.getElementById(tabId).addEventListener("click", () => {
          // update buttons
          Object.keys(tabs).forEach((id) => {
            const btn = document.getElementById(id);
            if (id === tabId) {
              btn.classList.remove("text-gray-500", "border-transparent");
              btn.classList.add("text-blue-600", "border-blue-600");
            } else {
              btn.classList.remove("text-blue-600", "border-blue-600");
              btn.classList.add("text-gray-500", "border-transparent");
            }
          });
          // update panels
          Object.values(tabs).forEach((pid) => {
            document
              .getElementById(pid)
              .classList.toggle("hidden", pid !== tabs[tabId]);
          });
        });
      });

      function parseNumberList(input) {
        if (!input) return [];
        const raw = input
          .replace(/[\n\r]+/g, ",")
          .split(/[,\s;]+/)
          .map((v) => v.trim())
          .filter((v) => v.length > 0);
        const nums = raw.map((v) => Number(v)).filter((v) => !isNaN(v));
        return nums;
      }

      function detectScale(values) {
        if (!values.length) return 1;
        const absVals = values.map((v) => Math.abs(v));
        const avg = absVals.reduce((a, b) => a + b, 0) / absVals.length;
        // If average absolute value > 0.5, assume percentages
        return avg > 0.5 ? 0.01 : 1;
      }

      function formatPct(x, decimals = 2) {
        if (!isFinite(x)) return "–";
        return (x * 100).toFixed(decimals) + "%";
      }

      function formatNum(x, decimals = 4) {
        if (!isFinite(x)) return "–";
        return x.toFixed(decimals);
      }

      function interpretSortino(value) {
        if (!isFinite(value)) return "";
        if (value < 0)
          return "Negative Sortino ratio: the average return is below the chosen minimum acceptable return (MAR).";
        if (value < 0.5)
          return "Low risk-adjusted performance: you are not being well compensated for downside risk.";
        if (value < 1.0)
          return "Moderate risk-adjusted performance. There is some compensation for downside risk, but it is not outstanding.";
        if (value < 2.0)
          return "Good risk-adjusted performance: the portfolio delivers solid excess return per unit of downside risk.";
        return "Excellent risk-adjusted performance: very strong excess return relative to downside risk. Check that the sample size is sufficient.";
      }

      // Calculate from return series
      document.getElementById("calc-returns").addEventListener("click", () => {
        const returns = parseNumberList(
          document.getElementById("returns-input").value
        );
        if (returns.length < 2) {
          alert("Please enter at least two return observations.");
          return;
        }
        const scale = detectScale(returns);
        const rets = returns.map((r) => r * scale); // convert to decimals

        const marInput = parseFloat(
          document.getElementById("mar-value").value || "0"
        );
        const marUnit = document.getElementById("mar-unit").value;
        const mar = marUnit === "percent" ? marInput * 0.01 : marInput;

        const n = rets.length;
        const avg = rets.reduce((a, b) => a + b, 0) / n;

        let sumSqDown = 0;
        for (let i = 0; i < n; i++) {
          const excess = rets[i] - mar;
          if (excess < 0) sumSqDown += excess * excess;
        }
        const downsideDev = Math.sqrt(sumSqDown / n);

        const avgExcess = avg - mar;
        let sortino = NaN;
        if (downsideDev > 0) sortino = avgExcess / downsideDev;

        const freq = parseFloat(document.getElementById("freq").value);
        const annualize = document.getElementById("annualize-sortino").checked;
        let sortinoAnnual = NaN;
        if (annualize && isFinite(sortino)) {
          sortinoAnnual = sortino * Math.sqrt(freq);
        }

        document.getElementById("n-obs").textContent = n.toString();
        document.getElementById("avg-ret").textContent = formatPct(avg);
        document.getElementById("mar-display").textContent = formatPct(mar);
        document.getElementById("downside-dev").textContent =
          formatPct(downsideDev);
        document.getElementById("avg-excess").textContent =
          formatPct(avgExcess);
        document.getElementById("sortino-value").textContent = isFinite(sortino)
          ? sortino.toFixed(3)
          : "undefined";
        document.getElementById("sortino-annualized").textContent = isFinite(
          sortinoAnnual
        )
          ? `Annualized Sortino: ${sortinoAnnual.toFixed(3)}`
          : "";

        document.getElementById("interpretation-text").textContent =
          interpretSortino(
            annualize && isFinite(sortinoAnnual) ? sortinoAnnual : sortino
          );
        document.getElementById("results-returns").classList.remove("hidden");
      });

      document.getElementById("clear-returns").addEventListener("click", () => {
        document.getElementById("returns-input").value = "";
        document.getElementById("mar-value").value = "";
        document.getElementById("results-returns").classList.add("hidden");
      });

      // Calculate from summary stats
      document.getElementById("calc-summary").addEventListener("click", () => {
        const avgInput = parseFloat(
          document.getElementById("avg-return-summary").value
        );
        const avgUnit = document.getElementById(
          "avg-return-unit-summary"
        ).value;
        const marInput = parseFloat(
          document.getElementById("mar-summary").value || "0"
        );
        const marUnit = document.getElementById("mar-unit-summary").value;
        const downInput = parseFloat(
          document.getElementById("downside-dev-summary").value
        );
        const downUnit = document.getElementById(
          "downside-dev-unit-summary"
        ).value;

        if (isNaN(avgInput) || isNaN(downInput)) {
          alert("Please enter at least average return and downside deviation.");
          return;
        }

        const avg = avgUnit === "percent" ? avgInput * 0.01 : avgInput;
        const mar = marUnit === "percent" ? marInput * 0.01 : marInput;
        const down = downUnit === "percent" ? downInput * 0.01 : downInput;

        const avgExcess = avg - mar;
        let sortino = NaN;
        if (down > 0) sortino = avgExcess / down;

        const freq = parseFloat(document.getElementById("freq-summary").value);
        const annualize = document.getElementById("annualize-summary").checked;
        let sortinoAnnual = NaN;
        if (annualize && isFinite(sortino)) {
          sortinoAnnual = sortino * Math.sqrt(freq);
        }

        document.getElementById("avg-excess-summary").textContent =
          formatPct(avgExcess);
        document.getElementById("downside-dev-display-summary").textContent =
          formatPct(down);
        document.getElementById("sortino-summary").textContent = isFinite(
          sortino
        )
          ? sortino.toFixed(3)
          : "undefined";
        document.getElementById("sortino-summary-annualized").textContent =
          isFinite(sortinoAnnual)
            ? `Annualized Sortino: ${sortinoAnnual.toFixed(3)}`
            : "";
        document.getElementById("interpretation-summary").textContent =
          interpretSortino(
            annualize && isFinite(sortinoAnnual) ? sortinoAnnual : sortino
          );

        document.getElementById("results-summary").classList.remove("hidden");
      });

      document.getElementById("clear-summary").addEventListener("click", () => {
        document.getElementById("avg-return-summary").value = "";
        document.getElementById("mar-summary").value = "";
        document.getElementById("downside-dev-summary").value = "";
        document.getElementById("results-summary").classList.add("hidden");
      });

      // Compare portfolios
      document.getElementById("calc-compare").addEventListener("click", () => {
        const avgA = parseFloat(document.getElementById("avg-a").value);
        const downA = parseFloat(document.getElementById("down-a").value);
        const avgB = parseFloat(document.getElementById("avg-b").value);
        const downB = parseFloat(document.getElementById("down-b").value);
        const marInput = parseFloat(
          document.getElementById("mar-compare").value || "0"
        );
        const freq = parseFloat(document.getElementById("freq-compare").value);
        const annualize = document.getElementById("annualize-compare").checked;

        if ([avgA, downA, avgB, downB].some((v) => isNaN(v))) {
          alert(
            "Please enter average return and downside deviation for both portfolios."
          );
          return;
        }

        const mar = marInput * 0.01; // assume % inputs for simplicity
        const avgADec = avgA * 0.01;
        const downADec = downA * 0.01;
        const avgBDec = avgB * 0.01;
        const downBDec = downB * 0.01;

        let sortinoA = NaN,
          sortinoB = NaN;
        if (downADec > 0) sortinoA = (avgADec - mar) / downADec;
        if (downBDec > 0) sortinoB = (avgBDec - mar) / downBDec;

        let sortinoAAnn = NaN,
          sortinoBAnn = NaN;
        if (annualize && isFinite(sortinoA))
          sortinoAAnn = sortinoA * Math.sqrt(freq);
        if (annualize && isFinite(sortinoB))
          sortinoBAnn = sortinoB * Math.sqrt(freq);

        const sA = annualize && isFinite(sortinoAAnn) ? sortinoAAnn : sortinoA;
        const sB = annualize && isFinite(sortinoBAnn) ? sortinoBAnn : sortinoB;
        const diff = isFinite(sA) && isFinite(sB) ? sA - sB : NaN;

        document.getElementById("sortino-a").textContent = isFinite(sortinoA)
          ? sortinoA.toFixed(3)
          : "undefined";
        document.getElementById("sortino-b").textContent = isFinite(sortinoB)
          ? sortinoB.toFixed(3)
          : "undefined";
        document.getElementById("sortino-a-annual").textContent = isFinite(
          sortinoAAnn
        )
          ? `Annualized: ${sortinoAAnn.toFixed(3)}`
          : "";
        document.getElementById("sortino-b-annual").textContent = isFinite(
          sortinoBAnn
        )
          ? `Annualized: ${sortinoBAnn.toFixed(3)}`
          : "";
        document.getElementById("sortino-diff").textContent = isFinite(diff)
          ? diff.toFixed(3)
          : "–";

        let better = "";
        if (isFinite(diff)) {
          if (diff > 0)
            better =
              "Portfolio A has a higher Sortino ratio (better downside risk-adjusted performance).";
          else if (diff < 0)
            better =
              "Portfolio B has a higher Sortino ratio (better downside risk-adjusted performance).";
          else better = "Both portfolios have the same Sortino ratio.";
        }
        document.getElementById("sortino-better").textContent = better;

        document.getElementById("results-compare").classList.remove("hidden");
      });

      document.getElementById("clear-compare").addEventListener("click", () => {
        ["avg-a", "down-a", "avg-b", "down-b", "mar-compare"].forEach(
          (id) => (document.getElementById(id).value = "")
        );
        document.getElementById("results-compare").classList.add("hidden");
      });

      document
        .querySelectorAll("#faq-container .faq-question")
        .forEach((btn) => {
          btn.addEventListener("click", () => {
            const answer = btn.parentElement.querySelector(".faq-answer");
            const symbol = btn.querySelector("span:last-child");
            const isHidden = answer.classList.contains("hidden");
            answer.classList.toggle("hidden", !isHidden);
            symbol.textContent = isHidden ? "−" : "+";
          });
        });

      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

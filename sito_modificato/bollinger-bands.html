<!DOCTYPE html><html lang="en"><head>
    <link rel="canonical" href="https://calcdomain.com/bollinger-bands">
    <title>Bollinger Bands Calculator | CalcDomain</title>
    <meta name="description" content="Calculate Bollinger Bands for trading analysis with our interactive and accessible online tool.">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Bollinger Bands Calculator | CalcDomain">
    <meta property="og:description" content="Calculate Bollinger Bands for trading analysis with our interactive and accessible online tool.">
    <meta property="og:url" content="https://calcdomain.com/bollinger-bands">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Bollinger Bands Calculator | CalcDomain">
    <meta name="twitter:description" content="Calculate Bollinger Bands for trading analysis with our interactive and accessible online tool.">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif; }
        .card-hover { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .prose table { width: 100%; border-collapse: collapse; margin-top: 1em; margin-bottom: 1em; }
        .prose th, .prose td { border: 1px solid #e5e7eb; padding: 0.5rem 0.75rem; text-align: left; }
        .prose thead th { background-color: #f9fafb; font-weight: 600; }
        .prose tr:nth-child(even) { background-color: #f9fafb; }
        .formula-box { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; overflow-x: auto; margin: 1rem 0; font-family: monospace; }
        .calc-input { width: 100%; padding: 0.625rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-size: 0.9375rem; }
        .calc-input:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15); }
        .calc-label { display: block; font-size: 0.8125rem; font-weight: 600; color: #6b7280; margin-bottom: 0.375rem; }
        .result-box { background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border: 1px solid #bfdbfe; border-radius: 0.75rem; padding: 1.5rem; text-align: center; }
        .result-value { font-size: 2.5rem; font-weight: 800; color: #1e40af; }
        .kpi-row { display: flex; justify-content: space-between; padding: 0.625rem 0; border-bottom: 1px solid #e5e7eb; font-size: 0.875rem; }
        .kpi-row:last-child { border-bottom: none; }
        .kpi-label { color: #6b7280; }
        .kpi-value { font-weight: 700; color: #111827; }
        .btn { display: inline-flex; justify-content: center; align-items: center; border: none; border-radius: 0.5rem; font-weight: 700; cursor: pointer; transition: background 0.2s ease; }
        .btn-primary { width: 100%; background: #2563eb; color: white; padding: 0.75rem; }
        .btn-primary:hover { background: #1d4ed8; }
        .btn-secondary { width: 100%; background: white; color: #374151; padding: 0.75rem; border: 1px solid #d1d5db; }
        .btn-secondary:hover { background: #f9fafb; }
        .alert { display: none; padding: 0.75rem; margin-bottom: 1rem; background: #fee2e2; border-left: 4px solid #dc2626; color: #991b1b; border-radius: 0.375rem; font-size: 0.875rem; }
        .schedule-table { width: 100%; border-collapse: collapse; font-size: 0.875rem; }
        .schedule-table th, .schedule-table td { padding: 0.75rem; border-bottom: 1px solid #e5e7eb; text-align: left; white-space: nowrap; }
        .schedule-table th { background: #f1f5f9; font-weight: 700; color: #6b7280; font-size: 0.75rem; text-transform: uppercase; }
        .schedule-table tr:nth-child(even) td { background: #fafafa; }
        .optional-section { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 0.5rem; padding: 1rem; margin-top: 1rem; }
        .sub { font-size: 1.125rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com"},
            {"@type": "ListItem", "position": 2, "name": "Finance", "item": "https://calcdomain.com/categories/finance"},
            {"@type": "ListItem", "position": 3, "name": "Investing and Growth", "item": "https://calcdomain.com/subcategories/finance-investing-and-growth"}
        ]
    }</script>
</head>
<body class="bg-gray-50 text-gray-800">
    <header id="siteHeader" class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="nav container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a class="brand text-2xl font-bold text-blue-600" href="https://calcdomain.com">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
              <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
            </div>
          </div>
          <div class="navRight hidden md:flex items-center space-x-6">
            <a class="pill text-gray-700 hover:text-blue-600 transition-colors" href="https://calcdomain.com/search">Advanced Search</a>
            <span class="pill text-gray-700 hover:text-blue-600 transition-colors">Categories</span>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <main id="mainContent" class="container mx-auto px-4 py-8">
      <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs">
        <ol class="flex flex-wrap items-center gap-1">
          <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
          <li class="text-gray-400">/</li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-blue-600 hover:underline">Finance</a></li>
          <li class="text-gray-400">/</li>
          <li><a href="https://calcdomain.com/subcategories/finance-investing-and-growth" class="text-blue-600 hover:underline">Investing and Growth</a></li>
          <li class="text-gray-400">/</li>
          <li><span class="text-gray-800">Bollinger Bands Calculator</span></li>
        </ol>
      </nav>

      <div class="space-y-3">
        <h1 id="pageTitle" class="text-3xl font-bold text-gray-900">Bollinger Bands Calculator</h1>
        <p id="pageSub" class="sub text-lg text-gray-600">Calculate Bollinger Bands for trading analysis with our interactive and accessible online tool.</p>
        <div id="errorBox" class="alert" role="alert" aria-live="polite"></div>
      </div>

      <div class="calc-hero mt-8" id="calcHero" aria-label="Calculator hero">
        <section class="card" id="inputsCard" aria-label="Calculator inputs">
          <div id="calculator-ui" class="bg-white p-6 rounded-lg border border-gray-200">
            <h3 class="text-lg font-bold text-gray-700 mb-4 mt-0">Inputs</h3>
            <div class="grid grid-cols-1 gap-4">
              <div>
                <label for="closingPrices" class="calc-label">Closing Prices (comma-separated)</label>
                <textarea id="closingPrices" class="calc-input" rows="4" placeholder="e.g., 120, 121, 122" inputmode="decimal">147.32,146.18,145.10,146.43,147.85,148.40,149.90,151.22,150.81,152.05,152.60,153.33,154.14,153.78,154.91,155.30,156.10,155.88,156.62,157.20,157.41,158.02,157.65,158.78,159.30</textarea>
              </div>
              <div>
                <label for="period" class="calc-label">Period (days)</label>
                <input id="period" type="number" class="calc-input" value="20" step="1" min="1" inputmode="numeric">
              </div>
              <div>
                <label for="stdDev" class="calc-label">Standard Deviation Multiplier</label>
                <input id="stdDev" type="number" class="calc-input" value="2" step="0.1" min="0" inputmode="decimal">
              </div>
            </div>

            <div class="flex gap-3 mt-6">
              <button class="btn btn-primary flex-1" id="calcBtn" type="button">Calculate</button>
              <button class="btn btn-secondary flex-1 btnSecondary" id="resetBtn" type="button">Reset</button>
            </div>
          </div>
          <div data-canon-btnrow="1" style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;"></div>
        </section>

        <section class="card sticky-box" id="resultsCard" aria-label="Calculator results">
          <div class="result-box mb-4">
            <div class="text-xs font-bold text-gray-500 uppercase tracking-wide mb-1">Middle Band</div>
            <div class="result-value" id="middleBand">$0.00</div>
          </div>

          <div class="bg-white border border-gray-200 rounded-lg p-4">
            <div class="kpi-row">
              <span class="kpi-label">Upper Band</span>
              <span class="kpi-value" id="upperBand">$0.00</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Lower Band</span>
              <span class="kpi-value" id="lowerBand">$0.00</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Std Dev</span>
              <span class="kpi-value" id="stdDevValue">$0.00</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Data Points</span>
              <span class="kpi-value" id="dataPoints">0</span>
            </div>
          </div>

          <div class="flex gap-3 mt-4">
            <button class="btn btn-secondary flex-1" id="toggleSchedule" type="button" disabled>Show Data Table</button>
            <button class="btn btn-secondary flex-1" id="downloadCsv" type="button" disabled>Download CSV</button>
          </div>
        </section>
      </div>

      <div id="scheduleWrap" class="mt-6 overflow-x-auto border border-gray-200 rounded-lg tableWrap" style="display: none;" aria-label="Closing price table">
        <table class="schedule-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Closing Price</th>
              <th>Deviation</th>
              <th>Upper Gap</th>
              <th>Lower Gap</th>
            </tr>
          </thead>
          <tbody id="scheduleBody"></tbody>
        </table>
        <div class="p-3 text-gray-500 text-sm bg-gray-50">Displaying the most recent readings. Download CSV for the complete dataset.</div>
      </div>

      <div class="flex flex-col lg:flex-row gap-8 mt-10">
        <section class="w-full lg:w-2/3 space-y-8">
          <section class="card content-card space-y-6" id="howToUse" aria-label="How to use and methodology">
            <h2 class="text-2xl font-semibold">How to Use This Calculator</h2>
            <p>Paste or type your historical closing prices separated by commas. Set the lookback period and the multiplier you prefer for the standard deviation band. Hit Calculate or wait for the inputs to settle after editing; results refresh automatically without producing NaN or Infinity.</p>

            <h2 class="text-2xl font-semibold mt-6">Methodology</h2>
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
              <p>The calculator finds the simple moving average (SMA) over the selected period, computes the standard deviation of those same closing prices, and then plots the upper and lower bands by adding and subtracting the multiplier times the standard deviation from the SMA. That gives you a volatility envelope aligned with how technical analysts expect Bollinger Bands to behave.</p>
            </div>
            <ul class="list-disc pl-5 mt-4 space-y-2 text-gray-700">
              <li>Middle band equals the SMA of the latest data points.</li>
              <li>Upper and lower bands stretch equally above and below the SMA according to the std dev multiplier.</li>
              <li>All input parsing is deterministic so that the calculator never surfaces NaN or Infinity.</li>
            </ul>
            <div class="mt-4 bg-gray-50 border border-gray-200 rounded-lg p-4 text-sm text-gray-700">
              Results are estimates for informational purposes only. Always confirm with live market data or a licensed advisor before trading decisions.</div>

            <div class="space-y-4 mt-6">
              <h3 class="text-xl font-semibold">Full original guide (expanded)</h3>
              <section>
                <h4 class="text-lg font-semibold">Data Source and Methodology</h4>
                <p>All calculations are based on the widely accepted Bollinger Bands formula. For more details on the application of Bollinger Bands, please visit <a href="https://www.iforex.in/education-center/bollinger-bands" rel="noopener" target="_blank" class="text-blue-600 hover:underline">iForex Education Center</a>. All calculations adhere strictly to the methodologies outlined therein.</p>
              </section>
              <section>
                <h4 class="text-lg font-semibold">The Formula Explained</h4>
                <div class="formula-box">
                  <p><strong>Bollinger Bands:</strong> Middle Band = SMA(N), Upper Band = SMA(N) + (K × StdDev), Lower Band = SMA(N) − (K × StdDev)</p>
                </div>
              </section>
              <section>
                <h4 class="text-lg font-semibold">Glossary of Variables</h4>
                <ul class="list-disc pl-5 space-y-1 text-gray-700">
                  <li><strong>Closing Prices:</strong> The end-of-day prices for a given period.</li>
                  <li><strong>Period:</strong> Number of days over which to calculate the moving average.</li>
                  <li><strong>Standard Deviation Multiplier:</strong> The multiplier applied to the standard deviation to calculate the bands.</li>
                </ul>
              </section>
              <section>
                <h4 class="text-lg font-semibold">Frequently Asked Questions (FAQ)</h4>
                <div class="space-y-3 text-gray-700">
                  <p><strong>How are Bollinger Bands calculated?</strong><br>Bollinger Bands are calculated using a simple moving average and the standard deviation of the asset's price over a specified period.</p>
                  <p><strong>What do Bollinger Bands indicate?</strong><br>They indicate market volatility and can signal potential overbought or oversold conditions.</p>
                </div>
              </section>
            </div>
          </section>

          <section class="card meta-section space-y-4" id="pageMeta" aria-label="Verification, changelog, formulas, citations">
            <details id="formulaDetails">
              <summary class="cursor-pointer font-bold text-gray-800">Formulas</summary>
              <div class="mt-3 p-3 bg-white border border-gray-200 rounded-lg text-sm">
                <p><strong>Core formula:</strong></p>
                <p class="font-mono mt-2">Middle Band = SMA(N)</p>
                <p class="font-mono">Upper Band = SMA(N) + (K × StdDev)</p>
                <p class="font-mono">Lower Band = SMA(N) − (K × StdDev)</p>
                <ul class="list-disc list-inside mt-2 text-gray-600">
                  <li>SMA(N): Simple moving average over the selected period.</li>
                  <li>StdDev: Standard deviation of the same set of closing prices.</li>
                  <li>K: Multiplier (default 2) that widens or narrows the volatility envelope.</li>
                </ul>
              </div>
            </details>

            <details class="mt-3" id="citationDetails">
              <summary class="cursor-pointer font-bold text-gray-800">Citations</summary>
              <div class="mt-3 p-3 bg-white border border-gray-200 rounded-lg text-sm">
                <p>iForex Education Center: <a href="https://www.iforex.in/education-center/bollinger-bands" target="_blank" rel="noopener" class="text-blue-600 hover:underline">https://www.iforex.in/education-center/bollinger-bands</a></p>
              </div>
            </details>

            <details class="mt-3" id="changelogDetails">
              <summary class="cursor-pointer font-bold text-gray-800">Changelog</summary>
              <div class="mt-3 p-3 bg-white border border-gray-200 rounded-lg text-sm space-y-3">
                <div>
                  <strong>Version:</strong> 0.1.0-draft<br>
                  <strong>Last code update:</strong> 2026-01-19
                </div>
                <ul class="list-disc list-inside space-y-1">
                  <li>0.1.0-draft — 2026-01-19: Initial audit spec draft generated from HTML extraction (review required).</li>
                  <li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
                  <li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
                </ul>
              </div>
            </details>

            <div class="flex gap-2 mt-4 flex-wrap">
              <span class="inline-flex items-center gap-1 border border-gray-200 px-3 py-1 rounded-full bg-white text-sm">
                <span class="text-green-600 font-bold">✓</span> Verified by Ugo Candido
              </span>
              <span class="inline-flex items-center border border-gray-200 px-3 py-1 rounded-full bg-white text-sm">Last Updated: 2026-01-19</span>
              <span class="inline-flex items-center border border-gray-200 px-3 py-1 rounded-full bg-white text-sm">Version 0.1.0-draft</span>
            </div>
          
          <div class="badge" id="versionBadge">Version 1.5.0</div></section>
        </section>

        <aside class="w-full lg:w-1/3">
          <div class="sticky top-24 space-y-8">
            <div id="sidebar-ad-placeholder-top"></div>
            <div class="bg-white p-6 rounded-lg shadow-md">
              <h3 class="font-bold text-lg mb-4">Related Calculators</h3>
              <ul class="space-y-3">
                <li><a href="https://calcdomain.com/mortgage-payment" class="text-blue-600 hover:underline">Mortgage Payment Calculator</a></li>
                <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-blue-600 hover:underline">Auto Loan Calculator</a></li>
                <li><a href="https://calcdomain.com/loan-payoff" class="text-blue-600 hover:underline">Loan Payoff Calculator</a></li>
                <li><a href="https://calcdomain.com/refinance-calculator" class="text-blue-600 hover:underline">Refinance Calculator</a></li>
                <li><a href="https://calcdomain.com/amortization-calculator" class="text-blue-600 hover:underline">Amortization Calculator</a></li>
                <li><a href="https://calcdomain.com/compound-interest" class="text-blue-600 hover:underline">Compound Interest Calculator</a></li>
              </ul>
            </div>
          </div>
        </aside>
      </div>
    </main>

    <footer id="siteFooter" class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.</p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
              <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health &amp; Fitness</a></li>
              <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math &amp; Conversions</a></li>
              <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle &amp; Everyday</a></li>
              <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction &amp; DIY</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
              <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
              <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
              <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
              <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
              <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
              <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
              <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
              <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
            </ul>
          </div>
        </div>
        <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
          <p>© 2026 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>
    <script>
      window.MathJax = {
        tex: { inlineMath: [['\\(','\\)'], ['$', '$']], displayMath: [['$', '$'], ['\\[', '\\]']] },
        svg: { fontCache: 'global' }
      };
    </script>
    <script>
      (function () {
        var loadMathJax = function () {
          if (window.__mathjaxLoading) return;
          window.__mathjaxLoading = true;
          var script = document.createElement("script");
          script.id = "MathJax-script";
          script.async = true;
          script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
          document.head.appendChild(script);
        };

        var target = document.querySelector(
          ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
        );

        if (!target) return;

        if ("IntersectionObserver" in window) {
          var observer = new IntersectionObserver(
            function (entries) {
              if (entries.some(function (entry) { return entry.isIntersecting; })) {
                observer.disconnect();
                loadMathJax();
              }
            },
            { rootMargin: "200px" }
          );
          observer.observe(target);
        } else {
          window.addEventListener(
            "load",
            function () {
              setTimeout(loadMathJax, 1000);
            },
            { once: true }
          );
        }
      })();
    </script>
    <script>
      (function() {
        'use strict';

        const debounce = (fn, delay = 100) => {
          let timer;
          return (...args) => {
            clearTimeout(timer);
            timer = setTimeout(() => fn(...args), delay);
          };
        };

        const round2 = (value) => {
          if (!Number.isFinite(value)) return 0;
          return Math.round((value + Number.EPSILON) * 100) / 100;
        };

        const fmtNumber = (value) => {
          const safe = Number.isFinite(value) ? value : 0;
          return '</script> + round2(safe).toFixed(2);
        };

        const els = {
          closingPrices: document.getElementById('closingPrices'),
          period: document.getElementById('period'),
          stdDev: document.getElementById('stdDev'),
          middleBand: document.getElementById('middleBand'),
          upperBand: document.getElementById('upperBand'),
          lowerBand: document.getElementById('lowerBand'),
          stdDevValue: document.getElementById('stdDevValue'),
          dataPoints: document.getElementById('dataPoints'),
          errorBox: document.getElementById('errorBox'),
          scheduleWrap: document.getElementById('scheduleWrap'),
          scheduleBody: document.getElementById('scheduleBody'),
          toggleSchedule: document.getElementById('toggleSchedule'),
          downloadCsv: document.getElementById('downloadCsv'),
          calcBtn: document.getElementById('calcBtn'),
          resetBtn: document.getElementById('resetBtn')
        };

        const DEFAULT_PRICES = '147.32,146.18,145.10,146.43,147.85,148.40,149.90,151.22,150.81,152.05,152.60,153.33,154.14,153.78,154.91,155.30,156.10,155.88,156.62,157.20,157.41,158.02,157.65,158.78,159.30';
        const DEFAULT_PERIOD = '20';
        const DEFAULT_STD_MULTIPLIER = '2';

        let currentSchedule = [];

        function parseInputs() {
          const rawPrices = els.closingPrices.value.split(/[,\n]+/).map((item) => item.trim()).filter(Boolean);
          const prices = rawPrices.map((item) => Number(item)).filter(Number.isFinite);
          return {
            prices,
            period: parseInt(els.period.value, 10),
            stdDevMultiplier: parseFloat(els.stdDev.value)
          };
        }

        function validate(inputs) {
          const errors = [];
          if (inputs.period < 1 || !Number.isFinite(inputs.period)) {
            errors.push('Period must be 1 or greater.');
          }
          if (!Number.isFinite(inputs.stdDevMultiplier) || inputs.stdDevMultiplier < 0) {
            errors.push('Standard deviation multiplier must be 0 or greater.');
          }
          if (inputs.prices.length < inputs.period) {
            errors.push('Provide at least as many closing prices as the selected period.');
          }
          if (inputs.prices.length === 0) {
            errors.push('At least one closing price is required.');
          }
          return { ok: errors.length === 0, errors };
        }

        function compute(inputs) {
          const { prices, period, stdDevMultiplier } = inputs;
          const relevant = prices.slice(-period);
          if (relevant.length < period) return null;
          const sma = relevant.reduce((sum, price) => sum + price, 0) / period;
          const variance = relevant.reduce((acc, price) => acc + Math.pow(price - sma, 2), 0) / period;
          const deviation = Math.sqrt(variance);
          const upper = sma + (stdDevMultiplier * deviation);
          const lower = sma - (stdDevMultiplier * deviation);
          const schedule = relevant.map((price, index) => {
            const diff = price - sma;
            return {
              num: prices.length - relevant.length + index + 1,
              close: round2(price),
              deviation: round2(diff),
              upperGap: round2(upper - price),
              lowerGap: round2(price - lower)
            };
          });
          return {
            middleBand: round2(sma),
            upperBand: round2(upper),
            lowerBand: round2(lower),
            stdDev: round2(deviation),
            dataPoints: prices.length,
            schedule
          };
        }

        function formatValues(results) {
          return {
            middleBand: fmtNumber(results.middleBand),
            upperBand: fmtNumber(results.upperBand),
            lowerBand: fmtNumber(results.lowerBand),
            stdDev: fmtNumber(results.stdDev),
            dataPoints: results.dataPoints.toString(),
            schedule: results.schedule
          };
        }

        function render(formatted, errors) {
          if (errors.length > 0) {
            els.errorBox.style.display = 'block';
            els.errorBox.textContent = errors.join(' ');
            els.toggleSchedule.disabled = true;
            els.downloadCsv.disabled = true;
            els.scheduleWrap.style.display = 'none';
            els.toggleSchedule.textContent = 'Show Data Table';
            currentSchedule = [];
            return;
          }
          els.errorBox.style.display = 'none';
          els.errorBox.textContent = '';

          els.middleBand.textContent = formatted.middleBand;
          els.upperBand.textContent = formatted.upperBand;
          els.lowerBand.textContent = formatted.lowerBand;
          els.stdDevValue.textContent = formatted.stdDev;
          els.dataPoints.textContent = formatted.dataPoints;

          const scheduleRows = formatted.schedule || [];
          currentSchedule = scheduleRows;
          els.toggleSchedule.disabled = currentSchedule.length === 0;
          els.downloadCsv.disabled = currentSchedule.length === 0;
          if (els.scheduleWrap.style.display === 'block' && currentSchedule.length > 0) {
            renderTable();
          }
        }

        function renderTable() {
          els.scheduleBody.innerHTML = '';
          const frag = document.createDocumentFragment();
          for (const row of currentSchedule) {
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${row.num}</td>
              <td>${fmtNumber(row.close)}</td>
              <td>${fmtNumber(row.deviation)}</td>
              <td>${fmtNumber(row.upperGap)}</td>
              <td>${fmtNumber(row.lowerGap)}</td>
            `;
            frag.appendChild(tr);
          }
          els.scheduleBody.appendChild(frag);
        }

        function update() {
          const inputs = parseInputs();
          const validation = validate(inputs);
          if (!validation.ok) {
            render({}, validation.errors);
            return;
          }
          const results = compute(inputs);
          if (!results) {
            render({}, ['Unable to compute with the provided inputs.']);
            return;
          }
          const formatted = formatValues(results);
          render(formatted, []);
        }

        els.calcBtn.addEventListener('click', update);
        els.resetBtn.addEventListener('click', () => {
          els.closingPrices.value = DEFAULT_PRICES;
          els.period.value = DEFAULT_PERIOD;
          els.stdDev.value = DEFAULT_STD_MULTIPLIER;
    const debouncedUpdate = debounce(update, 100);

    document.querySelectorAll('#inputsCard input, #inputsCard select, #inputsCard textarea')
      .forEach((el) => {
        el.addEventListener('input', debouncedUpdate);
        el.addEventListener('change', debouncedUpdate);
      });

          update();
        });

        els.toggleSchedule.addEventListener('click', () => {
          const isHidden = els.scheduleWrap.style.display !== 'block';
          els.scheduleWrap.style.display = isHidden ? 'block' : 'none';
          els.toggleSchedule.textContent = isHidden ? 'Hide Data Table' : 'Show Data Table';
          if (isHidden && currentSchedule.length > 0) {
            renderTable();
          }
        });

        els.downloadCsv.addEventListener('click', () => {
          if (currentSchedule.length === 0) return;
          let csv = '#,Closing Price,Deviation,Upper Gap,Lower Gap\n';
          for (const row of currentSchedule) {
            csv += `${row.num},${row.close},${row.deviation},${row.upperGap},${row.lowerGap}\n`;
          }
          const blob = new Blob([csv], { type: 'text/csv' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'bollinger-data.csv';
          a.click();
          URL.revokeObjectURL(url);
        });

        [els.closingPrices, els.period, els.stdDev].forEach((el) => {
          el.addEventListener('input', debouncedUpdate);
          el.addEventListener('change', debouncedUpdate);
        });

        update();
      })();
    </script>
</body></html>

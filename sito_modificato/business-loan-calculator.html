<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/business-loan-calculator">





<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Business Loan Calculator - Calculate Payments &amp; Amortization</title>
<meta name="description" content="Calculate your business loan payment, total interest, and full amortization schedule. Enter loan amount, APR, and term to get instant, accurate results.">


<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0KOxRfckZHNgsSCjWNBNYRdonEchfV8B2S/YlGceeoEES1rX+EVdo" crossorigin="anonymous">
<script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGjKrxZssNNgtgkexiX+bH3eJVwDEzZaXnFvhbYqsB/4eLGxNrgIChGCSB" crossorigin="anonymous"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURPlLJSytgoCNCIySrSCTEBbvX7inM4VLxS+ZJIYU1AkatxaYhFPER" crossorigin="anonymous" onload="renderMathInElement(document.body, {
      delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false}
      ]
    });"></script>

<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol, .prose dl { margin-bottom: 1rem; }
.prose li, .prose dt, .prose dd { margin-bottom: 0.5rem; }
.prose dt { font-weight: 600; }
.prose dd { margin-left: 1.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1.5rem;
overflow-x:auto; text-align: center; font-size: 1.1rem;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }
/* Custom focus state for WCAG AA */
.form-input:focus, .form-select:focus, .tooltip-btn:focus {
outline: 3px solid #3b82f6;
outline-offset: 2px;
box-shadow: none;
border-color: #3b82f6;
}
.form-input.invalid, .form-select.invalid {
border-color: #ef4444;
}
.form-input.invalid:focus {
outline-color: #ef4444;
border-color: #ef4444;
}
.error-message {
color: #dc2626;
font-size: 0.875rem;
margin-top: 0.5rem;
display: none; /* Hidden by default */
}
.tooltip-btn {
display: inline-flex;
align-items: center;
justify-content: center;
width: 1.25rem;
height: 1.25rem;
border-radius: 9999px;
border: 1px solid #9ca3af;
background: #f9fafb;
color: #6b7280;
margin-left: 0.5rem;
cursor: pointer;
}
.tooltip-content {
display: none; /* Hidden by default */
background: #1f2937;
color: #fff;
padding: 0.75rem;
border-radius: 6px;
font-size: 0.875rem;
position: absolute;
z-index: 10;
width: 250px;
bottom: 110%;
left: 50%;
transform: translateX(-50%);
box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.tooltip-content::after {
content: '';
position: absolute;
top: 100%;
left: 50%;
margin-left: -5px;
border-width: 5px;
border-style: solid;
border-color: #1f2937 transparent transparent transparent;
}
/* Prevent CLS on results load */
#results {
min-height: 320px;
}
@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
#results-chart-container { display: none !important; }
}
</style>

<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Business Loan Calculator - Calculate Payments & Amortization",
  "description": "Calculate your business loan payment, total interest, and full amortization schedule. Enter loan amount, APR, and term to get instant, accurate results.",
  "url": "https://calcdomain.com/business-loan-calculator",
  "inLanguage": "en",
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "dateModified": "2026-01-19"
}</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Finance",
      "item": "https://calcdomain.com/categories/finance"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Business Small Biz",
      "item": "https://calcdomain.com/subcategories/business-small-biz"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to Use the Business Loan Calculator",
  "description": "A step-by-step guide to calculating your business loan payments and total costs.",
  "step": [
    {
      "@type": "HowToStep",
      "name": "Enter Loan Amount",
      "text": "Input the total principal amount you plan to borrow for your business."
    },
    {
      "@type": "HowToStep",
      "name": "Enter Interest Rate",
      "text": "Input the Annual Percentage Rate (APR) quoted by your lender."
    },
    {
      "@type": "HowToStep",
      "name": "Enter Loan Term",
      "text": "Input the total length of the loan in years."
    },
    {
      "@type": "HowToStep",
      "name": "Select Payment Frequency",
      "text": "Choose how often you will make payments (Monthly, Bi-Weekly, or Weekly)."
    },
    {
      "@type": "HowToStep",
      "name": "Review Results",
      "text": "The calculator will instantly display your periodic payment, total principal, total interest, total cost, and a full amortization schedule."
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is amortization?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Amortization is the process of spreading out a loan into a series of fixed payments over time. Each payment consists of both principal and interest. In the beginning, a larger portion of the payment goes toward interest, and as the loan matures, a larger portion goes toward paying down the principal."
      }
    },
    {
      "@type": "Question",
      "name": "What is the difference between APR and interest rate?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The interest rate is the cost of borrowing the money, expressed as a percentage. The Annual Percentage Rate (APR) is a broader measure that includes the interest rate plus any lender fees, origination fees, or other costs associated with the loan. APR gives you a more complete picture of the loan's true cost."
      }
    },
    {
      "@type": "Question",
      "name": "Can I make extra payments on my business loan?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Most business loans allow for prepayments, which can help you pay off the loan faster and save on total interest. However, you must check your loan agreement for any 'prepayment penalties.' This calculator assumes no prepayments are made."
      }
    },
    {
      "@type": "Question",
      "name": "How is this different from a simple interest loan?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "This calculator uses an amortizing formula, where interest is calculated on the *remaining balance* of the loan. A simple interest loan calculates interest based on the *original principal* for the entire loan term, which is less common for standard business term loans."
      }
    },
    {
      "@type": "Question",
      "name": "What information do I need to apply for a business loan?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Lenders typically require a detailed business plan, personal and business financial statements (like balance sheets and income statements), tax returns, bank statements, and legal documents (like articles of incorporation). Use this calculator to model different scenarios before you apply."
      }
    }
  ]
}
</script>
<script src="search.js" defer=""></script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">


<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[', right: '\]</div>
  <pre class="auditspine-mono">', right: '</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[M = P \frac{i(1 + i)^n}{(1 + i)^n - 1}\]</div>
  <pre class="auditspine-mono">M = P \frac{i(1 + i)^n}{(1 + i)^n - 1}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[M = 50,000 \frac{0.00625(1 + 0.00625)^{60}}{(1 + 0.00625)^{60} - 1}\]</div>
  <pre class="auditspine-mono">M = 50,000 \frac{0.00625(1 + 0.00625)^{60}}{(1 + 0.00625)^{60} - 1}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[M = 50,000 \frac{0.00625(1.45329...)}{(1.45329...) - 1}\]</div>
  <pre class="auditspine-mono">M = 50,000 \frac{0.00625(1.45329...)}{(1.45329...) - 1}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[M = 50,000 \frac{0.009083...}{0.45329...}\]</div>
  <pre class="auditspine-mono">M = 50,000 \frac{0.009083...}{0.45329...}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[M = 50,000 \times 0.020038...\]</div>
  <pre class="auditspine-mono">M = 50,000 \times 0.020038...</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$ M = P \frac{i(1 + i)^n}{(1 + i)^n - 1} $</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><span class="auditspine-mono">P</span> = principal (loan amount) <em>(currency)</em></li>
<li><span class="auditspine-mono">r</span> = periodic interest rate (annual rate ÷ payments per year) <em>(1)</em></li>
<li><span class="auditspine-mono">n</span> = total number of payments (years × payments per year) <em>(count)</em></li>
<li><span class="auditspine-mono">M</span> = periodic payment for principal + interest <em>(currency)</em></li>
<li><span class="auditspine-mono">T</span> = property tax (annual or monthly depending on input) <em>(currency)</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Home</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/" target="_blank" rel="nofollow noopener">https://calcdomain.com/</a></li>
<li><strong>Finance</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/finance" target="_blank" rel="nofollow noopener">https://calcdomain.com/finance</a></li>
<li><strong>Business &amp; Small Biz</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/business-small-biz" target="_blank" rel="nofollow noopener">https://calcdomain.com/subcategories/business-small-biz</a></li>
<li><strong>SBA Loan Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/sba-loan-calculator" target="_blank" rel="nofollow noopener">https://calcdomain.com/sba-loan-calculator</a></li>
<li><strong>Startup Costs Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/startup-costs" target="_blank" rel="nofollow noopener">https://calcdomain.com/startup-costs</a></li>
<li><strong>Business Valuation Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/business-valuation-calculator" target="_blank" rel="nofollow noopener">https://calcdomain.com/business-valuation-calculator</a></li>
<li><strong>Profit Margin Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/profit-margin-calculator" target="_blank" rel="nofollow noopener">https://calcdomain.com/profit-margin-calculator</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-10 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300×600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why Use This Calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Instantly see your periodic payment (monthly, bi-weekly, weekly).</li>
<li>Visualize the total interest vs. principal with an interactive chart.</li>
<li>Generate a full amortization schedule to understand your payment breakdown.</li>
<li>Compare different loan offers by changing the APR and term.</li>
<li>Empower your business planning and financial forecasting.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Business Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="https://calcdomain.com/sba-loan-calculator" class="text-blue-600 hover:underline">SBA Loan Calculator</a></li>
<li><a href="https://calcdomain.com/startup-costs" class="text-blue-600 hover:underline">Startup Costs Calculator</a></li>
<li><a href="https://calcdomain.com/business-valuation-calculator" class="text-blue-600 hover:underline">Business Valuation Calculator</a></li>
<li><a href="https://calcdomain.com/profit-margin-calculator" class="text-blue-600 hover:underline">Profit Margin Calculator</a></li>
<li>Break-Even Point Calculator</li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>














<script defer="">
document.addEventListener('DOMContentLoaded', () => {
    // --- DOM Element Cache ---
    const elements = {
        form: document.getElementById('calculator-form'),
        loanAmount: document.getElementById('loanAmount'),
        interestRate: document.getElementById('interestRate'),
        loanTerm: document.getElementById('loanTerm'),
        paymentFrequency: document.getElementById('paymentFrequency'),
        startDate: document.getElementById('startDate'),
        paymentPerPeriod: document.getElementById('paymentPerPeriod'),
        totalPrincipal: document.getElementById('totalPrincipal'),
        totalInterest: document.getElementById('totalInterest'),
        totalCost: document.getElementById('totalCost'),
        scheduleBody: document.getElementById('scheduleBody'),
        aprTooltipBtn: document.getElementById('apr-tooltip-btn'),
        aprTooltip: document.getElementById('apr-tooltip')
    };

    const inputs = [elements.loanAmount, elements.interestRate, elements.loanTerm];
    let chartInstance = null;

    // --- Formatters ---
    const fmtCurrency = (val) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(val || 0);
    const fmtDate = new Intl.DateTimeFormat('en-US', { year: 'numeric', month: 'short' });

    // --- Validation Logic ---
    function validateField(input) {
        const errorEl = document.getElementById(`${input.id}-error`);
        let isValid = true;
        let errorMessage = '';

        const value = input.valueAsNumber;
        
        if (isNaN(value) || value <= (parseFloat(input.min) || 0)) {
            if (input.id === 'loanAmount') errorMessage = 'Loan amount must be greater than 0.';
            if (input.id === 'loanTerm') errorMessage = 'Term must be 1 year or more.';
            if (input.id === 'interestRate' && value < 0) errorMessage = 'Rate cannot be negative.';
            isValid = (input.id === 'interestRate' && value === 0) ? true : false; // 0% APR is valid
        }
        
        if (input.id === 'interestRate' && value > 100) {
            errorMessage = 'Rate seems too high (max 100%).';
            isValid = false;
        }

        if (isValid) {
            input.setAttribute('aria-invalid', 'false');
            input.classList.remove('invalid');
            errorEl.style.display = 'none';
        } else {
            input.setAttribute('aria-invalid', 'true');
            input.classList.add('invalid');
            errorEl.textContent = errorMessage;
            errorEl.style.display = 'block';
        }
        return isValid;
    }

    // --- Core Calculation Engine ---
    function calculateAmortization() {
        // 1. Validate all fields first
        let allValid = true;
        inputs.forEach(input => {
            if (!validateField(input)) {
                allValid = false;
            }
        });

        if (!allValid) {
            clearResults();
            return;
        }

        // 2. Get validated inputs
        const principal = elements.loanAmount.valueAsNumber || 0;
        const apr = elements.interestRate.valueAsNumber / 100;
        const termYears = elements.loanTerm.valueAsNumber || 0;
        const frequency = elements.paymentFrequency.value;

        // 3. Calculate periodic values
        let periodsPerYear;
        switch (frequency) {
            case 'weekly': periodsPerYear = 52; break;
            case 'biweekly': periodsPerYear = 26; break;
            default: periodsPerYear = 12;
        }

        const totalPayments = Math.round(termYears * periodsPerYear);
        const periodicRate = apr / periodsPerYear;

        // 4. Calculate payment (M)
        let periodicPayment;
        if (periodicRate === 0) {
            periodicPayment = principal / totalPayments;
        } else {
            const numerator = periodicRate * Math.pow(1 + periodicRate, totalPayments);
            const denominator = Math.pow(1 + periodicRate, totalPayments) - 1;
            periodicPayment = principal * (numerator / denominator);
        }

        // 5. Calculate totals
        const totalCost = periodicPayment * totalPayments;
        const totalInterest = totalCost - principal;

        // 6. Generate Schedule
        const schedule = [];
        let balance = principal;
        let runningInterest = 0;

        // Get start date
        let currentDate = new Date();
        if (elements.startDate.value) {
            const [year, month] = elements.startDate.value.split('-');
            currentDate = new Date(year, month - 1, 1);
        }
        currentDate.setHours(12); // Avoid DST issues

        for (let i = 1; i <= totalPayments; i++) {
            const interestPayment = balance * periodicRate;
            let principalPayment = periodicPayment - interestPayment;
            
            // Adjust last payment for float precision
            if (i === totalPayments) {
                principalPayment = balance;
                periodicPayment = balance + interestPayment;
            }
            
            balance -= principalPayment;
            if (balance < 0) balance = 0; // Prevent negative balance
            
            runningInterest += interestPayment;

            schedule.push({
                period: i,
                date: new Date(currentDate.getTime()),
                payment: periodicPayment,
                interest: interestPayment,
                principal: principalPayment,
                balance: balance
            });

            // Increment date
            switch (frequency) {
                case 'weekly': currentDate.setDate(currentDate.getDate() + 7); break;
                case 'biweekly': currentDate.setDate(currentDate.getDate() + 14); break;
                default: currentDate.setMonth(currentDate.getMonth() + 1);
            }
        }

        // 7. Update UI
        updateOutputs(periodicPayment, principal, totalInterest, totalCost);
        renderSchedule(schedule);
        renderChart(principal, totalInterest);
    }

    // --- UI Update Functions ---
    function updateOutputs(payment, principal, interest, cost) {
        elements.paymentPerPeriod.textContent = fmtCurrency(payment);
        elements.totalPrincipal.textContent = fmtCurrency(principal);
        elements.totalInterest.textContent = fmtCurrency(interest);
        elements.totalCost.textContent = fmtCurrency(cost);
    }

    function clearResults() {
        updateOutputs(0, 0, 0, 0);
        elements.scheduleBody.innerHTML = '<tr><td colspan="6" class="text-center p-4 text-gray-500">Enter valid loan details to generate the schedule.</td></tr>';
        renderChart(0, 0);
    }

    function renderSchedule(schedule) {
        const tbody = elements.scheduleBody;
        if (!schedule.length) {
            clearResults();
            return;
        }
        
        tbody.innerHTML = ''; // Clear previous
        schedule.forEach(row => {
            const tr = document.createElement('tr');
            tr.className = 'border-b border-gray-100 hover:bg-gray-50';
            tr.innerHTML = `
                <td class="px-4 py-2 text-left">${row.period}</td>
                <td class="px-4 py-2 text-left">${fmtDate.format(row.date)}</td>
                <td class="px-4 py-2">${fmtCurrency(row.payment)}</td>
                <td class="px-4 py-2">${fmtCurrency(row.interest)}</td>
                <td class="px-4 py-2">${fmtCurrency(row.principal)}</td>
                <td class="px-4 py-2 font-medium">${fmtCurrency(row.balance)}</td>`;
            tbody.appendChild(tr);
        });
    }

    function renderChart(principal, interest) {
        const ctx = document.getElementById('resultsChart');
        if (!ctx) return;

        const data = {
            labels: ['Total Principal', 'Total Interest'],
            datasets: [{
                data: [Math.max(0, principal), Math.max(0, interest)],
                backgroundColor: ['#2563eb', '#f97316'], // Blue, Orange
                borderWidth: 0
            }]
        };

        if (chartInstance) {
            chartInstance.data = data;
            chartInstance.update();
        } else {
            chartInstance = new Chart(ctx, {
                type: 'doughnut',
                data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom',
                            labels: { boxWidth: 12, padding: 15 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${fmtCurrency(context.raw)}`;
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });
        }
    }

    // --- Accessible Tooltip Logic ---
    function toggleTooltip() {
        const isHidden = elements.aprTooltip.style.display === 'none' || !elements.aprTooltip.style.display;
        elements.aprTooltip.style.display = isHidden ? 'block' : 'none';
        elements.aprTooltipBtn.setAttribute('aria-expanded', isHidden.toString());
    }

    elements.aprTooltipBtn.addEventListener('click', toggleTooltip);
    elements.aprTooltipBtn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            toggleTooltip();
        }
    });

    // Hide tooltip on outside click
    document.addEventListener('click', (e) => {
        if (!elements.aprTooltipBtn.contains(e.target) && !elements.aprTooltip.contains(e.target)) {
            elements.aprTooltip.style.display = 'none';
            elements.aprTooltipBtn.setAttribute('aria-expanded', 'false');
        }
    });
    
    // --- Mobile Menu Toggle ---
    const menuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    menuToggle.addEventListener('click', () => {
        const isHidden = mobileMenu.classList.contains('hidden');
        mobileMenu.classList.toggle('hidden');
        menuToggle.setAttribute('aria-expanded', !isHidden);
    });

    // --- Event Listeners ---
    elements.form.addEventListener('input', calculateAmortization);
    inputs.forEach(input => {
        input.addEventListener('blur', () => validateField(input));
    });

    // --- Initial Calculation ---
    calculateAmortization();
});
</script>

</body></html>
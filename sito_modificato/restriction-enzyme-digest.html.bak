<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/restriction-enzyme-digest" />
    <title>Restriction Enzyme Digest (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Restriction Enzyme Digest in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Restriction Enzyme Digest (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Restriction Enzyme Digest in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/restriction-enzyme-digest" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Restriction Enzyme Digest (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Restriction Enzyme Digest in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Science Calculators", "item": "https://calcdomain.com/categories/science"}, {"@type": "ListItem", "position": 3, "name": "Biology Calculators", "item": "https://calcdomain.com/subcategories/biology"}, {"@type": "ListItem", "position": 4, "name": "Restriction Enzyme Digest Calculator", "item": "https://calcdomain.com/restriction-enzyme-digest"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/science" class="text-blue-600 hover:underline">Science Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/biology" class="text-blue-600 hover:underline">Biology Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Restriction Enzyme Digest Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">
                Restriction Enzyme Digest Calculator
              </h1>
              <p class="text-gray-600">
                Paste a DNA sequence, choose one or two restriction enzymes, and
                instantly see cut sites, fragment sizes, and a visual digest
                map.
              </p>
            </header>

            <!-- Calculator UI -->
            <section
              aria-labelledby="digest-calculator-heading"
              class="space-y-6"
            >
              <h2 id="digest-calculator-heading" class="text-xl font-semibold">
                Restriction digest setup
              </h2>

              <!-- Sequence input -->
              <div>
                <label
                  for="sequence-input"
                  class="block text-sm font-medium text-gray-700 mb-1"
                >
                  DNA sequence (FASTA or plain)
                  <span class="text-gray-400 font-normal"
                    >(A, T, G, C only; others ignored)</span
                  >
                </label>
                <textarea
                  id="sequence-input"
                  rows="7"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 font-mono text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder=">Example plasmid&#10;GAATTCGCGGCCGCAAGCTT..."
                ></textarea>
                <div
                  class="mt-2 flex flex-wrap items-center gap-3 text-xs text-gray-500"
                >
                  <span id="seq-length-label">Length: 0 bp</span>
                  <button
                    type="button"
                    id="btn-clean-seq"
                    class="px-2 py-1 border border-gray-300 rounded text-xs hover:bg-gray-50"
                  >
                    Clean sequence
                  </button>
                  <button
                    type="button"
                    id="btn-demo-seq"
                    class="px-2 py-1 border border-blue-500 text-blue-600 rounded text-xs hover:bg-blue-50"
                  >
                    Load demo plasmid
                  </button>
                </div>
              </div>

              <!-- Topology -->
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <fieldset>
                  <legend class="block text-sm font-medium text-gray-700 mb-1">
                    DNA topology
                  </legend>
                  <div class="flex items-center gap-4 text-sm">
                    <label class="inline-flex items-center gap-1">
                      <input
                        type="radio"
                        name="topology"
                        value="circular"
                        class="text-blue-600 border-gray-300"
                        checked
                      />
                      <span>Circular (plasmid)</span>
                    </label>
                    <label class="inline-flex items-center gap-1">
                      <input
                        type="radio"
                        name="topology"
                        value="linear"
                        class="text-blue-600 border-gray-300"
                      />
                      <span>Linear (PCR product/genomic)</span>
                    </label>
                  </div>
                </fieldset>

                <fieldset>
                  <legend class="block text-sm font-medium text-gray-700 mb-1">
                    Digest type
                  </legend>
                  <div class="flex items-center gap-4 text-sm">
                    <label class="inline-flex items-center gap-1">
                      <input
                        type="radio"
                        name="digest-type"
                        value="single"
                        class="text-blue-600 border-gray-300"
                        checked
                      />
                      <span>Single digest</span>
                    </label>
                    <label class="inline-flex items-center gap-1">
                      <input
                        type="radio"
                        name="digest-type"
                        value="double"
                        class="text-blue-600 border-gray-300"
                      />
                      <span>Double digest</span>
                    </label>
                  </div>
                </fieldset>
              </div>

              <!-- Enzyme selection -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="border border-gray-200 rounded-md p-3">
                  <h3 class="text-sm font-semibold mb-2">Enzyme 1</h3>
                  <label
                    class="block text-xs font-medium text-gray-600 mb-1"
                    for="enzyme1-select"
                    >Common enzymes</label
                  >
                  <select
                    id="enzyme1-select"
                    class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm mb-2"
                  >
                    <option value="">-- Select enzyme --</option>
                  </select>
                  <div class="grid grid-cols-3 gap-2 text-xs">
                    <div>
                      <label
                        class="block text-[11px] text-gray-600 mb-0.5"
                        for="enzyme1-name"
                        >Name</label
                      >
                      <input
                        id="enzyme1-name"
                        type="text"
                        class="w-full border border-gray-300 rounded px-1.5 py-1 text-xs"
                        placeholder="EcoRI"
                      />
                    </div>
                    <div>
                      <label
                        class="block text-[11px] text-gray-600 mb-0.5"
                        for="enzyme1-site"
                        >Recognition</label
                      >
                      <input
                        id="enzyme1-site"
                        type="text"
                        class="w-full border border-gray-300 rounded px-1.5 py-1 text-xs"
                        placeholder="GAATTC"
                      />
                    </div>
                    <div>
                      <label
                        class="block text-[11px] text-gray-600 mb-0.5"
                        for="enzyme1-cut"
                        >Cut offset</label
                      >
                      <input
                        id="enzyme1-cut"
                        type="number"
                        class="w-full border border-gray-300 rounded px-1.5 py-1 text-xs"
                        placeholder="1"
                      />
                    </div>
                  </div>
                  <p class="mt-1 text-[11px] text-gray-500">
                    Offset is the cut position (0-based) from the 5′ end of the
                    recognition site on the top strand.
                  </p>
                </div>

                <div
                  class="border border-gray-200 rounded-md p-3 opacity-60"
                  id="enzyme2-panel"
                >
                  <h3 class="text-sm font-semibold mb-2">
                    Enzyme 2
                    <span class="text-gray-400 text-xs"
                      >(for double digest)</span
                    >
                  </h3>
                  <label
                    class="block text-xs font-medium text-gray-600 mb-1"
                    for="enzyme2-select"
                    >Common enzymes</label
                  >
                  <select
                    id="enzyme2-select"
                    class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm mb-2"
                  >
                    <option value="">-- Select enzyme --</option>
                  </select>
                  <div class="grid grid-cols-3 gap-2 text-xs">
                    <div>
                      <label
                        class="block text-[11px] text-gray-600 mb-0.5"
                        for="enzyme2-name"
                        >Name</label
                      >
                      <input
                        id="enzyme2-name"
                        type="text"
                        class="w-full border border-gray-300 rounded px-1.5 py-1 text-xs"
                        placeholder="HindIII"
                      />
                    </div>
                    <div>
                      <label
                        class="block text-[11px] text-gray-600 mb-0.5"
                        for="enzyme2-site"
                        >Recognition</label
                      >
                      <input
                        id="enzyme2-site"
                        type="text"
                        class="w-full border border-gray-300 rounded px-1.5 py-1 text-xs"
                        placeholder="AAGCTT"
                      />
                    </div>
                    <div>
                      <label
                        class="block text-[11px] text-gray-600 mb-0.5"
                        for="enzyme2-cut"
                        >Cut offset</label
                      >
                      <input
                        id="enzyme2-cut"
                        type="number"
                        class="w-full border border-gray-300 rounded px-1.5 py-1 text-xs"
                        placeholder="1"
                      />
                    </div>
                  </div>
                  <p class="mt-1 text-[11px] text-gray-500">
                    Leave blank if you only want a single-enzyme digest.
                  </p>
                </div>
              </div>

              <!-- Actions -->
              <div class="flex flex-wrap items-center gap-3 mt-2">
                <button
                  id="btn-run-digest"
                  type="button"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"
                >
                  Run digest
                </button>
                <button
                  id="btn-clear"
                  type="button"
                  class="inline-flex items-center px-3 py-2 border border-gray-300 text-sm rounded-md hover:bg-gray-50"
                >
                  Clear
                </button>
                <span id="error-message" class="text-sm text-red-600"></span>
              </div>
            </section>

            <!-- Results -->
            <section
              aria-labelledby="digest-results-heading"
              class="mt-8 space-y-4"
            >
              <h2 id="digest-results-heading" class="text-xl font-semibold">
                Digest results
              </h2>

              <!-- Summary -->
              <div
                id="results-summary"
                class="hidden bg-blue-50 border border-blue-100 text-sm rounded-md p-3 text-blue-900"
              >
                <p id="summary-text"></p>
              </div>

              <!-- Fragment table -->
              <div id="fragments-container" class="hidden">
                <h3 class="text-sm font-semibold mb-2">Fragments</h3>
                <div class="overflow-x-auto scrollbar-thin">
                  <table class="min-w-full text-xs border border-gray-200">
                    <thead class="bg-gray-100">
                      <tr>
                        <th class="px-2 py-1 border-b text-left font-semibold">
                          #
                        </th>
                        <th class="px-2 py-1 border-b text-left font-semibold">
                          Start (bp)
                        </th>
                        <th class="px-2 py-1 border-b text-left font-semibold">
                          End (bp)
                        </th>
                        <th class="px-2 py-1 border-b text-left font-semibold">
                          Length (bp)
                        </th>
                        <th class="px-2 py-1 border-b text-left font-semibold">
                          Cut ends
                        </th>
                      </tr>
                    </thead>
                    <tbody
                      id="fragments-tbody"
                      class="divide-y divide-gray-100"
                    ></tbody>
                  </table>
                </div>
              </div>

              <!-- Map -->
              <div id="map-container" class="hidden">
                <h3 class="text-sm font-semibold mb-2">
                  Restriction map (schematic)
                </h3>
                <div class="border border-gray-200 rounded-md p-3">
                  <div
                    class="flex flex-wrap items-center justify-between gap-3 mb-3 text-xs text-gray-600"
                  >
                    <div class="flex items-center gap-2">
                      <label class="inline-flex items-center gap-1">
                        <input
                          type="radio"
                          name="map-style"
                          value="circular"
                          class="text-blue-600 border-gray-300"
                          checked
                        />
                        <span>Circular</span>
                      </label>
                      <label class="inline-flex items-center gap-1">
                        <input
                          type="radio"
                          name="map-style"
                          value="linear"
                          class="text-blue-600 border-gray-300"
                        />
                        <span>Linear</span>
                      </label>
                    </div>
                    <div
                      id="map-legend"
                      class="flex flex-wrap items-center gap-2"
                    ></div>
                  </div>
                  <div class="w-full flex justify-center">
                    <svg
                      id="digest-map"
                      viewBox="0 0 260 260"
                      class="w-full max-w-xs text-gray-700"
                    ></svg>
                  </div>
                  <p class="mt-2 text-[11px] text-gray-500">
                    Map is schematic and not to scale for very long sequences;
                    fragment order and relative sizes are preserved.
                  </p>
                </div>
              </div>

              <!-- Cut site list -->
              <div id="cuts-container" class="hidden">
                <h3 class="text-sm font-semibold mb-1">Cut positions</h3>
                <p class="text-xs text-gray-600 mb-1">
                  Positions are 1-based relative to the 5′ end of the input
                  sequence.
                </p>
                <div
                  id="cuts-list"
                  class="text-xs text-gray-800 space-y-1"
                ></div>
              </div>
            </section>

            <!-- Explanatory content -->
            <section class="prose mt-10">
              <h2>How this restriction enzyme digest calculator works</h2>
              <p>
                This tool performs a virtual restriction digest on your DNA
                sequence. It scans for recognition sites of one or two
                restriction enzymes, computes the cut positions, and then
                derives the resulting fragment sizes and a simple restriction
                map.
              </p>

              <h3>1. Cleaning and parsing your DNA sequence</h3>
              <p>
                The calculator accepts plain DNA sequences or FASTA-formatted
                input. Any header lines starting with <code>&gt;</code>
                are ignored, and only the characters A, T, G, and C
                (case-insensitive) are kept. All other symbols (spaces, numbers,
                ambiguous bases) are removed before analysis.
              </p>

              <div class="formula-box text-sm">
                <p class="font-semibold mb-1">Effective sequence length</p>
                <p>
                  If your raw input has length \(N_{\text{raw}}\) and contains
                  \(N_{\text{valid}}\) valid bases (A/T/G/C), the calculator
                  uses:
                </p>
                <p class="mt-1">\( L = N_{\text{valid}} \quad \text{(bp)} \)</p>
              </div>

              <h3>2. Recognition sites and cut positions</h3>
              <p>Each restriction enzyme is defined by:</p>
              <ul>
                <li><strong>Name</strong> (e.g., EcoRI, HindIII)</li>
                <li><strong>Recognition sequence</strong> (e.g., GAATTC)</li>
                <li>
                  <strong>Cut offset</strong>: the 0-based index of the
                  phosphodiester bond cut relative to the 5′ end of the
                  recognition site on the top strand.
                </li>
              </ul>
              <p>
                For simplicity, this calculator assumes a single cut per
                recognition site and does not model staggered vs. blunt ends in
                detail; it focuses on fragment boundaries and sizes.
              </p>

              <h3>3. Fragment size calculation</h3>
              <p>
                After finding all cut positions for the selected enzymes, the
                tool sorts them and computes fragment lengths.
              </p>
              <h4>Linear DNA</h4>
              <p>
                For a linear molecule of length \(L\) with cut positions \(c_1,
                c_2, \dots, c_n\) (0-based, sorted), the fragment lengths are:
              </p>
              <ul>
                <li>First fragment: \( f_1 = c_1 - 0 \)</li>
                <li>
                  Intermediate fragments: \( f_i = c_i - c_{i-1} \) for \( i =
                  2, \dots, n \)
                </li>
                <li>Last fragment: \( f_{n+1} = L - c_n \)</li>
              </ul>

              <h4>Circular DNA</h4>
              <p>
                For a circular plasmid, the ends are joined, so the last
                fragment wraps around:
              </p>
              <ul>
                <li>
                  Fragments: \( f_i = c_i - c_{i-1} \) for \( i = 2, \dots, n \)
                </li>
                <li>
                  Wrap-around fragment: \( f_{\text{wrap}} = L - c_n + c_1 \)
                </li>
              </ul>

              <h3>4. Single vs. double digest</h3>
              <p>
                In a <strong>single digest</strong>, only one enzyme is used;
                all cut positions come from that enzyme. In a
                <strong>double digest</strong>, the calculator:
              </p>
              <ol>
                <li>Finds all recognition sites for enzyme 1 and enzyme 2.</li>
                <li>Combines and sorts all unique cut positions.</li>
                <li>Applies the fragment formulas above to the merged list.</li>
              </ol>
              <p>
                This mirrors how a real double digest generates a fragment
                pattern determined by the union of both enzymes’ cut sites.
              </p>

              <h2>Practical tips for planning a restriction digest</h2>
              <p>
                While this calculator focuses on the <em>in silico</em> map,
                successful wet-lab restriction digests also depend on buffer
                conditions, enzyme activity, and DNA quality.
              </p>
              <ul>
                <li>
                  <strong>Check buffer compatibility:</strong> For double
                  digests, choose a buffer where both enzymes have high activity
                  (consult the manufacturer’s chart).
                </li>
                <li>
                  <strong>Use enough units of enzyme:</strong> A common rule of
                  thumb is 1 unit per µg DNA for 1 hour in optimal conditions.
                </li>
                <li>
                  <strong>Avoid star activity:</strong> Excess enzyme, long
                  incubations, or non‑optimal buffers can cause off‑target cuts.
                </li>
                <li>
                  <strong>Consider methylation sensitivity:</strong> Some
                  enzymes do not cut methylated sites (e.g., dam/dcm methylation
                  in E. coli).
                </li>
              </ul>

              <h2>Limitations of this restriction digest calculator</h2>
              <ul>
                <li>
                  Assumes exact recognition sequences (no degenerate bases like
                  N, R, Y).
                </li>
                <li>
                  Does not model methylation, star activity, or partial digests.
                </li>
                <li>
                  Does not distinguish between 5′ overhang, 3′ overhang, or
                  blunt ends beyond reporting fragment boundaries.
                </li>
              </ul>
              <p>
                For critical cloning steps, always cross‑check with the enzyme
                supplier’s documentation and, if possible, validate your
                construct by sequencing.
              </p>
            </section>

            <!-- FAQ -->
            <section class="mt-10" id="faq">
              <h2 class="text-xl font-semibold mb-4">
                Restriction enzyme digest – FAQ
              </h2>
              <div class="space-y-3">
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    What is a restriction enzyme digest?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    A restriction enzyme digest is a reaction in which one or
                    more restriction endonucleases cut DNA at specific
                    recognition sequences. The resulting fragments can be
                    separated by gel electrophoresis or ligated into vectors for
                    cloning. This calculator simulates that process on your
                    sequence to predict fragment sizes and patterns.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    How accurate are the fragment sizes?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Fragment sizes are exact with respect to the input sequence
                    and recognition sites you specify. In real gels, apparent
                    sizes can differ slightly due to gel concentration, DNA
                    conformation (supercoiled vs. linear), and ladder choice,
                    but the relative fragment pattern should match the
                    simulation closely for complete digests.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Can I use this for genomic DNA digests?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    In principle yes, but genomic sequences are often very long
                    and contain many cut sites, leading to thousands of
                    fragments that are not individually resolvable on a standard
                    agarose gel. This tool is most useful for plasmids, PCR
                    products, and moderate‑length constructs (a few kb to tens
                    of kb).
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Why don’t I see any cut sites for my enzyme?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Common reasons include: (1) the recognition sequence is not
                    present in your DNA; (2) the recognition sequence was
                    entered incorrectly (orientation or spelling); or (3) the
                    sequence contains ambiguous bases that were stripped out
                    during cleaning. Try verifying the recognition site and
                    using the “Clean sequence” button before running the digest
                    again.
                  </p>
                </details>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Restriction, Enzyme, Digest, DNA sequence (FASTA or plain) (A, T, G, C only; others ignored), Circular (plasmid), Linear (PCR product/genomic), Single digest, Double digest.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>DNA sequence (FASTA or plain) (A, T, G, C only; others ignored)</li><li>Circular (plasmid)</li><li>Linear (PCR product/genomic)</li><li>Single digest</li><li>Double digest</li><li>Common enzymes -- Select enzyme -- Name Recognition Cut offset Offset is the cut position (0-based) from the 5′ end of the recognition site on the top strand. Enzyme 2 (for double digest) Common enzymes -- Select enzyme -- Name Recognition Cut offset Leave blank if you only want a single-enzyme digest. Run digest Clear Digest results Fragments # Start (bp) End (bp) Length (bp) Cut ends Restriction map (schematic) Circular</li><li>Linear</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Core Math &amp; Algebra tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/probability"
                  class="text-blue-600 hover:underline"
                  >Probability</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/quartile"
                  class="text-blue-600 hover:underline"
                  >Quartile</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/limit"
                  class="text-blue-600 hover:underline"
                  >Limit</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/integral"
                  class="text-blue-600 hover:underline"
                  >Integral</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/derivative"
                  class="text-blue-600 hover:underline"
                  >Derivative</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/statistics"
                  class="text-blue-600 hover:underline"
                  >Statistics</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/standard-deviation"
                  class="text-blue-600 hover:underline"
                  >Standard Deviation</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/binomial-distribution"
                  class="text-blue-600 hover:underline"
                  >Binomial Distribution</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/normal-distribution"
                  class="text-blue-600 hover:underline"
                  >Normal Distribution</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sample-size"
                  class="text-blue-600 hover:underline"
                  >Sample Size</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">
              More Science &amp; Biology tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/dna-to-protein-translator"
                  class="text-blue-600 hover:underline"
                  >DNA to Protein Translator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molecular-weight"
                  class="text-blue-600 hover:underline"
                  >Molecular Weight</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/dna-concentration"
                  class="text-blue-600 hover:underline"
                  >DNA Concentration</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/serial-dilution"
                  class="text-blue-600 hover:underline"
                  >Serial Dilution</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/primer-tm"
                  class="text-blue-600 hover:underline"
                  >Primer Tm (Design)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/qpcr-data-analysis-calculator"
                  class="text-blue-600 hover:underline"
                  >qPCR ΔΔCt</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Basic enzyme library with recognition site and cut offset (0-based from 5' end of site)
      const ENZYMES = [
        { name: "EcoRI", site: "GAATTC", cut: 1 },
        { name: "HindIII", site: "AAGCTT", cut: 1 },
        { name: "BamHI", site: "GGATCC", cut: 1 },
        { name: "XhoI", site: "CTCGAG", cut: 1 },
        { name: "NotI", site: "GCGGCCGC", cut: 2 },
        { name: "XbaI", site: "TCTAGA", cut: 1 },
        { name: "PstI", site: "CTGCAG", cut: 5 },
        { name: "SalI", site: "GTCGAC", cut: 1 },
        { name: "KpnI", site: "GGTACC", cut: 5 },
        { name: "NheI", site: "GCTAGC", cut: 1 },
      ];

      function populateEnzymeSelect(selectId) {
        const sel = document.getElementById(selectId);
        ENZYMES.forEach((e) => {
          const opt = document.createElement("option");
          opt.value = e.name;
          opt.textContent = `${e.name} (${e.site})`;
          sel.appendChild(opt);
        });
      }

      function cleanSequence(raw) {
        return raw
          .split(/\r?\n/)
          .filter((line) => !line.startsWith(">"))
          .join("")
          .toUpperCase()
          .replace(/[^ATGC]/g, "");
      }

      function updateSeqLength() {
        const raw = document.getElementById("sequence-input").value;
        const cleaned = cleanSequence(raw);
        document.getElementById(
          "seq-length-label"
        ).textContent = `Length: ${cleaned.length} bp`;
        return cleaned;
      }

      function getTopology() {
        const radios = document.querySelectorAll("input[name='topology']");
        for (const r of radios) if (r.checked) return r.value;
        return "circular";
      }

      function getDigestType() {
        const radios = document.querySelectorAll("input[name='digest-type']");
        for (const r of radios) if (r.checked) return r.value;
        return "single";
      }

      function getEnzymeFromInputs(prefix) {
        const name = document.getElementById(prefix + "-name").value.trim();
        const site = document
          .getElementById(prefix + "-site")
          .value.trim()
          .toUpperCase();
        const cutStr = document.getElementById(prefix + "-cut").value.trim();
        if (!name || !site) return null;
        const cut = cutStr === "" ? 0 : parseInt(cutStr, 10);
        if (isNaN(cut) || cut < 0 || cut > site.length) return null;
        return { name, site, cut };
      }

      function findCutPositions(seq, enzyme) {
        const positions = [];
        if (!enzyme) return positions;
        const site = enzyme.site;
        if (!site) return positions;
        let idx = seq.indexOf(site);
        while (idx !== -1) {
          const cutPos = idx + enzyme.cut; // 0-based in full sequence
          positions.push({ pos: cutPos, enzyme: enzyme.name });
          idx = seq.indexOf(site, idx + 1);
        }
        return positions;
      }

      function computeFragments(length, cuts, topology) {
        const sorted = [...cuts].sort((a, b) => a.pos - b.pos);
        const fragments = [];
        if (sorted.length === 0) {
          fragments.push({
            start: 0,
            end: length,
            len: length,
            from: "5′ end",
            to: topology === "circular" ? "5′ end (circular)" : "3′ end",
          });
          return fragments;
        }
        if (topology === "linear") {
          // first fragment
          fragments.push({
            start: 0,
            end: sorted[0].pos,
            len: sorted[0].pos - 0,
            from: "5′ end",
            to: `${sorted[0].enzyme} cut`,
          });
          // middle fragments
          for (let i = 1; i < sorted.length; i++) {
            fragments.push({
              start: sorted[i - 1].pos,
              end: sorted[i].pos,
              len: sorted[i].pos - sorted[i - 1].pos,
              from: `${sorted[i - 1].enzyme} cut`,
              to: `${sorted[i].enzyme} cut`,
            });
          }
          // last fragment
          fragments.push({
            start: sorted[sorted.length - 1].pos,
            end: length,
            len: length - sorted[sorted.length - 1].pos,
            from: `${sorted[sorted.length - 1].enzyme} cut`,
            to: "3′ end",
          });
        } else {
          // circular
          for (let i = 1; i < sorted.length; i++) {
            fragments.push({
              start: sorted[i - 1].pos,
              end: sorted[i].pos,
              len: sorted[i].pos - sorted[i - 1].pos,
              from: `${sorted[i - 1].enzyme} cut`,
              to: `${sorted[i].enzyme} cut`,
            });
          }
          // wrap fragment
          fragments.push({
            start: sorted[sorted.length - 1].pos,
            end: sorted[0].pos,
            len: length - sorted[sorted.length - 1].pos + sorted[0].pos,
            from: `${sorted[sorted.length - 1].enzyme} cut`,
            to: `${sorted[0].enzyme} cut`,
          });
        }
        return fragments;
      }

      function renderFragmentsTable(fragments, topology) {
        const tbody = document.getElementById("fragments-tbody");
        tbody.innerHTML = "";
        fragments.forEach((f, idx) => {
          const tr = document.createElement("tr");
          const start1 = f.start + 1;
          const end1 =
            topology === "circular" && f.end < f.start
              ? f.end + 1 + " (wrap)"
              : f.end + 1;
          tr.innerHTML = `
        <td class="px-2 py-1 border-b">${idx + 1}</td>
        <td class="px-2 py-1 border-b">${start1}</td>
        <td class="px-2 py-1 border-b">${end1}</td>
        <td class="px-2 py-1 border-b">${f.len}</td>
        <td class="px-2 py-1 border-b text-gray-600">${f.from} → ${f.to}</td>
      `;
          tbody.appendChild(tr);
        });
        document
          .getElementById("fragments-container")
          .classList.remove("hidden");
      }

      function renderCutsList(cuts) {
        const container = document.getElementById("cuts-list");
        container.innerHTML = "";
        if (cuts.length === 0) {
          container.textContent =
            "No cut sites found for the selected enzymes.";
          document.getElementById("cuts-container").classList.remove("hidden");
          return;
        }
        const grouped = {};
        cuts.forEach((c) => {
          if (!grouped[c.enzyme]) grouped[c.enzyme] = [];
          grouped[c.enzyme].push(c.pos + 1); // 1-based
        });
        Object.keys(grouped).forEach((name) => {
          const p = document.createElement("p");
          p.innerHTML = `<span class="font-semibold">${name}</span>: ${grouped[
            name
          ].join(", ")} bp`;
          container.appendChild(p);
        });
        document.getElementById("cuts-container").classList.remove("hidden");
      }

      function renderMap(length, cuts, topology) {
        const svg = document.getElementById("digest-map");
        svg.innerHTML = "";
        if (length === 0) return;

        const colors = {};
        const enzymes = [...new Set(cuts.map((c) => c.enzyme))];
        const palette = ["#2563eb", "#16a34a", "#f97316", "#dc2626", "#7c3aed"];
        enzymes.forEach((e, i) => {
          colors[e] = palette[i % palette.length];
        });

        // Legend
        const legend = document.getElementById("map-legend");
        legend.innerHTML = "";
        enzymes.forEach((e) => {
          const span = document.createElement("span");
          span.className = "inline-flex items-center gap-1 text-xs";
          span.innerHTML = `<span class="w-3 h-0.5 rounded-full" style="background:${colors[e]}"></span>${e}`;
          legend.appendChild(span);
        });

        const style =
          document.querySelector("input[name='map-style']:checked")?.value ||
          "circular";

        if (style === "linear" || topology === "linear") {
          // Draw a horizontal line with ticks
          const margin = 20;
          const width = 220;
          const y = 130;
          const x0 = margin;
          const x1 = margin + width;
          const scale = width / length;

          const line = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "line"
          );
          line.setAttribute("x1", x0);
          line.setAttribute("y1", y);
          line.setAttribute("x2", x1);
          line.setAttribute("y2", y);
          line.setAttribute("stroke", "#4b5563");
          line.setAttribute("stroke-width", "2");
          svg.appendChild(line);

          cuts.forEach((c) => {
            const x = x0 + c.pos * scale;
            const tick = document.createElementNS(
              "http://www.w3.org/2000/svg",
              "line"
            );
            tick.setAttribute("x1", x);
            tick.setAttribute("y1", y - 10);
            tick.setAttribute("x2", x);
            tick.setAttribute("y2", y + 10);
            tick.setAttribute("stroke", colors[c.enzyme] || "#2563eb");
            tick.setAttribute("stroke-width", "2");
            svg.appendChild(tick);

            const label = document.createElementNS(
              "http://www.w3.org/2000/svg",
              "text"
            );
            label.setAttribute("x", x);
            label.setAttribute("y", y - 14);
            label.setAttribute("text-anchor", "middle");
            label.setAttribute("font-size", "8");
            label.textContent = c.enzyme;
            svg.appendChild(label);
          });

          const lenLabel = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "text"
          );
          lenLabel.setAttribute("x", 130);
          lenLabel.setAttribute("y", y + 24);
          lenLabel.setAttribute("text-anchor", "middle");
          lenLabel.setAttribute("font-size", "9");
          lenLabel.textContent = `${length} bp`;
          svg.appendChild(lenLabel);
        } else {
          // Circular map
          const cx = 130,
            cy = 130,
            r = 80;
          const circle = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "circle"
          );
          circle.setAttribute("cx", cx);
          circle.setAttribute("cy", cy);
          circle.setAttribute("r", r);
          circle.setAttribute("fill", "none");
          circle.setAttribute("stroke", "#4b5563");
          circle.setAttribute("stroke-width", "2");
          svg.appendChild(circle);

          cuts.forEach((c) => {
            const angle = (c.pos / length) * 2 * Math.PI - Math.PI / 2;
            const xOuter = cx + r * Math.cos(angle);
            const yOuter = cy + r * Math.sin(angle);
            const xInner = cx + (r - 10) * Math.cos(angle);
            const yInner = cy + (r - 10) * Math.sin(angle);

            const tick = document.createElementNS(
              "http://www.w3.org/2000/svg",
              "line"
            );
            tick.setAttribute("x1", xInner);
            tick.setAttribute("y1", yInner);
            tick.setAttribute("x2", xOuter);
            tick.setAttribute("y2", yOuter);
            tick.setAttribute("stroke", colors[c.enzyme] || "#2563eb");
            tick.setAttribute("stroke-width", "2");
            svg.appendChild(tick);

            const labelRadius = r + 12;
            const xLabel = cx + labelRadius * Math.cos(angle);
            const yLabel = cy + labelRadius * Math.sin(angle);
            const label = document.createElementNS(
              "http://www.w3.org/2000/svg",
              "text"
            );
            label.setAttribute("x", xLabel);
            label.setAttribute("y", yLabel);
            label.setAttribute("font-size", "8");
            label.setAttribute("text-anchor", xLabel >= cx ? "start" : "end");
            label.textContent = c.enzyme;
            svg.appendChild(label);
          });

          const lenLabel = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "text"
          );
          lenLabel.setAttribute("x", cx);
          lenLabel.setAttribute("y", cy + 4);
          lenLabel.setAttribute("text-anchor", "middle");
          lenLabel.setAttribute("font-size", "10");
          lenLabel.textContent = `${length} bp`;
          svg.appendChild(lenLabel);
        }

        document.getElementById("map-container").classList.remove("hidden");
      }

      function runDigest() {
        const errorEl = document.getElementById("error-message");
        errorEl.textContent = "";
        document.getElementById("fragments-container").classList.add("hidden");
        document.getElementById("map-container").classList.add("hidden");
        document.getElementById("cuts-container").classList.add("hidden");
        document.getElementById("results-summary").classList.add("hidden");

        const seq = updateSeqLength();
        if (!seq || seq.length === 0) {
          errorEl.textContent = "Please enter a valid DNA sequence.";
          return;
        }

        const digestType = getDigestType();
        const enzyme1 = getEnzymeFromInputs("enzyme1");
        if (!enzyme1) {
          errorEl.textContent =
            "Please specify at least enzyme 1 (name, recognition site, and valid cut offset).";
          return;
        }
        let enzyme2 = null;
        if (digestType === "double") {
          enzyme2 = getEnzymeFromInputs("enzyme2");
          if (!enzyme2) {
            errorEl.textContent =
              "For a double digest, please provide valid details for enzyme 2.";
            return;
          }
        }

        let cuts = findCutPositions(seq, enzyme1);
        if (enzyme2) {
          cuts = cuts.concat(findCutPositions(seq, enzyme2));
        }
        if (cuts.length === 0) {
          errorEl.textContent =
            "No recognition sites found for the selected enzyme(s) in this sequence.";
          renderCutsList([]);
          return;
        }

        const topology = getTopology();
        const fragments = computeFragments(seq.length, cuts, topology);
        renderFragmentsTable(fragments, topology);
        renderCutsList(cuts);
        renderMap(seq.length, cuts, topology);

        const summary = document.getElementById("summary-text");
        const enzNames = enzyme2
          ? `${enzyme1.name} + ${enzyme2.name}`
          : enzyme1.name;
        summary.textContent = `${fragments.length} fragment(s) generated from a ${seq.length} bp ${topology} DNA by digest with ${enzNames}.`;
        document.getElementById("results-summary").classList.remove("hidden");
      }

      function loadDemoSequence() {
        const demoSeq = [
          ">Demo plasmid (~3 kb) with EcoRI, BamHI, HindIII sites",
          "GAATTCGCGGCCGCAAGCTTAGATCTGCGGCCGCGGATCCGTCGACGCGGCCGCAAGCTT",
          "GCTAGCGGATCCGCGGCCGCAAGCTTAGATCTGAATTCCGCGGCCGCAAGCTTGGATCC",
        ].join("\n");
        document.getElementById("sequence-input").value = demoSeq;
        updateSeqLength();
      }

      document.addEventListener("DOMContentLoaded", () => {
        populateEnzymeSelect("enzyme1-select");
        populateEnzymeSelect("enzyme2-select");

        document
          .getElementById("sequence-input")
          .addEventListener("input", updateSeqLength);

        document
          .getElementById("btn-clean-seq")
          .addEventListener("click", () => {
            const raw = document.getElementById("sequence-input").value;
            const cleaned = cleanSequence(raw);
            document.getElementById("sequence-input").value = cleaned;
            updateSeqLength();
          });

        document
          .getElementById("btn-demo-seq")
          .addEventListener("click", loadDemoSequence);

        document.getElementById("btn-clear").addEventListener("click", () => {
          document.getElementById("sequence-input").value = "";
          updateSeqLength();
          document.getElementById("enzyme1-select").value = "";
          document.getElementById("enzyme2-select").value = "";
          document.getElementById("enzyme1-name").value = "";
          document.getElementById("enzyme1-site").value = "";
          document.getElementById("enzyme1-cut").value = "";
          document.getElementById("enzyme2-name").value = "";
          document.getElementById("enzyme2-site").value = "";
          document.getElementById("enzyme2-cut").value = "";
          document.getElementById("error-message").textContent = "";
          document
            .getElementById("fragments-container")
            .classList.add("hidden");
          document.getElementById("map-container").classList.add("hidden");
          document.getElementById("cuts-container").classList.add("hidden");
          document.getElementById("results-summary").classList.add("hidden");
        });

        document
          .getElementById("btn-run-digest")
          .addEventListener("click", runDigest);

        document.querySelectorAll("input[name='digest-type']").forEach((r) => {
          r.addEventListener("change", () => {
            const type = getDigestType();
            const panel = document.getElementById("enzyme2-panel");
            if (type === "double") {
              panel.classList.remove("opacity-60");
            } else {
              panel.classList.add("opacity-60");
            }
          });
        });

        document.querySelectorAll("input[name='map-style']").forEach((r) => {
          r.addEventListener("change", () => {
            const seq = cleanSequence(
              document.getElementById("sequence-input").value
            );
            if (!seq.length) return;
            const digestType = getDigestType();
            const enzyme1 = getEnzymeFromInputs("enzyme1");
            if (!enzyme1) return;
            let enzyme2 = null;
            if (digestType === "double")
              enzyme2 = getEnzymeFromInputs("enzyme2");
            let cuts = findCutPositions(seq, enzyme1);
            if (enzyme2) cuts = cuts.concat(findCutPositions(seq, enzyme2));
            if (!cuts.length) return;
            renderMap(seq.length, cuts, getTopology());
          });
        });

        document
          .getElementById("enzyme1-select")
          .addEventListener("change", (e) => {
            const enz = ENZYMES.find((z) => z.name === e.target.value);
            if (!enz) return;
            document.getElementById("enzyme1-name").value = enz.name;
            document.getElementById("enzyme1-site").value = enz.site;
            document.getElementById("enzyme1-cut").value = enz.cut;
          });

        document
          .getElementById("enzyme2-select")
          .addEventListener("change", (e) => {
            const enz = ENZYMES.find((z) => z.name === e.target.value);
            if (!enz) return;
            document.getElementById("enzyme2-name").value = enz.name;
            document.getElementById("enzyme2-site").value = enz.site;
            document.getElementById("enzyme2-cut").value = enz.cut;
          });

        updateSeqLength();
      });

      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/mortgage-affordability-calculator">




 
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mortgage Affordability Calculator 2024 – How Much House Can I Afford? | CalcDomain</title>
  <meta name="description" content="Calculate how much house you can afford with CFPB-compliant DTI ratios. Includes FHA, VA, and conventional loan calculations with detailed breakdown of monthly payments, closing costs, and affordability range.">
  
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Inter', sans-serif; }
    .card { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:clamp(1rem,3vw,1.5rem); box-shadow:0 2px 8px rgba(0,0,0,.04); }
    .input-group { margin-bottom: 1rem; }
    .input-group label { display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151; }
    .input-group input, .input-group select { width: 100%; border: 1px solid #d1d5db; border-radius: 0.5rem; padding: 0.625rem; font-size: 0.95rem; }
    .input-group input:focus, .input-group select:focus { outline: none; border-color: #3b82f6; }
    .kpis { display: grid; grid-template-columns: 1fr; gap: 0.75rem; }
    @media (min-width:640px){ .kpis { grid-template-columns: repeat(2,1fr); } }
    @media (min-width:1024px){ .kpis { grid-template-columns: repeat(3,1fr); } }
    .kpi { border: 1px solid #e5e7eb; border-radius: 10px; padding: 0.9rem; background: #fbfcfe; }
    .kpi .label { color: #6b7280; font-size: 0.9rem; margin-bottom: 0.25rem; }
    .kpi .value { font-size: 1.4rem; font-weight: 800; color: #059669; }
    .kpi.warning .value { color: #f59e0b; }
    .kpi.danger .value { color: #dc2626; }
    .info-box { background: #eff6ff; border-left: 4px solid #3b82f6; padding: 1rem; border-radius: 4px; margin: 1rem 0; }
    .warning-box { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 1rem; border-radius: 4px; margin: 1rem 0; }
    .success-box { background: #d1fae5; border-left: 4px solid #10b981; padding: 1rem; border-radius: 4px; margin: 1rem 0; }
    .tabs { display: flex; gap: 0.5rem; border-bottom: 2px solid #e5e7eb; margin-bottom: 1.5rem; flex-wrap: wrap; }
    .tab { padding: 0.75rem 1rem; cursor: pointer; border-bottom: 3px solid transparent; font-weight: 500; color: #6b7280; transition: all 0.2s; }
    .tab:hover { color: #3b82f6; }
    .tab.active { color: #3b82f6; border-bottom-color: #3b82f6; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .toggle-group { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
    .toggle-btn { flex: 1; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 0.5rem; background: white; cursor: pointer; font-weight: 500; text-align: center; transition: all 0.2s; }
    .toggle-btn:hover { border-color: #3b82f6; }
    .toggle-btn.active { background: #3b82f6; color: white; border-color: #3b82f6; }
    .chart-bar { height: 2.5rem; border-radius: 0.25rem; display: flex; align-items: center; padding: 0 0.75rem; color: white; font-weight: 600; font-size: 0.875rem; margin-bottom: 0.5rem; }
    .comparison-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    .comparison-table th, .comparison-table td { padding: 0.75rem; text-align: left; border-bottom: 1px solid #e5e7eb; }
    .comparison-table th { background: #f9fafb; font-weight: 600; color: #374151; font-size: 0.875rem; }
    .comparison-table tr:hover { background: #f9fafb; }
    .tooltip { position: relative; display: inline-block; cursor: help; margin-left: 0.25rem; }
    .tooltiptext { visibility: hidden; width: 220px; background-color: #1f2937; color: white; text-align: center; border-radius: 6px; padding: 0.625rem; position: absolute; z-index: 10; bottom: 125%; left: 50%; margin-left: -110px; opacity: 0; transition: opacity 0.3s; font-size: 0.813rem; line-height: 1.5; }
    .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
    .slider { width: 100%; height: 6px; border-radius: 3px; background: #e5e7eb; outline: none; margin-top: 0.5rem; }
    .slider::-webkit-slider-thumb { appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #3b82f6; cursor: pointer; }
    .slider::-moz-range-thumb { width: 18px; height: 18px; border-radius: 50%; background: #3b82f6; cursor: pointer; border: none; }
  </style>

  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Mortgage Affordability Calculator",
  "url": "https://calcdomain.com/mortgage-affordability-calculator",
  "description": "CFPB-compliant mortgage affordability calculator with DTI ratio calculations for conventional, FHA, and VA loans.",
  "applicationCategory": "FinanceApplication",
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  },
  "dateModified": "2025-10-04",
  "citation": [
    {
      "@type": "GovernmentOrganization",
      "name": "Consumer Financial Protection Bureau"
    },
    {
      "@type": "GovernmentOrganization",
      "name": "U.S. Department of Housing and Urban Development"
    }
  ]
}
</script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
.auditspine-badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  border:1px solid #e5e7eb;
  background:#f8fafc;
  color:#0f172a;
}
.auditspine-badge-warn{
  background:#fff7ed;
  border-color:#fed7aa;
  color:#9a3412;
}
</style>
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Finance",
      "item": "https://calcdomain.com/categories/finance"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Mortgage Real Estate",
      "item": "https://calcdomain.com/subcategories/mortgage-real-estate"
    }
  ]
}</script>
</head>
<body class="bg-gray-50 text-gray-800">
<header class="bg-white shadow-sm sticky top-0 z-50">
  <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
    <div class="flex justify-between items-center">
      <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>

      <div class="w-full max-w-md hidden md:block mx-8">
        <div class="relative">
          <input
            type="search"
            id="search-input"
            placeholder="Search for a calculator..."
            class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            autocomplete="off"
          />
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
        </div>
      </div>

      <div class="hidden md:flex items-center space-x-6">
        <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
        <a href="https://calcdomain.com/#categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
      </div>

      <button
        id="mobile-menu-toggle"
        class="md:hidden p-2"
        aria-controls="mobile-menu"
        aria-expanded="false"
        aria-label="Open menu"
        type="button"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
      <div class="mb-4">
        <div class="relative">
          <input
            type="search"
            id="mobile-search-input"
            placeholder="Search calculators..."
            class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>
      </div>
      <div class="space-y-2">
        <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
        <a href="https://calcdomain.com#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
      </div>
    </nav>
  </nav>
</header>

<a class="skip-link" href="#main-content">Skip to main content</a>

  <header class="bg-white shadow-sm sticky top-0 z-40">
    <nav class="container mx-auto px-4 lg:px-6 py-4">
      <div class="flex items-center justify-between">
        <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>
        <div class="hidden md:flex items-center space-x-6">
          <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
           <a href="https://calcdomain.com/#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
        </div>
      </div>
    </nav>
  </header>

  <div class="bg-blue-50 border-b border-blue-200">
    <div class="container mx-auto px-4 lg:px-6 py-2 text-sm text-blue-900">
      <strong>✓ CFPB-Compliant:</strong> Based on official Consumer Financial Protection Bureau guidelines | 
      <span class="text-blue-700">Updated: October 4, 2025</span>
    </div>
  </div>

  <main class="container mx-auto px-4 lg:px-6 py-10 w-full lg:w-2/3" id="main-content">
<nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a> &raquo; <a href="https://calcdomain.com/categories/finance" class="text-blue-600 hover:underline">Finance</a> &raquo; <a href="https://calcdomain.com/subcategories/mortgage-real-estate" class="text-blue-600 hover:underline">Mortgage Real Estate</a></nav>
    <div class="mb-6 flex flex-wrap gap-4 items-center text-sm">
      <div class="flex items-center gap-2">
        <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
        <span class="text-gray-700">CFPB Guidelines</span>
      </div>
      <div class="flex items-center gap-2">
        <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
        <span class="text-gray-700">FHA, VA &amp; Conventional</span>
      </div>
      <div class="flex items-center gap-2">
        <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
        <span class="text-gray-700">Detailed Breakdown</span>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <section class="lg:col-span-2 card">
        <h1 class="text-3xl font-bold mb-2">Mortgage Affordability Calculator</h1>
<p class="text-gray-600 mb-4">Estimate how much house you can afford based on income, debts, and rates.</p>

        <div class="tabs">
          <div class="tab active" onclick="switchTab('basic', event)">Basic Info</div>
          <div class="tab" onclick="switchTab('details', event)">Property Details</div>
          <div class="tab" onclick="switchTab('advanced', event)">Advanced Options</div>
        </div>

        <form id="mortgageForm" novalidate="">
          <div id="basic-tab" class="tab-content active">
            <div class="grid md:grid-cols-2 gap-4">
              <div class="input-group">
                <label for="income">Annual Gross Income *
                  <span class="tooltip">ℹ️<span class="tooltiptext">Your total household income before taxes and deductions</span></span>
                </label>
                <div class="relative">
                  <input id="income" type="number" min="0" step="1000" placeholder="e.g., 75000" required="">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                </div>
              </div>

              <div class="input-group">
                <label for="monthlyDebts">Monthly Debt Payments *
                  <span class="tooltip">ℹ️<span class="tooltiptext">Car loans, student loans, credit cards, personal loans (minimum payments only)</span></span>
                </label>
                <div class="relative">
                  <input id="monthlyDebts" type="number" min="0" step="50" placeholder="e.g., 500" required="">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                </div>
              </div>

              <div class="input-group">
                <label for="downPayment">Down Payment *</label>
                <div class="toggle-group" style="margin-bottom: 0.5rem;">
                  <button type="button" class="toggle-btn active" data-type="percent" onclick="setDownPaymentType('percent', event)">Percent</button>
                  <button type="button" class="toggle-btn" data-type="dollar" onclick="setDownPaymentType('dollar', event)">Dollar Amount</button>
                </div>
                <div class="relative">
                  <input id="downPayment" type="number" min="0" step="0.5" value="20" placeholder="20">
                  <span id="downPaymentSymbol" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">%</span>
                </div>
                <input id="downPaymentSlider" type="range" min="0" max="50" step="0.5" value="20" class="slider">
              </div>

              <div class="input-group">
                <label for="interestRate">Interest Rate (%) *</label>
                <div class="relative">
                  <input id="interestRate" type="number" min="0" max="15" step="0.125" value="7.0" required="">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">%</span>
                </div>
                <input id="rateSlider" type="range" min="2" max="12" step="0.125" value="7" class="slider">
              </div>

              <div class="input-group">
                <label for="loanTerm">Loan Term (Years)</label>
                <select id="loanTerm">
                  <option value="30">30 years (most common)</option>
                  <option value="20">20 years</option>
                  <option value="15">15 years</option>
                  <option value="10">10 years</option>
                </select>
              </div>

              <div class="input-group">
                <label for="loanType">Loan Type
                  <span class="tooltip">ℹ️<span class="tooltiptext">Different loan types have different DTI limits and requirements</span></span>
                </label>
                <select id="loanType" onchange="updateLoanTypeInfo()">
                  <option value="conventional">Conventional (Fannie/Freddie)</option>
                  <option value="fha">FHA (Low down payment)</option>
                  <option value="va">VA (Veterans, 0% down)</option>
                  <option value="jumbo">Jumbo (High-value homes)</option>
                </select>
              </div>
            </div>
          </div>

          <div id="details-tab" class="tab-content">
            <div class="grid md:grid-cols-2 gap-4">
              <div class="input-group">
                <label for="propertyTax">Annual Property Tax Rate (%)
                  <span class="tooltip">ℹ️<span class="tooltiptext">Typically 0.5-2.5% of home value annually. Check your county's rate.</span></span>
                </label>
                <div class="relative">
                  <input id="propertyTax" type="number" min="0" max="5" step="0.1" value="1.2">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">%</span>
                </div>
              </div>

              <div class="input-group">
                <label for="homeInsurance">Annual Home Insurance
                  <span class="tooltip">ℹ️<span class="tooltiptext">Average is $1,500-$3,000 annually or use 0.5% of home value</span></span>
                </label>
                <div class="toggle-group" style="margin-bottom: 0.5rem;">
                  <button type="button" class="toggle-btn active" onclick="setInsuranceType('percent', event)">Percent</button>
                  <button type="button" class="toggle-btn" onclick="setInsuranceType('dollar', event)">Dollar Amount</button>
                </div>
                <div class="relative">
                  <input id="homeInsurance" type="number" min="0" step="0.1" value="0.5">
                  <span id="insuranceSymbol" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">%</span>
                </div>
              </div>

              <div class="input-group">
                <label for="hoaFees">Monthly HOA Fees</label>
                <div class="relative">
                  <input id="hoaFees" type="number" min="0" step="25" value="0" placeholder="0">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                </div>
              </div>

              <div class="input-group">
                <label for="maintenance">Monthly Maintenance Budget (% of home value)
                  <span class="tooltip">ℹ️<span class="tooltiptext">Recommended 1% of home value annually for maintenance and repairs</span></span>
                </label>
                <div class="relative">
                  <input id="maintenance" type="number" min="0" step="0.1" value="1" placeholder="1">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">%</span>
                </div>
              </div>
            </div>
          </div>

          <div id="advanced-tab" class="tab-content">
            <div class="grid md:grid-cols-2 gap-4">
              <div class="input-group">
                <label for="creditScore">Credit Score Range
                  <span class="tooltip">ℹ️<span class="tooltiptext">Affects your interest rate and loan approval chances</span></span>
                </label>
                <select id="creditScore">
                  <option value="excellent">Excellent (760+)</option>
                  <option value="good" selected="">Good (700-759)</option>
                  <option value="fair">Fair (650-699)</option>
                  <option value="poor">Poor (600-649)</option>
                  <option value="verypoor">Very Poor (Below 600)</option>
                </select>
              </div>

              <div class="input-group">
                <label for="dtiLimit">Max DTI Ratio (%)
                  <span class="tooltip">ℹ️<span class="tooltiptext">Maximum back-end debt-to-income ratio. Conventional: 36-43%, FHA: 43-50%, VA: 41-45%</span></span>
                </label>
                <div class="relative">
                  <input id="dtiLimit" type="number" min="28" max="50" step="1" value="43">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">%</span>
                </div>
              </div>

              <div class="input-group">
                <label for="utilities">Est. Monthly Utilities</label>
                <div class="relative">
                  <input id="utilities" type="number" min="0" step="25" value="200">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                </div>
              </div>

              <div class="input-group">
                <label for="closingCosts">Closing Costs (% of home price)
                  <span class="tooltip">ℹ️<span class="tooltiptext">Typically 2-5% of purchase price. Includes lender fees, title, appraisal, etc.</span></span>
                </label>
                <div class="relative">
                  <input id="closingCosts" type="number" min="0" max="10" step="0.5" value="3">
                  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">%</span>
                </div>
              </div>
            </div>
          </div>

          <div class="flex gap-3 mt-6">
            <button type="button" onclick="calculate()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-md transition">Calculate Affordability</button>
            <button type="button" onclick="resetForm()" class="bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold px-4 py-3 rounded-md transition">Reset</button>
          </div>
        </form>

        <div id="results" style="display: none;" class="mt-8">
          <h2 class="text-2xl font-semibold mb-4">Your Affordability Results</h2>
          
          <div id="dtiWarning"></div>

          <div class="kpis">
            <div class="kpi">
              <div class="label">Maximum Home Price</div>
              <div class="value" id="maxPrice">$0</div>
            </div>
            <div class="kpi">
              <div class="label">Recommended Range</div>
              <div class="value" id="recRange" style="font-size: 1.1rem;">$0 - $0</div>
            </div>
            <div class="kpi">
              <div class="label">Monthly Payment (PITI)</div>
              <div class="value" id="monthlyPayment">$0</div>
            </div>
            <div class="kpi">
              <div class="label">Cash Needed to Close</div>
              <div class="value" id="cashClose">$0</div>
            </div>
            <div class="kpi" id="dtiKpi">
              <div class="label">Your DTI Ratio</div>
              <div class="value" id="dtiRatio">0%</div>
            </div>
            <div class="kpi">
              <div class="label">Loan Amount</div>
              <div class="value" id="loanAmount">$0</div>
            </div>
          </div>

          <div class="mt-6">
            <h3 class="text-xl font-semibold mb-3">Monthly Payment Breakdown</h3>
            <div id="paymentBreakdown"></div>
          </div>

          <div class="mt-6">
            <h3 class="text-xl font-semibold mb-3">Comparison by Loan Type</h3>
            <div class="overflow-x-auto">
              <table class="comparison-table">
                <thead>
                  <tr>
                    <th>Loan Type</th>
                    <th>Max Home Price</th>
                    <th>Monthly Payment</th>
                    <th>Down Payment</th>
                    <th>DTI Ratio</th>
                  </tr>
                </thead>
                <tbody id="comparisonTable"></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <aside class="space-y-6 w-full lg:w-1/3">
        <div class="card">
          <h2 class="text-xl font-semibold mb-3">Authoritative Sources</h2>
          <div class="space-y-3 text-sm">
            <div>
              <a href="https://www.consumerfinance.gov/ask-cfpb/what-is-a-debt-to-income-ratio-en-1791/" target="_blank" rel="noopener" class="text-blue-600 font-medium flex items-center gap-1 hover:underline">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"></path><path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"></path></svg>
                CFPB: Debt-to-Income Ratio
              </a>
              <p class="text-xs text-gray-600 mt-1">Official guidance on DTI calculations</p>
            </div>
            <div>
              <a href="https://www.hud.gov/program_offices/housing/sfh/ins/sfhvsmmenu" target="_blank" rel="noopener" class="text-blue-600 font-medium flex items-center gap-1 hover:underline">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"></path><path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"></path></svg>
                HUD: FHA Loan Requirements
              </a>
              <p class="text-xs text-gray-600 mt-1">Federal Housing Administration guidelines</p>
            </div>
            <div>
              <a href="https://www.va.gov/housing-assistance/home-loans/" target="_blank" rel="noopener" class="text-blue-600 font-medium flex items-center gap-1 hover:underline">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"></path><path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"></path></svg>
                VA: Home Loan Benefits
              </a>
              <p class="text-xs text-gray-600 mt-1">Veterans Affairs loan programs</p>
            </div>
            <div>
              <a href="https://www.fanniemae.com/singlefamily/eligibility-matrix" target="_blank" rel="noopener" class="text-blue-600 font-medium flex items-center gap-1 hover:underline">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"></path><path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"></path></svg>
                Fannie Mae: Eligibility Matrix
              </a>
              <p class="text-xs text-gray-600 mt-1">Conventional loan standards</p>
            </div>
          </div>
        </div>

        <div class="card">
          <h2 class="text-xl font-semibold mb-3">DTI Ratio Standards</h2>
          <div class="space-y-3 text-sm">
            <div class="border-b pb-2">
              <div class="font-semibold text-gray-900">Conventional Loans</div>
              <div class="text-gray-700 mt-1">Front-end: <strong>28%</strong> | Back-end: <strong>36%</strong></div>
              <div class="text-gray-600 text-xs mt-1">Up to 43% with compensating factors</div>
            </div>
            <div class="border-b pb-2">
              <div class="font-semibold text-gray-900">FHA Loans</div>
              <div class="text-gray-700 mt-1">Front-end: <strong>31%</strong> | Back-end: <strong>43%</strong></div>
              <div class="text-gray-600 text-xs mt-1">Up to 50% with strong credit/reserves</div>
            </div>
            <div class="border-b pb-2">
              <div class="font-semibold text-gray-900">VA Loans</div>
              <div class="text-gray-700 mt-1">Back-end: <strong>41%</strong> guideline</div>
              <div class="text-gray-600 text-xs mt-1">No hard limit; uses residual income</div>
            </div>
            <div>
              <div class="font-semibold text-gray-900">Ideal DTI Range</div>
              <div class="text-gray-700 mt-1"><strong>Below 36%</strong> - Best rates</div>
              <div class="text-gray-600 text-xs mt-1">20% or below considered excellent</div>
            </div>
          </div>
        </div>

        <div class="card">
          <h2 class="text-xl font-semibold mb-3">Loan Type Comparison</h2>
          <div class="space-y-3 text-sm">
            <div>
              <div class="font-semibold text-gray-900">Conventional</div>
              <div class="text-gray-700 mt-1">• 3-20% down payment</div>
              <div class="text-gray-700">• PMI if less than 20% down</div>
              <div class="text-gray-700">• Credit score: 620+ typical</div>
            </div>
            <div>
              <div class="font-semibold text-gray-900">FHA</div>
              <div class="text-gray-700 mt-1">• 3.5% down (580+ credit)</div>
              <div class="text-gray-700">• MIP required (lifetime)</div>
              <div class="text-gray-700">• Easier qualification</div>
            </div>
            <div>
              <div class="font-semibold text-gray-900">VA</div>
              <div class="text-gray-700 mt-1">• 0% down payment</div>
              <div class="text-gray-700">• No PMI required</div>
              <div class="text-gray-700">• Veterans/military only</div>
            </div>
          </div>
        </div>

        <div class="card">
          <h2 class="text-xl font-semibold mb-3">Comprehensive FAQ</h2>
          <div class="space-y-4 text-sm">
            <div>
              <h3 class="font-semibold text-gray-900">What is the 28/36 rule?</h3>
              <p class="text-gray-700 mt-1">A traditional guideline: housing costs shouldn't exceed 28% of gross income (front-end) and total debt shouldn't exceed 36% (back-end). Modern lending may allow higher ratios with compensating factors.</p>
            </div>
            <div>
              <h3 class="font-semibold text-gray-900">What debts are included in DTI?</h3>
              <p class="text-gray-700 mt-1">Monthly minimums on credit cards, auto loans, student loans, personal loans, child support, alimony, and your proposed mortgage payment. Utilities and groceries typically aren't included.</p>
            </div>
            <div>
              <h3 class="font-semibold text-gray-900">How much should I put down?</h3>
              <p class="text-gray-700 mt-1">20% down avoids PMI on conventional loans. However, FHA allows 3.5% and VA allows 0%. Consider your cash reserves and emergency fund needs.</p>
            </div>
            <div>
              <h3 class="font-semibold text-gray-900">What's included in monthly payment?</h3>
              <p class="text-gray-700 mt-1">PITI: Principal, Interest, Taxes, and Insurance. May also include PMI/MIP and HOA fees.</p>
            </div>
            <div>
              <h3 class="font-semibold text-gray-900">How does credit score affect affordability?</h3>
              <p class="text-gray-700 mt-1">Higher credit scores typically qualify for lower interest rates, meaning you can afford a more expensive home with the same monthly payment. A 0.5% rate difference can change affordability by 5-10%.</p>
            </div>
          </div>
        </div>

        <div class="warning-box">
          <h3 class="font-bold text-amber-900 mb-2">⚠️ Important Disclaimer</h3>
          <p class="text-sm text-amber-900">This calculator provides estimates for planning purposes only. Actual loan approval depends on credit history, employment verification, assets, property appraisal, and lender requirements. Consult with a licensed mortgage professional for personalized advice.</p>
        </div>
      </aside>
    </div>
  
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Fixed-rate payment (principal + interest)</strong></div>
  <div style="margin-top:6px">\[M = P\,\frac{r(1+r)^{n}}{(1+r)^{n}-1}\]</div>
  <pre class="auditspine-mono">M = P * [ r(1+r)^n ] / [ (1+r)^n - 1 ]</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><span class="auditspine-mono">T</span> = property tax (annual or monthly depending on input) <em>(currency)</em></li>
<li><span class="auditspine-mono">I</span> = homeowners insurance (annual or monthly depending on input) <em>(currency)</em></li>
<li><span class="auditspine-mono">PMI</span> = private mortgage insurance (monthly) <em>(currency)</em></li>
<li><span class="auditspine-mono">HOA</span> = homeowners association dues (monthly) <em>(currency)</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>CFPB: Debt-to-Income Ratio</strong> — consumerfinance.gov · Accessed 2026-01-19<br><a href="https://www.consumerfinance.gov/ask-cfpb/what-is-a-debt-to-income-ratio-en-1791/" target="_blank" rel="nofollow noopener">https://www.consumerfinance.gov/ask-cfpb/what-is-a-debt-to-income-ratio-en-1791/</a></li>
<li><strong>HUD: FHA Loan Requirements</strong> — hud.gov · Accessed 2026-01-19<br><a href="https://www.hud.gov/program_offices/housing/sfh/ins/sfhvsmmenu" target="_blank" rel="nofollow noopener">https://www.hud.gov/program_offices/housing/sfh/ins/sfhvsmmenu</a></li>
<li><strong>VA: Home Loan Benefits</strong> — va.gov · Accessed 2026-01-19<br><a href="https://www.va.gov/housing-assistance/home-loans/" target="_blank" rel="nofollow noopener">https://www.va.gov/housing-assistance/home-loans/</a></li>
<li><strong>Fannie Mae: Eligibility Matrix</strong> — fanniemae.com · Accessed 2026-01-19<br><a href="https://www.fanniemae.com/singlefamily/eligibility-matrix" target="_blank" rel="nofollow noopener">https://www.fanniemae.com/singlefamily/eligibility-matrix</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main>

  <footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                                                                        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>

































  <script>
    // Mortgage Affordability Calculator - Complete Implementation
    (function() {
      'use strict';

      const LOAN_CONFIGS = {
        conventional: { name: 'Conventional', maxFrontEndDTI: 28, maxBackEndDTI: 36, maxDTIWithCompensating: 43, minDownPayment: 3, requiresPMI: true, pmiThreshold: 20, pmiRate: 0.005 },
        fha: { name: 'FHA', maxFrontEndDTI: 31, maxBackEndDTI: 43, maxDTIWithCompensating: 50, minDownPayment: 3.5, requiresPMI: true, pmiThreshold: 0, upfrontMIP: 1.75, annualMIP: 0.0085 },
        va: { name: 'VA', maxFrontEndDTI: 41, maxBackEndDTI: 41, maxDTIWithCompensating: 45, minDownPayment: 0, requiresPMI: false, fundingFee: 2.3 },
        jumbo: { name: 'Jumbo', maxFrontEndDTI: 28, maxBackEndDTI: 36, maxDTIWithCompensating: 43, minDownPayment: 10, requiresPMI: true, pmiThreshold: 20, pmiRate: 0.006 }
      };

      let downPaymentType = 'percent', insuranceType = 'percent';
      const els = {
        income: document.getElementById('income'),
        monthlyDebts: document.getElementById('monthlyDebts'),
        downPayment: document.getElementById('downPayment'),
        downPaymentSlider: document.getElementById('downPaymentSlider'),
        interestRate: document.getElementById('interestRate'),
        rateSlider: document.getElementById('rateSlider'),
        loanTerm: document.getElementById('loanTerm'),
        loanType: document.getElementById('loanType'),
        propertyTax: document.getElementById('propertyTax'),
        homeInsurance: document.getElementById('homeInsurance'),
        hoaFees: document.getElementById('hoaFees'),
        maintenance: document.getElementById('maintenance'),
        dtiLimit: document.getElementById('dtiLimit'),
        closingCosts: document.getElementById('closingCosts'),
        results: document.getElementById('results'),
        maxPrice: document.getElementById('maxPrice'),
        recRange: document.getElementById('recRange'),
        monthlyPayment: document.getElementById('monthlyPayment'),
        cashClose: document.getElementById('cashClose'),
        dtiRatio: document.getElementById('dtiRatio'),
        loanAmount: document.getElementById('loanAmount'),
        dtiKpi: document.getElementById('dtiKpi'),
        dtiWarning: document.getElementById('dtiWarning'),
        paymentBreakdown: document.getElementById('paymentBreakdown'),
        comparisonTable: document.getElementById('comparisonTable')
      };

      els.downPaymentSlider.addEventListener('input', e => { if (downPaymentType === 'percent') els.downPayment.value = e.target.value; });
      els.downPayment.addEventListener('input', e => { if (downPaymentType === 'percent') els.downPaymentSlider.value = e.target.value; });
      els.rateSlider.addEventListener('input', e => els.interestRate.value = e.target.value);
      els.interestRate.addEventListener('input', e => els.rateSlider.value = e.target.value);

      window.switchTab = function(tab, e) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        e.target.classList.add('active');
        document.getElementById(`${tab}-tab`).classList.add('active');
      };

      window.setDownPaymentType = function(type, e) {
        downPaymentType = type;
        e.target.parentElement.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
        e.target.classList.add('active');
        const sym = document.getElementById('downPaymentSymbol');
        if (type === 'percent') {
          sym.textContent = '%';
          els.downPayment.value = '20';
          els.downPaymentSlider.style.display = 'block';
        } else {
          sym.textContent = '$';
          els.downPayment.value = '';
          els.downPaymentSlider.style.display = 'none';
        }
      };

      window.setInsuranceType = function(type, e) {
        insuranceType = type;
        e.target.parentElement.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
        e.target.classList.add('active');
        const sym = document.getElementById('insuranceSymbol');
        if (type === 'percent') {
          sym.textContent = '%';
          els.homeInsurance.value = '0.5';
        } else {
          sym.textContent = '$';
          els.homeInsurance.value = '2000';
        }
      };

      window.updateLoanTypeInfo = function() {
        const cfg = LOAN_CONFIGS[els.loanType.value];
        els.dtiLimit.value = cfg.maxBackEndDTI;
        if (downPaymentType === 'percent') {
          if (els.loanType.value === 'va') {
            els.downPayment.value = els.downPaymentSlider.value = '0';
          } else if (els.loanType.value === 'fha') {
            els.downPayment.value = els.downPaymentSlider.value = '3.5';
          } else if (els.loanType.value === 'jumbo') {
            els.downPayment.value = els.downPaymentSlider.value = '10';
          }
        }
      };

      function calcMonthlyPI(principal, rate, years) {
        if (rate === 0) return principal / (years * 12);
        const r = rate / 12 / 100, n = years * 12;
        return principal * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
      }

      function calcPMI(loan, price, type) {
        const cfg = LOAN_CONFIGS[type];
        if (!cfg.requiresPMI) return 0;
        const ltv = (loan / price) * 100;
        if (type === 'fha') return (loan * cfg.annualMIP) / 12;
        return ltv <= cfg.pmiThreshold ? 0 : (loan * cfg.pmiRate) / 12;
      }

      function calcTotalPayment(price, dpInput, rate, term, type, taxRate, insInput, hoa) {
        let dp = downPaymentType === 'percent' ? price * (dpInput / 100) : dpInput;
        const loan = price - dp;
        const pi = calcMonthlyPI(loan, rate, term);
        const tax = (price * taxRate / 100) / 12;
        const ins = insuranceType === 'percent' ? (price * insInput / 100) / 12 : insInput / 12;
        const pmi = calcPMI(loan, price, type);
        return pi + tax + ins + pmi + hoa;
      }

      function calcAffordability() {
        const income = parseFloat(els.income.value) || 0;
        const debts = parseFloat(els.monthlyDebts.value) || 0;
        const dp = parseFloat(els.downPayment.value) || 20;
        const rate = parseFloat(els.interestRate.value) || 7;
        const term = parseInt(els.loanTerm.value) || 30;
        const type = els.loanType.value;
        const taxRate = parseFloat(els.propertyTax.value) || 1.2;
        const ins = parseFloat(els.homeInsurance.value) || 0.5;
        const hoa = parseFloat(els.hoaFees.value) || 0;
        const dtiLim = parseFloat(els.dtiLimit.value) || 43;
        const maxPmt = ((income / 12) * dtiLim / 100) - debts;
        let low = 50000, high = 5000000, max = 0;
        while (high - low > 100) {
          const mid = (low + high) / 2;
          const pmt = calcTotalPayment(mid, dp, rate, term, type, taxRate, ins, hoa);
          if (pmt <= maxPmt) { max = mid; low = mid; } else { high = mid; }
        }
        return Math.floor(max / 1000) * 1000;
      }

      window.calculate = function() {
        if (!parseFloat(els.income.value) || !parseFloat(els.interestRate.value)) {
          alert('Please enter valid income and interest rate');
          return;
        }

        const maxPrice = calcAffordability();
        const income = parseFloat(els.income.value);
        const debts = parseFloat(els.monthlyDebts.value) || 0;
        const dpInput = parseFloat(els.downPayment.value) || 20;
        const rate = parseFloat(els.interestRate.value);
        const term = parseInt(els.loanTerm.value);
        const type = els.loanType.value;
        const taxRate = parseFloat(els.propertyTax.value) || 1.2;
        const ins = parseFloat(els.homeInsurance.value) || 0.5;
        const hoa = parseFloat(els.hoaFees.value) || 0;
        const ccRate = parseFloat(els.closingCosts.value) || 3;

        let dp = downPaymentType === 'percent' ? maxPrice * (dpInput / 100) : dpInput;
        const loan = maxPrice - dp;
        const pi = calcMonthlyPI(loan, rate, term);
        const tax = (maxPrice * taxRate / 100) / 12;
        const monthIns = insuranceType === 'percent' ? (maxPrice * ins / 100) / 12 : ins / 12;
        const pmi = calcPMI(loan, maxPrice, type);
        const total = pi + tax + monthIns + pmi + hoa;
        const dti = ((total + debts) / (income / 12)) * 100;
        
        let cashClose = dp + (maxPrice * ccRate / 100);
        if (type === 'fha') cashClose += loan * 0.0175;

        els.maxPrice.textContent = fmt(maxPrice);
        els.recRange.textContent = `${fmt(maxPrice * 0.75)} - ${fmt(maxPrice * 0.9)}`;
        els.monthlyPayment.textContent = fmt(total);
        els.cashClose.textContent = fmt(cashClose);
        els.dtiRatio.textContent = `${dti.toFixed(1)}%`;
        els.loanAmount.textContent = fmt(loan);

        els.dtiKpi.classList.remove('warning', 'danger');
        if (dti > 43) els.dtiKpi.classList.add('danger');
        else if (dti > 36) els.dtiKpi.classList.add('warning');

        if (dti > 43) {
          els.dtiWarning.innerHTML = `<div class="warning-box"><strong>⚠️ High DTI:</strong> Your DTI of ${dti.toFixed(1)}% exceeds standard guidelines (43%). You may need compensating factors.</div>`;
        } else if (dti > 36) {
          els.dtiWarning.innerHTML = `<div class="info-box"><strong>ℹ️ Moderate DTI:</strong> Your DTI of ${dti.toFixed(1)}% is acceptable but above ideal (36%).</div>`;
        } else {
          els.dtiWarning.innerHTML = `<div class="success-box"><strong>✓ Excellent DTI:</strong> Your DTI of ${dti.toFixed(1)}% is ideal, giving you strong negotiating power.</div>`;
        }

        renderBreakdown(pi, tax, monthIns, pmi, hoa, total);
        renderComparison(income, debts, dpInput, rate, term, taxRate, ins, hoa);
        els.results.style.display = 'block';
        els.results.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      };

      function renderBreakdown(pi, tax, ins, pmi, hoa, total) {
        const comps = [
          { label: 'Principal & Interest', amount: pi, color: '#3b82f6' },
          { label: 'Property Tax', amount: tax, color: '#10b981' },
          { label: 'Home Insurance', amount: ins, color: '#f59e0b' },
          { label: 'PMI/MIP', amount: pmi, color: '#ef4444' },
          { label: 'HOA Fees', amount: hoa, color: '#8b5cf6' }
        ];
        let html = '';
        comps.forEach(c => {
          if (c.amount > 0) {
            const pct = (c.amount / total) * 100;
            html += `<div class="chart-bar" style="background-color: ${c.color}; width: ${pct}%;">${c.label}: ${fmt(c.amount)}</div>`;
          }
        });
        html += `<div class="mt-4 p-4 bg-gray-50 rounded-lg"><div class="flex justify-between font-semibold"><span>Total Monthly Payment (PITI):</span><span class="text-green-600 text-xl">${fmt(total)}</span></div></div>`;
        els.paymentBreakdown.innerHTML = html;
      }

      function renderComparison(income, debts, dpInput, rate, term, taxRate, ins, hoa) {
        const types = ['conventional', 'fha', 'va', 'jumbo'];
        let html = '';
        types.forEach(t => {
          const cfg = LOAN_CONFIGS[t];
          const maxPmt = ((income / 12) * cfg.maxBackEndDTI / 100) - debts;
          let low = 50000, high = 5000000, max = 0;
          const dpVal = t === 'va' ? 0 : (t === 'fha' ? 3.5 : dpInput);
          while (high - low > 100) {
            const mid = (low + high) / 2;
            const pmt = calcTotalPayment(mid, dpVal, rate, term, t, taxRate, ins, hoa);
            if (pmt <= maxPmt) { max = mid; low = mid; } else { high = mid; }
          }
          max = Math.floor(max / 1000) * 1000;
          const dp = downPaymentType === 'percent' ? max * (dpVal / 100) : (t === 'va' ? 0 : dpInput);
          const pmt = calcTotalPayment(max, dpVal, rate, term, t, taxRate, ins, hoa);
          const dti = ((pmt + debts) / (income / 12)) * 100;
          html += `<tr><td class="font-medium">${cfg.name}</td><td>${fmt(max)}</td><td>${fmt(pmt)}</td><td>${fmt(dp)}</td><td>${dti.toFixed(1)}%</td></tr>`;
        });
        els.comparisonTable.innerHTML = html;
      }

      window.resetForm = function() {
        document.getElementById('mortgageForm').reset();
        els.results.style.display = 'none';
        els.downPaymentSlider.value = 20;
        els.rateSlider.value = 7;
        downPaymentType = insuranceType = 'percent';
      };

      function fmt(val) {
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(val);
      }
    })();
  </script>

</body></html>
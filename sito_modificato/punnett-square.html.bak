<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/punnett-square" />
    <title>Punnett Square Calculator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Punnett Square Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Punnett Square Calculator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Punnett Square Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/punnett-square" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Punnett Square Calculator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Punnett Square Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Science Calculators", "item": "https://calcdomain.com/categories/science"}, {"@type": "ListItem", "position": 3, "name": "Biology Calculators", "item": "https://calcdomain.com/subcategories/biology"}, {"@type": "ListItem", "position": 4, "name": "Punnett Square Calculator", "item": "https://calcdomain.com/punnett-square"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/science" class="text-blue-600 hover:underline">Science Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/biology" class="text-blue-600 hover:underline">Biology Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Punnett Square Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">
                Punnett Square Calculator
              </h1>
              <p class="text-gray-600">
                Build monohybrid, dihybrid, and sex‑linked Punnett squares, see
                genotype and phenotype ratios, and follow step‑by‑step
                explanations.
              </p>
            </header>

            <!-- Calculator Controls -->
            <section aria-labelledby="calculator-section">
              <h2 id="calculator-section" class="text-xl font-semibold mb-3">
                Interactive Punnett Square
              </h2>

              <div class="mb-4">
                <label
                  for="mode"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Cross type</label
                >
                <select
                  id="mode"
                  class="w-full md:w-72 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
                >
                  <option value="mono">Monohybrid (1 gene)</option>
                  <option value="di">Dihybrid (2 genes)</option>
                  <option value="sex">Sex-linked (X-linked)</option>
                </select>
                <p class="text-xs text-gray-500 mt-1" id="mode-help">
                  Monohybrid: one gene (e.g., Aa × aa). Dihybrid: two genes
                  (e.g., AaBb × Aabb). Sex-linked: X-linked trait (e.g., X^AX^a
                  × X^aY).
                </p>
              </div>

              <!-- Monohybrid / Dihybrid Inputs -->
              <div id="standard-inputs" class="space-y-4">
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label
                      for="parent1"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Parent 1 genotype</label
                    >
                    <input
                      id="parent1"
                      type="text"
                      value="Aa"
                      class="w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
                      autocomplete="off"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Examples: <span class="font-mono">AA</span>,
                      <span class="font-mono">Aa</span>,
                      <span class="font-mono">aa</span>,
                      <span class="font-mono">AaBb</span>.
                    </p>
                  </div>
                  <div>
                    <label
                      for="parent2"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Parent 2 genotype</label
                    >
                    <input
                      id="parent2"
                      type="text"
                      value="Aa"
                      class="w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
                      autocomplete="off"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Use the same gene letters as Parent 1.
                    </p>
                  </div>
                </div>
              </div>

              <!-- Sex-linked Inputs -->
              <div id="sexlinked-inputs" class="space-y-4 hidden">
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label
                      for="mother"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Mother genotype (XX)</label
                    >
                    <input
                      id="mother"
                      type="text"
                      value="X^AX^a"
                      class="w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
                      autocomplete="off"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Examples: <span class="font-mono">X^AX^A</span>,
                      <span class="font-mono">X^AX^a</span>,
                      <span class="font-mono">X^aX^a</span>.
                    </p>
                  </div>
                  <div>
                    <label
                      for="father"
                      class="block text-sm font-medium text-gray-700 mb-1"
                      >Father genotype (XY)</label
                    >
                    <input
                      id="father"
                      type="text"
                      value="X^AY"
                      class="w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
                      autocomplete="off"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Examples: <span class="font-mono">X^AY</span>,
                      <span class="font-mono">X^aY</span>.
                    </p>
                  </div>
                </div>
                <p class="text-xs text-gray-500">
                  Use <span class="font-mono">X^A</span> for the dominant allele
                  and <span class="font-mono">X^a</span> for the recessive
                  allele. The Y chromosome carries no allele for this trait.
                </p>
              </div>

              <div class="mt-4 flex flex-wrap items-center gap-3">
                <button
                  id="calculate-btn"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                >
                  Generate Punnett Square
                </button>
                <button
                  id="clear-btn"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200"
                >
                  Clear
                </button>
                <span id="error-msg" class="text-sm text-red-600"></span>
              </div>
            </section>

            <!-- Results -->
            <section class="mt-8 space-y-6" aria-live="polite">
              <div id="square-container" class="hidden">
                <h2 class="text-xl font-semibold mb-2">Punnett Square</h2>
                <div class="overflow-x-auto">
                  <table
                    class="square-grid text-sm"
                    id="square-table"
                    aria-label="Punnett square table"
                  ></table>
                </div>
                <p id="square-note" class="text-xs text-gray-500 mt-2"></p>
              </div>

              <div
                id="summary-container"
                class="hidden grid md:grid-cols-2 gap-4"
              >
                <div class="bg-gray-50 border border-gray-200 rounded-md p-3">
                  <h3 class="font-semibold mb-1 text-sm">Genotype summary</h3>
                  <ul id="genotype-list" class="text-sm space-y-1"></ul>
                </div>
                <div class="bg-gray-50 border border-gray-200 rounded-md p-3">
                  <h3 class="font-semibold mb-1 text-sm">Phenotype summary</h3>
                  <ul id="phenotype-list" class="text-sm space-y-1"></ul>
                  <p class="text-xs text-gray-500 mt-2">
                    Phenotypes are inferred assuming uppercase alleles are
                    dominant over lowercase alleles.
                  </p>
                </div>
              </div>

              <div id="step-container" class="hidden">
                <h2 class="text-xl font-semibold mb-2">
                  How this Punnett square was built
                </h2>
                <ol
                  id="step-list"
                  class="list-decimal list-inside text-sm space-y-1"
                ></ol>
              </div>
            </section>

            <!-- Explanatory Content -->
            <section class="prose mt-10">
              <h2>What is a Punnett square?</h2>
              <p>
                A Punnett square is a simple grid used in genetics to predict
                how alleles from two parents can combine in their offspring. It
                helps you estimate the probability of different
                <strong>genotypes</strong> (allele combinations) and
                <strong>phenotypes</strong> (observable traits).
              </p>
              <p>
                Each parent produces <em>gametes</em> (eggs or sperm) that carry
                one allele for each gene. The Punnett square lists the gametes
                from one parent along the top and from the other parent along
                the side. Each cell shows a possible combination in the
                offspring.
              </p>

              <h2>How to use this Punnett square calculator</h2>
              <h3>1. Choose the cross type</h3>
              <ul>
                <li>
                  <strong>Monohybrid (1 gene)</strong> – one trait, such as
                  flower color (<span class="font-mono">A</span> vs
                  <span class="font-mono">a</span>).
                </li>
                <li>
                  <strong>Dihybrid (2 genes)</strong> – two traits at once, such
                  as color (<span class="font-mono">A/a</span>) and height
                  (<span class="font-mono">B/b</span>).
                </li>
                <li>
                  <strong>Sex-linked (X-linked)</strong> – traits carried on the
                  X chromosome (e.g., color blindness).
                </li>
              </ul>

              <h3>2. Enter parental genotypes</h3>
              <ul>
                <li>
                  For <strong>monohybrid</strong>, use two letters:
                  <span class="font-mono">AA</span>,
                  <span class="font-mono">Aa</span>, or
                  <span class="font-mono">aa</span>.
                </li>
                <li>
                  For <strong>dihybrid</strong>, use four letters: two per gene,
                  such as <span class="font-mono">AaBb</span>,
                  <span class="font-mono">AABb</span>, or
                  <span class="font-mono">aaBB</span>.
                </li>
                <li>
                  For <strong>sex-linked</strong>, use X and Y with
                  superscript-like notation:
                  <span class="font-mono">X^AX^a</span>,
                  <span class="font-mono">X^aX^a</span>,
                  <span class="font-mono">X^AY</span>,
                  <span class="font-mono">X^aY</span>.
                </li>
              </ul>

              <h3>3. Generate the Punnett square</h3>
              <p>
                Click <strong>“Generate Punnett Square”</strong>. The tool will:
              </p>
              <ul>
                <li>List all possible gametes from each parent.</li>
                <li>Fill in the Punnett square with offspring genotypes.</li>
                <li>Summarize genotype and phenotype ratios.</li>
                <li>Explain the steps used to build the square.</li>
              </ul>

              <h2>Behind the scenes: how the calculator works</h2>
              <h3>1. Splitting genotypes into genes</h3>
              <p>
                For autosomal traits (monohybrid and dihybrid), the calculator
                groups letters into genes by letter: all
                <span class="font-mono">A/a</span> alleles form one gene, all
                <span class="font-mono">B/b</span> alleles another, and so on.
              </p>

              <h3>2. Generating gametes</h3>
              <p>
                Each gamete gets one allele from each gene. For example, for a
                dihybrid parent with genotype
                <span class="font-mono">AaBb</span>:
              </p>
              <div class="formula-box">Possible gametes = AB, Ab, aB, ab</div>

              <h3>3. Filling the Punnett square</h3>
              <p>
                The gametes from Parent&nbsp;1 label the columns and those from
                Parent&nbsp;2 label the rows. Each cell combines one gamete from
                each parent to form an offspring genotype.
              </p>

              <h3>4. Counting genotypes and phenotypes</h3>
              <p>
                The calculator counts how often each genotype appears and
                converts counts into probabilities. To infer phenotypes, it
                assumes:
              </p>
              <ul>
                <li>Uppercase letters are <strong>dominant</strong>.</li>
                <li>Lowercase letters are <strong>recessive</strong>.</li>
                <li>
                  Any genotype with at least one uppercase allele for a gene
                  shows the dominant phenotype for that gene.
                </li>
              </ul>

              <h2>Example: monohybrid cross Aa × Aa</h2>
              <p>
                Suppose <span class="font-mono">A</span> = purple flowers
                (dominant) and <span class="font-mono">a</span> = white flowers
                (recessive).
              </p>
              <div class="formula-box">
                Parent 1: Aa<br />
                Parent 2: Aa<br /><br />
                Gametes: A, a (from each parent)<br /><br />
                Punnett square:<br />
                AA, Aa, Aa, aa
              </div>
              <ul>
                <li>Genotype ratio: 1 AA : 2 Aa : 1 aa</li>
                <li>Phenotype ratio: 3 purple : 1 white</li>
              </ul>

              <h2>Example: sex-linked X-linked cross</h2>
              <p>
                For an X-linked recessive trait (e.g., color blindness), let
                <span class="font-mono">X^A</span> = normal vision (dominant)
                and <span class="font-mono">X^a</span> = color blindness
                (recessive).
              </p>
              <div class="formula-box">
                Mother: X^AX^a (carrier)<br />
                Father: X^AY (normal)<br /><br />
                Possible children:<br />
                – Daughters: X^AX^A (normal), X^AX^a (carrier)<br />
                – Sons: X^AY (normal), X^aY (affected)
              </div>
              <p>
                The calculator separates probabilities for sons and daughters so
                you can see sex‑specific risks.
              </p>

              <h2>Limitations and assumptions</h2>
              <ul>
                <li>
                  Assumes simple Mendelian inheritance (no linkage, epistasis,
                  or incomplete dominance).
                </li>
                <li>Assumes genes assort independently in dihybrid crosses.</li>
                <li>Sex-linked mode currently models X-linked traits only.</li>
              </ul>
            </section>

            <!-- FAQ -->
            <section class="mt-10" id="faq">
              <h2 class="text-xl font-semibold mb-4">Punnett square FAQ</h2>
              <div class="space-y-3">
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    What is a Punnett square used for?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    A Punnett square predicts the probability of different
                    genotypes and phenotypes in offspring based on the genotypes
                    of the parents. It is widely used in biology and genetics
                    education to understand inheritance patterns.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    How many boxes does a Punnett square have?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    A monohybrid cross uses a 2×2 square (4 boxes). A dihybrid
                    cross uses a 4×4 square (16 boxes). More genes lead to more
                    boxes, but beyond two genes the grid becomes too large to be
                    practical for hand drawing, which is why most classroom
                    examples use one or two genes.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Can different genotypes have the same phenotype?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Yes. For a dominant–recessive trait, both
                    <span class="font-mono">AA</span> and
                    <span class="font-mono">Aa</span> show the dominant
                    phenotype, even though their genotypes differ. The
                    calculator groups such genotypes together when it reports
                    phenotype ratios.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Is this Punnett square calculator suitable for teaching?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Yes. It is designed for students and teachers: it supports
                    multiple cross types, shows the full grid, summarizes
                    ratios, and explains each step, making it ideal for
                    classroom demonstrations, homework, and self‑study.
                  </p>
                </details>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Punnett, Square.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Core Math & Algebra Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/probability"
                  class="text-blue-600 hover:underline"
                  >Probability</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/quartile"
                  class="text-blue-600 hover:underline"
                  >Quartile</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/limit"
                  class="text-blue-600 hover:underline"
                  >Limit</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/integral"
                  class="text-blue-600 hover:underline"
                  >Integral</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/derivative"
                  class="text-blue-600 hover:underline"
                  >Derivative</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/statistics"
                  class="text-blue-600 hover:underline"
                  >Statistics</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/binomial-distribution"
                  class="text-blue-600 hover:underline"
                  >Binomial Distribution</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/standard-deviation"
                  class="text-blue-600 hover:underline"
                  >Standard Deviation</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/mean-calculator-median-mode"
                  class="text-blue-600 hover:underline"
                  >Mean, Median, Mode</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/probability-calculator"
                  class="text-blue-600 hover:underline"
                  >Probability Calculator</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Biology & Genetics Tools</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/cell-doubling-time"
                  class="text-blue-600 hover:underline"
                  >Cell Doubling Time</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/hardy-weinberg"
                  class="text-blue-600 hover:underline"
                  >Hardy–Weinberg Equilibrium</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/allele-frequency"
                  class="text-blue-600 hover:underline"
                  >Allele Frequency</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/shannon-diversity-index"
                  class="text-blue-600 hover:underline"
                  >Shannon Diversity Index</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/simpsons-diversity-index"
                  class="text-blue-600 hover:underline"
                  >Simpson's Diversity Index</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/serial-dilution"
                  class="text-blue-600 hover:underline"
                  >Serial Dilution</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/dna-to-protein-translator"
                  class="text-blue-600 hover:underline"
                  >DNA to Protein Translator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molecular-weight"
                  class="text-blue-600 hover:underline"
                  >Molecular Weight</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molarity"
                  class="text-blue-600 hover:underline"
                  >Molarity</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Utility helpers
      function normalizeGenotype(genotype) {
        return genotype.replace(/\s+/g, "");
      }

      function groupAllelesByGene(genotype) {
        const groups = {};
        for (const ch of genotype) {
          if (!/[A-Za-z]/.test(ch)) continue;
          const key = ch.toUpperCase();
          if (!groups[key]) groups[key] = [];
          groups[key].push(ch);
        }
        return groups;
      }

      function generateGametesFromGroups(groups) {
        const genes = Object.keys(groups).sort();
        if (genes.length === 0) return [];
        let gametes = [""];
        for (const gene of genes) {
          const alleles = groups[gene];
          const next = [];
          for (const g of gametes) {
            for (const a of alleles) {
              next.push(g + a);
            }
          }
          gametes = next;
        }
        // Remove duplicates
        return Array.from(new Set(gametes));
      }

      function sortGenotype(genotype) {
        const groups = groupAllelesByGene(genotype);
        const genes = Object.keys(groups).sort();
        let result = "";
        for (const gene of genes) {
          const alleles = groups[gene].slice().sort((a, b) => {
            const ua = a.toUpperCase(),
              ub = b.toUpperCase();
            if (ua !== ub) return ua.localeCompare(ub);
            // Uppercase before lowercase
            if (a === ua && b !== ub) return -1;
            if (a !== ua && b === ub) return 1;
            return 0;
          });
          result += alleles.join("");
        }
        return result;
      }

      function inferPhenotype(genotype) {
        const groups = groupAllelesByGene(genotype);
        const genes = Object.keys(groups).sort();
        const parts = [];
        for (const gene of genes) {
          const alleles = groups[gene];
          const hasDominant = alleles.some((a) => a === a.toUpperCase());
          if (hasDominant) {
            parts.push(gene + "–dominant");
          } else {
            parts.push(gene + "–recessive");
          }
        }
        return parts.join(", ");
      }

      // Sex-linked helpers
      function parseSexLinked(genotype) {
        // Expect patterns like X^AX^a, X^AY, X^aY
        const cleaned = genotype.replace(/\s+/g, "");
        const tokens = [];
        let i = 0;
        while (i < cleaned.length) {
          if (cleaned[i] === "X") {
            let token = "X";
            i++;
            if (cleaned[i] === "^") {
              token += "^";
              i++;
              let allele = "";
              while (i < cleaned.length && /[A-Za-z]/.test(cleaned[i])) {
                allele += cleaned[i];
                i++;
              }
              if (allele.length === 0)
                throw new Error("Invalid X-linked allele notation.");
              token += allele;
            }
            tokens.push(token);
          } else if (cleaned[i] === "Y") {
            tokens.push("Y");
            i++;
          } else {
            throw new Error(
              "Use X and Y with ^ notation, e.g. X^AX^a or X^AY."
            );
          }
        }
        return tokens;
      }

      function sexLinkedGametes(tokens, isMother) {
        // Mother: two X tokens; Father: one X token and one Y
        const xs = tokens.filter((t) => t.startsWith("X"));
        const ys = tokens.filter((t) => t === "Y");
        const gametes = [];
        if (isMother) {
          if (xs.length !== 2 || ys.length !== 0)
            throw new Error("Mother must have two X chromosomes (no Y).");
          gametes.push(xs[0], xs[1]);
        } else {
          if (xs.length !== 1 || ys.length !== 1)
            throw new Error("Father must have one X and one Y chromosome.");
          gametes.push(xs[0], "Y");
        }
        return gametes;
      }

      function combineSexLinkedGametes(g1, g2) {
        // g1, g2 are tokens like "X^A" or "Y"
        const xs = [g1, g2].filter((t) => t.startsWith("X"));
        const ys = [g1, g2].filter((t) => t === "Y");
        return xs.join("") + ys.join("");
      }

      function inferSexLinkedPhenotype(genotype) {
        // genotype like "X^AX^a", "X^aY"
        const xs = [];
        let i = 0;
        while (i < genotype.length) {
          if (genotype[i] === "X") {
            let token = "X";
            i++;
            if (genotype[i] === "^") {
              token += "^";
              i++;
              let allele = "";
              while (i < genotype.length && /[A-Za-z]/.test(genotype[i])) {
                allele += genotype[i];
                i++;
              }
              token += allele;
            }
            xs.push(token);
          } else if (genotype[i] === "Y") {
            i++;
          } else {
            i++;
          }
        }
        const alleles = xs.map((t) => t.split("^")[1] || "");
        const hasDominant = alleles.some(
          (a) => a && a[0] === a[0].toUpperCase()
        );
        const gene = "X-linked";
        return hasDominant ? gene + "–dominant" : gene + "–recessive";
      }

      // Main logic
      const modeSelect = document.getElementById("mode");
      const standardInputs = document.getElementById("standard-inputs");
      const sexInputs = document.getElementById("sexlinked-inputs");
      const modeHelp = document.getElementById("mode-help");
      const errorMsg = document.getElementById("error-msg");
      const squareContainer = document.getElementById("square-container");
      const squareTable = document.getElementById("square-table");
      const squareNote = document.getElementById("square-note");
      const summaryContainer = document.getElementById("summary-container");
      const genotypeList = document.getElementById("genotype-list");
      const phenotypeList = document.getElementById("phenotype-list");
      const stepContainer = document.getElementById("step-container");
      const stepList = document.getElementById("step-list");

      modeSelect.addEventListener("change", () => {
        const mode = modeSelect.value;
        errorMsg.textContent = "";
        if (mode === "sex") {
          standardInputs.classList.add("hidden");
          sexInputs.classList.remove("hidden");
          modeHelp.textContent =
            "Sex-linked: X-linked trait. Example: Mother X^AX^a, Father X^aY.";
        } else {
          sexInputs.classList.add("hidden");
          standardInputs.classList.remove("hidden");
          modeHelp.textContent =
            "Monohybrid: one gene (e.g., Aa × aa). Dihybrid: two genes (e.g., AaBb × Aabb). Sex-linked: X-linked trait (e.g., X^AX^a × X^aY).";
        }
        clearResults();
      });

      document.getElementById("calculate-btn").addEventListener("click", () => {
        errorMsg.textContent = "";
        clearResults();
        try {
          const mode = modeSelect.value;
          if (mode === "sex") {
            runSexLinked();
          } else {
            runStandard(mode);
          }
        } catch (e) {
          console.error(e);
          errorMsg.textContent =
            e.message || "Invalid input. Please check your genotypes.";
        }
      });

      document.getElementById("clear-btn").addEventListener("click", () => {
        document.getElementById("parent1").value = "Aa";
        document.getElementById("parent2").value = "Aa";
        document.getElementById("mother").value = "X^AX^a";
        document.getElementById("father").value = "X^AY";
        errorMsg.textContent = "";
        clearResults();
      });

      function clearResults() {
        squareContainer.classList.add("hidden");
        summaryContainer.classList.add("hidden");
        stepContainer.classList.add("hidden");
        squareTable.innerHTML = "";
        genotypeList.innerHTML = "";
        phenotypeList.innerHTML = "";
        stepList.innerHTML = "";
        squareNote.textContent = "";
      }

      function runStandard(mode) {
        const p1 = normalizeGenotype(document.getElementById("parent1").value);
        const p2 = normalizeGenotype(document.getElementById("parent2").value);
        if (!p1 || !p2)
          throw new Error("Please enter both parental genotypes.");
        if (!/^[A-Za-z]+$/.test(p1) || !/^[A-Za-z]+$/.test(p2)) {
          throw new Error(
            "Use only letters for autosomal genotypes (e.g., Aa, AABb)."
          );
        }

        const g1 = groupAllelesByGene(p1);
        const g2 = groupAllelesByGene(p2);
        const genes1 = Object.keys(g1).sort();
        const genes2 = Object.keys(g2).sort();
        if (
          genes1.length !== genes2.length ||
          genes1.join("") !== genes2.join("")
        ) {
          throw new Error(
            "Both parents must use the same gene letters (e.g., A/a and B/b)."
          );
        }
        const geneCount = genes1.length;
        if (mode === "mono" && geneCount !== 1) {
          throw new Error(
            "Monohybrid mode expects exactly 1 gene (e.g., Aa × aa)."
          );
        }
        if (mode === "di" && geneCount !== 2) {
          throw new Error(
            "Dihybrid mode expects exactly 2 genes (e.g., AaBb × Aabb)."
          );
        }

        const gametes1 = generateGametesFromGroups(g1);
        const gametes2 = generateGametesFromGroups(g2);
        if (gametes1.length > 4 || gametes2.length > 4) {
          throw new Error(
            "This tool supports up to 4 gametes per parent (typical for monohybrid/dihybrid crosses)."
          );
        }

        buildSquareStandard(gametes1, gametes2);
        summarizeStandard(gametes1, gametes2);
        explainStandard(p1, p2, genes1, gametes1, gametes2);
      }

      function buildSquareStandard(gametes1, gametes2) {
        const rows = gametes2.length;
        const cols = gametes1.length;
        const thead = document.createElement("thead");
        const headRow = document.createElement("tr");
        headRow.appendChild(document.createElement("th")); // empty corner
        gametes1.forEach((g) => {
          const th = document.createElement("th");
          th.textContent = g;
          headRow.appendChild(th);
        });
        thead.appendChild(headRow);

        const tbody = document.createElement("tbody");
        for (let r = 0; r < rows; r++) {
          const tr = document.createElement("tr");
          const rowHeader = document.createElement("th");
          rowHeader.textContent = gametes2[r];
          tr.appendChild(rowHeader);
          for (let c = 0; c < cols; c++) {
            const td = document.createElement("td");
            const genotype = sortGenotype(gametes1[c] + gametes2[r]);
            td.textContent = genotype;
            tr.appendChild(td);
          }
          tbody.appendChild(tr);
        }
        squareTable.innerHTML = "";
        squareTable.appendChild(thead);
        squareTable.appendChild(tbody);
        squareContainer.classList.remove("hidden");
        squareNote.textContent =
          "Columns show gametes from Parent 1; rows show gametes from Parent 2.";
      }

      function summarizeStandard(gametes1, gametes2) {
        const counts = {};
        const phenoCounts = {};
        const total = gametes1.length * gametes2.length;
        for (const g1 of gametes1) {
          for (const g2 of gametes2) {
            const geno = sortGenotype(g1 + g2);
            counts[geno] = (counts[geno] || 0) + 1;
            const pheno = inferPhenotype(geno);
            phenoCounts[pheno] = (phenoCounts[pheno] || 0) + 1;
          }
        }
        genotypeList.innerHTML = "";
        Object.keys(counts)
          .sort()
          .forEach((geno) => {
            const li = document.createElement("li");
            const pct = ((counts[geno] / total) * 100).toFixed(1);
            li.innerHTML = `<span class="font-mono">${geno}</span> – ${counts[geno]} of ${total} (${pct}%)`;
            genotypeList.appendChild(li);
          });

        phenotypeList.innerHTML = "";
        Object.keys(phenoCounts)
          .sort()
          .forEach((pheno) => {
            const li = document.createElement("li");
            const pct = ((phenoCounts[pheno] / total) * 100).toFixed(1);
            li.innerHTML = `<span>${pheno}</span> – ${phenoCounts[pheno]} of ${total} (${pct}%)`;
            phenotypeList.appendChild(li);
          });

        summaryContainer.classList.remove("hidden");
      }

      function explainStandard(p1, p2, genes, gametes1, gametes2) {
        const steps = [];
        steps.push(`Parent 1 genotype: ${p1}`);
        steps.push(`Parent 2 genotype: ${p2}`);
        steps.push(`Genes considered: ${genes.join(", ")}.`);
        steps.push(`Parent 1 gametes: ${gametes1.join(", ")}.`);
        steps.push(`Parent 2 gametes: ${gametes2.join(", ")}.`);
        steps.push(
          "Each cell in the Punnett square combines one gamete from each parent to form an offspring genotype."
        );
        steps.push(
          "Genotype counts are converted into probabilities, and phenotypes are inferred assuming uppercase alleles are dominant."
        );

        stepList.innerHTML = "";
        steps.forEach((s) => {
          const li = document.createElement("li");
          li.textContent = s;
          stepList.appendChild(li);
        });
        stepContainer.classList.remove("hidden");
      }

      function runSexLinked() {
        const motherStr = document.getElementById("mother").value;
        const fatherStr = document.getElementById("father").value;
        if (!motherStr || !fatherStr)
          throw new Error("Please enter both mother and father genotypes.");
        const motherTokens = parseSexLinked(motherStr);
        const fatherTokens = parseSexLinked(fatherStr);
        const gametesMother = sexLinkedGametes(motherTokens, true);
        const gametesFather = sexLinkedGametes(fatherTokens, false);

        buildSquareSexLinked(gametesMother, gametesFather);
        summarizeSexLinked(gametesMother, gametesFather);
        explainSexLinked(motherStr, fatherStr, gametesMother, gametesFather);
      }

      function buildSquareSexLinked(gametesMother, gametesFather) {
        const cols = gametesMother.length;
        const rows = gametesFather.length;
        const thead = document.createElement("thead");
        const headRow = document.createElement("tr");
        headRow.appendChild(document.createElement("th"));
        gametesMother.forEach((g) => {
          const th = document.createElement("th");
          th.textContent = g;
          headRow.appendChild(th);
        });
        thead.appendChild(headRow);

        const tbody = document.createElement("tbody");
        for (let r = 0; r < rows; r++) {
          const tr = document.createElement("tr");
          const rowHeader = document.createElement("th");
          rowHeader.textContent = gametesFather[r];
          tr.appendChild(rowHeader);
          for (let c = 0; c < cols; c++) {
            const td = document.createElement("td");
            const geno = combineSexLinkedGametes(
              gametesMother[c],
              gametesFather[r]
            );
            td.textContent = geno;
            tr.appendChild(td);
          }
          tbody.appendChild(tr);
        }
        squareTable.innerHTML = "";
        squareTable.appendChild(thead);
        squareTable.appendChild(tbody);
        squareContainer.classList.remove("hidden");
        squareNote.textContent =
          "Columns show egg gametes from the mother; rows show sperm gametes from the father.";
      }

      function summarizeSexLinked(gametesMother, gametesFather) {
        const counts = {};
        const phenoCounts = {};
        const total = gametesMother.length * gametesFather.length;
        let sons = 0,
          daughters = 0;
        const sonCounts = {},
          daughterCounts = {};

        for (const gm of gametesMother) {
          for (const gf of gametesFather) {
            const geno = combineSexLinkedGametes(gm, gf);
            counts[geno] = (counts[geno] || 0) + 1;
            const pheno = inferSexLinkedPhenotype(geno);
            phenoCounts[pheno] = (phenoCounts[pheno] || 0) + 1;
            if (geno.includes("Y")) {
              sons++;
              sonCounts[pheno] = (sonCounts[pheno] || 0) + 1;
            } else {
              daughters++;
              daughterCounts[pheno] = (daughterCounts[pheno] || 0) + 1;
            }
          }
        }

        genotypeList.innerHTML = "";
        Object.keys(counts)
          .sort()
          .forEach((geno) => {
            const li = document.createElement("li");
            const pct = ((counts[geno] / total) * 100).toFixed(1);
            li.innerHTML = `<span class="font-mono">${geno}</span> – ${counts[geno]} of ${total} (${pct}%)`;
            genotypeList.appendChild(li);
          });

        phenotypeList.innerHTML = "";
        const allPhenotypes = Object.keys(phenoCounts).sort();
        allPhenotypes.forEach((pheno) => {
          const li = document.createElement("li");
          const pct = ((phenoCounts[pheno] / total) * 100).toFixed(1);
          li.innerHTML = `<span>${pheno}</span> – ${phenoCounts[pheno]} of ${total} (${pct}%)`;
          phenotypeList.appendChild(li);
        });

        if (sons > 0 || daughters > 0) {
          const li = document.createElement("li");
          li.classList.add("mt-2");
          let html = '<div class="text-xs text-gray-700 mt-1">';
          if (daughters > 0) {
            html += `<div><span class="badge bg-pink-100 text-pink-800">Daughters</span> `;
            Object.keys(daughterCounts).forEach((ph) => {
              const pct = ((daughterCounts[ph] / daughters) * 100).toFixed(1);
              html += `<br>${ph}: ${daughterCounts[ph]} of ${daughters} (${pct}%)`;
            });
            html += "</div>";
          }
          if (sons > 0) {
            html += `<div class="mt-1"><span class="badge bg-blue-100 text-blue-800">Sons</span> `;
            Object.keys(sonCounts).forEach((ph) => {
              const pct = ((sonCounts[ph] / sons) * 100).toFixed(1);
              html += `<br>${ph}: ${sonCounts[ph]} of ${sons} (${pct}%)`;
            });
            html += "</div>";
          }
          html += "</div>";
          li.innerHTML = html;
          phenotypeList.appendChild(li);
        }

        summaryContainer.classList.remove("hidden");
      }

      function explainSexLinked(
        motherStr,
        fatherStr,
        gametesMother,
        gametesFather
      ) {
        const steps = [];
        steps.push(`Mother genotype: ${motherStr} (XX).`);
        steps.push(`Father genotype: ${fatherStr} (XY).`);
        steps.push(`Mother's egg gametes: ${gametesMother.join(", ")}.`);
        steps.push(`Father's sperm gametes: ${gametesFather.join(", ")}.`);
        steps.push(
          "Each cell in the Punnett square combines one egg and one sperm to form a child's genotype."
        );
        steps.push(
          "Genotypes containing Y are sons; genotypes with two X chromosomes are daughters."
        );
        steps.push(
          "Phenotypes are inferred assuming the X^A allele is dominant over X^a."
        );

        stepList.innerHTML = "";
        steps.forEach((s) => {
          const li = document.createElement("li");
          li.textContent = s;
          stepList.appendChild(li);
        });
        stepContainer.classList.remove("hidden");
      }

      // Mobile menu toggle
      document
        .getElementById("mobile-menu-toggle")
        .addEventListener("click", () => {
          const menu = document.getElementById("mobile-menu");
          const isHidden = menu.classList.contains("hidden");
          menu.classList.toggle("hidden", !isHidden);
        });
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

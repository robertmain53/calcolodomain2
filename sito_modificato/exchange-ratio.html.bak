<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/exchange-ratio" />
    <title>Exchange Ratio Calculator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Exchange Ratio Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Exchange Ratio Calculator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Exchange Ratio Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/exchange-ratio" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Exchange Ratio Calculator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Exchange Ratio Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Exchange Ratio Calculator for M&A Deals (Fixed, Floating & Collars)",
        "description": "Interactive exchange ratio calculator for stock-for-stock M&A deals. Compute fixed and floating exchange ratios, implied offer price, premium, ownership split, and collar scenarios.",
        "url": "https://calcdomain.com/exchange-ratio",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Finance",
              "item": "https://calcdomain.com/categories/finance"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Finance",
              "item": "https://calcdomain.com/finance"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Exchange Ratio Calculator",
              "item": "https://calcdomain.com/exchange-ratio"
            }
          ]
        },
        "mainEntity": [
          {
            "@type": "FinancialProduct",
            "name": "Exchange Ratio Calculator",
            "description": "Tool to compute exchange ratios in stock-for-stock mergers and acquisitions, including fixed and floating structures with collars.",
            "category": "Mergers and Acquisitions"
          },
          {
            "@type": "FAQPage",
            "mainEntity": [
              {
                "@type": "Question",
                "name": "What is an exchange ratio in M&A?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "In a stock-for-stock merger or acquisition, the exchange ratio tells you how many shares of the acquirer each target share will receive. For example, an exchange ratio of 0.50 means each target share is exchanged for 0.5 shares of the acquirer."
                }
              },
              {
                "@type": "Question",
                "name": "How do you calculate a fixed exchange ratio?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "A fixed exchange ratio is usually set as the offer price per target share divided by the acquirer share price at signing. Formula: Exchange Ratio = Offer Price per Target Share ÷ Acquirer Share Price at Signing."
                }
              },
              {
                "@type": "Question",
                "name": "What is a floating exchange ratio?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "With a floating exchange ratio, the dollar value per target share is fixed, and the number of acquirer shares adjusts based Share ÷ Acquirer Share Price at Closing."
                }
              },
              {
                "@type": "Question",
                "name": "What is a collar in an exchange ratio?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "A collar sets upper and lower bounds on the effective exchange ratio or on the acquirer’s share price used in the calculation. It protects one or both parties from large share price moves between signing and closing by switching between fixed and floating behavior within a price band."
                }
              },
              {
                "@type": "Question",
                "name": "How does the exchange ratio affect ownership split?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "The exchange ratio determines how many new shares the acquirer issues to target shareholders. Ownership % for target shareholders = New Shares Issued ÷ (Existing Acquirer Shares + New Shares Issued). A higher exchange ratio generally gives target shareholders a larger ownership stake."
                }
              }
            ]
          }
        ]
      }</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Finance Calculators", "item": "https://calcdomain.com/categories/finance"}, {"@type": "ListItem", "position": 3, "name": "International Personal Finance", "item": "https://calcdomain.com/subcategories/finance-international-personal"}, {"@type": "ListItem", "position": 4, "name": "Exchange Ratio Calculator (M&amp;A Stock-for-Stock Deals)", "item": "https://calcdomain.com/exchange-ratio"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/finance" class="text-blue-600 hover:underline">Finance Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/finance-international-personal" class="text-blue-600 hover:underline">International Personal Finance</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Exchange Ratio Calculator (M&amp;amp;A Stock-for-Stock Deals)</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <div class="flex items-center justify-between gap-2 flex-wrap">
                <h1 class="text-2xl font-bold text-gray-900">
                  Exchange Ratio Calculator (M&amp;A Stock-for-Stock Deals)
                </h1>
                <span class="badge">M&amp;A • Equity • Deal Structuring</span>
              </div>
              <p class="mt-2 text-sm text-gray-600">
                Model fixed and floating exchange ratios, implied offer price,
                premium, and post-deal ownership for stock-for-stock mergers and
                acquisitions. Includes collar and sensitivity analysis.
              </p>
            </header>

            <!-- Calculator Tabs -->
            <div class="mb-4 border-b border-gray-200">
              <nav
                class="-mb-px flex flex-wrap gap-2"
                aria-label="Exchange ratio modes"
              >
                <button
                  type="button"
                  data-tab="fixed"
                  class="tab-btn border-b-2 border-blue-600 text-blue-600 px-3 py-2 text-sm font-medium"
                >
                  Fixed Exchange Ratio
                </button>
                <button
                  type="button"
                  data-tab="floating"
                  class="tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 px-3 py-2 text-sm font-medium"
                >
                  Floating (Fixed Value)
                </button>
                <button
                  type="button"
                  data-tab="collar"
                  class="tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 px-3 py-2 text-sm font-medium"
                >
                  Collar Scenario
                </button>
              </nav>
            </div>

            <!-- Input Grid -->
            <section aria-label="Inputs" class="space-y-6">
              <!-- Common Deal Inputs -->
              <div class="grid md:grid-cols-2 gap-4">
                <div>
                  <label class="input-label" for="acq-price-signing"
                    >Acquirer share price at signing</label
                  >
                  <div class="flex">
                    <span
                      class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                      >$</span
                    >
                    <input
                      id="acq-price-signing"
                      type="number"
                      step="0.01"
                      class="input-field rounded-l-none"
                      value="50"
                    />
                  </div>
                </div>
                <div>
                  <label class="input-label" for="tgt-price-signing"
                    >Target standalone price at signing</label
                  >
                  <div class="flex">
                    <span
                      class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                      >$</span
                    >
                    <input
                      id="tgt-price-signing"
                      type="number"
                      step="0.01"
                      class="input-field rounded-l-none"
                      value="40"
                    />
                  </div>
                </div>
                <div>
                  <label class="input-label" for="acq-shares-out"
                    >Acquirer basic shares outstanding</label
                  >
                  <input
                    id="acq-shares-out"
                    type="number"
                    step="1"
                    class="input-field"
                    value="200000000"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Use basic or fully diluted shares, consistent with your
                    model.
                  </p>
                </div>
                <div>
                  <label class="input-label" for="tgt-shares-out"
                    >Target basic shares outstanding</label
                  >
                  <input
                    id="tgt-shares-out"
                    type="number"
                    step="1"
                    class="input-field"
                    value="100000000"
                  />
                </div>
              </div>

              <!-- Fixed Exchange Ratio Panel -->
              <div id="panel-fixed" class="tab-panel space-y-4">
                <h2 class="section-title">Fixed Exchange Ratio</h2>
                <p class="text-sm text-gray-600">
                  In a fixed exchange ratio deal, the number of acquirer shares
                  per target share is locked at signing. The dollar value per
                  target share will float with the acquirer’s share price.
                </p>
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label class="input-label" for="fixed-offer-price"
                      >Target offer price at signing (per share)</label
                    >
                    <div class="flex">
                      <span
                        class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                        >$</span
                      >
                      <input
                        id="fixed-offer-price"
                        type="number"
                        step="0.01"
                        class="input-field rounded-l-none"
                        value="48"
                      />
                    </div>
                    <p class="text-xs text-gray-500 mt-1">
                      Optional. If left blank, you can input the exchange ratio
                      directly.
                    </p>
                  </div>
                  <div>
                    <label class="input-label" for="fixed-exchange-ratio"
                      >Exchange ratio (acquirer shares per target share)</label
                    >
                    <input
                      id="fixed-exchange-ratio"
                      type="number"
                      step="0.0001"
                      class="input-field"
                      placeholder="Auto-calculated from prices"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      If you enter both offer price and ratio, the ratio will be
                      recalculated from prices.
                    </p>
                  </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label class="input-label" for="acq-price-closing-fixed"
                      >Acquirer share price at closing (scenario)</label
                    >
                    <div class="flex">
                      <span
                        class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                        >$</span
                      >
                      <input
                        id="acq-price-closing-fixed"
                        type="number"
                        step="0.01"
                        class="input-field rounded-l-none"
                        value="45"
                      />
                    </div>
                    <p class="text-xs text-gray-500 mt-1">
                      Use this to see how the implied offer value changes by
                      closing.
                    </p>
                  </div>
                </div>
              </div>

              <!-- Floating Exchange Ratio Panel -->
              <div id="panel-floating" class="tab-panel space-y-4 hidden">
                <h2 class="section-title">
                  Floating Exchange Ratio (Fixed Dollar Value)
                </h2>
                <p class="text-sm text-gray-600">
                  In a floating exchange ratio deal, the dollar value per target
                  share is fixed, and the number of acquirer shares adjusts
                  based on the acquirer’s share price at closing.
                </p>
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label class="input-label" for="floating-fixed-value"
                      >Fixed cash-equivalent value per target share</label
                    >
                    <div class="flex">
                      <span
                        class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                        >$</span
                      >
                      <input
                        id="floating-fixed-value"
                        type="number"
                        step="0.01"
                        class="input-field rounded-l-none"
                        value="48"
                      />
                    </div>
                  </div>
                  <div>
                    <label class="input-label" for="acq-price-closing-floating"
                      >Acquirer share price at closing</label
                    >
                    <div class="flex">
                      <span
                        class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                        >$</span
                      >
                      <input
                        id="acq-price-closing-floating"
                        type="number"
                        step="0.01"
                        class="input-field rounded-l-none"
                        value="45"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <!-- Collar Panel -->
              <div id="panel-collar" class="tab-panel space-y-4 hidden">
                <h2 class="section-title">
                  Collar Scenario (Price Band Protection)
                </h2>
                <p class="text-sm text-gray-600">
                  Model a simple collar where the acquirer’s share price used in
                  the floating exchange ratio is capped and floored. Outside the
                  band, the effective exchange ratio behaves like fixed.
                </p>
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label class="input-label" for="collar-fixed-value"
                      >Target fixed value per share</label
                    >
                    <div class="flex">
                      <span
                        class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                        >$</span
                      >
                      <input
                        id="collar-fixed-value"
                        type="number"
                        step="0.01"
                        class="input-field rounded-l-none"
                        value="48"
                      />
                    </div>
                  </div>
                  <div>
                    <label class="input-label" for="collar-price-closing"
                      >Acquirer share price at closing</label
                    >
                    <div class="flex">
                      <span
                        class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                        >$</span
                      >
                      <input
                        id="collar-price-closing"
                        type="number"
                        step="0.01"
                        class="input-field rounded-l-none"
                        value="45"
                      />
                    </div>
                  </div>
                  <div>
                    <label class="input-label" for="collar-floor"
                      >Collar lower bound on acquirer price</label
                    >
                    <div class="flex">
                      <span
                        class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                        >$</span
                      >
                      <input
                        id="collar-floor"
                        type="number"
                        step="0.01"
                        class="input-field rounded-l-none"
                        value="40"
                      />
                    </div>
                  </div>
                  <div>
                    <label class="input-label" for="collar-cap"
                      >Collar upper bound on acquirer price</label
                    >
                    <div class="flex">
                      <span
                        class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"
                        >$</span
                      >
                      <input
                        id="collar-cap"
                        type="number"
                        step="0.01"
                        class="input-field rounded-l-none"
                        value="60"
                      />
                    </div>
                  </div>
                </div>
                <p class="text-xs text-gray-500">
                  Effective price used for the floating ratio = min(max(Closing
                  Price, Floor), Cap).
                </p>
              </div>

              <div class="flex flex-wrap gap-3 items-center pt-2">
                <button
                  id="calculate-btn"
                  type="button"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md shadow-sm"
                >
                  Calculate Exchange Ratio &amp; Ownership
                </button>
                <button
                  id="reset-btn"
                  type="button"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs font-medium rounded-md"
                >
                  Reset to defaults
                </button>
                <p id="error-msg" class="text-xs text-red-600"></p>
              </div>
            </section>

            <!-- Results -->
            <section aria-label="Results" class="mt-8 space-y-4">
              <h2 class="section-title">Results</h2>
              <div class="grid md:grid-cols-2 gap-4">
                <div class="bg-blue-50 border border-blue-100 rounded-lg p-4">
                  <h3 class="text-sm font-semibold text-blue-800 mb-2">
                    Exchange Ratio &amp; Offer
                  </h3>
                  <dl class="space-y-1 text-sm">
                    <div class="flex justify-between">
                      <dt>Exchange ratio</dt>
                      <dd
                        id="res-exchange-ratio"
                        class="font-semibold text-gray-900"
                      >
                        –
                      </dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Implied offer price at signing</dt>
                      <dd
                        id="res-offer-signing"
                        class="font-semibold text-gray-900"
                      >
                        –
                      </dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Premium vs. standalone (%)</dt>
                      <dd
                        id="res-premium-signing"
                        class="font-semibold text-gray-900"
                      >
                        –
                      </dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Implied offer price at closing</dt>
                      <dd
                        id="res-offer-closing"
                        class="font-semibold text-gray-900"
                      >
                        –
                      </dd>
                    </div>
                  </dl>
                </div>
                <div class="bg-green-50 border border-green-100 rounded-lg p-4">
                  <h3 class="text-sm font-semibold text-green-800 mb-2">
                    Ownership &amp; Dilution
                  </h3>
                  <dl class="space-y-1 text-sm">
                    <div class="flex justify-between">
                      <dt>New shares issued to target</dt>
                      <dd
                        id="res-new-shares"
                        class="font-semibold text-gray-900"
                      >
                        –
                      </dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Pro forma shares outstanding</dt>
                      <dd
                        id="res-proforma-shares"
                        class="font-semibold text-gray-900"
                      >
                        –
                      </dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Target ownership %</dt>
                      <dd
                        id="res-target-ownership"
                        class="font-semibold text-gray-900"
                      >
                        –
                      </dd>
                    </div>
                    <div class="flex justify-between">
                      <dt>Acquirer ownership %</dt>
                      <dd
                        id="res-acquirer-ownership"
                        class="font-semibold text-gray-900"
                      >
                        –
                      </dd>
                    </div>
                  </dl>
                </div>
              </div>

              <!-- Collar-specific note -->
              <div
                id="collar-note"
                class="hidden text-xs text-gray-600 bg-yellow-50 border border-yellow-100 rounded-md p-3"
              >
                <span class="font-semibold">Collar status: </span>
                <span id="collar-status-text">–</span>
              </div>

              <!-- Sensitivity Table -->
              <div class="mt-6">
                <h3 class="text-sm font-semibold text-gray-800 mb-2">
                  Sensitivity: Implied Offer vs. Acquirer Share Price
                </h3>
                <p class="text-xs text-gray-500 mb-2">
                  Quick view of how the implied offer price per target share
                  changes as the acquirer’s share price moves, holding the
                  exchange ratio structure constant.
                </p>
                <div class="overflow-x-auto">
                  <table
                    class="min-w-full text-xs border border-gray-200 rounded-lg overflow-hidden"
                  >
                    <thead class="bg-gray-100">
                      <tr>
                        <th
                          class="px-3 py-2 text-left font-semibold text-gray-700 border-b border-gray-200"
                        >
                          Acquirer Price
                        </th>
                        <th
                          class="px-3 py-2 text-left font-semibold text-gray-700 border-b border-gray-200"
                        >
                          Implied Offer / Target Share
                        </th>
                        <th
                          class="px-3 py-2 text-left font-semibold text-gray-700 border-b border-gray-200"
                        >
                          Premium vs. Standalone
                        </th>
                      </tr>
                    </thead>
                    <tbody id="sensitivity-body">
                      <!-- Filled by JS -->
                    </tbody>
                  </table>
                </div>
              </div>
            </section>

            <!-- Explanatory Content -->
            <section class="prose mt-10">
              <h2>What is an exchange ratio in M&amp;A?</h2>
              <p>
                In a stock-for-stock merger or acquisition, the
                <strong>exchange ratio</strong> tells you how many shares of the
                acquirer each target share will receive. For example, an
                exchange ratio of <code>0.50</code> means each target share is
                exchanged for <code>0.5</code> shares of the acquirer.
              </p>
              <p>
                The exchange ratio drives the
                <strong>implied offer price</strong>, the
                <strong>premium</strong> to the target’s standalone price, and
                the <strong>post-deal ownership split</strong> between acquirer
                and target shareholders.
              </p>

              <h2>Key formulas used in this calculator</h2>

              <h3>1. Fixed exchange ratio</h3>
              <div class="formula-box">
                <p><strong>Exchange ratio (fixed):</strong></p>
                <p>
                  $$ \text{ER}_{\text{fixed}} = \frac{\text{Offer Price per
                  Target Share at Signing}}{\text{Acquirer Share Price at
                  Signing}} $$
                </p>
                <p><strong>Implied offer price at signing:</strong></p>
                <p>
                  $$ \text{Offer}_{\text{signing}} = \text{ER}_{\text{fixed}}
                  \times \text{Acquirer Price}_{\text{signing}} $$
                </p>
                <p><strong>Implied offer price at closing:</strong></p>
                <p>
                  $$ \text{Offer}_{\text{closing}} = \text{ER}_{\text{fixed}}
                  \times \text{Acquirer Price}_{\text{closing}} $$
                </p>
              </div>
              <p>
                In a pure fixed exchange ratio deal, the <em>ratio</em> is
                locked. If the acquirer’s share price falls, the dollar value
                per target share falls as well.
              </p>

              <h3>2. Floating exchange ratio (fixed value)</h3>
              <div class="formula-box">
                <p><strong>Exchange ratio (floating):</strong></p>
                <p>
                  $$ \text{ER}_{\text{floating}} = \frac{\text{Fixed Dollar
                  Consideration per Target Share}}{\text{Acquirer Share Price at
                  Closing}} $$
                </p>
                <p><strong>Implied offer price at closing:</strong></p>
                <p>
                  $$ \text{Offer}_{\text{closing}} = \text{Fixed Dollar
                  Consideration per Target Share} $$
                </p>
              </div>
              <p>
                Here, the <em>dollar value</em> is fixed. If the acquirer’s
                share price falls, the target receives more shares; if it rises,
                the target receives fewer shares.
              </p>

              <h3>3. Collar structure (simple price band)</h3>
              <div class="formula-box">
                <p><strong>Effective acquirer price used in ratio:</strong></p>
                <p>
                  $$ P_{\text{eff}} = \min\left( \max\left(P_{\text{closing}},
                  P_{\text{floor}}\right), P_{\text{cap}} \right) $$
                </p>
                <p><strong>Exchange ratio with collar:</strong></p>
                <p>
                  $$ \text{ER}_{\text{collar}} = \frac{\text{Fixed Dollar
                  Consideration per Target Share}}{P_{\text{eff}}} $$
                </p>
              </div>
              <p>
                Within the collar band, the deal behaves like a floating
                exchange ratio. Outside the band, the effective price is capped
                or floored, which makes the exchange ratio behave more like
                fixed.
              </p>

              <h3>4. Premium and ownership</h3>
              <div class="formula-box">
                <p><strong>Premium vs. standalone price:</strong></p>
                <p>
                  $$ \text{Premium} = \frac{\text{Offer Price} -
                  \text{Standalone Target Price}}{\text{Standalone Target
                  Price}} $$
                </p>
                <p><strong>New shares issued to target:</strong></p>
                <p>
                  $$ \text{New Shares} = \text{ER} \times \text{Target Shares
                  Outstanding} $$
                </p>
                <p><strong>Pro forma shares outstanding:</strong></p>
                <p>
                  $$ \text{Pro Forma Shares} = \text{Acquirer Shares} +
                  \text{New Shares} $$
                </p>
                <p><strong>Target ownership %:</strong></p>
                <p>
                  $$ \%_{\text{Target}} = \frac{\text{New Shares}}{\text{Pro
                  Forma Shares}} $$
                </p>
                <p><strong>Acquirer ownership %:</strong></p>
                <p>$$ \%_{\text{Acquirer}} = 1 - \%_{\text{Target}} $$</p>
              </div>

              <h2>How to use the Exchange Ratio Calculator</h2>
              <ol>
                <li>
                  <strong>Enter market data.</strong> Input the acquirer and
                  target share prices at signing, plus each company’s basic or
                  fully diluted share count.
                </li>
                <li>
                  <strong>Choose a structure.</strong> Use the tabs to select:
                  <ul>
                    <li>
                      <strong>Fixed</strong> – lock the exchange ratio at
                      signing.
                    </li>
                    <li>
                      <strong>Floating</strong> – lock the dollar value per
                      target share.
                    </li>
                    <li>
                      <strong>Collar</strong> – protect both sides with a price
                      band.
                    </li>
                  </ul>
                </li>
                <li>
                  <strong>Set the economics.</strong>
                  <ul>
                    <li>
                      For <em>Fixed</em>, enter the target offer price at
                      signing (or directly enter an exchange ratio).
                    </li>
                    <li>
                      For <em>Floating</em>, enter the fixed dollar value per
                      target share and a closing price scenario.
                    </li>
                    <li>
                      For <em>Collar</em>, set the fixed value plus lower and
                      upper bounds for the acquirer’s share price.
                    </li>
                  </ul>
                </li>
                <li>
                  <strong>Click “Calculate”.</strong> The tool computes the
                  exchange ratio, implied offer price, premium, and post-deal
                  ownership split.
                </li>
                <li>
                  <strong>Review sensitivity.</strong> Use the sensitivity table
                  to see how the implied offer changes as the acquirer’s share
                  price moves.
                </li>
              </ol>

              <h2>Fixed vs. floating exchange ratios: when to use which?</h2>
              <h3>Fixed exchange ratio – target shares price risk</h3>
              <ul>
                <li>
                  Target shareholders bear more risk from acquirer share price
                  moves.
                </li>
                <li>
                  Acquirer knows exactly how many shares it will issue (dilution
                  is predictable).
                </li>
                <li>
                  Common when the acquirer is significantly larger and more
                  liquid than the target.
                </li>
              </ul>

              <h3>Floating exchange ratio – acquirer shares risk</h3>
              <ul>
                <li>
                  Target shareholders are protected on value; they receive a
                  fixed dollar amount.
                </li>
                <li>
                  Acquirer bears more risk on share price moves and potential
                  dilution.
                </li>
                <li>
                  Common when the target has strong bargaining power or when
                  market volatility is high.
                </li>
              </ul>

              <h3>Collars – sharing the risk</h3>
              <p>
                Collars are often used to
                <strong>share price risk</strong> between acquirer and target.
                Within a band, the deal behaves like floating (protecting
                value). Outside the band, the deal behaves more like fixed
                (limiting dilution or value leakage).
              </p>

              <h2>Limitations and practical notes</h2>
              <ul>
                <li>
                  This calculator focuses on
                  <strong>stock-for-stock consideration</strong> and does not
                  model cash components or earn-outs.
                </li>
                <li>
                  Use consistent share counts (basic vs. fully diluted) for both
                  acquirer and target.
                </li>
                <li>
                  In real transactions, legal documentation may define more
                  complex collars, caps, and walk-away rights than the
                  simplified structure here.
                </li>
                <li>
                  Always combine exchange ratio analysis with a full
                  <strong>accretion/dilution</strong> and
                  <strong>valuation</strong> model.
                </li>
              </ul>
            </section>

            <!-- FAQ -->
            <section class="mt-10" id="faq">
              <h2 class="text-xl font-semibold mb-4">Exchange Ratio FAQ</h2>
              <div class="space-y-3">
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    What is an exchange ratio in M&amp;A?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    It is the number of acquirer shares that each target share
                    receives in a stock-for-stock merger or acquisition. For
                    example, an exchange ratio of 0.80 means each target share
                    is exchanged for 0.8 shares of the acquirer.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    How do I choose the “right” exchange ratio?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Bankers usually start from valuation work (DCF, trading
                    comps, deal comps) to determine a reasonable
                    <em>offer premium</em> range. They then back into an
                    exchange ratio that delivers that premium at signing, while
                    checking dilution, EPS accretion, and ownership split.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Why do some deals use collars?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Collars reduce the risk that large share price moves between
                    signing and closing make the deal unattractive for one side.
                    They are especially common in volatile markets or when there
                    is a long gap between signing and closing due to regulatory
                    approvals.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Does this calculator handle cash-and-stock deals?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    Not explicitly. You can still use it for the stock component
                    by entering the stock portion of the value as the fixed
                    dollar amount, but a full cash-and-stock structure requires
                    a more detailed M&amp;A model.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Is this tool suitable for legal or tax advice?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    No. This calculator is for educational and analytical
                    purposes only. Always consult qualified legal, tax, and
                    financial advisors before structuring or agreeing to any
                    transaction.
                  </p>
                </details>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Exchange, Ratio.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              More Finance &amp; Valuation Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/npv"
                  class="text-blue-600 hover:underline"
                  >NPV (Net Present Value)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/irr"
                  class="text-blue-600 hover:underline"
                  >IRR (Internal Rate of Return)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/mirr"
                  class="text-blue-600 hover:underline"
                  >MIRR (Modified IRR)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/dcf"
                  class="text-blue-600 hover:underline"
                  >Discounted Cash Flow (FCFF)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/dcf-equity"
                  class="text-blue-600 hover:underline"
                  >Discounted Cash Flow (FCFE)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/business-valuation"
                  class="text-blue-600 hover:underline"
                  >Business Valuation (Multiple Methods)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/comparable-company-analysis"
                  class="text-blue-600 hover:underline"
                  >Comparable Company Analysis</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/precedent-transaction-analysis"
                  class="text-blue-600 hover:underline"
                  >Precedent Transaction Analysis</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/wacc"
                  class="text-blue-600 hover:underline"
                  >Weighted Average Cost of Capital (WACC)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/value-at-risk"
                  class="text-blue-600 hover:underline"
                  >Value at Risk (VaR)</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">
              Explore Finance Categories
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/finance-investment"
                  class="text-blue-600 hover:underline"
                  >Investing &amp; Valuation</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/finance-business-ratios-and-valuation"
                  class="text-blue-600 hover:underline"
                  >Business Ratios &amp; Valuation</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/finance-mortgage-real-estate"
                  class="text-blue-600 hover:underline"
                  >Mortgage &amp; Real Estate</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/finance-loans-and-debt"
                  class="text-blue-600 hover:underline"
                  >Loans &amp; Debt</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/finance-income-and-payroll"
                  class="text-blue-600 hover:underline"
                  >Income, Payroll &amp; Taxes</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/categories/finance"
                  class="text-blue-600 hover:underline"
                  >All Finance Calculators</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Tab handling
      const tabButtons = document.querySelectorAll(".tab-btn");
      const panels = {
        fixed: document.getElementById("panel-fixed"),
        floating: document.getElementById("panel-floating"),
        collar: document.getElementById("panel-collar"),
      };
      let currentMode = "fixed";

      tabButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const mode = btn.getAttribute("data-tab");
          currentMode = mode;
          tabButtons.forEach((b) => {
            b.classList.remove("border-blue-600", "text-blue-600");
            b.classList.add("border-transparent", "text-gray-500");
          });
          btn.classList.add("border-blue-600", "text-blue-600");
          btn.classList.remove("border-transparent", "text-gray-500");

          Object.keys(panels).forEach((key) => {
            panels[key].classList.toggle("hidden", key !== mode);
          });

          document
            .getElementById("collar-note")
            .classList.toggle("hidden", mode !== "collar");
          document.getElementById("error-msg").textContent = "";
        });
      });

      function fmtNumber(val, decimals = 2) {
        if (!isFinite(val)) return "–";
        return Number(val).toLocaleString(undefined, {
          minimumFractionDigits: decimals,
          maximumFractionDigits: decimals,
        });
      }

      function parsePositive(id) {
        const v = parseFloat(document.getElementById(id).value);
        return isFinite(v) && v > 0 ? v : null;
      }

      function calculate() {
        const errEl = document.getElementById("error-msg");
        errEl.textContent = "";

        const acqPriceSigning = parsePositive("acq-price-signing");
        const tgtPriceSigning = parsePositive("tgt-price-signing");
        const acqSharesOut = parsePositive("acq-shares-out");
        const tgtSharesOut = parsePositive("tgt-shares-out");

        if (
          !acqPriceSigning ||
          !tgtPriceSigning ||
          !acqSharesOut ||
          !tgtSharesOut
        ) {
          errEl.textContent =
            "Please enter valid positive values for prices and share counts.";
          return;
        }

        let exchangeRatio = null;
        let offerSigning = null;
        let offerClosing = null;
        let premiumSigning = null;
        let closingPriceForOffer = null;
        let collarStatus = "";

        if (currentMode === "fixed") {
          const offerInput = parsePositive("fixed-offer-price");
          const ratioInputRaw = document
            .getElementById("fixed-exchange-ratio")
            .value.trim();
          const ratioInput =
            ratioInputRaw === "" ? null : parseFloat(ratioInputRaw);
          const acqPriceClosing = parsePositive("acq-price-closing-fixed");

          if (!offerInput && (!ratioInput || ratioInput <= 0)) {
            errEl.textContent =
              "For a fixed exchange ratio, enter either an offer price at signing or a valid exchange ratio.";
            return;
          }

          if (offerInput) {
            exchangeRatio = offerInput / acqPriceSigning;
            offerSigning = offerInput;
          } else {
            exchangeRatio = ratioInput;
            offerSigning = exchangeRatio * acqPriceSigning;
          }

          closingPriceForOffer = acqPriceClosing || acqPriceSigning;
          offerClosing = exchangeRatio * closingPriceForOffer;
          premiumSigning = (offerSigning - tgtPriceSigning) / tgtPriceSigning;
        } else if (currentMode === "floating") {
          const fixedValue = parsePositive("floating-fixed-value");
          const acqPriceClosing = parsePositive("acq-price-closing-floating");

          if (!fixedValue || !acqPriceClosing) {
            errEl.textContent =
              "For a floating exchange ratio, enter a fixed value per target share and a closing price.";
            return;
          }

          exchangeRatio = fixedValue / acqPriceClosing;
          offerSigning = exchangeRatio * acqPriceSigning; // indicative at signing
          offerClosing = fixedValue;
          closingPriceForOffer = acqPriceClosing;
          premiumSigning = (offerSigning - tgtPriceSigning) / tgtPriceSigning;
        } else if (currentMode === "collar") {
          const fixedValue = parsePositive("collar-fixed-value");
          const acqPriceClosing = parsePositive("collar-price-closing");
          const floor = parsePositive("collar-floor");
          const cap = parsePositive("collar-cap");

          if (
            !fixedValue ||
            !acqPriceClosing ||
            !floor ||
            !cap ||
            floor >= cap
          ) {
            errEl.textContent =
              "For a collar, enter a fixed value, closing price, and valid floor & cap (floor < cap).";
            return;
          }

          let effectivePrice = acqPriceClosing;
          if (acqPriceClosing < floor) {
            effectivePrice = floor;
            collarStatus = `Closing price is below the floor. Using floor price $${fmtNumber(
              floor,
              2
            )} for the ratio.`;
          } else if (acqPriceClosing > cap) {
            effectivePrice = cap;
            collarStatus = `Closing price is above the cap. Using cap price $${fmtNumber(
              cap,
              2
            )} for the ratio.`;
          } else {
            collarStatus =
              "Closing price is within the collar band. Deal behaves like a floating exchange ratio.";
          }

          exchangeRatio = fixedValue / effectivePrice;
          offerSigning = exchangeRatio * acqPriceSigning;
          offerClosing = exchangeRatio * acqPriceClosing;
          closingPriceForOffer = acqPriceClosing;
          premiumSigning = (offerSigning - tgtPriceSigning) / tgtPriceSigning;

          document.getElementById("collar-status-text").textContent =
            collarStatus;
        }

        // Ownership calculations
        const newShares = exchangeRatio * tgtSharesOut;
        const proformaShares = acqSharesOut + newShares;
        const targetOwnership = newShares / proformaShares;
        const acquirerOwnership = 1 - targetOwnership;

        // Update results
        document.getElementById("res-exchange-ratio").textContent = fmtNumber(
          exchangeRatio,
          4
        );
        document.getElementById("res-offer-signing").textContent =
          "$" + fmtNumber(offerSigning, 2);
        document.getElementById("res-premium-signing").textContent =
          (premiumSigning * 100).toFixed(1) + "%";
        document.getElementById("res-offer-closing").textContent =
          "$" + fmtNumber(offerClosing, 2);

        document.getElementById("res-new-shares").textContent = fmtNumber(
          newShares,
          0
        );
        document.getElementById("res-proforma-shares").textContent = fmtNumber(
          proformaShares,
          0
        );
        document.getElementById("res-target-ownership").textContent =
          (targetOwnership * 100).toFixed(1) + "%";
        document.getElementById("res-acquirer-ownership").textContent =
          (acquirerOwnership * 100).toFixed(1) + "%";

        // Sensitivity table
        buildSensitivityTable(
          exchangeRatio,
          tgtPriceSigning,
          closingPriceForOffer
        );
      }

      function buildSensitivityTable(
        exchangeRatio,
        tgtPriceSigning,
        basePrice
      ) {
        const tbody = document.getElementById("sensitivity-body");
        tbody.innerHTML = "";

        if (!exchangeRatio || !basePrice) return;

        const deltas = [-0.3, -0.2, -0.1, 0, 0.1, 0.2, 0.3];

        deltas.forEach((d) => {
          const price = basePrice * (1 + d);
          if (price <= 0) return;
          const offer = exchangeRatio * price;
          const premium = (offer - tgtPriceSigning) / tgtPriceSigning;

          const tr = document.createElement("tr");
          tr.className = "border-t border-gray-200";

          const tdPrice = document.createElement("td");
          tdPrice.className = "px-3 py-2 whitespace-nowrap";
          tdPrice.textContent = "$" + fmtNumber(price, 2);

          const tdOffer = document.createElement("td");
          tdOffer.className = "px-3 py-2 whitespace-nowrap";
          tdOffer.textContent = "$" + fmtNumber(offer, 2);

          const tdPremium = document.createElement("td");
          tdPremium.className = "px-3 py-2 whitespace-nowrap";
          tdPremium.textContent = (premium * 100).toFixed(1) + "%";

          tr.appendChild(tdPrice);
          tr.appendChild(tdOffer);
          tr.appendChild(tdPremium);
          tbody.appendChild(tr);
        });
      }

      document
        .getElementById("calculate-btn")
        .addEventListener("click", calculate);

      document.getElementById("reset-btn").addEventListener("click", () => {
        const defaults = {
          "acq-price-signing": 50,
          "tgt-price-signing": 40,
          "acq-shares-out": 200000000,
          "tgt-shares-out": 100000000,
          "fixed-offer-price": 48,
          "fixed-exchange-ratio": "",
          "acq-price-closing-fixed": 45,
          "floating-fixed-value": 48,
          "acq-price-closing-floating": 45,
          "collar-fixed-value": 48,
          "collar-price-closing": 45,
          "collar-floor": 40,
          "collar-cap": 60,
        };
        Object.keys(defaults).forEach((id) => {
          const el = document.getElementById(id);
          if (el) el.value = defaults[id];
        });
        document.getElementById("error-msg").textContent = "";
        document.getElementById("sensitivity-body").innerHTML = "";
        [
          "res-exchange-ratio",
          "res-offer-signing",
          "res-premium-signing",
          "res-offer-closing",
          "res-new-shares",
          "res-proforma-shares",
          "res-target-ownership",
          "res-acquirer-ownership",
        ].forEach((id) => (document.getElementById(id).textContent = "–"));
        document.getElementById("collar-status-text").textContent = "–";
      });

      // Auto-calc ratio when offer or acquirer price at signing changes in fixed mode
      ["fixed-offer-price", "acq-price-signing"].forEach((id) => {
        document.getElementById(id).addEventListener("input", () => {
          if (currentMode !== "fixed") return;
          const offer = parsePositive("fixed-offer-price");
          const acqPriceSigning = parsePositive("acq-price-signing");
          if (offer && acqPriceSigning) {
            const ratio = offer / acqPriceSigning;
            document.getElementById("fixed-exchange-ratio").value =
              ratio.toFixed(4);
          }
        });
      });
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/isotope-abundance" />
    <title>Isotope Abundance Calculator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Isotope Abundance Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Isotope Abundance Calculator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Isotope Abundance Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/isotope-abundance" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Isotope Abundance Calculator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Isotope Abundance Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Isotope Abundance Calculator – From Mass Spectra or Average Atomic Mass",
        "description": "Free isotope abundance calculator. Compute percent abundance of isotopes from mass spectrometry peaks or from average atomic mass, or predict average atomic mass from given isotopic abundances.",
        "url": "https://calcdomain.com/isotope-abundance",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://calcdomain.com"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Science",
              "item": "https://calcdomain.com/categories/science"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Science Tools",
              "item": "https://calcdomain.com/science"
            },
            {
              "@type": "ListItem",
              "position": 4,
              "name": "Isotope Abundance Calculator",
              "item": "https://calcdomain.com/isotope-abundance"
            }
          ]
        },
        "mainEntity": {
          "@type": "SoftwareApplication",
          "name": "Isotope Abundance Calculator",
          "applicationCategory": "EducationalApplication",
          "operatingSystem": "Any",
          "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
        }
      }</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Science Calculators", "item": "https://calcdomain.com/categories/science"}, {"@type": "ListItem", "position": 3, "name": "Chemistry Calculators", "item": "https://calcdomain.com/subcategories/chemistry"}, {"@type": "ListItem", "position": 4, "name": "Isotope Abundance Calculator", "item": "https://calcdomain.com/isotope-abundance"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/science" class="text-blue-600 hover:underline">Science Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/chemistry" class="text-blue-600 hover:underline">Chemistry Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Isotope Abundance Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">
                Isotope Abundance Calculator
              </h1>
              <p class="text-gray-700">
                Calculate percent abundance of isotopes from mass spectrometry
                peak intensities or from the average atomic mass, and predict
                the average atomic mass from known isotopic abundances.
              </p>
            </header>

            <section class="mb-6">
              <div class="flex flex-wrap gap-2 mb-4">
                <button
                  id="mode-intensity"
                  class="mode-btn px-3 py-1 rounded-full text-sm font-medium bg-blue-600 text-white"
                >
                  1) From mass spectrum intensities
                </button>
                <button
                  id="mode-average"
                  class="mode-btn px-3 py-1 rounded-full text-sm font-medium bg-gray-200 text-gray-800"
                >
                  2) From average atomic mass
                </button>
                <button
                  id="mode-forward"
                  class="mode-btn px-3 py-1 rounded-full text-sm font-medium bg-gray-200 text-gray-800"
                >
                  3) From abundances → average mass
                </button>
              </div>

              <!-- Common element name/symbol -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1"
                    for="element-name"
                    >Element (optional)</label
                  >
                  <input
                    id="element-name"
                    type="text"
                    placeholder="e.g., Chlorine"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  />
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1"
                    for="element-symbol"
                    >Symbol (optional)</label
                  >
                  <input
                    id="element-symbol"
                    type="text"
                    placeholder="e.g., Cl"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  />
                </div>
              </div>

              <!-- MODE 1: From intensities -->
              <div id="panel-intensity" class="mode-panel">
                <h2 class="text-lg font-semibold mb-2">
                  1) Percent abundance from mass spectrum intensities
                </h2>
                <p class="text-sm text-gray-700 mb-3">
                  Enter the mass (m/z) and relative intensity for each isotope
                  peak. The calculator normalizes intensities to 100%.
                </p>

                <div class="overflow-x-auto mb-3">
                  <table
                    class="min-w-full text-sm border border-gray-200 rounded-md"
                  >
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-2 py-2 border-b text-left font-semibold">
                          Isotope mass (u)
                        </th>
                        <th class="px-2 py-2 border-b text-left font-semibold">
                          Relative intensity
                        </th>
                        <th class="px-2 py-2 border-b text-left font-semibold">
                          Remove
                        </th>
                      </tr>
                    </thead>
                    <tbody id="intensity-rows"></tbody>
                  </table>
                </div>
                <button
                  id="add-intensity-row"
                  type="button"
                  class="mb-3 inline-flex items-center px-3 py-1.5 border border-blue-600 text-blue-600 text-xs font-medium rounded-md hover:bg-blue-50"
                >
                  + Add isotope
                </button>

                <div class="flex flex-wrap gap-3 items-center mb-3">
                  <button
                    id="calc-intensity"
                    type="button"
                    class="px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700"
                  >
                    Calculate abundances
                  </button>
                  <button
                    id="reset-intensity"
                    type="button"
                    class="px-3 py-2 bg-gray-100 text-gray-700 text-xs font-medium rounded-md hover:bg-gray-200"
                  >
                    Reset
                  </button>
                  <p id="intensity-error" class="text-xs text-red-600"></p>
                </div>

                <div id="intensity-output" class="hidden">
                  <h3 class="text-md font-semibold mb-2">Results</h3>
                  <div class="overflow-x-auto mb-2">
                    <table
                      class="min-w-full text-sm border border-gray-200 rounded-md"
                    >
                      <thead class="bg-gray-50">
                        <tr>
                          <th
                            class="px-2 py-2 border-b text-left font-semibold"
                          >
                            Isotope
                          </th>
                          <th
                            class="px-2 py-2 border-b text-left font-semibold"
                          >
                            Mass (u)
                          </th>
                          <th
                            class="px-2 py-2 border-b text-left font-semibold"
                          >
                            Percent abundance (%)
                          </th>
                        </tr>
                      </thead>
                      <tbody id="intensity-output-body"></tbody>
                      <tfoot>
                        <tr class="bg-gray-50">
                          <td
                            class="px-2 py-2 border-t font-semibold"
                            colspan="2"
                          >
                            Total
                          </td>
                          <td
                            class="px-2 py-2 border-t font-semibold"
                            id="intensity-total"
                          ></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                  <p class="text-xs text-gray-600" id="intensity-summary"></p>
                </div>
              </div>

              <!-- MODE 2: From average atomic mass -->
              <div id="panel-average" class="mode-panel hidden mt-6">
                <h2 class="text-lg font-semibold mb-2">
                  2) Percent abundance from average atomic mass
                </h2>
                <p class="text-sm text-gray-700 mb-3">
                  Use the tabulated average atomic mass to solve for unknown
                  isotope abundances. This mode supports 2 or 3 isotopes.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
                  <div>
                    <label
                      class="block text-sm font-medium text-gray-700 mb-1"
                      for="avg-mass"
                      >Average atomic mass (u)</label
                    >
                    <input
                      id="avg-mass"
                      type="number"
                      step="0.0001"
                      placeholder="e.g., 35.453"
                      class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                    />
                  </div>
                  <div>
                    <label
                      class="block text-sm font-medium text-gray-700 mb-1"
                      for="avg-isotope-count"
                      >Number of isotopes</label
                    >
                    <select
                      id="avg-isotope-count"
                      class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                    >
                      <option value="2">
                        2 isotopes (one unknown abundance)
                      </option>
                      <option value="3">
                        3 isotopes (two unknown abundances)
                      </option>
                    </select>
                  </div>
                </div>

                <!-- 2-isotope case -->
                <div id="avg-2-wrapper" class="mb-3">
                  <h3 class="text-md font-semibold mb-1">Isotopes (2 total)</h3>
                  <p class="text-xs text-gray-600 mb-2">
                    Enter both isotope masses and the percent abundance of one
                    isotope. The other is 100% minus that value.
                  </p>
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-2">
                    <div>
                      <label
                        class="block text-xs font-medium text-gray-700 mb-1"
                        for="avg2-m1"
                        >Isotope 1 mass (u)</label
                      >
                      <input
                        id="avg2-m1"
                        type="number"
                        step="0.0001"
                        placeholder="e.g., 35.0"
                        class="w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                      />
                    </div>
                    <div>
                      <label
                        class="block text-xs font-medium text-gray-700 mb-1"
                        for="avg2-m2"
                        >Isotope 2 mass (u)</label
                      >
                      <input
                        id="avg2-m2"
                        type="number"
                        step="0.0001"
                        placeholder="e.g., 37.0"
                        class="w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                      />
                    </div>
                    <div>
                      <label
                        class="block text-xs font-medium text-gray-700 mb-1"
                        for="avg2-p1"
                        >Isotope 1 abundance (%)</label
                      >
                      <input
                        id="avg2-p1"
                        type="number"
                        step="0.01"
                        placeholder="leave blank to solve"
                        class="w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                      />
                    </div>
                  </div>
                </div>

                <!-- 3-isotope case -->
                <div id="avg-3-wrapper" class="mb-3 hidden">
                  <h3 class="text-md font-semibold mb-1">Isotopes (3 total)</h3>
                  <p class="text-xs text-gray-600 mb-2">
                    Enter all three isotope masses and the percent abundance of
                    one isotope. The other two are solved algebraically.
                  </p>
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-2">
                    <div>
                      <label
                        class="block text-xs font-medium text-gray-700 mb-1"
                        for="avg3-m1"
                        >Isotope 1 mass (u)</label
                      >
                      <input
                        id="avg3-m1"
                        type="number"
                        step="0.0001"
                        placeholder="e.g., 10.0"
                        class="w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                      />
                    </div>
                    <div>
                      <label
                        class="block text-xs font-medium text-gray-700 mb-1"
                        for="avg3-m2"
                        >Isotope 2 mass (u)</label
                      >
                      <input
                        id="avg3-m2"
                        type="number"
                        step="0.0001"
                        placeholder="e.g., 11.0"
                        class="w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                      />
                    </div>
                    <div>
                      <label
                        class="block text-xs font-medium text-gray-700 mb-1"
                        for="avg3-m3"
                        >Isotope 3 mass (u)</label
                      >
                      <input
                        id="avg3-m3"
                        type="number"
                        step="0.0001"
                        placeholder="e.g., 12.0"
                        class="w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                      />
                    </div>
                  </div>
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-2">
                    <div>
                      <label
                        class="block text-xs font-medium text-gray-700 mb-1"
                        for="avg3-p1"
                        >Known isotope abundance (%)</label
                      >
                      <input
                        id="avg3-p1"
                        type="number"
                        step="0.01"
                        placeholder="e.g., 20"
                        class="w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
                      />
                    </div>
                    <div
                      class="md:col-span-2 flex items-center text-xs text-gray-600"
                    >
                      The remaining two abundances must be between 0 and 100%
                      and sum with the known one to 100%.
                    </div>
                  </div>
                </div>

                <div class="flex flex-wrap gap-3 items-center mb-3">
                  <button
                    id="calc-average"
                    type="button"
                    class="px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700"
                  >
                    Solve abundances
                  </button>
                  <button
                    id="reset-average"
                    type="button"
                    class="px-3 py-2 bg-gray-100 text-gray-700 text-xs font-medium rounded-md hover:bg-gray-200"
                  >
                    Reset
                  </button>
                  <p id="average-error" class="text-xs text-red-600"></p>
                </div>

                <div id="average-output" class="hidden">
                  <h3 class="text-md font-semibold mb-2">Results</h3>
                  <div class="overflow-x-auto mb-2">
                    <table
                      class="min-w-full text-sm border border-gray-200 rounded-md"
                    >
                      <thead class="bg-gray-50">
                        <tr>
                          <th
                            class="px-2 py-2 border-b text-left font-semibold"
                          >
                            Isotope
                          </th>
                          <th
                            class="px-2 py-2 border-b text-left font-semibold"
                          >
                            Mass (u)
                          </th>
                          <th
                            class="px-2 py-2 border-b text-left font-semibold"
                          >
                            Percent abundance (%)
                          </th>
                        </tr>
                      </thead>
                      <tbody id="average-output-body"></tbody>
                      <tfoot>
                        <tr class="bg-gray-50">
                          <td
                            class="px-2 py-2 border-t font-semibold"
                            colspan="2"
                          >
                            Total
                          </td>
                          <td
                            class="px-2 py-2 border-t font-semibold"
                            id="average-total"
                          ></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                  <p class="text-xs text-gray-600" id="average-summary"></p>
                </div>
              </div>

              <!-- MODE 3: From abundances to average mass -->
              <div id="panel-forward" class="mode-panel hidden mt-6">
                <h2 class="text-lg font-semibold mb-2">
                  3) Average atomic mass from isotopic abundances
                </h2>
                <p class="text-sm text-gray-700 mb-3">
                  Enter each isotope mass and its percent abundance. The
                  calculator returns the weighted average atomic mass.
                </p>

                <div class="overflow-x-auto mb-3">
                  <table
                    class="min-w-full text-sm border border-gray-200 rounded-md"
                  >
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-2 py-2 border-b text-left font-semibold">
                          Isotope mass (u)
                        </th>
                        <th class="px-2 py-2 border-b text-left font-semibold">
                          Abundance (%)
                        </th>
                        <th class="px-2 py-2 border-b text-left font-semibold">
                          Remove
                        </th>
                      </tr>
                    </thead>
                    <tbody id="forward-rows"></tbody>
                  </table>
                </div>
                <button
                  id="add-forward-row"
                  type="button"
                  class="mb-3 inline-flex items-center px-3 py-1.5 border border-blue-600 text-blue-600 text-xs font-medium rounded-md hover:bg-blue-50"
                >
                  + Add isotope
                </button>

                <div class="flex flex-wrap gap-3 items-center mb-3">
                  <button
                    id="calc-forward"
                    type="button"
                    class="px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700"
                  >
                    Calculate average mass
                  </button>
                  <button
                    id="reset-forward"
                    type="button"
                    class="px-3 py-2 bg-gray-100 text-gray-700 text-xs font-medium rounded-md hover:bg-gray-200"
                  >
                    Reset
                  </button>
                  <p id="forward-error" class="text-xs text-red-600"></p>
                </div>

                <div id="forward-output" class="hidden">
                  <h3 class="text-md font-semibold mb-1">Result</h3>
                  <p class="text-sm text-gray-800 mb-1">
                    Estimated average atomic mass:
                    <span id="forward-avg-mass" class="font-semibold"></span> u
                  </p>
                  <p class="text-xs text-gray-600" id="forward-summary"></p>
                </div>
              </div>
            </section>

            <section class="prose text-sm">
              <h2>How the isotope abundance calculator works</h2>
              <p>
                Atoms of the same element can have different numbers of
                neutrons. These variants are called
                <strong>isotopes</strong>. Each isotope has a slightly different
                mass and a certain <strong>natural abundance</strong> (fraction
                of atoms in a typical sample).
              </p>

              <h3>Weighted average atomic mass</h3>
              <p>
                The atomic weight (average atomic mass) listed on the periodic
                table is a
                <strong>weighted average</strong> of the isotope masses:
              </p>
              <div class="formula-box text-sm">
                \[ \bar{m} = \sum_i m_i \, f_i \] where:
                <ul>
                  <li>\( \bar{m} \) = average atomic mass (u)</li>
                  <li>\( m_i \) = mass of isotope \( i \) (u)</li>
                  <li>
                    \( f_i \) = fractional abundance of isotope \( i \) (between
                    0 and 1)
                  </li>
                </ul>
                Percent abundance is \( \%_i = 100 \times f_i \).
              </div>

              <h3>1) From mass spectrum intensities</h3>
              <p>
                In a simple mass spectrum of a pure element, the
                <strong>peak intensities</strong> at each isotope mass are
                proportional to the number of ions of that isotope. If we call
                the raw intensities \( I_i \), the calculator computes:
              </p>
              <div class="formula-box text-sm">
                \[ f_i = \frac{I_i}{\sum_j I_j}, \quad \%_i = 100 \times f_i \]
              </div>
              <p>
                This assumes all isotopes ionize and are detected with similar
                efficiency, which is a good approximation for many teaching and
                general chemistry problems.
              </p>

              <h3>2) From average atomic mass (2 isotopes)</h3>
              <p>
                For two isotopes with masses \( m_1 \) and \( m_2 \), and
                fractional abundances \( f_1 \) and \( f_2 = 1 - f_1 \), the
                average mass is:
              </p>
              <div class="formula-box text-sm">
                \[ \bar{m} = m_1 f_1 + m_2 (1 - f_1) \] Solving for \( f_1 \):
                \[ f_1 = \frac{\bar{m} - m_2}{m_1 - m_2}, \quad f_2 = 1 - f_1 \]
              </div>

              <h3>3) From average atomic mass (3 isotopes)</h3>
              <p>
                For three isotopes with masses \( m_1, m_2, m_3 \) and
                abundances \( f_1, f_2, f_3 \) such that \( f_1 + f_2 + f_3 = 1
                \), and if one abundance (say \( f_1 \)) is known, the
                calculator solves the system:
              </p>
              <div class="formula-box text-sm">
                \[ \begin{cases} f_1 + f_2 + f_3 = 1 \\ m_1 f_1 + m_2 f_2 + m_3
                f_3 = \bar{m} \end{cases} \] with \( f_1 \) fixed, for \( f_2 \)
                and \( f_3 \).
              </div>

              <h3>3) From abundances to average mass</h3>
              <p>
                When you already know the isotope masses and their percent
                abundances, the calculator simply applies the weighted average
                formula:
              </p>
              <div class="formula-box text-sm">
                \[ \bar{m} = \sum_i m_i \left( \frac{\%_i}{100} \right) \]
              </div>

              <h2>Worked example: chlorine isotopes</h2>
              <p>
                Chlorine has two main stable isotopes: <sup>35</sup>Cl (34.969
                u) and <sup>37</sup>Cl (36.966 u). The tabulated average atomic
                mass is about 35.45 u.
              </p>
              <ol>
                <li>
                  Choose <strong>Mode 2 – From average atomic mass</strong>.
                </li>
                <li>Enter average mass \( \bar{m} = 35.45 \) u.</li>
                <li>Set number of isotopes to <strong>2</strong>.</li>
                <li>Enter \( m_1 = 34.969 \) and \( m_2 = 36.966 \).</li>
                <li>
                  Leave the abundance box blank and click
                  <strong>Solve abundances</strong>.
                </li>
              </ol>
              <p>The calculator will return approximately:</p>
              <ul>
                <li><sup>35</sup>Cl ≈ 75.8%</li>
                <li><sup>37</sup>Cl ≈ 24.2%</li>
              </ul>
              <p>
                which matches standard reference values from NIST and IUPAC
                within rounding.
              </p>

              <h2>Tips and limitations</h2>
              <ul>
                <li>
                  Use isotope masses from a reliable source (e.g., NIST, CIAAW)
                  for best accuracy.
                </li>
                <li>
                  For teaching problems, rounded masses (e.g., 35 and 37) are
                  usually sufficient.
                </li>
                <li>
                  The 3-isotope solver checks that the solution gives abundances
                  between 0 and 100% and that they sum to 100% within a small
                  numerical tolerance.
                </li>
                <li>
                  Real high-precision work may require more detailed corrections
                  (mass bias, detector efficiency, molecular ions), which are
                  beyond the scope of this introductory tool.
                </li>
              </ul>
            </section>

            <section class="mt-8" id="faq">
              <h2 class="text-lg font-semibold mb-3">Isotope abundance FAQ</h2>
              <div class="space-y-3 text-sm">
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    What is isotopic abundance?
                  </summary>
                  <p class="mt-2 text-gray-700">
                    Isotopic abundance is the fraction or percentage of atoms of
                    a given isotope in a naturally occurring sample of an
                    element. For example, about 98.9% of natural carbon atoms
                    are <sup>12</sup>C and 1.1% are <sup>13</sup>C.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Why doesn’t the atomic mass on the periodic table look like
                    a whole number?
                  </summary>
                  <p class="mt-2 text-gray-700">
                    Because it is a <strong>weighted average</strong> of all
                    naturally occurring isotopes, not the mass of a single
                    isotope. Elements with multiple abundant isotopes (like Cl,
                    Cu, or Br) have atomic weights that fall between the masses
                    of those isotopes.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Can I use mass spectrometry peak heights directly as
                    abundances?
                  </summary>
                  <p class="mt-2 text-gray-700">
                    For simple teaching problems and many qualitative analyses,
                    yes: peak heights or areas are proportional to the number of
                    ions, so normalizing them gives approximate percent
                    abundances. High-precision work may require corrections for
                    detector response and mass bias.
                  </p>
                </details>
                <details class="border border-gray-200 rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Why do my calculated abundances come out negative or above
                    100%?
                  </summary>
                  <p class="mt-2 text-gray-700">
                    This usually means the input data are inconsistent: for
                    example, the average atomic mass is not compatible with the
                    isotope masses and the known abundance, or rounding has been
                    overdone. Check your numbers and use more significant
                    figures if possible.
                  </p>
                </details>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Isotope, Abundance.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              More chemistry & physics tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/stoichiometry"
                  class="text-blue-600 hover:underline"
                  >Stoichiometry Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/empirical-formula"
                  class="text-blue-600 hover:underline"
                  >Empirical Formula Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molar-mass"
                  class="text-blue-600 hover:underline"
                  >Molar Mass Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percent-composition"
                  class="text-blue-600 hover:underline"
                  >Percent Composition Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/beer-lambert-law"
                  class="text-blue-600 hover:underline"
                  >Beer–Lambert Law Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/nernst-equation"
                  class="text-blue-600 hover:underline"
                  >Nernst Equation Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molarity"
                  class="text-blue-600 hover:underline"
                  >Molarity Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/ideal-gas-law"
                  class="text-blue-600 hover:underline"
                  >Ideal Gas Law Calculator</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Category</h2>
            <p class="text-sm text-gray-700 mb-2">
              This tool is part of the
              <a
                href="https://calcdomain.com/categories/science"
                class="text-blue-600 hover:underline"
                >Science</a
              >
              collection.
            </p>
            <a
              href="https://calcdomain.com/science"
              class="inline-block mt-1 px-3 py-1.5 bg-blue-600 text-white text-xs font-semibold rounded-md hover:bg-blue-700"
              >Browse all science calculators</a
            >
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Mode switching
      const modeButtons = {
        intensity: document.getElementById("mode-intensity"),
        average: document.getElementById("mode-average"),
        forward: document.getElementById("mode-forward"),
      };
      const panels = {
        intensity: document.getElementById("panel-intensity"),
        average: document.getElementById("panel-average"),
        forward: document.getElementById("panel-forward"),
      };

      function setMode(mode) {
        Object.keys(panels).forEach((key) => {
          if (key === mode) {
            panels[key].classList.remove("hidden");
            modeButtons[key].classList.remove("bg-gray-200", "text-gray-800");
            modeButtons[key].classList.add("bg-blue-600", "text-white");
          } else {
            panels[key].classList.add("hidden");
            modeButtons[key].classList.remove("bg-blue-600", "text-white");
            modeButtons[key].classList.add("bg-gray-200", "text-gray-800");
          }
        });
      }

      modeButtons.intensity.addEventListener("click", () =>
        setMode("intensity")
      );
      modeButtons.average.addEventListener("click", () => setMode("average"));
      modeButtons.forward.addEventListener("click", () => setMode("forward"));

      // Utility
      function parseNumber(value) {
        const v = parseFloat(value);
        return isFinite(v) ? v : null;
      }

      function clearError(id) {
        const el = document.getElementById(id);
        if (el) el.textContent = "";
      }

      function setError(id, msg) {
        const el = document.getElementById(id);
        if (el) el.textContent = msg;
      }

      // MODE 1: From intensities
      const intensityBody = document.getElementById("intensity-rows");
      const addIntensityRowBtn = document.getElementById("add-intensity-row");
      const calcIntensityBtn = document.getElementById("calc-intensity");
      const resetIntensityBtn = document.getElementById("reset-intensity");

      function addIntensityRow(mass = "", intensity = "") {
        const tr = document.createElement("tr");
        tr.innerHTML = `
      <td class="px-2 py-1 border-b">
        <input type="number" step="0.0001" class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none mass-input" placeholder="e.g., 35.0" value="${mass}">
      </td>
      <td class="px-2 py-1 border-b">
        <input type="number" step="0.01" class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none intensity-input" placeholder="e.g., 75" value="${intensity}">
      </td>
      <td class="px-2 py-1 border-b text-center">
        <button type="button" class="text-xs text-red-600 remove-row">✕</button>
      </td>
    `;
        intensityBody.appendChild(tr);
      }

      addIntensityRowBtn.addEventListener("click", () => addIntensityRow());

      intensityBody.addEventListener("click", (e) => {
        if (e.target.classList.contains("remove-row")) {
          const rows = intensityBody.querySelectorAll("tr");
          if (rows.length > 1) {
            e.target.closest("tr").remove();
          }
        }
      });

      function resetIntensity() {
        intensityBody.innerHTML = "";
        addIntensityRow();
        addIntensityRow();
        clearError("intensity-error");
        document.getElementById("intensity-output").classList.add("hidden");
      }

      resetIntensityBtn.addEventListener("click", resetIntensity);

      calcIntensityBtn.addEventListener("click", () => {
        clearError("intensity-error");
        const rows = intensityBody.querySelectorAll("tr");
        const data = [];
        let totalI = 0;

        rows.forEach((row) => {
          const m = parseNumber(row.querySelector(".mass-input").value);
          const I = parseNumber(row.querySelector(".intensity-input").value);
          if (m !== null && I !== null && I > 0) {
            data.push({ mass: m, intensity: I });
            totalI += I;
          }
        });

        if (data.length < 2) {
          setError(
            "intensity-error",
            "Enter at least two isotope peaks with positive intensities."
          );
          return;
        }
        if (totalI <= 0) {
          setError(
            "intensity-error",
            "Total intensity must be greater than zero."
          );
          return;
        }

        const tbody = document.getElementById("intensity-output-body");
        tbody.innerHTML = "";
        let totalPercent = 0;
        data.forEach((d, idx) => {
          const f = d.intensity / totalI;
          const pct = f * 100;
          totalPercent += pct;
          const tr = document.createElement("tr");
          tr.innerHTML = `
        <td class="px-2 py-1 border-b">${idx + 1}</td>
        <td class="px-2 py-1 border-b">${d.mass.toFixed(4)}</td>
        <td class="px-2 py-1 border-b">${pct.toFixed(2)}</td>
      `;
          tbody.appendChild(tr);
        });

        document.getElementById("intensity-total").textContent =
          totalPercent.toFixed(2);
        const name = document.getElementById("element-name").value.trim();
        const symbol = document.getElementById("element-symbol").value.trim();
        let label = "the element";
        if (name && symbol) label = `${name} (${symbol})`;
        else if (name) label = name;
        else if (symbol) label = symbol;

        document.getElementById(
          "intensity-summary"
        ).textContent = `Relative intensities have been normalized so that the total abundance of ${label} isotopes is 100%.`;
        document.getElementById("intensity-output").classList.remove("hidden");
      });

      // Initialize intensity rows
      resetIntensity();

      // MODE 2: From average atomic mass
      const avgCountSelect = document.getElementById("avg-isotope-count");
      const avg2Wrapper = document.getElementById("avg-2-wrapper");
      const avg3Wrapper = document.getElementById("avg-3-wrapper");
      const calcAverageBtn = document.getElementById("calc-average");
      const resetAverageBtn = document.getElementById("reset-average");

      avgCountSelect.addEventListener("change", () => {
        if (avgCountSelect.value === "2") {
          avg2Wrapper.classList.remove("hidden");
          avg3Wrapper.classList.add("hidden");
        } else {
          avg2Wrapper.classList.add("hidden");
          avg3Wrapper.classList.remove("hidden");
        }
        clearError("average-error");
        document.getElementById("average-output").classList.add("hidden");
      });

      function resetAverage() {
        document.getElementById("avg-mass").value = "";
        document.getElementById("avg2-m1").value = "";
        document.getElementById("avg2-m2").value = "";
        document.getElementById("avg2-p1").value = "";
        document.getElementById("avg3-m1").value = "";
        document.getElementById("avg3-m2").value = "";
        document.getElementById("avg3-m3").value = "";
        document.getElementById("avg3-p1").value = "";
        avgCountSelect.value = "2";
        avg2Wrapper.classList.remove("hidden");
        avg3Wrapper.classList.add("hidden");
        clearError("average-error");
        document.getElementById("average-output").classList.add("hidden");
      }

      resetAverageBtn.addEventListener("click", resetAverage);

      calcAverageBtn.addEventListener("click", () => {
        clearError("average-error");
        const avgMass = parseNumber(document.getElementById("avg-mass").value);
        if (avgMass === null) {
          setError("average-error", "Enter a valid average atomic mass.");
          return;
        }

        const mode = avgCountSelect.value;
        const tbody = document.getElementById("average-output-body");
        tbody.innerHTML = "";
        let totalPercent = 0;
        const name = document.getElementById("element-name").value.trim();
        const symbol = document.getElementById("element-symbol").value.trim();
        let label = "the element";
        if (name && symbol) label = `${name} (${symbol})`;
        else if (name) label = name;
        else if (symbol) label = symbol;

        if (mode === "2") {
          const m1 = parseNumber(document.getElementById("avg2-m1").value);
          const m2 = parseNumber(document.getElementById("avg2-m2").value);
          let p1 = document.getElementById("avg2-p1").value.trim();
          if (m1 === null || m2 === null) {
            setError("average-error", "Enter valid masses for both isotopes.");
            return;
          }
          if (Math.abs(m1 - m2) < 1e-9) {
            setError("average-error", "Isotope masses must be different.");
            return;
          }

          let f1;
          if (p1 === "") {
            f1 = (avgMass - m2) / (m1 - m2);
          } else {
            const p1num = parseNumber(p1);
            if (p1num === null) {
              setError(
                "average-error",
                "Enter a valid percent abundance for isotope 1 or leave it blank."
              );
              return;
            }
            f1 = p1num / 100;
          }
          const f2 = 1 - f1;

          if (f1 < -1e-4 || f2 < -1e-4 || f1 > 1.0001 || f2 > 1.0001) {
            setError(
              "average-error",
              "No physically valid solution: check the average mass and isotope masses."
            );
            return;
          }

          const pct1 = Math.max(0, Math.min(1, f1)) * 100;
          const pct2 = Math.max(0, Math.min(1, f2)) * 100;
          totalPercent = pct1 + pct2;

          const rows = [
            { idx: 1, mass: m1, pct: pct1 },
            { idx: 2, mass: m2, pct: pct2 },
          ];
          rows.forEach((r) => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
          <td class="px-2 py-1 border-b">${r.idx}</td>
          <td class="px-2 py-1 border-b">${r.mass.toFixed(4)}</td>
          <td class="px-2 py-1 border-b">${r.pct.toFixed(2)}</td>
        `;
            tbody.appendChild(tr);
          });

          document.getElementById("average-total").textContent =
            totalPercent.toFixed(2);
          document.getElementById(
            "average-summary"
          ).textContent = `Solved isotopic abundances for ${label} assuming two isotopes and an average atomic mass of ${avgMass.toFixed(
            4
          )} u.`;
        } else {
          const m1 = parseNumber(document.getElementById("avg3-m1").value);
          const m2 = parseNumber(document.getElementById("avg3-m2").value);
          const m3 = parseNumber(document.getElementById("avg3-m3").value);
          const p1 = parseNumber(document.getElementById("avg3-p1").value);

          if (m1 === null || m2 === null || m3 === null || p1 === null) {
            setError(
              "average-error",
              "Enter valid masses for all three isotopes and a known abundance."
            );
            return;
          }
          if (p1 < 0 || p1 > 100) {
            setError(
              "average-error",
              "Known isotope abundance must be between 0 and 100%."
            );
            return;
          }

          const f1 = p1 / 100;
          const S = 1 - f1;
          const R = avgMass - m1 * f1;
          const denom = m2 - m3;

          if (Math.abs(denom) < 1e-9) {
            setError(
              "average-error",
              "Isotope 2 and 3 masses must be different."
            );
            return;
          }

          const f2 = (R - m3 * S) / denom;
          const f3 = S - f2;

          if (f2 < -1e-4 || f3 < -1e-4 || f2 > 1.0001 || f3 > 1.0001) {
            setError(
              "average-error",
              "No physically valid solution: check the average mass, isotope masses, and known abundance."
            );
            return;
          }

          const pct1 = Math.max(0, Math.min(1, f1)) * 100;
          const pct2 = Math.max(0, Math.min(1, f2)) * 100;
          const pct3 = Math.max(0, Math.min(1, f3)) * 100;
          totalPercent = pct1 + pct2 + pct3;

          const rows = [
            { idx: 1, mass: m1, pct: pct1 },
            { idx: 2, mass: m2, pct: pct2 },
            { idx: 3, mass: m3, pct: pct3 },
          ];
          rows.forEach((r) => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
          <td class="px-2 py-1 border-b">${r.idx}</td>
          <td class="px-2 py-1 border-b">${r.mass.toFixed(4)}</td>
          <td class="px-2 py-1 border-b">${r.pct.toFixed(2)}</td>
        `;
            tbody.appendChild(tr);
          });

          document.getElementById("average-total").textContent =
            totalPercent.toFixed(2);
          document.getElementById(
            "average-summary"
          ).textContent = `Solved isotopic abundances for ${label} assuming three isotopes and an average atomic mass of ${avgMass.toFixed(
            4
          )} u.`;
        }

        document.getElementById("average-output").classList.remove("hidden");
      });

      // MODE 3: From abundances to average mass
      const forwardBody = document.getElementById("forward-rows");
      const addForwardRowBtn = document.getElementById("add-forward-row");
      const calcForwardBtn = document.getElementById("calc-forward");
      const resetForwardBtn = document.getElementById("reset-forward");

      function addForwardRow(mass = "", pct = "") {
        const tr = document.createElement("tr");
        tr.innerHTML = `
      <td class="px-2 py-1 border-b">
        <input type="number" step="0.0001" class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none fwd-mass-input" placeholder="e.g., 35.0" value="${mass}">
      </td>
      <td class="px-2 py-1 border-b">
        <input type="number" step="0.01" class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none fwd-pct-input" placeholder="e.g., 75.8" value="${pct}">
      </td>
      <td class="px-2 py-1 border-b text-center">
        <button type="button" class="text-xs text-red-600 remove-row">✕</button>
      </td>
    `;
        forwardBody.appendChild(tr);
      }

      addForwardRowBtn.addEventListener("click", () => addForwardRow());

      forwardBody.addEventListener("click", (e) => {
        if (e.target.classList.contains("remove-row")) {
          const rows = forwardBody.querySelectorAll("tr");
          if (rows.length > 1) {
            e.target.closest("tr").remove();
          }
        }
      });

      function resetForward() {
        forwardBody.innerHTML = "";
        addForwardRow();
        addForwardRow();
        clearError("forward-error");
        document.getElementById("forward-output").classList.add("hidden");
      }

      resetForwardBtn.addEventListener("click", resetForward);

      calcForwardBtn.addEventListener("click", () => {
        clearError("forward-error");
        const rows = forwardBody.querySelectorAll("tr");
        const data = [];
        let totalPct = 0;

        rows.forEach((row) => {
          const m = parseNumber(row.querySelector(".fwd-mass-input").value);
          const p = parseNumber(row.querySelector(".fwd-pct-input").value);
          if (m !== null && p !== null && p > 0) {
            data.push({ mass: m, pct: p });
            totalPct += p;
          }
        });

        if (data.length < 1) {
          setError(
            "forward-error",
            "Enter at least one isotope with mass and positive percent abundance."
          );
          return;
        }

        if (totalPct <= 0) {
          setError(
            "forward-error",
            "Total percent abundance must be greater than zero."
          );
          return;
        }

        let avgMass = 0;
        data.forEach((d) => {
          const f = d.pct / totalPct; // normalize if not exactly 100
          avgMass += d.mass * f;
        });

        const name = document.getElementById("element-name").value.trim();
        const symbol = document.getElementById("element-symbol").value.trim();
        let label = "the element";
        if (name && symbol) label = `${name} (${symbol})`;
        else if (name) label = name;
        else if (symbol) label = symbol;

        document.getElementById("forward-avg-mass").textContent =
          avgMass.toFixed(4);
        document.getElementById("forward-summary").textContent =
          `Computed the weighted average atomic mass of ${label} from the entered isotope masses and abundances. ` +
          `Input abundances sum to ${totalPct.toFixed(
            2
          )}%; they were normalized to 100% for the calculation.`;
        document.getElementById("forward-output").classList.remove("hidden");
      });

      // Initialize forward rows
      resetForward();
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

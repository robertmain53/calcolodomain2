<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/density">





 
<link rel="icon" type="image/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/favicon.svg">
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png">
<link rel="manifest" href="https://calcdomain.com/site.webmanifest">
<meta charset="utf-8">
<title>Density Calculator | Science » Physics</title>
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="Professional density calculator. Compute density, mass, or volume with unit conversions, geometry-assisted volume, and freight density class. Accessible, fast, and accurate." name="description">
<meta content="Ugo Candido" name="author">

<meta content="#005A9C" name="theme-color">
<meta content="index,follow" name="robots">
<style>
    /* Critical CSS (mobile-first, above-the-fold) */
    :root{
      --primary-color:#005A9C; --secondary-color:#003F6E; --accent-color:#00A4E4;
      --background-color:#F8F9FA; --surface-color:#FFFFFF;
      --text-color:#212529; --muted-text-color:#6C757D; --border-color:#DEE2E6;
      --success-color:#198754; --error-color:#DC3545;
      --touch-target-min:48px; --container-max-width:1160px;
    }
    *,*::before,*::after{box-sizing:border-box}
    html{font-size:16px}
    body{margin:0;background:var(--background-color);color:var(--text-color);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji;line-height:1.6}
    a{color:var(--primary-color);text-decoration:none}
    a:hover{text-decoration:underline}
    .skip-link{position:absolute;top:-40px;left:8px;background:var(--primary-color);color:#fff;padding:8px 12px;border-radius:4px;z-index:1000}
    .skip-link:focus{top:8px}
    header{background:var(--surface-color);border-bottom:1px solid var(--border-color)}
    .container{max-width:var(--container-max-width);margin:0 auto;padding:0 1rem}
    .header-bar{display:flex;gap:1rem;align-items:center;justify-content:space-between;padding:.75rem 0}
    .brand{font-weight:700;color:var(--primary-color);font-size:1.125rem}
    .breadcrumb{font-size:.9rem;color:var(--muted-text-color);margin:.5rem 0 0}
    .breadcrumb a{color:inherit}
    main{padding:1.25rem 0}
    h1{font-size:1.75rem;line-height:1.25;color:var(--secondary-color);margin:0 0 .5rem}
    p{margin:.75rem 0 1rem;max-width:70ch}
    .layout{display:grid;grid-template-columns:1fr;gap:1.5rem;margin-top:.5rem}
    @media(min-width:992px){.layout{grid-template-columns:420px 1fr}}
    .card{background:#fff;border:1px solid var(--border-color);border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.05);padding:1rem}
    .calculator-container h2{margin-top:0;color:var(--secondary-color);font-size:1.35rem}
    .form-group{margin-bottom:1rem}
    .form-group label{display:block;font-weight:600;margin-bottom:.35rem}
    .required::after{content:" *";color:var(--error-color);font-weight:700}
    .help-inline{color:var(--muted-text-color);font-size:.9rem}
    .input-row{display:flex;gap:.5rem;align-items:center}
    .form-control, select{width:100%;min-height:48px;padding:.65rem .75rem;border:1px solid var(--border-color);border-radius:8px;font-size:1rem}
    .form-control:focus, select:focus{outline:3px solid var(--primary-color);outline-offset:2px}
    .form-control[aria-invalid="true"]{border-color:var(--error-color)}
    fieldset{border:1px solid var(--border-color);border-radius:8px;padding:.5rem .5rem .75rem}
    legend{font-weight:700;color:var(--secondary-color);padding:0 .25rem}
    .radio-group{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.25rem}
    .radio-pill{position:relative}
    .radio-pill input{position:absolute;opacity:0;inset:0}
    .radio-pill label{display:inline-flex;align-items:center;justify-content:center;padding:.5rem .75rem;min-height:var(--touch-target-min);border:1px solid var(--border-color);border-radius:999px;cursor:pointer}
    .radio-pill input:checked+label{background:var(--primary-color);border-color:var(--primary-color);color:#fff}
    .radio-pill input:focus-visible+label{outline:3px solid var(--primary-color);outline-offset:2px}
    .tooltip-btn{margin-left:.35rem;inline-size:32px;block-size:32px;min-width:32px;min-height:32px;border-radius:50%;border:1px solid var(--border-color);background:#fff;color:var(--secondary-color);font-weight:700;cursor:pointer}
    .tooltip-content{display:none;margin-top:.35rem;background:#F1F3F5;border:1px solid var(--border-color);border-radius:8px;padding:.5rem}
    .tooltip-content[data-open="true"]{display:block}
    .actions{display:flex;gap:.5rem;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.7rem 1rem;min-height:var(--touch-target-min);min-width:var(--touch-target-min);border-radius:8px;border:1px solid transparent;cursor:pointer;font-weight:600}
    .btn-primary{background:var(--primary-color);color:#fff;border-color:var(--primary-color)}
    .btn-secondary{background:#fff;color:var(--primary-color);border-color:var(--primary-color)}
    .error-message{color:var(--error-color);font-size:.9rem;margin-top:.25rem;min-height:1.25rem}
    .results-container{min-height:240px;border:1px solid var(--border-color);border-radius:10px;background:#F8FAFC;padding:1rem}
    .results-container h3{margin:0 0 .5rem;color:var(--secondary-color)}
    .result-row{display:flex;justify-content:space-between;gap:.75rem;padding:.5rem 0;border-bottom:1px solid var(--border-color)}
    .result-row:last-child{border-bottom:none}
    .result-label{color:var(--muted-text-color)}
    .result-value{font-weight:700;color:var(--success-color)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    footer{background:var(--secondary-color);color:#fff;margin-top:2rem}
    footer .container{padding:1.25rem 1rem}
    .small{font-size:.92rem;color:#e6e6e6}
  </style>
<style media="print" onload="this.media='all'">
    /* Non-critical, enhanced styles (loaded non-blocking) */
    .calculator-layout{display:grid;grid-template-columns:1fr;gap:2rem;margin-top:1rem}
    @media(min-width:992px){.calculator-layout{grid-template-columns:440px 1fr}}
    .content-container h2{margin-top:1.5rem;border-bottom:1px solid var(--border-color);padding-bottom:.4rem}
    .formula-box{background:#e9ecef;padding:1rem;border-radius:8px;margin:.75rem 0;overflow:auto}
    code{background:#e9ecef;padding:.15rem .35rem;border-radius:4px}
    .note{font-size:.9rem;color:var(--muted-text-color)}
    .subtle{color:var(--muted-text-color)}
    details.summary-card{border:1px solid var(--border-color);border-radius:10px;background:#fff;padding:.5rem .75rem}
    details.summary-card>summary{cursor:pointer;font-weight:700;outline-offset:2px}
    details[open].summary-card{box-shadow:0 2px 6px rgba(0,0,0,.06)}
    .grid{display:grid;gap:.75rem}
    .grid-2{grid-template-columns:1fr;gap:.75rem}
    @media(min-width:640px){.grid-2{grid-template-columns:1fr 1fr}}
  </style>
<noscript>
<style>.tooltip-content{display:block}.error-message{min-height:auto}</style>
</noscript>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Density Calculator",
  "description": "Compute density, mass, or volume with unit conversions, geometry-assisted volume, and freight density class. Accessible, fast, and accurate.",
  "url": "https://calcdomain.com/density",
  "author": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CalcDomain"
  },
  "mainEntity": [
    {
      "@type": "HowTo",
      "name": "How It Works: A Step-by-Step Example",
      "description": "Solve density from mass and volume and review unit conversions.",
      "step": [
        {
          "@type": "HowToStep",
          "name": "Provide mass",
          "text": "Enter mass m = 0.5 kg."
        },
        {
          "@type": "HowToStep",
          "name": "Provide volume",
          "text": "Enter volume V = 0.5 L (the tool converts it to 0.0005 m³ internally)."
        },
        {
          "@type": "HowToStep",
          "name": "Apply the formula",
          "text": "Compute density ρ = m / V = 0.5 / 0.0005 = 1000 kg/m³."
        },
        {
          "@type": "HowToStep",
          "name": "Review conversions",
          "text": "Automatically view equivalent values in g/cm³, lb/ft³, lb/gal, etc."
        }
      ]
    },
    {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is the formula for density?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Density is mass divided by volume: ρ = m / V. Rearranged: m = ρ·V and V = m / ρ."
          }
        },
        {
          "@type": "Question",
          "name": "Which units does this calculator support?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Mass: kg, g, lb, oz. Volume: m³, L, mL, cm³, ft³, in³, US gal. Density: kg/m³, g/cm³, g/mL, lb/ft³, lb/in³, lb/gal."
          }
        },
        {
          "@type": "Question",
          "name": "Does temperature affect density?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Density of most materials varies with temperature (and pressure for gases). This calculator performs pure unit-consistent math; provide density values appropriate to your conditions."
          }
        },
        {
          "@type": "Question",
          "name": "Can I compute volume from dimensions?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. Choose Box or Cylinder and enter dimensions; the tool computes volume and uses it in the calculation."
          }
        },
        {
          "@type": "Question",
          "name": "How is freight class estimated?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Freight class is approximated from density thresholds commonly used in LTL shipping. Always verify with your carrier or NMFTA."
          }
        },
        {
          "@type": "Question",
          "name": "Is this calculator accessible?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. It is keyboard navigable, screen-reader friendly, and meets WCAG 2.1 AA color contrast and focus requirements."
          }
        }
      ]
    }
  ]
}
</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="search.js" defer=""></script>
<!-- MathJax for LaTeX formulas -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\(','\)'], ['$', '$']],
      displayMath: [['$','$'], ['\[','\]']]
    },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="preload" href="https://calcdomain.com/assets/js/mobile-menu.js" as="script">
<link rel="preload" href="https://calcdomain.com/assets/js/page-enhancements.js" as="script">


<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "General",
      "item": "https://calcdomain.com/categories/general"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Miscellaneous",
      "item": "https://calcdomain.com/subcategories/miscellaneous"
    }
  ]
}
</script>
</head>
<body>

<a class="skip-link" href="#main">Skip to main content</a>
<header>
<div class="container">
<div class="header-bar" role="banner">
CalcDomain
</div>
<nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo; <a href="https://calcdomain.com/categories/general" class="hover:text-blue-600">General</a> &raquo; <a href="https://calcdomain.com/subcategories/miscellaneous" class="hover:text-blue-600">Miscellaneous</a></nav>
</div>
</header>
<main class="container" id="main" role="main">
<h1>Density Calculator</h1>
<p>
      A professional-grade density calculator for scientists, engineers, students, and logistics teams. Compute density, mass, or volume with consistent units, convert results instantly, and even estimate LTL freight class from package dimensions.
    </p>
<div class="layout">
<section aria-labelledby="calc-heading" class="card calculator-container" id="density-calculator">
<h2 id="calc-heading">Interactive Calculator</h2>
<div class="form-group">
<fieldset>
<legend>What do you want to solve for?</legend>
<div aria-label="Solve for" class="radio-group" role="radiogroup">
<div class="radio-pill">
<input checked="" id="solveDensity" name="solveFor" type="radio" value="density">
<label for="solveDensity">Density (ρ)</label>
</div>
<div class="radio-pill">
<input id="solveMass" name="solveFor" type="radio" value="mass">
<label for="solveMass">Mass (m)</label>
</div>
<div class="radio-pill">
<input id="solveVolume" name="solveFor" type="radio" value="volume">
<label for="solveVolume">Volume (V)</label>
</div>
</div>
</fieldset>
</div>
<div class="form-group">
<label for="unitSystem">Preferred unit system</label>
<select aria-describedby="unitSystemHelp" id="unitSystem">
<option selected="" value="metric">Metric (SI)</option>
<option value="imperial">Imperial (US customary)</option>
</select>
<div class="help-inline" id="unitSystemHelp">You can still choose any unit below.</div>
</div>
<div class="form-group" id="massGroup">
<div class="input-row">
<div style="flex:1">
<label class="required" for="massInput">Mass</label>
<input aria-describedby="massError massTip" aria-required="true" class="form-control" id="massInput" inputmode="decimal" placeholder="e.g., 0.5" step="any" type="number">
<div aria-live="polite" class="error-message" id="massError" role="alert"></div>
</div>
<div style="width:10.5rem">
<label class="required" for="massUnit">Unit</label>
<select aria-required="true" id="massUnit">
<option value="kg">kg</option>
<option value="g">g</option>
<option value="lb">lb</option>
<option value="oz">oz</option>
</select>
</div>
</div>
<div class="input-row" style="margin-top:.35rem">
<button aria-controls="massTip" aria-expanded="false" aria-label="About Mass" class="tooltip-btn" id="massTipBtn" type="button">?</button>
<div class="tooltip-content" id="massTip" role="note">Mass is the quantity of matter. Use the object’s weight converted to mass if necessary. For everyday use on Earth, weight in pounds approximates mass in lb.</div>
</div>
</div>
<div class="form-group" id="volumeGroup">
<fieldset>
<legend class="required">Volume input method</legend>
<div class="radio-group">
<div class="radio-pill">
<input checked="" id="volDirect" name="volumeMode" type="radio" value="direct">
<label for="volDirect">Enter volume</label>
</div>
<div class="radio-pill">
<input id="volBox" name="volumeMode" type="radio" value="box">
<label for="volBox">Box (L×W×H)</label>
</div>
<div class="radio-pill">
<input id="volCylinder" name="volumeMode" type="radio" value="cylinder">
<label for="volCylinder">Cylinder (d×h)</label>
</div>
</div>
</fieldset>
<div class="form-subgroup" id="volumeDirectFields" style="margin-top:.5rem">
<div class="input-row">
<div style="flex:1">
<label class="required" for="volumeInput">Volume</label>
<input aria-describedby="volumeError volumeTip" aria-required="true" class="form-control" id="volumeInput" inputmode="decimal" placeholder="e.g., 0.5" step="any" type="number">
<div aria-live="polite" class="error-message" id="volumeError" role="alert"></div>
</div>
<div style="width:10.5rem">
<label class="required" for="volumeUnit">Unit</label>
<select aria-required="true" id="volumeUnit">
<option value="m3">m³</option>
<option value="L">L</option>
<option value="mL">mL</option>
<option value="cm3">cm³</option>
<option value="ft3">ft³</option>
<option value="in3">in³</option>
<option value="gal">US gal</option>
</select>
</div>
</div>
<div class="input-row" style="margin-top:.35rem">
<button aria-controls="volumeTip" aria-expanded="false" aria-label="About Volume" class="tooltip-btn" id="volumeTipBtn" type="button">?</button>
<div class="tooltip-content" id="volumeTip" role="note">Volume is the space an object occupies. If you have dimensions, switch to Box or Cylinder to compute it automatically.</div>
</div>
</div>
<div class="form-subgroup" id="volumeBoxFields" style="display:none;margin-top:.5rem">
<div class="input-row">
<div style="flex:1">
<label class="required" for="lenInput">Length</label>
<input aria-describedby="boxError" aria-required="true" class="form-control" id="lenInput" step="any" type="number">
</div>
<div style="flex:1">
<label class="required" for="widInput">Width</label>
<input aria-describedby="boxError" aria-required="true" class="form-control" id="widInput" step="any" type="number">
</div>
</div>
<div class="input-row" style="margin-top:.5rem">
<div style="flex:1">
<label class="required" for="heiInput">Height</label>
<input aria-describedby="boxError" aria-required="true" class="form-control" id="heiInput" step="any" type="number">
</div>
<div style="width:10.5rem">
<label class="required" for="boxUnit">Dim. Unit</label>
<select id="boxUnit">
<option value="m">m</option>
<option value="cm">cm</option>
<option value="mm">mm</option>
<option value="ft">ft</option>
<option value="in">in</option>
</select>
</div>
</div>
<div aria-live="polite" class="error-message" id="boxError" role="alert"></div>
<div aria-live="polite" class="note" id="boxVolumePreview">Computed volume: —</div>
</div>
<div class="form-subgroup" id="volumeCylinderFields" style="display:none;margin-top:.5rem">
<div class="input-row">
<div style="flex:1">
<label class="required" for="diameterInput">Diameter</label>
<input aria-describedby="cylError" aria-required="true" class="form-control" id="diameterInput" step="any" type="number">
</div>
<div style="flex:1">
<label class="required" for="heightInput">Height</label>
<input aria-describedby="cylError" aria-required="true" class="form-control" id="heightInput" step="any" type="number">
</div>
<div style="width:10.5rem">
<label class="required" for="cylUnit">Dim. Unit</label>
<select id="cylUnit">
<option value="m">m</option>
<option value="cm">cm</option>
<option value="mm">mm</option>
<option value="ft">ft</option>
<option value="in">in</option>
</select>
</div>
</div>
<div aria-live="polite" class="error-message" id="cylError" role="alert"></div>
<div aria-live="polite" class="note" id="cylVolumePreview">Computed volume: —</div>
</div>
</div>
<div class="form-group" id="densityGroup">
<div class="input-row">
<div style="flex:1">
<label class="required" for="densityInput">Density</label>
<input aria-describedby="densityError densityTip" aria-required="true" class="form-control" id="densityInput" inputmode="decimal" placeholder="e.g., 1000" step="any" type="number">
<div aria-live="polite" class="error-message" id="densityError" role="alert"></div>
</div>
<div style="width:10.5rem">
<label class="required" for="densityUnit">Unit</label>
<select aria-required="true" id="densityUnit">
<option value="kgm3">kg/m³</option>
<option value="gcm3">g/cm³</option>
<option value="gml">g/mL</option>
<option value="lbft3">lb/ft³</option>
<option value="lbin3">lb/in³</option>
<option value="lbgal">lb/gal (US)</option>
</select>
</div>
</div>
<div class="input-row" style="margin-top:.35rem">
<button aria-controls="densityTip" aria-expanded="false" aria-label="About Density" class="tooltip-btn" id="densityTipBtn" type="button">?</button>
<div class="tooltip-content" id="densityTip" role="note">Density varies with temperature and pressure. Use values appropriate to your conditions (e.g., water ≈ 1000 kg/m³ at 4°C).</div>
</div>
<div class="form-group" style="margin-top:.5rem">
<label for="materialSelect">Optional: autofill density from common materials</label>
<select aria-describedby="materialHelp" id="materialSelect">
<option value="">— None —</option>
<option value="water">Water (20°C) ≈ 998.2 kg/m³</option>
<option value="air">Air (1 atm, 15°C) ≈ 1.225 kg/m³</option>
<option value="aluminum">Aluminum ≈ 2700 kg/m³</option>
<option value="steel">Carbon steel ≈ 7850 kg/m³</option>
<option value="oak">Oak (wood) ≈ 700 kg/m³</option>
</select>
<div class="help-inline" id="materialHelp">Select a material to prefill density. You can edit the value afterwards.</div>
</div>
</div>
<details class="summary-card" id="freightPanel">
<summary>Freight density helper (LTL) — optional</summary>
<div class="grid grid-2" style="margin-top:.5rem">
<div>
<label class="required" for="pkgWeight">Weight (lb)</label>
<input aria-describedby="freightError" class="form-control" id="pkgWeight" step="any" type="number">
</div>
<div>
<label class="required" for="pkgLen">Length (in)</label>
<input aria-describedby="freightError" class="form-control" id="pkgLen" step="any" type="number">
</div>
<div>
<label class="required" for="pkgWid">Width (in)</label>
<input aria-describedby="freightError" class="form-control" id="pkgWid" step="any" type="number">
</div>
<div>
<label class="required" for="pkgHei">Height (in)</label>
<input aria-describedby="freightError" class="form-control" id="pkgHei" step="any" type="number">
</div>
</div>
<div aria-live="polite" class="error-message" id="freightError" role="alert"></div>
<div aria-live="polite" class="note" id="freightPreview">Freight density: —</div>
</details>
<div class="actions" style="margin-top:.75rem">
<button class="btn btn-primary" id="calcBtn" type="button">Calculate</button>
<button class="btn btn-secondary" id="clearBtn" type="button">Clear</button>
</div>
</section>
<section aria-labelledby="resultsHeading" aria-live="polite" class="card results-container" id="results">
<h3 id="resultsHeading">Results</h3>
<div class="result-row" id="primaryResult">
<span class="result-label" id="primaryLabel">Density</span>
<span class="result-value" id="primaryValue">—</span>
</div>
<div class="result-row">
<span class="result-label">SI density (kg/m³)</span>
<span class="result-value" id="siDensity">—</span>
</div>
<div class="result-row">
<span class="result-label">g/cm³ (g/mL)</span>
<span class="result-value" id="gcms">—</span>
</div>
<div class="result-row">
<span class="result-label">lb/ft³</span>
<span class="result-value" id="lbft3">—</span>
</div>
<div class="result-row">
<span class="result-label">lb/in³</span>
<span class="result-value" id="lbin3">—</span>
</div>
<div class="result-row">
<span class="result-label">lb/gal (US)</span>
<span class="result-value" id="lbgal">—</span>
</div>
<div class="result-row" id="freightResult" style="display:none">
<span class="result-label">Freight class (estimate)</span>
<span class="result-value" id="freightClass">—</span>
</div>
</section>
</div>
<section class="card content-container" style="margin-top:1rem">
<h2>Data Source and Methodology</h2>
<p>
        Authoritative data on units and symbols are taken from:
        <br>
        International Bureau of Weights and Measures (BIPM), The International System of Units (SI), 9th edition, 2019. 
        <a href="https://www.bipm.org/documents/20126/41483022/SI-Brochure-9.pdf" rel="noopener" target="_blank">Direct link (PDF)</a>.
        <br>
        Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.
      </p>
<p>
        Methodology: all inputs are converted to SI base units (kg and m³) internally. Calculations use the canonical physics relationship ρ = m / V, with inverse forms for solving mass or volume. Results are then converted to the requested output units without loss of precision beyond floating-point rounding.
      </p>
<h2>The Formula Explained</h2>
<div aria-label="Formulas in LaTeX" class="formula-box">
<div>Density: $$\\rho = \\frac{m}{V}$$</div>
<div>Mass from density and volume: $$m = \\rho\\,V$$</div>
<div>Volume from mass and density: $$V = \\frac{m}{\\rho}$$</div>
<div>Box volume: $$V_{box} = L\\,W\\,H$$</div>
<div>Cylinder volume: $$V_{cyl} = \\pi\\,\\left(\\tfrac{d}{2}\\right)^2 h$$</div>
<div>Freight density (US customary): $$\\rho_{freight}\\,[\\tfrac{lb}{ft^3}] = \\frac{W_{lb}}{\\tfrac{L_{in}\\,W_{in}\\,H_{in}}{1728}}$$</div>
</div>
<h2>Glossary of Variables</h2>
<ul>
<li>ρ (Density): amount of mass per unit volume. Units: kg/m³, g/cm³, g/mL, lb/ft³, lb/in³, lb/gal.</li>
<li>m (Mass): quantity of matter. Units: kg, g, lb, oz.</li>
<li>V (Volume): 3D space occupied. Units: m³, L, mL, cm³, ft³, in³, US gal.</li>
<li>L, W, H: length, width, height for box shapes (m, cm, mm, ft, in).</li>
<li>d, h: diameter and height for cylinders (m, cm, mm, ft, in).</li>
<li>Freight class: estimated NMFC class derived from density ranges; confirm with your carrier.</li>
</ul>
<h2>How It Works: A Step-by-Step Example</h2>
<p>
        Suppose you have 0.5 kg of liquid occupying 0.5 L. Convert 0.5 L to m³: 0.5 L = 0.0005 m³. Apply the formula:
      </p>
<div class="formula-box">$$\\rho = \\frac{m}{V} = \\frac{0.5\\;kg}{0.0005\\;m^3} = 1000\\;kg/m^3$$</div>
<p>
        Conversions: 1000 kg/m³ = 1 g/cm³ = 1 g/mL ≈ 62.42796 lb/ft³ ≈ 8.3454 lb/gal. The calculator performs these conversions automatically.
      </p>
<h2>Frequently Asked Questions (FAQ)</h2>
<div>
<h3>Is density the same as specific gravity?</h3>
<p>No. Specific gravity is the ratio of a substance’s density to a reference (often water at 4°C). It is dimensionless, while density has units.</p>
<h3>Can I compute mass if I only know dimensions and density?</h3>
<p>Yes. Use Box or Cylinder to compute volume, then choose “Mass (m)” as the solve-for option. The tool will do m = ρ·V for you.</p>
<h3>Which water density should I use?</h3>
<p>At 4°C, water is about 1000 kg/m³ (1 g/cm³). At 20°C it’s ≈ 998.2 kg/m³. Select a value appropriate to your temperature.</p>
<h3>Why do I get very small numbers in lb/in³?</h3>
<p>Because a cubic inch is a very small volume. Use lb/ft³ or lb/gal for more familiar scales in US customary units.</p>
<h3>What precision does the calculator use?</h3>
<p>Internally it uses double-precision floating point. Results are displayed with sensible rounding; you can copy the SI value for maximum precision.</p>
<h3>Is the freight class accurate?</h3>
<p>It’s an estimate using common density thresholds. Actual NMFC class also depends on handling, liability, and stowability—confirm with your carrier.</p>
</div>
<div class="small" style="margin-top:1rem;border-top:1px solid var(--border-color);padding-top:.75rem">
        Strumento sviluppato da <strong>Ugo Candido</strong>,. Contenuti verificati da,.
        <br>
        Ultima revisione per l'accuratezza in data: September 15, 2025.
      </div>
</section>

<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[','\]</div>
  <pre class="auditspine-mono">','</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\\rho = \\frac{m}{V}\]</div>
  <pre class="auditspine-mono">\\rho = \\frac{m}{V}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[m = \\rho\\,V\]</div>
  <pre class="auditspine-mono">m = \\rho\\,V</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[V = \\frac{m}{\\rho}\]</div>
  <pre class="auditspine-mono">V = \\frac{m}{\\rho}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[V_{box} = L\\,W\\,H\]</div>
  <pre class="auditspine-mono">V_{box} = L\\,W\\,H</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[V_{cyl} = \\pi\\,\\left(\\tfrac{d}{2}\\right)^2 h\]</div>
  <pre class="auditspine-mono">V_{cyl} = \\pi\\,\\left(\\tfrac{d}{2}\\right)^2 h</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Density: $\\rho = \\frac{m}{V}$ Mass from density and volume: $m = \\rho\\,V$ Volume from mass and density: $V = \\frac{m}{\\rho}$ Box volume: $V_{box} = L\\,W\\,H$ Cylinder volume: $V_{cyl} = \\pi\\,\\left(\\tfrac{d}{2}\\right)^2 h$ Freight density (US customary): $\\rho_{freight}\\,[\\tfrac{lb}{ft^3}] = \\frac{W_{lb}}{\\tfrac{L_{in}\\,W_{in}\\,H_{in}}{1728}}$</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$\\rho = \\frac{m}{V} = \\frac{0.5\\;kg}{0.0005\\;m^3} = 1000\\;kg/m^3$</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Direct link (PDF)</strong> — bipm.org · Accessed 2026-01-19<br><a href="https://www.bipm.org/documents/20126/41483022/SI-Brochure-9.pdf" target="_blank" rel="nofollow noopener">https://www.bipm.org/documents/20126/41483022/SI-Brochure-9.pdf</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main>
<!-- Standard Footer --> 
<script defer="">
    (function(){
      'use strict';

      // Elements
      const solveRadios = document.querySelectorAll('input[name="solveFor"]');
      const unitSystem = document.getElementById('unitSystem');

      const massGroup = document.getElementById('massGroup');
      const massInput = document.getElementById('massInput');
      const massUnit = document.getElementById('massUnit');
      const massError = document.getElementById('massError');

      const volumeGroup = document.getElementById('volumeGroup');
      const volumeInput = document.getElementById('volumeInput');
      const volumeUnit = document.getElementById('volumeUnit');
      const volumeError = document.getElementById('volumeError');

      const volModeDirect = document.getElementById('volDirect');
      const volModeBox = document.getElementById('volBox');
      const volModeCylinder = document.getElementById('volCylinder');

      const volumeDirectFields = document.getElementById('volumeDirectFields');
      const volumeBoxFields = document.getElementById('volumeBoxFields');
      const volumeCylinderFields = document.getElementById('volumeCylinderFields');

      const lenInput = document.getElementById('lenInput');
      const widInput = document.getElementById('widInput');
      const heiInput = document.getElementById('heiInput');
      const boxUnit = document.getElementById('boxUnit');
      const boxError = document.getElementById('boxError');
      const boxVolumePreview = document.getElementById('boxVolumePreview');

      const diameterInput = document.getElementById('diameterInput');
      const heightInput = document.getElementById('heightInput');
      const cylUnit = document.getElementById('cylUnit');
      const cylError = document.getElementById('cylError');
      const cylVolumePreview = document.getElementById('cylVolumePreview');

      const densityGroup = document.getElementById('densityGroup');
      const densityInput = document.getElementById('densityInput');
      const densityUnit = document.getElementById('densityUnit');
      const densityError = document.getElementById('densityError');

      const materialSelect = document.getElementById('materialSelect');

      // Tooltips
      const tipBtns = [
        {btn: document.getElementById('massTipBtn'), panel: document.getElementById('massTip')},
        {btn: document.getElementById('volumeTipBtn'), panel: document.getElementById('volumeTip')},
        {btn: document.getElementById('densityTipBtn'), panel: document.getElementById('densityTip')}
      ];
      tipBtns.forEach(({btn, panel})=>{
        btn?.addEventListener('click', ()=>{
          const open = panel.dataset.open === 'true';
          panel.dataset.open = String(!open);
          btn.setAttribute('aria-expanded', String(!open));
        });
      });

      // Freight helper
      const freightPanel = document.getElementById('freightPanel');
      const pkgWeight = document.getElementById('pkgWeight');
      const pkgLen = document.getElementById('pkgLen');
      const pkgWid = document.getElementById('pkgWid');
      const pkgHei = document.getElementById('pkgHei');
      const freightError = document.getElementById('freightError');
      const freightPreview = document.getElementById('freightPreview');
      const freightResultRow = document.getElementById('freightResult');
      const freightClassSpan = document.getElementById('freightClass');

      // Actions
      const calcBtn = document.getElementById('calcBtn');
      const clearBtn = document.getElementById('clearBtn');

      // Results
      const primaryLabel = document.getElementById('primaryLabel');
      const primaryValue = document.getElementById('primaryValue');
      const siDensity = document.getElementById('siDensity');
      const gcm3Out = document.getElementById('gcms');
      const lbft3Out = document.getElementById('lbft3');
      const lbin3Out = document.getElementById('lbin3');
      const lbgalOut = document.getElementById('lbgal');

      // Conversions
      const MASS_TO_KG = { kg:1, g:0.001, lb:0.45359237, oz:0.028349523125 };
      const VOL_TO_M3 = {
        m3:1, L:0.001, mL:1e-6, cm3:1e-6, ft3:0.028316846592, in3:0.000016387064, gal:0.003785411784
      };
      const LEN_TO_M = { m:1, cm:0.01, mm:0.001, ft:0.3048, in:0.0254 };

      // Density conversions from kg/m^3 to others
      function kgm3_to_gcm3(x){ return x/1000; }
      function kgm3_to_gml(x){ return x/1000; }
      function kgm3_to_lbft3(x){ return x*0.062427960576; }
      function kgm3_to_lbin3(x){ return x*0.000036127292; }
      function kgm3_to_lbgal(x){ return x*0.008345404452; }

      // Density input unit to kg/m^3
      function densityToSI(val, unit){
        const v = Number(val);
        switch(unit){
          case 'kgm3': return v;
          case 'gcm3': return v*1000;
          case 'gml': return v*1000;
          case 'lbft3': return v/0.062427960576;
          case 'lbin3': return v/0.000036127292;
          case 'lbgal': return v/0.008345404452;
          default: return NaN;
        }
      }
      function densityFromSI(kgm3, unit){
        switch(unit){
          case 'kgm3': return kgm3;
          case 'gcm3': return kgm3_to_gcm3(kgm3);
          case 'gml': return kgm3_to_gml(kgm3);
          case 'lbft3': return kgm3_to_lbft3(kgm3);
          case 'lbin3': return kgm3_to_lbin3(kgm3);
          case 'lbgal': return kgm3_to_lbgal(kgm3);
          default: return NaN;
        }
      }

      // Helpers
      function parsePositive(inputEl, errorEl, fieldName){
        const v = inputEl.value.trim();
        if(v === ''){
          errorEl.textContent = `${fieldName} is required. Please enter a value.`;
          inputEl.setAttribute('aria-invalid','true');
          return null;
        }
        const num = Number(v);
        if(!isFinite(num)){
          errorEl.textContent = `The value for ${fieldName} must be a number.`;
          inputEl.setAttribute('aria-invalid','true');
          return null;
        }
        if(num <= 0){
          errorEl.textContent = `${fieldName} must be greater than zero.`;
          inputEl.setAttribute('aria-invalid','true');
          return null;
        }
        errorEl.textContent = '';
        inputEl.setAttribute('aria-invalid','false');
        return num;
      }

      function roundSmart(n){
        if(!isFinite(n)) return n;
        const abs = Math.abs(n);
        if(abs === 0) return 0;
        if(abs >= 1000) return n.toFixed(2);
        if(abs >= 1) return n.toFixed(4);
        if(abs >= 0.01) return n.toFixed(6);
        return n.toExponential(4);
      }

      function setUnitDefaults(){
        const sys = unitSystem.value;
        if(sys === 'metric'){
          massUnit.value = 'kg';
          volumeUnit.value = 'L';
          boxUnit.value = 'cm';
          cylUnit.value = 'cm';
          densityUnit.value = 'kgm3';
        }else{
          massUnit.value = 'lb';
          volumeUnit.value = 'ft3';
          boxUnit.value = 'in';
          cylUnit.value = 'in';
          densityUnit.value = 'lbft3';
        }
      }

      function updateSolveUI(){
        const solveFor = document.querySelector('input[name="solveFor"]:checked').value;
        // Density: need mass + volume
        // Mass: need density + volume
        // Volume: need mass + density
        massGroup.style.display = (solveFor === 'volume') ? '' : ''; // mass is needed for density and volume; keep visible
        volumeGroup.style.display = (solveFor === 'mass') ? '' : ''; // volume is needed for density and mass; keep visible
        densityGroup.style.display = (solveFor === 'density') ? 'none' : ''; // hide density input when solving density
        // Labels in results
        primaryLabel.textContent = (solveFor === 'density') ? 'Density' : (solveFor === 'mass') ? 'Mass' : 'Volume';
      }

      function computeVolumeFromBox(){
        const L = Number(lenInput.value);
        const W = Number(widInput.value);
        const H = Number(heiInput.value);
        if([L,W,H].some(v=>!isFinite(v) || v<=0)){
          boxError.textContent = 'Please provide positive Length, Width, and Height.';
          boxVolumePreview.textContent = 'Computed volume: —';
          return null;
        }
        boxError.textContent = '';
        const mPerUnit = LEN_TO_M[boxUnit.value] || 1;
        const V_m3 = (L*mPerUnit) * (W*mPerUnit) * (H*mPerUnit);
        boxVolumePreview.textContent = `Computed volume: ${roundSmart(V_m3)} m³`;
        return V_m3;
      }

      function computeVolumeFromCylinder(){
        const d = Number(diameterInput.value);
        const h = Number(heightInput.value);
        if([d,h].some(v=>!isFinite(v) || v<=0)){
          cylError.textContent = 'Please provide positive Diameter and Height.';
          cylVolumePreview.textContent = 'Computed volume: —';
          return null;
        }
        cylError.textContent = '';
        const mPerUnit = LEN_TO_M[cylUnit.value] || 1;
        const r = (d*mPerUnit)/2;
        const V_m3 = Math.PI * r*r * (h*mPerUnit);
        cylVolumePreview.textContent = `Computed volume: ${roundSmart(V_m3)} m³`;
        return V_m3;
      }

      function getVolumeSI(){
        const mode = document.querySelector('input[name="volumeMode"]:checked').value;
        if(mode === 'direct'){
          const v = parsePositive(volumeInput, volumeError, 'Volume');
          if(v == null) return null;
          const factor = VOL_TO_M3[volumeUnit.value] || 1;
          return v * factor;
        }else if(mode === 'box'){
          return computeVolumeFromBox();
        }else{
          return computeVolumeFromCylinder();
        }
      }

      function getMassSI(){
        const m = parsePositive(massInput, massError, 'Mass');
        if(m == null) return null;
        const factor = MASS_TO_KG[massUnit.value] || 1;
        return m * factor;
      }

      function getDensitySI(){
        const v = parsePositive(densityInput, densityError, 'Density');
        if(v == null) return null;
        return densityToSI(v, densityUnit.value);
      }

      function formatPrimary(valueSI){
        const solveFor = document.querySelector('input[name="solveFor"]:checked').value;
        if(!isFinite(valueSI)) return '—';
        if(solveFor === 'density'){
          // Display in selected density unit
          const out = densityFromSI(valueSI, densityUnit.value || 'kgm3'); // if hidden, still ok
          const u = unitLabelDensity(densityUnit.value || 'kgm3');
          return `${roundSmart(out)} ${u}`;
        }else if(solveFor === 'mass'){
          // Display in selected mass unit
          const inv = Object.entries(MASS_TO_KG).find(([u,f])=>u===massUnit.value)?.[1] || 1;
          const out = valueSI / inv;
          return `${roundSmart(out)} ${massUnit.value}`;
        }else{
          // Volume
          const inv = Object.entries(VOL_TO_M3).find(([u,f])=>u===volumeUnit.value)?.[1] || 1;
          const out = valueSI / inv;
          return `${roundSmart(out)} ${volumeUnit.value}`;
        }
      }

      function unitLabelDensity(code){
        switch(code){
          case 'kgm3': return 'kg/m³';
          case 'gcm3': return 'g/cm³';
          case 'gml': return 'g/mL';
          case 'lbft3': return 'lb/ft³';
          case 'lbin3': return 'lb/in³';
          case 'lbgal': return 'lb/gal';
          default: return '';
        }
      }

      function updateResults(kgm3Value, primarySI=null){
        if(kgm3Value == null || !isFinite(kgm3Value)){
          primaryValue.textContent = '—';
          siDensity.textContent = '—';
          gcm3Out.textContent = '—';
          lbft3Out.textContent = '—';
          lbin3Out.textContent = '—';
          lbgalOut.textContent = '—';
          return;
        }
        primaryValue.textContent = formatPrimary(primarySI ?? kgm3Value);
        siDensity.textContent = `${roundSmart(kgm3Value)} kg/m³`;
        gcm3Out.textContent = `${roundSmart(kgm3_to_gcm3(kgm3Value))} g/cm³`;
        lbft3Out.textContent = `${roundSmart(kgm3_to_lbft3(kgm3Value))} lb/ft³`;
        lbin3Out.textContent = `${roundSmart(kgm3_to_lbin3(kgm3Value))} lb/in³`;
        lbgalOut.textContent = `${roundSmart(kgm3_to_lbgal(kgm3Value))} lb/gal`;
      }

      function estimateFreightClass(lbPerFt3){
        // NMFC density classes (approximate)
        if(!isFinite(lbPerFt3) || lbPerFt3<=0) return {cls:'—', note:''};
        const d = lbPerFt3;
        if(d >= 50) return {cls:'Class 50', note:'≥ 50 lb/ft³'};
        if(d >= 35) return {cls:'Class 55', note:'35–<50'};
        if(d >= 30) return {cls:'Class 60', note:'30–<35'};
        if(d >= 22.5) return {cls:'Class 65', note:'22.5–<30'};
        if(d >= 15) return {cls:'Class 70', note:'15–<22.5'};
        if(d >= 13.5) return {cls:'Class 77.5', note:'13.5–<15'};
        if(d >= 12) return {cls:'Class 85', note:'12–<13.5'};
        if(d >= 10.5) return {cls:'Class 92.5', note:'10.5–<12'};
        if(d >= 9) return {cls:'Class 100', note:'9–<10.5'};
        if(d >= 8) return {cls:'Class 110', note:'8–<9'};
        if(d >= 7) return {cls:'Class 125', note:'7–<8'};
        if(d >= 6) return {cls:'Class 150', note:'6–<7'};
        if(d >= 5) return {cls:'Class 175', note:'5–<6'};
        if(d >= 4) return {cls:'Class 200', note:'4–<5'};
        if(d >= 3) return {cls:'Class 250', note:'3–<4'};
        if(d >= 2) return {cls:'Class 300', note:'2–<3'};
        if(d >= 1) return {cls:'Class 400', note:'1–<2'};
        return {cls:'Class 500', note:'< 1'};
      }

      function computeFreight(){
        const w = Number(pkgWeight.value);
        const L = Number(pkgLen.value);
        const W = Number(pkgWid.value);
        const H = Number(pkgHei.value);
        if([w,L,W,H].some(v => !isFinite(v) || v<=0)){
          freightError.textContent = '';
          freightPreview.textContent = 'Freight density: —';
          freightResultRow.style.display = 'none';
          return null;
        }
        freightError.textContent = '';
        const ft3 = (L*W*H)/1728; // 12^3
        const density = w/ft3; // lb/ft³
        const cls = estimateFreightClass(density);
        freightPreview.textContent = `Freight density: ${roundSmart(density)} lb/ft³ (${cls.cls})`;
        freightResultRow.style.display = '';
        freightClassSpan.textContent = `${cls.cls} (${cls.note})`;
        return density;
      }

      function calculate(){
        updateSolveUI();
        const solveFor = document.querySelector('input[name="solveFor"]:checked').value;
        let rhoSI=null, mSI=null, vSI=null, primarySI=null;

        // Volume
        if(solveFor !== 'mass'){
          vSI = getVolumeSI(); // needed for density or volume? For density yes; for volume solve we still need m & rho
        }else{
          vSI = getVolumeSI(); // still needed to compute mass
        }

        // Mass
        if(solveFor !== 'volume'){
          mSI = getMassSI();
        }else{
          mSI = getMassSI(); // still needed to compute volume
        }

        // Density
        if(solveFor !== 'density'){
          rhoSI = getDensitySI();
        }

        if(solveFor === 'density'){
          if(mSI==null || vSI==null) { updateResults(null); return; }
          if(vSI<=0){ volumeError.textContent='Volume must be greater than zero.'; return; }
          rhoSI = mSI / vSI;
          primarySI = rhoSI; // primary is density
          updateResults(rhoSI, primarySI);
        }else if(solveFor === 'mass'){
          if(rhoSI==null || vSI==null) { updateResults(null); return; }
          mSI = rhoSI * vSI;
          primarySI = mSI;
          updateResults(rhoSI, primarySI);
        }else{
          if(mSI==null || rhoSI==null) { updateResults(null); return; }
          vSI = mSI / rhoSI;
          primarySI = vSI;
          updateResults(rhoSI, primarySI);
        }

        // Freight helper
        computeFreight();
      }

      function clearAll(){
        [massInput, volumeInput, lenInput, widInput, heiInput, diameterInput, heightInput, densityInput, pkgWeight, pkgLen, pkgWid, pkgHei].forEach(el=>{ if(el){ el.value=''; } });
        [massError, volumeError, boxError, cylError, freightError, densityError].forEach(el=>{ el.textContent=''; });
        [boxVolumePreview, cylVolumePreview, freightPreview].forEach(el=>{ if(el){ el.textContent = el.id==='freightPreview' ? 'Freight density: —' : 'Computed volume: —'; } });
        [massInput, volumeInput, lenInput, widInput, heiInput, diameterInput, heightInput, densityInput].forEach(el=>{ if(el){ el.setAttribute('aria-invalid','false'); } });
        materialSelect.value = '';
        updateResults(null);
        freightResultRow.style.display = 'none';
        primaryValue.textContent = '—';
      }

      // Set defaults and event listeners
      setUnitDefaults();
      updateSolveUI();

      unitSystem.addEventListener('change', setUnitDefaults);
      solveRadios.forEach(r=>r.addEventListener('change', updateSolveUI));

      // Volume mode switching
      function updateVolumeMode(){
        const mode = document.querySelector('input[name="volumeMode"]:checked').value;
        volumeDirectFields.style.display = (mode==='direct') ? '' : 'none';
        volumeBoxFields.style.display = (mode==='box') ? '' : 'none';
        volumeCylinderFields.style.display = (mode==='cylinder') ? '' : 'none';
      }
      [volModeDirect, volModeBox, volModeCylinder].forEach(el=>el.addEventListener('change', updateVolumeMode));

      // Inline validation on blur
      massInput.addEventListener('blur', ()=>parsePositive(massInput, massError, 'Mass'));
      volumeInput.addEventListener('blur', ()=>parsePositive(volumeInput, volumeError, 'Volume'));
      lenInput.addEventListener('blur', computeVolumeFromBox);
      widInput.addEventListener('blur', computeVolumeFromBox);
      heiInput.addEventListener('blur', computeVolumeFromBox);
      boxUnit.addEventListener('change', computeVolumeFromBox);

      diameterInput.addEventListener('blur', computeVolumeFromCylinder);
      heightInput.addEventListener('blur', computeVolumeFromCylinder);
      cylUnit.addEventListener('change', computeVolumeFromCylinder);

      densityInput.addEventListener('blur', ()=>parsePositive(densityInput, densityError, 'Density'));

      // Material density presets (kg/m³)
      const MATERIALS = {
        water: 998.2,
        air: 1.225,
        aluminum: 2700,
        steel: 7850,
        oak: 700
      };
      materialSelect.addEventListener('change', ()=>{
        const key = materialSelect.value;
        if(!key){ return; }
        const val = MATERIALS[key];
        if(isFinite(val)){
          densityInput.value = densityFromSI(val, densityUnit.value).toString();
          densityError.textContent = '';
          densityInput.setAttribute('aria-invalid','false');
        }
      });

      // Calculate / Clear
      calcBtn.addEventListener('click', calculate);
      clearBtn.addEventListener('click', clearAll);

      // Light auto-calc on input (debounced) to enhance UX without hurting INP
      let t;
      document.getElementById('density-calculator').addEventListener('input', ()=>{
        window.clearTimeout(t);
        t = window.setTimeout(calculate, 200);
      });

      // Initialize previews
      updateVolumeMode();
      updateResults(null);
    })();
  </script>

</body></html>
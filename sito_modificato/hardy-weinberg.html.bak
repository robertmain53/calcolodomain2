<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/hardy-weinberg" />
    <title>Hardy Weinberg Calculator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Hardy Weinberg Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Hardy Weinberg Calculator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Hardy Weinberg Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/hardy-weinberg" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Hardy Weinberg Calculator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Hardy Weinberg Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Hardy–Weinberg Equilibrium Calculator (p, q, Genotype & Allele Frequencies)",
        "description": "Interactive Hardy–Weinberg equilibrium calculator. Compute allele frequencies (p, q), genotype frequencies (p², 2pq, q²), expected vs observed counts, and test for deviation from Hardy–Weinberg using chi-square.",
        "url": "https://calcdomain.com/hardy-weinberg",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://calcdomain.com"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Science",
              "item": "https://calcdomain.com/categories/science"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Biology & Genetics",
              "item": "https://calcdomain.com/biology"
            },
            {
              "@type": "ListItem",
              "position": 4,
              "name": "Hardy–Weinberg Equilibrium Calculator",
              "item": "https://calcdomain.com/hardy-weinberg"
            }
          ]
        },
        "mainEntity": [
          {
            "@type": "HowTo",
            "name": "How to use the Hardy–Weinberg equilibrium calculator",
            "step": [
              {
                "@type": "HowToStep",
                "name": "Choose your input mode",
                "text": "Select whether you want to start from genotype counts, genotype frequencies, or allele frequencies (p and q)."
              },
              {
                "@type": "HowToStep",
                "name": "Enter your data",
                "text": "Fill in the AA, Aa, and aa values or the allele frequencies. The calculator automatically enforces that p + q = 1 and genotype frequencies sum to 1."
              },
              {
                "@type": "HowToStep",
                "name": "Review expected Hardy–Weinberg values",
                "text": "The tool computes allele frequencies, expected genotype frequencies p², 2pq, q², and expected counts for your sample size."
              },
              {
                "@type": "HowToStep",
                "name": "Check Hardy–Weinberg equilibrium",
                "text": "If you provide observed genotype counts, the calculatoilibrium at α = 0.05."
              }
            ]
          },
          {
            "@type": "FAQPage",
            "mainEntity": [
              {
                "@type": "Question",
                "name": "What is the Hardy–Weinberg equilibrium?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "Hardy–Weinberg equilibrium describes a theoretical population in which allele and genotype frequencies remain constant from generation to generation. It assumes random mating, no selection, no mutation, no migration, and a very large population size. Under these conditions, genotype frequencies follow p² + 2pq + q² = 1, where p and q are allele frequencies."
                }
              },
              {
                "@type": "Question",
                "name": "How do you calculate p and q from genotype counts?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "For a bi-allelic locus with genotypes AA, Aa, and aa, let N be the total number of individuals. The frequency of allele A is p = (2×AA + Aa) / (2N) and the frequency of allele a is q = (2×aa + Aa) / (2N). By definition p + q = 1."
                }
              },
              {
                "@type": "Question",
                "name": "How do you test for deviation from Hardy–Weinberg equilibrium?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "You can compare observed genotype counts to the expected counts under Hardy–Weinberg using a chi-square test: χ² = Σ (Observed − Expected)² / Expected across the three genotypes. For a simple bi-allelic locus with estimated p and q, the test typically has 1 degree of freedom. A p-value below 0.05 suggests a significant deviation from Hardy–Weinberg equilibrium."
                }
              },
              {
                "@type": "Question",
                "name": "When does Hardy–Weinberg equilibrium not hold?",
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": "Hardy–Weinberg equilibrium is violated when one or more assumptions are broken: non-random mating (inbreeding or assortative mating), natural selection, genetic drift in small populations, mutation, gene flow (migration), or genotyping errors. These forces can change allele and genotype frequencies over generations."
                }
              }
            ]
          }
        ]
      }</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Science Calculators", "item": "https://calcdomain.com/categories/science"}, {"@type": "ListItem", "position": 3, "name": "Biology Calculators", "item": "https://calcdomain.com/subcategories/biology"}, {"@type": "ListItem", "position": 4, "name": "Hardy\u2013Weinberg Equilibrium Calculator", "item": "https://calcdomain.com/hardy-weinberg"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/science" class="text-blue-600 hover:underline">Science Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/biology" class="text-blue-600 hover:underline">Biology Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Hardy–Weinberg Equilibrium Calculator</span></li>
  </ol>
</nav>

      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h1 class="text-2xl md:text-3xl font-bold mb-2">
              Hardy–Weinberg Equilibrium Calculator
            </h1>
            <p class="text-gray-600 mb-4">
              Compute allele frequencies (p, q), expected genotype frequencies
              (p², 2pq, q²), expected counts, and a chi-square test for
              deviation from Hardy–Weinberg equilibrium.
            </p>

            <!-- Tabs -->
            <div class="mb-4">
              <div
                class="inline-flex rounded-md border border-gray-200 overflow-hidden"
                role="tablist"
              >
                <button
                  id="tab-counts"
                  class="px-3 py-2 text-sm font-medium border-r border-gray-200 tab-active"
                  type="button"
                  data-mode="counts"
                >
                  Genotype counts
                </button>
                <button
                  id="tab-freqs"
                  class="px-3 py-2 text-sm font-medium border-r border-gray-200"
                  type="button"
                  data-mode="freqs"
                >
                  Genotype frequencies
                </button>
                <button
                  id="tab-alleles"
                  class="px-3 py-2 text-sm font-medium"
                  type="button"
                  data-mode="alleles"
                >
                  Allele frequencies (p, q)
                </button>
              </div>
            </div>

            <!-- Input forms -->
            <form id="hw-form" class="space-y-4">
              <!-- Counts mode -->
              <div id="mode-counts" class="space-y-3">
                <h2 class="font-semibold text-lg">
                  1. Enter observed genotype counts
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                  <div>
                    <label
                      for="countAA"
                      class="block text-sm font-medium text-gray-700"
                      >AA count</label
                    >
                    <input
                      type="number"
                      id="countAA"
                      min="0"
                      step="1"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      value="40"
                    />
                  </div>
                  <div>
                    <label
                      for="countAa"
                      class="block text-sm font-medium text-gray-700"
                      >Aa count</label
                    >
                    <input
                      type="number"
                      id="countAa"
                      min="0"
                      step="1"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      value="40"
                    />
                  </div>
                  <div>
                    <label
                      for="countaa"
                      class="block text-sm font-medium text-gray-700"
                      >aa count</label
                    >
                    <input
                      type="number"
                      id="countaa"
                      min="0"
                      step="1"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      value="20"
                    />
                  </div>
                </div>
              </div>

              <!-- Frequencies mode -->
              <div id="mode-freqs" class="space-y-3 hidden">
                <h2 class="font-semibold text-lg">
                  1. Enter genotype frequencies
                </h2>
                <p class="text-sm text-gray-500">
                  Frequencies must be between 0 and 1 and should sum to 1. The
                  calculator will normalize small rounding errors.
                </p>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                  <div>
                    <label
                      for="freqAA"
                      class="block text-sm font-medium text-gray-700"
                      >f(AA)</label
                    >
                    <input
                      type="number"
                      id="freqAA"
                      min="0"
                      max="1"
                      step="0.001"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      value="0.4"
                    />
                  </div>
                  <div>
                    <label
                      for="freqAa"
                      class="block text-sm font-medium text-gray-700"
                      >f(Aa)</label
                    >
                    <input
                      type="number"
                      id="freqAa"
                      min="0"
                      max="1"
                      step="0.001"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      value="0.4"
                    />
                  </div>
                  <div>
                    <label
                      for="freqaa"
                      class="block text-sm font-medium text-gray-700"
                      >f(aa)</label
                    >
                    <input
                      type="number"
                      id="freqaa"
                      min="0"
                      max="1"
                      step="0.001"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      value="0.2"
                    />
                  </div>
                </div>
                <div>
                  <label
                    for="freqN"
                    class="block text-sm font-medium text-gray-700"
                    >Sample size (N, optional)</label
                  >
                  <input
                    type="number"
                    id="freqN"
                    min="1"
                    step="1"
                    class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                    placeholder="e.g. 100"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    If provided, expected counts will be computed as frequencies
                    × N.
                  </p>
                </div>
              </div>

              <!-- Alleles mode -->
              <div id="mode-alleles" class="space-y-3 hidden">
                <h2 class="font-semibold text-lg">
                  1. Enter allele frequencies
                </h2>
                <p class="text-sm text-gray-500">
                  For a bi-allelic locus with alleles A and a, p = f(A), q =
                  f(a), and p + q = 1.
                </p>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 items-end">
                  <div>
                    <label
                      for="alleleP"
                      class="block text-sm font-medium text-gray-700"
                      >p (allele A)</label
                    >
                    <input
                      type="number"
                      id="alleleP"
                      min="0"
                      max="1"
                      step="0.001"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      value="0.6"
                    />
                  </div>
                  <div>
                    <label
                      for="alleleQ"
                      class="block text-sm font-medium text-gray-700"
                      >q (allele a)</label
                    >
                    <input
                      type="number"
                      id="alleleQ"
                      min="0"
                      max="1"
                      step="0.001"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      value="0.4"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      If p + q ≠ 1, values will be normalized.
                    </p>
                  </div>
                  <div>
                    <label
                      for="alleleN"
                      class="block text-sm font-medium text-gray-700"
                      >Sample size (N, optional)</label
                    >
                    <input
                      type="number"
                      id="alleleN"
                      min="1"
                      step="1"
                      class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2"
                      placeholder="e.g. 100"
                    />
                  </div>
                </div>
              </div>

              <div class="pt-2 flex flex-wrap items-center gap-3">
                <button
                  type="button"
                  id="btn-calc"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  Calculate Hardy–Weinberg
                </button>
                <button
                  type="button"
                  id="btn-reset"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200"
                >
                  Reset
                </button>
                <p id="error-msg" class="text-sm text-red-600"></p>
              </div>
            </form>

            <!-- Results -->
            <div id="results-container" class="mt-6 hidden">
              <h2 class="text-xl font-semibold mb-3">Results</h2>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-semibold mb-2">Allele frequencies</h3>
                  <div class="text-sm space-y-1">
                    <p>
                      <span class="font-mono">p</span> (A) =
                      <span id="res-p" class="font-semibold"></span>
                    </p>
                    <p>
                      <span class="font-mono">q</span> (a) =
                      <span id="res-q" class="font-semibold"></span>
                    </p>
                    <p class="text-gray-500 text-xs">
                      Check: p + q = <span id="res-pqsum"></span>
                    </p>
                  </div>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-semibold mb-2">
                    Expected genotype frequencies (Hardy–Weinberg)
                  </h3>
                  <div class="text-sm space-y-1">
                    <p>
                      f(AA) = p² =
                      <span id="res-exp-f-AA" class="font-semibold"></span>
                    </p>
                    <p>
                      f(Aa) = 2pq =
                      <span id="res-exp-f-Aa" class="font-semibold"></span>
                    </p>
                    <p>
                      f(aa) = q² =
                      <span id="res-exp-f-aa" class="font-semibold"></span>
                    </p>
                    <p class="text-gray-500 text-xs">
                      Check: p² + 2pq + q² = <span id="res-fsum"></span>
                    </p>
                  </div>
                </div>
              </div>

              <div
                id="counts-section"
                class="border border-gray-200 rounded-lg p-4 mb-4 hidden"
              >
                <h3 class="font-semibold mb-2">
                  Observed vs expected genotype counts
                </h3>
                <p class="text-sm text-gray-500 mb-2">
                  N = <span id="res-N"></span> individuals.
                </p>
                <div class="overflow-x-auto">
                  <table class="min-w-full text-sm border border-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-3 py-2 border-b text-left">Genotype</th>
                        <th class="px-3 py-2 border-b text-right">Observed</th>
                        <th class="px-3 py-2 border-b text-right">
                          Expected (HW)
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="px-3 py-2 border-b">AA</td>
                        <td
                          class="px-3 py-2 border-b text-right"
                          id="res-obs-AA"
                        ></td>
                        <td
                          class="px-3 py-2 border-b text-right"
                          id="res-exp-AA"
                        ></td>
                      </tr>
                      <tr>
                        <td class="px-3 py-2 border-b">Aa</td>
                        <td
                          class="px-3 py-2 border-b text-right"
                          id="res-obs-Aa"
                        ></td>
                        <td
                          class="px-3 py-2 border-b text-right"
                          id="res-exp-Aa"
                        ></td>
                      </tr>
                      <tr>
                        <td class="px-3 py-2 border-b">aa</td>
                        <td
                          class="px-3 py-2 border-b text-right"
                          id="res-obs-aa"
                        ></td>
                        <td
                          class="px-3 py-2 border-b text-right"
                          id="res-exp-aa"
                        ></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div
                id="chisq-section"
                class="border border-gray-200 rounded-lg p-4 mb-2 hidden"
              >
                <h3 class="font-semibold mb-2">
                  Chi-square test for Hardy–Weinberg equilibrium
                </h3>
                <p class="text-sm mb-2">
                  Test statistic: <span class="font-mono">χ²</span> =
                  <span id="res-chisq" class="font-semibold"></span><br />
                  Degrees of freedom: <span id="res-df"></span><br />
                  Approximate p-value:
                  <span id="res-pvalue" class="font-semibold"></span>
                </p>
                <p id="res-interpretation" class="text-sm"></p>
                <p class="text-xs text-gray-500 mt-2">
                  Note: For a single bi-allelic locus with allele frequencies
                  estimated from the data, the chi-square test typically has 1
                  degree of freedom. For small expected counts (&lt; 5), an
                  exact test (e.g., Fisher or exact HWE test) is preferred.
                </p>
              </div>
            </div>

            <!-- Explanation -->
            <article class="prose mt-8">
              <h2>Hardy–Weinberg equilibrium: definition and formula</h2>
              <p>
                The Hardy–Weinberg principle describes how allele and genotype
                frequencies behave in an idealized population. For a locus with
                two alleles, A and a, with frequencies \(p\) and \(q\) (where
                \(p + q = 1\)), the expected genotype frequencies under
                Hardy–Weinberg equilibrium (HWE) are:
              </p>
              <div class="formula-box">
                <p>\[ p = f(A), \quad q = f(a), \quad p + q = 1 \]</p>
                <p>\[ f(AA) = p^2,\quad f(Aa) = 2pq,\quad f(aa) = q^2 \]</p>
                <p>\[ p^2 + 2pq + q^2 = 1 \]</p>
              </div>
              <p>
                These expectations hold if the population is infinitely large,
                mating is random, and there is no selection, mutation,
                migration, or genotyping error. Real populations often deviate
                from these assumptions, and testing for Hardy–Weinberg
                equilibrium is a standard tool in population genetics,
                evolutionary biology, and medical genetics.
              </p>

              <h2>How this Hardy–Weinberg calculator works</h2>
              <h3>1. From genotype counts</h3>
              <p>
                If you enter observed counts for genotypes AA, Aa, and aa, the
                calculator:
              </p>
              <ol>
                <li>
                  Computes the total sample size \(N = n_{AA} + n_{Aa} +
                  n_{aa}\).
                </li>
                <li>
                  Computes allele frequencies: \[ p = \frac{2n_{AA} +
                  n_{Aa}}{2N}, \quad q = \frac{2n_{aa} + n_{Aa}}{2N} \]
                </li>
                <li>
                  Computes expected genotype frequencies under HWE: \(p^2, 2pq,
                  q^2\).
                </li>
                <li>
                  Computes expected counts: \[ E_{AA} = p^2 N,\quad E_{Aa} = 2pq
                  N,\quad E_{aa} = q^2 N \]
                </li>
                <li>
                  Performs a chi-square test: \[ \chi^2 = \sum \frac{(O_i -
                  E_i)^2}{E_i} \] and reports an approximate p-value.
                </li>
              </ol>

              <h3>2. From genotype frequencies</h3>
              <p>
                If you provide genotype frequencies \(f(AA), f(Aa), f(aa)\), the
                tool:
              </p>
              <ul>
                <li>
                  Normalizes them so they sum to 1 (tolerating small rounding
                  errors).
                </li>
                <li>
                  Computes allele frequencies: \[ p = f(AA) + \frac{1}{2}
                  f(Aa),\quad q = f(aa) + \frac{1}{2} f(Aa) \]
                </li>
                <li>
                  Computes the Hardy–Weinberg expectations \(p^2, 2pq, q^2\).
                </li>
                <li>
                  If you also provide a sample size \(N\), it converts
                  frequencies to expected counts.
                </li>
              </ul>

              <h3>3. From allele frequencies (p, q)</h3>
              <p>If you start from allele frequencies, the calculator:</p>
              <ul>
                <li>Normalizes p and q so that \(p + q = 1\).</li>
                <li>
                  Computes the expected genotype frequencies \(p^2, 2pq, q^2\).
                </li>
                <li>
                  If you provide a sample size \(N\), it computes expected
                  counts \(p^2 N, 2pq N, q^2 N\).
                </li>
              </ul>

              <h2>Chi-square test for Hardy–Weinberg equilibrium</h2>
              <p>
                To test whether a population is in Hardy–Weinberg equilibrium,
                we compare observed genotype counts to the expected counts using
                a chi-square goodness-of-fit test:
              </p>
              <div class="formula-box">
                <p>
                  \[ \chi^2 = \sum_{i \in \{AA, Aa, aa\}} \frac{(O_i -
                  E_i)^2}{E_i} \]
                </p>
              </div>
              <p>
                For a single bi-allelic locus with allele frequencies estimated
                from the data, the test typically has 1 degree of freedom. A
                p-value below 0.05 suggests a statistically significant
                deviation from HWE. However, when expected counts are small
                (especially &lt; 5), an exact test is preferred over chi-square.
              </p>

              <h2>Assumptions and common causes of deviation</h2>
              <p>Hardy–Weinberg equilibrium assumes:</p>
              <ul>
                <li>Random mating (no assortative mating or inbreeding).</li>
                <li>
                  No natural selection (all genotypes have equal fitness).
                </li>
                <li>No mutation introducing new alleles.</li>
                <li>No migration (no gene flow from other populations).</li>
                <li>Very large population size (no genetic drift).</li>
                <li>Accurate genotyping (no systematic errors).</li>
              </ul>
              <p>
                Deviations from HWE can signal biological processes (selection,
                inbreeding, population structure), demographic history
                (bottlenecks, admixture), or technical issues (genotyping
                errors, sample contamination). Interpreting deviations requires
                biological context and, often, additional data.
              </p>

              <h2>Worked example</h2>
              <p>
                Suppose you genotype 100 individuals at a locus and observe:
              </p>
              <ul>
                <li>AA: 40</li>
                <li>Aa: 40</li>
                <li>aa: 20</li>
              </ul>
              <p>Allele frequencies are:</p>
              <div class="formula-box">
                <p>\[ N = 40 + 40 + 20 = 100 \]</p>
                <p>
                  \[ p = \frac{2 \cdot 40 + 40}{2 \cdot 100} = \frac{120}{200} =
                  0.6,\quad q = 1 - p = 0.4 \]
                </p>
                <p>
                  \[ f(AA) = p^2 = 0.36,\quad f(Aa) = 2pq = 0.48,\quad f(aa) =
                  q^2 = 0.16 \]
                </p>
                <p>\[ E_{AA} = 36,\quad E_{Aa} = 48,\quad E_{aa} = 16 \]</p>
              </div>
              <p>The chi-square statistic is:</p>
              <div class="formula-box">
                <p>
                  \[ \chi^2 = \frac{(40-36)^2}{36} + \frac{(40-48)^2}{48} +
                  \frac{(20-16)^2}{16} \approx 0.44 + 1.33 + 1.00 = 2.77 \]
                </p>
              </div>
              <p>
                With 1 degree of freedom, χ² ≈ 2.77 corresponds to p ≈ 0.096. At
                α = 0.05, we would not reject Hardy–Weinberg equilibrium for
                this locus.
              </p>
            </article>

            <!-- FAQ -->
            <section class="mt-8" id="faq">
              <h2 class="text-xl font-semibold mb-3">
                Hardy–Weinberg equilibrium FAQ
              </h2>
              <div class="space-y-3">
                <div class="border border-gray-200 rounded-md">
                  <button
                    class="w-full text-left px-4 py-3 font-medium flex justify-between items-center faq-question"
                  >
                    <span
                      >What is the Hardy–Weinberg equilibrium used for?</span
                    >
                    <span class="text-gray-400">+</span>
                  </button>
                  <div
                    class="px-4 pb-3 hidden faq-answer text-sm text-gray-700"
                  >
                    It is used as a null model in population genetics. If a
                    locus is in Hardy–Weinberg equilibrium, allele and genotype
                    frequencies are stable and follow p², 2pq, q². Deviations
                    from HWE can indicate selection, inbreeding, population
                    structure, or technical problems with genotyping. In medical
                    genetics, HWE tests are routinely applied to quality-control
                    SNP data.
                  </div>
                </div>

                <div class="border border-gray-200 rounded-md">
                  <button
                    class="w-full text-left px-4 py-3 font-medium flex justify-between items-center faq-question"
                  >
                    <span
                      >Can Hardy–Weinberg equilibrium hold if allele frequencies
                      change over time?</span
                    >
                    <span class="text-gray-400">+</span>
                  </button>
                  <div
                    class="px-4 pb-3 hidden faq-answer text-sm text-gray-700"
                  >
                    Strictly speaking, Hardy–Weinberg equilibrium assumes
                    constant allele frequencies across generations. However, in
                    practice, we often test HWE within a single generation or
                    sample. Even if allele frequencies are changing slowly over
                    evolutionary time, a snapshot sample can still be close to
                    HWE if the assumptions are approximately met in the recent
                    past.
                  </div>
                </div>

                <div class="border border-gray-200 rounded-md">
                  <button
                    class="w-full text-left px-4 py-3 font-medium flex justify-between items-center faq-question"
                  >
                    <span
                      >Why do we usually test only one locus at a time?</span
                    >
                    <span class="text-gray-400">+</span>
                  </button>
                  <div
                    class="px-4 pb-3 hidden faq-answer text-sm text-gray-700"
                  >
                    The Hardy–Weinberg principle is defined for a single locus.
                    When you test many loci (e.g., thousands of SNPs), each
                    locus can have different evolutionary forces acting on it.
                    Multiple-testing corrections are needed if you interpret
                    many HWE tests simultaneously, especially in genome-wide
                    association studies (GWAS).
                  </div>
                </div>

                <div class="border border-gray-200 rounded-md">
                  <button
                    class="w-full text-left px-4 py-3 font-medium flex justify-between items-center faq-question"
                  >
                    <span
                      >Is this calculator suitable for forensic or clinical
                      use?</span
                    >
                    <span class="text-gray-400">+</span>
                  </button>
                  <div
                    class="px-4 pb-3 hidden faq-answer text-sm text-gray-700"
                  >
                    This calculator is designed for education and quick
                    exploratory analysis. For forensic, clinical, or regulatory
                    applications, you should use validated software, follow
                    domain-specific guidelines, and consult a qualified
                    statistician or population geneticist.
                  </div>
                </div>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Hardy, Weinberg.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>

        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-4">
            <h2 class="text-lg font-semibold mb-3">
              Related Biology &amp; Genetics Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/cell-doubling-time"
                  class="text-blue-600 hover:underline"
                  >Cell Doubling Time</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/island-biogeography"
                  class="text-blue-600 hover:underline"
                  >Island Biogeography</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/niche-breadth"
                  class="text-blue-600 hover:underline"
                  >Niche Breadth</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/punnett-square"
                  class="text-blue-600 hover:underline"
                  >Punnett Square</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/shannon-diversity-index"
                  class="text-blue-600 hover:underline"
                  >Shannon Diversity Index</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/simpsons-diversity-index"
                  class="text-blue-600 hover:underline"
                  >Simpson's Diversity Index</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/allele-frequency"
                  class="text-blue-600 hover:underline"
                  >Allele Frequency</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/mark-recapture"
                  class="text-blue-600 hover:underline"
                  >Mark–Recapture (Lincoln–Petersen)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/hardy-weinberg"
                  class="text-blue-600 hover:underline font-semibold"
                  >Hardy–Weinberg Equilibrium</a
                >
              </li>
            </ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">
              Explore Science Calculators
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/stoichiometry"
                  class="text-blue-600 hover:underline"
                  >Stoichiometry</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molarity"
                  class="text-blue-600 hover:underline"
                  >Molarity</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/nernst-equation"
                  class="text-blue-600 hover:underline"
                  >Nernst Equation</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/ideal-gas-law"
                  class="text-blue-600 hover:underline"
                  >Ideal Gas Law</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/radioactive-decay"
                  class="text-blue-600 hover:underline"
                  >Radioactive Decay</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>

    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>

    <script>
      (function () {
        const tabs = {
          counts: document.getElementById("tab-counts"),
          freqs: document.getElementById("tab-freqs"),
          alleles: document.getElementById("tab-alleles"),
        };
        const modes = {
          counts: document.getElementById("mode-counts"),
          freqs: document.getElementById("mode-freqs"),
          alleles: document.getElementById("mode-alleles"),
        };
        let currentMode = "counts";

        function setMode(mode) {
          currentMode = mode;
          Object.keys(modes).forEach((m) => {
            modes[m].classList.toggle("hidden", m !== mode);
            tabs[m].classList.toggle("tab-active", m === mode);
          });
          document.getElementById("error-msg").textContent = "";
          document.getElementById("results-container").classList.add("hidden");
        }

        Object.values(tabs).forEach((btn) => {
          btn.addEventListener("click", () => setMode(btn.dataset.mode));
        });

        function chiSquareCDF(x, k) {
          if (x < 0 || k < 1) return 0;
          const a = k / 2;
          const g = gamma(a);
          return lowerIncompleteGamma(a, x / 2) / g;
        }

        function gamma(z) {
          const p = [
            676.5203681218851, -1259.1392167224028, 771.32342877765313,
            -176.61502916214059, 12.507343278686905, -0.13857109526572012,
            9.9843695780195716e-6, 1.5056327351493116e-7,
          ];
          if (z < 0.5) {
            return Math.PI / (Math.sin(Math.PI * z) * gamma(1 - z));
          }
          z -= 1;
          let x = 0.99999999999980993;
          for (let i = 0; i < p.length; i++) {
            x += p[i] / (z + i + 1);
          }
          const t = z + p.length - 0.5;
          return (
            Math.sqrt(2 * Math.PI) * Math.pow(t, z + 0.5) * Math.exp(-t) * x
          );
        }

        function lowerIncompleteGamma(s, x) {
          let sum = 0;
          let term = 1 / s;
          let n = 0;
          while (term > 1e-10) {
            sum += term;
            n++;
            term *= x / (s + n);
            if (n > 200) break;
          }
          return Math.pow(x, s) * Math.exp(-x) * sum;
        }

        function format(num, digits = 4) {
          if (!isFinite(num)) return "—";
          return Number(num.toFixed(digits));
        }

        function resetForm() {
          document.getElementById("countAA").value = 40;
          document.getElementById("countAa").value = 40;
          document.getElementById("countaa").value = 20;

          document.getElementById("freqAA").value = 0.4;
          document.getElementById("freqAa").value = 0.4;
          document.getElementById("freqaa").value = 0.2;
          document.getElementById("freqN").value = "";

          document.getElementById("alleleP").value = 0.6;
          document.getElementById("alleleQ").value = 0.4;
          document.getElementById("alleleN").value = "";

          document.getElementById("error-msg").textContent = "";
          document.getElementById("results-container").classList.add("hidden");
          document
            .querySelectorAll("input")
            .forEach((inp) => inp.classList.remove("input-error"));
        }

        document
          .getElementById("btn-reset")
          .addEventListener("click", resetForm);

        document.getElementById("btn-calc").addEventListener("click", () => {
          document.getElementById("error-msg").textContent = "";
          document
            .querySelectorAll("input")
            .forEach((inp) => inp.classList.remove("input-error"));

          let p,
            q,
            N = null;
          let obsAA = null,
            obsAa = null,
            obsaa = null;
          let haveObservedCounts = false;

          try {
            if (currentMode === "counts") {
              const nAA = Number(document.getElementById("countAA").value);
              const nAa = Number(document.getElementById("countAa").value);
              const naa = Number(document.getElementById("countaa").value);

              if ([nAA, nAa, naa].some((v) => isNaN(v) || v < 0)) {
                throw new Error("Counts must be non-negative numbers.");
              }
              N = nAA + nAa + naa;
              if (N === 0)
                throw new Error("Total sample size N must be greater than 0.");

              p = (2 * nAA + nAa) / (2 * N);
              q = 1 - p;

              obsAA = nAA;
              obsAa = nAa;
              obsaa = naa;
              haveObservedCounts = true;
            } else if (currentMode === "freqs") {
              let fAA = Number(document.getElementById("freqAA").value);
              let fAa = Number(document.getElementById("freqAa").value);
              let faa = Number(document.getElementById("freqaa").value);
              const Ninput = document.getElementById("freqN").value;

              if ([fAA, fAa, faa].some((v) => isNaN(v) || v < 0)) {
                throw new Error("Frequencies must be non-negative numbers.");
              }
              let sum = fAA + fAa + faa;
              if (sum === 0)
                throw new Error(
                  "At least one genotype frequency must be greater than 0."
                );
              fAA / sum;
              fAa / sum;
              faa / sum;

              p = fAA + 0.5 * fAa;
              q = faa + 0.5 * fAa;

              if (Ninput) {
                N = Number(Ninput);
                if (isNaN(N) || N <= 0)
                  throw new Error("Sample size N must be a positive number.");
                obsAA = fAA * N;
                obsAa = fAa * N;
                obsaa = faa * N;
                haveObservedCounts = false;
              }
            } else if (currentMode === "alleles") {
              let pIn = Number(document.getElementById("alleleP").value);
              let qIn = Number(document.getElementById("alleleQ").value);
              const Ninput = document.getElementById("alleleN").value;

              if ([pIn, qIn].some((v) => isNaN(v) || v < 0)) {
                throw new Error(
                  "Allele frequencies must be non-negative numbers."
                );
              }
              const sum = pIn + qIn;
              if (sum === 0)
                throw new Error(
                  "At least one allele frequency must be greater than 0."
                );
              p = pIn / sum;
              q = qIn / sum;

              if (Ninput) {
                N = Number(Ninput);
                if (isNaN(N) || N <= 0)
                  throw new Error("Sample size N must be a positive number.");
              }
            }

            if (p < 0 || p > 1 || q < 0 || q > 1) {
              throw new Error(
                "Computed allele frequencies are outside [0, 1]. Please check your inputs."
              );
            }

            const p2 = p * p;
            const q2 = q * q;
            const twoPQ = 2 * p * q;

            document.getElementById("res-p").textContent = format(p, 4);
            document.getElementById("res-q").textContent = format(q, 4);
            document.getElementById("res-pqsum").textContent = format(p + q, 4);

            document.getElementById("res-exp-f-AA").textContent = format(p2, 4);
            document.getElementById("res-exp-f-Aa").textContent = format(
              twoPQ,
              4
            );
            document.getElementById("res-exp-f-aa").textContent = format(q2, 4);
            document.getElementById("res-fsum").textContent = format(
              p2 + twoPQ + q2,
              4
            );

            const countsSection = document.getElementById("counts-section");
            const chisqSection = document.getElementById("chisq-section");
            countsSection.classList.add("hidden");
            chisqSection.classList.add("hidden");

            if (N && N > 0) {
              const expAA = p2 * N;
              const expAa = twoPQ * N;
              const expaa = q2 * N;

              document.getElementById("res-N").textContent = format(N, 4);
              document.getElementById("res-exp-AA").textContent = format(
                expAA,
                3
              );
              document.getElementById("res-exp-Aa").textContent = format(
                expAa,
                3
              );
              document.getElementById("res-exp-aa").textContent = format(
                expaa,
                3
              );

              if (obsAA !== null && obsAa !== null && obsaa !== null) {
                document.getElementById("res-obs-AA").textContent = format(
                  obsAA,
                  3
                );
                document.getElementById("res-obs-Aa").textContent = format(
                  obsAa,
                  3
                );
                document.getElementById("res-obs-aa").textContent = format(
                  obsaa,
                  3
                );
              } else {
                document.getElementById("res-obs-AA").textContent = "—";
                document.getElementById("res-obs-Aa").textContent = "—";
                document.getElementById("res-obs-aa").textContent = "—";
              }

              countsSection.classList.remove("hidden");

              if (haveObservedCounts) {
                const O = [obsAA, obsAa, obsaa];
                const E = [expAA, expAa, expaa];
                let chisq = 0;
                for (let i = 0; i < 3; i++) {
                  if (E[i] > 0) {
                    chisq += Math.pow(O[i] - E[i], 2) / E[i];
                  }
                }
                const df = 1;
                const pval = 1 - chiSquareCDF(chisq, df);

                document.getElementById("res-chisq").textContent = format(
                  chisq,
                  4
                );
                document.getElementById("res-df").textContent = df;
                document.getElementById("res-pvalue").textContent = format(
                  pval,
                  4
                );

                const interp = document.getElementById("res-interpretation");
                if (pval < 0.05) {
                  interp.textContent =
                    "At α = 0.05, the p-value is below 0.05, suggesting a statistically significant deviation from Hardy–Weinberg equilibrium.";
                  interp.className = "text-sm text-red-700";
                } else {
                  interp.textContent =
                    "At α = 0.05, the p-value is ≥ 0.05, so there is no strong evidence against Hardy–Weinberg equilibrium for this locus.";
                  interp.className = "text-sm text-green-700";
                }

                chisqSection.classList.remove("hidden");
              }
            }

            document
              .getElementById("results-container")
              .classList.remove("hidden");
          } catch (err) {
            document.getElementById("error-msg").textContent = err.message;
          }
        });

        document.querySelectorAll(".faq-question").forEach((btn) => {
          btn.addEventListener("click", () => {
            const ans = btn.parentElement.querySelector(".faq-answer");
            const icon = btn.querySelector("span:last-child");
            const isHidden = ans.classList.contains("hidden");
            document
              .querySelectorAll(".faq-answer")
              .forEach((a) => a.classList.add("hidden"));
            document
              .querySelectorAll(".faq-question span:last-child")
              .forEach((i) => (i.textContent = "+"));
            if (isHidden) {
              ans.classList.remove("hidden");
              icon.textContent = "−";
            }
          });
        });
      })();
    </script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/dna-to-protein-translator" />
    <title>Dna to Protein Translator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Dna to Protein Translator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Dna to Protein Translator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Dna to Protein Translator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/dna-to-protein-translator" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Dna to Protein Translator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Dna to Protein Translator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Science Calculators", "item": "https://calcdomain.com/categories/science"}, {"@type": "ListItem", "position": 3, "name": "Biology Calculators", "item": "https://calcdomain.com/subcategories/biology"}, {"@type": "ListItem", "position": 4, "name": "DNA to Protein Translator", "item": "https://calcdomain.com/dna-to-protein-translator"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/science" class="text-blue-600 hover:underline">Science Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/biology" class="text-blue-600 hover:underline">Biology Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">DNA to Protein Translator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">
                DNA to Protein Translator
              </h1>
              <p class="text-gray-600">
                Translate DNA or mRNA sequences into amino acid (protein)
                sequences with support for multiple genetic codes, reading
                frames, ORFs, and reverse complement.
              </p>
            </header>

            <section aria-labelledby="translator-section" class="mb-8">
              <h2 id="translator-section" class="text-xl font-semibold mb-3">
                Sequence input
              </h2>
              <label
                for="sequence-input"
                class="block text-sm font-medium text-gray-700 mb-1"
              >
                Paste DNA or mRNA sequence (FASTA headers and whitespace
                allowed)
              </label>
              <textarea
                id="sequence-input"
                rows="7"
                class="w-full border border-gray-300 rounded-md p-3 mono text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                placeholder=">Example sequence&#10;ATGGCCATTGTAATGGGCCGCTGAAAGGGTGCCCGATAG"
              ></textarea>

              <div class="mt-3 flex flex-wrap gap-3 text-sm">
                <button
                  type="button"
                  id="example-btn"
                  class="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded-md"
                >
                  Load example
                </button>
                <button
                  type="button"
                  id="clear-btn"
                  class="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded-md"
                >
                  Clear
                </button>
              </div>

              <div class="mt-5 grid md:grid-cols-2 gap-4 text-sm">
                <div class="space-y-2">
                  <div>
                    <label class="block font-medium mb-1">Input type</label>
                    <div class="flex items-center gap-4">
                      <label class="inline-flex items-center gap-1">
                        <input
                          type="radio"
                          name="input-type"
                          value="dna"
                          class="text-blue-600"
                          checked
                        />
                        <span>DNA (A, C, G, T)</span>
                      </label>
                      <label class="inline-flex items-center gap-1">
                        <input
                          type="radio"
                          name="input-type"
                          value="mrna"
                          class="text-blue-600"
                        />
                        <span>mRNA (A, C, G, U)</span>
                      </label>
                    </div>
                  </div>

                  <div>
                    <label for="genetic-code" class="block font-medium mb-1"
                      >Genetic code</label
                    >
                    <select
                      id="genetic-code"
                      class="w-full border border-gray-300 rounded-md p-2"
                    >
                      <option value="standard">Standard (nuclear)</option>
                      <option value="vertebrate_mito">
                        Vertebrate mitochondrial
                      </option>
                      <option value="yeast_mito">Yeast mitochondrial</option>
                      <option value="bacterial">
                        Bacterial / plant plastid
                      </option>
                    </select>
                  </div>

                  <div>
                    <label for="frame-select" class="block font-medium mb-1"
                      >Reading frame</label
                    >
                    <select
                      id="frame-select"
                      class="w-full border border-gray-300 rounded-md p-2"
                    >
                      <option value="1">+1 (forward, offset 0)</option>
                      <option value="2">+2 (forward, offset 1)</option>
                      <option value="3">+3 (forward, offset 2)</option>
                      <option value="all3">All 3 forward frames</option>
                      <option value="all6">
                        All 6 frames (forward + reverse complement)
                      </option>
                    </select>
                  </div>
                </div>

                <div class="space-y-2">
                  <div>
                    <label class="block font-medium mb-1"
                      >Translation options</label
                    >
                    <label class="flex items-start gap-2 mb-1">
                      <input
                        type="checkbox"
                        id="trim-to-start"
                        class="mt-1 text-blue-600"
                      />
                      <span
                        >Trim to first start codon (e.g., ATG/AUG) in each
                        frame</span
                      >
                    </label>
                    <label class="flex items-start gap-2 mb-1">
                      <input
                        type="checkbox"
                        id="stop-at-stop"
                        class="mt-1 text-blue-600"
                        checked
                      />
                      <span
                        >Stop translation at first stop codon (*) in each
                        frame</span
                      >
                    </label>
                    <label class="flex items-start gap-2 mb-1">
                      <input
                        type="checkbox"
                        id="show-orfs"
                        class="mt-1 text-blue-600"
                        checked
                      />
                      <span
                        >Detect open reading frames (ORFs) and list them in a
                        table</span
                      >
                    </label>
                    <label class="flex items-start gap-2 mb-1">
                      <input
                        type="checkbox"
                        id="show-revcomp"
                        class="mt-1 text-blue-600"
                      />
                      <span>Show reverse complement sequence</span>
                    </label>
                  </div>

                  <div>
                    <label for="min-orf-length" class="block font-medium mb-1"
                      >Minimum ORF length (amino acids)</label
                    >
                    <input
                      type="number"
                      id="min-orf-length"
                      class="w-32 border border-gray-300 rounded-md p-1.5"
                      value="30"
                      min="1"
                      step="1"
                    />
                  </div>
                </div>
              </div>

              <div class="mt-5 flex flex-wrap items-center gap-3">
                <button
                  type="button"
                  id="translate-btn"
                  class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-md"
                >
                  Translate
                </button>
                <button
                  type="button"
                  id="download-fasta-btn"
                  class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-md disabled:opacity-50 disabled:cursor-not-allowed"
                  disabled
                >
                  Download FASTA
                </button>
                <span id="status-msg" class="text-sm text-gray-600"></span>
              </div>
            </section>

            <section aria-labelledby="results-section" class="mb-8">
              <h2 id="results-section" class="text-xl font-semibold mb-3">
                Translation results
              </h2>

              <div id="results-container" class="space-y-6">
                <div
                  id="main-translation-card"
                  class="hidden border border-gray-200 rounded-md p-4"
                >
                  <h3 class="font-semibold mb-2">Amino acid sequence</h3>
                  <div class="overflow-x-auto scrollbar-thin">
                    <pre
                      id="aa-output"
                      class="mono text-xs md:text-sm leading-5 whitespace-pre-wrap"
                    ></pre>
                  </div>
                  <p id="aa-summary" class="mt-2 text-sm text-gray-600"></p>
                </div>

                <div
                  id="frames-card"
                  class="hidden border border-gray-200 rounded-md p-4"
                >
                  <h3 class="font-semibold mb-2">Reading frames</h3>
                  <p class="text-xs text-gray-600 mb-2">
                    Start codons are highlighted in green, stop codons in red.
                    ORFs above the minimum length are shaded in blue.
                  </p>
                  <div
                    id="frames-output"
                    class="space-y-3 mono text-xs md:text-sm leading-5"
                  ></div>
                </div>

                <div
                  id="orfs-card"
                  class="hidden border border-gray-200 rounded-md p-4"
                >
                  <h3 class="font-semibold mb-2">
                    Detected open reading frames (ORFs)
                  </h3>
                  <div class="overflow-x-auto">
                    <table
                      class="min-w-full text-xs md:text-sm border border-gray-200"
                    >
                      <thead class="bg-gray-50">
                        <tr>
                          <th class="px-2 py-1 border-b text-left">#</th>
                          <th class="px-2 py-1 border-b text-left">Frame</th>
                          <th class="px-2 py-1 border-b text-left">
                            Start (nt)
                          </th>
                          <th class="px-2 py-1 border-b text-left">End (nt)</th>
                          <th class="px-2 py-1 border-b text-left">
                            Length (aa)
                          </th>
                          <th class="px-2 py-1 border-b text-left">
                            Sequence (first 30 aa)
                          </th>
                        </tr>
                      </thead>
                      <tbody id="orfs-table-body"></tbody>
                    </table>
                  </div>
                </div>

                <div
                  id="revcomp-card"
                  class="hidden border border-gray-200 rounded-md p-4"
                >
                  <h3 class="font-semibold mb-2">Reverse complement</h3>
                  <div class="overflow-x-auto scrollbar-thin">
                    <pre
                      id="revcomp-output"
                      class="mono text-xs md:text-sm leading-5 whitespace-pre-wrap"
                    ></pre>
                  </div>
                </div>

                <div
                  id="codon-usage-card"
                  class="hidden border border-gray-200 rounded-md p-4"
                >
                  <h3 class="font-semibold mb-2">
                    Codon usage (translated region)
                  </h3>
                  <div class="overflow-x-auto">
                    <table
                      class="min-w-full text-xs md:text-sm border border-gray-200"
                    >
                      <thead class="bg-gray-50">
                        <tr>
                          <th class="px-2 py-1 border-b text-left">Codon</th>
                          <th class="px-2 py-1 border-b text-left">AA</th>
                          <th class="px-2 py-1 border-b text-right">Count</th>
                        </tr>
                      </thead>
                      <tbody id="codon-usage-body"></tbody>
                    </table>
                  </div>
                </div>
              </div>
            </section>

            <section class="prose">
              <h2>How this DNA to protein translator works</h2>
              <p>
                This tool converts nucleotide sequences into amino acid
                (protein) sequences using standard bioinformatics conventions.
                It accepts raw DNA or mRNA, ignores FASTA headers and
                whitespace, and lets you control reading frame, genetic code,
                and how open reading frames (ORFs) are handled.
              </p>

              <h3>1. Cleaning and normalizing the input</h3>
              <p>The sequence is first normalized:</p>
              <ul>
                <li>
                  FASTA headers starting with <code>&gt;</code> are removed.
                </li>
                <li>
                  Whitespace, digits, and non-IUPAC characters are stripped.
                </li>
                <li>All letters are converted to uppercase.</li>
                <li>
                  If you select mRNA, <code>U</code> is treated as equivalent to
                  <code>T</code> for codon lookup.
                </li>
              </ul>

              <h3>2. Reading frames and codons</h3>
              <p>
                A codon is a group of three nucleotides. There are three
                possible reading frames on each strand, depending on the
                starting offset (0, 1, or 2). For a given frame, codons are
                formed as:
              </p>
              <div class="formula-box mono text-sm">
                <p>
                  codon<sub>i</sub> = sequence[ start + 3·i : start + 3·i + 3 ]
                </p>
              </div>
              <p>You can translate:</p>
              <ul>
                <li>A single forward frame (+1, +2, or +3).</li>
                <li>All 3 forward frames.</li>
                <li>All 6 frames (3 forward + 3 on the reverse complement).</li>
              </ul>

              <h3>3. Genetic codes and start/stop codons</h3>
              <p>
                Each genetic code is a mapping from codons to amino acids. For
                example, in the standard code:
              </p>
              <ul>
                <li>
                  <code>ATG</code> → Methionine (<code>M</code>) and is usually
                  a start codon.
                </li>
                <li>
                  <code>TAA</code>, <code>TAG</code>, <code>TGA</code> → stop
                  codons (<code>*</code>).
                </li>
              </ul>
              <p>
                Mitochondrial and bacterial codes differ in how some codons are
                interpreted (e.g., <code>TGA</code> can code for tryptophan in
                mitochondria). This tool adjusts the codon table accordingly
                when you change the genetic code.
              </p>

              <h3>4. Open reading frames (ORFs)</h3>
              <p>
                An open reading frame is a stretch of codons that begins with a
                start codon and ends with a stop codon, without internal stops.
                For each frame, the tool:
              </p>
              <ol>
                <li>Scans codons from 5′ to 3′.</li>
                <li>Marks positions where a start codon appears.</li>
                <li>Extends until a stop codon is found.</li>
                <li>
                  Reports ORFs whose length (in amino acids) is at least your
                  chosen minimum.
                </li>
              </ol>
              <p>
                ORFs are summarized in a table with frame, nucleotide start/end
                positions (1-based), and length in amino acids.
              </p>

              <h3>5. Handling ambiguous bases</h3>
              <p>
                Biological sequences often contain ambiguous IUPAC codes such as
                <code>N</code>, <code>R</code>, or <code>Y</code>. This
                translator:
              </p>
              <ul>
                <li>Keeps ambiguous bases in the nucleotide sequence.</li>
                <li>
                  Translates any codon containing an ambiguous base as
                  <code>X</code> (unknown amino acid).
                </li>
              </ul>

              <h3>6. Reverse complement</h3>
              <p>
                The reverse complement is computed by reversing the sequence and
                replacing each base with its complement:
              </p>
              <div class="formula-box mono text-sm">
                <p>A ↔ T, C ↔ G, and (for RNA) A ↔ U</p>
              </div>
              <p>
                When you select “All 6 frames”, the tool translates three frames
                on the forward strand and three on the reverse complement.
              </p>

              <h2>Practical tips for interpreting results</h2>
              <ul>
                <li>
                  <strong>Long ORFs</strong> (hundreds of amino acids) are more
                  likely to represent real protein-coding genes.
                </li>
                <li>
                  <strong>Short ORFs</strong> may be regulatory or non-coding;
                  adjust the minimum ORF length to explore them.
                </li>
                <li>
                  If you see many <code>X</code> residues, your input may
                  contain ambiguous bases or sequencing errors; check the
                  original data.
                </li>
                <li>
                  Always confirm predicted proteins with additional evidence
                  (e.g., BLAST searches, expression data, or experimental
                  validation).
                </li>
              </ul>

              <h2>Limitations and good practices</h2>
              <p>
                This translator is designed for educational and exploratory use.
                It does not perform splice site prediction, codon optimization,
                or advanced gene finding. For critical research or clinical
                decisions, use specialized pipelines and consult a qualified
                molecular biologist or bioinformatician.
              </p>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Clinical notes</h2><p class="text-sm text-gray-700">Use consistent units (kg, cm, mg/dL) and flag inputs outside physiological ranges. Always interpret the result alongside clinical history and context.</p><p class="text-sm text-gray-700 mt-2">Key entities: Dna, To, Protein, Translator, Paste DNA or mRNA sequence (FASTA headers and whitespace allowed), Input type, DNA (A, C, G, T), mRNA (A, C, G, U).</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Paste DNA or mRNA sequence (FASTA headers and whitespace allowed)</li><li>Input type</li><li>DNA (A, C, G, T)</li><li>mRNA (A, C, G, U)</li><li>Genetic code Standard (nuclear) Vertebrate mitochondrial Yeast mitochondrial Bacterial / plant plastid Reading frame +1 (forward, offset 0) +2 (forward, offset 1) +3 (forward, offset 2) All 3 forward frames All 6 frames (forward + reverse complement) Translation options Trim to first start codon (e.g., ATG/AUG) in each frame</li><li>Stop translation at first stop codon (*) in each frame</li><li>Detect open reading frames (ORFs) and list them in a table</li><li>Show reverse complement sequence</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, rounding to 2-3 decimals.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Clinical notes</h2><p class="text-sm text-gray-700">Use consistent units (kg, cm, mg/dL) and flag inputs outside physiological ranges. Always interpret the result alongside clinical history and context.</p><p class="text-sm text-gray-700 mt-2">Key entities: Dna, To, Protein, Translator, Paste DNA or mRNA sequence (FASTA headers and whitespace allowed), Input type, DNA (A, C, G, T), mRNA (A, C, G, U).</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Paste DNA or mRNA sequence (FASTA headers and whitespace allowed)</li><li>Input type</li><li>DNA (A, C, G, T)</li><li>mRNA (A, C, G, U)</li><li>Genetic code Standard (nuclear) Vertebrate mitochondrial Yeast mitochondrial Bacterial / plant plastid Reading frame +1 (forward, offset 0) +2 (forward, offset 1) +3 (forward, offset 2) All 3 forward frames All 6 frames (forward + reverse complement) Translation options Trim to first start codon (e.g., ATG/AUG) in each frame</li><li>Stop translation at first stop codon (*) in each frame</li><li>Detect open reading frames (ORFs) and list them in a table</li><li>Show reverse complement sequence</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, rounding to 2-3 decimals.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Biology & Genetics tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/hemocytometer"
                  class="text-blue-600 hover:underline"
                  >Hemocytometer Cell Counting</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molecular-weight"
                  class="text-blue-600 hover:underline"
                  >Molecular Weight Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/dna-concentration"
                  class="text-blue-600 hover:underline"
                  >DNA Concentration Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molar-mass"
                  class="text-blue-600 hover:underline"
                  >Molar Mass Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molarity"
                  class="text-blue-600 hover:underline"
                  >Molarity Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percent-yield"
                  class="text-blue-600 hover:underline"
                  >Percent Yield</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/stoichiometry"
                  class="text-blue-600 hover:underline"
                  >Stoichiometry Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/empirical-formula"
                  class="text-blue-600 hover:underline"
                  >Empirical Formula</a
                >
              </li>
            
              <li><a href="https://calcdomain.com/restriction-enzyme-digest" class="text-blue-600 hover:underline">Restriction Enzyme Digest Calculator</a></li>

              <li><a href="https://calcdomain.com/population-pyramid-generator" class="text-blue-600 hover:underline">Population Pyramid Generator</a></li>
</ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Science categories</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/biology"
                  class="text-blue-600 hover:underline"
                  >Biology Tools</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/chemistry"
                  class="text-blue-600 hover:underline"
                  >Chemistry Calculators</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/physics"
                  class="text-blue-600 hover:underline"
                  >Physics & Optics</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/life-and-earth-sciences"
                  class="text-blue-600 hover:underline"
                  >Life & Earth Sciences</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/categories/science"
                  class="text-blue-600 hover:underline"
                  >All Science Calculators</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Genetic code tables (subset of NCBI codes)
      const GENETIC_CODES = {
        standard: {
          name: "Standard",
          startCodons: new Set(["ATG", "TTG", "CTG"]),
          table: {
            TTT: "F",
            TTC: "F",
            TTA: "L",
            TTG: "L",
            TCT: "S",
            TCC: "S",
            TCA: "S",
            TCG: "S",
            TAT: "Y",
            TAC: "Y",
            TAA: "*",
            TAG: "*",
            TGT: "C",
            TGC: "C",
            TGA: "*",
            TGG: "W",
            CTT: "L",
            CTC: "L",
            CTA: "L",
            CTG: "L",
            CCT: "P",
            CCC: "P",
            CCA: "P",
            CCG: "P",
            CAT: "H",
            CAC: "H",
            CAA: "Q",
            CAG: "Q",
            CGT: "R",
            CGC: "R",
            CGA: "R",
            CGG: "R",
            ATT: "I",
            ATC: "I",
            ATA: "I",
            ATG: "M",
            ACT: "T",
            ACC: "T",
            ACA: "T",
            ACG: "T",
            AAT: "N",
            AAC: "N",
            AAA: "K",
            AAG: "K",
            AGT: "S",
            AGC: "S",
            AGA: "R",
            AGG: "R",
            GTT: "V",
            GTC: "V",
            GTA: "V",
            GTG: "V",
            GCT: "A",
            GCC: "A",
            GCA: "A",
            GCG: "A",
            GAT: "D",
            GAC: "D",
            GAA: "E",
            GAG: "E",
            GGT: "G",
            GGC: "G",
            GGA: "G",
            GGG: "G",
          },
        },
        vertebrate_mito: {
          name: "Vertebrate mitochondrial",
          startCodons: new Set(["ATG", "ATA", "ATT", "ATC", "GTG"]),
          table: {
            TTT: "F",
            TTC: "F",
            TTA: "L",
            TTG: "L",
            TCT: "S",
            TCC: "S",
            TCA: "S",
            TCG: "S",
            TAT: "Y",
            TAC: "Y",
            TAA: "*",
            TAG: "*",
            TGT: "C",
            TGC: "C",
            TGA: "W",
            TGG: "W",
            CTT: "L",
            CTC: "L",
            CTA: "L",
            CTG: "L",
            CCT: "P",
            CCC: "P",
            CCA: "P",
            CCG: "P",
            CAT: "H",
            CAC: "H",
            CAA: "Q",
            CAG: "Q",
            CGT: "R",
            CGC: "R",
            CGA: "R",
            CGG: "R",
            ATT: "I",
            ATC: "I",
            ATA: "M",
            ATG: "M",
            ACT: "T",
            ACC: "T",
            ACA: "T",
            ACG: "T",
            AAT: "N",
            AAC: "N",
            AAA: "K",
            AAG: "K",
            AGT: "S",
            AGC: "S",
            AGA: "*",
            AGG: "*",
            GTT: "V",
            GTC: "V",
            GTA: "V",
            GTG: "V",
            GCT: "A",
            GCC: "A",
            GCA: "A",
            GCG: "A",
            GAT: "D",
            GAC: "D",
            GAA: "E",
            GAG: "E",
            GGT: "G",
            GGC: "G",
            GGA: "G",
            GGG: "G",
          },
        },
        yeast_mito: {
          name: "Yeast mitochondrial",
          startCodons: new Set(["ATG", "ATA", "GTG"]),
          table: {
            TTT: "F",
            TTC: "F",
            TTA: "L",
            TTG: "L",
            TCT: "S",
            TCC: "S",
            TCA: "S",
            TCG: "S",
            TAT: "Y",
            TAC: "Y",
            TAA: "*",
            TAG: "*",
            TGT: "C",
            TGC: "C",
            TGA: "W",
            TGG: "W",
            CTT: "T",
            CTC: "T",
            CTA: "T",
            CTG: "T",
            CCT: "P",
            CCC: "P",
            CCA: "P",
            CCG: "P",
            CAT: "H",
            CAC: "H",
            CAA: "Q",
            CAG: "Q",
            CGT: "R",
            CGC: "R",
            CGA: "R",
            CGG: "R",
            ATT: "I",
            ATC: "I",
            ATA: "M",
            ATG: "M",
            ACT: "T",
            ACC: "T",
            ACA: "T",
            ACG: "T",
            AAT: "N",
            AAC: "N",
            AAA: "K",
            AAG: "K",
            AGT: "S",
            AGC: "S",
            AGA: "R",
            AGG: "R",
            GTT: "V",
            GTC: "V",
            GTA: "V",
            GTG: "V",
            GCT: "A",
            GCC: "A",
            GCA: "A",
            GCG: "A",
            GAT: "D",
            GAC: "D",
            GAA: "E",
            GAG: "E",
            GGT: "G",
            GGC: "G",
            GGA: "G",
            GGG: "G",
          },
        },
        bacterial: {
          name: "Bacterial / plant plastid",
          startCodons: new Set(["ATG", "GTG", "TTG"]),
          table: {
            TTT: "F",
            TTC: "F",
            TTA: "L",
            TTG: "L",
            TCT: "S",
            TCC: "S",
            TCA: "S",
            TCG: "S",
            TAT: "Y",
            TAC: "Y",
            TAA: "*",
            TAG: "*",
            TGT: "C",
            TGC: "C",
            TGA: "*",
            TGG: "W",
            CTT: "L",
            CTC: "L",
            CTA: "L",
            CTG: "L",
            CCT: "P",
            CCC: "P",
            CCA: "P",
            CCG: "P",
            CAT: "H",
            CAC: "H",
            CAA: "Q",
            CAG: "Q",
            CGT: "R",
            CGC: "R",
            CGA: "R",
            CGG: "R",
            ATT: "I",
            ATC: "I",
            ATA: "I",
            ATG: "M",
            ACT: "T",
            ACC: "T",
            ACA: "T",
            ACG: "T",
            AAT: "N",
            AAC: "N",
            AAA: "K",
            AAG: "K",
            AGT: "S",
            AGC: "S",
            AGA: "R",
            AGG: "R",
            GTT: "V",
            GTC: "V",
            GTA: "V",
            GTG: "V",
            GCT: "A",
            GCC: "A",
            GCA: "A",
            GCG: "A",
            GAT: "D",
            GAC: "D",
            GAA: "E",
            GAG: "E",
            GGT: "G",
            GGC: "G",
            GGA: "G",
            GGG: "G",
          },
        },
      };

      const COMPLEMENT = {
        A: "T",
        T: "A",
        U: "A",
        C: "G",
        G: "C",
        a: "t",
        t: "a",
        u: "a",
        c: "g",
        g: "c",
      };

      function cleanSequence(raw) {
        if (!raw) return "";
        const lines = raw.split(/\r?\n/).filter((l) => !l.startsWith(">"));
        const joined = lines.join("").toUpperCase();
        return joined.replace(/[^ACGTURYKMSWBDHVN]/gi, "");
      }

      function toDNA(seq, inputType) {
        if (inputType === "mrna") {
          return seq.replace(/U/g, "T");
        }
        return seq;
      }

      function reverseComplement(seq) {
        const chars = seq.split("").reverse();
        return chars
          .map((ch) => (COMPLEMENT[ch] ? COMPLEMENT[ch].toUpperCase() : ch))
          .join("");
      }

      function translateFrame(dna, frameIndex, code, options) {
        const { trimToStart, stopAtStop, minOrfAa } = options;
        const table = code.table;
        const startCodons = code.startCodons;
        const startOffset = frameIndex; // 0,1,2 for forward; for reverse we pass adjusted
        const codons = [];
        const aaSeq = [];
        const orfs = [];
        let inOrf = false;
        let orfStartNt = null;
        let currentOrfAa = "";
        let usedRegionCodons = [];

        const len = dna.length;
        let i = startOffset;
        let started = !trimToStart;

        while (i + 3 <= len) {
          const codon = dna.slice(i, i + 3);
          codons.push({ codon, pos: i });
          const hasAmbig = /[^ACGT]/.test(codon);
          let aa;
          if (hasAmbig) {
            aa = "X";
          } else {
            aa = table[codon] || "X";
          }

          if (!started && startCodons.has(codon)) {
            started = true;
          }

          if (started) {
            aaSeq.push(aa);
            usedRegionCodons.push(codon);
          }

          const isStart = startCodons.has(codon);
          const isStop = aa === "*";

          if (isStart && !inOrf) {
            inOrf = true;
            orfStartNt = i;
            currentOrfAa = "";
          }

          if (inOrf) {
            currentOrfAa += aa;
          }

          if (inOrf && isStop) {
            const aaLen = currentOrfAa.length;
            if (aaLen >= minOrfAa) {
              orfs.push({
                startNt: orfStartNt + 1,
                endNt: i + 3,
                lengthAa: aaLen,
                aaSeq: currentOrfAa,
              });
            }
            inOrf = false;
            orfStartNt = null;
            currentOrfAa = "";
          }

          if (started && stopAtStop && isStop) {
            break;
          }

          i += 3;
        }

        const aaString = aaSeq.join("");
        return { aaString, codons, orfs, usedRegionCodons };
      }

      function buildCodonUsage(codons, code) {
        const usage = {};
        const table = code.table;
        for (const c of codons) {
          const codon = c.toUpperCase();
          if (!/^[ACGT]{3}$/.test(codon)) continue;
          const aa = table[codon] || "X";
          const key = codon;
          if (!usage[key]) usage[key] = { codon, aa, count: 0 };
          usage[key].count += 1;
        }
        return Object.values(usage).sort((a, b) =>
          a.codon.localeCompare(b.codon)
        );
      }

      function formatWrapped(seq, group = 10, line = 60) {
        const groupsPerLine = Math.floor(line / group);
        const parts = [];
        for (let i = 0; i < seq.length; i += group) {
          parts.push(seq.slice(i, i + group));
        }
        const lines = [];
        for (let i = 0; i < parts.length; i += groupsPerLine) {
          lines.push(parts.slice(i, i + groupsPerLine).join(" "));
        }
        return lines.join("\n");
      }

      function highlightFrames(dna, framesData, code, options) {
        const { minOrfAa } = options;
        const table = code.table;
        const startCodons = code.startCodons;
        const container = document.getElementById("frames-output");
        container.innerHTML = "";

        framesData.forEach((frameInfo) => {
          const { label, dnaSeq, frameIndex } = frameInfo;
          const len = dnaSeq.length;
          let html = "";
          let i = frameIndex;
          let inOrf = false;
          let orfStartIndex = null;
          let aaCountInOrf = 0;

          while (i + 3 <= len) {
            const codon = dnaSeq.slice(i, i + 3);
            const hasAmbig = /[^ACGT]/.test(codon);
            const aa = hasAmbig ? "X" : table[codon] || "X";
            const isStart = startCodons.has(codon);
            const isStop = aa === "*";

            let spanClass = "";
            if (isStart) spanClass = "highlight-start";
            if (isStop) spanClass = "highlight-stop";

            if (isStart && !inOrf) {
              inOrf = true;
              orfStartIndex = i;
              aaCountInOrf = 0;
            }
            if (inOrf) aaCountInOrf++;

            if (inOrf && isStop) {
              if (aaCountInOrf >= minOrfAa) {
                // mark ORF region with background
                // we will wrap entire ORF later; for simplicity, use same color for codons in ORF
                spanClass = spanClass + " highlight-orfs";
              }
              inOrf = false;
              orfStartIndex = null;
              aaCountInOrf = 0;
            }

            const display = codon;
            if (spanClass) {
              html += `<span class="${spanClass.trim()}">${display}</span>`;
            } else {
              html += display;
            }

            if ((i - frameIndex) % 30 === 27) html += " ";
            i += 3;
          }

          const frameBlock = document.createElement("div");
          frameBlock.innerHTML = `<div class="font-semibold mb-1">${label}</div><div class="mono text-xs md:text-sm leading-5 break-all">${html}</div>`;
          container.appendChild(frameBlock);
        });
      }

      function downloadFASTA(header, seq) {
        const fasta = `>${header}\n${formatWrapped(seq, 60, 60)}\n`;
        const blob = new Blob([fasta], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = header.replace(/\s+/g, "_") + ".fasta";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      document.addEventListener("DOMContentLoaded", () => {
        const seqInput = document.getElementById("sequence-input");
        const exampleBtn = document.getElementById("example-btn");
        const clearBtn = document.getElementById("clear-btn");
        const translateBtn = document.getElementById("translate-btn");
        const downloadBtn = document.getElementById("download-fasta-btn");
        const statusMsg = document.getElementById("status-msg");
        const frameSelect = document.getElementById("frame-select");
        const geneticCodeSelect = document.getElementById("genetic-code");
        const trimToStartCb = document.getElementById("trim-to-start");
        const stopAtStopCb = document.getElementById("stop-at-stop");
        const showOrfsCb = document.getElementById("show-orfs");
        const showRevcompCb = document.getElementById("show-revcomp");
        const minOrfInput = document.getElementById("min-orf-length");

        const mainCard = document.getElementById("main-translation-card");
        const aaOutput = document.getElementById("aa-output");
        const aaSummary = document.getElementById("aa-summary");
        const framesCard = document.getElementById("frames-card");
        const orfsCard = document.getElementById("orfs-card");
        const orfsBody = document.getElementById("orfs-table-body");
        const revcompCard = document.getElementById("revcomp-card");
        const revcompOutput = document.getElementById("revcomp-output");
        const codonUsageCard = document.getElementById("codon-usage-card");
        const codonUsageBody = document.getElementById("codon-usage-body");

        let lastMainAA = "";

        exampleBtn.addEventListener("click", () => {
          seqInput.value = [
            ">Example coding sequence",
            "ATGGCCATTGTAATGGGCCGCTGAAAGGGTGCCCGATAG",
          ].join("\n");
        });

        clearBtn.addEventListener("click", () => {
          seqInput.value = "";
          statusMsg.textContent = "";
          mainCard.classList.add("hidden");
          framesCard.classList.add("hidden");
          orfsCard.classList.add("hidden");
          revcompCard.classList.add("hidden");
          codonUsageCard.classList.add("hidden");
          downloadBtn.disabled = true;
          lastMainAA = "";
        });

        translateBtn.addEventListener("click", () => {
          statusMsg.textContent = "";
          mainCard.classList.add("hidden");
          framesCard.classList.add("hidden");
          orfsCard.classList.add("hidden");
          revcompCard.classList.add("hidden");
          codonUsageCard.classList.add("hidden");
          orfsBody.innerHTML = "";
          codonUsageBody.innerHTML = "";
          downloadBtn.disabled = true;
          lastMainAA = "";

          const raw = seqInput.value.trim();
          if (!raw) {
            statusMsg.textContent = "Please paste a DNA or mRNA sequence.";
            statusMsg.classList.remove("text-green-600");
            statusMsg.classList.add("text-red-600");
            return;
          }

          const inputType = document.querySelector(
            'input[name="input-type"]:checked'
          ).value;
          let dna = toDNA(cleanSequence(raw), inputType);
          if (dna.length < 3) {
            statusMsg.textContent =
              "Sequence is too short to translate (need at least 3 nucleotides).";
            statusMsg.classList.remove("text-green-600");
            statusMsg.classList.add("text-red-600");
            return;
          }

          const codeKey = geneticCodeSelect.value;
          const code = GENETIC_CODES[codeKey] || GENETIC_CODES.standard;
          const frameMode = frameSelect.value;
          const trimToStart = trimToStartCb.checked;
          const stopAtStop = stopAtStopCb.checked;
          const showOrfs = showOrfsCb.checked;
          const showRevcomp = showRevcompCb.checked;
          const minOrfAa = Math.max(1, parseInt(minOrfInput.value || "30", 10));

          const options = { trimToStart, stopAtStop, minOrfAa };

          let framesToTranslate = [];
          if (frameMode === "1" || frameMode === "2" || frameMode === "3") {
            framesToTranslate.push({
              label: `Frame +${frameMode}`,
              dnaSeq: dna,
              frameIndex: parseInt(frameMode, 10) - 1,
              isReverse: false,
            });
          } else if (frameMode === "all3" || frameMode === "all6") {
            framesToTranslate.push({
              label: "Frame +1",
              dnaSeq: dna,
              frameIndex: 0,
              isReverse: false,
            });
            framesToTranslate.push({
              label: "Frame +2",
              dnaSeq: dna,
              frameIndex: 1,
              isReverse: false,
            });
            framesToTranslate.push({
              label: "Frame +3",
              dnaSeq: dna,
              frameIndex: 2,
              isReverse: false,
            });
            if (frameMode === "all6") {
              const rev = reverseComplement(dna);
              framesToTranslate.push({
                label: "Frame -1",
                dnaSeq: rev,
                frameIndex: 0,
                isReverse: true,
              });
              framesToTranslate.push({
                label: "Frame -2",
                dnaSeq: rev,
                frameIndex: 1,
                isReverse: true,
              });
              framesToTranslate.push({
                label: "Frame -3",
                dnaSeq: rev,
                frameIndex: 2,
                isReverse: true,
              });
            }
          }

          const allOrfs = [];
          let mainAASeq = "";
          let mainCodonsForUsage = [];

          framesToTranslate.forEach((frameInfo, idx) => {
            const res = translateFrame(
              frameInfo.dnaSeq,
              frameInfo.frameIndex,
              code,
              options
            );
            frameInfo.translation = res;
            if (showOrfs && res.orfs.length) {
              res.orfs.forEach((o) => {
                allOrfs.push({
                  ...o,
                  frameLabel: frameInfo.label,
                });
              });
            }
            if (idx === 0) {
              mainAASeq = res.aaString;
              mainCodonsForUsage = res.usedRegionCodons;
            }
          });

          if (!mainAASeq) {
            statusMsg.textContent =
              "No amino acids could be translated in the selected frame/options.";
            statusMsg.classList.remove("text-green-600");
            statusMsg.classList.add("text-red-600");
            return;
          }

          // Show main translation
          mainCard.classList.remove("hidden");
          aaOutput.textContent = formatWrapped(mainAASeq, 10, 60);
          aaSummary.textContent = `Length: ${mainAASeq.length} amino acids. Genetic code: ${code.name}.`;

          // Frames visualization
          framesCard.classList.remove("hidden");
          highlightFrames(dna, framesToTranslate, code, options);

          // ORFs table
          if (showOrfs && allOrfs.length) {
            orfsCard.classList.remove("hidden");
            allOrfs.sort((a, b) => b.lengthAa - a.lengthAa);
            orfsBody.innerHTML = allOrfs
              .map((orf, idx) => {
                const preview =
                  orf.aaSeq.slice(0, 30) + (orf.aaSeq.length > 30 ? "…" : "");
                return `<tr class="${
                  idx % 2 === 0 ? "bg-white" : "bg-gray-50"
                }">
            <td class="px-2 py-1 border-b">${idx + 1}</td>
            <td class="px-2 py-1 border-b">${orf.frameLabel}</td>
            <td class="px-2 py-1 border-b">${orf.startNt}</td>
            <td class="px-2 py-1 border-b">${orf.endNt}</td>
            <td class="px-2 py-1 border-b">${orf.lengthAa}</td>
            <td class="px-2 py-1 border-b mono">${preview}</td>
          </tr>`;
              })
              .join("");
          }

          // Reverse complement
          if (showRevcomp) {
            revcompCard.classList.remove("hidden");
            revcompOutput.textContent = formatWrapped(
              reverseComplement(dna),
              10,
              60
            );
          }

          // Codon usage
          if (mainCodonsForUsage.length) {
            codonUsageCard.classList.remove("hidden");
            const usage = buildCodonUsage(mainCodonsForUsage, code);
            codonUsageBody.innerHTML = usage
              .map(
                (u) => `
          <tr>
            <td class="px-2 py-1 border-b mono">${u.codon}</td>
            <td class="px-2 py-1 border-b mono">${u.aa}</td>
            <td class="px-2 py-1 border-b text-right">${u.count}</td>
          </tr>
        `
              )
              .join("");
          }

          lastMainAA = mainAASeq;
          downloadBtn.disabled = false;
          statusMsg.textContent = `Translated ${dna.length} nucleotides.`;
          statusMsg.classList.remove("text-red-600");
          statusMsg.classList.add("text-green-600");
        });

        downloadBtn.addEventListener("click", () => {
          if (!lastMainAA) return;
          downloadFASTA("translated_protein", lastMainAA);
        });
      });
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

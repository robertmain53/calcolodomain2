<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Levene’s Test Calculator – Homogeneity of Variances (F test)</title>
    <meta name="description" content="Levene’s test calculator for homogeneity of variances across 2 or more groups. Paste your data, choose mean or median (Brown–Forsythe), and get F statistic, p-value, and interpretation for the equality of variances assumption.">
    <link rel="canonical" href="https://calcdomain.com/levenes-test">
    
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .card-hover { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .prose { max-width: 65ch; margin-left: auto; margin-right: auto; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .formula-box { background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; overflow-x: auto; margin: 1rem 0; }
        .badge { font-size: 0.7rem; padding: 0.15rem 0.45rem; border-radius: 9999px; }
        .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
        .smallcaps { font-variant: small-caps; }
        .table-sm th, .table-sm td { white-space: nowrap; }
    </style>
    
    <!-- HEAD_SCRIPTS_E_META -->
    <!-- Google tag (gtag.js) -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-7MB5V1LZRN');
    </script>
    
    <meta name="google-site-verification" content="_tiTZ9ivAdtXcAS9CMnTNJ549Sg39WVqP_ZFbWgglNA">
    
    <script src="https://cmp.gatekeeperconsent.com/min.js" data-cfasync="false"></script>
    <script src="https://the.gatekeeperconsent.com/cmp.min.js" data-cfasync="false"></script>
    
    <script async="" src="//www.ezojs.com/ezoic/sa.min.js"></script>
    <script>
        window.ezstandalone = window.ezstandalone || {};
        ezstandalone.cmd = ezstandalone.cmd || [];
    </script>

    <script type="application/ld+json">
[
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://calcdomain.com"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Science",
        "item": "https://calcdomain.com/categories/science"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Physics",
        "item": "https://calcdomain.com/subcategories/physics"
      }
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Levene’s Test Calculator – Homogeneity of Variances (F test)",
    "url": "https://calcdomain.com/levenes-test",
    "inLanguage": "en",
    "description": "Levene’s test calculator for homogeneity of variances across 2 or more groups. Paste your data, choose mean or median (Brown–Forsythe), and get F statistic, p-value, and interpretation for the equality of variances assumption.",
    "isPartOf": {
      "@type": "WebSite",
      "name": "CalcDomain",
      "url": "https://calcdomain.com/"
    }
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is Levene’s test used for?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Levene’s test assesses whether several groups have equal population variances. It is typically used before applying methods such as the independent samples t test or one-way ANOVA, which assume homogeneity of variances."
        }
      },
      {
        "@type": "Question",
        "name": "Should I use the mean or median version of Levene’s test?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The original Levene’s test is based on deviations from the group mean and works well under approximate normality. The Brown–Forsythe modification uses the median and is more robust to outliers and heavy tails. Many analysts prefer the median version unless normality is well supported."
        }
      },
      {
        "@type": "Question",
        "name": "What are the assumptions of Levene’s test?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Levene’s test assumes independent observations and a reasonably continuous scale. It is less sensitive to departures from normality than tests like Bartlett’s test, especially in the median (Brown–Forsythe) form, but very small samples or extreme outliers can still distort the results."
        }
      },
      {
        "@type": "Question",
        "name": "How do I interpret the p-value in Levene’s test?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The null hypothesis states that all group variances are equal. A small p-value (typically below 0.05) indicates evidence against homogeneity of variances. A large p-value suggests that the data are compatible with equal variances, but it does not prove that the variances are exactly the same."
        }
      }
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to use the Levene’s test calculator",
    "description": "Step-by-step instructions to run Levene’s test for homogeneity of variances across two or more groups.",
    "totalTime": "PT3M",
    "step": [
      {
        "@type": "HowToStep",
        "name": "Paste the groups",
        "text": "For each group, paste the numeric observations into a separate group box. You can separate values with commas, semicolons, spaces or line breaks."
      },
      {
        "@type": "HowToStep",
        "name": "Choose center (mean or median)",
        "text": "Select whether the deviations should be computed from the group mean (original Levene) or group median (Brown–Forsythe)."
      },
      {
        "@type": "HowToStep",
        "name": "Set the significance level",
        "text": "Select a significance level such as 0.05. The test will compare the p-value to this threshold when giving the interpretation."
      },
      {
        "@type": "HowToStep",
        "name": "Run the test and interpret results",
        "text": "Click Calculate. The tool returns the F statistic, numerator and denominator degrees of freedom, p-value, and a textual summary indicating whether homogeneity of variances is rejected or not at the chosen significance level."
      }
    ]
  }
]
</script>

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
.auditspine-badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  border:1px solid #e5e7eb;
  background:#f8fafc;
  color:#0f172a;
}
.auditspine-badge-warn{
  background:#fff7ed;
  border-color:#fed7aa;
  color:#9a3412;
}
</style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- BODY_SCRIPTS_INIZIO -->
    <script async="" src="https://pagead2.googlesyndication.com/pagead/js?client=ca-pub-9476637732224939" crossorigin="anonymous"></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a href="https://calcdomain.com" class="text-2xl font-bold text-blue-600">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
              <div id="search-results" class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a href="https://calcdomain.com/search" class="text-gray-700 hover:text-blue-600 transition-colors">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="text-gray-700 hover:text-blue-600 transition-colors">Categories</a>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      
      <nav class="text-sm mb-4 text-gray-600" aria-label="Breadcrumbs"><a href="https://calcdomain.com" class="hover:text-blue-600">Home</a> &raquo; <a href="https://calcdomain.com/categories/science" class="hover:text-blue-600">Science</a> &raquo; <a href="https://calcdomain.com/subcategories/physics" class="hover:text-blue-600">Physics</a></nav>
      
      <div class="flex flex-col lg:flex-row gap-8">
        
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <div class="flex items-center gap-2 mb-2">
                <h1 class="text-2xl md:text-3xl font-bold">Levene’s Test for Homogeneity of Variances</h1>
                <span class="badge bg-blue-100 text-blue-700 border border-blue-200">F-test</span>
              </div>
              <p class="text-gray-700">
                Run <strong>Levene’s test</strong> (and its <strong>Brown–Forsythe median-based variant</strong>) to check
                whether multiple groups have equal variances. Paste your data for 2 or more groups and get the
                <strong>F statistic, degrees of freedom, p-value</strong> and an interpretation at your chosen
                significance level.
              </p>
              <p class="text-xs text-gray-500 mt-1">
                Designed for teaching, lab work and quick checks of the equal-variance assumption before t-tests and ANOVA.
                For critical decisions, consult a statistician and your field’s reporting standards.
              </p>
            </header>

            <!-- Calculator -->
            <section aria-labelledby="lt-calculator" class="mb-8">
              <h2 id="lt-calculator" class="text-xl font-semibold mb-4">
                Interactive Levene’s test calculator
              </h2>

              <!-- Options -->
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div>
                  <label for="lt-center" class="block text-sm font-medium text-gray-800 mb-1">
                    Center (Z<sub>ij</sub> deviations from)
                  </label>
                  <select id="lt-center" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="median" selected="">Median (Brown–Forsythe, robust)</option>
                    <option value="mean">Mean (original Levene)</option>
                  </select>
                  <p class="text-xs text-gray-500 mt-1">
                    Median is recommended for robustness to outliers and non-normality.
                  </p>
                </div>
                <div>
                  <label for="lt-alpha" class="block text-sm font-medium text-gray-800 mb-1">
                    Significance level α
                  </label>
                  <select id="lt-alpha" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="0.10">0.10</option>
                    <option value="0.05" selected="">0.05</option>
                    <option value="0.01">0.01</option>
                    <option value="0.001">0.001</option>
                  </select>
                  <p class="text-xs text-gray-500 mt-1">
                    Used to decide whether to reject equal variances.
                  </p>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-800 mb-1">
                    Group count
                  </label>
                  <div class="flex items-center gap-2">
                    <button id="lt-remove-group-btn" type="button" class="px-2 py-1 text-sm border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                      −
                    </button>
                    <span id="lt-group-count" class="text-sm font-semibold text-gray-800">3 groups</span>
                    <button id="lt-add-group-btn" type="button" class="px-2 py-1 text-sm border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                      +
                    </button>
                  </div>
                  <p class="text-xs text-gray-500 mt-1">
                    Between 2 and 8 groups. Each needs at least 2 observations.
                  </p>
                </div>
              </div>

              <!-- Group inputs -->
              <div id="lt-groups-container" class="space-y-4 mb-4">
                <!-- JS will populate group cards -->
              </div>

              <p class="text-xs text-gray-500 mb-4">
                Paste one group per box. You can use commas, semicolons, spaces, or line breaks
                (e.g. <span class="mono">12.4, 11.9, 13.2 12.8</span>).
              </p>

              <!-- Buttons -->
              <div class="flex flex-wrap gap-3 mb-2">
                <button id="lt-calc-btn" type="button" class="inline-flex items-center justify-center px-4 py-2 rounded-md bg-blue-600 text-white text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Run Levene’s test
                </button>
                <button id="lt-reset-btn" type="button" class="inline-flex items-center justify-center px-4 py-2 rounded-md border border-gray-300 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Reset example data
                </button>
              </div>

              <!-- Error -->
              <p id="lt-error" class="text-sm text-red-600 mb-3 hidden"></p>

              <!-- Formula summary -->
              <div id="lt-formula-box" class="formula-box hidden">
                <p class="font-semibold mb-1">Formula used</p>
                <p id="lt-formula" class="text-sm text-gray-800"></p>
              </div>

              <!-- Results -->
              <div id="lt-results-box" class="mt-4 hidden">
                <h3 class="text-lg font-semibold mb-2">Levene’s test results</h3>
                <p id="lt-summary" class="text-sm text-gray-800 mb-3"></p>

                <div class="overflow-x-auto mb-3">
                  <table class="min-w-full text-sm border border-gray-200 rounded-md overflow-hidden table-sm">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-3 py-2 text-left font-semibold text-gray-700 border-b">Component</th>
                        <th class="px-3 py-2 text-left font-semibold text-gray-700 border-b">df</th>
                        <th class="px-3 py-2 text-left font-semibold text-gray-700 border-b">SS</th>
                        <th class="px-3 py-2 text-left font-semibold text-gray-700 border-b">MS</th>
                        <th class="px-3 py-2 text-left font-semibold text-gray-700 border-b">F</th>
                      </tr>
                    </thead>
                    <tbody id="lt-results-body" class="divide-y divide-gray-100">
                      <!-- filled by JS -->
                    </tbody>
                  </table>
                </div>

                <p id="lt-interpretation" class="text-sm font-medium mt-2"></p>
                <p id="lt-footnote" class="text-xs text-gray-500 mt-2">
                  F statistic computed from an ANOVA on absolute deviations \(Z_{ij} = |X_{ij} - T_i|\),
                  where \(T_i\) is the chosen group center (mean or median).
                  p-value is based on the F distribution with the reported degrees of freedom.
                </p>
              </div>
            </section>

            <!-- Theory & explanation -->
            <section class="prose">
              <h2>What is Levene’s test?</h2>
              <p>
                Levene’s test is a widely used <strong>omnibus test of equality of variances</strong> across
                two or more groups. It tests the null hypothesis
              </p>
              <div class="formula-box">
                \[
                  H_0: \sigma_1^2 = \sigma_2^2 = \dots = \sigma_k^2
                \]
                \[
                  H_A: \text{at least two group variances differ.}
                \]
              </div>
              <p>
                It works by transforming the original observations \(X_{ij}\) into absolute deviations from a
                group-specific center \(T_i\):
              </p>
              <div class="formula-box">
                \[
                  Z_{ij} = |X_{ij} - T_i|
                \]
              </div>
              <p>
                Then a standard <strong>one-way ANOVA</strong> is run on the \(Z_{ij}\). If the mean (or median)
                absolute deviations differ substantially between groups, the test statistic becomes large and the
                p-value becomes small.
              </p>

              <h2>Mean vs. median (Brown–Forsythe) Levene’s test</h2>
              <p>
                The choice of center \(T_i\) defines several variants:
              </p>
              <ul>
                <li>
                  <strong>Mean-based Levene’s test</strong>:
                  \(T_i = \bar{X}_i\), the sample mean of group \(i\). This is the original version and
                  is efficient when data are approximately normal.
                </li>
                <li>
                  <strong>Median-based (Brown–Forsythe) test</strong>:
                  \(T_i = \tilde{X}_i\), the sample median of group \(i\). This version is more robust
                  to outliers and skewed distributions.
                </li>
              </ul>
              <p>
                Many contemporary references recommend the median-based variant whenever normality is questionable.
                This calculator offers both, with the median version selected by default.
              </p>

              <h2>How the F statistic is computed</h2>
              <p>
                After computing the deviations \(Z_{ij}\) for each observation in group \(i\),
                let \(\bar{Z}_i\) be the mean of group \(i\), and \(\bar{Z}\) the overall mean:
              </p>
              <div class="formula-box">
                <p>Between-group sum of squares:</p>
                \[
                  SS_B = \sum_{i=1}^k n_i(\bar{Z}_i - \bar{Z})^2
                \]
                <p>Within-group sum of squares:</p>
                \[
                  SS_W = \sum_{i=1}^k \sum_{j=1}^{n_i} (Z_{ij} - \bar{Z}_i)^2
                \]
                <p>Degrees of freedom:</p>
                \[
                  df_B = k - 1, \qquad df_W = N - k
                \]
                <p>Mean squares and Levene’s F statistic:</p>
                \[
                  MS_B = \frac{SS_B}{df_B}, \quad
                  MS_W = \frac{SS_W}{df_W}, \quad
                  F = \frac{MS_B}{MS_W}.
                \]
              </div>
              <p>
                Under \(H_0\) (equal variances), and assuming independent observations and mild regularity
                conditions, the F statistic approximately follows an
                \(F(df_B, df_W)\) distribution. The p-value is then:
              </p>
              <div class="formula-box">
                \[
                  p = P(F_{df_B, df_W} \ge F_{\text{obs}}).
                \]
              </div>

              <h2>When should you use Levene’s test?</h2>
              <ul>
                <li>
                  Before running a <strong>t-test</strong> or <strong>ANOVA</strong>, to assess whether the
                  assumption of equal variances across groups is reasonable.
                </li>
                <li>
                  In <strong>experimental design and quality control</strong>, to check stability of variability
                  across conditions, treatments, or production lines.
                </li>
                <li>
                  As part of <strong>model diagnostics</strong> when comparing residual spreads across categories.
                </li>
              </ul>
              <p>
                Remember that a non-significant Levene’s test does <em>not</em> prove that the variances are
                exactly equal—it only indicates that the data are compatible with homogeneity at the chosen
                significance level.
              </p>

              <h2>Practical tips and caveats</h2>
              <ul>
                <li>
                  <strong>Sample size:</strong> with very small \(n_i\) per group, the test has low power.
                  With very large samples, trivial differences in variance may become statistically significant.
                </li>
                <li>
                  <strong>Outliers:</strong> outliers can inflate variance and distort tests; the median-based
                  variant mitigates this but does not eliminate it.
                </li>
                <li>
                  <strong>Multiple testing:</strong> if you run Levene’s test repeatedly across many outcomes
                  or subsets, consider multiplicity adjustments.
                </li>
                <li>
                  <strong>Complementary plots:</strong> always inspect standard deviations, boxplots, and
                  residual plots alongside the numerical test.
                </li>
              </ul>
            </section>

            <!-- FAQ -->
            <section id="faq" class="mt-10">
              <h2 class="text-xl font-semibold mb-4">Frequently asked questions</h2>

              <div class="border-t border-gray-200 divide-y divide-gray-200">
                <div class="faq-item py-3">
                  <button type="button" class="faq-question w-full flex justify-between items-center text-left">
                    <span class="text-sm font-medium text-gray-800">
                      Can I use Levene’s test with only two groups?
                    </span>
                    <span class="ml-3 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer mt-2 text-sm text-gray-700 hidden">
                    <p>
                      Yes. With two groups, Levene’s test is essentially an F test comparing two variances and is
                      closely related to the equal-variance assumption in the classic two-sample t test. For more than
                      two groups, it generalises naturally through the ANOVA formulation on absolute deviations.
                    </p>
                  </div>
                </div>

                <div class="faq-item py-3">
                  <button type="button" class="faq-question w-full flex justify-between items-center text-left">
                    <span class="text-sm font-medium text-gray-800">
                      How does Levene’s test compare to Bartlett’s test?
                    </span>
                    <span class="ml-3 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer mt-2 text-sm text-gray-700 hidden">
                    <p>
                      Bartlett’s test is more powerful under strict normality but is very sensitive to deviations from
                      normality and outliers. Levene’s test, especially in its median (Brown–Forsythe) form, is more
                      robust and therefore preferred in many applied settings where normality cannot be guaranteed.
                    </p>
                  </div>
                </div>

                <div class="faq-item py-3">
                  <button type="button" class="faq-question w-full flex justify-between items-center text-left">
                    <span class="text-sm font-medium text-gray-800">
                      What should I do if Levene’s test is significant?
                    </span>
                    <span class="ml-3 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer mt-2 text-sm text-gray-700 hidden">
                    <p>
                      A significant result suggests heterogeneity of variances. Common responses include using
                      <strong>Welch’s t test</strong> instead of the standard t test, applying a
                      <strong>Welch-type ANOVA</strong>, transforming the data, or using methods specifically designed
                      for unequal variances. The right choice depends on your design and discipline.
                    </p>
                  </div>
                </div>

                <div class="faq-item py-3">
                  <button type="button" class="faq-question w-full flex justify-between items-center text-left">
                    <span class="text-sm font-medium text-gray-800">
                      Is this calculator a substitute for full statistical software?
                    </span>
                    <span class="ml-3 text-gray-400">+</span>
                  </button>
                  <div class="faq-answer mt-2 text-sm text-gray-700 hidden">
                    <p>
                      No. This tool implements the core Levene/Brown–Forsythe test with numerical F distribution
                      calculations for p-values, suitable for quick checks and educational purposes. For complex
                      designs, model diagnostics, or regulatory submissions, use a full statistical package and
                      consult a qualified statistician.
                    </p>
                  </div>
                </div>
              </div>
            </section>
          </div>
        
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[H_0: \sigma_1^2 = \sigma_2^2 = \dots = \sigma_k^2\]</div>
  <pre class="auditspine-mono">H_0: \sigma_1^2 = \sigma_2^2 = \dots = \sigma_k^2</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[H_A: \text{at least two group variances differ.}\]</div>
  <pre class="auditspine-mono">H_A: \text{at least two group variances differ.}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[Z_{ij} = |X_{ij} - T_i|\]</div>
  <pre class="auditspine-mono">Z_{ij} = |X_{ij} - T_i|</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[SS_B = \sum_{i=1}^k n_i(\bar{Z}_i - \bar{Z})^2\]</div>
  <pre class="auditspine-mono">SS_B = \sum_{i=1}^k n_i(\bar{Z}_i - \bar{Z})^2</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[SS_W = \sum_{i=1}^k \sum_{j=1}^{n_i} (Z_{ij} - \bar{Z}_i)^2\]</div>
  <pre class="auditspine-mono">SS_W = \sum_{i=1}^k \sum_{j=1}^{n_i} (Z_{ij} - \bar{Z}_i)^2</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[df_B = k - 1, \qquad df_W = N - k\]</div>
  <pre class="auditspine-mono">df_B = k - 1, \qquad df_W = N - k</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ H_0: \sigma_1^2 = \sigma_2^2 = \dots = \sigma_k^2 \] \[ H_A: \text{at least two group variances differ.} \]</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ Z_{ij} = |X_{ij} - T_i| \]</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">Between-group sum of squares: \[ SS_B = \sum_{i=1}^k n_i(\bar{Z}_i - \bar{Z})^2 \] Within-group sum of squares: \[ SS_W = \sum_{i=1}^k \sum_{j=1}^{n_i} (Z_{ij} - \bar{Z}_i)^2 \] Degrees of freedom: \[ df_B = k - 1, \qquad df_W = N - k \] Mean squares and Levene’s F statistic: \[ MS_B = \frac{SS_B}{df_B}, \quad MS_W = \frac{SS_W}{df_W}, \quad F = \frac{MS_B}{MS_W}. \]</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">\[ p = P(F_{df_B, df_W} \ge F_{\text{obs}}). \]</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>NIST — Weights and measures</strong> — nist.gov · Accessed 2026-01-19<br><a href="https://www.nist.gov/pml/weights-and-measures" target="_blank" rel="nofollow noopener">https://www.nist.gov/pml/weights-and-measures</a></li>
<li><strong>FTC — Consumer advice</strong> — consumer.ftc.gov · Accessed 2026-01-19<br><a href="https://consumer.ftc.gov/" target="_blank" rel="nofollow noopener">https://consumer.ftc.gov/</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</main>
        
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-5 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">Related Science &amp; Data Analysis tools</h2>
            <p class="text-sm text-gray-700 mb-3">
              Pair Levene’s test with these calculators for experimental design, ecology and biostatistics.
            </p>
            <ul class="space-y-2 text-sm">
              <li>
                <a href="https://calcdomain.com/shannon-diversity-index" class="text-blue-600 hover:underline">
                  Shannon diversity index
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/simpsons-diversity-index" class="text-blue-600 hover:underline">
                  Simpson’s diversity index
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/allele-frequency" class="text-blue-600 hover:underline">
                  Allele frequency
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/elisa" class="text-blue-600 hover:underline">
                  ELISA data analysis
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/lotka-volterra" class="text-blue-600 hover:underline">
                  Lotka–Volterra predator–prey model
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/mark-recapture" class="text-blue-600 hover:underline">
                  Mark–recapture (Lincoln–Petersen)
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/serial-dilution" class="text-blue-600 hover:underline">
                  Serial dilution calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/standard-form" class="text-blue-600 hover:underline">
                  Standard form &amp; scientific notation
                </a>
              </li>
            </ul>
          </div>

          <div class="bg-white p-5 rounded-lg shadow-md">
            <h3 class="text-md font-semibold mb-2">Explore more Science tools</h3>
            <ul class="space-y-1 text-sm">
              <li>
                <a href="https://calcdomain.com/categories/science" class="text-blue-600 hover:underline">
                  Science calculators index
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/stoichiometry" class="text-blue-600 hover:underline">
                  Stoichiometry calculator
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/nernst-equation" class="text-blue-600 hover:underline">
                  Nernst equation
                </a>
              </li>
              <li>
                <a href="https://calcdomain.com/beer-lambert-law" class="text-blue-600 hover:underline">
                  Beer–Lambert law
                </a>
              </li>
            </ul>
          </div>
        </aside>
        
      </div>
    </div> 

    <footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>








    
    <script src="/assets/js/script_menu.js" defer=""></script>
    <script src="/assets/js/script_faq.js" defer=""></script>
    <script src="search.js" defer=""></script>
    
    <script>
      window.MathJax = {
        tex: { inlineMath: [['\\(','\\)'], ['$', '$']], displayMath: [['$','$'], ['\\[','\\]']] },
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    
    <script>
      (function() {
        const centerSelect = document.getElementById('lt-center');
        const alphaSelect = document.getElementById('lt-alpha');
        const addGroupBtn = document.getElementById('lt-add-group-btn');
        const removeGroupBtn = document.getElementById('lt-remove-group-btn');
        const groupCountSpan = document.getElementById('lt-group-count');
        const groupsContainer = document.getElementById('lt-groups-container');

        const calcBtn = document.getElementById('lt-calc-btn');
        const resetBtn = document.getElementById('lt-reset-btn');
        const errorEl = document.getElementById('lt-error');

        const formulaBox = document.getElementById('lt-formula-box');
        const formulaEl = document.getElementById('lt-formula');

        const resultsBox = document.getElementById('lt-results-box');
        const resultsBody = document.getElementById('lt-results-body');
        const summaryEl = document.getElementById('lt-summary');
        const interpretationEl = document.getElementById('lt-interpretation');

        const MIN_GROUPS = 2;
        const MAX_GROUPS = 8;

        let currentGroups = 3;

        function clearError() {
          errorEl.textContent = '';
          errorEl.classList.add('hidden');
        }

        function showError(msg) {
          errorEl.textContent = msg;
          errorEl.classList.remove('hidden');
        }

        function updateGroupCountLabel() {
          groupCountSpan.textContent = currentGroups + (currentGroups === 1 ? ' group' : ' groups');
        }

        function createGroupCard(index, presetValues) {
          const wrapper = document.createElement('div');
          wrapper.className = 'bg-gray-50 border border-gray-200 rounded-md p-3';
          wrapper.dataset.groupIndex = index;

          const labelRow = document.createElement('div');
          labelRow.className = 'flex items-center justify-between mb-1';

          const label = document.createElement('label');
          label.className = 'text-sm font-medium text-gray-800';
          label.textContent = 'Group ' + (index + 1);
          labelRow.appendChild(label);

          const nInfo = document.createElement('span');
          nInfo.className = 'text-xs text-gray-500';
          nInfo.id = 'lt-group-n-' + index;
          nInfo.textContent = '';
          labelRow.appendChild(nInfo);

          const textarea = document.createElement('textarea');
          textarea.className = 'w-full border border-gray-300 rounded-md px-2 py-1 text-xs mono focus:outline-none focus:ring-2 focus:ring-blue-500';
          textarea.rows = 3;
          textarea.id = 'lt-group-' + index;
          textarea.placeholder = 'e.g. 12.4, 11.9, 13.2, 12.8';

          if (presetValues && presetValues.length) {
            textarea.value = presetValues.join(', ');
            nInfo.textContent = presetValues.length + ' values';
          }

          textarea.addEventListener('input', function() {
            const values = parseNumberList(this.value);
            nInfo.textContent = values.length ? (values.length + ' values') : '';
          });

          wrapper.appendChild(labelRow);
          wrapper.appendChild(textarea);
          return wrapper;
        }

        function rebuildGroupCards(presets) {
          groupsContainer.innerHTML = '';
          for (let i = 0; i < currentGroups; i++) {
            const presetVals = presets && presets[i] ? presets[i] : null;
            const card = createGroupCard(i, presetVals);
            groupsContainer.appendChild(card);
          }
          updateGroupCountLabel();
        }

        function parseNumberList(str) {
          if (!str) return [];
          const raw = str
            .replace(/[\n\r]+/g, ' ')
            .split(/[,;\s]+/)
            .map(s => s.trim())
            .filter(Boolean);
          const out = [];
          for (const token of raw) {
            const num = Number(token);
            if (isFinite(num)) {
              out.push(num);
            }
          }
          return out;
        }

        function mean(arr) {
          if (!arr.length) return NaN;
          let s = 0;
          for (let i = 0; i < arr.length; i++) s += arr[i];
          return s / arr.length;
        }

        function median(arr) {
          if (!arr.length) return NaN;
          const a = arr.slice().sort((x, y) => x - y);
          const mid = Math.floor(a.length / 2);
          if (a.length % 2 === 0) {
            return (a[mid - 1] + a[mid]) / 2;
          }
          return a[mid];
        }

        function fmt(x) {
          if (!isFinite(x)) return '—';
          const abs = Math.abs(x);
          if (abs !== 0 && (abs < 1e-6 || abs >= 1e6)) {
            return x.toExponential(6);
          }
          return x.toLocaleString(undefined, { maximumFractionDigits: 6 });
        }

        // Incomplete beta and F CDF (for p-values)
        function logGamma(z) {
          // Lanczos approximation
          const g = 7;
          const p = [
            0.99999999999980993,
            676.5203681218851,
            -1259.1392167224028,
            771.32342877765313,
            -176.61502916214059,
            12.507343278686905,
            -0.13857109526572012,
            9.9843695780195716e-6,
            1.5056327351493116e-7
          ];
          if (z < 0.5) {
            return Math.log(Math.PI) - Math.log(Math.sin(Math.PI * z)) - logGamma(1 - z);
          }
          z -= 1;
          let x = p[0];
          for (let i = 1; i < p.length; i++) {
            x += p[i] / (z + i);
          }
          const t = z + g + 0.5;
          return 0.5 * Math.log(2 * Math.PI) + (z + 0.5) * Math.log(t) - t + Math.log(x);
        }

        function logBeta(a, b) {
          return logGamma(a) + logGamma(b) - logGamma(a + b);
        }

        function betacf(x, a, b) {
          const MAX_ITER = 200;
          const EPS = 3e-7;
          let qab = a + b;
          let qap = a + 1.0;
          let qam = a - 1.0;
          let c = 1.0;
          let d = 1.0 - qab * x / qap;
          if (Math.abs(d) < 1e-30) d = 1e-30;
          d = 1.0 / d;
          let h = d;
          for (let m = 1; m <= MAX_ITER; m++) {
            let m2 = 2 * m;
            let aa = m * (b - m) * x / ((qam + m2) * (a + m2));
            d = 1.0 + aa * d;
            if (Math.abs(d) < 1e-30) d = 1e-30;
            c = 1.0 + aa / c;
            if (Math.abs(c) < 1e-30) c = 1e-30;
            d = 1.0 / d;
            h *= d * c;
            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));
            d = 1.0 + aa * d;
            if (Math.abs(d) < 1e-30) d = 1e-30;
            c = 1.0 + aa / c;
            if (Math.abs(c) < 1e-30) c = 1e-30;
            d = 1.0 / d;
            let del = d * c;
            h *= del;
            if (Math.abs(del - 1.0) < EPS) break;
          }
          return h;
        }

        function regularizedBeta(x, a, b) {
          if (x <= 0) return 0;
          if (x >= 1) return 1;
          const lnB = logBeta(a, b);
          const front = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - lnB) / a;
          const cf = betacf(x, a, b);
          return front * cf;
        }

        function fCdf(x, d1, d2) {
          if (x <= 0) return 0;
          const a = d1 / 2;
          const b = d2 / 2;
          const xx = (d1 * x) / (d1 * x + d2);
          return regularizedBeta(xx, a, b);
        }

        function runLevene() {
          clearError();
          resultsBox.classList.add('hidden');
          resultsBody.innerHTML = '';
          summaryEl.textContent = '';
          interpretationEl.textContent = '';
          formulaBox.classList.add('hidden');
          formulaEl.textContent = '';

          // Collect groups
          const groups = [];
          for (let i = 0; i < currentGroups; i++) {
            const ta = document.getElementById('lt-group-' + i);
            if (!ta) continue;
            const values = parseNumberList(ta.value);
            if (values.length > 0) {
              groups.push({ index: i, values });
            }
          }

          if (groups.length < 2) {
            showError('Please provide data for at least two groups (each with at least two numeric observations).');
            return;
          }

          for (let g of groups) {
            if (g.values.length < 2) {
              showError('Each active group must contain at least two numeric observations. Group ' + (g.index + 1) + ' has only ' + g.values.length + '.');
              return;
            }
          }

          const k = groups.length;
          let N = 0;
          for (let g of groups) N += g.values.length;

          if (N <= k) {
            showError('Total sample size must exceed the number of groups.');
            return;
          }

          const centerMode = centerSelect.value; // 'mean' or 'median'
          const alpha = Number(alphaSelect.value);

          // Compute Ti and Z_ij
          const groupCenters = [];
          const zGroups = [];
          const zGroupMeans = [];
          let allZ = [];

          for (let g of groups) {
            const vals = g.values;
            const center = centerMode === 'mean' ? mean(vals) : median(vals);
            groupCenters.push(center);
            const z = vals.map(x => Math.abs(x - center));
            zGroups.push(z);
            const zMean = mean(z);
            zGroupMeans.push(zMean);
            allZ = allZ.concat(z);
          }

          const overallZMean = mean(allZ);

          // ANOVA on Z
          let ssBetween = 0;
          let ssWithin = 0;
          for (let i = 0; i < k; i++) {
            const n_i = zGroups[i].length;
            const zMean_i = zGroupMeans[i];
            ssBetween += n_i * Math.pow(zMean_i - overallZMean, 2);
            for (let j = 0; j < zGroups[i].length; j++) {
              const diff = zGroups[i][j] - zMean_i;
              ssWithin += diff * diff;
            }
          }

          const dfBetween = k - 1;
          const dfWithin = N - k;

          const msBetween = ssBetween / dfBetween;
          const msWithin = ssWithin / dfWithin;
          const F = msBetween / msWithin;

          let pValue = NaN;
          try {
            const cdf = fCdf(F, dfBetween, dfWithin);
            pValue = 1 - cdf;
          } catch (e) {
            pValue = NaN;
          }

          // Fill ANOVA-like table (between and within)
          resultsBody.innerHTML = '';

          function addRow(name, df, ss, ms, fVal) {
            const tr = document.createElement('tr');
            const tdName = document.createElement('td');
            const tdDf = document.createElement('td');
            const tdSs = document.createElement('td');
            const tdMs = document.createElement('td');
            const tdF = document.createElement('td');
            tdName.className = 'px-3 py-2 text-gray-800';
            tdDf.className = 'px-3 py-2 text-gray-800';
            tdSs.className = 'px-3 py-2 text-gray-800';
            tdMs.className = 'px-3 py-2 text-gray-800';
            tdF.className = 'px-3 py-2 text-gray-800';
            tdName.textContent = name;
            tdDf.textContent = df != null ? df : '';
            tdSs.textContent = ss != null ? fmt(ss) : '';
            tdMs.textContent = ms != null ? fmt(ms) : '';
            tdF.textContent = fVal != null ? fmt(fVal) : '';
            tr.appendChild(tdName);
            tr.appendChild(tdDf);
            tr.appendChild(tdSs);
            tr.appendChild(tdMs);
            tr.appendChild(tdF);
            resultsBody.appendChild(tr);
          }

          addRow('Between groups (Levene)', dfBetween, ssBetween, msBetween, F);
          addRow('Within groups', dfWithin, ssWithin, msWithin, null);

          const centerLabel = centerMode === 'mean' ? 'group means (original Levene)' : 'group medians (Brown–Forsythe variant)';
          const pText = isFinite(pValue) ? fmt(pValue) : 'not available (numerical issue)';

          summaryEl.textContent =
            'F(' + dfBetween + ', ' + dfWithin + ') = ' + fmt(F) +
            ', p = ' + pText +
            ' using deviations from ' + centerLabel + ' across ' + k + ' groups (N = ' + N + ').';

          let decision = '';
          if (isFinite(pValue)) {
            if (pValue < alpha) {
              decision =
                'At α = ' + alpha.toString() +
                ', the p-value is smaller than α, so you <strong>reject</strong> the null hypothesis of equal variances.';
            } else {
              decision =
                'At α = ' + alpha.toString() +
                ', the p-value is greater than or equal to α, so you <strong>do not reject</strong> the null hypothesis of equal variances.';
            }
          } else {
            decision =
              'The p-value could not be computed reliably due to numerical limitations. Interpret the F statistic with caution.';
          }
          interpretationEl.innerHTML = decision;

          // Formula text
          let formulaText = '';
          if (centerMode === 'mean') {
            formulaText =
              'Z_ij = |X_ij − X̄_i|, where X̄_i is the mean of group i. ' +
              'An ANOVA is computed on Z_ij, yielding F = MS_between / MS_within with df_between = k − 1 and df_within = N − k.';
          } else {
            formulaText =
              'Z_ij = |X_ij − med_i|, where med_i is the median of group i (Brown–Forsythe version). ' +
              'An ANOVA is computed on Z_ij, yielding F = MS_between / MS_within with df_between = k − 1 and df_within = N − k.';
          }
          formulaEl.textContent = formulaText;
          formulaBox.classList.remove('hidden');

          resultsBox.classList.remove('hidden');
        }

        function setExampleData() {
          // Example: three groups with slightly different spreads
          const presets = [
            [10.2, 9.8, 10.5, 10.1, 9.9],
            [11.0, 10.7, 11.3, 10.9, 11.1],
            [9.5, 8.9, 9.8, 10.2, 9.3]
          ];
          currentGroups = 3;
          rebuildGroupCards(presets);
          centerSelect.value = 'median';
          alphaSelect.value = '0.05';
          clearError();
          resultsBox.classList.add('hidden');
          formulaBox.classList.add('hidden');
        }

        addGroupBtn.addEventListener('click', function() {
          if (currentGroups >= MAX_GROUPS) return;
          currentGroups += 1;
          rebuildGroupCards();
        });

        removeGroupBtn.addEventListener('click', function() {
          if (currentGroups <= MIN_GROUPS) return;
          currentGroups -= 1;
          rebuildGroupCards();
        });

        calcBtn.addEventListener('click', runLevene);
        resetBtn.addEventListener('click', setExampleData);

        // Initial state
        setExampleData();
      })();
    </script>


</body></html>
<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/sound-transmission-loss" />
    <title>Sound Transmission Loss [Urgent 2024] | CalcDomain</title>
    <meta name="description" content="Calculate Sound Transmission Loss Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Sound Transmission Loss [Urgent 2024] | CalcDomain" />
    <meta property="og:description" content="Calculate Sound Transmission Loss Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/sound-transmission-loss" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Sound Transmission Loss [Urgent 2024] | CalcDomain" />
    <meta name="twitter:description" content="Calculate Sound Transmission Loss Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Sound Transmission Loss (STL) Calculator – Mass Law & Multi‑Layer Walls",
        "description": "Interactive sound transmission loss (STL) calculator using mass law and simple panel models. Estimate TL vs frequency for single and double‑leaf walls, visualize curves, and learn how mass, frequency, and cavity depth affect sound insulation.",
        "url": "https://calcdomain.com/sound-transmission-loss",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://calcdomain.com"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Engineering",
              "item": "https://calcdomain.com/categories/engineering"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Sound Transmission Loss (STL) Calculator",
              "item": "https://calcdomain.com/sound-transmission-loss"
            }
          ]
        },
        "mainEntity": {
          "@type": "FAQPage",
          "name": "Sound Transmission Loss (STL) – FAQs",
          "mainEntity": [
            {
              "@type": "Question",
              "name": "What is sound transmission loss (STL)?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Sound transmission loss (STL), often just called transmission loss TL, is the difference in sound level (in decibels) between the incident sound on one side of a partition and the transmitted sound on the other side. It quantifies how much a wall, floor, door, or window reduces airborne sound passing through it."
              }
            },
            {
              "@type": "Question",
              "name": "What is the mass law for sound transmission loss?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "For a limp, non‑stiff panel in the mass‑controlled region, the mass law approximation is TL ≈ 20·log10(m · f) − 47, where m is the surface mass density in kg/m² and f is frequency in Hz. This predicts that doubling the mass per unit area or doubling the frequency increases TL by about 6 dB."
              }
            },
            {
              "@type": "Question",
              "name": "Why can transmission loss be negative?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "In theosonance when using simplified models or measurements with high uncertainty. A negative TL means the transmitted level is slightly higher than the incident reference level, often due to flanking paths, room modes, or measurement noise rather than the partition amplifying sound."
              }
            },
            {
              "@type": "Question",
              "name": "How is STL related to STC?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "STL is a frequency‑by‑frequency measure of transmission loss. Sound Transmission Class (STC) is a single‑number rating derived from the TL curve between 125 Hz and 4 kHz using a standardized contour. Higher STC generally means higher STL across mid‑band frequencies, but two constructions with the same STC can have different low‑frequency performance."
              }
            },
            {
              "@type": "Question",
              "name": "How can I increase sound transmission loss of a wall?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "To increase STL you can: add mass (heavier gypsum boards, multiple layers), decouple leaves (resilient channels, staggered studs, double‑stud walls), add absorption in the cavity (mineral wool), seal air gaps (acoustic caulk, gaskets), and avoid rigid mechanical bridges. Each of these targets a different part of the TL curve: mass helps mid/high frequencies, decoupling and damping help around resonance, and sealing gaps prevents large leaks."
              }
            }
          ]
        }
      }</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Lifestyle & Everyday Calculators", "item": "https://calcdomain.com/categories/lifestyle-everyday"}, {"@type": "ListItem", "position": 3, "name": "Miscellaneous Calculators", "item": "https://calcdomain.com/subcategories/miscellaneous"}, {"@type": "ListItem", "position": 4, "name": "Sound Transmission Loss (STL) Calculator", "item": "https://calcdomain.com/sound-transmission-loss"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-blue-600 hover:underline">Lifestyle &amp; Everyday Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/miscellaneous" class="text-blue-600 hover:underline">Miscellaneous Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Sound Transmission Loss (STL) Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl font-bold mb-2">
                Sound Transmission Loss (STL) Calculator
              </h1>
              <p class="text-gray-700">
                Estimate frequency‑dependent sound transmission loss of single
                and double‑leaf walls using the mass law and simple resonance
                models. Visualize TL vs frequency and compare design options.
              </p>
            </header>

            <!-- Calculator UI -->
            <section aria-labelledby="stl-calculator-heading" class="mb-8">
              <h2
                id="stl-calculator-heading"
                class="text-xl font-semibold mb-4"
              >
                STL Calculator
              </h2>

              <!-- Mode toggle -->
              <div class="mb-4 flex flex-wrap gap-3 items-center">
                <span class="font-medium mr-2">Wall type:</span>
                <button
                  id="mode-single"
                  type="button"
                  class="px-3 py-1 rounded-full text-sm font-medium bg-blue-600 text-white"
                >
                  Single leaf
                </button>
                <button
                  id="mode-double"
                  type="button"
                  class="px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-700"
                >
                  Double leaf (with cavity)
                </button>
              </div>

              <!-- Inputs grid -->
              <div class="grid md:grid-cols-2 gap-6 mb-6">
                <!-- Single leaf inputs -->
                <div id="single-inputs">
                  <h3 class="font-semibold mb-2">Single‑leaf panel</h3>
                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Surface mass density m (kg/m²)</span
                    >
                    <input
                      id="mass-single"
                      type="number"
                      min="1"
                      step="0.1"
                      value="20"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Example: 12.5 mm gypsum board ≈ 9–10 kg/m², double layer ≈
                      18–20 kg/m².
                    </p>
                  </label>

                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Loss factor / damping η (0–0.2)</span
                    >
                    <input
                      id="eta-single"
                      type="number"
                      min="0"
                      max="0.2"
                      step="0.005"
                      value="0.02"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Higher η (e.g. with damping layers) reduces the dip at
                      resonance.
                    </p>
                  </label>

                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Panel resonance frequency f<sub>r</sub> (Hz,
                      optional)</span
                    >
                    <input
                      id="fr-single"
                      type="number"
                      min="1"
                      step="1"
                      placeholder="e.g. 80"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      If left empty, the calculator uses pure mass law (no
                      resonance dip).
                    </p>
                  </label>
                </div>

                <!-- Double leaf inputs -->
                <div id="double-inputs" class="hidden">
                  <h3 class="font-semibold mb-2">Double‑leaf wall</h3>
                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Mass of leaf 1 m₁ (kg/m²)</span
                    >
                    <input
                      id="mass1-double"
                      type="number"
                      min="1"
                      step="0.1"
                      value="15"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                  </label>
                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Mass of leaf 2 m₂ (kg/m²)</span
                    >
                    <input
                      id="mass2-double"
                      type="number"
                      min="1"
                      step="0.1"
                      value="15"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                  </label>
                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Cavity depth d (m)</span
                    >
                    <input
                      id="cavity-depth"
                      type="number"
                      min="0.02"
                      step="0.01"
                      value="0.10"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      Stud spacing between leaves, e.g. 0.09–0.15 m.
                    </p>
                  </label>
                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Cavity absorption factor α (0–1)</span
                    >
                    <input
                      id="cavity-alpha"
                      type="number"
                      min="0"
                      max="1"
                      step="0.05"
                      value="0.5"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                    <p class="text-xs text-gray-500 mt-1">
                      0 = empty air cavity, 1 = heavily filled with mineral
                      wool.
                    </p>
                  </label>
                </div>

                <!-- Frequency range & options -->
                <div>
                  <h3 class="font-semibold mb-2">Frequency range</h3>
                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Start frequency f<sub>min</sub> (Hz)</span
                    >
                    <input
                      id="f-min"
                      type="number"
                      min="20"
                      step="10"
                      value="100"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                  </label>
                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >End frequency f<sub>max</sub> (Hz)</span
                    >
                    <input
                      id="f-max"
                      type="number"
                      min="200"
                      step="10"
                      value="5000"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                  </label>
                  <label class="block mb-3">
                    <span class="block text-sm font-medium text-gray-700"
                      >Number of points</span
                    >
                    <input
                      id="n-points"
                      type="number"
                      min="5"
                      max="200"
                      step="1"
                      value="40"
                      class="mt-1 w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                  </label>
                  <label class="inline-flex items-center mt-1">
                    <input
                      id="log-spacing"
                      type="checkbox"
                      class="mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500"
                      checked
                    />
                    <span class="text-sm text-gray-700"
                      >Logarithmic spacing (better for audio)</span
                    >
                  </label>
                </div>
              </div>

              <div class="flex flex-wrap gap-3 items-center mb-4">
                <button
                  id="calc-btn"
                  type="button"
                  class="px-4 py-2 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700"
                >
                  Calculate STL
                </button>
                <button
                  id="reset-btn"
                  type="button"
                  class="px-3 py-2 bg-gray-100 text-gray-700 font-medium rounded-md hover:bg-gray-200"
                >
                  Reset
                </button>
                <p id="error-msg" class="text-sm text-red-600"></p>
              </div>

              <!-- Key results -->
              <div id="results-summary" class="hidden mb-6">
                <h3 class="font-semibold mb-2">Key results</h3>
                <div class="grid sm:grid-cols-3 gap-4">
                  <div class="p-3 rounded-md bg-gray-50 border">
                    <div class="text-xs uppercase tracking-wide text-gray-500">
                      Reference frequency
                    </div>
                    <div class="text-lg font-semibold">
                      <span id="ref-f">500</span> Hz
                    </div>
                    <div class="text-xs text-gray-500">User‑selectable</div>
                  </div>
                  <div class="p-3 rounded-md bg-gray-50 border">
                    <div class="text-xs uppercase tracking-wide text-gray-500">
                      STL at f<sub>ref</sub>
                    </div>
                    <div class="text-lg font-semibold">
                      <span id="tl-ref">0</span> dB
                    </div>
                    <div class="text-xs text-gray-500">From model</div>
                  </div>
                  <div class="p-3 rounded-md bg-gray-50 border">
                    <div class="text-xs uppercase tracking-wide text-gray-500">
                      Approx. mass‑law slope
                    </div>
                    <div class="text-lg font-semibold">
                      <span id="slope">6</span> dB / octave
                    </div>
                    <div class="text-xs text-gray-500">Ideal ≈ 6 dB/oct</div>
                  </div>
                </div>
              </div>

              <!-- Chart -->
              <div class="mb-6">
                <h3
                  class="font-semibold mb-2 flex items-center justify-between"
                >
                  <span>STL vs frequency</span>
                  <label class="flex items-center text-xs text-gray-600">
                    Ref. frequency:
                    <select
                      id="ref-select"
                      class="ml-2 border rounded px-1 py-0.5 text-xs"
                    >
                      <option value="125">125 Hz</option>
                      <option value="250">250 Hz</option>
                      <option value="500" selected>500 Hz</option>
                      <option value="1000">1 kHz</option>
                      <option value="2000">2 kHz</option>
                      <option value="4000">4 kHz</option>
                    </select>
                  </label>
                </h3>
                <div class="bg-gray-50 border rounded-md p-3">
                  <canvas
                    id="stl-chart"
                    aria-label="Sound transmission loss vs frequency chart"
                  ></canvas>
                  <p class="text-xs text-gray-500 mt-2">
                    Log‑frequency horizontal axis (Hz), sound transmission loss
                    TL (dB) on vertical axis.
                  </p>
                </div>
              </div>

              <!-- Table -->
              <div id="table-container" class="hidden">
                <h3 class="font-semibold mb-2">Numerical values</h3>
                <div class="overflow-x-auto border rounded-md">
                  <table class="min-w-full stl-table">
                    <thead>
                      <tr>
                        <th
                          class="text-left text-xs font-semibold text-gray-600 border-b"
                        >
                          Frequency (Hz)
                        </th>
                        <th
                          class="text-left text-xs font-semibold text-gray-600 border-b"
                        >
                          STL (dB)
                        </th>
                      </tr>
                    </thead>
                    <tbody id="stl-table-body"></tbody>
                  </table>
                </div>
              </div>
            </section>

            <!-- Theory & explanation -->
            <section class="prose">
              <h2>What is sound transmission loss (STL)?</h2>
              <p>
                Sound transmission loss (STL), often written as transmission
                loss TL, is the reduction in sound level as airborne sound
                passes through a partition such as a wall, floor, door, or
                window.
              </p>
              <p>
                It is defined as the difference between the incident sound power
                on the source side and the transmitted sound power on the
                receiving side, expressed in decibels:
              </p>
              <div class="formula-box">
                \( TL = 10
                \log_{10}\!\left(\dfrac{W_\text{incident}}{W_\text{transmitted}}\right)
                \,\text{dB} \)
              </div>
              <p>
                In practice, STL is measured in a lab according to standards
                (e.g. ISO 10140, ASTM E90) and reported as a curve vs frequency.
                This calculator provides an engineering estimate based on
                simplified physical models.
              </p>

              <h2>Mass law for a single‑leaf wall</h2>
              <p>
                Above the panel’s critical and resonance frequencies, a single,
                limp panel behaves approximately according to the
                <strong>mass law</strong>. The transmission loss increases with
                both surface mass density and frequency:
              </p>
              <div class="formula-box">
                \( TL_\text{mass} \approx 20 \log_{10}(m \, f) - 47 \quad
                [\text{dB}] \)
                <br />
                where:
                <ul>
                  <li>\( m \) = surface mass density (kg/m²)</li>
                  <li>\( f \) = frequency (Hz)</li>
                </ul>
              </div>
              <p>Consequences of mass law:</p>
              <ul>
                <li>
                  Doubling the mass per unit area increases TL by ≈ 6 dB at a
                  given frequency.
                </li>
                <li>
                  Doubling the frequency also increases TL by ≈ 6 dB (slope ≈ 6
                  dB per octave).
                </li>
                <li>
                  Heavier walls are more effective at blocking mid‑ and
                  high‑frequency sound.
                </li>
              </ul>

              <h3>Including panel resonance and damping</h3>
              <p>
                Real panels are not perfectly limp. Around the panel’s
                fundamental resonance frequency \( f_r \), the TL curve shows a
                <strong>dip</strong> where sound transmission is higher than
                mass law predicts.
              </p>
              <p>
                A simple way to approximate this behavior is to subtract a
                resonance term that decays away from \( f_r \):
              </p>
              <div class="formula-box">
                \( TL(f) \approx TL_\text{mass}(f) - \Delta TL_\text{res}(f) \)
                <br /><br />
                \( \Delta TL_\text{res}(f) \approx \dfrac{K}{\sqrt{1 +
                \left(\dfrac{f - f_r}{\eta f_r}\right)^2}} \)
                <br />
                where:
                <ul>
                  <li>\( f_r \) = panel resonance frequency (Hz)</li>
                  <li>
                    \( \eta \) = loss factor (dimensionless damping, 0–0.2)
                  </li>
                  <li>
                    \( K \) = depth of the dip (dB), chosen empirically in the
                    model
                  </li>
                </ul>
              </div>
              <p>
                Higher damping (larger \( \eta \)) spreads and shallows the dip,
                improving STL around resonance. Damping can be increased with
                constrained‑layer damping, viscoelastic layers, or resilient
                mounting.
              </p>

              <h2>Double‑leaf walls and cavity resonance</h2>
              <p>
                Double‑leaf constructions (e.g. two gypsum boards on separate
                studs with an air cavity) can provide significantly higher STL
                than a single leaf of the same total mass, especially at mid and
                high frequencies.
              </p>
              <p>
                However, they introduce an additional
                <strong>mass–air–mass resonance</strong> at a low frequency \(
                f_0 \), where STL drops sharply.
              </p>
              <div class="formula-box">
                For two equal leaves with mass \( m_1 \) and \( m_2 \) and
                cavity depth \( d \):
                <br /><br />
                \( f_0 \approx \dfrac{c}{2\pi} \sqrt{\dfrac{S}{m_1 + m_2}} \)
                <br />
                where \( S \) is the acoustic stiffness of the air cavity, which
                is inversely proportional to \( d \), and \( c \) is the speed
                of sound in air.
              </div>
              <p>
                Above the mass–air–mass resonance, the TL of a double‑leaf wall
                can be approximated as:
              </p>
              <div class="formula-box">
                \( TL_\text{double}(f) \approx 20 \log_{10}\big((m_1 + m_2)
                f\big) - 47 + \Delta TL_\text{cavity}(f, \alpha) \)
              </div>
              <p>
                where \( \Delta TL_\text{cavity} \) is an additional term that
                depends on cavity depth and absorption (modeled here with the
                cavity absorption factor α).
              </p>
              <p>
                Filling the cavity with mineral wool (higher α) damps the
                mass–air–mass resonance and raises STL around and above \( f_0
                \).
              </p>

              <h2>How this calculator models STL</h2>
              <p>
                This tool is designed as an
                <strong>engineering approximation</strong>, not a replacement
                for lab measurements or full finite‑element / boundary‑element
                simulations.
              </p>
              <h3>Single‑leaf mode</h3>
              <ul>
                <li>
                  Base TL from the mass law: \( TL_\text{mass} = 20 \log_{10}(m
                  f) - 47 \).
                </li>
                <li>
                  Optional resonance dip around user‑specified \( f_r \) with
                  depth and width controlled by η.
                </li>
                <li>
                  No coincidence dip (critical frequency) is modeled; this is a
                  mid‑band approximation.
                </li>
              </ul>

              <h3>Double‑leaf mode</h3>
              <ul>
                <li>
                  Effective mass \( m_\text{eff} = m_1 + m_2 \) for the mass‑law
                  term.
                </li>
                <li>
                  Approximate mass–air–mass resonance frequency based on cavity
                  depth.
                </li>
                <li>
                  Resonance dip whose depth is reduced as cavity absorption
                  factor α increases.
                </li>
              </ul>
              <p>
                The goal is to give you
                <strong>qualitative insight</strong> into how mass, frequency,
                cavity depth, and damping affect STL, and to help compare design
                options, not to produce certification‑grade data.
              </p>

              <h2>Interpreting the results</h2>
              <ul>
                <li>
                  <strong>Low frequencies (below 125 Hz)</strong> are the
                  hardest to block. Even heavy walls may show modest STL.
                </li>
                <li>
                  <strong>Mid frequencies (250–2000 Hz)</strong> are where mass
                  law works well and where speech and many noises lie.
                </li>
                <li>
                  <strong>High frequencies (&gt; 2 kHz)</strong> are usually
                  easier to attenuate; small leaks can still dominate.
                </li>
              </ul>
              <p>
                The calculator’s slope indicator compares the modeled TL
                increase per octave to the ideal 6 dB/oct mass‑law slope.
                Deviations indicate the influence of resonance or limitations of
                the simplified model.
              </p>

              <h2>STL vs STC and other ratings</h2>
              <p>
                STL is a <strong>frequency‑dependent</strong> quantity. Building
                codes and product datasheets often use single‑number ratings
                derived from STL curves:
              </p>
              <ul>
                <li>
                  <strong>STC (Sound Transmission Class)</strong> – North
                  American rating for walls, floors, doors.
                </li>
                <li>
                  <strong>Rw</strong> – European single‑number rating similar to
                  STC.
                </li>
                <li>
                  <strong>OITC</strong> – Outdoor–Indoor Transmission Class,
                  more sensitive to low frequencies.
                </li>
              </ul>
              <p>
                This calculator does not compute STC directly, but you can
                visually compare the TL curve to typical STC reference curves to
                get a rough idea of performance.
              </p>

              <h2>Practical tips to improve sound transmission loss</h2>
              <ul>
                <li>
                  <strong>Add mass</strong> – double or triple layers of gypsum
                  board, denser materials, or constrained‑layer damping.
                </li>
                <li>
                  <strong>Decouple leaves</strong> – use resilient channels,
                  staggered studs, or double‑stud walls to reduce mechanical
                  coupling.
                </li>
                <li>
                  <strong>Fill cavities</strong> – add mineral wool or
                  fiberglass to increase absorption and damp resonances.
                </li>
                <li>
                  <strong>Seal gaps</strong> – use acoustic sealant around
                  perimeters, electrical boxes, and penetrations.
                </li>
                <li>
                  <strong>Control flanking paths</strong> – treat ceilings,
                  floors, and side walls to avoid sound bypassing the main
                  partition.
                </li>
              </ul>

              <h2>Limitations and assumptions</h2>
              <ul>
                <li>
                  Normal incidence and diffuse field effects are simplified.
                </li>
                <li>
                  Coincidence effects and detailed modal behavior are not
                  modeled.
                </li>
                <li>
                  Material properties are represented only by mass, damping, and
                  simple cavity parameters.
                </li>
                <li>
                  Results should be used for
                  <strong>preliminary design and education</strong>, not for
                  code compliance.
                </li>
              </ul>
            </section>

            <!-- FAQ -->
            <section class="mt-8">
              <h2 class="text-xl font-semibold mb-4">
                Sound transmission loss – FAQ
              </h2>
              <div class="space-y-3" id="faq-container">
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    What is sound transmission loss (STL)?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    STL (or TL) is the difference in sound level between the
                    incident sound on one side of a partition and the
                    transmitted sound on the other side, expressed in dB. Higher
                    STL means better airborne sound insulation.
                  </p>
                </details>
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    What units are used in the STL formulas?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    The mass law formula assumes surface mass density in kg/m²
                    and frequency in Hz. The result is TL in decibels (dB).
                    Using other units (e.g. lb/ft²) requires converting to SI
                    units first.
                  </p>
                </details>
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Why does the calculator show a dip in STL at some frequency?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    That dip corresponds to a resonance: for a single leaf, the
                    panel’s fundamental resonance; for a double leaf, the
                    mass–air–mass resonance of the two leaves and the air
                    cavity. Around resonance, the partition vibrates more and
                    transmits more sound, reducing TL.
                  </p>
                </details>
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    Can STL be negative?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    In theory, STL is non‑negative. However, simplified models
                    or noisy measurements can yield slightly negative values at
                    very low frequencies or near resonance. This usually
                    indicates that the model is outside its valid range or that
                    flanking paths and room effects dominate.
                  </p>
                </details>
                <details class="border rounded-md p-3">
                  <summary class="font-medium cursor-pointer">
                    How accurate is this STL calculator?
                  </summary>
                  <p class="mt-2 text-sm text-gray-700">
                    It is a simplified engineering tool based on mass law and
                    basic resonance approximations. It is useful for
                    understanding trends and comparing design options, but it
                    will not match laboratory test data exactly. For critical
                    projects, always refer to measured TL curves or detailed
                    simulations.
                  </p>
                </details>
              </div>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Surface mass density m (kg/m²) Example: 12.5 mm gypsum board ≈ 9–10 kg/m², double layer ≈ 18–20 kg/m².</li><li>Loss factor / damping η (0–0.2) Higher η (e.g. with damping layers) reduces the dip at resonance.</li><li>Panel resonance frequency f r (Hz, optional) If left empty, the calculator uses pure mass law (no resonance dip).</li><li>Mass of leaf 1 m₁ (kg/m²)</li><li>Mass of leaf 2 m₂ (kg/m²)</li><li>Cavity depth d (m) Stud spacing between leaves, e.g. 0.09–0.15 m.</li><li>Cavity absorption factor α (0–1) 0 = empty air cavity, 1 = heavily filled with mineral wool.</li><li>Start frequency f min (Hz)</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Sound, Transmission, Loss, Surface mass density m (kg/m²) Example: 12.5 mm gypsum board ≈ 9–10 kg/m², double layer ≈ 18–20 kg/m²., Loss factor / damping η (0–0.2) Higher η (e.g. with damping layers) reduces the dip at resonance., Panel resonance frequency f r (Hz, optional) If left empty, the calculator uses pure mass law (no resonance dip)., Mass of leaf 1 m₁ (kg/m²), Mass of leaf 2 m₂ (kg/m²).</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Surface mass density m (kg/m²) Example: 12.5 mm gypsum board ≈ 9–10 kg/m², double layer ≈ 18–20 kg/m².</li><li>Loss factor / damping η (0–0.2) Higher η (e.g. with damping layers) reduces the dip at resonance.</li><li>Panel resonance frequency f r (Hz, optional) If left empty, the calculator uses pure mass law (no resonance dip).</li><li>Mass of leaf 1 m₁ (kg/m²)</li><li>Mass of leaf 2 m₂ (kg/m²)</li><li>Cavity depth d (m) Stud spacing between leaves, e.g. 0.09–0.15 m.</li><li>Cavity absorption factor α (0–1) 0 = empty air cavity, 1 = heavily filled with mineral wool.</li><li>Start frequency f min (Hz)</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>

        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Engineering Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/sound-intensity-level"
                  class="text-blue-600 hover:underline"
                  >Sound Intensity Level</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/reverberation-time"
                  class="text-blue-600 hover:underline"
                  >Reverberation Time (Sabine)</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/decibel"
                  class="text-blue-600 hover:underline"
                  >Noise Level (Decibel) Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/room-mode"
                  class="text-blue-600 hover:underline"
                  >Room Mode Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/standard-atmosphere"
                  class="text-blue-600 hover:underline"
                  >Standard Atmosphere</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/heat-index"
                  class="text-blue-600 hover:underline"
                  >Heat Index</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/pressure"
                  class="text-blue-600 hover:underline"
                  >Pressure Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/kinetic-energy"
                  class="text-blue-600 hover:underline"
                  >Kinetic Energy</a
                >
              </li>
            </ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Engineering Categories</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/categories/engineering"
                  class="text-blue-600 hover:underline"
                  >All Engineering Calculators</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/civil"
                  class="text-blue-600 hover:underline"
                  >Civil Engineering</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/mechanical-engineering"
                  class="text-blue-600 hover:underline"
                  >Mechanical Engineering</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/electrical"
                  class="text-blue-600 hover:underline"
                  >Electrical & Electronics</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/conversions-power-and-lighting"
                  class="text-blue-600 hover:underline"
                  >Power & Lighting Conversions</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>

    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>

    <!-- Chart.js for plotting -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <script>
      (function () {
        const c = 343; // speed of sound (m/s), used for rough resonance estimates

        const modeSingleBtn = document.getElementById("mode-single");
        const modeDoubleBtn = document.getElementById("mode-double");
        const singleInputs = document.getElementById("single-inputs");
        const doubleInputs = document.getElementById("double-inputs");

        const massSingleEl = document.getElementById("mass-single");
        const etaSingleEl = document.getElementById("eta-single");
        const frSingleEl = document.getElementById("fr-single");

        const mass1DoubleEl = document.getElementById("mass1-double");
        const mass2DoubleEl = document.getElementById("mass2-double");
        const cavityDepthEl = document.getElementById("cavity-depth");
        const cavityAlphaEl = document.getElementById("cavity-alpha");

        const fMinEl = document.getElementById("f-min");
        const fMaxEl = document.getElementById("f-max");
        const nPointsEl = document.getElementById("n-points");
        const logSpacingEl = document.getElementById("log-spacing");

        const calcBtn = document.getElementById("calc-btn");
        const resetBtn = document.getElementById("reset-btn");
        const errorMsgEl = document.getElementById("error-msg");

        const resultsSummary = document.getElementById("results-summary");
        const refFEl = document.getElementById("ref-f");
        const tlRefEl = document.getElementById("tl-ref");
        const slopeEl = document.getElementById("slope");
        const refSelect = document.getElementById("ref-select");

        const tableContainer = document.getElementById("table-container");
        const tableBody = document.getElementById("stl-table-body");

        let currentMode = "single";
        let chart;
        let lastData = null;

        function setMode(mode) {
          currentMode = mode;
          if (mode === "single") {
            modeSingleBtn.classList.add("bg-blue-600", "text-white");
            modeSingleBtn.classList.remove("bg-gray-100", "text-gray-700");
            modeDoubleBtn.classList.add("bg-gray-100", "text-gray-700");
            modeDoubleBtn.classList.remove("bg-blue-600", "text-white");
            singleInputs.classList.remove("hidden");
            doubleInputs.classList.add("hidden");
          } else {
            modeDoubleBtn.classList.add("bg-blue-600", "text-white");
            modeDoubleBtn.classList.remove("bg-gray-100", "text-gray-700");
            modeSingleBtn.classList.add("bg-gray-100", "text-gray-700");
            modeSingleBtn.classList.remove("bg-blue-600", "text-white");
            singleInputs.classList.add("hidden");
            doubleInputs.classList.remove("hidden");
          }
          errorMsgEl.textContent = "";
        }

        modeSingleBtn.addEventListener("click", () => setMode("single"));
        modeDoubleBtn.addEventListener("click", () => setMode("double"));

        function generateFrequencies(fMin, fMax, n, logSpacing) {
          const freqs = [];
          if (logSpacing) {
            const logMin = Math.log10(fMin);
            const logMax = Math.log10(fMax);
            const step = (logMax - logMin) / (n - 1);
            for (let i = 0; i < n; i++) {
              freqs.push(Math.pow(10, logMin + step * i));
            }
          } else {
            const step = (fMax - fMin) / (n - 1);
            for (let i = 0; i < n; i++) {
              freqs.push(fMin + step * i);
            }
          }
          return freqs;
        }

        function tlMassLaw(m, f) {
          return 20 * Math.log10(m * f) - 47;
        }

        function resonanceDip(f, fr, eta, depth) {
          if (!fr || fr <= 0 || eta <= 0) return 0;
          const x = (f - fr) / (eta * fr);
          return depth / Math.sqrt(1 + x * x);
        }

        function computeSingleLeaf() {
          const m = parseFloat(massSingleEl.value);
          const eta = parseFloat(etaSingleEl.value);
          const fr = parseFloat(frSingleEl.value);

          if (!isFinite(m) || m <= 0)
            throw new Error("Mass must be a positive number.");
          if (!isFinite(eta) || eta < 0 || eta > 0.2)
            throw new Error("Loss factor η must be between 0 and 0.2.");

          const fMin = parseFloat(fMinEl.value);
          const fMax = parseFloat(fMaxEl.value);
          const n = parseInt(nPointsEl.value, 10);
          if (!(fMin > 0 && fMax > fMin))
            throw new Error("Frequency range must be valid and f_max > f_min.");
          if (!(n >= 5 && n <= 200))
            throw new Error("Number of points must be between 5 and 200.");

          const freqs = generateFrequencies(
            fMin,
            fMax,
            n,
            logSpacingEl.checked
          );
          const tls = freqs.map((f) => {
            let tl = tlMassLaw(m, f);
            if (isFinite(fr)) {
              const depth = 12; // dB dip depth parameter
              tl -= resonanceDip(f, fr, eta || 0.02, depth);
            }
            return tl;
          });

          return { freqs, tls };
        }

        function computeDoubleLeaf() {
          const m1 = parseFloat(mass1DoubleEl.value);
          const m2 = parseFloat(mass2DoubleEl.value);
          const d = parseFloat(cavityDepthEl.value);
          const alpha = parseFloat(cavityAlphaEl.value);

          if (!isFinite(m1) || m1 <= 0 || !isFinite(m2) || m2 <= 0)
            throw new Error("Leaf masses must be positive.");
          if (!isFinite(d) || d <= 0)
            throw new Error("Cavity depth must be positive.");
          if (!isFinite(alpha) || alpha < 0 || alpha > 1)
            throw new Error(
              "Cavity absorption factor must be between 0 and 1."
            );

          const fMin = parseFloat(fMinEl.value);
          const fMax = parseFloat(fMaxEl.value);
          const n = parseInt(nPointsEl.value, 10);
          if (!(fMin > 0 && fMax > fMin))
            throw new Error("Frequency range must be valid and f_max > f_min.");
          if (!(n >= 5 && n <= 200))
            throw new Error("Number of points must be between 5 and 200.");

          const freqs = generateFrequencies(
            fMin,
            fMax,
            n,
            logSpacingEl.checked
          );

          const mEff = m1 + m2;
          // Rough mass–air–mass resonance estimate: f0 ~ c / (2π) * sqrt(1 / (d * (1/m1 + 1/m2)))
          const f0 =
            (c / (2 * Math.PI)) * Math.sqrt(1 / (d * (1 / m1 + 1 / m2)));

          const tls = freqs.map((f) => {
            let tl = tlMassLaw(mEff, f);

            // Mass–air–mass resonance dip
            const etaBase = 0.03;
            const eta = etaBase + 0.15 * alpha; // more absorption -> higher damping
            const depth = 18 * (1 - alpha); // empty cavity: deep dip, filled: shallow
            tl -= resonanceDip(f, f0, eta, depth);

            // Simple cavity benefit above resonance
            if (f > f0 * 1.5) {
              const extra =
                5 * (1 - Math.exp(-(f - f0) / (3 * f0))) * (0.5 + 0.5 * alpha);
              tl += extra;
            }

            return tl;
          });

          return { freqs, tls, f0 };
        }

        function updateChart(freqs, tls) {
          const ctx = document.getElementById("stl-chart").getContext("2d");
          const data = freqs.map((f, i) => ({ x: f, y: tls[i] }));

          if (chart) {
            chart.data.datasets[0].data = data;
            chart.options.scales.x.type = "logarithmic";
            chart.update();
            return;
          }

          chart = new Chart(ctx, {
            type: "line",
            data: {
              datasets: [
                {
                  label: "STL",
                  data,
                  borderColor: "#2563eb",
                  backgroundColor: "rgba(37, 99, 235, 0.1)",
                  tension: 0.15,
                  pointRadius: 0,
                  borderWidth: 2,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              interaction: { mode: "nearest", intersect: false },
              plugins: {
                legend: { display: false },
                tooltip: {
                  callbacks: {
                    label: (ctx) =>
                      `STL: ${ctx.parsed.y.toFixed(
                        1
                      )} dB at ${ctx.parsed.x.toFixed(0)} Hz`,
                  },
                },
              },
              scales: {
                x: {
                  type: "logarithmic",
                  title: { display: true, text: "Frequency (Hz)" },
                  ticks: {
                    callback: (val) => {
                      const v = Number(val);
                      if (
                        [
                          20, 50, 100, 200, 500, 1000, 2000, 5000, 10000,
                        ].includes(v)
                      )
                        return v >= 1000 ? v / 1000 + "k" : v;
                      return "";
                    },
                  },
                },
                y: {
                  title: {
                    display: true,
                    text: "Sound Transmission Loss TL (dB)",
                  },
                },
              },
            },
          });
        }

        function updateTable(freqs, tls) {
          tableBody.innerHTML = "";
          freqs.forEach((f, i) => {
            const tr = document.createElement("tr");
            const tdF = document.createElement("td");
            const tdTL = document.createElement("td");
            tdF.textContent = f.toFixed(0);
            tdTL.textContent = tls[i].toFixed(1);
            tdF.className = "border-b text-gray-700";
            tdTL.className = "border-b text-gray-700";
            tr.appendChild(tdF);
            tr.appendChild(tdTL);
            tableBody.appendChild(tr);
          });
          tableContainer.classList.remove("hidden");
        }

        function findClosestIndex(freqs, target) {
          let idx = 0;
          let bestDiff = Infinity;
          freqs.forEach((f, i) => {
            const diff = Math.abs(f - target);
            if (diff < bestDiff) {
              bestDiff = diff;
              idx = i;
            }
          });
          return idx;
        }

        function updateSummary(freqs, tls) {
          const refFreq = parseFloat(refSelect.value);
          const idxRef = findClosestIndex(freqs, refFreq);
          refFEl.textContent = freqs[idxRef].toFixed(0);
          tlRefEl.textContent = tls[idxRef].toFixed(1);

          // Approximate slope between 500 Hz and 1000 Hz if within range
          const f1 = 500,
            f2 = 1000;
          if (freqs[0] <= f1 && freqs[freqs.length - 1] >= f2) {
            const i1 = findClosestIndex(freqs, f1);
            const i2 = findClosestIndex(freqs, f2);
            const slope =
              (tls[i2] - tls[i1]) / (Math.log2(freqs[i2] / freqs[i1]) || 1);
            slopeEl.textContent = slope.toFixed(1);
          } else {
            slopeEl.textContent = "–";
          }

          resultsSummary.classList.remove("hidden");
        }

        refSelect.addEventListener("change", () => {
          if (lastData) {
            updateSummary(lastData.freqs, lastData.tls);
          }
        });

        calcBtn.addEventListener("click", () => {
          errorMsgEl.textContent = "";
          try {
            let result;
            if (currentMode === "single") {
              result = computeSingleLeaf();
            } else {
              result = computeDoubleLeaf();
            }
            lastData = result;
            updateChart(result.freqs, result.tls);
            updateTable(result.freqs, result.tls);
            updateSummary(result.freqs, result.tls);
          } catch (e) {
            errorMsgEl.textContent = e.message;
          }
        });

        resetBtn.addEventListener("click", () => {
          massSingleEl.value = 20;
          etaSingleEl.value = 0.02;
          frSingleEl.value = "";
          mass1DoubleEl.value = 15;
          mass2DoubleEl.value = 15;
          cavityDepthEl.value = 0.1;
          cavityAlphaEl.value = 0.5;
          fMinEl.value = 100;
          fMaxEl.value = 5000;
          nPointsEl.value = 40;
          logSpacingEl.checked = true;
          refSelect.value = "500";
          errorMsgEl.textContent = "";
          resultsSummary.classList.add("hidden");
          tableContainer.classList.add("hidden");
          if (chart) {
            chart.data.datasets[0].data = [];
            chart.update();
          }
          lastData = null;
        });

        // Initial mode
        setMode("single");
      })();
    </script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

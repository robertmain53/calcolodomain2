<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="canonical" href="https://calcdomain.com/bridge-loan-calculator">
    <title>Bridge Loan Calculator: Interest-Only, Retained &amp; Rolled-Up | CalcDomain</title>
    <meta name="description" content="Professional bridge loan calculator with LTV, fees, serviced/retained/rolled-up interest, net advance, redemption amount, and APR (IRR). Print a clean schedule.">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <meta property="og:type" content="website">
    <meta property="og:title" content="Bridge Loan Calculator: Interest-Only, Retained &amp; Rolled-Up | CalcDomain">
    <meta property="og:description" content="Professional bridge loan calculator with LTV, fees, serviced/retained/rolled-up interest, net advance, redemption amount, and APR (IRR). Print a clean schedule.">
    <meta property="og:url" content="https://calcdomain.com/bridge-loan-calculator">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Bridge Loan Calculator: Interest-Only, Retained &amp; Rolled-Up | CalcDomain">
    <meta name="twitter:description" content="Professional bridge loan calculator with LTV, fees, serviced/retained/rolled-up interest, net advance, redemption amount, and APR (IRR). Print a clean schedule.">

    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
    <style>
        body { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif; }
        header#siteHeader { background: #fff; border-bottom: 1px solid #e5e7eb; }
        #mainContent { max-width: 1100px; }
        .card { background: white; border: 1px solid #e5e7eb; border-radius: 1rem; padding: 1.5rem; box-shadow: 0px 12px 40px rgba(15, 23, 42, 0.08); }
        .calc-hero { display: grid; gap: 1.5rem; }
        @media (min-width: 1024px) { .calc-hero { grid-template-columns: minmax(0, 1fr) minmax(0, 1fr); align-items: start; } }
        .calc-input { width: 100%; padding: 0.65rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-size: 0.95rem; }
        .calc-input:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2); }
        .calc-label { font-size: 0.875rem; font-weight: 600; color: #4b5563; margin-bottom: 0.35rem; display: block; }
        .result-box { background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%); border: 1px solid #c7d2fe; border-radius: 0.75rem; padding: 1.5rem; text-align: center; }
        .result-value { font-size: 2.25rem; font-weight: 800; color: #1d4ed8; }
        .kpi-row { display: flex; justify-content: space-between; padding: 0.65rem 0; border-bottom: 1px solid #e5e7eb; font-size: 0.95rem; }
        .kpi-row:last-child { border-bottom: none; }
        .kpi-label { color: #6b7280; }
        .kpi-value { font-weight: 700; color: #111827; }
        .btn { display: inline-flex; justify-content: center; align-items: center; font-weight: 700; border-radius: 0.5rem; padding: 0.7rem 1rem; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .btn-primary { background: #2563eb; color: white; border: none; }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 10px 20px rgba(37, 99, 235, 0.25); }
        .btn-secondary { border: 1px solid #d1d5db; background: white; color: #374151; }
        .btn-secondary:hover { background: #f9fafb; }
        .alert { display: none; padding: 0.85rem 1rem; margin-top: 1rem; border-radius: 0.5rem; font-size: 0.95rem; }
        .alert-error { background: #fef2f2; border: 1px solid #fecaca; color: #991b1b; }
        .schedule-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        .schedule-table th, .schedule-table td { padding: 0.75rem; border-bottom: 1px solid #e5e7eb; text-align: left; }
        .schedule-table th { background: #f1f5f9; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; }
        .tableWrap { border: 1px solid #e5e7eb; border-radius: 1rem; padding: 1rem; background: #fff; }
        .sticky-box { position: sticky; top: 1.5rem; }
        .content-card h2 { font-size: 1.5rem; font-weight: 600; }
        .meta-section summary { cursor: pointer; font-weight: 700; display: flex; justify-content: space-between; }
        .meta-section details div { font-size: 0.95rem; }
        .badge-row span { display: inline-flex; align-items: center; gap: 0.35rem; border: 1px solid #e5e7eb; background: white; border-radius: 999px; padding: 0.35rem 0.9rem; font-size: 0.9rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Bridge Loan Calculator",
        "url": "https://calcdomain.com/bridge-loan-calculator",
        "description": "Calculate bridge loan costs with LTV, fees, serviced/retained/rolled-up interest, net advance, redemption, and APR (IRR).",
        "inLanguage": "en",
        "reviewedBy": { "@type": "Person", "name": "Ugo Candido" },
        "dateModified": "2026-01-19"
      }</script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com" },
        { "@type": "ListItem", "position": 2, "name": "Finance", "item": "https://calcdomain.com/categories/finance" },
        { "@type": "ListItem", "position": 3, "name": "Loans Debt", "item": "https://calcdomain.com/subcategories/loans-debt" }
      ]
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to calculate bridge loan costs",
      "description": "Steps to compute net advance, monthly interest, total fees, redemption amount, and APR for a bridge loan.",
      "step": [
        { "@type": "HowToStep", "name": "Enter property value & LTV", "text": "Provide the asset value and maximum LTV to estimate the permissible gross loan." },
        { "@type": "HowToStep", "name": "Set gross loan & term", "text": "Adjust the gross loan and term in months to match the offer or target scenario." },
        { "@type": "HowToStep", "name": "Choose interest method", "text": "Select serviced, retained, or rolled-up interest and set the monthly interest rate." },
        { "@type": "HowToStep", "name": "Add fees", "text": "Include arrangement, broker, exit, valuation and legal fees; choose if capitalised or paid upfront." },
        { "@type": "HowToStep", "name": "Review results", "text": "Check net advance, monthly payments, total interest, total fees, redemption amount, and APR (IRR)." }
      ]
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        { "@type": "Question", "name": "What’s the difference between serviced, retained, and rolled-up interest?", "acceptedAnswer": { "@type": "Answer", "text": "Serviced means you pay interest each month; retained deducts all interest up front from the advance; rolled-up accrues and compounds to redemption." } },
        { "@type": "Question", "name": "How is APR estimated here?", "acceptedAnswer": { "@type": "Answer", "text": "APR is the internal rate of return (IRR) of cash flows considering the net advance, any monthly interest paid, and the redemption payment, annualised to 12 months." } },
        { "@type": "Question", "name": "Does LTV cap reduce my requested loan?", "acceptedAnswer": { "@type": "Answer", "text": "Yes. If your requested gross loan exceeds the LTV cap, the calculator trims it to the maximum allowed." } },
        { "@type": "Question", "name": "Are fees added to the loan or paid upfront?", "acceptedAnswer": { "@type": "Answer", "text": "You can choose either. Capitalised fees increase the redemption amount; upfront fees reduce the net cash you receive." } },
        { "@type": "Question", "name": "Can I model an exit fee as a percentage?", "acceptedAnswer": { "@type": "Answer", "text": "Yes. Set the exit fee percent; it is applied to the gross loan and added to the redemption payment." } },
        { "@type": "Question", "name": "What currencies does this support?", "acceptedAnswer": { "@type": "Answer", "text": "Values are formatted to your locale currency for display; the math is currency-agnostic." } },
        { "@type": "Question", "name": "Is day-count convention configurable?", "acceptedAnswer": { "@type": "Answer", "text": "This tool models monthly periods. For daily accrual, approximate by converting your nominal rate to an equivalent monthly rate." } }
      ]
    }
    </script>
</head>
<body class="bg-gray-50 text-gray-900">

    <header id="siteHeader" class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="nav container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a class="brand text-2xl font-bold text-blue-600" href="https://calcdomain.com">CalcDomain</a>
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input type="search" id="search-input" placeholder="Search for a calculator..." class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" autocomplete="off">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
          </div>
          <div class="navRight hidden md:flex items-center space-x-6">
            <a class="pill text-gray-700 hover:text-blue-600 transition-colors" href="https://calcdomain.com/search">Advanced Search</a>
            <span class="pill text-gray-700 hover:text-blue-600 transition-colors">Categories</span>
          </div>
          <button id="mobile-menu-toggle" class="md:hidden p-2" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open menu" type="button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
        <nav id="mobile-menu" class="md:hidden mt-4 hidden" aria-label="Mobile menu" role="navigation">
          <div class="mb-4">
            <div class="relative">
              <input type="search" id="mobile-search-input" placeholder="Search calculators..." class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a href="https://calcdomain.com/search" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
            <a href="https://calcdomain.com/#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
          </div>
        </nav>
      </nav>
    </header>

    <main id="mainContent" class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
        <ol class="flex flex-wrap items-center gap-1">
          <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
          <li class="text-gray-400">/</li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-blue-600 hover:underline">Finance Calculators</a></li>
          <li class="text-gray-400">/</li>
          <li><span class="text-gray-800">Bridge Loan Calculator</span></li>
        </ol>
      </nav>

      <div class="space-y-3">
        <h1 id="pageTitle" class="text-3xl font-bold text-gray-900">Bridge Loan Calculator: Interest-Only, Retained &amp; Rolled-Up</h1>
        <p id="pageSub" class="sub text-lg text-gray-600">Professional bridge loan calculator with LTV, fees, serviced/retained/rolled-up interest, net advance, redemption amount, and APR (IRR). Print a clean schedule.</p>
        <div id="errorBox" class="alert alert-error" role="alert" aria-live="polite"></div>
      </div>

      <div class="calc-hero mt-8" id="calcHero" aria-label="Calculator hero">
        <section class="card" id="inputsCard" aria-label="Calculator inputs">
          <div class="space-y-6">
            <div>
              <h3 class="text-lg font-bold text-gray-700">Loan &amp; Property Details</h3>
              <p class="text-sm text-gray-500 mt-1">Populate the asset value, requested loan, and interest assumptions. LTV caps adjust the gross loan automatically.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="propertyValue" class="calc-label">Property Value</label>
                <input id="propertyValue" type="number" class="calc-input" value="1200000" step="1000" min="0" inputmode="decimal">
              </div>
              <div>
                <label for="ltv" class="calc-label">Loan-to-Value (%)</label>
                <input id="ltv" type="number" class="calc-input" value="65" step="0.5" min="0" max="100" inputmode="decimal">
                <p id="ltvErr" class="text-xs text-red-600 mt-1"></p>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="grossLoan" class="calc-label">Gross Loan Requested</label>
                <input id="grossLoan" type="number" class="calc-input" value="780000" step="1000" min="0" inputmode="decimal">
                <p id="glErr" class="text-xs text-red-600 mt-1"></p>
              </div>
              <div>
                <label for="termMonths" class="calc-label">Term (months)</label>
                <input id="termMonths" type="number" class="calc-input" value="18" step="1" min="1" max="60" inputmode="numeric">
                <p id="tmErr" class="text-xs text-red-600 mt-1"></p>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="rateMonthly" class="calc-label">Monthly Interest Rate (%)</label>
                <input id="rateMonthly" type="number" class="calc-input" value="1.25" step="0.01" min="0" inputmode="decimal">
                <p id="rmErr" class="text-xs text-red-600 mt-1"></p>
              </div>
              <div>
                <label for="interestMethod" class="calc-label">Interest Method</label>
                <select id="interestMethod" class="calc-input">
                  <option value="serviced" selected>Serviced (interest paid monthly)</option>
                  <option value="retained">Retained (interest deducted up front)</option>
                  <option value="rolled">Rolled-up (interest compounds to redemption)</option>
                </select>
              </div>
            </div>
            <div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="arrFeePct" class="calc-label">Arrangement Fee (%)</label>
                  <input id="arrFeePct" type="number" class="calc-input" value="1" step="0.1" min="0" inputmode="decimal">
                </div>
                <div>
                  <label for="arrFeeMode" class="calc-label">Arrangement Fee Mode</label>
                  <select id="arrFeeMode" class="calc-input">
                    <option value="upfront" selected>Upfront</option>
                    <option value="capitalised">Capitalised into redemption</option>
                  </select>
                </div>
              </div>
              <p class="text-xs text-gray-500 mt-2">Capitalised retains the fee on the redemption side; upfront fees shrink the cash you receive.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="brokerFeePct" class="calc-label">Broker Fee (%)</label>
                <input id="brokerFeePct" type="number" class="calc-input" value="0.5" step="0.1" min="0" inputmode="decimal">
              </div>
              <div>
                <label for="exitFeePct" class="calc-label">Exit Fee (%)</label>
                <input id="exitFeePct" type="number" class="calc-input" value="2" step="0.1" min="0" inputmode="decimal">
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="valuationFee" class="calc-label">Valuation Fee (currency)</label>
                <input id="valuationFee" type="number" class="calc-input" value="1200" step="100" min="0" inputmode="decimal">
              </div>
              <div>
                <label for="legalFee" class="calc-label">Legal Fee (currency)</label>
                <input id="legalFee" type="number" class="calc-input" value="1500" step="100" min="0" inputmode="decimal">
              </div>
            </div>
            <div>
              <label for="startMonth" class="calc-label">Schedule start month</label>
              <input id="startMonth" type="month" class="calc-input" value="2026-02">
              <p class="text-xs text-gray-500 mt-1">Set the first payment date to align the amortization schedule.</p>
            </div>

            <div class="flex gap-3">
              <button class="btn btn-primary flex-1" id="calcBtn" type="button">Calculate</button>
              <button class="btn btn-secondary flex-1 btnSecondary" id="resetBtn" type="button">Reset</button>
            </div>
          </div>
          <div data-canon-btnrow="1" style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;"></div>
        </section>

        <section class="card sticky-box" id="resultsCard" aria-label="Calculator results">
          <div class="result-box mb-4">
            <div class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">Net advance to borrower</div>
            <div class="result-value" id="netAdvance">$0.00</div>
            <p class="text-sm text-gray-600 mt-2" id="advanceNote">Cash proceeds after fees and retained interest.</p>
          </div>

          <div class="bg-white border border-gray-200 rounded-lg p-4">
            <div class="kpi-row">
              <span class="kpi-label">Monthly interest</span>
              <span class="kpi-value" id="monthlyInterest">—</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Total fees</span>
              <span class="kpi-value" id="totalFees">—</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Total interest cost</span>
              <span class="kpi-value" id="totalInterest">—</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Redemption amount</span>
              <span class="kpi-value" id="redemptionAmount">—</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">Payments created</span>
              <span class="kpi-value" id="paymentCount">—</span>
            </div>
            <div class="kpi-row">
              <span class="kpi-label">APR / IRR</span>
              <span class="kpi-value" id="aprIrr">—</span>
            </div>
          </div>

          <div class="mt-4">
            <canvas id="resultsChart" height="220"></canvas>
            <p class="text-xs text-gray-500 mt-2">Composition: principal, interest, and fees.</p>
          </div>

          <div class="flex gap-3 mt-4">
            <button class="btn btn-secondary flex-1" id="toggleSchedule" type="button">View Amortization Schedule</button>
            <button class="btn btn-secondary flex-1" id="downloadCsv" type="button" disabled>Download CSV</button>
          </div>
        </section>
      </div>

      <div id="scheduleWrap" class="mt-6 overflow-x-auto tableWrap" style="display:none;" aria-label="Amortization schedule">
        <table class="schedule-table w-full">
          <thead>
            <tr>
              <th>#</th>
              <th>Period</th>
              <th>Interest</th>
              <th>Principal</th>
              <th>Balance</th>
            </tr>
          </thead>
          <tbody id="scheduleBody"></tbody>
        </table>
        <div class="p-3 text-gray-500 text-sm bg-gray-50 mt-2">Showing the first 60 rows. Download CSV for the complete schedule.</div>
      </div>

      <section class="card content-card space-y-6 mt-10" id="howToUse" aria-label="How to use and methodology">
        <h2>How to Use This Bridge Loan Calculator</h2>
        <p>Follow the sequence below to estimate the cash a bridge loan delivers, the fees triggered, and the eventual payoff obligations.</p>
        <ol class="list-decimal list-inside space-y-1 text-gray-700">
          <li>Enter the property value and cap the loan with the LTV percentage so you do not overstretch the asset.</li>
          <li>Set the gross loan plus the term in months that matches the bridge financing offer.</li>
          <li>Choose whether interest is serviced, retained, or rolled-up and supply the monthly interest rate.</li>
          <li>Add arrangement, broker, exit, valuation, and legal fees, selecting if arrangement costs are upfront or capitalised.</li>
          <li>Review net advance, monthly outflows, total fees, redemption payment, and APR/IRR to understand the full cost.</li>
        </ol>

        <h2 class="mt-6">Methodology</h2>
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 text-sm text-gray-700">
          <p>The calculator enforces the LTV cap by trimming the gross loan if you exceed the permitted multiple of the property value.</p>
          <p>Serviced interest pays the rate each month while the principal stays on the balance. Retained interest deducts the full interest up front. Rolled-up interest compounds on the balance and settles at redemption.</p>
          <p>Fees can be billed upfront (reducing the net advance) or capitalised (added to the redemption amount). The APR is the internal rate of return (IRR) from the borrower’s cash flows, annualised to 12 months.</p>
        </div>
        <ul class="list-disc pl-5 text-gray-700 space-y-1">
          <li>The calculator defaults to monthly periods; adjust the start month so the schedule aligns with your deal.</li>
          <li>Net advance reflects the cash in your pocket after upfront fees and retained interest.</li>
          <li>Redemption amount includes capitalised arrangement fees and any exit fees or rolled-up interest.</li>
          <li>The APR/IRR output accounts for all cash flows (advance, monthly interest, and redemption) so you can compare across deals.</li>
        </ul>

        <div class="bg-white border border-gray-200 rounded-lg p-4 text-sm text-gray-700">
          <strong>Why this calculator stands out</strong>
          <ul class="list-disc pl-5 mt-2 space-y-1">
            <li>LTV guardrails that auto-trim your requested transfer to the permitted amount.</li>
            <li>Serviced, retained, and rolled-up interest modeling with upfront or capitalised fees.</li>
            <li>Cash-flow APR/IRR plus a printable schedule to support underwriting and closing discussions.</li>
          </ul>
        </div>

        <div class="bg-white border border-gray-200 rounded-lg p-4 text-sm text-gray-700">
          <strong>Related tools</strong>
          <ul class="list-disc pl-5 mt-2 space-y-1">
            <li><a href="https://calcdomain.com/loan-amortization" class="text-blue-600 hover:underline">Loan Amortization Schedule</a></li>
            <li><a href="https://calcdomain.com/apr" class="text-blue-600 hover:underline">APR Calculator</a></li>
            <li><a href="https://calcdomain.com/interest-only-loan" class="text-blue-600 hover:underline">Interest-Only Loan</a></li>
          </ul>
        </div>

        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 text-sm text-gray-700">
          Verified by <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline">Ugo Candido</a> on 2026-01-19. Always double-check with your lender for final terms.
        </div>
      </section>

      <section class="card meta-section space-y-4 mt-8" id="pageMeta" aria-label="Verification, changelog, formulas, citations">
        <details id="formulaDetails">
          <summary class="text-gray-800">Formulas</summary>
          <div class="mt-3 p-4 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 space-y-3">
            <div>
              <strong>Serviced interest</strong>
              <div class="font-mono mt-1">I<sub>m</sub> = L × i</div>
            </div>
            <div>
              <strong>Retained interest</strong>
              <div class="font-mono mt-1">I<sub>retained</sub> = L × i × n</div>
            </div>
            <div>
              <strong>Rolled-up balance</strong>
              <div class="font-mono mt-1">B<sub>n</sub> = L × (1 + i)<sup>n</sup></div>
            </div>
            <div>
              <strong>Exit fee</strong>
              <div class="font-mono mt-1">Exit = L × e / 100</div>
            </div>
            <div>
              <strong>Cash-flow APR (IRR)</strong>
              <div class="font-mono mt-1">0 = -NetAdvance + Σ Pay<sub>t</sub>(1 + r)<sup>-t</sup> + Redemption × (1 + r)<sup>-n</sup></div>
              <div class="text-xs text-gray-500 mt-1">APR = (1 + r)<sup>12</sup> - 1</div>
            </div>
            <div>
              <strong>Variables</strong>
              <ul class="list-disc pl-5 text-gray-600">
                <li>P = principal (gross loan)</li>
                <li>i = periodic (monthly) interest rate</li>
                <li>n = term in months</li>
                <li>M = periodic interest payment returned to the lender</li>
                <li>T = taxes, fees, and capitalised expenses</li>
              </ul>
            </div>
          </div>
        </details>

        <details id="citationDetails">
          <summary class="text-gray-800">Citations</summary>
          <div class="mt-3 p-4 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 space-y-2">
            <p><strong>Home</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">https://calcdomain.com/</a></p>
            <p><strong>Finance</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/finance" class="text-blue-600 hover:underline" target="_blank" rel="noopener">https://calcdomain.com/finance</a></p>
            <p><strong>Loans &amp; Debt</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/finance-loans-debt" class="text-blue-600 hover:underline" target="_blank" rel="noopener">https://calcdomain.com/subcategories/finance-loans-debt</a></p>
            <p><strong>12 CFR Part 1026 (Regulation Z — Truth in Lending)</strong> — ecfr.gov · Accessed 2026-01-19<br><a href="https://www.ecfr.gov/current/title-12/chapter-X/part-1026" class="text-blue-600 hover:underline" target="_blank" rel="noopener">https://www.ecfr.gov/current/title-12/chapter-X/part-1026</a></p>
            <p><strong>Loan Amortization Schedule</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/loan-amortization" class="text-blue-600 hover:underline" target="_blank" rel="noopener">https://calcdomain.com/loan-amortization</a></p>
            <p><strong>APR Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/apr" class="text-blue-600 hover:underline" target="_blank" rel="noopener">https://calcdomain.com/apr</a></p>
            <p><strong>Interest-Only Loan</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/interest-only-loan" class="text-blue-600 hover:underline" target="_blank" rel="noopener">https://calcdomain.com/interest-only-loan</a></p>
          </div>
        </details>

        <details id="changelogDetails">
          <summary class="text-gray-800">Changelog</summary>
          <div class="mt-3 p-4 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 space-y-2">
            <p><strong>Version:</strong> 0.1.0-draft<br><strong>Last code update:</strong> 2026-01-19</p>
            <ul class="list-disc pl-5 text-gray-600">
              <li>Initial audit spec draft generated from HTML extraction (review required).</li>
              <li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
              <li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
            </ul>
          </div>
        </details>

        <div class="badge-row" id="badgeRow">
          <span><span class="text-green-600 font-bold">✓</span> Verified by Ugo Candido</span>
          <span>Last Updated: 2026-01-19</span>
          <span>Version 0.1.0-draft</span>
        </div>
      
          <div class="badge" id="versionBadge">Version 1.5.0</div></section>
    </main>

    <footer id="siteFooter" class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.</p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2 text-sm text-gray-400">
              <li><a href="https://calcdomain.com/categories/finance" class="hover:text-white">Finance</a></li>
              <li><a href="https://calcdomain.com/categories/health-fitness" class="hover:text-white">Health &amp; Fitness</a></li>
              <li><a href="https://calcdomain.com/categories/math-conversions" class="hover:text-white">Math &amp; Conversions</a></li>
              <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="hover:text-white">Lifestyle &amp; Everyday</a></li>
              <li><a href="https://calcdomain.com/categories/construction-diy" class="hover:text-white">Construction &amp; DIY</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2 text-sm text-gray-400">
              <li><a href="https://calcdomain.com/mortgage-payment" class="hover:text-white">Mortgage Calculator</a></li>
              <li><a href="https://calcdomain.com/percentage-calculator" class="hover:text-white">Percentage Calculator</a></li>
              <li><a href="https://calcdomain.com/bmi-calculator" class="hover:text-white">BMI Calculator</a></li>
              <li><a href="https://calcdomain.com/auto-loan-calculator" class="hover:text-white">Auto Loan Calculator</a></li>
              <li><a href="https://calcdomain.com/house-affordability" class="hover:text-white">House Affordability</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2 text-sm text-gray-400">
              <li><a href="https://calcdomain.com/about" class="hover:text-white">About Us</a></li>
              <li><a href="https://calcdomain.com/contact" class="hover:text-white">Contact</a></li>
              <li><a href="https://calcdomain.com/privacy" class="hover:text-white">Privacy Policy</a></li>
              <li><a href="https://calcdomain.com/terms" class="hover:text-white">Terms of Service</a></li>
              <li><a href="https://calcdomain.com/sitemap.xml" class="hover:text-white">Site Map</a></li>
            </ul>
          </div>
        </div>
        <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
          <p>© 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>
    <script>
(function() {
  'use strict';

  const defaults = {
    propertyValue: 1200000,
    ltv: 65,
    grossLoan: 780000,
    termMonths: 18,
    rateMonthly: 1.25,
    interestMethod: 'serviced',
    arrFeePct: 1,
    arrFeeMode: 'upfront',
    brokerFeePct: 0.5,
    exitFeePct: 2,
    valuationFee: 1200,
    legalFee: 1500,
    startMonth: '2026-02'
  };

  const els = {
    propertyValue: document.getElementById('propertyValue'),
    ltv: document.getElementById('ltv'),
    grossLoan: document.getElementById('grossLoan'),
    termMonths: document.getElementById('termMonths'),
    rateMonthly: document.getElementById('rateMonthly'),
    interestMethod: document.getElementById('interestMethod'),
    arrFeePct: document.getElementById('arrFeePct'),
    arrFeeMode: document.getElementById('arrFeeMode'),
    brokerFeePct: document.getElementById('brokerFeePct'),
    exitFeePct: document.getElementById('exitFeePct'),
    valuationFee: document.getElementById('valuationFee'),
    legalFee: document.getElementById('legalFee'),
    startMonth: document.getElementById('startMonth'),

    netAdvance: document.getElementById('netAdvance'),
    monthlyInterest: document.getElementById('monthlyInterest'),
    totalFees: document.getElementById('totalFees'),
    totalInterest: document.getElementById('totalInterest'),
    redemptionAmount: document.getElementById('redemptionAmount'),
    aprIrr: document.getElementById('aprIrr'),
    paymentCount: document.getElementById('paymentCount'),
    advanceNote: document.getElementById('advanceNote'),
    errorBox: document.getElementById('errorBox'),
    scheduleWrap: document.getElementById('scheduleWrap'),
    scheduleBody: document.getElementById('scheduleBody'),
    toggleSchedule: document.getElementById('toggleSchedule'),
    downloadCsv: document.getElementById('downloadCsv'),
    calcBtn: document.getElementById('calcBtn'),
    resetBtn: document.getElementById('resetBtn')
  };

  const errNodes = {
    ltv: document.getElementById('ltvErr'),
    gl: document.getElementById('glErr'),
    tm: document.getElementById('tmErr'),
    rm: document.getElementById('rmErr')
  };

  const round2 = (value) => {
    if (!Number.isFinite(value)) return 0;
    return Math.round((value + Number.EPSILON) * 100) / 100;
  };

  const fmtCurrency = (value) => {
    const safe = Number.isFinite(value) ? value : 0;
    return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(safe);
  };

  const payoffLabel = (count) => {
    const years = count / 12;
    const wholeYears = Math.floor(years);
    const remMonths = Math.round((years - wholeYears) * 12);
    if (wholeYears <= 0) return `${Math.max(1, remMonths)} months`;
    if (remMonths <= 0) return `${wholeYears} years`;
    return `${wholeYears} yrs ${remMonths} mos`;
  };

  let currentSchedule = [];
  let chart;

  function parseInputs() {
    return {
      propertyValue: parseFloat(els.propertyValue.value),
      ltv: parseFloat(els.ltv.value),
      grossLoan: parseFloat(els.grossLoan.value),
      termMonths: parseFloat(els.termMonths.value),
      rateMonthly: parseFloat(els.rateMonthly.value),
      interestMethod: els.interestMethod.value,
      arrFeePct: parseFloat(els.arrFeePct.value),
      arrFeeMode: els.arrFeeMode.value,
      brokerFeePct: parseFloat(els.brokerFeePct.value),
      exitFeePct: parseFloat(els.exitFeePct.value),
      valuationFee: parseFloat(els.valuationFee.value),
      legalFee: parseFloat(els.legalFee.value),
      startMonth: els.startMonth.value
    };
  }

  function validate(inputs) {
    const errors = [];
    const pv = inputs.propertyValue;
    const ltv = inputs.ltv;
    const gl = inputs.grossLoan;
    const tm = inputs.termMonths;
    const rm = inputs.rateMonthly;

    if (!Number.isFinite(pv) || pv <= 0) {
      errors.push('Property value must be greater than 0.');
    }
    if (!Number.isFinite(ltv) || ltv <= 0 || ltv > 100) {
      errors.push('LTV must be between 1% and 100%.');
      if (errNodes.ltv) errNodes.ltv.textContent = 'LTV must be between 1% and 100%.';
    } else if (errNodes.ltv) {
      errNodes.ltv.textContent = '';
    }
    if (!Number.isFinite(gl) || gl <= 0) {
      errors.push('Enter a gross loan greater than 0.');
      if (errNodes.gl) errNodes.gl.textContent = 'Enter a gross loan greater than 0.';
    } else {
      errNodes.gl.textContent = '';
    }
    if (!Number.isFinite(tm) || tm < 1 || tm > 60) {
      errors.push('Term must be between 1 and 60 months.');
      if (errNodes.tm) errNodes.tm.textContent = 'Term must be between 1 and 60 months.';
    } else if (errNodes.tm) {
      errNodes.tm.textContent = '';
    }
    if (!Number.isFinite(rm) || rm < 0) {
      errors.push('Monthly rate cannot be negative.');
      if (errNodes.rm) errNodes.rm.textContent = 'Monthly rate cannot be negative.';
    } else if (errNodes.rm) {
      errNodes.rm.textContent = '';
    }
    if (Number.isFinite(ltv) && Number.isFinite(pv) && Number.isFinite(gl)) {
      const maxLoan = pv * (ltv / 100);
      if (gl > maxLoan) {
        errors.push('Requested loan exceeds the LTV cap; result is trimmed to LTV maximum.');
      }
    }
    return { ok: errors.length === 0, errors };
  }

  function irrMonthly(cashflows) {
    const maxIter = 100;
    const tol = 1e-9;
    let rLow = -0.99;
    let rHigh = 5;
    const npv = (r) => cashflows.reduce((sum, cf, idx) => sum + cf / Math.pow(1 + r, idx), 0);
    const dnpv = (r) => cashflows.reduce((sum, cf, idx) => idx > 0 ? sum - idx * cf / Math.pow(1 + r, idx + 1) : sum, 0);
    let r = 0.01;
    for (let i = 0; i < 20; i++) {
      const f = npv(r);
      const df = dnpv(r);
      if (Math.abs(df) < 1e-12) break;
      const r1 = r - f / df;
      if (!isFinite(r1) || r1 <= rLow || r1 >= rHigh) break;
      if (Math.abs(r1 - r) < tol) return r1;
      r = r1;
    }
    let fa = npv(rLow);
    let fb = npv(rHigh);
    if (fa * fb > 0) return NaN;
    for (let i = 0; i < maxIter; i++) {
      const mid = (rLow + rHigh) / 2;
      const fm = npv(mid);
      if (Math.abs(fm) < tol) return mid;
      if (fa * fm < 0) {
        rHigh = mid;
        fb = fm;
      } else {
        rLow = mid;
        fa = fm;
      }
    }
    return (rLow + rHigh) / 2;
  }

  function compute(inputs) {
    const principal = Math.max(0, inputs.propertyValue || 0);
    const ltv = Math.min(100, Math.max(0, inputs.ltv || 0));
    const maxLoan = principal * (ltv / 100);
    let L = Math.max(0, inputs.grossLoan || 0);
    if (L > maxLoan) L = maxLoan;
    const n = Math.max(1, Math.round(inputs.termMonths || 0));
    const i = Math.max(0, inputs.rateMonthly || 0) / 100;
    const method = inputs.interestMethod;
    const arrPct = Math.max(0, inputs.arrFeePct || 0) / 100;
    const brokerPct = Math.max(0, inputs.brokerFeePct || 0) / 100;
    const exitPct = Math.max(0, inputs.exitFeePct || 0) / 100;
    const valuationFee = Math.max(0, inputs.valuationFee || 0);
    const legalFee = Math.max(0, inputs.legalFee || 0);
    const arrMode = inputs.arrFeeMode;

    const arrFee = L * arrPct;
    const brokerFee = L * brokerPct;
    const exitFee = L * exitPct;

    let monthlyPay = 0;
    let totalInterest = 0;
    let redemption = L;
    const schedule = [];
    const start = inputs.startMonth ? new Date(inputs.startMonth + '-01T00:00:00') : new Date();

    if (method === 'serviced') {
      monthlyPay = L * i;
      totalInterest = monthlyPay * n;
      redemption += exitFee;
      for (let t = 1; t <= n; t++) {
        schedule.push({
          idx: t,
          date: new Date(start.getFullYear(), start.getMonth() + t - 1, 1),
          interest: round2(monthlyPay),
          principal: 0,
          balance: round2(L)
        });
      }
    } else if (method === 'retained') {
      totalInterest = L * i * n;
      redemption += exitFee;
      for (let t = 1; t <= n; t++) {
        schedule.push({
          idx: t,
          date: new Date(start.getFullYear(), start.getMonth() + t - 1, 1),
          interest: 0,
          principal: 0,
          balance: round2(L)
        });
      }
    } else {
      let balance = L;
      for (let t = 1; t <= n; t++) {
        const interest = balance * i;
        balance += interest;
        schedule.push({
          idx: t,
          date: new Date(start.getFullYear(), start.getMonth() + t - 1, 1),
          interest: round2(interest),
          principal: 0,
          balance: round2(balance)
        });
      }
      totalInterest = round2(balance - L);
      redemption = balance + exitFee;
    }

    const upfrontDeductions = brokerFee + valuationFee + legalFee + (method === 'retained' ? totalInterest : 0) + (arrMode === 'upfront' ? arrFee : 0);
    const capitalisedFees = arrMode === 'capitalised' ? arrFee : 0;
    const netAdvance = Math.max(0, L - upfrontDeductions);
    const redemptionAmount = redemption + capitalisedFees;
    const totalFees = arrFee + brokerFee + valuationFee + legalFee + exitFee;

    const cashflows = [-netAdvance];
    if (method === 'serviced') {
      for (let t = 1; t <= n - 1; t++) cashflows.push(monthlyPay);
      cashflows.push(monthlyPay + redemptionAmount);
    } else {
      for (let t = 1; t <= n - 1; t++) cashflows.push(0);
      cashflows.push(redemptionAmount);
    }

    const irr = irrMonthly(cashflows);
    const apr = isFinite(irr) ? Math.pow(1 + irr, 12) - 1 : null;

    return {
      netAdvance: round2(netAdvance),
      monthlyInterest: round2(monthlyPay),
      totalFees: round2(totalFees),
      totalInterest: round2(totalInterest),
      redemptionAmount: round2(redemptionAmount),
      apr,
      schedule,
      interestMethod: method,
      principal: L,
      totalInterestRaw: totalInterest
    };
  }

  function format(outputs) {
    const monthlyInterestLabel = outputs.interestMethod === 'serviced'
      ? fmtCurrency(outputs.monthlyInterest)
      : outputs.interestMethod === 'retained'
        ? '— (retained)'
        : '— (rolled-up)';

    return {
      netAdvance: fmtCurrency(outputs.netAdvance),
      monthlyInterest: monthlyInterestLabel,
      totalFees: fmtCurrency(outputs.totalFees),
      totalInterest: fmtCurrency(outputs.totalInterest),
      redemptionAmount: fmtCurrency(outputs.redemptionAmount),
      apr: (outputs.apr == null || !Number.isFinite(outputs.apr)) ? '—' : `${(outputs.apr * 100).toFixed(2)}%`,
      paymentCount: `${outputs.schedule.length} payments`,
      payoffLabel: `${outputs.schedule.length} payments (~${payoffLabel(outputs.schedule.length)})`,
      advanceNote: outputs.interestMethod === 'retained' ? 'Interest retained up front; net advance excludes prepaid interest.' : 'Cash proceeds after fees and retained interest.'
    };
  }

  function renderError(messages) {
    if (!messages || messages.length === 0) {
      els.errorBox.style.display = 'none';
      els.errorBox.textContent = '';
      return;
    }
    els.errorBox.style.display = 'block';
    els.errorBox.textContent = messages.join(' ');
  }

  function renderScheduleTable(schedule) {
    const tbody = els.scheduleBody;
    tbody.innerHTML = '';
    const formatter = new Intl.DateTimeFormat('en-US', { year: 'numeric', month: 'short' });
    const rows = schedule.slice(0, 60);
    const frag = document.createDocumentFragment();
    rows.forEach((row) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${row.idx}</td>
        <td>${formatter.format(row.date)}</td>
        <td>${fmtCurrency(row.interest)}</td>
        <td>${fmtCurrency(row.principal)}</td>
        <td>${fmtCurrency(row.balance)}</td>
      `;
      frag.appendChild(tr);
    });
    tbody.appendChild(frag);
  }

  function renderChart(parts) {
    const canvas = document.getElementById('resultsChart');
    if (!canvas) return;
    const data = {
      labels: ['Principal', 'Interest', 'Fees'],
      datasets: [{
        data: [parts.principal, parts.totalInterest, parts.totalFees],
        backgroundColor: ['#2563eb', '#4f46e5', '#f59e0b']
      }]
    };
    const options = {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { position: 'bottom' } }
    };
    if (!chart) {
      chart = new Chart(canvas, { type: 'doughnut', data, options });
    } else {
      chart.data = data;
      chart.update();
    }
  }

  function render(formatted, outputs) {
    els.netAdvance.textContent = formatted.netAdvance;
    els.monthlyInterest.textContent = formatted.monthlyInterest;
    els.totalFees.textContent = formatted.totalFees;
    els.totalInterest.textContent = formatted.totalInterest;
    els.redemptionAmount.textContent = formatted.redemptionAmount;
    els.aprIrr.textContent = formatted.apr;
    els.paymentCount.textContent = formatted.payoffLabel;
    els.advanceNote.textContent = formatted.advanceNote;

    renderChart(outputs);
    currentSchedule = outputs.schedule;
    if (els.scheduleWrap.style.display === 'block') {
      renderScheduleTable(currentSchedule);
    }
    els.downloadCsv.disabled = currentSchedule.length === 0;
  }

  function update() {
    const inputs = parseInputs();
    const validation = validate(inputs);
    if (!validation.ok) {
      renderError(validation.errors);
      els.downloadCsv.disabled = true;
      els.scheduleWrap.style.display = 'none';
      els.toggleSchedule.textContent = 'View Amortization Schedule';
      return;
    }
    renderError([]);

    const outputs = compute(inputs);
    if (!outputs || outputs.schedule.length === 0) {
      renderError(['Calculation failed for the current inputs.']);
      els.downloadCsv.disabled = true;
      return;
    }

    const formatted = format(outputs);
    render(formatted, outputs);
  }

  function debounce(fn, delay = 100) {
    let timer;
    return (...args) => {
      clearTimeout(timer);
      timer = setTimeout(() => fn(...args), delay);
    };
  }

  input.addEventListener('change', debouncedUpdate);
  });

  els.calcBtn.addEventListener('click', update);
  els.resetBtn.addEventListener('click', () => {
    Object.keys(defaults).forEach((key) => {
      if (els[key]) {
        els[key].value = defaults[key];
      }
    });
    const debouncedUpdate = debounce(update, 100);

    document.querySelectorAll('#inputsCard input, #inputsCard select, #inputsCard textarea')
      .forEach((el) => {
        el.addEventListener('input', debouncedUpdate);
        el.addEventListener('change', debouncedUpdate);
      });

    update();
  });

  els.toggleSchedule.addEventListener('click', () => {
    const isHidden = els.scheduleWrap.style.display !== 'block';
    els.scheduleWrap.style.display = isHidden ? 'block' : 'none';
    els.toggleSchedule.textContent = isHidden ? 'Hide Amortization Schedule' : 'View Amortization Schedule';
    if (isHidden) {
      renderScheduleTable(currentSchedule);
    }
  });

  els.downloadCsv.addEventListener('click', () => {
    if (currentSchedule.length === 0) return;
    const header = '#,Period,Interest,Principal,Balance\n';
    const formatter = new Intl.DateTimeFormat('en-US', { year: 'numeric', month: 'short' });
    let csv = header;
    currentSchedule.forEach((row) => {
      csv += `${row.idx},${formatter.format(row.date)},${row.interest},${row.principal},${row.balance}\n`;
    });
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'bridge-loan-schedule.csv';
    a.click();
    URL.revokeObjectURL(url);
  });

  update();
})();
</script>
</body>
</html>

<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/equipment-loan-calculator">





  <!-- Icons / PWA -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Equipment Loan Calculator - Estimate Payments, Interest &amp; Total Cost</title>
  <meta name="description" content="Professional equipment loan calculator for businesses. Estimate monthly, quarterly, or annual payments, total interest, and payoff with optional residual/balloon, sales tax and fees.">
  

  <!-- Fonts / Tailwind / Chart.js / MathJax -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Tailwind customizations for visible focus and color contrast
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: { 600: '#2563eb', 700: '#1d4ed8' }
          }
        }
      }
    }
  </script>
  <style>
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; }
    .prose { max-width: 70ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: 0.75rem; }
    .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.25rem; margin-bottom: 0.5rem; }
    .prose p { margin-bottom: 1rem; line-height: 1.7; }
    .prose ul, .prose ol { margin-left: 1.25rem; margin-bottom: 1rem; }
    .formula-box {
      background:#f8fafc; border:1px solid #e5e7eb; border-radius:10px; padding:1rem;
      overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
    }
    details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
    details[open] > summary { margin-bottom: 0.5rem; }

    .result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 1rem; text-align: center; }
    .result-card h4 { font-size: 0.95rem; color: #374151; margin-bottom: 0.25rem; }
    .result-card p { font-size: 1.6rem; font-weight: 800; color: #1d4ed8; }

    /* Visible focus ring */
    :focus-visible { outline: 3px solid #1d4ed8; outline-offset: 2px; border-radius: 6px; }

    /* Prevent layout shift when results render */
    #results { min-height: 320px; }

    /* Tooltip popover styles */
    .tip {
      display:none; margin-top:0.5rem; background:#f9fafb; border:1px solid #e5e7eb; border-radius:8px; padding:0.75rem; font-size:0.875rem; color:#374151;
    }
    .tip[aria-hidden="false"] { display:block; }

    @media print {
      body * { visibility: hidden; }
      #print-section, #print-section * { visibility: visible; }
      #print-section { position: absolute; left: 0; top: 0; width: 100%; }
      #results-chart-container { display: none !important; }
    }
  </style>

  <!-- Schema.org: WebPage -->
  <script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Equipment Loan Calculator",
  "description": "Estimate equipment finance payments with optional residual/balloon, sales tax and fees. Get total interest, total cost and a printable schedule.",
  "url": "https://calcdomain.com/equipment-loan-calculator",
  "inLanguage": "en",
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "dateModified": "2026-01-19"
}</script>

  <!-- Schema.org: Breadcrumbs -->
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Finance",
      "item": "https://calcdomain.com/categories/finance"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Loans Debt",
      "item": "https://calcdomain.com/subcategories/loans-debt"
    }
  ]
}
</script>

  <!-- Schema.org: HowTo -->
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to calculate equipment loan payments",
  "description": "Step-by-step guide to compute business equipment finance payments including residual/balloon and taxes.",
  "step": [
    {
      "@type": "HowToStep",
      "name": "Enter equipment cost",
      "text": "Provide purchase price, down payment and trade-in (if any)."
    },
    {
      "@type": "HowToStep",
      "name": "Add taxes and fees",
      "text": "Enter sales tax rate and fees; choose whether to finance them."
    },
    {
      "@type": "HowToStep",
      "name": "Set loan terms",
      "text": "Enter APR, term, payment frequency and optional residual/balloon."
    },
    {
      "@type": "HowToStep",
      "name": "Review results",
      "text": "Check payment, total interest and schedule; export or print if needed."
    }
  ]
}
</script>

  <!-- Schema.org: FAQPage -->
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "Is sales tax usually financed or paid up front?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "It depends on jurisdiction and lender policy. This calculator lets you model either: finance the tax with the loan or pay up front."
      }
    },
    {
      "@type": "Question",
      "name": "What is a residual/balloon value?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "A lump-sum owed at the end of the term (similar to a lease residual) that reduces periodic payments. The unpaid residual is due at maturity."
      }
    },
    {
      "@type": "Question",
      "name": "Which payment frequencies are supported?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Monthly, quarterly, and annual payments. APR is converted to an effective rate per period."
      }
    },
    {
      "@type": "Question",
      "name": "Does this calculator handle prepayments?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "This version focuses on standard amortization with an optional end-of-term balloon. Use our prepayment planner for extra principal strategies."
      }
    },
    {
      "@type": "Question",
      "name": "Are results tax or accounting advice?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "No. Results are educational estimates. Consult your accountant for depreciation (e.g., Section 179, bonus) and tax treatment."
      }
    },
    {
      "@type": "Question",
      "name": "How accurate is the schedule date spacing?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Dates are spaced by period (monthly/quarterly/annual) for planning visibility; actual lender schedules may vary slightly with business days and cutoffs."
      }
    },
    {
      "@type": "Question",
      "name": "Can I use a 0% APR?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. Set APR to 0 to model promotional financing; payments will be principal only (plus any financed taxes/fees) adjusted for residual if used."
      }
    }
  ]
}
</script>

  <!-- MathJax for LaTeX in the Methodology section -->
  <script defer="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <!-- Open Graph -->
  <meta property="og:title" content="Equipment Loan Calculator">
  <meta property="og:description" content="Estimate equipment finance payments with residual/balloon, sales tax and fees. Printable schedule for client-ready quotes.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://calcdomain.com/equipment-loan-calculator">
  <meta property="og:site_name" content="CalcDomain">

<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- Header (non-sticky per requirements) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
      
        
<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[PV = \underbrace{\big(\text{Price} - \text{Down} - \text{TradeIn}\big)}_{\text{Taxable Base}} \;+\; \begin{cases} \text{Tax} &amp; \text{if financed}\\ 0 &amp; \text{if paid up front} \end{cases} \;+\; \begin{cases} \text{Fees} &amp; \text{if financed}\\ 0 &amp; \text{if paid up front} \end{cases}\]</div>
  <pre class="auditspine-mono">PV = \underbrace{\big(\text{Price} - \text{Down} - \text{TradeIn}\big)}_{\text{Taxable Base}} \;+\; \begin{cases} \text{Tax} &amp; \text{if financed}\\ 0 &amp; \text{if paid up front} \end{cases} \;+\; \begin{cases} \text{Fees} &amp; \text{if financed}\\ 0 &amp; \text{if paid up front} \end{cases}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\text{Payment} = \frac{\big(PV - \frac{B}{(1+i)^n}\big)\, i}{1 - (1+i)^{-n}}\]</div>
  <pre class="auditspine-mono">\text{Payment} = \frac{\big(PV - \frac{B}{(1+i)^n}\big)\, i}{1 - (1+i)^{-n}}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\text{Payment} = PV \cdot \frac{i}{1-(1+i)^{-n}}\]</div>
  <pre class="auditspine-mono">\text{Payment} = PV \cdot \frac{i}{1-(1+i)^{-n}}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">We compute the amount financed \(PV\) from purchase inputs, then apply the annuity formula with optional end-of-term residual/balloon \(B\). Let \(i\) be the rate per period and \(n\) the number of periods. Amount financed: \[ PV = \underbrace{\big(\text{Price} - \text{Down} - \text{TradeIn}\big)}_{\text{Taxable Base}} \;+\; \begin{cases} \text{Tax} &amp; \text{if financed}\\ 0 &amp; \text{if paid up front} \end{cases} \;+\; \begin{cases} \text{Fees} &amp; \text{if financed}\\ 0 &amp; \text{if paid up front} \end{cases} \] Per-period rate: \(\; i = \dfrac{\text{APR}}{\text{periods per year}}\) Payment with balloon \(B\) due at maturity: \[ \text{Payment} = \frac{\big(PV - \frac{B}{(1+i)^n}\big)\, i}{1 - (1+i)^{-n}} \] For \(B=0\) this reduces to the standard annuity: \[ \text{Payment} = PV \cdot \frac{i}{1-(1+i)^{-n}} \] Interest each period: \(\text{Interest}_t = \text{Balance}_{t-1}\cdot i\), Principal: \(\text{Principal}_t = \text{Payment} - \text{Interest}_t\).</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><span class="auditspine-mono">P</span> = principal (loan amount) <em>(currency)</em></li>
<li><span class="auditspine-mono">r</span> = periodic interest rate (annual rate ÷ payments per year) <em>(1)</em></li>
<li><span class="auditspine-mono">n</span> = total number of payments (years × payments per year) <em>(count)</em></li>
<li><span class="auditspine-mono">M</span> = periodic payment for principal + interest <em>(currency)</em></li>
<li><span class="auditspine-mono">T</span> = property tax (annual or monthly depending on input) <em>(currency)</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Home</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/" target="_blank" rel="nofollow noopener">https://calcdomain.com/</a></li>
<li><strong>Finance</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/finance" target="_blank" rel="nofollow noopener">https://calcdomain.com/finance</a></li>
<li><strong>Loans &amp; Debt</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/finance-loans-debt" target="_blank" rel="nofollow noopener">https://calcdomain.com/subcategories/finance-loans-debt</a></li>
<li><strong>Loan Amortization Schedule</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/loan-amortization" target="_blank" rel="nofollow noopener">https://calcdomain.com/loan-amortization</a></li>
<li><strong>APR Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/apr" target="_blank" rel="nofollow noopener">https://calcdomain.com/apr</a></li>
<li><strong>Loan Prepayment Planner</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/loan-prepayment" target="_blank" rel="nofollow noopener">https://calcdomain.com/loan-prepayment</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
      </section>

      <!-- Sidebar -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-24 space-y-6">
          <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-600">
            Ad Placement (300×600)
          </div>

          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-bold text-lg mb-3">Why this equipment finance tool</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Models residual/balloon and tax/fees handling—like real lender quotes.</li>
              <li>Monthly, quarterly, or annual payments for B2B cash-flow planning.</li>
              <li>Printable schedule for proposals and client files.</li>
            </ul>
          </div>

          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="font-bold text-lg mb-4">Related loan tools</h3>
            <ul class="space-y-3 text-sm">
              <li><a href="https://calcdomain.com/loan-amortization" class="text-brand-700 hover:underline">Loan Amortization Schedule</a></li>
              <li><a href="https://calcdomain.com/apr" class="text-brand-700 hover:underline">APR Calculator</a></li>
              <li><a href="https://calcdomain.com/loan-prepayment" class="text-brand-700 hover:underline">Loan Prepayment Planner</a></li>
              <li>Lease vs. Loan Analyzer</li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>















  <!-- Calculator Logic (defer, end of body) -->
  <script defer="">
  (function(){
    const $ = (id) => document.getElementById(id);

    const els = {
      price: $('price'),
      down: $('downPayment'),
      trade: $('tradeIn'),
      taxRate: $('salesTax'),
      fees: $('fees'),
      financeTax: $('financeTax'),
      financeFees: $('financeFees'),
      apr: $('apr'),
      term: $('term'),
      termUnit: $('termUnit'),
      frequency: $('frequency'),
      residual: $('residual'),
      residualMode: $('residualMode'),
      firstDate: $('firstDate'),

      paymentPerPeriod: $('paymentPerPeriod'),
      totalInterest: $('totalInterest'),
      totalCost: $('totalCost'),
      payoffTime: $('payoffTime'),
      scheduleBody: $('scheduleBody'),

      recalc: $('recalc'),
      printBtn: $('printBtn'),
      resetBtn: $('resetBtn'),

      scheduleDetails: $('scheduleDetails'),
    };

    // Accessible tooltips
    document.querySelectorAll('[data-tip]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const tipSel = btn.getAttribute('data-tip');
        const tip = document.querySelector(tipSel);
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!expanded));
        tip.setAttribute('aria-hidden', String(expanded));
      });
      btn.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter' || e.key === ' '){
          e.preventDefault();
          btn.click();
        }
      });
    });

    // Mobile menu
    const mmBtn = $('mobile-menu-toggle');
    const mm = $('mobile-menu');
    if (mmBtn && mm) {
      mmBtn.addEventListener('click', ()=>{
        const hidden = mm.classList.contains('hidden');
        mm.classList.toggle('hidden', !hidden);
        mmBtn.setAttribute('aria-expanded', String(hidden));
      });
    }

    // Validation helpers
    const errors = {
      price: $('priceError'),
      down: $('downError'),
      trade: $('tradeError'),
      tax: $('taxError'),
      fees: $('feesError'),
      apr: $('aprError'),
      term: $('termError'),
      freq: $('freqError'),
      resid: $('residError')
    };

    function showError(el, errEl, msg){
      errEl.textContent = msg;
      errEl.classList.remove('hidden');
      el.setAttribute('aria-invalid', 'true');
    }
    function clearError(el, errEl){
      errEl.textContent = '';
      errEl.classList.add('hidden');
      el.removeAttribute('aria-invalid');
    }

    function validate(){
      let ok = true;
      const price = num(els.price.value);
      const down = num(els.down.value);
      const trade = num(els.trade.value);
      const taxRate = num(els.taxRate.value);
      const fees = num(els.fees.value);
      const apr = num(els.apr.value);
      const term = num(els.term.value);

      // Price
      if (!(price > 0)) { showError(els.price, errors.price, 'Enter a positive equipment price.'); ok=false; } else { clearError(els.price, errors.price); }
      // Down / Trade
      if (down < 0) { showError(els.down, errors.down, 'Down payment cannot be negative.'); ok=false; } else { clearError(els.down, errors.down); }
      if (trade < 0) { showError(els.trade, errors.trade, 'Trade-in cannot be negative.'); ok=false; } else { clearError(els.trade, errors.trade); }
      if (down + trade > price) { showError(els.down, errors.down, 'Down + trade-in cannot exceed price.'); showError(els.trade, errors.trade, 'Down + trade-in cannot exceed price.'); ok=false; }

      // Tax / Fees
      if (taxRate < 0) { showError(els.taxRate, errors.tax, 'Sales tax rate cannot be negative.'); ok=false; } else { clearError(els.taxRate, errors.tax); }
      if (fees < 0) { showError(els.fees, errors.fees, 'Fees cannot be negative.'); ok=false; } else { clearError(els.fees, errors.fees); }

      // APR
      if (apr < 0) { showError(els.apr, errors.apr, 'APR cannot be negative.'); ok=false; } else { clearError(els.apr, errors.apr); }

      // Term
      if (!(term > 0)) { showError(els.term, errors.term, 'Enter a positive term.'); ok=false; } else { clearError(els.term, errors.term); }

      // Residual
      const resid = num(els.residual.value);
      if (resid < 0) { showError(els.residual, errors.resid, 'Residual cannot be negative.'); ok=false; } else { clearError(els.residual, errors.resid); }

      return ok;
    }

    // on-blur inline validation
    [els.price, els.down, els.trade, els.taxRate, els.fees, els.apr, els.term, els.residual].forEach(ctrl=>{
      ctrl.addEventListener('blur', validate);
    });

    // Formatting helpers
    const fmtCur = (v) => new Intl.NumberFormat(undefined, {style:'currency', currency:'USD'}).format(v || 0);
    const fmtNum = (v) => new Intl.NumberFormat().format(v || 0);

    function num(v){ const n = parseFloat(v); return isFinite(n) ? n : 0; }

    function periodsPerYear(freq){
      switch(freq){
        case 'quarterly': return 4;
        case 'annual': return 1;
        default: return 12;
      }
    }

    function monthsPerStep(freq){
      switch(freq){
        case 'quarterly': return 3;
        case 'annual': return 12;
        default: return 1;
      }
    }

    function compute(){
      if(!validate()) { updateOutputs(0,0,0,'—',[]); return; }

      const price = num(els.price.value);
      const down = num(els.down.value);
      const trade = num(els.trade.value);
      const taxRate = num(els.taxRate.value)/100;
      const fees = num(els.fees.value);
      const apr = num(els.apr.value)/100;
      let termVal = num(els.term.value);
      const termUnit = els.termUnit.value;
      const freq = els.frequency.value;
      const ppYear = periodsPerYear(freq);

      // Convert term to periods
      let totalPeriods;
      if (termUnit === 'years') {
        totalPeriods = Math.round(termVal * ppYear);
      } else {
        // months
        totalPeriods = Math.round((termVal/12) * ppYear);
      }
      if (totalPeriods <= 0) { showError(els.term, errors.term, 'Term results in zero periods—adjust inputs.'); return updateOutputs(0,0,0,'—',[]); }
      else { clearError(els.term, errors.term); }

      // Residual handling
      let residualValue = num(els.residual.value);
      if (els.residualMode.value === 'percent') {
        residualValue = price * (residualValue/100);
      }

      // Taxable base assumption: price - trade - down for tax base (common but not universal).
      const taxableBase = Math.max(0, price - trade - down);
      const tax = taxableBase * taxRate;

      // Amount financed PV
      let pv = Math.max(0, price - down - trade);
      if (els.financeTax.checked) pv += tax;
      if (els.financeFees.checked) pv += fees;

      // Per-period rate
      const i = apr / ppYear;

      // Payment with balloon
      let payment = 0;
      if (i === 0) {
        // Simple principal spread, ignoring time value; balloon subtracted from financed principal
        payment = (pv - residualValue) / totalPeriods;
      } else {
        const discBalloon = residualValue / Math.pow(1+i, totalPeriods);
        payment = ((pv - discBalloon) * i) / (1 - Math.pow(1+i, -totalPeriods));
      }

      // Build schedule
      const schedule = [];
      let balance = pv;
      const start = els.firstDate.value ? new Date(els.firstDate.value + '-01') : new Date();
      const stepMonths = monthsPerStep(freq);

      for (let p=1; p<=totalPeriods; p++){
        const interest = balance * i;
        let principal = payment - interest;
        // Prevent numeric drift on final period (before balloon)
        if (p === totalPeriods) {
          // Ensure final remaining equals balloon
          principal = Math.max(0, balance - residualValue);
        }
        balance = Math.max(0, balance - principal);

        // Date label
        const d = new Date(start);
        d.setMonth(start.getMonth() + p*stepMonths);

        schedule.push({
          period: p,
          date: d,
          payment: payment,
          interest: interest,
          principal: principal,
          balance: balance
        });
      }

      // Totals
      const totalPaid = payment * totalPeriods + residualValue;
      const totalInterest = Math.max(0, totalPaid - pv);

      const payoffLabel = termUnit === 'years'
        ? `${fmtNum(termVal)} years`
        : `${fmtNum(termVal)} months`;

      updateOutputs(payment, totalInterest, totalPaid, payoffLabel, schedule);
    }

    function updateOutputs(payment, totalInterest, totalPaid, payoff, schedule){
      els.paymentPerPeriod.textContent = fmtCur(payment);
      els.totalInterest.textContent = fmtCur(totalInterest);
      els.totalCost.textContent = fmtCur(totalPaid);
      els.payoffTime.textContent = payoff;
      renderSchedule(schedule);
      renderChart(totalPaid - totalInterest, totalInterest);
    }

    function renderSchedule(rows){
      const tbody = els.scheduleBody;
      tbody.innerHTML = '';
      if (!rows || !rows.length) return;
      const df = new Intl.DateTimeFormat(undefined, {year:'numeric', month:'short'});

      rows.forEach(r=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="px-4 py-2 text-left">${r.period}</td>
          <td class="px-4 py-2 text-left">${df.format(r.date)}</td>
          <td class="px-4 py-2">${fmtCur(r.payment)}</td>
          <td class="px-4 py-2">${fmtCur(r.interest)}</td>
          <td class="px-4 py-2">${fmtCur(r.principal)}</td>
          <td class="px-4 py-2">${fmtCur(r.balance)}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    let chartInstance = null;
    function renderChart(principalPortion, interestPortion){
      const ctx = document.getElementById('resultsChart');
      if (!ctx) return;

      const data = {
        labels: ['Principal', 'Interest'],
        datasets: [{ data: [Math.max(0, principalPortion), Math.max(0, interestPortion)] }]
      };

      if (chartInstance) {
        chartInstance.data = data;
        chartInstance.update();
      } else {
        chartInstance = new Chart(ctx, {
          type: 'doughnut',
          data,
          options: {
            plugins: { legend: { position: 'bottom' } },
            responsive: true,
            maintainAspectRatio: false
          }
        });
      }
    }

    // Wire up buttons & inputs
    els.recalc.addEventListener('click', compute);
    els.printBtn.addEventListener('click', ()=> window.print());
    els.resetBtn.addEventListener('click', ()=>{
      // Reset to sensible defaults
      els.price.value = 50000;
      els.down.value = 5000;
      els.trade.value = 0;
      els.taxRate.value = 8.5;
      els.fees.value = 300;
      els.financeTax.checked = true;
      els.financeFees.checked = true;
      els.apr.value = 7.25;
      els.term.value = 60;
      els.termUnit.value = 'months';
      els.frequency.value = 'monthly';
      els.residual.value = 0;
      els.residualMode.value = 'amount';
      els.firstDate.value = '';
      // Clear errors
      Object.values(errors).forEach(e => { e.classList.add('hidden'); e.textContent=''; });
      // Recompute
      compute();
      // Collapse schedule
      els.scheduleDetails.open = false;
    });

    // Live calculation on input without being chatty; on blur we already validate
    [
      'price','downPayment','tradeIn','salesTax','fees','apr','term','termUnit','frequency','residual','residualMode','financeTax','financeFees','firstDate'
    ].forEach(id=>{
      const node = document.getElementById(id);
      if (node) node.addEventListener('input', compute);
    });

    // Initial compute
    compute();
  })();
  </script>


</body></html>
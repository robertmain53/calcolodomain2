<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/calibration-curve" />
    <title>Calibration Curve Calculator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Calibration Curve Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Calibration Curve Calculator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Calibration Curve Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/calibration-curve" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Calibration Curve Calculator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Calibration Curve Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Calibration Curve Calculator – Build, Fit & Analyze Standard Curves Online",
        "description": "Create calibration curves from standards, fit linear or quadratic models, view regression statistics, and interpolate unknown sample concentrations. Supports weighting, residuals, and export.",
        "url": "https://calcdomain.com/calibration-curve",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://calcdomain.com"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Science",
              "item": "https://calcdomain.com/categories/science"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Calibration Curve Calculator",
              "item": "https://calcdomain.com/calibration-curve"
            }
          ]
        },
        "mainEntity": {
          "@type": "HowTo",
          "name": "How to build a calibration curve and interpolate unknowns",
          "step": [
            {
              "@type": "HowToStep",
              "position": 1,
              "name": "Enter standards",
              "text": "Enter at least 3–5 standard concentrations and their instrument responses (e.g., absorbance, peak area, signal)."
            },
            {
              "@type": "HowToStep",
              "position": 2,
              "name": "Choose model and weighting",
              "text": "Select linear or quadratic regression and an optional weighting scheme (unweighted, 1/x, or 1/x²)."
            },
            {
              "@type": "HowToStep",
              "position": 3,
              "name": "Fit the curve",
              "text": "Click Fit curve to compute the regression equation, R², residuals, and plot the calibration curve."
            },
            {
              "@type": "HowToStep",
              "position": 4,
              "name": "Enter unknown samples",
              "text": "Enter instrument responses for unknown samples to interpolate their concentrations from the fitted curve."
            },
            {
              "@type": "HowToStep",
              "position": 5,
              "name": "Review diagnostics",
              "text": "Inspect residuals, lack-of-fit, and R² to assess whether the calibration model is appropriate over the chosen range."
            }
          ]
        }
      }</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Lifestyle & Everyday Calculators", "item": "https://calcdomain.com/categories/lifestyle-everyday"}, {"@type": "ListItem", "position": 3, "name": "Miscellaneous Calculators", "item": "https://calcdomain.com/subcategories/miscellaneous"}, {"@type": "ListItem", "position": 4, "name": "Calibration Curve Calculator", "item": "https://calcdomain.com/calibration-curve"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-blue-600 hover:underline">Lifestyle &amp; Everyday Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/miscellaneous" class="text-blue-600 hover:underline">Miscellaneous Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Calibration Curve Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <!-- MAIN CONTENT -->
            <header class="mb-6">
              <h1 class="text-2xl md:text-3xl font-bold mb-2">
                Calibration Curve Calculator
              </h1>
              <p class="text-gray-700 mb-2">
                Build, fit, and analyze calibration curves from your standards,
                then interpolate unknown sample concentrations with full
                regression statistics.
              </p>
              <p class="text-xs text-gray-500">
                For educational and research support only. Always verify results
                against your lab’s validated methods and SOPs.
              </p>
            </header>

            <!-- Calculator UI -->
            <section aria-labelledby="calibration-tool" class="mb-8">
              <h2 id="calibration-tool" class="text-xl font-semibold mb-3">
                Interactive Calibration Curve Tool
              </h2>

              <!-- Settings -->
              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1"
                    for="x-label"
                    >X-axis (concentration) label</label
                  >
                  <input
                    id="x-label"
                    type="text"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                    value="Concentration (mg/L)"
                  />
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1"
                    for="y-label"
                    >Y-axis (response) label</label
                  >
                  <input
                    id="y-label"
                    type="text"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                    value="Signal (absorbance)"
                  />
                </div>
              </div>

              <div class="grid md:grid-cols-3 gap-4 mb-4">
                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1"
                    for="model-select"
                    >Regression model</label
                  >
                  <select
                    id="model-select"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                  >
                    <option value="linear">Linear (y = a + b·x)</option>
                    <option value="quadratic">
                      Quadratic (y = a + b·x + c·x²)
                    </option>
                  </select>
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1"
                    for="weighting-select"
                    >Weighting</label
                  >
                  <select
                    id="weighting-select"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                  >
                    <option value="none">Unweighted</option>
                    <option value="1/x">1/x</option>
                    <option value="1/x2">1/x²</option>
                  </select>
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-gray-700 mb-1"
                    for="intercept-mode"
                    >Intercept</label
                  >
                  <select
                    id="intercept-mode"
                    class="w-full border rounded-md px-3 py-2 text-sm"
                  >
                    <option value="free">Fit intercept (default)</option>
                    <option value="force-zero">
                      Force through origin (a = 0)
                    </option>
                  </select>
                </div>
              </div>

              <!-- Standards table -->
              <div class="mb-4">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-gray-800">
                    Standards (known concentrations)
                  </h3>
                  <div class="space-x-2">
                    <button
                      id="add-row-btn"
                      type="button"
                      class="px-3 py-1 text-xs bg-blue-600 text-white rounded-md hover:bg-blue-700"
                    >
                      + Add row
                    </button>
                    <button
                      id="clear-rows-btn"
                      type="button"
                      class="px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200"
                    >
                      Clear
                    </button>
                  </div>
                </div>
                <div class="overflow-x-auto border rounded-md">
                  <table class="min-w-full text-xs">
                    <thead class="bg-gray-50">
                      <tr>
                        <th
                          class="px-2 py-2 text-left font-medium text-gray-700"
                        >
                          #
                        </th>
                        <th
                          class="px-2 py-2 text-left font-medium text-gray-700"
                        >
                          Concentration (x)
                        </th>
                        <th
                          class="px-2 py-2 text-left font-medium text-gray-700"
                        >
                          Response (y)
                        </th>
                        <th
                          class="px-2 py-2 text-left font-medium text-gray-700"
                        >
                          Include
                        </th>
                      </tr>
                    </thead>
                    <tbody id="standards-body">
                      <!-- Rows inserted by JS -->
                    </tbody>
                  </table>
                </div>
                <p class="text-xs text-gray-500 mt-1">
                  Tip: Enter at least 5–7 standards spanning your working range.
                  Uncheck “Include” to temporarily exclude outliers.
                </p>
              </div>

              <!-- Fit button -->
              <div class="flex flex-wrap items-center gap-3 mb-4">
                <button
                  id="fit-btn"
                  type="button"
                  class="px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700"
                >
                  Fit calibration curve
                </button>
                <button
                  id="export-json-btn"
                  type="button"
                  class="px-3 py-2 bg-white border text-sm rounded-md hover:bg-gray-50"
                >
                  Export data (JSON)
                </button>
                <button
                  id="reset-btn"
                  type="button"
                  class="px-3 py-2 bg-white border text-sm rounded-md hover:bg-gray-50"
                >
                  Reset to example
                </button>
                <span id="fit-status" class="text-xs text-gray-600"></span>
              </div>

              <!-- Plot & stats -->
              <div class="grid md:grid-cols-2 gap-6 mb-6">
                <div>
                  <h3 class="font-semibold text-gray-800 mb-2">
                    Calibration curve
                  </h3>
                  <canvas
                    id="calibration-chart"
                    aria-label="Calibration curve chart"
                  ></canvas>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800 mb-2">
                    Regression results
                  </h3>
                  <div
                    class="border rounded-md p-3 text-sm space-y-1 bg-gray-50"
                  >
                    <p>
                      <span class="font-medium">Model:</span>
                      <span id="model-summary">–</span>
                    </p>
                    <p>
                      <span class="font-medium">Equation:</span>
                      <span id="equation-text">–</span>
                    </p>
                    <p>
                      <span class="font-medium">R²:</span>
                      <span id="r2-text">–</span>
                    </p>
                    <p>
                      <span class="font-medium">Standard error (Sy/x):</span>
                      <span id="syx-text">–</span>
                    </p>
                    <p>
                      <span class="font-medium">n (included points):</span>
                      <span id="npoints-text">–</span>
                    </p>
                    <p>
                      <span class="font-medium">Residual range:</span>
                      <span id="residual-range-text">–</span>
                    </p>
                  </div>
                  <details class="mt-3 text-sm">
                    <summary class="cursor-pointer text-blue-600">
                      Show residuals table
                    </summary>
                    <div
                      class="mt-2 max-h-48 overflow-y-auto border rounded-md bg-white"
                    >
                      <table class="min-w-full text-xs">
                        <thead class="bg-gray-50">
                          <tr>
                            <th class="px-2 py-1 text-left">#</th>
                            <th class="px-2 py-1 text-left">x</th>
                            <th class="px-2 py-1 text-left">y</th>
                            <th class="px-2 py-1 text-left">ŷ</th>
                            <th class="px-2 py-1 text-left">Residual (y–ŷ)</th>
                          </tr>
                        </thead>
                        <tbody id="residuals-body"></tbody>
                      </table>
                    </div>
                  </details>
                </div>
              </div>

              <!-- Unknown samples -->
              <div class="mb-4">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-gray-800">Unknown samples</h3>
                  <button
                    id="add-unknown-btn"
                    type="button"
                    class="px-3 py-1 text-xs bg-blue-600 text-white rounded-md hover:bg-blue-700"
                  >
                    + Add unknown
                  </button>
                </div>
                <div class="overflow-x-auto border rounded-md">
                  <table class="min-w-full text-xs">
                    <thead class="bg-gray-50">
                      <tr>
                        <th
                          class="px-2 py-2 text-left font-medium text-gray-700"
                        >
                          Sample ID
                        </th>
                        <th
                          class="px-2 py-2 text-left font-medium text-gray-700"
                        >
                          Response (y)
                        </th>
                        <th
                          class="px-2 py-2 text-left font-medium text-gray-700"
                        >
                          Estimated concentration (x)
                        </th>
                      </tr>
                    </thead>
                    <tbody id="unknowns-body">
                      <!-- Unknown rows -->
                    </tbody>
                  </table>
                </div>
                <p class="text-xs text-gray-500 mt-1">
                  Unknowns are interpolated using the current fitted curve.
                  Estimates outside the calibration range are flagged.
                </p>
              </div>
            </section>

            <!-- Explanatory content -->
            <section class="prose">
              <h2>What is a calibration curve?</h2>
              <p>
                A calibration curve (or standard curve) is a plot of instrument
                response (y-axis) versus known analyte concentration (x-axis).
                It is used to convert measured signals from unknown samples into
                concentrations by interpolation.
              </p>
              <p>
                Calibration curves are fundamental in analytical chemistry,
                spectroscopy, chromatography, immunoassays, and many other
                quantitative methods.
              </p>

              <h2>Regression models and equations</h2>
              <p>This tool supports two common models:</p>
              <ul>
                <li>
                  <strong>Linear regression</strong>: assumes a straight-line
                  relationship between concentration and response.
                </li>
                <li>
                  <strong>Quadratic regression</strong>: allows gentle curvature
                  when the response is not perfectly linear.
                </li>
              </ul>

              <div class="formula-box">
                <p class="font-semibold mb-1">Linear model</p>
                <p>\( y = a + b x \)</p>
                <ul>
                  <li>
                    \(y\): instrument response (e.g., absorbance, peak area)
                  </li>
                  <li>\(x\): analyte concentration</li>
                  <li>\(a\): intercept</li>
                  <li>\(b\): slope (sensitivity)</li>
                </ul>
                <p class="font-semibold mt-2 mb-1">Quadratic model</p>
                <p>\( y = a + b x + c x^2 \)</p>
              </div>

              <h3>Least-squares fitting (with optional weighting)</h3>
              <p>
                The calculator uses (weighted) least-squares regression: it
                finds the coefficients that minimize the sum of squared
                residuals between measured responses \(y_i\) and predicted
                responses \(\hat{y}_i\).
              </p>
              <p>The objective function is:</p>
              <p>
                \[ \text{Minimize } S = \sum_{i=1}^{n} w_i \left(y_i -
                \hat{y}_i\right)^2 \]
              </p>
              <p>where \(w_i\) are weights:</p>
              <ul>
                <li><strong>Unweighted</strong>: \(w_i = 1\)</li>
                <li><strong>1/x</strong>: \(w_i = 1/x_i\)</li>
                <li><strong>1/x²</strong>: \(w_i = 1/x_i^2\)</li>
              </ul>
              <p>
                Weighting is often used in chromatography and spectroscopy when
                variance increases with concentration, so that low-concentration
                standards are not overwhelmed by high-concentration points.
              </p>

              <h2>Key statistics: R², Sy/x, and residuals</h2>
              <p>The regression panel reports several diagnostics:</p>
              <ul>
                <li>
                  <strong>R² (coefficient of determination)</strong>: fraction
                  of variance in y explained by the model.
                </li>
                <li>
                  <strong>Standard error of regression (Sy/x)</strong>: typical
                  size of residuals in y-units.
                </li>
                <li>
                  <strong>Residuals</strong>: \(e_i = y_i - \hat{y}_i\) for each
                  standard.
                </li>
              </ul>

              <div class="formula-box">
                <p class="font-semibold mb-1">R²</p>
                <p>
                  \[ R^2 = 1 - \frac{\sum (y_i - \hat{y}_i)^2}{\sum (y_i -
                  \bar{y})^2} \]
                </p>
                <p class="font-semibold mt-2 mb-1">Standard error (Sy/x)</p>
                <p>
                  \[ S_{y/x} = \sqrt{\frac{\sum (y_i - \hat{y}_i)^2}{n - p}} \]
                </p>
                <ul>
                  <li>\(n\): number of included points</li>
                  <li>
                    \(p\): number of fitted parameters (2 for linear, 3 for
                    quadratic; minus 1 if intercept is fixed)
                  </li>
                </ul>
              </div>

              <h2>Interpolating unknown sample concentrations</h2>
              <p>
                Once the curve is fitted, the calculator inverts the equation to
                estimate concentration from a measured response \(y\).
              </p>
              <h3>Linear model inversion</h3>
              <p>For \( y = a + b x \) with \(b \neq 0\):</p>
              <p>\[ x = \frac{y - a}{b} \]</p>

              <h3>Quadratic model inversion</h3>
              <p>
                For \( y = a + b x + c x^2 \), we solve the quadratic equation
                in \(x\):
              </p>
              <p>\[ c x^2 + b x + (a - y) = 0 \]</p>
              <p>The solutions are:</p>
              <p>\[ x = \frac{-b \pm \sqrt{b^2 - 4 c (a - y)}}{2c} \]</p>
              <p>
                The calculator chooses the physically meaningful root (real and
                within or near the calibration range). If no real root exists,
                the response is incompatible with the current model.
              </p>

              <h2>Best practices for calibration curves</h2>
              <ul>
                <li>
                  Prepare standards using accurate volumetric glassware and
                  properly mixed stock solutions.
                </li>
                <li>
                  Cover the full expected range of unknown samples, including
                  low and high ends.
                </li>
                <li>
                  Use replicates at key concentrations to assess precision and
                  potential curvature.
                </li>
                <li>
                  Inspect residuals: they should be randomly scattered around
                  zero, not systematically curved.
                </li>
                <li>
                  Do not rely on R² alone; check residual plots and method
                  validation criteria.
                </li>
                <li>
                  Recalibrate when instrument conditions change or QC samples
                  drift out of tolerance.
                </li>
              </ul>

              <h2>Limitations and validation</h2>
              <p>
                This online tool is designed for teaching and exploratory data
                analysis. It does not replace validated laboratory software or
                regulatory-compliant systems (e.g., 21 CFR Part 11).
              </p>
              <p>
                Before using any calibration model for reportable results,
                verify:
              </p>
              <ul>
                <li>
                  Linearity or appropriate model fit over the working range.
                </li>
                <li>
                  Accuracy, precision, LOD/LOQ, and robustness according to your
                  guidelines (e.g., ICH, CLSI).
                </li>
                <li>
                  That calculations match your lab’s validated spreadsheets or
                  LIMS implementation.
                </li>
              </ul>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Calibration, Curve.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">Related Science Tools</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/stoichiometry"
                  class="text-blue-600 hover:underline"
                  >Stoichiometry Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/beer-lambert-law"
                  class="text-blue-600 hover:underline"
                  >Beer–Lambert Law</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percent-yield"
                  class="text-blue-600 hover:underline"
                  >Percent Yield Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molarity"
                  class="text-blue-600 hover:underline"
                  >Molarity Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/ideal-gas-law"
                  class="text-blue-600 hover:underline"
                  >Ideal Gas Law Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/molar-mass"
                  class="text-blue-600 hover:underline"
                  >Molar Mass Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percent-composition"
                  class="text-blue-600 hover:underline"
                  >Percent Composition</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/solution-dilution"
                  class="text-blue-600 hover:underline"
                  >Solution Dilution Calculator</a
                >
              </li>
            </ul>
          </div>

          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">FAQ – Calibration Curves</h2>
            <div class="space-y-3 text-sm" id="faq-container">
              <details>
                <summary class="cursor-pointer font-medium text-gray-800">
                  How many calibration standards do I need?
                </summary>
                <p class="mt-1 text-gray-700">
                  For a simple linear calibration, at least 5–7 non-zero
                  standards spanning the working range are recommended. More
                  points improve your ability to detect curvature and outliers.
                  Include a blank if appropriate.
                </p>
              </details>
              <details>
                <summary class="cursor-pointer font-medium text-gray-800">
                  When should I use a quadratic calibration curve?
                </summary>
                <p class="mt-1 text-gray-700">
                  Use a quadratic model when residuals from a linear fit show
                  systematic curvature (e.g., underestimation at low
                  concentrations and overestimation at high). Ensure you have
                  enough points across the range and validate that the model
                  improves accuracy without overfitting.
                </p>
              </details>
              <details>
                <summary class="cursor-pointer font-medium text-gray-800">
                  What is weighting (1/x, 1/x²) and why use it?
                </summary>
                <p class="mt-1 text-gray-700">
                  In many methods, measurement variance increases with
                  concentration. Unweighted regression can then be dominated by
                  high standards, degrading accuracy at low levels. Weighting
                  (1/x or 1/x²) gives more influence to low concentrations,
                  often improving fit near the LLOQ. Always verify with QC
                  samples and method validation.
                </p>
              </details>
              <details>
                <summary class="cursor-pointer font-medium text-gray-800">
                  Should I force the calibration through zero?
                </summary>
                <p class="mt-1 text-gray-700">
                  Only force the intercept to zero if there is a strong
                  theoretical and empirical justification (e.g., a true blank
                  gives zero response and residuals support it). Forcing zero
                  can bias results if the instrument has baseline offset or
                  matrix effects. Many guidelines recommend fitting the
                  intercept unless validated otherwise.
                </p>
              </details>
              <details>
                <summary class="cursor-pointer font-medium text-gray-800">
                  Can I extrapolate beyond the calibration range?
                </summary>
                <p class="mt-1 text-gray-700">
                  Extrapolation outside the calibrated range is generally
                  discouraged because model behavior may not remain valid. If
                  unknowns fall outside the range, dilute or concentrate them to
                  bring responses within the validated interval, then re-measure
                  and recalculate.
                </p>
              </details>
            </div>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <!-- Chart.js for plotting -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <script>
      // Utility: create default example data
      const exampleStandards = [
        { x: 0, y: 0.002 },
        { x: 1, y: 0.102 },
        { x: 2, y: 0.199 },
        { x: 4, y: 0.401 },
        { x: 6, y: 0.602 },
        { x: 8, y: 0.805 },
        { x: 10, y: 1.0 },
      ];

      const standardsBody = document.getElementById("standards-body");
      const residualsBody = document.getElementById("residuals-body");
      const unknownsBody = document.getElementById("unknowns-body");
      const fitStatus = document.getElementById("fit-status");

      let chart;
      let currentCoeffs = null; // {a,b,c?, model}
      let currentXRange = null; // {min, max}

      function addStandardRow(x = "", y = "", include = true) {
        const row = document.createElement("tr");
        row.className = "border-t";

        const indexCell = document.createElement("td");
        indexCell.className = "px-2 py-1 text-gray-500";
        indexCell.textContent = standardsBody.children.length + 1;

        const xCell = document.createElement("td");
        const xInput = document.createElement("input");
        xInput.type = "number";
        xInput.step = "any";
        xInput.value = x;
        xInput.className =
          "table-input w-full border-0 px-2 py-1 focus:outline-none focus:ring-0";
        xCell.appendChild(xInput);

        const yCell = document.createElement("td");
        const yInput = document.createElement("input");
        yInput.type = "number";
        yInput.step = "any";
        yInput.value = y;
        yInput.className =
          "table-input w-full border-0 px-2 py-1 focus:outline-none focus:ring-0";
        yCell.appendChild(yInput);

        const includeCell = document.createElement("td");
        includeCell.className = "px-2 py-1 text-center";
        const includeInput = document.createElement("input");
        includeInput.type = "checkbox";
        includeInput.checked = include;
        includeCell.appendChild(includeInput);

        row.appendChild(indexCell);
        row.appendChild(xCell);
        row.appendChild(yCell);
        row.appendChild(includeCell);
        standardsBody.appendChild(row);
      }

      function renumberStandardRows() {
        Array.from(standardsBody.children).forEach((row, idx) => {
          row.firstChild.textContent = idx + 1;
        });
      }

      function resetToExample() {
        standardsBody.innerHTML = "";
        exampleStandards.forEach((p) => addStandardRow(p.x, p.y, true));
        renumberStandardRows();
        unknownsBody.innerHTML = "";
        addUnknownRow("U1", "");
        addUnknownRow("U2", "");
        clearResults();
        fitStatus.textContent =
          'Loaded example data. Click "Fit calibration curve" to analyze.';
      }

      function clearStandards() {
        standardsBody.innerHTML = "";
        clearResults();
        fitStatus.textContent = "All standard rows cleared.";
      }

      function addUnknownRow(id = "", y = "") {
        const row = document.createElement("tr");
        row.className = "border-t";

        const idCell = document.createElement("td");
        const idInput = document.createElement("input");
        idInput.type = "text";
        idInput.value = id;
        idInput.placeholder = "Sample ID";
        idInput.className =
          "w-full border-0 px-2 py-1 focus:outline-none focus:ring-0";
        idCell.appendChild(idInput);

        const yCell = document.createElement("td");
        const yInput = document.createElement("input");
        yInput.type = "number";
        yInput.step = "any";
        yInput.value = y;
        yInput.className =
          "table-input w-full border-0 px-2 py-1 focus:outline-none focus:ring-0";
        yCell.appendChild(yInput);

        const xCell = document.createElement("td");
        xCell.className = "px-2 py-1 text-gray-700";
        xCell.textContent = "–";

        row.appendChild(idCell);
        row.appendChild(yCell);
        row.appendChild(xCell);
        unknownsBody.appendChild(row);
      }

      function getStandardsData() {
        const rows = Array.from(standardsBody.children);
        const data = [];
        for (const row of rows) {
          const inputs = row.querySelectorAll("input");
          const x = parseFloat(inputs[0].value);
          const y = parseFloat(inputs[1].value);
          const include = inputs[2].checked;
          if (!include) continue;
          if (!isFinite(x) || !isFinite(y)) continue;
          data.push({ x, y });
        }
        return data;
      }

      // Weighted linear regression (optionally force intercept)
      function fitLinear(data, weighting, forceZero) {
        const n = data.length;
        if (n < 2) return null;

        let Sw = 0,
          Swx = 0,
          Swy = 0,
          Swxx = 0,
          Swxy = 0;
        for (const { x, y } of data) {
          let w = 1;
          if (weighting === "1/x") {
            if (x === 0) continue;
            w = 1 / Math.abs(x);
          } else if (weighting === "1/x2") {
            if (x === 0) continue;
            w = 1 / (x * x);
          }
          Sw += w;
          Swx += w * x;
          Swy += w * y;
          Swxx += w * x * x;
          Swxy += w * x * y;
        }

        if (forceZero) {
          // y = b x, minimize sum w (y - b x)^2 => b = sum(w x y) / sum(w x^2)
          const b = Swxy / Swxx;
          const a = 0;
          return { a, b };
        } else {
          const denom = Sw * Swxx - Swx * Swx;
          if (denom === 0) return null;
          const a = (Swy * Swxx - Swx * Swxy) / denom;
          const b = (Sw * Swxy - Swx * Swy) / denom;
          return { a, b };
        }
      }

      // Unweighted quadratic regression (normal equations)
      function fitQuadratic(data, weighting) {
        const n = data.length;
        if (n < 3) return null;

        let S1 = 0,
          Sx = 0,
          Sx2 = 0,
          Sx3 = 0,
          Sx4 = 0;
        let Sy = 0,
          Sxy = 0,
          Sx2y = 0;

        for (const { x, y } of data) {
          let w = 1;
          if (weighting === "1/x") {
            if (x === 0) continue;
            w = 1 / Math.abs(x);
          } else if (weighting === "1/x2") {
            if (x === 0) continue;
            w = 1 / (x * x);
          }
          const x2 = x * x;
          const x3 = x2 * x;
          const x4 = x2 * x2;

          S1 += w;
          Sx += w * x;
          Sx2 += w * x2;
          Sx3 += w * x3;
          Sx4 += w * x4;

          Sy += w * y;
          Sxy += w * x * y;
          Sx2y += w * x2 * y;
        }

        // Solve 3x3 system using Cramer's rule or Gaussian elimination
        const A = [
          [S1, Sx, Sx2],
          [Sx, Sx2, Sx3],
          [Sx2, Sx3, Sx4],
        ];
        const B = [Sy, Sxy, Sx2y];

        function det3(m) {
          return (
            m[0][0] * (m[1][1] * m[2][2] - m[1][2] * m[2][1]) -
            m[0][1] * (m[1][0] * m[2][2] - m[1][2] * m[2][0]) +
            m[0][2] * (m[1][0] * m[2][1] - m[1][1] * m[2][0])
          );
        }

        const detA = det3(A);
        if (detA === 0) return null;

        const A_a = [
          [B[0], A[0][1], A[0][2]],
          [B[1], A[1][1], A[1][2]],
          [B[2], A[2][1], A[2][2]],
        ];
        const A_b = [
          [A[0][0], B[0], A[0][2]],
          [A[1][0], B[1], A[1][2]],
          [A[2][0], B[2], A[2][2]],
        ];
        const A_c = [
          [A[0][0], A[0][1], B[0]],
          [A[1][0], A[1][1], B[1]],
          [A[2][0], A[2][1], B[2]],
        ];

        const a = det3(A_a) / detA;
        const b = det3(A_b) / detA;
        const c = det3(A_c) / detA;
        return { a, b, c };
      }

      function predictY(x, coeffs) {
        if (!coeffs) return NaN;
        if (coeffs.model === "linear") {
          return coeffs.a + coeffs.b * x;
        } else {
          return coeffs.a + coeffs.b * x + coeffs.c * x * x;
        }
      }

      function computeStats(data, coeffs, p) {
        const n = data.length;
        if (!coeffs || n <= p) return null;

        let ssRes = 0;
        let ssTot = 0;
        let yMean = data.reduce((sum, d) => sum + d.y, 0) / n;
        let minRes = Infinity,
          maxRes = -Infinity;
        const residuals = [];

        for (const d of data) {
          const yHat = predictY(d.x, coeffs);
          const res = d.y - yHat;
          residuals.push({ x: d.x, y: d.y, yHat, res });
          ssRes += res * res;
          const dev = d.y - yMean;
          ssTot += dev * dev;
          if (res < minRes) minRes = res;
          if (res > maxRes) maxRes = res;
        }

        const r2 = ssTot === 0 ? 1 : 1 - ssRes / ssTot;
        const syx = Math.sqrt(ssRes / (n - p));

        return { r2, syx, residuals, minRes, maxRes };
      }

      function updateResidualsTable(residuals) {
        residualsBody.innerHTML = "";
        residuals.forEach((r, idx) => {
          const tr = document.createElement("tr");
          tr.className = "border-t";
          tr.innerHTML = `
        <td class="px-2 py-1 text-gray-500">${idx + 1}</td>
        <td class="px-2 py-1">${r.x.toPrecision(6)}</td>
        <td class="px-2 py-1">${r.y.toPrecision(6)}</td>
        <td class="px-2 py-1">${r.yHat.toPrecision(6)}</td>
        <td class="px-2 py-1">${r.res.toExponential(3)}</td>
      `;
          residualsBody.appendChild(tr);
        });
      }

      function formatEquation(coeffs) {
        if (!coeffs) return "–";
        function fmt(v) {
          if (!isFinite(v)) return "0";
          if (Math.abs(v) >= 0.01 && Math.abs(v) < 1e4) return v.toFixed(4);
          return v.toExponential(3);
        }
        if (coeffs.model === "linear") {
          const a = fmt(coeffs.a);
          const b = fmt(coeffs.b);
          return `y = ${a} + ${b}·x`;
        } else {
          const a = fmt(coeffs.a);
          const b = fmt(coeffs.b);
          const c = fmt(coeffs.c);
          return `y = ${a} + ${b}·x + ${c}·x²`;
        }
      }

      function clearResults() {
        currentCoeffs = null;
        currentXRange = null;
        document.getElementById("model-summary").textContent = "–";
        document.getElementById("equation-text").textContent = "–";
        document.getElementById("r2-text").textContent = "–";
        document.getElementById("syx-text").textContent = "–";
        document.getElementById("npoints-text").textContent = "–";
        document.getElementById("residual-range-text").textContent = "–";
        residualsBody.innerHTML = "";
        if (chart) {
          chart.data.datasets[1].data = [];
          chart.update();
        }
        // clear unknown estimates
        Array.from(unknownsBody.children).forEach((row) => {
          const cells = row.children;
          if (cells[2]) cells[2].textContent = "–";
        });
      }

      function fitCurve() {
        const data = getStandardsData();
        if (data.length < 2) {
          fitStatus.textContent = "Enter at least two valid standard points.";
          clearResults();
          return;
        }

        const model = document.getElementById("model-select").value;
        const weighting = document.getElementById("weighting-select").value;
        const interceptMode = document.getElementById("intercept-mode").value;
        const forceZero = interceptMode === "force-zero";

        let coeffs;
        if (model === "linear") {
          coeffs = fitLinear(data, weighting, forceZero);
          if (!coeffs) {
            fitStatus.textContent = "Could not fit linear model (check data).";
            clearResults();
            return;
          }
          coeffs.model = "linear";
        } else {
          coeffs = fitQuadratic(data, weighting);
          if (!coeffs) {
            fitStatus.textContent =
              "Could not fit quadratic model (check data).";
            clearResults();
            return;
          }
          if (forceZero) {
            // For simplicity we do not support forcing zero intercept with quadratic here
            fitStatus.textContent =
              "Note: Forcing intercept to zero is only applied to linear model.";
          }
          coeffs.model = "quadratic";
        }

        // Stats
        const p = coeffs.model === "linear" ? (forceZero ? 1 : 2) : 3;
        const stats = computeStats(data, coeffs, p);
        if (!stats) {
          fitStatus.textContent = "Could not compute regression statistics.";
          clearResults();
          return;
        }

        currentCoeffs = coeffs;
        const xs = data.map((d) => d.x);
        currentXRange = { min: Math.min(...xs), max: Math.max(...xs) };

        document.getElementById("model-summary").textContent =
          (coeffs.model === "linear" ? "Linear" : "Quadratic") +
          (weighting !== "none" ? `, weighted (${weighting})` : "") +
          (forceZero && coeffs.model === "linear"
            ? ", intercept fixed at 0"
            : "");

        document.getElementById("equation-text").textContent =
          formatEquation(coeffs);
        document.getElementById("r2-text").textContent = stats.r2.toFixed(5);
        document.getElementById("syx-text").textContent =
          stats.syx.toExponential(3);
        document.getElementById("npoints-text").textContent =
          data.length.toString();
        document.getElementById(
          "residual-range-text"
        ).textContent = `${stats.minRes.toExponential(
          3
        )} to ${stats.maxRes.toExponential(3)}`;

        updateResidualsTable(stats.residuals);
        updateChart(data, coeffs);
        updateUnknowns();
        fitStatus.textContent = "Calibration curve fitted successfully.";
      }

      function updateChart(data, coeffs) {
        const xLabel =
          document.getElementById("x-label").value || "Concentration";
        const yLabel = document.getElementById("y-label").value || "Response";

        const scatterData = data.map((d) => ({ x: d.x, y: d.y }));

        // Generate smooth curve
        const xs = data.map((d) => d.x);
        const minX = Math.min(...xs);
        const maxX = Math.max(...xs);
        const span = maxX - minX || 1;
        const start = minX - 0.05 * span;
        const end = maxX + 0.05 * span;
        const curvePoints = [];
        const steps = 100;
        for (let i = 0; i <= steps; i++) {
          const x = start + ((end - start) * i) / steps;
          const y = predictY(x, coeffs);
          if (isFinite(y)) curvePoints.push({ x, y });
        }

        if (!chart) {
          const ctx = document
            .getElementById("calibration-chart")
            .getContext("2d");
          chart = new Chart(ctx, {
            type: "scatter",
            data: {
              datasets: [
                {
                  label: "Standards",
                  data: scatterData,
                  backgroundColor: "#2563eb",
                  borderColor: "#2563eb",
                  pointRadius: 4,
                },
                {
                  label: "Fitted curve",
                  data: curvePoints,
                  type: "line",
                  borderColor: "#16a34a",
                  borderWidth: 2,
                  pointRadius: 0,
                  tension: 0,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: true },
                tooltip: { mode: "nearest", intersect: false },
              },
              scales: {
                x: {
                  type: "linear",
                  title: { display: true, text: xLabel },
                },
                y: {
                  title: { display: true, text: yLabel },
                },
              },
            },
          });
        } else {
          chart.data.datasets[0].data = scatterData;
          chart.data.datasets[1].data = curvePoints;
          chart.options.scales.x.title.text = xLabel;
          chart.options.scales.y.title.text = yLabel;
          chart.update();
        }
      }

      function estimateXFromY(y, coeffs) {
        if (!coeffs) return NaN;
        if (coeffs.model === "linear") {
          if (coeffs.b === 0) return NaN;
          return (y - coeffs.a) / coeffs.b;
        } else {
          const { a, b, c } = coeffs;
          // Solve c x^2 + b x + (a - y) = 0
          const A = c;
          const B = b;
          const C = a - y;
          const disc = B * B - 4 * A * C;
          if (disc < 0) return NaN;
          const sqrtD = Math.sqrt(disc);
          const x1 = (-B + sqrtD) / (2 * A);
          const x2 = (-B - sqrtD) / (2 * A);
          // Choose root closer to calibration range
          if (!currentXRange) return x1;
          const d1 = Math.abs(x1 - (currentXRange.min + currentXRange.max) / 2);
          const d2 = Math.abs(x2 - (currentXRange.min + currentXRange.max) / 2);
          return d1 <= d2 ? x1 : x2;
        }
      }

      function updateUnknowns() {
        if (!currentCoeffs) return;
        const rows = Array.from(unknownsBody.children);
        for (const row of rows) {
          const cells = row.children;
          const yInput = cells[1].querySelector("input");
          const y = parseFloat(yInput.value);
          const resultCell = cells[2];
          if (!isFinite(y)) {
            resultCell.textContent = "–";
            resultCell.className = "px-2 py-1 text-gray-700";
            continue;
          }
          const xEst = estimateXFromY(y, currentCoeffs);
          if (!isFinite(xEst)) {
            resultCell.textContent = "No real solution";
            resultCell.className = "px-2 py-1 text-red-600";
            continue;
          }
          let text = xEst.toPrecision(6);
          let cls = "px-2 py-1 text-gray-700";
          if (
            currentXRange &&
            (xEst < currentXRange.min || xEst > currentXRange.max)
          ) {
            text += " (extrapolated)";
            cls = "px-2 py-1 text-amber-700";
          }
          resultCell.textContent = text;
          resultCell.className = cls;
        }
      }

      function exportData() {
        const standards = [];
        Array.from(standardsBody.children).forEach((row) => {
          const inputs = row.querySelectorAll("input");
          standards.push({
            x: inputs[0].value,
            y: inputs[1].value,
            include: inputs[2].checked,
          });
        });
        const unknowns = [];
        Array.from(unknownsBody.children).forEach((row) => {
          const cells = row.children;
          const id = cells[0].querySelector("input").value;
          const y = cells[1].querySelector("input").value;
          const xEst = cells[2].textContent;
          unknowns.push({ id, y, estimatedX: xEst });
        });
        const payload = {
          xLabel: document.getElementById("x-label").value,
          yLabel: document.getElementById("y-label").value,
          model: document.getElementById("model-select").value,
          weighting: document.getElementById("weighting-select").value,
          interceptMode: document.getElementById("intercept-mode").value,
          coefficients: currentCoeffs,
          standards,
          unknowns,
        };
        const blob = new Blob([JSON.stringify(payload, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "calibration-curve.json";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      // Event listeners
      document.getElementById("add-row-btn").addEventListener("click", () => {
        addStandardRow("", "", true);
        renumberStandardRows();
      });

      document
        .getElementById("clear-rows-btn")
        .addEventListener("click", clearStandards);
      document.getElementById("fit-btn").addEventListener("click", fitCurve);
      document
        .getElementById("reset-btn")
        .addEventListener("click", resetToExample);
      document
        .getElementById("export-json-btn")
        .addEventListener("click", exportData);
      document
        .getElementById("add-unknown-btn")
        .addEventListener("click", () => addUnknownRow("", ""));

      unknownsBody.addEventListener("input", (e) => {
        if (e.target.tagName.toLowerCase() === "input") {
          updateUnknowns();
        }
      });

      // Refit when labels or model settings change (optional)
      document.getElementById("model-select").addEventListener("change", () => {
        if (getStandardsData().length >= 2) fitCurve();
      });
      document
        .getElementById("weighting-select")
        .addEventListener("change", () => {
          if (getStandardsData().length >= 2) fitCurve();
        });
      document
        .getElementById("intercept-mode")
        .addEventListener("change", () => {
          if (getStandardsData().length >= 2) fitCurve();
        });
      document.getElementById("x-label").addEventListener("input", () => {
        if (chart) {
          chart.options.scales.x.title.text =
            document.getElementById("x-label").value;
          chart.update();
        }
      });
      document.getElementById("y-label").addEventListener("input", () => {
        if (chart) {
          chart.options.scales.y.title.text =
            document.getElementById("y-label").value;
          chart.update();
        }
      });

      // Initialize with example data
      resetToExample();
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

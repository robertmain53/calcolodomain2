<!DOCTYPE html><html lang="en"><head>
<link rel="canonical" href="https://calcdomain.com/fat-calculator">





<link rel="icon" type="ihttps://calcdomain.commage/png" href="https://calcdomain.com/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="https://calcdomain.com/https://calcdomain.comfavicon.svg">
<link rel="shortcut icon" href="https://calcdomain.com/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="https://calcdomain.com/apple-touch-icon.png">
<link rel="manifest" href="https://calcdomain.com/site.webmanifest">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Body Fat Calculator - Estimate Your Body Fat Percentage</title>
<meta name="description" content="A free, accessible calculator to estimate body fat percentage (BFP) using the U.S. Navy method or BMI. Includes formulas, health charts, and step-by-step examples.">


<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }

/* --- Accessibility & UX Enhancements --- */
/* Visible focus for keyboard navigation */
:focus-visible {
outline: 3px solid #3b82f6;
outline-offset: 2px;
border-radius: 4px;
}
/* Style for invalid fields */
input[aria-invalid="true"] {
border-color: #e11d48;
box-shadow: 0 0 0 1px #e11d48;
}
/* Error message styling */
.error-message {
color: #c1103c;
font-size: 0.875rem;
margin-top: 0.25rem;
display: none; /* Hidden by default */
}
/* Show error message when invalid */
input[aria-invalid="true"] + .error-message {
display: block;
}
/* Taller touch targets for accessibility */
.touch-target {
min-height: 48px;
min-width: 48px;
display: inline-flex;
align-items: center;
}
/* Accessible tooltip button */
.tooltip-btn {
background: none;
border: none;
padding: 0.25rem;
margin-left: 0.25rem;
cursor: help;
border-radius: 99px;
color: #6b7280;
}
.tooltip-btn:hover { color: #111827; }
.tooltip-content {
position: absolute;
background: #111827;
color: white;
padding: 0.5rem 0.75rem;
border-radius: 6px;
font-size: 0.875rem;
width: max-content;
max-width: 250px;
z-index: 10;
box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
}
/* Custom radio toggle */
.toggle-label {
cursor: pointer;
padding: 0.5rem 1rem;
border: 1px solid #d1d5db;
color: #374151;
font-weight: 500;
transition: all 0.2s ease-in-out;
}
.toggle-label:first-of-type { border-radius: 6px 0 0 6px; }
.toggle-label:last-of-type { border-radius: 0 6px 6px 0; margin-left: -1px; }
input[type="radio"]:checked + .toggle-label {
background-color: #3b82f6;
color: white;
border-color: #3b82f6;
z-index: 1;
position: relative;
}
/* --- End Accessibility Enhancements --- */

@media print {
body * { visibility: hidden; }
#print-section, #print-section * { visibility: visible; }
#print-section { position: absolute; left: 0; top: 0; width: 100%; }
#results-chart-container { display: none !important; }
}
</style>

<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Body Fat Calculator - Estimate Your Body Fat Percentage",
  "description": "A free, accessible calculator to estimate body fat percentage (BFP) using the U.S. Navy method or BMI. Includes formulas, health charts, and step-by-step examples.",
  "url": "https://calcdomain.com/fat-calculator",
  "inLanguage": "en",
  "reviewedBy": {
    "@type": "Person",
    "name": "Ugo Candido"
  },
  "dateModified": "2026-01-19"
}</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://calcdomain.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Health & Fitness",
      "item": "https://calcdomain.com/categories/health-fitness"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Diet Nutrition",
      "item": "https://calcdomain.com/subcategories/diet-nutrition"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Body Fat Calculator",
  "description": "Calculates body fat percentage, fat mass, and lean mass using the U.S. Navy or BMI-based formulas.",
  "applicationCategory": "HealthApplication",
  "operatingSystem": "All",
  "browserRequirements": "Requires a modern browser.",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  }
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to Use the Body Fat Calculator",
  "description": "A step-by-step guide to estimating your body fat percentage.",
  "step": [
    {
      "@type": "HowToStep",
      "name": "Select Units",
      "text": "Choose between Metric (kg, cm) and Imperial (lbs, ft, in) units."
    },
    {
      "@type": "HowToStep",
      "name": "Select Method",
      "text": "Choose the 'U.S. Navy' method (requires tape measurements) or the 'BMI-Based' method (quicker estimate)."
    },
    {
      "@type": "HowToStep",
      "name": "Enter Basic Info",
      "text": "Input your gender, age, height, and weight."
    },
    {
      "@type": "HowToStep",
      "name": "Enter Measurements (if U.S. Navy)",
      "text": "If using the U.S. Navy method, provide your neck, waist, and (if female) hip measurements."
    },
    {
      "@type": "HowToStep",
      "name": "Calculate & Review",
      "text": "Click 'Calculate' to see your results, including body fat percentage, fat mass, lean mass, and health category."
    }
  ]
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "Article",
"mainEntityOfPage": {
"@type": "WebPage",
"@id": "https://calcdomain.com/fat-calculator"
},
"headline": "Body Fat Calculator: A Comprehensive Guide",
"description": "This page provides an interactive tool to calculate body fat percentage, along with detailed explanations of the U.S. Navy and BMI-based formulas, data sources, and a step-by-step example.",
"image": "https://calcdomain.com/images/body-fat-chart.png",
"author": {
"@type": "Person",
"name": "Ugo Candido"
},
"publisher": {
"@type": "Organization",
"name": "CalcDomain",
"logo": {
"@type": "ImageObject",
"url": "https://calcdomain.com/logo.png"
}
},
"datePublished": "2025-02-15",
"dateModified": "2025-10-29",
"mainEntity": {
"@context": "https://schema.org",
"@type": "FAQPage",
"mainEntity": [
{
"@type": "Question",
"name": "How accurate is this body fat calculator?",
"acceptedAnswer": {
"@type": "Answer",
"text": "The accuracy depends on the method. The U.S. Navy method has a reported accuracy of ±3-4% for most people, but it requires precise measurements. The BMI-based method is a less accurate, general estimate. No calculator can replace a professional assessment like a DEXA scan."
}
},
{
"@type": "Question",
"name": "What is the U.S. Navy method?",
"acceptedAnswer": {
"@type": "Answer",
"text": "The U.S. Navy method (also called the 'DoD method') is a circumference-based formula developed by Hodgdon & Beckett in 1984. It uses tape measurements of height, neck, waist, and (for women) hips to estimate body fat percentage."
}
},
{
"@type": "Question",
"name": "Why is my Body Fat Percentage (BFP) different from my BMI?",
"acceptedAnswer": {
"@type": "Answer",
"text": "BMI (Body Mass Index) only measures your weight relative to your height. It cannot tell the difference between muscle and fat. Body Fat Percentage (BFP) specifically estimates the portion of your weight that is fat. An athlete, for example, might have a high BMI (due to muscle) but a low BFP."
}
},
{
"@type": "Question",
"name": "How should I measure my waist, neck, and hip?",
"acceptedAnswer": {
"@type":E": "Answer",
"text": "For accurate results, be consistent. Use a flexible tape measure (not a metal one). \n- Neck: Measure just below the larynx (Adam's apple), rounding up to the nearest half-inch or 0.5 cm.\n- Waist: For men, measure at the navel. For women, measure at the narrowest point between the ribs and hip bone. \n- Hip (Women only): Measure at the widest point of the hips/buttocks. \nAll measurements should be taken without sucking in or pulling the tape too tight."
}
},
{
"@type": "Question",
"name": "What is a healthy body fat percentage?",
"acceptedAnswer": {
"@type": "Answer",
"text": "Healthy ranges vary by age and gender. Generally, for men, 10-20% is considered healthy or 'fitness'. For women, 20-30% is the equivalent range. Essential fat (the minimum needed for health) is around 2-5% for men and 10-13% for women."
}
},
{
"@type": "Question",
"name": "Is this calculator suitable for children or bodybuilders?",
"acceptedAnswer": {
"@type": "Answer",
"text": "No. These formulas were developed for and validated on average adults. They are known to be inaccurate for children, pregnant women, the elderly, and individuals with very high muscle mass (like bodybuilders), as they don't fit the standard assumptions of the model."
}
}
]
}
}
</script>


<style>
/* AUDIT_SPINE_CSS */
.auditspine-note{
  border:1px solid #e5e7eb;
  background:#fff;
  border-radius:12px;
  padding:12px;
  color:#475569;
  font-size:13px;
  line-height:1.5;
}
.auditspine-mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.auditspine-changelog{
  border:1px solid #e5e7eb;
  background:#fff;
  border-left:5px solid #334155;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  color:#475569;
}
.auditspine-formula{
  margin:10px 0;
  background:#0b1220;
  color:#e5e7eb;
  border-radius:12px;
  padding:12px;
  border:1px solid rgba(255,255,255,.12);
  overflow-x:auto;
}
.auditspine-formula pre{margin:8px 0 0; white-space:pre-wrap;}
.auditspine-hr{border:none; border-top:1px solid #e5e7eb; margin:18px 0;}
</style>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">


<!-- AUDIT_SPINE_START -->
<hr class="auditspine-hr">
<section aria-label="Formulas, sources, changelog, verification">
  <span class="auditspine-badge">Audit: Complete</span>

  <details style="margin-top:10px">
    <summary><strong>Formula (LaTeX) + variables + units</strong></summary>
    <div class="auditspine-note" style="margin-top:10px">
      This section shows the formulas used by the calculator engine, plus variable definitions and units.
      
    </div>
    <div class="auditspine-formula">
      <div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[BFP \% = 86.010 \times \log_{10}(\text{waist}_{cm} - \text{neck}_{cm}) - 70.041 \times \log_{10}(\text{height}_{cm}) + 36.76\]</div>
  <pre class="auditspine-mono">BFP \% = 86.010 \times \log_{10}(\text{waist}_{cm} - \text{neck}_{cm}) - 70.041 \times \log_{10}(\text{height}_{cm}) + 36.76</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[BFP \% = 163.205 \times \log_{10}(\text{waist}_{cm} + \text{hip}_{cm} - \text{neck}_{cm}) - 97.684 \times \log_{10}(\text{height}_{cm}) - 78.387\]</div>
  <pre class="auditspine-mono">BFP \% = 163.205 \times \log_{10}(\text{waist}_{cm} + \text{hip}_{cm} - \text{neck}_{cm}) - 97.684 \times \log_{10}(\text{height}_{cm}) - 78.387</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[BMI = \frac{\text{weight}_{kg}}{\text{height}_m^2}\]</div>
  <pre class="auditspine-mono">BMI = \frac{\text{weight}_{kg}}{\text{height}_m^2}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[BFP \% = (1.20 \times BMI) + (0.23 \times \text{Age}) - (10.8 \times \text{Gender}) - 5.4\]</div>
  <pre class="auditspine-mono">BFP \% = (1.20 \times BMI) + (0.23 \times \text{Age}) - (10.8 \times \text{Gender}) - 5.4</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\text{Fat Mass} = \text{Total Weight} \times (BFP \% / 100)\]</div>
  <pre class="auditspine-mono">\text{Fat Mass} = \text{Total Weight} \times (BFP \% / 100)</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted LaTeX)</strong></div>
  <div style="margin-top:6px">\[\text{Lean Body Mass} = \text{Total Weight} - \text{Fat Mass}\]</div>
  <pre class="auditspine-mono">\text{Lean Body Mass} = \text{Total Weight} - \text{Fat Mass}</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$BFP \% = 86.010 \times \log_{10}(\text{waist}_{cm} - \text{neck}_{cm}) - 70.041 \times \log_{10}(\text{height}_{cm}) + 36.76$</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$BFP \% = 163.205 \times \log_{10}(\text{waist}_{cm} + \text{hip}_{cm} - \text{neck}_{cm}) - 97.684 \times \log_{10}(\text{height}_{cm}) - 78.387$</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$BMI = \frac{\text{weight}_{kg}}{\text{height}_m^2}$</pre>
</div>
<div style="margin:10px 0">
  <div><strong>Formula (extracted text)</strong></div>
  
  <pre class="auditspine-mono">$BFP \% = (1.20 \times BMI) + (0.23 \times \text{Age}) - (10.8 \times \text{Gender}) - 5.4$</pre>
</div>
      <div style="margin-top:12px"><strong>Variables and units</strong></div>
      <ul style="margin:8px 0 0 18px">
        <li><em>No variables provided in audit spec.</em></li>
      </ul>
    </div>
  </details>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Sources (authoritative):</strong>
    <ul style="margin:8px 0 0 18px">
      <li><strong>Home</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/" target="_blank" rel="nofollow noopener">https://calcdomain.com/</a></li>
<li><strong>Health &amp; Fitness</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/health-fitness" target="_blank" rel="nofollow noopener">https://calcdomain.com/health-fitness</a></li>
<li><strong>Diet &amp; Nutrition</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/subcategories/diet-nutrition" target="_blank" rel="nofollow noopener">https://calcdomain.com/subcategories/diet-nutrition</a></li>
<li><strong>BMI Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/bmi-calculator" target="_blank" rel="nofollow noopener">https://calcdomain.com/bmi-calculator</a></li>
<li><strong>BMR Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/bmr" target="_blank" rel="nofollow noopener">https://calcdomain.com/bmr</a></li>
<li><strong>TDEE Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/tdee" target="_blank" rel="nofollow noopener">https://calcdomain.com/tdee</a></li>
<li><strong>Ideal Weight Calculator</strong> — calcdomain.com · Accessed 2026-01-19<br><a href="https://calcdomain.com/ideal-weight" target="_blank" rel="nofollow noopener">https://calcdomain.com/ideal-weight</a></li>
    </ul>
  </div>

  <div class="auditspine-changelog" style="margin-top:12px">
    <strong>Changelog</strong><br>
    <div style="margin-top:6px">
      <strong>Version:</strong> 0.1.0-draft<br>
      <strong>Last code update:</strong> 2026-01-19
    </div>
    <div style="margin-top:10px">
  <strong>0.1.0-draft</strong> · 2026-01-19
  <ul style="margin:6px 0 0 18px">
    <li>Initial audit spec draft generated from HTML extraction (review required).</li>
<li>Verify formulas match the calculator engine and convert any text-only formulas to LaTeX.</li>
<li>Confirm sources are authoritative and relevant to the calculator methodology.</li>
  </ul>
</div>
  </div>

  <div class="auditspine-note" style="margin-top:12px">
    <strong>Verified by Ugo Candido on 2026-01-19</strong><br>
    <a href="https://calcdomain.com/ugocandido" target="_blank" rel="noopener">Profile</a> ·
    <a href="https://www.linkedin.com/in/ugocandido92821/" target="_blank" rel="noopener">LinkedIn</a>
  </div>
</section>
<!-- AUDIT_SPINE_END -->
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why Use This Calculator?</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Get an estimate of your body composition, not just weight.</li>
<li>Compare two of the most common estimation methods.</li>
<li>Understand the formulas and data sources behind the calculation.</li>
<li>Track changes in fat mass and lean mass over time (when used consistently).</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related Health Tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="https://calcdomain.com/bmi-calculator" class="text-blue-600 hover:underline">BMI Calculator</a></li>
<li><a href="https://calcdomain.com/bmr" class="text-blue-600 hover:underline">BMR Calculator</a></li>
<li><a href="https://calcdomain.com/tdee" class="text-blue-600 hover:underline">TDEE Calculator</a></li>
<li><a href="https://calcdomain.com/ideal-weight" class="text-blue-600 hover:underline">Ideal Weight Calculator</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-gray-900 text-white py-12">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
        <p class="text-gray-400 mb-4">
          Your trusted source for free online calculators. Accurate, fast, and reliable calculations for every need.
        </p>
        </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Categories</h4>
                                                                                                                                                                                                                                                <ul class="space-y-2">
          <li><a href="https://calcdomain.com/categories/construction" class="text-gray-400 hover:text-white">Construction</a></li>
          <li><a href="https://calcdomain.com/categories/construction-diy" class="text-gray-400 hover:text-white">Construction & DIY</a></li>
          <li><a href="https://calcdomain.com/categories/engineering" class="text-gray-400 hover:text-white">Engineering</a></li>
          <li><a href="https://calcdomain.com/categories/finance" class="text-gray-400 hover:text-white">Finance</a></li>
          <li><a href="https://calcdomain.com/categories/general" class="text-gray-400 hover:text-white">General</a></li>
          <li><a href="https://calcdomain.com/categories/health-fitness" class="text-gray-400 hover:text-white">Health & Fitness</a></li>
          <li><a href="https://calcdomain.com/categories/lifestyle-everyday" class="text-gray-400 hover:text-white">Lifestyle & Everyday</a></li>
          <li><a href="https://calcdomain.com/categories/math" class="text-gray-400 hover:text-white">Math</a></li>
          <li><a href="https://calcdomain.com/categories/math-conversions" class="text-gray-400 hover:text-white">Math & Conversions</a></li>
          <li><a href="https://calcdomain.com/categories/science" class="text-gray-400 hover:text-white">Science</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/mortgage-payment" class="text-gray-400 hover:text-white">Mortgage Calculator</a></li>
          <li><a href="https://calcdomain.com/percentage-calculator" class="text-gray-400 hover:text-white">Percentage Calculator</a></li>
          <li><a href="https://calcdomain.com/bmi-calculator" class="text-gray-400 hover:text-white">BMI Calculator</a></li>
          <li><a href="https://calcdomain.com/auto-loan-calculator" class="text-gray-400 hover:text-white">Auto Loan Calculator</a></li>
          <li><a href="https://calcdomain.com/house-affordability" class="text-gray-400 hover:text-white">House Affordability</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-lg font-semibold mb-4">Support</h4>
        <ul class="space-y-2">
          <li><a href="https://calcdomain.com/about" class="text-gray-400 hover:text-white">About Us</a></li>
          <li><a href="https://calcdomain.com/contact" class="text-gray-400 hover:text-white">Contact</a></li>
          <li><a href="https://calcdomain.com/privacy" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
          <li><a href="https://calcdomain.com/terms" class="text-gray-400 hover:text-white">Terms of Service</a></li>
          <li><a href="https://calcdomain.com/sitemap.xml" class="text-gray-400 hover:text-white">Site Map</a></li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 CalcDomain. All Rights Reserved. | Free Online Calculators for Everyone</p>
    </div>
  </div>
</footer>
































<script defer="">
document.addEventListener('DOMContentLoaded', () => {

// --- DOM Element Selection ---
const ui = {
form: document.getElementById('calculator-ui'),
unitMetric: document.getElementById('units-metric'),
unitImperial: document.getElementById('units-imperial'),
methodNavy: document.getElementById('method-navy'),
methodBmi: document.getElementById('method-bmi'),
genderMale: document.getElementById('gender-male'),
genderFemale: document.getElementById('gender-female'),
age: document.getElementById('age'),
heightFt: document.getElementById('height-ft'),
heightIn: document.getElementById('height-in'),
heightCm: document.getElementById('height-cm'),
heightImperialGroup: document.getElementById('height-imperial-group'),
heightMetricGroup: document.getElementById('height-metric-group'),
weight: document.getElementById('weight'),
neck: document.getElementById('neck'),
waist: document.getElementById('waist'),
hip: document.getElementById('hip'),
hipGroup: document.getElementById('hip-group'),
navyFields: document.getElementById('navy-fields'),
weightUnit: document.getElementById('weight-unit'),
neckUnit: document.getElementById('neck-unit'),
waistUnit: document.getElementById('waist-unit'),
hipUnit: document.getElementById('hip-unit'),
calculateBtn: document.getElementById('calculate-btn'),
clearBtn: document.getElementById('clear-btn'),
results: document.getElementById('results'),
resultsHeading: document.getElementById('results-heading'),
resultBfp: document.getElementById('result-bfp'),
resultFatMass: document.getElementById('result-fat-mass'),
resultLeanMass: document.getElementById('result-lean-mass'),
resultFatMassUnit: document.getElementById('result-fat-mass-unit'),
resultLeanMassUnit: document.getElementById('result-lean-mass-unit'),
resultBfpCategoryValue: document.getElementById('result-bfp-category-value'),
resultCategory: document.getElementById('result-category'),
tooltipBtns: document.querySelectorAll('.tooltip-btn')
};

const categoryRows = {
essential: document.getElementById('cat-row-essential'),
athletes: document.getElementById('cat-row-athletes'),
fitness: document.getElementById('cat-row-fitness'),
acceptable: document.getElementById('cat-row-acceptable'),
obese: document.getElementById('cat-row-obese')
};

// --- State Management ---
let currentUnit = 'metric'; // 'metric' or 'imperial'
let currentMethod = 'navy'; // 'navy' or 'bmi'
let currentGender = 'male'; // 'male' or 'female'

// --- Event Listeners ---
ui.unitMetric.addEventListener('change', handleUnitChange);
ui.unitImperial.addEventListener('change', handleUnitChange);
ui.methodNavy.addEventListener('change', handleMethodChange);
ui.methodBmi.addEventListener('change', handleMethodChange);
ui.genderMale.addEventListener('change', handleGenderChange);
ui.genderFemale.addEventListener('change', handleGenderChange);
ui.calculateBtn.addEventListener('click', handleCalculate);
ui.clearBtn.addEventListener('click', handleClear);

// Add blur validation listeners
const inputsToValidate = [ui.age, ui.heightFt, ui.heightIn, ui.heightCm, ui.weight, ui.neck, ui.waist, ui.hip];
inputsToValidate.forEach(input => {
input.addEventListener('blur', () => validateField(input));
});

// Tooltip listeners
ui.tooltipBtns.forEach(btn => {
const tooltipId = btn.getAttribute('data-tooltip-id');
const tooltip = document.getElementById(tooltipId);
if (tooltip) {
btn.addEventListener('click', () => toggleTooltip(tooltip, btn));
btn.addEventListener('blur', () => hideTooltip(tooltip));
btn.addEventListener('keydown', (e) => {
if (e.key === 'Escape') hideTooltip(tooltip);
});
}
});

// --- UI Toggles ---
function handleUnitChange(e) {
currentUnit = e.target.value;
updateUnits();
}

function handleMethodChange(e) {
currentMethod = e.target.value;
updateMethodView();
}

function handleGenderChange(e) {
currentGender = e.target.value;
updateHipFieldVisibility();
}

function updateUnits() {
const isMetric = currentUnit === 'metric';
const weightLabel = isMetric ? 'kg' : 'lbs';
const lengthLabel = isMetric ? 'cm' : 'in';

ui.heightMetricGroup.classList.toggle('hidden', !isMetric);
ui.heightImperialGroup.classList.toggle('hidden', isMetric);

ui.weightUnit.textContent = weightLabel;
ui.neckUnit.textContent = lengthLabel;
ui.waistUnit.textContent = lengthLabel;
ui.hipUnit.textContent = lengthLabel;

// Update required attributes
ui.heightCm.ariaRequired = isMetric ? 'true' : 'false';
ui.heightFt.ariaRequired = !isMetric ? 'true' : 'false';
ui.heightIn.ariaRequired = !isMetric ? 'true' : 'false';
}

function updateMethodView() {
const isNavy = currentMethod === 'navy';
ui.navyFields.classList.toggle('hidden', !isNavy);

// Update required attributes
ui.neck.ariaRequired = isNavy ? 'true' : 'false';
ui.waist.ariaRequired = isNavy ? 'true' : 'false';
updateHipFieldVisibility(); // Re-check hip visibility
}

function updateHipFieldVisibility() {
const isNavy = currentMethod === 'navy';
const isFemale = currentGender === 'female';
const showHip = isNavy && isFemale;

ui.hipGroup.classList.toggle('hidden', !showHip);
ui.hip.ariaRequired = showHip ? 'true' : 'false';
}

// --- Tooltip Logic ---
function toggleTooltip(tooltip, btn) {
const isHidden = tooltip.classList.toggle('hidden');
btn.setAttribute('aria-expanded', !isHidden);
if (!isHidden) {
// Position tooltip (simple version)
const btnRect = btn.getBoundingClientRect();
tooltip.style.left = `${btnRect.left}px`;
tooltip.style.top = `${btnRect.bottom + 4}px`;
}
}

function hideTooltip(tooltip) {
tooltip.classList.add('hidden');
const btn = document.querySelector(`[data-tooltip-id="${tooltip.id}"]`);
if (btn) btn.setAttribute('aria-expanded', 'false');
}

// --- Validation Logic ---
function validateField(input) {
if (!input) return true;

const isVisible = !input.closest('.hidden');
const isRequired = input.ariaRequired === 'true';

if (!isVisible || !isRequired) {
setValidity(input, true);
return true;
}

const value = parseFloat(input.value);
const min = parseFloat(input.min);
const max = parseFloat(input.max);
let isValid = true;

if (isNaN(value)) {
isValid = false;
} else if (!isNaN(min) && value < min) {
isValid = false;
} else if (!isNaN(max) && value > max) {
isValid = false;
}

setValidity(input, isValid);
return isValid;
}

function setValidity(input, isValid) {
const errorDiv = document.getElementById(input.getAttribute('aria-describedby').split(' ')[0]);
if (isValid) {
input.setAttribute('aria-invalid', 'false');
if (errorDiv) errorDiv.style.display = 'none';
} else {
input.setAttribute('aria-invalid', 'true');
if (errorDiv) errorDiv.style.display = 'block';
}
}

function validateForm() {
let isFormValid = true;
let firstErrorField = null;

const fieldsToValidate = [
ui.age,
ui.weight,
...(currentUnit === 'metric' ? [ui.heightCm] : [ui.heightFt, ui.heightIn]),
...(currentMethod === 'navy' ? [ui.neck, ui.waist] : []),
...(currentMethod === 'navy' && currentGender === 'female' ? [ui.hip] : [])
];

fieldsToValidate.forEach(field => {
if (!validateField(field)) {
isFormValid = false;
if (!firstErrorField) {
firstErrorField = field;
}
}
});

if (firstErrorField) {
firstErrorField.focus();
}

return isFormValid;
}

// --- Calculation Logic ---
function handleCalculate() {
// Clear previous results and highlights
ui.results.classList.add('hidden');
resetCategoryHighlights();

if (!validateForm()) {
return;
}

// 1. Get and normalize values to METRIC
const values = getMetricValues();
if (!values) return;

const { age, heightCm, weightKg, neckCm, waistCm, hipCm } = values;

// 2. Perform calculation
let bfp;
const heightM = heightCm / 100;
const bmi = weightKg / (heightM * heightM);

if (currentMethod === 'navy') {
if (currentGender === 'male') {
if (waistCm <= neckCm) {
alert("Waist measurement must be greater than neck measurement.");
return;
}
bfp = 86.010 * Math.log10(waistCm - neckCm) - 70.041 * Math.log10(heightCm) + 36.76;
} else { // Female
if ((waistCm + hipCm) <= neckCm) {
alert("Waist + Hip measurement must be greater than neck measurement.");
return;
}
bfp = 163.205 * Math.log10(waistCm + hipCm - neckCm) - 97.684 * Math.log10(heightCm) - 78.387;
}
} else { // BMI method
const genderVal = (currentGender === 'male') ? 1 : 0;
bfp = (1.20 * bmi) + (0.23 * age) - (10.8 * genderVal) - 5.4;
}

// Ensure BFP is within a reasonable range (e.g., essential fat to 60%)
const essentialFat = (currentGender === 'male') ? 2 : 10;
bfp = Math.max(essentialFat, Math.min(bfp, 60));

// 3. Calculate derived metrics
const fatMassKg = weightKg * (bfp / 100);
const leanMassKg = weightKg - fatMassKg;

// 4. Convert for display if needed
const displayWeightUnit = currentUnit === 'metric' ? 'kg' : 'lbs';
const fatMassDisplay = currentUnit === 'metric' ? fatMassKg : kgToLbs(fatMassKg);
const leanMassDisplay = currentUnit === 'metric' ? leanMassKg : kgToLbs(leanMassKg);

// 5. Render results
renderResults(bfp, fatMassDisplay, leanMassDisplay, displayWeightUnit);
}

function getMetricValues() {
const age = parseFloat(ui.age.value);
let heightCm, weightKg, neckCm, waistCm, hipCm;

if (currentUnit === 'metric') {
heightCm = parseFloat(ui.heightCm.value);
weightKg = parseFloat(ui.weight.value);
neckCm = parseFloat(ui.neck.value);
waistCm = parseFloat(ui.waist.value);
hipCm = parseFloat(ui.hip.value);
} else {
const ft = parseFloat(ui.heightFt.value) || 0;
const inches = parseFloat(ui.heightIn.value) || 0;
heightCm = (ft * 12 + inches) * 2.54;
weightKg = lbsToKg(parseFloat(ui.weight.value));
neckCm = inToCm(parseFloat(ui.neck.value));
waistCm = inToCm(parseFloat(ui.waist.value));
hipCm = inToCm(parseFloat(ui.hip.value));
}

return { age, heightCm, weightKg, neckCm, waistCm, hipCm, gender: currentGender };
}

function renderResults(bfp, fatMass, leanMass, unit) {
const bfpFixed = bfp.toFixed(1);
const fatMassFixed = fatMass.toFixed(1);
const leanMassFixed = leanMass.toFixed(1);

ui.resultBfp.textContent = `${bfpFixed}%`;
ui.resultFatMass.textContent = `${fatMassFixed}`;
ui.resultLeanMass.textContent = `${leanMassFixed}`;
ui.resultFatMassUnit.textContent = unit;
ui.resultLeanMassUnit.textContent = unit;

const { category, rowId } = getCategory(bfp, currentGender);
ui.resultBfpCategoryValue.textContent = `${bfpFixed}%`;
ui.resultCategory.textContent = category;

// Highlight the correct row
const rowToHighlight = document.getElementById(rowId);
if (rowToHighlight) {
rowToHighlight.classList.add('bg-blue-100', 'font-bold');
}

ui.results.classList.remove('hidden');
ui.resultsHeading.focus(); // Focus for accessibility
}

function getCategory(bfp, gender) {
if (gender === 'male') {
if (bfp < 6) return { category: 'Essential Fat (Low)', rowId: 'cat-row-essential' };
if (bfp < 14) return { category: 'Athletes', rowId: 'cat-row-athletes' };
if (bfp < 18) return { category: 'Fitness', rowId: 'cat-row-fitness' };
if (bfp < 25) return { category: 'Acceptable', rowId: 'cat-row-acceptable' };
return { category: 'Obese', rowId: 'cat-row-obese' };
} else { // Female
if (bfp < 14) return { category: 'Essential Fat (Low)', rowId: 'cat-row-essential' };
if (bfp < 21) return { category: 'Athletes', rowId: 'cat-row-athletes' };
if (bfp < 25) return { category: 'Fitness', rowId: 'cat-row-fitness' };
if (bfp < 32) return { category: 'Acceptable', rowId: 'cat-row-acceptable' };
return { category: 'Obese', rowId: 'cat-row-obese' };
}
}

function resetCategoryHighlights() {
Object.values(categoryRows).forEach(row => {
if (row) row.classList.remove('bg-blue-100', 'font-bold');
});
}

// --- Clear Form ---
function handleClear() {
ui.form.reset();
// Reset state variables and UI
currentUnit = 'metric';
currentMethod = 'navy';
currentGender = 'male';
updateUnits();
updateMethodView();
ui.results.classList.add('hidden');
resetCategoryHighlights();

// Clear all validation states
inputsToValidate.forEach(input => setValidity(input, true));
}

// --- Unit Conversion Helpers ---
const lbsToKg = (lbs) => lbs * 0.453592;
const kgToLbs = (kg) => kg * 2.20462;
const inToCm = (inches) => inches * 2.54;

// --- Initial Setup ---
updateUnits();
updateMethodView();
});
</script>


</body></html>
<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/playfair-cipher" />
    <title>Playfair Cipher Calculator (2024 Guide) | CalcDomain</title>
    <meta name="description" content="Calculate Playfair Cipher Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Playfair Cipher Calculator (2024 Guide) | CalcDomain" />
    <meta property="og:description" content="Calculate Playfair Cipher Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />
    <meta property="og:url" content="https://calcdomain.com/playfair-cipher" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Playfair Cipher Calculator (2024 Guide) | CalcDomain" />
    <meta name="twitter:description" content="Calculate Playfair Cipher Calculator in seconds with this free tool. Get accurate results, formulas, and tips - start now. No signup. Try it today." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Engineering Calculators", "item": "https://calcdomain.com/categories/engineering"}, {"@type": "ListItem", "position": 3, "name": "Mechanical Engineering Now Tools &", "item": "https://calcdomain.com/subcategories/engineering-mechanical"}, {"@type": "ListItem", "position": 4, "name": "Playfair Cipher Encoder &amp; Decoder", "item": "https://calcdomain.com/playfair-cipher"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/engineering" class="text-blue-600 hover:underline">Engineering Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/engineering-mechanical" class="text-blue-600 hover:underline">Mechanical Engineering Now Tools &amp;</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Playfair Cipher Encoder &amp;amp; Decoder</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h1 class="text-2xl md:text-3xl font-bold mb-2">
              Playfair Cipher Encoder &amp; Decoder
            </h1>
            <p class="text-gray-600 mb-4">
              Encrypt or decrypt text using the classic Playfair cipher.
              Customize the keyword, alphabet variant, padding rules, and see a
              step‑by‑step digraph breakdown.
            </p>

            <!-- Calculator UI -->
            <section aria-labelledby="playfair-tool" class="mb-8">
              <h2 id="playfair-tool" class="text-xl font-semibold mb-4">
                Playfair Cipher Tool
              </h2>

              <div class="grid md:grid-cols-2 gap-6 mb-4">
                <div>
                  <label
                    for="mode"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Mode</label
                  >
                  <select
                    id="mode"
                    class="w-full border border-gray-300 rounded-md px-3 py-2"
                  >
                    <option value="encrypt">
                      Encrypt (plaintext → ciphertext)
                    </option>
                    <option value="decrypt">
                      Decrypt (ciphertext → plaintext)
                    </option>
                  </select>
                </div>
                <div>
                  <label
                    for="keyword"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Keyword / Key phrase</label
                  >
                  <input
                    id="keyword"
                    type="text"
                    class="w-full border border-gray-300 rounded-md px-3 py-2"
                    placeholder="e.g. PLAYFAIR EXAMPLE"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Letters only; spaces and duplicates are removed
                    automatically.
                  </p>
                </div>
              </div>

              <div class="grid md:grid-cols-2 gap-6 mb-4">
                <div>
                  <label
                    for="alphabetVariant"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Alphabet variant</label
                  >
                  <select
                    id="alphabetVariant"
                    class="w-full border border-gray-300 rounded-md px-3 py-2"
                  >
                    <option value="IJ">
                      25 letters, I/J combined (classic)
                    </option>
                    <option value="QV">25 letters, Q omitted</option>
                    <option value="full">Full A–Z (6×6 with digits 0–9)</option>
                  </select>
                  <p class="text-xs text-gray-500 mt-1">
                    Full A–Z uses a 6×6 grid with digits 0–9 appended.
                  </p>
                </div>
                <div>
                  <label
                    for="paddingLetter"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Padding letter</label
                  >
                  <input
                    id="paddingLetter"
                    type="text"
                    maxlength="1"
                    class="w-24 border border-gray-300 rounded-md px-3 py-2"
                    value="X"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Used to split double letters and pad odd length text.
                  </p>
                </div>
              </div>

              <div class="grid md:grid-cols-2 gap-6 mb-4">
                <div>
                  <label
                    for="doubleRule"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Double-letter rule</label
                  >
                  <select
                    id="doubleRule"
                    class="w-full border border-gray-300 rounded-md px-3 py-2"
                  >
                    <option value="split">
                      Split pair with padding letter (standard)
                    </option>
                    <option value="skip">Allow double letters unchanged</option>
                  </select>
                </div>
                <div>
                  <label
                    for="preserveSpacing"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Output formatting</label
                  >
                  <select
                    id="preserveSpacing"
                    class="w-full border border-gray-300 rounded-md px-3 py-2"
                  >
                    <option value="group5">Group in blocks of 5</option>
                    <option value="continuous">
                      Continuous text (no spaces)
                    </option>
                    <option value="mirror">
                      Mirror original spacing &amp; punctuation
                    </option>
                  </select>
                </div>
              </div>

              <div class="mb-4">
                <label
                  for="inputText"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Input text</label
                >
                <textarea
                  id="inputText"
                  rows="4"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 mono"
                  placeholder="Enter plaintext or ciphertext here..."
                ></textarea>
              </div>

              <div class="flex flex-wrap items-center gap-3 mb-4">
                <button
                  id="runButton"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700"
                >
                  Run Playfair
                </button>
                <button
                  id="swapButton"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-800 text-sm font-medium rounded-md hover:bg-gray-200"
                >
                  Swap input/output
                </button>
                <button
                  id="clearButton"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-800 text-sm font-medium rounded-md hover:bg-gray-200"
                >
                  Clear
                </button>
                <span id="errorMessage" class="text-sm text-red-600"></span>
              </div>

              <div class="mb-4">
                <label
                  for="outputText"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Result</label
                >
                <textarea
                  id="outputText"
                  rows="3"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 mono"
                  readonly
                ></textarea>
              </div>

              <!-- Key square and digraph breakdown -->
              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <h3 class="text-sm font-semibold text-gray-800 mb-2">
                    Key square
                  </h3>
                  <div
                    id="keySquareContainer"
                    class="inline-grid gap-1 border border-gray-200 rounded-md p-2 bg-gray-50"
                  ></div>
                  <p
                    id="keySquareCaption"
                    class="text-xs text-gray-500 mt-2"
                  ></p>
                </div>
                <div>
                  <h3 class="text-sm font-semibold text-gray-800 mb-2">
                    Digraph breakdown
                  </h3>
                  <div
                    id="digraphTable"
                    class="border border-gray-200 rounded-md max-h-64 overflow-y-auto text-xs bg-gray-50"
                  >
                    <table class="min-w-full text-left mono">
                      <thead class="bg-gray-100 sticky top-0">
                        <tr>
                          <th class="px-2 py-1 border-b">#</th>
                          <th class="px-2 py-1 border-b">Pair</th>
                          <th class="px-2 py-1 border-b">Rule</th>
                          <th class="px-2 py-1 border-b">→</th>
                        </tr>
                      </thead>
                      <tbody id="digraphBody"></tbody>
                    </table>
                  </div>
                </div>
              </div>
            </section>

            <!-- Explanatory content -->
            <section class="prose mt-8">
              <h2>How the Playfair cipher works</h2>
              <p>
                The Playfair cipher is a classical manual encryption method that
                encrypts <strong>pairs of letters</strong> (digraphs) using a
                <strong>5×5 key square</strong> built from a keyword. It is
                stronger than simple substitution ciphers because it hides
                single‑letter frequencies.
              </p>

              <h3>1. Building the key square</h3>
              <p>To construct the key square:</p>
              <ol>
                <li>
                  Choose a keyword or key phrase (for example,
                  <code>PLAYFAIR EXAMPLE</code>).
                </li>
                <li>Remove all non‑letters and convert to uppercase.</li>
                <li>
                  Remove duplicate letters, keeping only the first occurrence.
                </li>
                <li>
                  Append the remaining letters of the alphabet that are not yet
                  used.
                </li>
                <li>Write the 25 letters row by row into a 5×5 grid.</li>
              </ol>
              <p>
                Traditionally, <strong>I</strong> and <strong>J</strong> share a
                single cell, so only 25 letters are needed. This tool also
                supports a variant that omits <strong>Q</strong>, and a 6×6 mode
                with digits 0–9.
              </p>

              <div class="formula-box mono text-sm">
                Example keyword: <strong>PLAYFAIR EXAMPLE</strong><br />
                Cleaned keyword: <strong>PLAYFAIREXAMPLE</strong><br />
                Unique letters: <strong>PLAYFIREXM</strong><br />
                Remaining alphabet (I/J combined):
                <strong>BCDGHJKNOQSTUVWZ</strong><br />
                Final key square rows:
                <strong
                  >PLAYF&nbsp;IREXM&nbsp;BCDGH&nbsp;JKNOQ&nbsp;STUVWZ</strong
                >
              </div>

              <h3>2. Preparing the plaintext</h3>
              <p>Before encryption, the plaintext is normalized:</p>
              <ul>
                <li>
                  Keep only letters (optionally digits in 6×6 mode) and convert
                  to uppercase.
                </li>
                <li>
                  Replace <strong>J</strong> with <strong>I</strong> if using
                  the I/J combined alphabet.
                </li>
                <li>Split into digraphs (pairs of letters).</li>
                <li>
                  If a pair contains the same letter twice (e.g.
                  <code>LL</code>), insert a padding letter (commonly
                  <code>X</code>) between them.
                </li>
                <li>
                  If the final group has a single letter, append the padding
                  letter.
                </li>
              </ul>
              <p>
                This tool lets you choose the padding letter and whether to
                strictly split double letters or allow them unchanged.
              </p>

              <h3>3. Encryption rules for each digraph</h3>
              <p>For each pair of letters in the key square:</p>
              <ol>
                <li>
                  <strong>Same row:</strong> Replace each letter with the letter
                  immediately to its right (wrap around at the end of the row).
                </li>
                <li>
                  <strong>Same column:</strong> Replace each letter with the
                  letter immediately below it (wrap around at the bottom).
                </li>
                <li>
                  <strong>Rectangle:</strong> If they form the corners of a
                  rectangle, replace each letter with the letter in the same row
                  but in the other letter’s column.
                </li>
              </ol>
              <p>
                Decryption uses the same rules but shifts left in rows and up in
                columns.
              </p>

              <h3>4. Example</h3>
              <p>
                Using the classic keyword <code>PLAYFAIR EXAMPLE</code> and
                padding letter <code>X</code>:
              </p>
              <ul>
                <li>Plaintext: <code>HIDETHEGOLDINTHETREESTUMP</code></li>
                <li>
                  Prepared digraphs:
                  <code>HI DE TH EG OL DI NT HE TR EE ST UM PX</code>
                </li>
                <li>
                  Encrypted ciphertext: <code>BMODZBXDNABEKUDMUIXMMOUVIF</code>
                </li>
              </ul>
              <p>
                If you enter this example into the tool with the same settings,
                the step‑by‑step table will show exactly how each digraph is
                transformed.
              </p>

              <h2>Options and variants in this tool</h2>
              <h3>Alphabet variants</h3>
              <ul>
                <li>
                  <strong>25 letters, I/J combined:</strong> Traditional
                  Playfair; I and J map to the same cell.
                </li>
                <li>
                  <strong>25 letters, Q omitted:</strong> Alternative historical
                  variant that keeps I and J separate but removes Q.
                </li>
                <li>
                  <strong>Full A–Z + digits 0–9:</strong> Extended 6×6 grid for
                  alphanumeric messages.
                </li>
              </ul>

              <h3>Padding and formatting</h3>
              <ul>
                <li>
                  <strong>Padding letter:</strong> Default is <code>X</code>,
                  but you can choose any character present in the alphabet.
                </li>
                <li>
                  <strong>Double‑letter rule:</strong> Either split repeated
                  letters with padding (standard) or allow them unchanged.
                </li>
                <li>
                  <strong>Output formatting:</strong> Group in blocks of 5,
                  continuous text, or mirror the original spacing and
                  punctuation.
                </li>
              </ul>

              <h2>Limitations and security notes</h2>
              <ul>
                <li>
                  The Playfair cipher is <strong>not secure</strong> by modern
                  cryptographic standards.
                </li>
                <li>
                  It can be broken with frequency analysis of digraphs and
                  known‑plaintext attacks.
                </li>
                <li>
                  Use it only for educational purposes, puzzles, or low‑stakes
                  games—not for real security.
                </li>
              </ul>
            </section>

            <section class="prose mt-8">
              <h2>Frequently asked questions</h2>

              <h3>Is the Playfair cipher symmetric?</h3>
              <p>
                Yes. The same key square is used for both encryption and
                decryption. The only difference is the direction of the shift in
                rows and columns (right/down for encryption, left/up for
                decryption).
              </p>

              <h3>What keyword should I choose?</h3>
              <p>
                Historically, people used memorable phrases such as names,
                mottos, or song lyrics. For puzzles, choose a keyword that is
                thematically related but not too obvious. Longer, less
                predictable phrases produce more mixed key squares.
              </p>

              <h3>How are non‑letter characters handled?</h3>
              <p>
                For the core Playfair algorithm, only letters (and optionally
                digits) are processed. This tool removes other characters for
                the internal encryption, but if you choose “Mirror original
                spacing &amp; punctuation” the output will re‑insert them in
                their original positions.
              </p>

              <h3>Can I use this to break Playfair ciphers?</h3>
              <p>
                This page focuses on encoding and decoding when you already know
                the key. For code‑breaking, you typically need additional tools
                such as hill‑climbing search over possible key squares and
                digraph frequency analysis.
              </p>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Playfair, Cipher.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              Related Engineering Tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/regex-tester"
                  class="text-blue-600 hover:underline"
                  >Regular Expression (Regex) Tester</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/url-encoder-decoder"
                  class="text-blue-600 hover:underline"
                  >URL Encoder/Decoder</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/packet-loss-calculator"
                  class="text-blue-600 hover:underline"
                  >Packet Loss Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/api-latency"
                  class="text-blue-600 hover:underline"
                  >API Latency &amp; Throughput</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/caching-strategy"
                  class="text-blue-600 hover:underline"
                  >Caching Strategy Calculator</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">You might also like</h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/caesar-cipher"
                  class="text-blue-600 hover:underline"
                  >Caesar Cipher Encoder/Decoder</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/affine-cipher"
                  class="text-blue-600 hover:underline"
                  >Affine Cipher Encoder/Decoder</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/vigenere-cipher"
                  class="text-blue-600 hover:underline"
                  >Vigenère Cipher Encoder/Decoder</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/baconian-cipher"
                  class="text-blue-600 hover:underline"
                  >Baconian Cipher Encoder/Decoder</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/rail-fence-cipher"
                  class="text-blue-600 hover:underline"
                  >Rail Fence Cipher Encoder/Decoder</a
                >
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // Utility: sanitize and normalize text
      function normalizeText(text, alphabetVariant) {
        let cleaned = text.toUpperCase();
        // Keep letters and digits (digits only used in full variant)
        cleaned = cleaned.replace(/[^A-Z0-9]/g, "");
        if (alphabetVariant === "IJ") {
          cleaned = cleaned.replace(/J/g, "I");
          cleaned = cleaned.replace(/[^A-Z]/g, "");
        } else if (alphabetVariant === "QV") {
          cleaned = cleaned.replace(/Q/g, ""); // Q not allowed
          cleaned = cleaned.replace(/[^A-Z]/g, "");
        } else if (alphabetVariant === "full") {
          // A-Z0-9 allowed, no further restriction
        }
        return cleaned;
      }

      function buildAlphabet(alphabetVariant) {
        if (alphabetVariant === "IJ") {
          // I/J combined: we will treat J as I in normalizeText
          return "ABCDEFGHIKLMNOPQRSTUVWXYZ"; // no J
        } else if (alphabetVariant === "QV") {
          return "ABCDEFGHIJKLMNOPRSTUVWXYZ"; // no Q
        } else {
          // full: A-Z + 0-9
          return "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        }
      }

      function buildKeySquare(keyword, alphabetVariant) {
        const baseAlphabet = buildAlphabet(alphabetVariant);
        let key = keyword.toUpperCase().replace(/[^A-Z0-9]/g, "");
        if (alphabetVariant === "IJ") {
          key = key.replace(/J/g, "I");
          key = key.replace(/[^A-Z]/g, "");
        } else if (alphabetVariant === "QV") {
          key = key.replace(/Q/g, "");
          key = key.replace(/[^A-Z]/g, "");
        }
        let seen = new Set();
        let sequence = "";

        for (const ch of key) {
          if (!baseAlphabet.includes(ch)) continue;
          if (!seen.has(ch)) {
            seen.add(ch);
            sequence += ch;
          }
        }
        for (const ch of baseAlphabet) {
          if (!seen.has(ch)) {
            seen.add(ch);
            sequence += ch;
          }
        }

        const size = alphabetVariant === "full" ? 6 : 5;
        const grid = [];
        const pos = {};
        for (let r = 0; r < size; r++) {
          grid[r] = [];
          for (let c = 0; c < size; c++) {
            const ch = sequence[r * size + c];
            grid[r][c] = ch;
            pos[ch] = { r, c };
          }
        }
        return { grid, pos, size, sequence };
      }

      function prepareDigraphs(
        text,
        paddingLetter,
        doubleRule,
        alphabetVariant
      ) {
        const prepared = [];
        let i = 0;
        while (i < text.length) {
          const a = text[i];
          let b = i + 1 < text.length ? text[i + 1] : null;

          if (!b) {
            // last single char
            prepared.push([a, paddingLetter, "pad_last"]);
            i += 1;
          } else if (a === b && doubleRule === "split") {
            prepared.push([a, paddingLetter, "split_double"]);
            i += 1;
          } else {
            prepared.push([a, b, "normal"]);
            i += 2;
          }
        }
        return prepared;
      }

      function playfairTransform(digraphs, keySquare, mode) {
        const { grid, pos, size } = keySquare;
        const results = [];
        const shift = mode === "encrypt" ? 1 : -1;

        function mod(n, m) {
          return ((n % m) + m) % m;
        }

        for (let idx = 0; idx < digraphs.length; idx++) {
          const [a, b, tag] = digraphs[idx];
          const pa = pos[a];
          const pb = pos[b];
          if (!pa || !pb) {
            // Should not happen if normalization is correct
            results.push({
              index: idx + 1,
              pairIn: a + b,
              rule: "skip",
              pairOut: a + b,
            });
            continue;
          }

          let rule;
          let outA, outB;

          if (pa.r === pb.r) {
            // same row
            rule = "same row";
            outA = grid[pa.r][mod(pa.c + shift, size)];
            outB = grid[pb.r][mod(pb.c + shift, size)];
          } else if (pa.c === pb.c) {
            // same column
            rule = "same column";
            outA = grid[mod(pa.r + shift, size)][pa.c];
            outB = grid[mod(pb.r + shift, size)][pb.c];
          } else {
            // rectangle
            rule = "rectangle";
            outA = grid[pa.r][pb.c];
            outB = grid[pb.r][pa.c];
          }

          results.push({
            index: idx + 1,
            pairIn: a + b,
            pairOut: outA + outB,
            rule:
              rule +
              (tag === "split_double"
                ? " (split double)"
                : tag === "pad_last"
                ? " (padded)"
                : ""),
          });
        }

        return results;
      }

      function formatOutput(coreText, original, mode, preserveSpacing) {
        if (preserveSpacing === "continuous") {
          return coreText;
        }
        if (preserveSpacing === "group5") {
          return coreText.replace(/(.{5})/g, "$1 ").trim();
        }
        if (preserveSpacing === "mirror") {
          // Mirror original spacing & punctuation
          const letters = coreText.split("");
          let li = 0;
          let out = "";
          for (let i = 0; i < original.length; i++) {
            const ch = original[i];
            if (/[A-Za-z0-9]/.test(ch)) {
              if (li < letters.length) {
                const mapped = letters[li++];
                // Preserve case
                out += ch === ch.toLowerCase() ? mapped.toLowerCase() : mapped;
              } else {
                out += ch;
              }
            } else {
              out += ch;
            }
          }
          // append remaining letters if any
          while (li < letters.length) {
            out += letters[li++];
          }
          return out;
        }
        return coreText;
      }

      function renderKeySquare(container, keySquare, alphabetVariant) {
        container.innerHTML = "";
        const { grid, size } = keySquare;
        container.style.gridTemplateColumns = `repeat(${size}, minmax(0, 1fr))`;
        for (let r = 0; r < size; r++) {
          for (let c = 0; c < size; c++) {
            const cell = document.createElement("div");
            cell.className =
              "grid-cell flex items-center justify-center border border-gray-300 rounded bg-white text-sm font-semibold mono";
            cell.textContent = grid[r][c];
            container.appendChild(cell);
          }
        }
      }

      function renderDigraphs(tbody, digraphResults) {
        tbody.innerHTML = "";
        for (const row of digraphResults) {
          const tr = document.createElement("tr");
          tr.innerHTML = `
        <td class="px-2 py-1 border-b text-gray-500">${row.index}</td>
        <td class="px-2 py-1 border-b">${row.pairIn}</td>
        <td class="px-2 py-1 border-b text-gray-600">${row.rule}</td>
        <td class="px-2 py-1 border-b font-semibold">${row.pairOut}</td>
      `;
          tbody.appendChild(tr);
        }
      }

      function runPlayfair() {
        const mode = document.getElementById("mode").value;
        const keyword = document.getElementById("keyword").value || "";
        const alphabetVariant =
          document.getElementById("alphabetVariant").value;
        const paddingLetterRaw =
          document.getElementById("paddingLetter").value || "X";
        const doubleRule = document.getElementById("doubleRule").value;
        const preserveSpacing =
          document.getElementById("preserveSpacing").value;
        const inputText = document.getElementById("inputText").value || "";
        const errorEl = document.getElementById("errorMessage");
        const outputEl = document.getElementById("outputText");
        const keySquareContainer =
          document.getElementById("keySquareContainer");
        const keySquareCaption = document.getElementById("keySquareCaption");
        const digraphBody = document.getElementById("digraphBody");

        errorEl.textContent = "";
        outputEl.value = "";
        keySquareContainer.innerHTML = "";
        digraphBody.innerHTML = "";
        keySquareCaption.textContent = "";

        if (!keyword.trim()) {
          errorEl.textContent = "Please enter a keyword.";
          return;
        }
        if (!inputText.trim()) {
          errorEl.textContent = "Please enter some text to process.";
          return;
        }

        let paddingLetter =
          paddingLetterRaw.toUpperCase().replace(/[^A-Z0-9]/g, "") || "X";
        const keySquare = buildKeySquare(keyword, alphabetVariant);
        const baseAlphabet = buildAlphabet(alphabetVariant);
        if (!baseAlphabet.includes(paddingLetter)) {
          paddingLetter = baseAlphabet[0];
        }

        const normalized = normalizeText(inputText, alphabetVariant);
        if (!normalized.length) {
          errorEl.textContent =
            "No valid characters to process after cleaning (letters/digits only).";
          return;
        }

        const digraphs = prepareDigraphs(
          normalized,
          paddingLetter,
          doubleRule,
          alphabetVariant
        );
        const digraphResults = playfairTransform(digraphs, keySquare, mode);
        const coreOutput = digraphResults.map((r) => r.pairOut).join("");
        const formattedOutput = formatOutput(
          coreOutput,
          inputText,
          mode,
          preserveSpacing
        );

        outputEl.value = formattedOutput;

        renderKeySquare(keySquareContainer, keySquare, alphabetVariant);
        keySquareCaption.textContent = `Grid built from keyword "${keyword.trim()}" using ${
          alphabetVariant === "IJ"
            ? "I/J combined"
            : alphabetVariant === "QV"
            ? "Q omitted"
            : "A–Z + 0–9"
        } variant.`;
        renderDigraphs(digraphBody, digraphResults);
      }

      document
        .getElementById("runButton")
        .addEventListener("click", runPlayfair);

      document.getElementById("clearButton").addEventListener("click", () => {
        document.getElementById("inputText").value = "";
        document.getElementById("outputText").value = "";
        document.getElementById("errorMessage").textContent = "";
        document.getElementById("digraphBody").innerHTML = "";
      });

      document.getElementById("swapButton").addEventListener("click", () => {
        const inputEl = document.getElementById("inputText");
        const outputEl = document.getElementById("outputText");
        const modeEl = document.getElementById("mode");
        const tmp = inputEl.value;
        inputEl.value = outputEl.value;
        outputEl.value = tmp;
        modeEl.value = modeEl.value === "encrypt" ? "decrypt" : "encrypt";
      });

      // Allow Ctrl+Enter / Cmd+Enter to run
      document.getElementById("inputText").addEventListener("keydown", (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
          e.preventDefault();
          runPlayfair();
        }
      });

      // Initialize with a classic example
      window.addEventListener("DOMContentLoaded", () => {
        document.getElementById("keyword").value = "PLAYFAIR EXAMPLE";
        document.getElementById("inputText").value =
          "Hide the gold in the tree stump";
      });

      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

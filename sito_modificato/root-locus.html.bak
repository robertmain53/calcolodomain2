<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://calcdomain.com/root-locus" />
    <title>Root Locus Calculator Guide [Unmissable 2024] | CalcDomain</title>
    <meta name="description" content="Calculate Root Locus Calculator Guide fast with our unmissable tool. Get clear results, formulas, and tips - act now. No signup. Try it today. Free to use." />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Root Locus Calculator Guide [Unmissable 2024] | CalcDomain" />
    <meta property="og:description" content="Calculate Root Locus Calculator Guide fast with our unmissable tool. Get clear results, formulas, and tips - act now. No signup. Try it today. Free to use." />
    <meta property="og:url" content="https://calcdomain.com/root-locus" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Root Locus Calculator Guide [Unmissable 2024] | CalcDomain" />
    <meta name="twitter:description" content="Calculate Root Locus Calculator Guide fast with our unmissable tool. Get clear results, formulas, and tips - act now. No signup. Try it today. Free to use." />

    
    <link rel="preload" href="https://calcdomain.com/assets/tailwind.min.css" as="style">
    <link rel="stylesheet" href="https://calcdomain.com/assets/tailwind.min.css">
    <!-- Google tag (gtag.js) -->
    
    
    
    
    

    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Root Locus Calculator – Plot & Analyze Control System Poles",
        "description": "Interactive root locus calculator for control systems. Enter open-loop transfer functions, plot root locus, inspect poles/zeros, gain K, damping ratio, and stability.",
        "url": "https://calcdomain.com/root-locus",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://calcdomain.com"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Math & Conversions",
              "item": "https://calcdomain.com/categories/math-conversions"
            },
            {
              "@type": "ListItem",
              "position": 3,
              "name": "Core Math & Algebra",
              "item": "https://calcdomain.com/subcategories/core-math-algebra"
            },
            {
              "@type": "ListItem",
              "position": 4,
              "name": "Root Locus Calculator",
              "item": "https://calcdomain.com/root-locus"
            }
          ]
        },
        "mainEntity": {
          "@type": "SoftwareApplication",
          "name": "Root Locus Calculator",
          "applicationCategory": "EducationalApplication",
          "operatingSystem": "Any",
          "description": "An interactive tool to plot root locus of linear time-invariant control systems, visualize closed-loop pole locations as gain varies, and compute damping ratio and natural frequency.",
          "url": "https://calcdomain.com/root-locus"
        }
      }</script>
  
    <style>
      body { margin: 0; }
      .mb-10 { margin-bottom: 2.5rem; }
      .mt-10 { margin-top: 2.5rem; }
    </style>
    <script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Ugo Candido",
        "url": "https://www.linkedin.com/in/ugocandido92821/",
        "sameAs": ["https://www.linkedin.com/in/ugocandido92821/"],
        "email": "info@calcdomain.com",
        "description": "Ugo Candido builds calculators and educational resources to help readers make better decisions with transparent, practical models."
      }</script>
  <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/"}, {"@type": "ListItem", "position": 2, "name": "Math Calculators", "item": "https://calcdomain.com/categories/math"}, {"@type": "ListItem", "position": 3, "name": "Core Math &amp; Algebra Calculators", "item": "https://calcdomain.com/subcategories/core-math-algebra"}, {"@type": "ListItem", "position": 4, "name": "Root Locus Calculator", "item": "https://calcdomain.com/root-locus"}]}</script>
</head>
  <body class="bg-gray-50 text-gray-800">
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9476637732224939"
      crossorigin="anonymous"
    ></script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
      <nav class="container mx-auto px-4 lg:px-6 py-4" aria-label="Primary">
        <div class="flex justify-between items-center">
          <a
            href="https://calcdomain.com"
            class="text-2xl font-bold text-blue-600"
            >CalcDomain</a
          >
          <div class="w-full max-w-md hidden md:block mx-8">
            <div class="relative">
              <input
                type="search"
                id="search-input"
                placeholder="Search for a calculator..."
                class="w-full py-2 px-4 pr-10 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                autocomplete="off"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              <div
                id="search-results"
                class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-lg mt-2 max-h-96 overflow-y-auto z-50 hidden border border-gray-200"
              ></div>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="https://calcdomain.com/search"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="text-gray-700 hover:text-blue-600 transition-colors"
              >Categories</a
            >
          </div>
          <button
            id="mobile-menu-toggle"
            class="md:hidden p-2"
            aria-controls="mobile-menu"
            aria-expanded="false"
            aria-label="Open menu"
            type="button"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              ></path>
            </svg>
          </button>
        </div>
        <nav
          id="mobile-menu"
          class="md:hidden mt-4 hidden"
          aria-label="Mobile menu"
          role="navigation"
        >
          <div class="mb-4">
            <div class="relative">
              <input
                type="search"
                id="mobile-search-input"
                placeholder="Search calculators..."
                class="w-full py-3 px-4 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <svg
                class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="space-y-2">
            <a
              href="https://calcdomain.com/search"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Advanced Search</a
            >
            <a
              href="https://calcdomain.com/#categories"
              class="block py-2 text-gray-700 hover:text-blue-600"
              >Categories</a
            >
          </div>
        </nav>
      </nav>
    </header>

    <div class="container mx-auto px-4 py-8">
      <nav id="breadcrumb-container" class="text-sm mb-4 text-gray-600">
  <ol class="flex flex-wrap items-center gap-1">
    <li><a href="https://calcdomain.com" class="text-blue-600 hover:underline">Home</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/categories/math" class="text-blue-600 hover:underline">Math Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><a href="https://calcdomain.com/subcategories/core-math-algebra" class="text-blue-600 hover:underline">Core Math &amp;amp; Algebra Calculators</a></li>
    <li class="text-gray-400">/</li>
    <li><span class="text-gray-800">Root Locus Calculator</span></li>
  </ol>
</nav>
      <div class="flex flex-col lg:flex-row gap-8">
        <main class="w-full lg:w-2/3">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <header class="mb-6">
              <h1 class="text-2xl font-bold mb-2">Root Locus Calculator</h1>
              <p class="text-gray-700">
                Plot the root locus of a single-input single-output (SISO)
                linear time-invariant system, inspect closed-loop poles for a
                given gain \(K\), and read damping ratio and natural frequency.
              </p>
              <p class="mt-2 text-xs text-gray-500">
                Educational tool – always verify results against your course
                notes or a trusted CAS for critical designs.
              </p>
            </header>

            <!-- Calculator UI -->
            <section aria-labelledby="root-locus-inputs" class="mb-8">
              <h2 id="root-locus-inputs" class="text-xl font-semibold mb-3">
                1. Enter the open-loop transfer function
              </h2>
              <p class="text-sm text-gray-700 mb-4">
                The calculator assumes a unity-feedback system with open-loop
                transfer function \( G(s) = K \dfrac{N(s)}{D(s)} \). Enter
                numerator and denominator polynomials in descending powers of
                \(s\).
              </p>

              <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label
                    for="numerator"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Numerator coefficients \(N(s)\)
                  </label>
                  <input
                    id="numerator"
                    type="text"
                    value="1"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                    placeholder="e.g. 1 3 2  (for s² + 3s + 2)"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Space-separated real numbers. Example: <code>1 3 2</code> →
                    \(s^2 + 3s + 2\).
                  </p>
                </div>
                <div>
                  <label
                    for="denominator"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Denominator coefficients \(D(s)\)
                  </label>
                  <input
                    id="denominator"
                    type="text"
                    value="1 3 2"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                    placeholder="e.g. 1 5 6  (for s² + 5s + 6)"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Must be proper: degree of \(D(s)\) ≥ degree of \(N(s)\).
                  </p>
                </div>
              </div>

              <div class="grid md:grid-cols-3 gap-4 mb-4">
                <div>
                  <label
                    for="k-min"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Gain range \(K_{\min}\)
                  </label>
                  <input
                    id="k-min"
                    type="number"
                    step="0.1"
                    value="0"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                  />
                </div>
                <div>
                  <label
                    for="k-max"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Gain range \(K_{\max}\)
                  </label>
                  <input
                    id="k-max"
                    type="number"
                    step="1"
                    value="50"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                  />
                </div>
                <div>
                  <label
                    for="k-steps"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Number of samples
                  </label>
                  <input
                    id="k-steps"
                    type="number"
                    min="5"
                    max="400"
                    value="80"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    More samples → smoother locus, slower computation.
                  </p>
                </div>
              </div>

              <div class="flex flex-wrap items-center gap-3 mb-4">
                <button
                  id="plot-btn"
                  class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"
                >
                  Plot Root Locus
                </button>
                <button
                  id="reset-btn"
                  class="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200"
                >
                  Reset
                </button>
                <span id="status-text" class="text-xs text-gray-500"></span>
              </div>

              <div class="grid md:grid-cols-3 gap-4 mb-2">
                <div class="text-xs text-gray-600">
                  <span
                    class="inline-block w-3 h-3 rounded-full bg-blue-500 mr-1"
                  ></span>
                  Root locus trajectory
                </div>
                <div class="text-xs text-gray-600">
                  <span
                    class="inline-block w-3 h-3 rounded-full bg-red-500 mr-1"
                  ></span>
                  Open-loop poles
                </div>
                <div class="text-xs text-gray-600">
                  <span
                    class="inline-block w-3 h-3 rounded-full border border-green-600 mr-1"
                  ></span>
                  Open-loop zeros
                </div>
              </div>
            </section>

            <!-- Plot and K-slice -->
            <section aria-labelledby="root-locus-plot" class="mb-8">
              <h2 id="root-locus-plot" class="text-xl font-semibold mb-3">
                2. Root locus plot
              </h2>
              <div
                class="border border-gray-200 rounded-md p-3 bg-gray-50 mb-3"
              >
                <canvas
                  id="rootLocusCanvas"
                  width="600"
                  height="400"
                  aria-label="Root locus plot"
                ></canvas>
              </div>
              <p class="text-xs text-gray-500 mb-4">
                Real axis (horizontal), imaginary axis (vertical). Stable
                closed-loop poles lie in the left half-plane (Re &lt; 0).
              </p>

              <div class="grid md:grid-cols-2 gap-4 items-end">
                <div>
                  <label
                    for="k-current"
                    class="block text-sm font-medium text-gray-700 mb-1"
                  >
                    Inspect closed-loop poles at gain \(K\)
                  </label>
                  <input
                    id="k-current"
                    type="number"
                    step="0.1"
                    value="10"
                    class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                  />
                  <p class="text-xs text-gray-500 mt-1">
                    Closed-loop characteristic equation: \( D(s) + K N(s) = 0
                    \).
                  </p>
                </div>
                <div class="flex gap-2">
                  <button
                    id="update-k-btn"
                    class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700"
                  >
                    Update poles for K
                  </button>
                  <button
                    id="auto-k-btn"
                    class="px-3 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200"
                  >
                    Auto-step K
                  </button>
                </div>
              </div>

              <div id="k-info" class="mt-4 text-sm text-gray-800 hidden">
                <h3 class="font-semibold mb-1 text-gray-900">
                  Closed-loop pole summary
                </h3>
                <div
                  id="k-stability"
                  class="mb-1 text-xs font-medium inline-block badge bg-green-100 text-green-700"
                ></div>
                <div class="overflow-x-auto mt-2">
                  <table class="min-w-full text-xs border border-gray-200">
                    <thead class="bg-gray-100">
                      <tr>
                        <th class="px-2 py-1 border-b text-left">Pole</th>
                        <th class="px-2 py-1 border-b text-left">Re</th>
                        <th class="px-2 py-1 border-b text-left">Im</th>
                        <th class="px-2 py-1 border-b text-left">
                          ω<sub>n</sub>
                        </th>
                        <th class="px-2 py-1 border-b text-left">ζ</th>
                      </tr>
                    </thead>
                    <tbody id="k-pole-table"></tbody>
                  </table>
                </div>
              </div>
            </section>

            <!-- Theory & explanation -->
            <section aria-labelledby="root-locus-theory" class="prose">
              <h2 id="root-locus-theory">What is a root locus?</h2>
              <p>
                In classical control theory, the <strong>root locus</strong> is
                the locus of closed-loop poles of a feedback system as a real
                scalar gain \(K\) varies from 0 to \(+\infty\). For a
                unity-feedback system with open-loop transfer function \( G(s) =
                K \dfrac{N(s)}{D(s)} \), the closed-loop characteristic equation
                is:
              </p>
              <div class="formula-box">
                \[ 1 + G(s) = 0 \quad \Rightarrow \quad D(s) + K N(s) = 0 \]
              </div>
              <p>
                Each solution \(s_i(K)\) of this equation is a closed-loop pole.
                Plotting all \(s_i(K)\) in the complex plane as \(K\) varies
                gives the root locus. The location of these poles determines:
              </p>
              <ul>
                <li>
                  <strong>Stability</strong> – all poles must lie in the left
                  half-plane (LHP) for asymptotic stability.
                </li>
                <li>
                  <strong>Transient response</strong> – damping ratio \(\zeta\)
                  and natural frequency \(\omega_n\) of complex poles.
                </li>
                <li>
                  <strong>Steady-state error</strong> – via system type and pole
                  at the origin.
                </li>
              </ul>

              <h3>Closed-loop poles, damping ratio, and natural frequency</h3>
              <p>
                For a second-order complex pole pair \( s = \sigma \pm j\omega_d
                \), we define:
              </p>
              <div class="formula-box">
                \[ \omega_n = \sqrt{\sigma^2 + \omega_d^2}, \qquad \zeta =
                -\frac{\sigma}{\omega_n}, \qquad \omega_d = \omega_n \sqrt{1 -
                \zeta^2} \]
              </div>
              <p>
                The table in this calculator computes \(\omega_n\) and \(\zeta\)
                for each pole at the selected gain \(K\). Real poles have
                \(\omega_d = 0\) and \(\zeta = 1\) (overdamped).
              </p>

              <h3>Basic root locus rules (qualitative design)</h3>
              <p>Some standard rules used in hand sketching:</p>
              <ul>
                <li>
                  The number of branches equals the number of poles of \(G(s)\).
                </li>
                <li>
                  Branches start at open-loop poles and end at open-loop zeros
                  (including zeros at infinity).
                </li>
                <li>
                  The locus lies on real-axis segments where the total number of
                  real poles and zeros to the right is odd.
                </li>
                <li>
                  Asymptotes for branches going to infinity have angles
                  \(\theta_k = \dfrac{(2k+1)\pi}{n-m}\), where \(n\) = number of
                  poles, \(m\) = number of zeros.
                </li>
                <li>
                  The centroid of asymptotes is \(\sigma_a = \dfrac{\sum
                  \text{poles} - \sum \text{zeros}}{n-m}\).
                </li>
              </ul>
              <p>
                This interactive tool does not rely on these rules to draw the
                plot; instead, it <em>numerically computes</em>
                the closed-loop poles for many values of \(K\). However,
                understanding the rules helps you interpret the plot.
              </p>

              <h3>How this calculator works (numerical method)</h3>
              <ol>
                <li>
                  Parse numerator and denominator coefficients into polynomials
                  \(N(s)\) and \(D(s)\).
                </li>
                <li>
                  Generate a grid of gain values \(K\) between \(K_{\min}\) and
                  \(K_{\max}\).
                </li>
                <li>
                  For each \(K\), form the characteristic polynomial \( P_K(s) =
                  D(s) + K N(s) \) and compute its roots numerically.
                </li>
                <li>
                  Collect all roots and plot them in the complex plane as the
                  root locus.
                </li>
                <li>
                  For a user-selected \(K\), recompute roots and derive
                  \(\omega_n\) and \(\zeta\) for each pole.
                </li>
              </ol>
              <p>
                This is similar in spirit to tools like MATLAB’s
                <code>rlocus</code>, but implemented entirely in JavaScript for
                quick visual exploration in the browser.
              </p>
            </section>

            <!-- FAQ -->
            <section class="prose mt-8" id="faq">
              <h2>Root locus FAQ</h2>

              <h3>
                What kinds of systems does this root locus calculator support?
              </h3>
              <p>
                It supports
                <strong>SISO, LTI, rational transfer functions</strong> of the
                form \( G(s) = K \dfrac{N(s)}{D(s)} \) with real coefficients.
                Both numerator and denominator can be any order, as long as the
                system is proper (degree of \(D(s)\) ≥ degree of \(N(s)\)).
              </p>

              <h3>How do I know if the closed-loop system is stable?</h3>
              <p>
                For each chosen gain \(K\), the calculator recomputes the
                closed-loop poles. If
                <strong>all poles have negative real parts</strong>, the system
                is asymptotically stable. The “Closed-loop pole summary” box
                shows a
                <span class="badge bg-green-100 text-green-700">Stable</span> or
                <span class="badge bg-red-100 text-red-700">Unstable</span>
                label accordingly.
              </p>

              <h3>Can I design for a target damping ratio or settling time?</h3>
              <p>
                This tool is mainly for <strong>visual exploration</strong>. A
                common workflow is:
              </p>
              <ol>
                <li>Plot the root locus for a reasonable range of \(K\).</li>
                <li>Use the \(K\) slider / input to move along the locus.</li>
                <li>
                  Watch the damping ratio \(\zeta\) and natural frequency
                  \(\omega_n\) of the dominant poles.
                </li>
                <li>
                  Pick a gain \(K\) that meets your design specs (e.g. \(\zeta
                  \approx 0.7\), desired \(\omega_n\)).
                </li>
              </ol>
              <p>
                For more advanced design (lead/lag compensators, PID tuning),
                you would typically combine root locus with analytical formulas
                or a dedicated control design environment.
              </p>

              <h3>
                Why do I sometimes see numerical noise or strange branches?
              </h3>
              <p>
                The calculator uses floating‑point arithmetic and a generic
                polynomial root finder. For high‑order systems, very large
                gains, or nearly repeated poles, numerical conditioning can
                cause:
              </p>
              <ul>
                <li>Small asymmetries in symmetric loci.</li>
                <li>Apparent “jumps” in branches for certain \(K\) values.</li>
              </ul>
              <p>
                If this happens, try reducing \(K_{\max}\), lowering the number
                of samples, or simplifying the transfer function.
              </p>
            </section>
          </div>



            <section class="mt-10" id="author">
              <h2 class="text-xl font-semibold mb-4">About the author</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  <a href="https://www.linkedin.com/in/ugocandido92821/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Ugo Candido</a>
                  builds financial tools and educational resources to help
                  readers make better money decisions. He focuses on practical,
                  transparent models that reflect how lenders calculate
                  payments and total cost of ownership.
                </p>
                <p class="text-sm text-gray-700 mt-3">
                  Contact: <a href="mailto:info@calcdomain.com" class="text-blue-600 hover:underline">info@calcdomain.com</a>
                </p>
              </div>
            </section>

            <section class="mt-10" id="editorial-policy">
              <h2 class="text-xl font-semibold mb-4">Editorial policy</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  CalcDomain content is created for educational purposes and is
                  reviewed for clarity, accuracy, and transparency. We do not
                  accept paid placements that influence calculator outputs.
                  Inputs and assumptions are shown directly in the interface so
                  you can verify how results are produced.
                </p>
              </div>
            </section>

            <section class="mt-10" id="methodology">
              <h2 class="text-xl font-semibold mb-4">Methodology</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm text-gray-700">
                  Results use standard formulas and the values you provide.
                  Figures are estimates and may differ from lender quotes.
                  For decisions that require professional guidance, consult a
                  licensed advisor.
                </p>
              </div>
            </section>

        
            <section class="mt-10" id="sources">
              <h2 class="text-xl font-semibold mb-4">Sources</h2>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                  <li>
                    <a href="https://www.nist.gov/pml/owm/metric-si/si-units" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      NIST: The International System of Units (SI)
                    </a>
                  </li>
                  <li>
                    <a href="https://openstax.org/details/books/college-algebra" class="text-blue-600 hover:underline" target="_blank" rel="noopener">
                      OpenStax: College Algebra
                    </a>
                  </li>
                </ul>
              </div>
            </section>

        





<section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Numerator coefficients \(N(s)\)</li><li>Denominator coefficients \(D(s)\)</li><li>Gain range \(K_{\min}\)</li><li>Gain range \(K_{\max}\)</li><li>Number of samples</li><li>Inspect closed-loop poles at gain \(K\)</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Operational notes</h2><p class="text-sm text-gray-700">Fill in realistic values and keep units and timeframes consistent.</p><p class="text-sm text-gray-700 mt-2">Key entities: Root, Locus, Numerator coefficients \(N(s)\), Denominator coefficients \(D(s)\), Gain range \(K_{\min}\), Gain range \(K_{\max}\), Number of samples, Inspect closed-loop poles at gain \(K\).</p></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Inputs used by this calculator</h2><ul class="text-sm text-gray-700 list-disc pl-5"><li>Numerator coefficients \(N(s)\)</li><li>Denominator coefficients \(D(s)\)</li><li>Gain range \(K_{\min}\)</li><li>Gain range \(K_{\max}\)</li><li>Number of samples</li><li>Inspect closed-loop poles at gain \(K\)</li></ul></section><section class="bg-white p-4 rounded-lg shadow-md mt-6"><h2 class="text-lg font-semibold mb-2">Consistency checks</h2><p class="text-sm text-gray-700">Checks: non-negative values, plausible ranges, coherent outputs.</p></section><!-- %%EEAT_STRIP%% -->
<!-- %%QUALITY_BLOCKS%% -->
<!-- %%FAQ_JSONLD%% -->
</main>
        <aside class="w-full lg:w-1/3">
          <div class="bg-white p-4 rounded-lg shadow-md mb-6">
            <h2 class="text-lg font-semibold mb-3">
              More Core Math &amp; Algebra tools
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="https://calcdomain.com/derivative"
                  class="text-blue-600 hover:underline"
                  >Derivative Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/integral"
                  class="text-blue-600 hover:underline"
                  >Integral Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/quadratic-formula"
                  class="text-blue-600 hover:underline"
                  >Quadratic Formula Solver</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/equation-solver"
                  class="text-blue-600 hover:underline"
                  >Equation Solver</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/polynomial"
                  class="text-blue-600 hover:underline"
                  >Polynomial Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/linear-algebra"
                  class="text-blue-600 hover:underline"
                  >Linear Algebra Toolkit</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/matrix"
                  class="text-blue-600 hover:underline"
                  >Matrix Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/laplace-transform"
                  class="text-blue-600 hover:underline"
                  >Laplace Transform</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/inverse-laplace-transform"
                  class="text-blue-600 hover:underline"
                  >Inverse Laplace Transform</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sohcahtoa"
                  class="text-blue-600 hover:underline"
                  >Trigonometric Functions (SOHCAHTOA)</a
                >
              </li>
            </ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md">
            <h2 class="text-lg font-semibold mb-3">Tip</h2>
            <p class="text-sm text-gray-700">
              When comparing with textbook root locus sketches, remember that
              this tool uses exact numerical roots. Small differences often come
              from approximations used in hand sketches.
            </p>
          </div>
        </aside>
      </div>
    </div>
    <footer class="bg-gray-900 text-white py-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-2xl font-bold mb-4">CalcDomain</h3>
            <p class="text-gray-400 mb-4">
              Your trusted source for free online calculators. Accurate, fast,
              and reliable calculations for every need.
            </p>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Categories</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/finance"
                  class="text-gray-400 hover:text-white"
                  >Finance</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/health-fitness"
                  class="text-gray-400 hover:text-white"
                  >Health & Fitness</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/math-conversions"
                  class="text-gray-400 hover:text-white"
                  >Math & Conversions</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/lifestyle-everyday"
                  class="text-gray-400 hover:text-white"
                  >Lifestyle & Everyday</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/construction-diy"
                  class="text-gray-400 hover:text-white"
                  >Construction & DIY</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Popular Tools</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/mortgage-payment"
                  class="text-gray-400 hover:text-white"
                  >Mortgage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/percentage-calculator"
                  class="text-gray-400 hover:text-white"
                  >Percentage Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/bmi-calculator"
                  class="text-gray-400 hover:text-white"
                  >BMI Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/auto-loan-calculator"
                  class="text-gray-400 hover:text-white"
                  >Auto Loan Calculator</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/house-affordability"
                  class="text-gray-400 hover:text-white"
                  >House Affordability</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-4">Support</h4>
            <ul class="space-y-2">
              <li>
                <a
                  href="https://calcdomain.com/about"
                  class="text-gray-400 hover:text-white"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/contact"
                  class="text-gray-400 hover:text-white"
                  >Contact</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/privacy"
                  class="text-gray-400 hover:text-white"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/terms"
                  class="text-gray-400 hover:text-white"
                  >Terms of Service</a
                >
              </li>
              <li>
                <a
                  href="https://calcdomain.com/sitemap.xml"
                  class="text-gray-400 hover:text-white"
                  >Site Map</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400"
        >
          <p>
            &copy; 2025 CalcDomain. All Rights Reserved. | Free Online
            Calculators for Everyone
          </p>
        </div>
      </div>
    </footer>

    <script src="/assets/js/mobile-menu.js"></script>
    <script src="/search.js"></script>

    <script>
      // --- Utility: parse polynomial coefficients from text ---
      function parseCoefficients(str) {
        if (!str) return [];
        return str
          .trim()
          .split(/[\s,;]+/)
          .map(Number)
          .filter((v) => !Number.isNaN(v));
      }

      // Polynomial operations: represented as array [a0, a1, ..., an] for a0*s^n + ... + an
      function polyAdd(p, q) {
        const n = Math.max(p.length, q.length);
        const res = new Array(n).fill(0);
        for (let i = 0; i < n; i++) {
          const pi = p[p.length - n + i] || 0;
          const qi = q[q.length - n + i] || 0;
          res[i] = pi + qi;
        }
        return trimLeadingZeros(res);
      }

      function polyScale(p, k) {
        return p.map((c) => c * k);
      }

      function trimLeadingZeros(p) {
        let i = 0;
        while (i < p.length - 1 && Math.abs(p[i]) < 1e-14) i++;
        return p.slice(i);
      }

      // Companion matrix eigenvalues for roots of polynomial
      function polyRoots(coeffs) {
        coeffs = trimLeadingZeros(coeffs);
        const n = coeffs.length - 1;
        if (n <= 0) return [];
        // Normalize to monic: s^n + a1 s^{n-1} + ... + an
        const a0 = coeffs[0];
        if (Math.abs(a0) === 0) return [];
        const a = coeffs.map((c) => c / a0);
        const companion = [];
        for (let i = 0; i < n; i++) {
          companion[i] = new Array(n).fill(0);
        }
        for (let i = 0; i < n - 1; i++) {
          companion[i + 1][i] = 1;
        }
        for (let j = 0; j < n; j++) {
          companion[0][j] = -a[j + 1] || 0;
        }
        return eigenvaluesQR(companion);
      }

      // Basic QR algorithm for eigenvalues of real matrix (small n)
      function eigenvaluesQR(A) {
        const n = A.length;
        let M = A.map((row) => row.slice());
        const maxIter = 200;
        const eps = 1e-10;

        function clone(mat) {
          return mat.map((r) => r.slice());
        }

        function transpose(mat) {
          const m = mat.length,
            n = mat[0].length;
          const T = Array.from({ length: n }, () => new Array(m).fill(0));
          for (let i = 0; i < m; i++)
            for (let j = 0; j < n; j++) T[j][i] = mat[i][j];
          return T;
        }

        function matMul(A, B) {
          const m = A.length,
            n = B[0].length,
            p = B.length;
          const C = Array.from({ length: m }, () => new Array(n).fill(0));
          for (let i = 0; i < m; i++) {
            for (let k = 0; k < p; k++) {
              const aik = A[i][k];
              if (aik === 0) continue;
              for (let j = 0; j < n; j++) {
                C[i][j] += aik * B[k][j];
              }
            }
          }
          return C;
        }

        function qrDecompose(A) {
          const m = A.length,
            n = A[0].length;
          const Q = Array.from({ length: m }, () => new Array(n).fill(0));
          const R = Array.from({ length: n }, () => new Array(n).fill(0));
          const v = Array.from({ length: m }, () => new Array(n).fill(0));

          for (let j = 0; j < n; j++) {
            for (let i = 0; i < m; i++) v[i][j] = A[i][j];
            for (let k = 0; k < j; k++) {
              let r = 0;
              for (let i = 0; i < m; i++) r += Q[i][k] * A[i][j];
              R[k][j] = r;
              for (let i = 0; i < m; i++) v[i][j] -= r * Q[i][k];
            }
            let norm = 0;
            for (let i = 0; i < m; i++) norm += v[i][j] * v[i][j];
            norm = Math.sqrt(norm);
            if (norm < 1e-14) norm = 1e-14;
            R[j][j] = norm;
            for (let i = 0; i < m; i++) Q[i][j] = v[i][j] / norm;
          }
          return { Q, R };
        }

        for (let iter = 0; iter < maxIter; iter++) {
          const { Q, R } = qrDecompose(M);
          M = matMul(R, Q);
          let off = 0;
          for (let i = 0; i < n; i++)
            for (let j = 0; j < n; j++) if (i !== j) off += Math.abs(M[i][j]);
          if (off < eps) break;
        }

        const eigs = [];
        let i = 0;
        while (i < n) {
          if (i < n - 1 && Math.abs(M[i + 1][i]) > 1e-6) {
            // 2x2 block -> complex conjugate pair
            const a = M[i][i],
              b = M[i][i + 1],
              c = M[i + 1][i],
              d = M[i + 1][i + 1];
            const tr = a + d;
            const det = a * d - b * c;
            const disc = tr * tr - 4 * det;
            if (disc >= 0) {
              const r1 = (tr + Math.sqrt(disc)) / 2;
              const r2 = (tr - Math.sqrt(disc)) / 2;
              eigs.push({ re: r1, im: 0 }, { re: r2, im: 0 });
            } else {
              const re = tr / 2;
              const im = Math.sqrt(-disc) / 2;
              eigs.push({ re, im }, { re, im: -im });
            }
            i += 2;
          } else {
            eigs.push({ re: M[i][i], im: 0 });
            i++;
          }
        }
        return eigs;
      }

      // --- Root locus computation ---
      function computeRootLocus(num, den, kMin, kMax, steps) {
        const locusPoints = [];
        const ks = [];
        const nSteps = Math.max(2, steps | 0);
        for (let i = 0; i < nSteps; i++) {
          const K = kMin + (kMax - kMin) * (i / (nSteps - 1));
          const polyK = polyAdd(den, polyScale(num, K));
          const roots = polyRoots(polyK);
          roots.forEach((r) => {
            locusPoints.push({ re: r.re, im: r.im, K });
          });
          ks.push(K);
        }
        return { locusPoints, ks };
      }

      // --- Plotting on canvas ---
      function plotRootLocus(canvas, data, poles, zeros, kHighlightRoots) {
        const ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        const allPoints = [
          ...data,
          ...poles,
          ...zeros,
          ...(kHighlightRoots || []),
        ];
        if (allPoints.length === 0) return;

        let minRe = Infinity,
          maxRe = -Infinity,
          minIm = Infinity,
          maxIm = -Infinity;
        allPoints.forEach((p) => {
          minRe = Math.min(minRe, p.re);
          maxRe = Math.max(maxRe, p.re);
          minIm = Math.min(minIm, p.im);
          maxIm = Math.max(maxIm, p.im);
        });

        const margin = 20;
        if (!isFinite(minRe) || !isFinite(maxRe)) {
          minRe = -5;
          maxRe = 5;
          minIm = -5;
          maxIm = 5;
        }
        const spanRe = maxRe - minRe || 1;
        const spanIm = maxIm - minIm || 1;
        const scaleX = (canvas.width - 2 * margin) / spanRe;
        const scaleY = (canvas.height - 2 * margin) / spanIm;

        function toCanvas(p) {
          return {
            x: margin + (p.re - minRe) * scaleX,
            y: canvas.height - (margin + (p.im - minIm) * scaleY),
          };
        }

        // Axes
        ctx.strokeStyle = "#9ca3af";
        ctx.lineWidth = 1;
        ctx.beginPath();
        const y0 = toCanvas({ re: 0, im: 0 }).y;
        ctx.moveTo(margin, y0);
        ctx.lineTo(canvas.width - margin, y0);
        ctx.stroke();

        ctx.beginPath();
        const x0 = toCanvas({ re: 0, im: 0 }).x;
        ctx.moveTo(x0, margin);
        ctx.lineTo(x0, canvas.height - margin);
        ctx.stroke();

        // Root locus points
        ctx.fillStyle = "rgba(37, 99, 235, 0.7)";
        data.forEach((p) => {
          const c = toCanvas(p);
          ctx.beginPath();
          ctx.arc(c.x, c.y, 2, 0, 2 * Math.PI);
          ctx.fill();
        });

        // Open-loop poles (red crosses)
        ctx.strokeStyle = "#ef4444";
        ctx.lineWidth = 1.5;
        poles.forEach((p) => {
          const c = toCanvas(p);
          const r = 5;
          ctx.beginPath();
          ctx.moveTo(c.x - r, c.y - r);
          ctx.lineTo(c.x + r, c.y + r);
          ctx.moveTo(c.x - r, c.y + r);
          ctx.lineTo(c.x + r, c.y - r);
          ctx.stroke();
        });

        // Open-loop zeros (green circles)
        ctx.strokeStyle = "#16a34a";
        zeros.forEach((p) => {
          const c = toCanvas(p);
          const r = 4;
          ctx.beginPath();
          ctx.arc(c.x, c.y, r, 0, 2 * Math.PI);
          ctx.stroke();
        });

        // Highlight closed-loop poles for selected K
        if (kHighlightRoots && kHighlightRoots.length) {
          ctx.fillStyle = "#f97316";
          kHighlightRoots.forEach((p) => {
            const c = toCanvas(p);
            ctx.beginPath();
            ctx.arc(c.x, c.y, 3.5, 0, 2 * Math.PI);
            ctx.fill();
          });
        }
      }

      function computeClosedLoopPoles(num, den, K) {
        const polyK = polyAdd(den, polyScale(num, K));
        return polyRoots(polyK);
      }

      function updatePoleTable(roots, K) {
        const tableBody = document.getElementById("k-pole-table");
        const status = document.getElementById("k-stability");
        const container = document.getElementById("k-info");
        tableBody.innerHTML = "";
        if (!roots || !roots.length) {
          container.classList.add("hidden");
          return;
        }
        let stable = true;
        roots.forEach((r, idx) => {
          const re = r.re;
          const im = r.im;
          if (re >= 0) stable = false;
          const wn = Math.sqrt(re * re + im * im);
          const zeta = wn > 1e-12 ? -re / wn : re < 0 ? 1 : 0;
          const tr = document.createElement("tr");
          tr.innerHTML = `
        <td class="px-2 py-1 border-b">p<sub>${idx + 1}</sub></td>
        <td class="px-2 py-1 border-b">${re.toFixed(4)}</td>
        <td class="px-2 py-1 border-b">${im.toFixed(4)}</td>
        <td class="px-2 py-1 border-b">${wn.toFixed(4)}</td>
        <td class="px-2 py-1 border-b">${zeta.toFixed(3)}</td>
      `;
          tableBody.appendChild(tr);
        });
        status.textContent = stable
          ? `Stable for K = ${K}`
          : `Unstable for K = ${K}`;
        status.className =
          "mb-1 text-xs font-medium inline-block badge " +
          (stable ? "bg-green-100 text-green-700" : "bg-red-100 text-red-700");
        container.classList.remove("hidden");
      }

      document.addEventListener("DOMContentLoaded", () => {
        const numInput = document.getElementById("numerator");
        const denInput = document.getElementById("denominator");
        const kMinInput = document.getElementById("k-min");
        const kMaxInput = document.getElementById("k-max");
        const kStepsInput = document.getElementById("k-steps");
        const kCurrentInput = document.getElementById("k-current");
        const plotBtn = document.getElementById("plot-btn");
        const resetBtn = document.getElementById("reset-btn");
        const updateKBtn = document.getElementById("update-k-btn");
        const autoKBtn = document.getElementById("auto-k-btn");
        const statusText = document.getElementById("status-text");
        const canvas = document.getElementById("rootLocusCanvas");

        let locusData = [];
        let openLoopPoles = [];
        let openLoopZeros = [];
        let autoKInterval = null;

        function computeOpenLoopPolesZeros(num, den) {
          const poles = polyRoots(den);
          const zeros = polyRoots(num);
          return {
            poles: poles.map((p) => ({ re: p.re, im: p.im })),
            zeros: zeros.map((z) => ({ re: z.re, im: z.im })),
          };
        }

        function doPlot() {
          const num = parseCoefficients(numInput.value);
          const den = parseCoefficients(denInput.value);
          const kMin = parseFloat(kMinInput.value);
          const kMax = parseFloat(kMaxInput.value);
          const steps = parseInt(kStepsInput.value, 10);

          if (!num.length || !den.length) {
            statusText.textContent =
              "Enter valid numerator and denominator coefficients.";
            return;
          }
          if (
            !Number.isFinite(kMin) ||
            !Number.isFinite(kMax) ||
            kMax <= kMin
          ) {
            statusText.textContent = "K range must be valid with Kmax > Kmin.";
            return;
          }
          statusText.textContent = "Computing root locus...";
          setTimeout(() => {
            try {
              const { locusPoints } = computeRootLocus(
                num,
                den,
                kMin,
                kMax,
                steps
              );
              locusData = locusPoints;
              const { poles, zeros } = computeOpenLoopPolesZeros(num, den);
              openLoopPoles = poles;
              openLoopZeros = zeros;
              const K = parseFloat(kCurrentInput.value);
              const rootsK = computeClosedLoopPoles(num, den, K);
              const rootsKPoints = rootsK.map((r) => ({ re: r.re, im: r.im }));
              plotRootLocus(
                canvas,
                locusData,
                openLoopPoles,
                openLoopZeros,
                rootsKPoints
              );
              updatePoleTable(rootsK, K);
              statusText.textContent = `Plotted ${locusData.length} points for K in [${kMin}, ${kMax}].`;
            } catch (e) {
              console.error(e);
              statusText.textContent =
                "Error during computation. Try simpler coefficients or fewer steps.";
            }
          }, 10);
        }

        plotBtn.addEventListener("click", doPlot);

        resetBtn.addEventListener("click", () => {
          numInput.value = "1";
          denInput.value = "1 3 2";
          kMinInput.value = "0";
          kMaxInput.value = "50";
          kStepsInput.value = "80";
          kCurrentInput.value = "10";
          locusData = [];
          openLoopPoles = [];
          openLoopZeros = [];
          const ctx = canvas.getContext("2d");
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          document.getElementById("k-info").classList.add("hidden");
          statusText.textContent = "";
          if (autoKInterval) {
            clearInterval(autoKInterval);
            autoKInterval = null;
            autoKBtn.textContent = "Auto-step K";
          }
        });

        updateKBtn.addEventListener("click", () => {
          const num = parseCoefficients(numInput.value);
          const den = parseCoefficients(denInput.value);
          const K = parseFloat(kCurrentInput.value);
          if (!num.length || !den.length || !Number.isFinite(K)) {
            statusText.textContent = "Enter valid coefficients and K.";
            return;
          }
          try {
            const rootsK = computeClosedLoopPoles(num, den, K);
            const rootsKPoints = rootsK.map((r) => ({ re: r.re, im: r.im }));
            plotRootLocus(
              canvas,
              locusData,
              openLoopPoles,
              openLoopZeros,
              rootsKPoints
            );
            updatePoleTable(rootsK, K);
            statusText.textContent = `Updated closed-loop poles for K = ${K}.`;
          } catch (e) {
            console.error(e);
            statusText.textContent = "Error updating poles for this K.";
          }
        });

        autoKBtn.addEventListener("click", () => {
          if (autoKInterval) {
            clearInterval(autoKInterval);
            autoKInterval = null;
            autoKBtn.textContent = "Auto-step K";
            return;
          }
          const kMin = parseFloat(kMinInput.value);
          const kMax = parseFloat(kMaxInput.value);
          if (
            !Number.isFinite(kMin) ||
            !Number.isFinite(kMax) ||
            kMax <= kMin
          ) {
            statusText.textContent =
              "Set a valid K range before auto-stepping.";
            return;
          }
          let direction = 1;
          autoKBtn.textContent = "Stop auto-step";
          autoKInterval = setInterval(() => {
            let K = parseFloat(kCurrentInput.value);
            if (!Number.isFinite(K)) K = kMin;
            const step = (kMax - kMin) / 100;
            K += direction * step;
            if (K >= kMax) {
              K = kMax;
              direction = -1;
            }
            if (K <= kMin) {
              K = kMin;
              direction = 1;
            }
            kCurrentInput.value = K.toFixed(3);
            updateKBtn.click();
          }, 250);
        });

        // Initial plot
        doPlot();
      });
    </script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["\\(", "\\)"],
            ["$", "$"],
          ],
          displayMath: [
            ["$", "$"],
            ["\\[", "\\]"],
          ],
        },
        svg: { fontCache: "global" },
      };
    </script>
    <script>
  (function () {
    var loadMathJax = function () {
      if (window.__mathjaxLoading) return;
      window.__mathjaxLoading = true;
      var script = document.createElement("script");
      script.id = "MathJax-script";
      script.async = true;
      script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js";
      document.head.appendChild(script);
    };

    var target = document.querySelector(
      ".formula-box, .mathjax, .math, .formula, [data-mathjax]"
    );

    if (!target) return;

    if ("IntersectionObserver" in window) {
      var observer = new IntersectionObserver(
        function (entries) {
          if (entries.some(function (entry) { return entry.isIntersecting; })) {
            observer.disconnect();
            loadMathJax();
          }
        },
        { rootMargin: "200px" }
      );
      observer.observe(target);
    } else {
      window.addEventListener(
        "load",
        function () {
          setTimeout(loadMathJax, 1000);
        },
        { once: true }
      );
    }
  })();
</script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7MB5V1LZRN"></script>
<script>
  window.__cmpLoadQueued = window.__cmpLoadQueued || [];
  window.addEventListener("load", function () {
    var loadCmp = function () {
      var s1 = document.createElement("script");
      s1.src = "https://cmp.gatekeeperconsent.com/min.js";
      s1.async = true;
      s1.setAttribute("data-cfasync", "false");
      document.head.appendChild(s1);

      var s2 = document.createElement("script");
      s2.src = "https://the.gatekeeperconsent.com/cmp.min.js";
      s2.async = true;
      s2.setAttribute("data-cfasync", "false");
      document.head.appendChild(s2);
    };

    if ("requestIdleCallback" in window) {
      requestIdleCallback(loadCmp, { timeout: 2000 });
    } else {
      setTimeout(loadCmp, 1000);
    }
  });
</script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
      window.ezstandalone = window.ezstandalone || {};
      ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
</body>
</html>

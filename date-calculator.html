<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Date Calculator: Find Duration &amp; Add/Subtract Dates</title>
<meta name="description" content="Calculate the duration (years, months, days) between two dates, or find a new date by adding or subtracting time. Accurate, accessible, and mobile-friendly.">
<link rel="canonical" href="https://calcdomain.com/date-calculator.html"/>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; }
.prose { max-width: 65ch; }
.prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
.prose p { margin-bottom: 1rem; line-height: 1.6; }
.prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.prose li { margin-bottom: 0.5rem; }
.formula-box {
background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1rem;
overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
}
details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
details[open] > summary { margin-bottom: 0.5rem; }
.result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; }
.result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; text-align: center; }
.result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; text-align: center; }
.result-card .result-sub { font-size: 1.1rem; font-weight: 500; color: #4b5563; text-align: center; margin-top: 0.25rem; }

/* Custom Focus State - WCAG 2.1 AA */
:focus-visible {
outline: 3px solid #3b82f6;
outline-offset: 2px;
box-shadow: none;
}
/* Remove default outline for elements with custom focus-visible */
:focus {
outline: none;
}
/* Ensure form inputs get the ring */
input:focus-visible, select:focus-visible, button:focus-visible, [role="tab"]:focus-visible {
outline: 3px solid #3b82f6 !important;
outline-offset: 2px !important;
}

/* Accessible Tablist */
[role="tab"] {
border-bottom: 3px solid transparent;
}
[role="tab"][aria-selected="true"] {
border-bottom-color: #2563eb;
color: #2563eb;
font-weight: 600;
}
.error-message {
color: #dc2626;
font-size: 0.875rem;
margin-top: 0.5rem;
}
</style>

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "WebPage",
"name": "Date Calculator: Find Duration & Add/Subtract Dates",
"description": "Calculate the duration (years, months, days) between two dates, or find a new date by adding or subtracting time. Accurate, accessible, and mobile-friendly.",
"url": "https://calcdomain.com/date-calculator.html",
"inLanguage": "en",
"author": { "@type": "Person", "name": "Ugo Candido" },
"publisher": { "@type": "Organization", "name": "CalcDomain" }
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "BreadcrumbList",
"itemListElement": [
{ "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/" },
{ "@type": "ListItem", "position": 2, "name": "Everyday Life", "item": "https://calcdomain.com/lifestyle-everyday.html" },
{ "@type": "ListItem", "position": 3, "name": "Time and Date", "item": "https://calcdomain.com/subcategories/time-date.html" },
{ "@type": "ListItem", "position": 4, "name": "Date Calculator", "item": "https://calcdomain.com/date-calculator.html" }
]
}
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "HowTo",
"name": "How to Use the Date Calculator",
"description": "A step-by-step guide to calculating date durations and new dates.",
"step": [
{"@type": "HowToStep", "name": "Choose a Mode", "text": "Select either 'Calculate Duration' to find the time between two dates or 'Add / Subtract Time' to find a new date."},
{"@type": "HowToStep", "name": "Enter Dates (for Duration)", "text": "Input the 'Start Date' and 'End Date' and check 'Include end day' if needed."},
{"@type": "HowToStep", "name": "Enter Time (for Add/Subtract)", "text": "Input the 'Start Date', select 'Add' or 'Subtract', and enter the amount of years, months, weeks, or days."},
{"@type": "HowToStep", "name": "Calculate", "text": "Click the 'Calculate' button to see the result."},
{"@type": "HowToStep", "name": "Review Results", "text": "The result will appear below, showing the total duration in multiple units or the new calculated date and day of the week."}
]
}
</script>
<script src="search.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900">

<header class="bg-white shadow-sm">
<nav class="container mx-auto px-4 lg:px-6 py-4">
<div class="flex justify-between items-center">
<a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

<div class="w-full max-w-md hidden md:block mx-8">
<div class="relative">
<input type="search" id="search-input" placeholder="Search for a calculator..."
class="w-full py-2 px-4 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
autocomplete="off">
<svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
</svg>
<div id="search-results" class="absolute top-full left-0 right-0 hidden bg-white border border-gray-200 rounded-lg shadow-lg mt-2 max-h-96 overflow-y-auto z-50"></div>
</div>
</div>

<div class="hidden md:flex items-center space-x-6 text-sm">
<a href="search.html" class="text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="text-gray-700 hover:text-blue-600">Categories</a>
</div>

<button id="mobile-menu-toggle" class="md:hidden p-2" aria-label="Open menu">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M4 6h16M4 12h16M4 18h16"></path>
</svg>
</button>
</div>

<div id="mobile-menu" class="md:hidden mt-4 hidden">
<div class="space-y-2">
<a href="search.html" class="block py-2 text-gray-700 hover:text-blue-600">Advanced Search</a>
<a href="index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600">Categories</a>
</div>
</div>
</nav>
</header>

<main class="container mx-auto px-4 lg:px-6 py-10">
<div class="flex flex-col lg:flex-row gap-8">

<section class="w-full lg:w-2/3">
<nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
<a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
<a href="lifestyle-everyday.html" class="hover:text-blue-600">Everyday Life</a> &raquo;
<a href="subcategories/time-date.html" class="hover:text-blue-600">Time and Date</a> &raquo;
<span class="text-gray-900">Date Calculator</span>
</nav>

<div id="print-section" class="bg-white p-6 rounded-lg shadow-md">
<h1 class="text-3xl font-extrabold text-gray-900 mb-2">Date Calculator</h1>
<p class="text-gray-600 mb-6">Easily calculate the duration between two dates or find a new date by adding or subtracting years, months, weeks, and days. Ideal for planning events, tracking deadlines, or calculating age.</p>

<div class="mb-4 border-b border-gray-200">
<div role="tablist" aria-label="Date Calculation Mode" class="flex -mb-px space-x-6">
<button role="tab" aria-selected="true" id="tab-duration" aria-controls="panel-duration" class="py-3 px-1 text-sm font-medium text-gray-600 hover:text-blue-600">
Calculate Duration
</button>
<button role="tab" aria-selected="false" id="tab-addsub" aria-controls="panel-addsub" class="py-3 px-1 text-sm font-medium text-gray-600 hover:text-blue-600" tabindex="-1">
Add / Subtract Time
</button>
</div>
</div>

<form id="calculator-form" class="space-y-6">
<div role="tabpanel" id="panel-duration" aria-labelledby="tab-duration" class="space-y-6">
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div>
<label for="startDateDur" class="block text-sm font-medium text-gray-700 mb-1">Start Date <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="date" id="startDateDur" aria-required="true"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
</div>
<div>
<label for="endDateDur" class="block text-sm font-medium text-gray-700 mb-1">End Date <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="date" id="endDateDur" aria-required="true"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
</div>
</div>
<div class="flex items-center">
<input type="checkbox" id="includeEndDay" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
<label for="includeEndDay" class="ml-2 block text-sm text-gray-900">Include end day (adds 1 day)</label>
</div>
<div id="duration-error" role="alert" class="error-message hidden"></div>
</div>

<div role="tabpanel" id="panel-addsub" aria-labelledby="tab-addsub" class="space-y-6 hidden">
<div>
<label for="startDateAdd" class="block text-sm font-medium text-gray-700 mb-1">Start Date <span class="text-red-600" aria-hidden="true">*</span></label>
<input type="date" id="startDateAdd" aria-required="true"
class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
</div>
<fieldset>
<legend class="block text-sm font-medium text-gray-700 mb-2">Operation</legend>
<div class="flex items-center space-x-6">
<div class="flex items-center">
<input type="radio" id="op-add" name="operation" value="add" checked class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500">
<label for="op-add" class="ml-2 block text-sm text-gray-900">Add</label>
</div>
<div class="flex items-center">
<input type="radio" id="op-sub" name="operation" value="sub" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500">
<label for="op-sub" class="ml-2 block text-sm text-gray-900">Subtract</label>
</div>
</div>
</fieldset>
<fieldset>
<legend class="block text-sm font-medium text-gray-700 mb-1">Time to Add or Subtract</legend>
<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-2">
<div>
<label for="addYears" class="block text-sm font-medium text-gray-700">Years</label>
<input type="number" id="addYears" min="0" step="1" placeholder="0" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
</div>
<div>
<label for="addMonths" class="block text-sm font-medium text-gray-700">Months</label>
<input type="number" id="addMonths" min="0" step="1" placeholder="0" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
</div>
<div>
<label for="addWeeks" class="block text-sm font-medium text-gray-700">Weeks</label>
<input type="number" id="addWeeks" min="0" step="1" placeholder="0" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
</div>
<div>
<label for="addDays" class="block text-sm font-medium text-gray-700">Days</label>
<input type="number" id="addDays" min="0" step="1" placeholder="0" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
</div>
</div>
</fieldset>
<div id="addsub-error" role="alert" class="error-message hidden"></div>
</div>

<div class="flex items-center space-x-4">
<button type="submit" id="calculateBtn" class="px-6 py-3 bg-blue-600 text-white font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
Calculate
</button>
<button type="reset" id="resetBtn" class="px-6 py-3 bg-gray-200 text-gray-700 font-medium rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400">
Clear
</button>
</div>
</form>

<section id="results" aria-live="polite" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6 min-h-[120px]">
<h3 class="text-xl font-semibold text-gray-900 mb-4" id="result-title">Result</h3>
<div id="result-content" class="text-gray-700">
<p>Results will be displayed here once calculated.</p>
</div>
</section>
</div>

<article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
<h2>Data Source and Methodology</h2>
<p>This calculator operates based on the rules of the <strong>Gregorian calendar</strong>, the most widely used civil calendar, and adheres to the date and time representations defined by the <strong>ISO 8601 standard</strong>.</p>
<p>All calculations are performed using JavaScript's native Date object, which accounts for leap years and variable month lengths. All date inputs are parsed as local time at midnight (00:00:00) to ensure consistency and avoid time zone-related errors.</p>

<h2>The Formula Explained</h2>
<p>Calculating date differences isn't a single formula, but an algorithm. Here are the core concepts:</p>

<h3>Calculating Duration</h3>
<p>To find the number of days between two dates, the calculator converts both dates into a numeric timestamp (milliseconds since the UNIX epoch: Jan 1, 1970). The difference is then divided by the number of milliseconds in a day.</p>
<div class="formula-box">
$TotalDays = \lfloor \frac{Timestamp_{End} - Timestamp_{Start}}{1000 \times 60 \times 60 \times 24} \rfloor$
</div>
<p>The "Years, Months, Days" breakdown is more complex. It's an iterative process that calculates full years, then full months from the remainder, and finally the remaining days, correctly accounting for leap years and month lengths.</p>

<h3>Adding or Subtracting Time</h3>
<p>Adding time units is done in order from largest to smallest (Years, Months, Weeks, Days). The calculator includes special logic to handle "month-end" ambiguity. For example, if you add 1 month to January 31, 2025, the result will be February 28, 2025 (the last day of the target month), not March 2 or 3, which can happen with naive calculations.</p>

<h2>Glossary of Variables</h2>
<ul class="space-y-2">
<li><strong>Start Date:</strong> The initial date from which to begin a calculation.</li>
<li><strong>End Date:</strong> The final date used to find the duration.</li>
<li><strong>Include end day:</strong> A toggle that adds one day to the total duration. This is useful for "inclusive" counts (e.g., Jan 1 to Jan 2 is 2 days, not 1).</li>
<li><strong>Years/Months/Weeks/Days (Add/Subtract):</strong> The specific units of time to add to or subtract from the Start Date.</li>
<li><strong>Total Days (Result):</strong> The total number of 24-hour periods between the two dates.</li>
<li><strong>Duration Breakdown (Result):</strong> The same duration expressed as a combination of Years, Months, and Days.</li>
<li><strong>New Date (Result):</strong> The final date after the time units have been added or subtracted.</li>
</ul>

<h2>How It Works: A Step-by-Step Example</h2>
<h3>Example 1: Calculating Duration</h3>
<p>Let's find the time between <strong>July 4, 2025</strong> and <strong>December 25, 2025</strong>.</p>
<ol>
<li><strong>Mode:</strong> Select 'Calculate Duration'.</li>
<li><strong>Start Date:</strong> Set to `2025-07-04`.</li>
<li><strong>End Date:</strong> Set to `2025-12-25`.</li>
<li><strong>Calculate:</strong> The tool first finds the millisecond difference and divides by 86,400,000.</li>
<li><strong>Result:</strong>
<ul>
<li><strong>Total Days:</strong> 174 days</li>
<li><strong>Duration Breakdown:</strong> 5 months, 21 days</li>
</ul>
</li>
</ol>

<h3>Example 2: Adding Time</h3>
<p>Let's find the date <strong>6 months and 15 days</strong> after <strong>October 20, 2025</strong>.</p>
<ol>
<li><strong>Mode:</strong> Select 'Add / Subtract Time'.</li>
<li><strong>Start Date:</strong> Set to `2025-10-20`.</li>
<li><strong>Operation:</strong> Ensure 'Add' is selected.</li>
<li><strong>Inputs:</strong> Enter `6` in Months and `15` in Days.</li>
<li><strong>Calculate:</strong> The tool adds 6 months to Oct 20, 2025 (resulting in April 20, 2026), then adds 15 days.</li>
<li><strong>Result:</strong>
<ul>
<li><strong>New Date:</strong> May 5, 2026</li>
<li><strong>Day of the Week:</strong> Tuesday</li>
</ul>
</li>
</ol>

<h2>Frequently Asked Questions</h2>
<details>
<summary>How does the calculator handle leap years?</summary>
<p>All calculations automatically account for leap years as defined by the Gregorian calendar. A leap year occurs every 4 years, except for years divisible by 100 but not by 400. This means 2000 was a leap year, 2100 will not be, and 2024 is. Adding 1 year to February 29, 2024 will result in February 28, 2025.</p>
</details>
<details>
<summary>What happens if I add 1 month to January 31?</summary>
<p>This calculator is designed to handle this specific edge case logically. Adding 1 month to January 31 results in February 28 (or 29 in a leap year). The logic finds the last valid day of the target month rather than "rolling over" into the next month.</p>
</details>
<details>
<summary>Why is "Include end day" an option?</summary>
<p>This depends on how you're counting. If you ask "how many days from Monday to Friday," you might mean 4 days (Tue, Wed, Thu, Fri) or 5 (Mon, Tue, Wed, Thu, Fri). By default, the calculator provides the difference (4 days). Checking "Include end day" gives the inclusive count (5 days).</p>
</details>
<details>
<summary>How do I calculate my age?</summary>
<p>Select the 'Calculate Duration' mode. Set the 'Start Date' to your birth date and the 'End Date' to today's date. The 'Duration Breakdown' (e.g., 30 years, 5 months, 12 days) is your exact age.</p>
</details>
<details>
<summary>Can I calculate durations in hours, minutes, or seconds?</summary>
<p>This calculator is designed for day-level precision. For calculations involving hours or minutes, you would need a specialized Time Duration calculator.</p>
</details>
<details>
<summary>Why is my "Duration Breakdown" different from "Total Days"?</summary>
<p>They are two ways of expressing the same duration. "Total Days" is a single number (e.g., <strong>397 days</strong>). "Duration Breakdown" converts this into the largest possible units (e.g., <strong>1 year, 1 month, 1 day</strong>). Both represent the same amount of time.</p>
</details>

<div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600">
<p><strong>Tool developed by Ugo Candido.</strong> Contents verified by the CalcDomain Editorial Board.<br>
Last accuracy review: <time datetime="2025-10-25">October 25, 2025</time></p>
</div>
</article>
</section>

<aside class="w-full lg:w-1/3">
<div class="sticky top-24 space-y-6">
<div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
Ad Placement (300×600)
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-3">Why use this calculator</h3>
<ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
<li>Get two tools in one: Duration and Add/Subtract.</li>
<li>Calculations are instant and handle leap years automatically.</li>
<li>Smart logic prevents common errors, like month-end rollovers.</li>
<li>Fully accessible (WCAG 2.1) and mobile-first design.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-lg shadow-md">
<h3 class="font-bold text-lg mb-4">Related time tools</h3>
<ul class="space-y-3 text-sm">
<li><a href="age-calculator.html" class="text-blue-600 hover:underline">Age Calculator</a></li>
<li><a href="time-duration-calculator.html" class="text-blue-600 hover:underline">Time Duration Calculator</a></li>
<li><a href="work-days-calculator.html" class="text-blue-600 hover:underline">Business Days Calculator</a></li>
<li><a href="countdown-timer.html" class="text-blue-600 hover:underline">Countdown Timer</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>

<footer class="bg-white border-t">
<div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
<p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
<div class="mt-4 space-x-4">
<a href="about.html" class="hover:text-blue-600">About</a>
<a href="contact.html" class="hover:text-blue-600">Contact</a>
<a href="privacy.html" class="hover:text-blue-600">Privacy</a>
<a href="terms.html" class="hover:text-blue-600">Terms</a>
</div>
</div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
// --- DOM Element Selection ---
const $ = (selector) => document.querySelector(selector);
const $$ = (selector) => document.querySelectorAll(selector);

const elements = {
form: $('#calculator-form'),
tabs: $$('[role="tab"]'),
panels: $$('[role="tabpanel"]'),
resultTitle: $('#result-title'),
resultContent: $('#result-content'),
// Duration
startDateDur: $('#startDateDur'),
endDateDur: $('#endDateDur'),
includeEndDay: $('#includeEndDay'),
durationError: $('#duration-error'),
// Add/Subtract
startDateAdd: $('#startDateAdd'),
opAdd: $('#op-add'),
addYears: $('#addYears'),
addMonths: $('#addMonths'),
addWeeks: $('#addWeeks'),
addDays: $('#addDays'),
addsubError: $('#addsub-error')
};

let activeTab = 'duration';

// --- Utility Functions ---

/**
* Safely parses a YYYY-MM-DD string into a local Date object at midnight.
* This avoids time zone issues associated with new Date(string).
* @param {string} dateString - The date string in "YYYY-MM-DD" format.
* @returns {Date | null} A Date object or null if invalid.
*/
const parseDate = (dateString) => {
if (!dateString) return null;
const parts = dateString.split('-').map(Number);
if (parts.length !== 3 || isNaN(parts[0]) || isNaN(parts[1]) || isNaN(parts[2])) {
return null;
}
// new Date(Year, MonthIndex, Day)
const date = new Date(parts[0], parts[1] - 1, parts[2]);
// Verify the date wasn't invalid (e.g., 2025-02-31)
if (date.getFullYear() === parts[0] &&
date.getMonth() === parts[1] - 1 &&
date.getDate() === parts[2]) {
return date;
}
return null;
};

/**
* Formats a Date object into a readable string (e.g., "October 27, 2025").
* @param {Date} date - The Date object to format.
* @returns {string} The formatted date string.
*/
const formatDate = (date) => {
return date.toLocaleDateString('en-US', {
year: 'numeric',
month: 'long',
day: 'numeric',
});
};

/**
* Gets the full day of the week (e.g., "Monday").
* @param {Date} date - The Date object.
* @returns {string} The day of the week.
*/
const getDayOfWeek = (date) => {
return date.toLocaleDateString('en-US', { weekday: 'long' });
};

/**
* Formats a number with commas.
* @param {number} num - The number to format.
* @returns {string} The formatted number string.
*/
const formatNumber = (num) => {
return num.toLocaleString('en-US');
};

/**
* Shows an error message and links it to the input for accessibility.
* @param {HTMLElement} errorEl - The error message container.
* @param {HTMLElement} inputEl - The input field with the error.
* @param {string} message - The error message to display.
*/
const showError = (errorEl, inputEl, message) => {
errorEl.textContent = message;
errorEl.classList.remove('hidden');
inputEl.setAttribute('aria-describedby', errorEl.id);
inputEl.setAttribute('aria-invalid', 'true');
// Focus the first invalid field
if (document.activeElement !== inputEl) {
inputEl.focus();
}
};

/**
* Clears all error messages and ARIA attributes.
*/
const clearErrors = () => {
[elements.durationError, elements.addsubError].forEach(el => {
el.textContent = '';
el.classList.add('hidden');
});
[elements.startDateDur, elements.endDateDur, elements.startDateAdd].forEach(input => {
input.removeAttribute('aria-describedby');
input.removeAttribute('aria-invalid');
});
};

/**
* Clears the results area.
*/
const clearResults = () => {
elements.resultTitle.textContent = 'Result';
elements.resultContent.innerHTML = '<p>Results will be displayed here once calculated.</p>';
};

// --- Tab Switching Logic ---

elements.tabs.forEach(tab => {
tab.addEventListener('click', () => {
// Deactivate all
elements.tabs.forEach(t => {
t.setAttribute('aria-selected', 'false');
t.setAttribute('tabindex', '-1');
});
elements.panels.forEach(p => p.classList.add('hidden'));

// Activate clicked
tab.setAttribute('aria-selected', 'true');
tab.removeAttribute('tabindex');
const panelId = tab.getAttribute('aria-controls');
$(`#${panelId}`).classList.remove('hidden');

activeTab = panelId.includes('duration') ? 'duration' : 'addsub';
clearErrors();
clearResults();
});
});

// --- Calculation Logic ---

/**
* Calculates the duration between two dates.
*/
const calculateDuration = () => {
const start = parseDate(elements.startDateDur.value);
const end = parseDate(elements.endDateDur.value);

// Validation
if (!start) {
showError(elements.durationError, elements.startDateDur, 'Please enter a valid start date.');
return;
}
if (!end) {
showError(elements.durationError, elements.endDateDur, 'Please enter a valid end date.');
return;
}

let startDate = start;
let endDate = end;

if (endDate < startDate) {
[startDate, endDate] = [endDate, startDate]; // Swap if end is before start
}

const includeDay = elements.includeEndDay.checked;
const msPerDay = 1000 * 60 * 60 * 24;

// 1. Total Days
let dayDiff = Math.round((endDate.getTime() - startDate.getTime()) / msPerDay);
if (includeDay) {
dayDiff += 1;
}

// 2. Breakdown (Years, Months, Days)
let y = endDate.getFullYear() - startDate.getFullYear();
let m = endDate.getMonth() - startDate.getMonth();
let d = endDate.getDate() - startDate.getDate();

if (d < 0) {
m--;
// Get days in *previous* month of end date
const daysInPrevMonth = new Date(endDate.getFullYear(), endDate.getMonth(), 0).getDate();
d += daysInPrevMonth;
}
if (m < 0) {
y--;
m += 12;
}

// Adjust for inclusion
let y_inc = y, m_inc = m, d_inc = d;
if (includeDay) {
d_inc++;
// Handle day rollover
const daysInMonth = new Date(startDate.getFullYear() + y_inc, startDate.getMonth() + m_inc + 1, 0).getDate();
if (d_inc >= daysInMonth) {
d_inc = 0;
m_inc++;
if (m_inc >= 12) {
m_inc = 0;
y_inc++;
}
}
}
const breakdown = (includeDay) ? { y: y_inc, m: m_inc, d: d_inc } : { y, m, d };

renderDurationResults(dayDiff, breakdown);
};

/**
* Adds or subtracts time from a date.
*/
const calculateAddSub = () => {
const start = parseDate(elements.startDateAdd.value);

// Validation
if (!start) {
showError(elements.addsubError, elements.startDateAdd, 'Please enter a valid start date.');
return;
}

const sign = elements.opAdd.checked ? 1 : -1;
const years = (parseInt(elements.addYears.value) || 0) * sign;
const months = (parseInt(elements.addMonths.value) || 0) * sign;
const weeks = (parseInt(elements.addWeeks.value) || 0) * sign;
const days = (parseInt(elements.addDays.value) || 0) * sign;

if (years === 0 && months === 0 && weeks === 0 && days === 0) {
showError(elements.addsubError, elements.addYears, 'Please enter at least one time unit to add or subtract.');
return;
}

const resultDate = new Date(start.getTime());
const originalDay = resultDate.getDate();

// Apply in order: Years, Months, Days (Weeks are just days)
resultDate.setFullYear(resultDate.getFullYear() + years);

// Smart Month Addition
resultDate.setMonth(resultDate.getMonth() + months);
// Check for month-end rollover
if (resultDate.getDate() !== originalDay) {
// Rolled over (e.g., Jan 31 + 1 Mo = Mar 2).
// Set to last day of *previous* month (which is the correct target month)
resultDate.setDate(0);
}

// Apply Days
resultDate.setDate(resultDate.getDate() + (weeks * 7));
resultDate.setDate(resultDate.getDate() + days);

renderAddSubResult(resultDate);
};

// --- Rendering Logic ---

/**
* Renders the results for the Duration calculation.
* @param {number} totalDays - The total number of days.
* @param {object} breakdown - An object {y, m, d}.
*/
const renderDurationResults = (totalDays, breakdown) => {
elements.resultTitle.textContent = 'Calculated Duration';

const plural = (val, str) => val === 1 ? `1 ${str}` : `${formatNumber(val)} ${str}s`;

const breakdownStr = [
plural(breakdown.y, 'year'),
plural(breakdown.m, 'month'),
plural(breakdown.d, 'day')
].join(', ');

elements.resultContent.innerHTML = `
<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
<div class="result-card">
<h4>Duration Breakdown</h4>
<p>${breakdown.y > 0 ? plural(breakdown.y, 'Year') : ''} ${breakdown.m > 0 ? plural(breakdown.m, 'Month') : ''} ${breakdown.d > 0 ? plural(breakdown.d, 'Day') : ''}</p>
<p class="result-sub">${breakdownStr}</p>
</div>
<div class="result-card">
<h4>Total Days</h4>
<p>${formatNumber(totalDays)}</p>
<p class="result-sub">Total number of days</p>
</div>
</div>
`;
};

/**
* Renders the results for the Add/Subtract calculation.
* @param {Date} resultDate - The final calculated date.
*/
const renderAddSubResult = (resultDate) => {
elements.resultTitle.textContent = 'New Date';
elements.resultContent.innerHTML = `
<div class="result-card max-w-sm mx-auto">
<h4>Resulting Date</h4>
<p>${formatDate(resultDate)}</p>
<p class="result-sub">${getDayOfWeek(resultDate)}</p>
</div>
`;
};

// --- Event Listeners ---

elements.form.addEventListener('submit', (e) => {
e.preventDefault();
clearErrors();
if (activeTab === 'duration') {
calculateDuration();
} else {
calculateAddSub();
}
});

elements.form.addEventListener('reset', () => {
clearErrors();
clearResults();
// Reset tabs to default
elements.tabs[0].click();
});

// Set default dates for a better experience
const today = new Date().toISOString().split('T')[0];
elements.startDateDur.value = today;
elements.endDateDur.value = today;
elements.startDateAdd.value = today;

});
</script>
</body>
</html>
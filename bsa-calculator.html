<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BSA Calculator (Body Surface Area) – Accurate Multi-Formula Tool</title>
  <meta name="description" content="Professional Body Surface Area (BSA) calculator using Mosteller, Du Bois, Haycock, and Gehan–George formulas. Supports metric/US units, accessibility, and printable results." />
  <link rel="canonical" href="https://calcdomain.com/bsa-calculator.html" />

  <!-- Icons / PWA (optional placeholders) -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Chart.js for visual comparison -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- MathJax for LaTeX formulas -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root { --focus-ring: 3px solid #2563eb; }
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji"; }
    .prose { max-width: 70ch; }
    .prose h2 { font-size: 1.5rem; font-weight: 700; margin-top: 2rem; margin-bottom: 0.75rem; }
    .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.25rem; margin-bottom: 0.5rem; }
    .prose p { margin-bottom: 1rem; line-height: 1.7; }
    .prose ul, .prose ol { margin-left: 1.25rem; margin-bottom: 1rem; }
    .formula-box { background:#f3f4f6; border:1px solid #d1d5db; border-radius:10px; padding:1rem; overflow-x:auto; }
    /* Focus visibility */
    :is(a,button,input,select,summary,details,[role="switch"]) :focus { outline: none; }
    :is(a,button,input,select,summary,details,[role="switch"]):focus-visible { box-shadow: 0 0 0 3px rgba(37,99,235,.5); outline: var(--focus-ring); outline-offset: 2px; border-radius: 8px; }
    /* Results min-height to prevent CLS */
    #results { min-height: 280px; }
    /* Touch targets */
    .touch-target { min-height: 48px; min-width: 48px; }
    /* Print */
    @media print {
      header, footer, aside, #chartBlock, #faq, .no-print { display: none !important; }
      #print-section { margin: 0; padding: 0; }
    }
  </style>

  <!-- JSON-LD: WebPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"bsa calculator",
    "url":"https://calcdomain.com/bsa-calculator.html",
    "inLanguage":"en",
    "description":"Professional Body Surface Area (BSA) calculator using Mosteller, Du Bois, Haycock, and Gehan–George formulas. Supports metric/US units, accessibility, and printable results.",
    "breadcrumb":{
      "@type":"BreadcrumbList",
      "itemListElement":[
        {"@type":"ListItem","position":1,"name":"Home","item":"https://calcdomain.com/"},
        {"@type":"ListItem","position":2,"name":"Health & Fitness","item":"https://calcdomain.com/health-fitness.html"},
        {"@type":"ListItem","position":3,"name":"Health Metrics","item":"https://calcdomain.com/subcategories/health-metrics.html"},
        {"@type":"ListItem","position":4,"name":"BSA Calculator","item":"https://calcdomain.com/bsa-calculator.html"}
      ]
    },
    "author":{"@type":"Person","name":"Ugo Candido"},
    "publisher":{"@type":"Organization","name":"CalcDomain"}
  }
  </script>

  <!-- JSON-LD: HowTo -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to calculate Body Surface Area (BSA)",
    "description":"Enter height and weight, choose unit system, and the calculator computes BSA using several validated formulas.",
    "step":[
      {"@type":"HowToStep","name":"Select Units","text":"Choose Metric (cm, kg) or US (in, lb)."},
      {"@type":"HowToStep","name":"Enter Height","text":"Provide height in centimeters or inches."},
      {"@type":"HowToStep","name":"Enter Weight","text":"Provide weight in kilograms or pounds."},
      {"@type":"HowToStep","name":"Review Results","text":"See BSA by Mosteller (default), Du Bois, Haycock, and Gehan–George."},
      {"@type":"HowToStep","name":"Export/Print","text":"Use the Print button to save a clean record for charts or clinical notes."}
    ]
  }
  </script>

  <!-- JSON-LD: FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"Which BSA formula should I use?","acceptedAnswer":{"@type":"Answer","text":"Mosteller is widely used for its simplicity and accuracy. Du Bois and Haycock are also common in clinical practice. Your local guideline or protocol should prevail."}},
      {"@type":"Question","name":"Can I use BSA for drug dosing?","acceptedAnswer":{"@type":"Answer","text":"BSA is often used to derive initial dosing for certain chemotherapeutics and other drugs. Always follow institutional protocols and prescriber judgment."}},
      {"@type":"Question","name":"Does BSA change with units?","acceptedAnswer":{"@type":"Answer","text":"No. The calculator converts units internally; the resulting BSA in m² is independent of whether you used metric or US units."}},
      {"@type":"Question","name":"Is BSA accurate in children?","acceptedAnswer":{"@type":"Answer","text":"Pediatric dosing often uses BSA. Formulas like Mosteller and Haycock are commonly applied, but follow pediatric guidelines and specialist advice."}},
      {"@type":"Question","name":"What are typical adult BSA values?","acceptedAnswer":{"@type":"Answer","text":"Typical adult BSA is around 1.6–2.2 m². Individual results vary by height and weight."}},
      {"@type":"Question","name":"Do I need age or sex?","acceptedAnswer":{"@type":"Answer","text":"Most BSA formulas use only height and weight; age and sex are not required."}},
      {"@type":"Question","name":"Can I export results?","acceptedAnswer":{"@type":"Answer","text":"Use the Print button to generate a clean copy. You can also copy values directly from the results cards."}}
    ]
  }
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header (non-sticky per spec) -->
  <header class="bg-white border-b">
    <nav class="container mx-auto px-4 lg:px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-extrabold text-blue-600">CalcDomain</a>
      <div class="hidden md:flex items-center gap-6 text-sm">
        <a href="search.html" class="hover:text-blue-600">Advanced Search</a>
        <a href="index.html#categories" class="hover:text-blue-600">Categories</a>
      </div>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-6 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Main content -->
      <section class="w-full lg:w-2/3">
        <!-- Breadcrumb -->
        <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
          <a href="index.html" class="hover:text-blue-600">Home</a> &raquo;
          <a href="health-fitness.html" class="hover:text-blue-600">Health &amp; Fitness</a> &raquo;
          <a href="subcategories/health-metrics.html" class="hover:text-blue-600">Health Metrics</a> &raquo;
          <span class="text-gray-900">BSA Calculator</span>
        </nav>

        <div id="print-section" class="bg-white p-6 rounded-lg shadow-sm">
          <!-- 1) H1 -->
          <h1 class="text-3xl font-extrabold text-gray-900 mb-2">bsa calculator</h1>

          <!-- 2) Intro -->
          <p class="text-gray-700 mb-6">
            Compute Body Surface Area (BSA) with clinically accepted formulas (Mosteller, Du Bois, Haycock, Gehan–George).
            Designed for healthcare professionals and students who need fast, reliable results with accessible UX and printable output.
          </p>

          <!-- 3) Calculator UI -->
          <section id="calculator-ui" class="space-y-6" aria-labelledby="calcTitle">
            <h2 id="calcTitle" class="sr-only">BSA calculator inputs</h2>

            <!-- Units toggle -->
            <fieldset class="bg-gray-50 border border-gray-200 rounded-lg p-4">
              <legend class="font-semibold text-gray-900">Units <span class="text-red-600" aria-hidden="true">*</span></legend>
              <p id="unitsTip" class="text-sm text-gray-600 mt-1">Choose your preferred unit system. The result is always in m².</p>
              <div class="mt-3 flex gap-6">
                <label class="inline-flex items-center gap-2 touch-target">
                  <input type="radio" name="units" id="unitsMetric" class="accent-blue-600" value="metric" checked
                         aria-describedby="unitsTip" aria-required="true">
                  <span>Metric (cm, kg)</span>
                </label>
                <label class="inline-flex items-center gap-2 touch-target">
                  <input type="radio" name="units" id="unitsUs" class="accent-blue-600" value="us"
                         aria-describedby="unitsTip" aria-required="true">
                  <span>US (in, lb)</span>
                </label>
              </div>
            </fieldset>

            <!-- Inputs grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Height -->
              <div>
                <div class="flex items-center gap-2">
                  <label for="height" class="block text-sm font-medium text-gray-900">
                    Height <span class="text-red-600" aria-hidden="true">*</span>
                  </label>
                  <button type="button" class="ml-1 text-xs px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 focus-visible:ring-2 focus-visible:ring-blue-500"
                          aria-expanded="false" aria-controls="heightHelp" id="heightHelpBtn">?</button>
                </div>
                <div class="mt-1 relative">
                  <input type="number" inputmode="decimal" id="height" min="30" max="250" step="0.1"
                         class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600 focus:ring-blue-600"
                         aria-required="true" aria-describedby="heightHelp heightError" />
                  <span id="heightUnit" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500">cm</span>
                </div>
                <p id="heightHelp" class="mt-1 text-sm text-gray-600 hidden">
                  Enter standing height. Valid range: 30–250 cm (12–98 in).
                </p>
                <p id="heightError" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>

              <!-- Weight -->
              <div>
                <div class="flex items-center gap-2">
                  <label for="weight" class="block text-sm font-medium text-gray-900">
                    Weight <span class="text-red-600" aria-hidden="true">*</span>
                  </label>
                  <button type="button" class="ml-1 text-xs px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 focus-visible:ring-2 focus-visible:ring-blue-500"
                          aria-expanded="false" aria-controls="weightHelp" id="weightHelpBtn">?</button>
                </div>
                <div class="mt-1 relative">
                  <input type="number" inputmode="decimal" id="weight" min="1" max="300" step="0.1"
                         class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-600 focus:ring-blue-600"
                         aria-required="true" aria-describedby="weightHelp weightError" />
                  <span id="weightUnit" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500">kg</span>
                </div>
                <p id="weightHelp" class="mt-1 text-sm text-gray-600 hidden">
                  Use actual body weight unless protocol specifies otherwise. Valid range: 1–300 kg (2–660 lb).
                </p>
                <p id="weightError" class="mt-1 text-sm text-red-700" role="alert" aria-live="polite"></p>
              </div>
            </div>

            <!-- Primary actions -->
            <div class="flex flex-wrap items-center gap-3">
              <button id="calcBtn" class="touch-target px-4 py-2 rounded-md bg-blue-600 text-white font-semibold hover:bg-blue-700 focus-visible:ring-4 focus-visible:ring-blue-300">
                Calculate BSA
              </button>
              <button id="resetBtn" class="touch-target px-4 py-2 rounded-md bg-gray-200 text-gray-900 hover:bg-gray-300">
                Reset
              </button>
              <button id="printBtn" class="no-print touch-target px-4 py-2 rounded-md bg-white border text-gray-900 hover:bg-gray-50">
                Print
              </button>
            </div>
          </section>

          <!-- 4) Results -->
          <section id="results" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6">
            <h2 class="text-xl font-bold text-blue-900 mb-4">Results</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="bg-white border rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-600">Mosteller (default)</h3>
                <p id="bsaMosteller" class="text-2xl font-extrabold text-blue-600 mt-1">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-600">Du Bois</h3>
                <p id="bsaDuBois" class="text-2xl font-extrabold text-blue-600 mt-1">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-600">Haycock</h3>
                <p id="bsaHaycock" class="text-2xl font-extrabold text-blue-600 mt-1">—</p>
              </div>
              <div class="bg-white border rounded-lg p-4 text-center">
                <h3 class="text-sm text-gray-600">Gehan–George</h3>
                <p id="bsaGehan" class="text-2xl font-extrabold text-blue-600 mt-1">—</p>
              </div>
            </div>

            <!-- Chart -->
            <div id="chartBlock" class="mt-6">
              <div class="h-56">
                <canvas id="bsaChart" aria-label="BSA comparison by formula"></canvas>
              </div>
            </div>
          </section>
        </div>

        <!-- 5) E-E-A-T content -->
        <article class="bg-white p-6 rounded-lg shadow-sm mt-8 prose">
          <h2>Authoritative data source &amp; methodology</h2>
          <p>
            This tool implements widely accepted BSA equations from peer-reviewed literature:
          </p>
          <ul>
            <li><strong>Mosteller (1987)</strong> – N Engl J Med; BSA \(=\sqrt{\frac{\text{height (cm)}\times \text{weight (kg)}}{3600}}\).</li>
            <li><strong>Du Bois &amp; Du Bois (1916)</strong> – Arch Intern Med; \(BSA = 0.007184 \times H^{0.725}\times W^{0.425}\) with H in cm and W in kg.</li>
            <li><strong>Haycock et&nbsp;al. (1978)</strong> – Clin Pediatr; \(BSA = 0.024265 \times H^{0.3964}\times W^{0.5378}\).</li>
            <li><strong>Gehan &amp; George (1970)</strong> – Cancer Chemother Rep; \(BSA = 0.0235 \times H^{0.42246}\times W^{0.51456}\).</li>
          </ul>
          <p class="italic">Tutti i calcoli si basano rigorosamente sulle formule e sui dati forniti da questa fonte.</p>

          <h2>The formulas (LaTeX)</h2>
          <div class="formula-box">
            Mosteller: \[
              \text{BSA}_{\text{Mosteller}} = \sqrt{\frac{H\_{\text{cm}}\times W\_{\text{kg}}}{3600}}
            \]
            Du Bois & Du Bois: \[
              \text{BSA}_{\text{DuBois}} = 0.007184 \times H\_{\text{cm}}^{0.725}\times W\_{\text{kg}}^{0.425}
            \]
            Haycock: \[
              \text{BSA}_{\text{Haycock}} = 0.024265 \times H\_{\text{cm}}^{0.3964}\times W\_{\text{kg}}^{0.5378}
            \]
            Gehan–George: \[
              \text{BSA}_{\text{Gehan}} = 0.0235 \times H\_{\text{cm}}^{0.42246}\times W\_{\text{kg}}^{0.51456}
            \]
          </div>

          <h2>Glossary of variables</h2>
          <div class="overflow-x-auto">
            <table class="min-w-full text-sm">
              <thead>
                <tr class="bg-gray-100">
                  <th class="text-left p-2">Symbol</th>
                  <th class="text-left p-2">Name</th>
                  <th class="text-left p-2">Units</th>
                  <th class="text-left p-2">Notes</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-t">
                  <td class="p-2"><code>H</code></td>
                  <td class="p-2">Height</td>
                  <td class="p-2">cm (or in → cm)</td>
                  <td class="p-2">Converter applied when US units are selected.</td>
                </tr>
                <tr class="border-t">
                  <td class="p-2"><code>W</code></td>
                  <td class="p-2">Weight</td>
                  <td class="p-2">kg (or lb → kg)</td>
                  <td class="p-2">Converter applied when US units are selected.</td>
                </tr>
                <tr class="border-t">
                  <td class="p-2"><code>BSA</code></td>
                  <td class="p-2">Body Surface Area</td>
                  <td class="p-2">m²</td>
                  <td class="p-2">Reported to 3 decimals for clinical readability.</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h2>How it works: a step-by-step example</h2>
          <h3>Example inputs</h3>
          <ul>
            <li>Height = 170 cm</li>
            <li>Weight = 65 kg</li>
          </ul>
          <h3>Calculation (Mosteller)</h3>
          <p>Plug into \(\sqrt{\frac{H \times W}{3600}}\) ⇒ \(\sqrt{\frac{170 \times 65}{3600}}=\sqrt{3.0694}=1.752\ \text{m}^2\) (≈ 1.75 m²).</p>
          <h3>Interpretation</h3>
          <p>Values around 1.6–2.0 m² are common in adults; use institutional guidance when BSA informs dosing.</p>

          <h2 id="faq">Frequently asked questions</h2>
          <details>
            <summary>Which BSA value should I chart?</summary>
            <p>Use the method your institution specifies. If none is specified, Mosteller is a pragmatic and widely accepted default.</p>
          </details>
          <details>
            <summary>Are inputs required?</summary>
            <p>Yes, height and weight are required. The calculator validates ranges on blur and provides fixes.</p>
          </details>
          <details>
            <summary>How many decimals are shown?</summary>
            <p>Three decimals for BSA (e.g., 1.732 m²), balancing readability and precision.</p>
          </details>
          <details>
            <summary>Is this tool appropriate for pediatrics?</summary>
            <p>Commonly, yes; however, pediatric dosing should always follow specialist protocols.</p>
          </details>
          <details>
            <summary>Why do formulas differ?</summary>
            <p>They originate from different datasets and regression methods. Differences are usually small for typical adult sizes.</p>
          </details>

          <!-- 6) Authorship / Review -->
          <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700">
            <p><strong>Tool developed by Ugo Candido.</strong><br>
            Content verified by CalcDomain Editorial Board.<br>
            Ultima revisione per l'accuratezza in data: <time datetime="2025-10-30">October 30, 2025</time></p>
          </div>
        </article>
      </section>

      <!-- Sidebar -->
      <aside class="w-full lg:w-1/3">
        <div class="sticky top-4 space-y-6">
          <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-600">
            Ad Placement (300×600)
          </div>
          <div class="bg-white p-6 rounded-lg border">
            <h3 class="font-bold text-lg mb-3">Why this BSA calculator</h3>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
              <li>Multi-formula output for transparent comparisons.</li>
              <li>Accessible UI with inline validation and clear tooltips.</li>
              <li>Print-friendly summary for charts and documentation.</li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-lg border">
            <h3 class="font-bold text-lg mb-4">Related health metrics</h3>
            <ul class="space-y-2 text-sm">
              <li><a class="text-blue-600 hover:underline" href="bmi-calculator.html">BMI Calculator</a></li>
              <li><a class="text-blue-600 hover:underline" href="ideal-weight-calculator.html">Ideal Weight</a></li>
              <li><a class="text-blue-600 hover:underline" href="body-fat-calculator.html">Body Fat %</a></li>
              <li><a class="text-blue-600 hover:underline" href="calorie-needs-calculator.html">Calorie Needs</a></li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
      <p>&copy; 2025 CalcDomain. All rights reserved.</p>
      <div class="mt-4 space-x-4">
        <a href="about.html" class="hover:text-blue-600">About</a>
        <a href="contact.html" class="hover:text-blue-600">Contact</a>
        <a href="privacy.html" class="hover:text-blue-600">Privacy</a>
        <a href="terms.html" class="hover:text-blue-600">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Calculator Logic (defer) -->
  <script defer>
  (function(){
    const els = {
      unitsMetric: document.getElementById('unitsMetric'),
      unitsUs: document.getElementById('unitsUs'),
      height: document.getElementById('height'),
      weight: document.getElementById('weight'),
      heightUnit: document.getElementById('heightUnit'),
      weightUnit: document.getElementById('weightUnit'),
      heightError: document.getElementById('heightError'),
      weightError: document.getElementById('weightError'),
      heightHelpBtn: document.getElementById('heightHelpBtn'),
      weightHelpBtn: document.getElementById('weightHelpBtn'),
      heightHelp: document.getElementById('heightHelp'),
      weightHelp: document.getElementById('weightHelp'),
      calcBtn: document.getElementById('calcBtn'),
      resetBtn: document.getElementById('resetBtn'),
      printBtn: document.getElementById('printBtn'),
      outMosteller: document.getElementById('bsaMosteller'),
      outDuBois: document.getElementById('bsaDuBois'),
      outHaycock: document.getElementById('bsaHaycock'),
      outGehan: document.getElementById('bsaGehan'),
    };

    // Chart
    let chart;
    const chartEl = document.getElementById('bsaChart');

    // Accessibility toggles for tooltips
    function toggleHelp(btn, panel){
      const expanded = btn.getAttribute('aria-expanded') === 'true';
      btn.setAttribute('aria-expanded', String(!expanded));
      panel.classList.toggle('hidden');
    }
    els.heightHelpBtn.addEventListener('click', () => toggleHelp(els.heightHelpBtn, els.heightHelp));
    els.weightHelpBtn.addEventListener('click', () => toggleHelp(els.weightHelpBtn, els.weightHelp));
    els.heightHelpBtn.addEventListener('keydown', e => { if(e.key==='Enter' || e.key===' ') { e.preventDefault(); toggleHelp(els.heightHelpBtn, els.heightHelp);} });
    els.weightHelpBtn.addEventListener('keydown', e => { if(e.key==='Enter' || e.key===' ') { e.preventDefault(); toggleHelp(els.weightHelpBtn, els.weightHelp);} });

    // Unit switching
    function setUnits() {
      const metric = els.unitsMetric.checked;
      els.heightUnit.textContent = metric ? 'cm' : 'in';
      els.weightUnit.textContent = metric ? 'kg' : 'lb';
      // adjust ranges for UX (programmatic validation still handles both)
      els.height.min = metric ? 30 : 12;
      els.height.max = metric ? 250 : 98;
      els.weight.min = metric ? 1 : 2;
      els.weight.max = metric ? 300 : 660;
      // Convert existing values heuristically when flipping units (if both present)
      const h = parseFloat(els.height.value);
      const w = parseFloat(els.weight.value);
      if (!isNaN(h)) els.height.value = metric ? (h*2.54).toFixed(1) : (h/2.54).toFixed(1);
      if (!isNaN(w)) els.weight.value = metric ? (w/2.2046226218).toFixed(1) : (w*2.2046226218).toFixed(1);
      clearErrors();
    }
    els.unitsMetric.addEventListener('change', setUnits);
    els.unitsUs.addEventListener('change', setUnits);

    // Validation
    function clearErrors(){
      els.heightError.textContent = '';
      els.weightError.textContent = '';
    }
    function validateHeight(){
      const metric = els.unitsMetric.checked;
      const v = parseFloat(els.height.value);
      if (isNaN(v)) { els.heightError.textContent = 'Please enter a numeric height.'; return false; }
      const min = metric ? 30 : 12;
      const max = metric ? 250 : 98;
      if (v < min || v > max) {
        els.heightError.textContent = `Height must be between ${min} and ${max} ${metric?'cm':'in'}.`;
        return false;
      }
      els.heightError.textContent = '';
      return true;
    }
    function validateWeight(){
      const metric = els.unitsMetric.checked;
      const v = parseFloat(els.weight.value);
      if (isNaN(v)) { els.weightError.textContent = 'Please enter a numeric weight.'; return false; }
      const min = metric ? 1 : 2;
      const max = metric ? 300 : 660;
      if (v < min || v > max) {
        els.weightError.textContent = `Weight must be between ${min} and ${max} ${metric?'kg':'lb'}.`;
        return false;
      }
      els.weightError.textContent = '';
      return true;
    }
    els.height.addEventListener('blur', validateHeight);
    els.weight.addEventListener('blur', validateWeight);

    // Conversions
    const inToCm = (v) => v * 2.54;
    const lbToKg = (v) => v / 2.2046226218;

    // BSA formulas (H in cm, W in kg)
    function mosteller(H, W){ return Math.sqrt((H*W)/3600); }
    function dubois(H, W){ return 0.007184*Math.pow(H,0.725)*Math.pow(W,0.425); }
    function haycock(H, W){ return 0.024265*Math.pow(H,0.3964)*Math.pow(W,0.5378); }
    function gehan(H, W){ return 0.0235*Math.pow(H,0.42246)*Math.pow(W,0.51456); }

    function toMetric(){
      let H = parseFloat(els.height.value);
      let W = parseFloat(els.weight.value);
      if (isNaN(H) || isNaN(W)) return null;
      if (els.unitsUs.checked){ H = inToCm(H); W = lbToKg(W); }
      return { H, W };
    }

    function fmtBSA(v){ return isFinite(v) ? v.toFixed(3) + ' m²' : '—'; }

    function renderChart(values){
      const labels = ['Mosteller','Du Bois','Haycock','Gehan–George'];
      const data = [values.mosteller, values.dubois, values.haycock, values.gehan];
      const cfg = {
        type: 'bar',
        data: { labels, datasets: [{ label: 'BSA (m²)', data }] },
        options: {
          responsive:true, maintainAspectRatio:false,
          plugins:{ legend:{ display:false } },
          scales:{ y:{ beginAtZero:false } }
        }
      };
      if (chart){ chart.data.labels = labels; chart.data.datasets[0].data = data; chart.update(); }
      else { chart = new Chart(chartEl, cfg); }
    }

    function calculate(){
      const okH = validateHeight();
      const okW = validateWeight();
      if(!okH || !okW) return;

      const m = toMetric();
      if(!m) return;
      const H = m.H, W = m.W;

      const vMost = mosteller(H,W);
      const vDu = dubois(H,W);
      const vHay = haycock(H,W);
      const vGeh = gehan(H,W);

      els.outMosteller.textContent = fmtBSA(vMost);
      els.outDuBois.textContent = fmtBSA(vDu);
      els.outHaycock.textContent = fmtBSA(vHay);
      els.outGehan.textContent = fmtBSA(vGeh);

      renderChart({ mosteller: +vMost.toFixed(3), dubois: +vDu.toFixed(3), haycock: +vHay.toFixed(3), gehan: +vGeh.toFixed(3) });
    }

    // Buttons
    els.calcBtn.addEventListener('click', (e)=>{ e.preventDefault(); calculate(); });
    els.resetBtn.addEventListener('click', (e)=>{
      e.preventDefault();
      els.unitsMetric.checked = true;
      els.height.value = '';
      els.weight.value = '';
      setUnits();
      clearErrors();
      els.outMosteller.textContent = '—';
      els.outDuBois.textContent = '—';
      els.outHaycock.textContent = '—';
      els.outGehan.textContent = '—';
      if (chart) { chart.destroy(); chart = null; }
    });
    els.printBtn.addEventListener('click', (e)=>{ e.preventDefault(); window.print(); });

    // Initialize defaults
    setUnits();
    // Sensible demo values to avoid empty LCP on first load (no CLS; results area has min-height)
    els.height.value = '170';
    els.weight.value = '65';
    calculate();
  })();
  </script>
</body>
</html>

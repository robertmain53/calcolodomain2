<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marginal Tax Rate Calculator - See Your 2024-2025 Tax Brackets</title>
    <meta name="description" content="Calculate your federal marginal tax rate, effective tax rate, and total income tax based on the 2024-2025 IRS brackets. Understand your true tax burden.">
    <link rel="canonical" href="https://calcdomain.com/marginal-tax-rate-calculator.html"/>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .prose { max-width: 65ch; }
        .prose h2 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose li { margin-bottom: 0.5rem; }
        .formula-box {
            background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; padding:1rem;
            overflow-x:auto; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
        }
        details > summary { cursor: pointer; font-weight: 600; padding: 0.5rem 0; }
        details[open] > summary { margin-bottom: 0.5rem; }
        .result-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 1.25rem; text-align: center; }
        .result-card h4 { font-size: 0.95rem; color: #6b7280; margin-bottom: 0.25rem; }
        .result-card p { font-size: 1.75rem; font-weight: 700; color: #2563eb; }
        /* Custom focus state for WCAG compliance */
        .focus-visible-custom:focus-visible {
            outline: 3px solid #3b82f6;
            outline-offset: 2px;
            box-shadow: none;
        }
        /* Accessible tooltip icon button */
        .tooltip-btn {
            background: transparent;
            border: none;
            padding: 0.25rem;
            margin-left: 0.25rem;
            border-radius: 9999px;
            cursor: pointer;
            color: #6b7280;
        }
        .tooltip-btn:hover { color: #1d4ed8; }
        /* Hide visually but keep for screen readers */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        [aria-hidden="true"] { display: none; }
        
        @media print {
            body * { visibility: hidden; }
            #print-section, #print-section * { visibility: visible; }
            #print-section { position: absolute; left: 0; top: 0; width: 100%; }
        }
    </style>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "Marginal Tax Rate Calculator",
      "description": "Calculate your federal marginal tax rate, effective tax rate, and total income tax based on the 2024-2025 IRS brackets.",
      "url": "https://calcdomain.com/marginal-tax-rate-calculator.html",
      "inLanguage": "en",
      "author": { "@type": "Person", "name": "Ugo Candido" },
      "publisher": { "@type": "Organization", "name": "CalcDomain" }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://calcdomain.com/" },
        { "@type": "ListItem", "position": 2, "name": "Finance", "item": "https://calcdomain.com/finance.html" },
        { "@type": "ListItem", "position": 3, "name": "Taxes", "item": "https://calcdomain.com/subcategories/taxes.html" },
        { "@type": "ListItem", "position": 4, "name": "Marginal Tax Rate Calculator", "item": "https://calcdomain.com/marginal-tax-rate-calculator.html" }
      ]
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to Calculate Your Marginal Tax Rate",
      "description": "A step-by-step guide to finding your federal marginal tax bracket, effective tax rate, and total tax.",
      "step": [
        {
          "@type": "HowToStep", 
          "name": "Select Filing Status", 
          "text": "Choose your filing status from the dropdown menu: Single, Married Filing Jointly, Married Filing Separately, or Head of Household."
        },
        {
          "@type": "HowToStep", 
          "name": "Enter Taxable Income", 
          "text": "Input your annual taxable income. This is your income *after* taking all deductions (standard or itemized)."
        },
        {
          "@type": "HowToStep", 
          "name": "Calculate", 
          "text": "Click the 'Calculate' button to process your information against the official IRS tax brackets."
        },
        {
          "@type": "HowToStep", 
          "name": "Review Results", 
          "text": "See your Marginal Tax Rate (the rate on your next dollar), your Effective Tax Rate (your average rate), and your Total Tax Owed."
        }
      ]
    }
    </script>
    <script src="search.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900">

    <header class="bg-white shadow-sm">
        <nav class="container mx-auto px-4 lg:px-6 py-4">
            <div class="flex justify-between items-center">
                <a href="index.html" class="text-2xl font-bold text-blue-600">CalcDomain</a>

                <div class="w-full max-w-md hidden md:block mx-8">
                    <div class="relative">
                        <input type="search" id="search-input" placeholder="Search for a calculator..."
                               class="w-full py-2 px-4 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus-visible-custom"
                               autocomplete="off">
                        <svg class="w-5 h-5 absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"
                             fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <div id="search-results" class="absolute top-full left-0 right-0 hidden bg-white border border-gray-200 rounded-lg shadow-lg mt-2 max-h-96 overflow-y-auto z-50"></div>
                    </div>
                </div>

                <div class="hidden md:flex items-center space-x-6 text-sm">
                    <a href="https://calcdomain.com/search.html" class="text-gray-700 hover:text-blue-600 focus-visible-custom rounded">Advanced Search</a>
                    <a href="https://calcdomain.com/index.html#categories" class="text-gray-700 hover:text-blue-600 focus-visible-custom rounded">Categories</a>
                </div>

                <button id="mobile-menu-toggle" class="md:hidden p-2 focus-visible-custom rounded" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>

            <div id="mobile-menu" class="md:hidden mt-4 hidden">
                <div class="space-y-2">
                    <a href="https://calcdomain.com/search.html" class="block py-2 text-gray-700 hover:text-blue-600 focus-visible-custom rounded">Advanced Search</a>
                    <a href="https://calcdomain.com/index.html#categories" class="block py-2 text-gray-700 hover:text-blue-600 focus-visible-custom rounded">Categories</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 lg:px-6 py-10">
        <div class="flex flex-col lg:flex-row gap-8">

            <section class="w-full lg:w-2/3">
                <nav class="text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
                    <a href="https://calcdomain.com/index.html" class="hover:text-blue-600 focus-visible-custom rounded">Home</a> &raquo;
                    <a href="https://calcdomain.com/finance.html" class="hover:text-blue-600 focus-visible-custom rounded">Finance</a> &raquo;
                    <a href="https://calcdomain.com/subcategories/taxes.html" class="hover:text-blue-600 focus-visible-custom rounded">Taxes</a> &raquo;
                    <span class="text-gray-900">Marginal Tax Rate Calculator</span>
                </nav>

                <div id="print-section" class="bg-white p-6 rounded-lg shadow-md">
                    <h1 class="text-3xl font-extrabold text-gray-900 mb-2">Marginal Tax Rate Calculator (2024-2025)</h1>
                    <p class="text-gray-600 mb-6">This calculator helps you determine your federal marginal tax rate based on your taxable income and filing status for the 2024 tax year (filed in 2025). It shows which tax bracket you fall into, your effective tax rate, and your total estimated tax bill. This is essential for financial planning and understanding the tax impact of additional income.</p>

                    <section id="calculator-ui" aria-labelledby="calculator-heading" class="space-y-6">
                        <h2 id="calculator-heading" class="sr-only">Tax Calculator Inputs</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="filingStatus" class="block text-sm font-medium text-gray-700">Filing Status <span class="text-red-600" aria-hidden="true">*</span></label>
                                <select id="filingStatus"
                                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus-visible-custom"
                                        aria-required="true">
                                    <option value="single" selected>Single</option>
                                    <option value="marriedJointly">Married Filing Jointly</option>
                                    <option value="marriedSeparately">Married Filing Separately</option>
                                    <option value="headOfHousehold">Head of Household</option>
                                </select>
                            </div>
                            <div>
                                <div class="flex items-center justify-between">
                                    <label for="taxableIncome" class="block text-sm font-medium text-gray-700">Taxable Income <span class="text-red-600" aria-hidden="true">*</span></label>
                                    <button type="button" class="tooltip-btn focus-visible-custom" id="tooltip-btn" aria-label="What is taxable income?" aria-describedby="tooltip-content" aria-expanded="false">
                                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg>
                                    </button>
                                </div>
                                <input type="number" id="taxableIncome" value="75000" step="100" min="0"
                                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus-visible-custom"
                                       aria-required="true"
                                       aria-describedby="tooltip-content income-error">
                                <div id="tooltip-content" role="tooltip" class="hidden mt-2 p-2 bg-gray-700 text-white text-sm rounded-md" aria-hidden="true">
                                    Taxable income is your income *after* all deductions (like the standard deduction or itemized deductions).
                                </div>
                                <div id="income-error" class="text-sm text-red-600 mt-1" role="alert" aria-live="assertive"></div>
                            </div>
                        </div>
                        <button id="calculate-btn" class="w-full md:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus-visible-custom">
                            Calculate
                        </button>
                    </section>
                    
                    <section id="results-container" aria-labelledby="results-heading" class="mt-8 bg-blue-50 border border-blue-100 rounded-lg p-6 min-h-[150px]">
                        <h2 id="results-heading" class="sr-only">Calculator Results</h2>
                        <div id="error-container" role="alert" aria-live="assertive" class="text-red-700 font-medium"></div>
                        <div id="results-content" class="hidden">
                            <p id="results-summary" class="text-lg text-gray-800 mb-6 text-center"></p>
                            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                                <div class="result-card">
                                    <h4>Marginal Tax Rate</h4>
                                    <p id="marginal-rate" class="text-blue-600">0%</p>
                                </div>
                                <div class="result-card">
                                    <h4>Effective Tax Rate</h4>
                                    <p id="effective-rate" class="text-blue-600">0.00%</p>
                                </div>
                                <div class="result-card">
                                    <h4>Total Tax Owed</h4>
                                    <p id="total-tax" class="text-blue-600">$0.00</p>
                                </div>
                            </div>
                        </div>
                    </section>

                </div>

                <article class="bg-white p-6 rounded-lg shadow-md mt-8 prose">
                    <section id="data-source">
                        <h2>Authoritative Data Source and Methodology</h2>
                        <p>This calculator uses the 2024 U.S. Federal Income Tax Brackets, as defined by the IRS in <a href="https://www.irs.gov/pub/irs-drop/rp-23-48.pdf" target="_blank" rel="nofollow noopener" class="text-blue-600 hover:underline">Revenue Procedure 2023-48</a>. These rates apply to income earned in 2024 (the tax return you file in 2025).</p>
                        <p><strong>All calculations are based strictly on the formulas and data provided by this source.</strong> This calculator does not account for state taxes, local taxes, capital gains, or tax credits, which can lower your final tax bill.</p>
                    </section>
                    
                    <section id="formula">
                        <h2>The Formula Explained</h2>
                        <p>The U.S. federal income tax system is **progressive**. This means you pay different rates on different "portions" (or brackets) of your income. Your <strong>Marginal Tax Rate</strong> is simply the tax rate applied to your *highest* portion of income.</p>
                        <p>Your <strong>Effective Tax Rate</strong>, however, is your *average* tax rate. It provides a clearer picture of your total tax burden and is calculated with the following formula:</p>
                        <div class="formula-box">
                            $$ \text{Effective Tax Rate} = \frac{\text{Total Tax Owed}}{\text{Taxable Income}} \times 100\% $$
                        </div>
                    </section>
                    
                    <section id="glossary">
                        <h2>Glossary of Variables</h2>
                        <dl class="space-y-4">
                            <div>
                                <dt class="font-semibold">Filing Status</dt>
                                <dd class="ml-4">Your tax-filing category (e.g., Single, Married Filing Jointly). Your status determines the income thresholds for each tax bracket.</dd>
                            </div>
                            <div>
                                <dt class="font-semibold">Taxable Income</dt>
                                <dd class="ml-4">Your gross income *after* all eligible deductions (such as the standard deduction or itemized deductions). This is the amount your tax is actually calculated on, not your total salary.</dd>
                            </div>
                            <div>
                                <dt class="font-semibold">Marginal Tax Rate</dt>
                                <dd class="ml-4">The tax rate you pay on your *next dollar* of income. It corresponds to the highest tax bracket your income falls into.</dd>
                            </div>
                            <div>
                                <dt class="font-semibold">Effective Tax Rate</dt>
                                <dd class="ml-4">Your average tax rate. It is your Total Tax Owed divided by your Taxable Income. This rate is almost always lower than your marginal rate.</dd>
                            </div>
                            <div>
                                <dt class="font-semibold">Total Tax Owed</dt>
                                <dd class="ml-4">The total amount of federal income tax you are liable for, calculated by applying the progressive rates across all your income brackets.</dd>
                            </div>
                        </dl>
                    </section>

                    <section id="example">
                        <h2>How It Works: A Step-by-Step Example</h2>
                        <p>Let's calculate the tax for a **Single** filer with **$50,000** in taxable income.</p>
                        <p>We use the 2024 brackets for a Single filer:</p>
                        <ul class="list-none p-0">
                            <li><strong>10%</strong> on income up to $11,600</li>
                            <li><strong>12%</strong> on income over $11,600 up to $47,150</li>
                            <li><strong>22%</strong> on income over $47,150 up to $100,525</li>
                            <li>...and so on.</li>
                        </ul>
                        <ol class="list-decimal list-outside ml-4 space-y-2">
                            <li><strong>Bracket 1 (10%):</strong> The first $11,600 is taxed at 10%.<br>
                                <span class="formula-box inline-block my-1">$11,600 \times 0.10 = \$1,160$</span></li>
                            <li><strong>Bracket 2 (12%):</strong> The income between $11,600 and $47,150 is taxed at 12%.<br>
                                <span class="formula-box inline-block my-1">($47,150 - \$11,600) \times 0.12 = \$35,550 \times 0.12 = \$4,266$</span></li>
                            <li><strong>Bracket 3 (22%):</strong> The remaining income over $47,150 is taxed at 22%.<br>
                                <span class="formula-box inline-block my-1">($50,000 - \$47,150) \times 0.22 = \$2,850 \times 0.22 = \$627$</span></li>
                        </ol>
                        <p><strong>Results:</strong></p>
                        <ul>
                            <li><strong>Total Tax Owed:</strong> $1,160 + $4,266 + $627 = <strong>$6,053</strong></li>
                            <li><strong>Marginal Tax Rate:</strong> <strong>22%</strong> (the highest rate applied)</li>
                            <li><strong>Effective Tax Rate:</strong> ($6,053 / $50,000) = <strong>12.11%</strong></li>
                        </ul>
                    </section>

                    <section id="faq">
                        <h2>Frequently Asked Questions (FAQ)</h2>
                        <details>
                            <summary>What's the difference between marginal and effective tax rate?</summary>
                            <p>Your <strong>marginal rate</strong> is the tax you pay on your *last dollar earned* (your highest bracket). Your <strong>effective rate</strong> is your *average tax rate* (total tax divided by total taxable income). Your effective rate is a more accurate measure of your overall tax burden.</p>
                        </details>
                        <details>
                            <summary>Why is my marginal rate higher than my effective rate?</summary>
                            <p>This is the essence of a progressive tax system. You only pay the highest rate (your marginal rate) on the portion of your income that falls into that top bracket. The rest of your income is taxed at lower rates, pulling your average (effective) rate down.</p>
                        </details>
                        <details>
                            <summary>Does this calculator include state or local taxes?</summary>
                            <p>No. This calculator is for **U.S. Federal Income Tax only**. It does not include state/local taxes, Social Security (FICA), or Medicare, which are calculated separately.</p>
                        </details>
                        <details>
                            <summary>What is 'taxable income'? How is it different from my salary?</summary>
                            <p>Your salary or gross income is your total pay *before* any deductions. Your <strong>taxable income</strong> is your income *after* you subtract deductions (like the standard deduction or itemized deductions). Your tax is calculated on this lower, taxable amount. This calculator assumes you have already determined your taxable income.</p>
                        </details>
                        <details>
                            <summary>What about capital gains or dividends?</summary>
                            <p>This calculator is for <strong>ordinary income</strong> (like wages, salaries, and business income). Long-term capital gains and qualified dividends are taxed at different, lower rates and are not included in this calculation.</p>
                        </details>
                    </section>

                    <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600">
                        <p><strong>Tool developed by Ugo Candido.</strong> Finance content reviewed by the CalcDomain Editorial Board.<br>
                        Last accuracy review for 2024 tax brackets: <time datetime="2024-11-10">November 10, 2024</time></p>
                    </div>
                </article>
            </section>

            <aside class="w-full lg:w-1/3">
                <div class="sticky top-24 space-y-6">
                    <div class="bg-gray-200 h-72 rounded-lg flex items-center justify-center text-gray-500">
                        Ad Placement (300×600)
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="font-bold text-lg mb-3">Why use this calculator</h3>
                        <ul class="list-disc list-inside text-sm text-gray-600 space-y-2">
                            <li>Instantly find your federal tax bracket.</li>
                            <li>Understand the difference between marginal and effective rates.</li>
                            <li>Plan for bonuses, raises, or freelance income.</li>
                            <li>Based on official 2024 IRS data.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="font-bold text-lg mb-4">Related Tax Tools</h3>
                        <ul class="space-y-3 text-sm">
                            <li><a href="https://calcdomain.com/income-tax-calculator.html" class="text-blue-600 hover:underline focus-visible-custom rounded">Federal Income Tax Calculator</a></li>
                            <li><a href="https://calcdomain.com/payroll-take-home-pay.html" class="text-blue-600 hover:underline focus-visible-custom rounded">Take-Home Pay (Payroll) Calculator</a></li>
                            <li><a href="https://calcdomain.com/capital-gains-tax.html" class="text-blue-600 hover:underline focus-visible-custom rounded">Capital Gains Tax Calculator</a></li>
                            <li><a href="https://calcdomain.com/401k.html" class="text-blue-600 hover:underline focus-visible-custom rounded">401(k) Contribution Calculator</a></li>
                        </ul>
                    </div>
                </div>
            </aside>
        </div>
    </main>

    <footer class="bg-white border-t">
        <div class="container mx-auto px-6 py-8 text-center text-gray-600 text-sm">
            <p>&copy; 2025 CalcDomain. All Rights Reserved.</p>
            <div class="mt-4 space-x-4">
                <a href="https://calcdomain.com/about.html" class="hover:text-blue-600 focus-visible-custom rounded">About</a>
                <a href="https://calcdomain.com/contact.html" class="hover:text-blue-600 focus-visible-custom rounded">Contact</a>
                <a href="https://calcdomain.com/privacy.html" class="hover:text-blue-600 focus-visible-custom rounded">Privacy</a>
                <a href="https://calcdomain.com/terms.html" class="hover:text-blue-600 focus-visible-custom rounded">Terms</a>
            </div>
        </div>
    </footer>

    <script defer>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DOM Elements ---
        const elements = {
            filingStatus: document.getElementById('filingStatus'),
            taxableIncome: document.getElementById('taxableIncome'),
            calculateBtn: document.getElementById('calculate-btn'),
            
            // Results
            resultsContent: document.getElementById('results-content'),
            resultsSummary: document.getElementById('results-summary'),
            marginalRateEl: document.getElementById('marginal-rate'),
            effectiveRateEl: document.getElementById('effective-rate'),
            totalTaxEl: document.getElementById('total-tax'),
            
            // Errors & Tooltips
            incomeError: document.getElementById('income-error'),
            errorContainer: document.getElementById('error-container'),
            tooltipBtn: document.getElementById('tooltip-btn'),
            tooltipContent: document.getElementById('tooltip-content'),
            
            // Mobile Menu
            mobileMenuToggle: document.getElementById('mobile-menu-toggle'),
            mobileMenu: document.getElementById('mobile-menu')
        };

        // --- Authoritative Data Source (IRS RP 2023-48) ---
        const TAX_YEAR = '2024';
        const TAX_BRACKETS = {
          '2024': {
            'single': [
              { rate: 0.10, threshold: 0 },
              { rate: 0.12, threshold: 11600 },
              { rate: 0.22, threshold: 47150 },
              { rate: 0.24, threshold: 100525 },
              { rate: 0.32, threshold: 191950 },
              { rate: 0.35, threshold: 243725 },
              { rate: 0.37, threshold: 609350 }
            ],
            'marriedJointly': [
              { rate: 0.10, threshold: 0 },
              { rate: 0.12, threshold: 23200 },
              { rate: 0.22, threshold: 94300 },
              { rate: 0.24, threshold: 201050 },
              { rate: 0.32, threshold: 383900 },
              { rate: 0.35, threshold: 487450 },
              { rate: 0.37, threshold: 731200 }
            ],
            'marriedSeparately': [
              { rate: 0.10, threshold: 0 },
              { rate: 0.12, threshold: 11600 },
              { rate: 0.22, threshold: 47150 },
              { rate: 0.24, threshold: 100525 },
              { rate: 0.32, threshold: 191950 },
              { rate: 0.35, threshold: 243725 },
              { rate: 0.37, threshold: 365600 }
            ],
            'headOfHousehold': [
              { rate: 0.10, threshold: 0 },
              { rate: 0.12, threshold: 16550 },
              { rate: 0.22, threshold: 63100 },
              { rate: 0.24, threshold: 107750 },
              { rate: 0.32, threshold: 191950 },
              { rate: 0.35, threshold: 243700 },
              { rate: 0.37, threshold: 609350 }
            ]
          }
        };

        // --- Formatters ---
        const fmtCurrency = (val) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(val || 0);
        const fmtPercent = (val, digits = 2) => new Intl.NumberFormat('en-US', { style: 'percent', minimumFractionDigits: digits, maximumFractionDigits: digits }).format(val || 0);
        const fmtInteger = (val) => new Intl.NumberFormat('en-US').format(val || 0);
        
        // --- Core Calculation Logic ---
        function calculateTax(income, status) {
            if (income < 0) return { totalTax: 0, marginalRate: 0, effectiveRate: 0 };
            
            const brackets = TAX_BRACKETS[TAX_YEAR][status];
            let totalTax = 0;
            let marginalRate = 0;

            for (let i = 0; i < brackets.length; i++) {
                const { rate, threshold } = brackets[i];
                const nextThreshold = (i + 1 < brackets.length) ? brackets[i + 1].threshold : Infinity;

                if (income > threshold) {
                    const taxableAmountInBracket = Math.min(income, nextThreshold) - threshold;
                    totalTax += taxableAmountInBracket * rate;
                    marginalRate = rate;
                } else {
                    break; // Income doesn't reach this bracket
                }
            }
            
            const effectiveRate = (income > 0) ? (totalTax / income) : 0;
            return { totalTax, marginalRate, effectiveRate };
        }

        // --- UI & Validation ---
        function showError(field, message) {
            const errorEl = (field === 'income') ? elements.incomeError : elements.errorContainer;
            const inputEl = (field === 'income') ? elements.taxableIncome : null;

            errorEl.textContent = message;
            if (inputEl) {
                inputEl.setAttribute('aria-invalid', 'true');
                // Ensure error message ID is in aria-describedby
                const desc = inputEl.getAttribute('aria-describedby');
                if (desc && !desc.includes('income-error')) {
                    inputEl.setAttribute('aria-describedby', desc + ' income-error');
                }
            }
        }

        function clearErrors() {
            elements.incomeError.textContent = '';
            elements.errorContainer.textContent = '';
            elements.taxableIncome.setAttribute('aria-invalid', 'false');
            // Remove error from aria-describedby
            const desc = elements.taxableIncome.getAttribute('aria-describedby');
            if (desc) {
                elements.taxableIncome.setAttribute('aria-describedby', desc.replace('income-error', '').trim());
            }
        }
        
        function validateIncome() {
            clearErrors();
            const income = parseFloat(elements.taxableIncome.value);
            
            if (isNaN(income) || elements.taxableIncome.value.trim() === '') {
                showError('income', 'Please enter your taxable income.');
                return false;
            }
            if (income < 0) {
                showError('income', 'Income must be zero or greater.');
                return false;
            }
            return true;
        }

        function runCalculation() {
            if (!validateIncome()) {
                elements.resultsContent.classList.add('hidden');
                return;
            }
            
            const income = parseFloat(elements.taxableIncome.value);
            const status = elements.filingStatus.value;
            
            const { totalTax, marginalRate, effectiveRate } = calculateTax(income, status);
            
            // Update UI
            elements.marginalRateEl.textContent = fmtPercent(marginalRate, 0);
            elements.effectiveRateEl.textContent = fmtPercent(effectiveRate, 2);
            elements.totalTaxEl.textContent = fmtCurrency(totalTax);
            
            elements.resultsSummary.innerHTML = `For a <strong>${status.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}</strong> filer with <strong>${fmtCurrency(income)}</strong> in taxable income:`;
            
            elements.resultsContent.classList.remove('hidden');
        }

        function toggleTooltip() {
            const isExpanded = elements.tooltipBtn.getAttribute('aria-expanded') === 'true';
            elements.tooltipBtn.setAttribute('aria-expanded', !isExpanded);
            elements.tooltipContent.classList.toggle('hidden');
            elements.tooltipContent.setAttribute('aria-hidden', isExpanded);
        }

        function toggleMobileMenu() {
            const isExpanded = elements.mobileMenuToggle.getAttribute('aria-expanded') === 'true';
            elements.mobileMenuToggle.setAttribute('aria-expanded', !isExpanded);
            elements.mobileMenu.classList.toggle('hidden');
        }

        // --- Event Listeners ---
        elements.calculateBtn.addEventListener('click', runCalculation);
        elements.taxableIncome.addEventListener('blur', validateIncome);
        elements.tooltipBtn.addEventListener('click', toggleTooltip);
        elements.mobileMenuToggle.addEventListener('click', toggleMobileMenu);

        // Add keydown for tooltip button (WCAG)
        elements.tooltipBtn.addEventListener('keydown', (e) => {
            if (e.key === ' ' || e.key === 'Enter') {
                e.preventDefault();
                toggleTooltip();
            }
        });
        
        // Initial calculation on page load
        runCalculation();
    });
    </script>
</body>
</html>